var JT=Object.defineProperty;var Cw=a=>{throw TypeError(a)};var eA=(a,e,s)=>e in a?JT(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s;var eg=(a,e,s)=>eA(a,typeof e!="symbol"?e+"":e,s),tg=(a,e,s)=>e.has(a)||Cw("Cannot "+s);var Ae=(a,e,s)=>(tg(a,e,"read from private field"),s?s.call(a):e.get(a)),$t=(a,e,s)=>e.has(a)?Cw("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,s),At=(a,e,s,r)=>(tg(a,e,"write to private field"),r?r.call(a,s):e.set(a,s),s),is=(a,e,s)=>(tg(a,e,"access private method"),s);var bh=(a,e,s,r)=>({set _(n){At(a,e,n,s)},get _(){return Ae(a,e,r)}});function tA(a,e){for(var s=0;s<e.length;s++){const r=e[s];if(typeof r!="string"&&!Array.isArray(r)){for(const n in r)if(n!=="default"&&!(n in a)){const o=Object.getOwnPropertyDescriptor(r,n);o&&Object.defineProperty(a,n,o.get?o:{enumerable:!0,get:()=>r[n]})}}}return Object.freeze(Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();function tx(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var sg={exports:{}},hd={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kw;function sA(){if(kw)return hd;kw=1;var a=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function s(r,n,o){var c=null;if(o!==void 0&&(c=""+o),n.key!==void 0&&(c=""+n.key),"key"in n){o={};for(var d in n)d!=="key"&&(o[d]=n[d])}else o=n;return n=o.ref,{$$typeof:a,type:r,key:c,ref:n!==void 0?n:null,props:o}}return hd.Fragment=e,hd.jsx=s,hd.jsxs=s,hd}var Rw;function rA(){return Rw||(Rw=1,sg.exports=sA()),sg.exports}var t=rA(),rg={exports:{}},Jt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lw;function aA(){if(Lw)return Jt;Lw=1;var a=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),x=Symbol.iterator;function b(V){return V===null||typeof V!="object"?null:(V=x&&V[x]||V["@@iterator"],typeof V=="function"?V:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function T(V,G,Z){this.props=V,this.context=G,this.refs=S,this.updater=Z||v}T.prototype.isReactComponent={},T.prototype.setState=function(V,G){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,G,"setState")},T.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function k(){}k.prototype=T.prototype;function E(V,G,Z){this.props=V,this.context=G,this.refs=S,this.updater=Z||v}var R=E.prototype=new k;R.constructor=E,w(R,T.prototype),R.isPureReactComponent=!0;var K=Array.isArray;function z(){}var D={H:null,A:null,T:null,S:null},O=Object.prototype.hasOwnProperty;function U(V,G,Z){var oe=Z.ref;return{$$typeof:a,type:V,key:G,ref:oe!==void 0?oe:null,props:Z}}function I(V,G){return U(V.type,G,V.props)}function F(V){return typeof V=="object"&&V!==null&&V.$$typeof===a}function te(V){var G={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(Z){return G[Z]})}var le=/\/+/g;function H(V,G){return typeof V=="object"&&V!==null&&V.key!=null?te(""+V.key):G.toString(36)}function X(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(z,z):(V.status="pending",V.then(function(G){V.status==="pending"&&(V.status="fulfilled",V.value=G)},function(G){V.status==="pending"&&(V.status="rejected",V.reason=G)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function q(V,G,Z,oe,ye){var je=typeof V;(je==="undefined"||je==="boolean")&&(V=null);var xe=!1;if(V===null)xe=!0;else switch(je){case"bigint":case"string":case"number":xe=!0;break;case"object":switch(V.$$typeof){case a:case e:xe=!0;break;case m:return xe=V._init,q(xe(V._payload),G,Z,oe,ye)}}if(xe)return ye=ye(V),xe=oe===""?"."+H(V,0):oe,K(ye)?(Z="",xe!=null&&(Z=xe.replace(le,"$&/")+"/"),q(ye,G,Z,"",function(Re){return Re})):ye!=null&&(F(ye)&&(ye=I(ye,Z+(ye.key==null||V&&V.key===ye.key?"":(""+ye.key).replace(le,"$&/")+"/")+xe)),G.push(ye)),1;xe=0;var Ee=oe===""?".":oe+":";if(K(V))for(var Pe=0;Pe<V.length;Pe++)oe=V[Pe],je=Ee+H(oe,Pe),xe+=q(oe,G,Z,je,ye);else if(Pe=b(V),typeof Pe=="function")for(V=Pe.call(V),Pe=0;!(oe=V.next()).done;)oe=oe.value,je=Ee+H(oe,Pe++),xe+=q(oe,G,Z,je,ye);else if(je==="object"){if(typeof V.then=="function")return q(X(V),G,Z,oe,ye);throw G=String(V),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.")}return xe}function ae(V,G,Z){if(V==null)return V;var oe=[],ye=0;return q(V,oe,"","",function(je){return G.call(Z,je,ye++)}),oe}function ce(V){if(V._status===-1){var G=V._result;G=G(),G.then(function(Z){(V._status===0||V._status===-1)&&(V._status=1,V._result=Z)},function(Z){(V._status===0||V._status===-1)&&(V._status=2,V._result=Z)}),V._status===-1&&(V._status=0,V._result=G)}if(V._status===1)return V._result.default;throw V._result}var ee=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var G=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(G))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},W={map:ae,forEach:function(V,G,Z){ae(V,function(){G.apply(this,arguments)},Z)},count:function(V){var G=0;return ae(V,function(){G++}),G},toArray:function(V){return ae(V,function(G){return G})||[]},only:function(V){if(!F(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return Jt.Activity=g,Jt.Children=W,Jt.Component=T,Jt.Fragment=s,Jt.Profiler=n,Jt.PureComponent=E,Jt.StrictMode=r,Jt.Suspense=f,Jt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,Jt.__COMPILER_RUNTIME={__proto__:null,c:function(V){return D.H.useMemoCache(V)}},Jt.cache=function(V){return function(){return V.apply(null,arguments)}},Jt.cacheSignal=function(){return null},Jt.cloneElement=function(V,G,Z){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var oe=w({},V.props),ye=V.key;if(G!=null)for(je in G.key!==void 0&&(ye=""+G.key),G)!O.call(G,je)||je==="key"||je==="__self"||je==="__source"||je==="ref"&&G.ref===void 0||(oe[je]=G[je]);var je=arguments.length-2;if(je===1)oe.children=Z;else if(1<je){for(var xe=Array(je),Ee=0;Ee<je;Ee++)xe[Ee]=arguments[Ee+2];oe.children=xe}return U(V.type,ye,oe)},Jt.createContext=function(V){return V={$$typeof:c,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:o,_context:V},V},Jt.createElement=function(V,G,Z){var oe,ye={},je=null;if(G!=null)for(oe in G.key!==void 0&&(je=""+G.key),G)O.call(G,oe)&&oe!=="key"&&oe!=="__self"&&oe!=="__source"&&(ye[oe]=G[oe]);var xe=arguments.length-2;if(xe===1)ye.children=Z;else if(1<xe){for(var Ee=Array(xe),Pe=0;Pe<xe;Pe++)Ee[Pe]=arguments[Pe+2];ye.children=Ee}if(V&&V.defaultProps)for(oe in xe=V.defaultProps,xe)ye[oe]===void 0&&(ye[oe]=xe[oe]);return U(V,je,ye)},Jt.createRef=function(){return{current:null}},Jt.forwardRef=function(V){return{$$typeof:d,render:V}},Jt.isValidElement=F,Jt.lazy=function(V){return{$$typeof:m,_payload:{_status:-1,_result:V},_init:ce}},Jt.memo=function(V,G){return{$$typeof:u,type:V,compare:G===void 0?null:G}},Jt.startTransition=function(V){var G=D.T,Z={};D.T=Z;try{var oe=V(),ye=D.S;ye!==null&&ye(Z,oe),typeof oe=="object"&&oe!==null&&typeof oe.then=="function"&&oe.then(z,ee)}catch(je){ee(je)}finally{G!==null&&Z.types!==null&&(G.types=Z.types),D.T=G}},Jt.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},Jt.use=function(V){return D.H.use(V)},Jt.useActionState=function(V,G,Z){return D.H.useActionState(V,G,Z)},Jt.useCallback=function(V,G){return D.H.useCallback(V,G)},Jt.useContext=function(V){return D.H.useContext(V)},Jt.useDebugValue=function(){},Jt.useDeferredValue=function(V,G){return D.H.useDeferredValue(V,G)},Jt.useEffect=function(V,G){return D.H.useEffect(V,G)},Jt.useEffectEvent=function(V){return D.H.useEffectEvent(V)},Jt.useId=function(){return D.H.useId()},Jt.useImperativeHandle=function(V,G,Z){return D.H.useImperativeHandle(V,G,Z)},Jt.useInsertionEffect=function(V,G){return D.H.useInsertionEffect(V,G)},Jt.useLayoutEffect=function(V,G){return D.H.useLayoutEffect(V,G)},Jt.useMemo=function(V,G){return D.H.useMemo(V,G)},Jt.useOptimistic=function(V,G){return D.H.useOptimistic(V,G)},Jt.useReducer=function(V,G,Z){return D.H.useReducer(V,G,Z)},Jt.useRef=function(V){return D.H.useRef(V)},Jt.useState=function(V){return D.H.useState(V)},Jt.useSyncExternalStore=function(V,G,Z){return D.H.useSyncExternalStore(V,G,Z)},Jt.useTransition=function(){return D.H.useTransition()},Jt.version="19.2.0",Jt}var Dw;function If(){return Dw||(Dw=1,rg.exports=aA()),rg.exports}var y=If();const lt=tx(y),Iw=tA({__proto__:null,default:lt},[y]);var ag={exports:{}},fd={},ng={exports:{}},ig={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mw;function nA(){return Mw||(Mw=1,(function(a){function e(q,ae){var ce=q.length;q.push(ae);e:for(;0<ce;){var ee=ce-1>>>1,W=q[ee];if(0<n(W,ae))q[ee]=ae,q[ce]=W,ce=ee;else break e}}function s(q){return q.length===0?null:q[0]}function r(q){if(q.length===0)return null;var ae=q[0],ce=q.pop();if(ce!==ae){q[0]=ce;e:for(var ee=0,W=q.length,V=W>>>1;ee<V;){var G=2*(ee+1)-1,Z=q[G],oe=G+1,ye=q[oe];if(0>n(Z,ce))oe<W&&0>n(ye,Z)?(q[ee]=ye,q[oe]=ce,ee=oe):(q[ee]=Z,q[G]=ce,ee=G);else if(oe<W&&0>n(ye,ce))q[ee]=ye,q[oe]=ce,ee=oe;else break e}}return ae}function n(q,ae){var ce=q.sortIndex-ae.sortIndex;return ce!==0?ce:q.id-ae.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;a.unstable_now=function(){return o.now()}}else{var c=Date,d=c.now();a.unstable_now=function(){return c.now()-d}}var f=[],u=[],m=1,g=null,x=3,b=!1,v=!1,w=!1,S=!1,T=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function R(q){for(var ae=s(u);ae!==null;){if(ae.callback===null)r(u);else if(ae.startTime<=q)r(u),ae.sortIndex=ae.expirationTime,e(f,ae);else break;ae=s(u)}}function K(q){if(w=!1,R(q),!v)if(s(f)!==null)v=!0,z||(z=!0,te());else{var ae=s(u);ae!==null&&X(K,ae.startTime-q)}}var z=!1,D=-1,O=5,U=-1;function I(){return S?!0:!(a.unstable_now()-U<O)}function F(){if(S=!1,z){var q=a.unstable_now();U=q;var ae=!0;try{e:{v=!1,w&&(w=!1,k(D),D=-1),b=!0;var ce=x;try{t:{for(R(q),g=s(f);g!==null&&!(g.expirationTime>q&&I());){var ee=g.callback;if(typeof ee=="function"){g.callback=null,x=g.priorityLevel;var W=ee(g.expirationTime<=q);if(q=a.unstable_now(),typeof W=="function"){g.callback=W,R(q),ae=!0;break t}g===s(f)&&r(f),R(q)}else r(f);g=s(f)}if(g!==null)ae=!0;else{var V=s(u);V!==null&&X(K,V.startTime-q),ae=!1}}break e}finally{g=null,x=ce,b=!1}ae=void 0}}finally{ae?te():z=!1}}}var te;if(typeof E=="function")te=function(){E(F)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,H=le.port2;le.port1.onmessage=F,te=function(){H.postMessage(null)}}else te=function(){T(F,0)};function X(q,ae){D=T(function(){q(a.unstable_now())},ae)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(q){q.callback=null},a.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<q?Math.floor(1e3/q):5},a.unstable_getCurrentPriorityLevel=function(){return x},a.unstable_next=function(q){switch(x){case 1:case 2:case 3:var ae=3;break;default:ae=x}var ce=x;x=ae;try{return q()}finally{x=ce}},a.unstable_requestPaint=function(){S=!0},a.unstable_runWithPriority=function(q,ae){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ce=x;x=q;try{return ae()}finally{x=ce}},a.unstable_scheduleCallback=function(q,ae,ce){var ee=a.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?ee+ce:ee):ce=ee,q){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=ce+W,q={id:m++,callback:ae,priorityLevel:q,startTime:ce,expirationTime:W,sortIndex:-1},ce>ee?(q.sortIndex=ce,e(u,q),s(f)===null&&q===s(u)&&(w?(k(D),D=-1):w=!0,X(K,ce-ee))):(q.sortIndex=W,e(f,q),v||b||(v=!0,z||(z=!0,te()))),q},a.unstable_shouldYield=I,a.unstable_wrapCallback=function(q){var ae=x;return function(){var ce=x;x=ae;try{return q.apply(this,arguments)}finally{x=ce}}}})(ig)),ig}var Pw;function iA(){return Pw||(Pw=1,ng.exports=nA()),ng.exports}var og={exports:{}},Br={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ow;function oA(){if(Ow)return Br;Ow=1;var a=If();function e(f){var u="https://react.dev/errors/"+f;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)u+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var r={d:{f:s,r:function(){throw Error(e(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},n=Symbol.for("react.portal");function o(f,u,m){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:g==null?null:""+g,children:f,containerInfo:u,implementation:m}}var c=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,u){if(f==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return Br.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Br.createPortal=function(f,u){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(e(299));return o(f,u,null,m)},Br.flushSync=function(f){var u=c.T,m=r.p;try{if(c.T=null,r.p=2,f)return f()}finally{c.T=u,r.p=m,r.d.f()}},Br.preconnect=function(f,u){typeof f=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,r.d.C(f,u))},Br.prefetchDNS=function(f){typeof f=="string"&&r.d.D(f)},Br.preinit=function(f,u){if(typeof f=="string"&&u&&typeof u.as=="string"){var m=u.as,g=d(m,u.crossOrigin),x=typeof u.integrity=="string"?u.integrity:void 0,b=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;m==="style"?r.d.S(f,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:g,integrity:x,fetchPriority:b}):m==="script"&&r.d.X(f,{crossOrigin:g,integrity:x,fetchPriority:b,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},Br.preinitModule=function(f,u){if(typeof f=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var m=d(u.as,u.crossOrigin);r.d.M(f,{crossOrigin:m,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&r.d.M(f)},Br.preload=function(f,u){if(typeof f=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var m=u.as,g=d(m,u.crossOrigin);r.d.L(f,m,{crossOrigin:g,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},Br.preloadModule=function(f,u){if(typeof f=="string")if(u){var m=d(u.as,u.crossOrigin);r.d.m(f,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:m,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else r.d.m(f)},Br.requestFormReset=function(f){r.d.r(f)},Br.unstable_batchedUpdates=function(f,u){return f(u)},Br.useFormState=function(f,u,m){return c.H.useFormState(f,u,m)},Br.useFormStatus=function(){return c.H.useHostTransitionStatus()},Br.version="19.2.0",Br}var Fw;function R_(){if(Fw)return og.exports;Fw=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(e){console.error(e)}}return a(),og.exports=oA(),og.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bw;function lA(){if(Bw)return fd;Bw=1;var a=iA(),e=If(),s=R_();function r(i){var l="https://react.dev/errors/"+i;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)l+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+i+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var l=i,h=i;if(i.alternate)for(;l.return;)l=l.return;else{i=l;do l=i,(l.flags&4098)!==0&&(h=l.return),i=l.return;while(i)}return l.tag===3?h:null}function c(i){if(i.tag===13){var l=i.memoizedState;if(l===null&&(i=i.alternate,i!==null&&(l=i.memoizedState)),l!==null)return l.dehydrated}return null}function d(i){if(i.tag===31){var l=i.memoizedState;if(l===null&&(i=i.alternate,i!==null&&(l=i.memoizedState)),l!==null)return l.dehydrated}return null}function f(i){if(o(i)!==i)throw Error(r(188))}function u(i){var l=i.alternate;if(!l){if(l=o(i),l===null)throw Error(r(188));return l!==i?null:i}for(var h=i,p=l;;){var N=h.return;if(N===null)break;var A=N.alternate;if(A===null){if(p=N.return,p!==null){h=p;continue}break}if(N.child===A.child){for(A=N.child;A;){if(A===h)return f(N),i;if(A===p)return f(N),l;A=A.sibling}throw Error(r(188))}if(h.return!==p.return)h=N,p=A;else{for(var Y=!1,ie=N.child;ie;){if(ie===h){Y=!0,h=N,p=A;break}if(ie===p){Y=!0,p=N,h=A;break}ie=ie.sibling}if(!Y){for(ie=A.child;ie;){if(ie===h){Y=!0,h=A,p=N;break}if(ie===p){Y=!0,p=A,h=N;break}ie=ie.sibling}if(!Y)throw Error(r(189))}}if(h.alternate!==p)throw Error(r(190))}if(h.tag!==3)throw Error(r(188));return h.stateNode.current===h?i:l}function m(i){var l=i.tag;if(l===5||l===26||l===27||l===6)return i;for(i=i.child;i!==null;){if(l=m(i),l!==null)return l;i=i.sibling}return null}var g=Object.assign,x=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),E=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function te(i){return i===null||typeof i!="object"?null:(i=F&&i[F]||i["@@iterator"],typeof i=="function"?i:null)}var le=Symbol.for("react.client.reference");function H(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===le?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case w:return"Fragment";case T:return"Profiler";case S:return"StrictMode";case K:return"Suspense";case z:return"SuspenseList";case U:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case v:return"Portal";case E:return i.displayName||"Context";case k:return(i._context.displayName||"Context")+".Consumer";case R:var l=i.render;return i=i.displayName,i||(i=l.displayName||l.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case D:return l=i.displayName||null,l!==null?l:H(i.type)||"Memo";case O:l=i._payload,i=i._init;try{return H(i(l))}catch{}}return null}var X=Array.isArray,q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce={pending:!1,data:null,method:null,action:null},ee=[],W=-1;function V(i){return{current:i}}function G(i){0>W||(i.current=ee[W],ee[W]=null,W--)}function Z(i,l){W++,ee[W]=i.current,i.current=l}var oe=V(null),ye=V(null),je=V(null),xe=V(null);function Ee(i,l){switch(Z(je,l),Z(ye,i),Z(oe,null),l.nodeType){case 9:case 11:i=(i=l.documentElement)&&(i=i.namespaceURI)?Zv(i):0;break;default:if(i=l.tagName,l=l.namespaceURI)l=Zv(l),i=Jv(l,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}G(oe),Z(oe,i)}function Pe(){G(oe),G(ye),G(je)}function Re(i){i.memoizedState!==null&&Z(xe,i);var l=oe.current,h=Jv(l,i.type);l!==h&&(Z(ye,i),Z(oe,h))}function Qe(i){ye.current===i&&(G(oe),G(ye)),xe.current===i&&(G(xe),ld._currentValue=ce)}var ot,ne;function ke(i){if(ot===void 0)try{throw Error()}catch(h){var l=h.stack.trim().match(/\n( *(at )?)/);ot=l&&l[1]||"",ne=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ot+i+ne}var Be=!1;function qe(i,l){if(!i||Be)return"";Be=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(l){var pt=function(){throw Error()};if(Object.defineProperty(pt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(pt,[])}catch(rt){var Xe=rt}Reflect.construct(i,[],pt)}else{try{pt.call()}catch(rt){Xe=rt}i.call(pt.prototype)}}else{try{throw Error()}catch(rt){Xe=rt}(pt=i())&&typeof pt.catch=="function"&&pt.catch(function(){})}}catch(rt){if(rt&&Xe&&typeof rt.stack=="string")return[rt.stack,Xe.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=p.DetermineComponentFrameRoot(),Y=A[0],ie=A[1];if(Y&&ie){var Te=Y.split(`
`),We=ie.split(`
`);for(N=p=0;p<Te.length&&!Te[p].includes("DetermineComponentFrameRoot");)p++;for(;N<We.length&&!We[N].includes("DetermineComponentFrameRoot");)N++;if(p===Te.length||N===We.length)for(p=Te.length-1,N=We.length-1;1<=p&&0<=N&&Te[p]!==We[N];)N--;for(;1<=p&&0<=N;p--,N--)if(Te[p]!==We[N]){if(p!==1||N!==1)do if(p--,N--,0>N||Te[p]!==We[N]){var ct=`
`+Te[p].replace(" at new "," at ");return i.displayName&&ct.includes("<anonymous>")&&(ct=ct.replace("<anonymous>",i.displayName)),ct}while(1<=p&&0<=N);break}}}finally{Be=!1,Error.prepareStackTrace=h}return(h=i?i.displayName||i.name:"")?ke(h):""}function dt(i,l){switch(i.tag){case 26:case 27:case 5:return ke(i.type);case 16:return ke("Lazy");case 13:return i.child!==l&&l!==null?ke("Suspense Fallback"):ke("Suspense");case 19:return ke("SuspenseList");case 0:case 15:return qe(i.type,!1);case 11:return qe(i.type.render,!1);case 1:return qe(i.type,!0);case 31:return ke("Activity");default:return""}}function He(i){try{var l="",h=null;do l+=dt(i,h),h=i,i=i.return;while(i);return l}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var Ce=Object.prototype.hasOwnProperty,_e=a.unstable_scheduleCallback,ge=a.unstable_cancelCallback,Ze=a.unstable_shouldYield,Me=a.unstable_requestPaint,nt=a.unstable_now,ht=a.unstable_getCurrentPriorityLevel,Oe=a.unstable_ImmediatePriority,tt=a.unstable_UserBlockingPriority,Ct=a.unstable_NormalPriority,we=a.unstable_LowPriority,bt=a.unstable_IdlePriority,ve=a.log,xt=a.unstable_setDisableYieldValue,me=null,De=null;function ue(i){if(typeof ve=="function"&&xt(i),De&&typeof De.setStrictMode=="function")try{De.setStrictMode(me,i)}catch{}}var Fe=Math.clz32?Math.clz32:st,mt=Math.log,Se=Math.LN2;function st(i){return i>>>=0,i===0?32:31-(mt(i)/Se|0)|0}var wt=256,yt=262144,Mt=4194304;function Ke(i){var l=i&42;if(l!==0)return l;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Vt(i,l,h){var p=i.pendingLanes;if(p===0)return 0;var N=0,A=i.suspendedLanes,Y=i.pingedLanes;i=i.warmLanes;var ie=p&134217727;return ie!==0?(p=ie&~A,p!==0?N=Ke(p):(Y&=ie,Y!==0?N=Ke(Y):h||(h=ie&~i,h!==0&&(N=Ke(h))))):(ie=p&~A,ie!==0?N=Ke(ie):Y!==0?N=Ke(Y):h||(h=p&~i,h!==0&&(N=Ke(h)))),N===0?0:l!==0&&l!==N&&(l&A)===0&&(A=N&-N,h=l&-l,A>=h||A===32&&(h&4194048)!==0)?l:N}function Nt(i,l){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&l)===0}function St(i,l){switch(i){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Kt(){var i=Mt;return Mt<<=1,(Mt&62914560)===0&&(Mt=4194304),i}function ws(i){for(var l=[],h=0;31>h;h++)l.push(i);return l}function Ne(i,l){i.pendingLanes|=l,l!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function gt(i,l,h,p,N,A){var Y=i.pendingLanes;i.pendingLanes=h,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=h,i.entangledLanes&=h,i.errorRecoveryDisabledLanes&=h,i.shellSuspendCounter=0;var ie=i.entanglements,Te=i.expirationTimes,We=i.hiddenUpdates;for(h=Y&~h;0<h;){var ct=31-Fe(h),pt=1<<ct;ie[ct]=0,Te[ct]=-1;var Xe=We[ct];if(Xe!==null)for(We[ct]=null,ct=0;ct<Xe.length;ct++){var rt=Xe[ct];rt!==null&&(rt.lane&=-536870913)}h&=~pt}p!==0&&jt(i,p,0),A!==0&&N===0&&i.tag!==0&&(i.suspendedLanes|=A&~(Y&~l))}function jt(i,l,h){i.pendingLanes|=l,i.suspendedLanes&=~l;var p=31-Fe(l);i.entangledLanes|=l,i.entanglements[p]=i.entanglements[p]|1073741824|h&261930}function vt(i,l){var h=i.entangledLanes|=l;for(i=i.entanglements;h;){var p=31-Fe(h),N=1<<p;N&l|i[p]&l&&(i[p]|=l),h&=~N}}function os(i,l){var h=l&-l;return h=(h&42)!==0?1:xs(h),(h&(i.suspendedLanes|l))!==0?0:h}function xs(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function hs(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Yr(){var i=ae.p;return i!==0?i:(i=window.event,i===void 0?32:Sw(i.type))}function M(i,l){var h=ae.p;try{return ae.p=i,l()}finally{ae.p=h}}var C=Math.random().toString(36).slice(2),j="__reactFiber$"+C,_="__reactProps$"+C,P="__reactContainer$"+C,L="__reactEvents$"+C,$="__reactListeners$"+C,J="__reactHandles$"+C,de="__reactResources$"+C,B="__reactMarker$"+C;function se(i){delete i[j],delete i[_],delete i[L],delete i[$],delete i[J]}function fe(i){var l=i[j];if(l)return l;for(var h=i.parentNode;h;){if(l=h[P]||h[j]){if(h=l.alternate,l.child!==null||h!==null&&h.child!==null)for(i=iw(i);i!==null;){if(h=i[j])return h;i=iw(i)}return l}i=h,h=i.parentNode}return null}function he(i){if(i=i[j]||i[P]){var l=i.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return i}return null}function pe(i){var l=i.tag;if(l===5||l===26||l===27||l===6)return i.stateNode;throw Error(r(33))}function Ue(i){var l=i[de];return l||(l=i[de]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Ge(i){i[B]=!0}var re=new Set,Le={};function Je(i,l){it(i,l),it(i+"Capture",l)}function it(i,l){for(Le[i]=l,i=0;i<l.length;i++)re.add(l[i])}var Et=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ht={},_t={};function Pt(i){return Ce.call(_t,i)?!0:Ce.call(Ht,i)?!1:Et.test(i)?_t[i]=!0:(Ht[i]=!0,!1)}function Wt(i,l,h){if(Pt(l))if(h===null)i.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":i.removeAttribute(l);return;case"boolean":var p=l.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(l);return}}i.setAttribute(l,""+h)}}function Bt(i,l,h){if(h===null)i.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(l);return}i.setAttribute(l,""+h)}}function It(i,l,h,p){if(p===null)i.removeAttribute(h);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(h);return}i.setAttributeNS(l,h,""+p)}}function Qt(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function _s(i){var l=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Yt(i,l,h){var p=Object.getOwnPropertyDescriptor(i.constructor.prototype,l);if(!i.hasOwnProperty(l)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var N=p.get,A=p.set;return Object.defineProperty(i,l,{configurable:!0,get:function(){return N.call(this)},set:function(Y){h=""+Y,A.call(this,Y)}}),Object.defineProperty(i,l,{enumerable:p.enumerable}),{getValue:function(){return h},setValue:function(Y){h=""+Y},stopTracking:function(){i._valueTracker=null,delete i[l]}}}}function es(i){if(!i._valueTracker){var l=_s(i)?"checked":"value";i._valueTracker=Yt(i,l,""+i[l])}}function Es(i){if(!i)return!1;var l=i._valueTracker;if(!l)return!0;var h=l.getValue(),p="";return i&&(p=_s(i)?i.checked?"true":"false":i.value),i=p,i!==h?(l.setValue(i),!0):!1}function Ys(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var ua=/[\n"\\]/g;function Rs(i){return i.replace(ua,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Ar(i,l,h,p,N,A,Y,ie){i.name="",Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"?i.type=Y:i.removeAttribute("type"),l!=null?Y==="number"?(l===0&&i.value===""||i.value!=l)&&(i.value=""+Qt(l)):i.value!==""+Qt(l)&&(i.value=""+Qt(l)):Y!=="submit"&&Y!=="reset"||i.removeAttribute("value"),l!=null?mr(i,Y,Qt(l)):h!=null?mr(i,Y,Qt(h)):p!=null&&i.removeAttribute("value"),N==null&&A!=null&&(i.defaultChecked=!!A),N!=null&&(i.checked=N&&typeof N!="function"&&typeof N!="symbol"),ie!=null&&typeof ie!="function"&&typeof ie!="symbol"&&typeof ie!="boolean"?i.name=""+Qt(ie):i.removeAttribute("name")}function Nr(i,l,h,p,N,A,Y,ie){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(i.type=A),l!=null||h!=null){if(!(A!=="submit"&&A!=="reset"||l!=null)){es(i);return}h=h!=null?""+Qt(h):"",l=l!=null?""+Qt(l):h,ie||l===i.value||(i.value=l),i.defaultValue=l}p=p??N,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=ie?i.checked:!!p,i.defaultChecked=!!p,Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"&&(i.name=Y),es(i)}function mr(i,l,h){l==="number"&&Ys(i.ownerDocument)===i||i.defaultValue===""+h||(i.defaultValue=""+h)}function rr(i,l,h,p){if(i=i.options,l){l={};for(var N=0;N<h.length;N++)l["$"+h[N]]=!0;for(h=0;h<i.length;h++)N=l.hasOwnProperty("$"+i[h].value),i[h].selected!==N&&(i[h].selected=N),N&&p&&(i[h].defaultSelected=!0)}else{for(h=""+Qt(h),l=null,N=0;N<i.length;N++){if(i[N].value===h){i[N].selected=!0,p&&(i[N].defaultSelected=!0);return}l!==null||i[N].disabled||(l=i[N])}l!==null&&(l.selected=!0)}}function ys(i,l,h){if(l!=null&&(l=""+Qt(l),l!==i.value&&(i.value=l),h==null)){i.defaultValue!==l&&(i.defaultValue=l);return}i.defaultValue=h!=null?""+Qt(h):""}function Aa(i,l,h,p){if(l==null){if(p!=null){if(h!=null)throw Error(r(92));if(X(p)){if(1<p.length)throw Error(r(93));p=p[0]}h=p}h==null&&(h=""),l=h}h=Qt(l),i.defaultValue=h,p=i.textContent,p===h&&p!==""&&p!==null&&(i.value=p),es(i)}function Fr(i,l){if(l){var h=i.firstChild;if(h&&h===i.lastChild&&h.nodeType===3){h.nodeValue=l;return}}i.textContent=l}var dl=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Nc(i,l,h){var p=l.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?p?i.setProperty(l,""):l==="float"?i.cssFloat="":i[l]="":p?i.setProperty(l,h):typeof h!="number"||h===0||dl.has(l)?l==="float"?i.cssFloat=h:i[l]=(""+h).trim():i[l]=h+"px"}function du(i,l,h){if(l!=null&&typeof l!="object")throw Error(r(62));if(i=i.style,h!=null){for(var p in h)!h.hasOwnProperty(p)||l!=null&&l.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var N in l)p=l[N],l.hasOwnProperty(N)&&h[N]!==p&&Nc(i,N,p)}else for(var A in l)l.hasOwnProperty(A)&&Nc(i,A,l[A])}function ul(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ho=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),fo=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function mo(i){return fo.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function ha(){}var go=null;function Ln(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ln=null,cn=null;function po(i){var l=he(i);if(l&&(i=l.stateNode)){var h=i[_]||null;e:switch(i=l.stateNode,l.type){case"input":if(Ar(i,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),l=h.name,h.type==="radio"&&l!=null){for(h=i;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+Rs(""+l)+'"][type="radio"]'),l=0;l<h.length;l++){var p=h[l];if(p!==i&&p.form===i.form){var N=p[_]||null;if(!N)throw Error(r(90));Ar(p,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(l=0;l<h.length;l++)p=h[l],p.form===i.form&&Es(p)}break e;case"textarea":ys(i,h.value,h.defaultValue);break e;case"select":l=h.value,l!=null&&rr(i,!!h.multiple,l,!1)}}}var hl=!1;function jc(i,l,h){if(hl)return i(l,h);hl=!0;try{var p=i(l);return p}finally{if(hl=!1,(ln!==null||cn!==null)&&(Xu(),ln&&(l=ln,i=cn,cn=ln=null,po(l),i)))for(l=0;l<i.length;l++)po(i[l])}}function Dn(i,l){var h=i.stateNode;if(h===null)return null;var p=h[_]||null;if(p===null)return null;h=p[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(h&&typeof h!="function")throw Error(r(231,l,typeof h));return h}var Ca=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ec=!1;if(Ca)try{var pi={};Object.defineProperty(pi,"passive",{get:function(){Ec=!0}}),window.addEventListener("test",pi,pi),window.removeEventListener("test",pi,pi)}catch{Ec=!1}var Ka=null,fl=null,uu=null;function Jx(){if(uu)return uu;var i,l=fl,h=l.length,p,N="value"in Ka?Ka.value:Ka.textContent,A=N.length;for(i=0;i<h&&l[i]===N[i];i++);var Y=h-i;for(p=1;p<=Y&&l[h-p]===N[A-p];p++);return uu=N.slice(i,1<p?1-p:void 0)}function hu(i){var l=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&l===13&&(i=13)):i=l,i===10&&(i=13),32<=i||i===13?i:0}function fu(){return!0}function ey(){return!1}function Wr(i){function l(h,p,N,A,Y){this._reactName=h,this._targetInst=N,this.type=p,this.nativeEvent=A,this.target=Y,this.currentTarget=null;for(var ie in i)i.hasOwnProperty(ie)&&(h=i[ie],this[ie]=h?h(A):A[ie]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?fu:ey,this.isPropagationStopped=ey,this}return g(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=fu)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=fu)},persist:function(){},isPersistent:fu}),l}var xo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},mu=Wr(xo),Tc=g({},xo,{view:0,detail:0}),X2=Wr(Tc),sm,rm,Ac,gu=g({},Tc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nm,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ac&&(Ac&&i.type==="mousemove"?(sm=i.screenX-Ac.screenX,rm=i.screenY-Ac.screenY):rm=sm=0,Ac=i),sm)},movementY:function(i){return"movementY"in i?i.movementY:rm}}),ty=Wr(gu),Z2=g({},gu,{dataTransfer:0}),J2=Wr(Z2),eE=g({},Tc,{relatedTarget:0}),am=Wr(eE),tE=g({},xo,{animationName:0,elapsedTime:0,pseudoElement:0}),sE=Wr(tE),rE=g({},xo,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),aE=Wr(rE),nE=g({},xo,{data:0}),sy=Wr(nE),iE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},oE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cE(i){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(i):(i=lE[i])?!!l[i]:!1}function nm(){return cE}var dE=g({},Tc,{key:function(i){if(i.key){var l=iE[i.key]||i.key;if(l!=="Unidentified")return l}return i.type==="keypress"?(i=hu(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?oE[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nm,charCode:function(i){return i.type==="keypress"?hu(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?hu(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),uE=Wr(dE),hE=g({},gu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ry=Wr(hE),fE=g({},Tc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nm}),mE=Wr(fE),gE=g({},xo,{propertyName:0,elapsedTime:0,pseudoElement:0}),pE=Wr(gE),xE=g({},gu,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),yE=Wr(xE),bE=g({},xo,{newState:0,oldState:0}),vE=Wr(bE),wE=[9,13,27,32],im=Ca&&"CompositionEvent"in window,Cc=null;Ca&&"documentMode"in document&&(Cc=document.documentMode);var SE=Ca&&"TextEvent"in window&&!Cc,ay=Ca&&(!im||Cc&&8<Cc&&11>=Cc),ny=" ",iy=!1;function oy(i,l){switch(i){case"keyup":return wE.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ly(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ml=!1;function _E(i,l){switch(i){case"compositionend":return ly(l);case"keypress":return l.which!==32?null:(iy=!0,ny);case"textInput":return i=l.data,i===ny&&iy?null:i;default:return null}}function NE(i,l){if(ml)return i==="compositionend"||!im&&oy(i,l)?(i=Jx(),uu=fl=Ka=null,ml=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return ay&&l.locale!=="ko"?null:l.data;default:return null}}var jE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cy(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l==="input"?!!jE[i.type]:l==="textarea"}function dy(i,l,h,p){ln?cn?cn.push(p):cn=[p]:ln=p,l=ah(l,"onChange"),0<l.length&&(h=new mu("onChange","change",null,h,p),i.push({event:h,listeners:l}))}var kc=null,Rc=null;function EE(i){qv(i,0)}function pu(i){var l=pe(i);if(Es(l))return i}function uy(i,l){if(i==="change")return l}var hy=!1;if(Ca){var om;if(Ca){var lm="oninput"in document;if(!lm){var fy=document.createElement("div");fy.setAttribute("oninput","return;"),lm=typeof fy.oninput=="function"}om=lm}else om=!1;hy=om&&(!document.documentMode||9<document.documentMode)}function my(){kc&&(kc.detachEvent("onpropertychange",gy),Rc=kc=null)}function gy(i){if(i.propertyName==="value"&&pu(Rc)){var l=[];dy(l,Rc,i,Ln(i)),jc(EE,l)}}function TE(i,l,h){i==="focusin"?(my(),kc=l,Rc=h,kc.attachEvent("onpropertychange",gy)):i==="focusout"&&my()}function AE(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return pu(Rc)}function CE(i,l){if(i==="click")return pu(l)}function kE(i,l){if(i==="input"||i==="change")return pu(l)}function RE(i,l){return i===l&&(i!==0||1/i===1/l)||i!==i&&l!==l}var fa=typeof Object.is=="function"?Object.is:RE;function Lc(i,l){if(fa(i,l))return!0;if(typeof i!="object"||i===null||typeof l!="object"||l===null)return!1;var h=Object.keys(i),p=Object.keys(l);if(h.length!==p.length)return!1;for(p=0;p<h.length;p++){var N=h[p];if(!Ce.call(l,N)||!fa(i[N],l[N]))return!1}return!0}function py(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function xy(i,l){var h=py(i);i=0;for(var p;h;){if(h.nodeType===3){if(p=i+h.textContent.length,i<=l&&p>=l)return{node:h,offset:l-i};i=p}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=py(h)}}function yy(i,l){return i&&l?i===l?!0:i&&i.nodeType===3?!1:l&&l.nodeType===3?yy(i,l.parentNode):"contains"in i?i.contains(l):i.compareDocumentPosition?!!(i.compareDocumentPosition(l)&16):!1:!1}function by(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var l=Ys(i.document);l instanceof i.HTMLIFrameElement;){try{var h=typeof l.contentWindow.location.href=="string"}catch{h=!1}if(h)i=l.contentWindow;else break;l=Ys(i.document)}return l}function cm(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l&&(l==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||l==="textarea"||i.contentEditable==="true")}var LE=Ca&&"documentMode"in document&&11>=document.documentMode,gl=null,dm=null,Dc=null,um=!1;function vy(i,l,h){var p=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;um||gl==null||gl!==Ys(p)||(p=gl,"selectionStart"in p&&cm(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Dc&&Lc(Dc,p)||(Dc=p,p=ah(dm,"onSelect"),0<p.length&&(l=new mu("onSelect","select",null,l,h),i.push({event:l,listeners:p}),l.target=gl)))}function yo(i,l){var h={};return h[i.toLowerCase()]=l.toLowerCase(),h["Webkit"+i]="webkit"+l,h["Moz"+i]="moz"+l,h}var pl={animationend:yo("Animation","AnimationEnd"),animationiteration:yo("Animation","AnimationIteration"),animationstart:yo("Animation","AnimationStart"),transitionrun:yo("Transition","TransitionRun"),transitionstart:yo("Transition","TransitionStart"),transitioncancel:yo("Transition","TransitionCancel"),transitionend:yo("Transition","TransitionEnd")},hm={},wy={};Ca&&(wy=document.createElement("div").style,"AnimationEvent"in window||(delete pl.animationend.animation,delete pl.animationiteration.animation,delete pl.animationstart.animation),"TransitionEvent"in window||delete pl.transitionend.transition);function bo(i){if(hm[i])return hm[i];if(!pl[i])return i;var l=pl[i],h;for(h in l)if(l.hasOwnProperty(h)&&h in wy)return hm[i]=l[h];return i}var Sy=bo("animationend"),_y=bo("animationiteration"),Ny=bo("animationstart"),DE=bo("transitionrun"),IE=bo("transitionstart"),ME=bo("transitioncancel"),jy=bo("transitionend"),Ey=new Map,fm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");fm.push("scrollEnd");function Ya(i,l){Ey.set(i,l),Je(l,[i])}var xu=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},ka=[],xl=0,mm=0;function yu(){for(var i=xl,l=mm=xl=0;l<i;){var h=ka[l];ka[l++]=null;var p=ka[l];ka[l++]=null;var N=ka[l];ka[l++]=null;var A=ka[l];if(ka[l++]=null,p!==null&&N!==null){var Y=p.pending;Y===null?N.next=N:(N.next=Y.next,Y.next=N),p.pending=N}A!==0&&Ty(h,N,A)}}function bu(i,l,h,p){ka[xl++]=i,ka[xl++]=l,ka[xl++]=h,ka[xl++]=p,mm|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function gm(i,l,h,p){return bu(i,l,h,p),vu(i)}function vo(i,l){return bu(i,null,null,l),vu(i)}function Ty(i,l,h){i.lanes|=h;var p=i.alternate;p!==null&&(p.lanes|=h);for(var N=!1,A=i.return;A!==null;)A.childLanes|=h,p=A.alternate,p!==null&&(p.childLanes|=h),A.tag===22&&(i=A.stateNode,i===null||i._visibility&1||(N=!0)),i=A,A=A.return;return i.tag===3?(A=i.stateNode,N&&l!==null&&(N=31-Fe(h),i=A.hiddenUpdates,p=i[N],p===null?i[N]=[l]:p.push(l),l.lane=h|536870912),A):null}function vu(i){if(50<td)throw td=0,N0=null,Error(r(185));for(var l=i.return;l!==null;)i=l,l=i.return;return i.tag===3?i.stateNode:null}var yl={};function PE(i,l,h,p){this.tag=i,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ma(i,l,h,p){return new PE(i,l,h,p)}function pm(i){return i=i.prototype,!(!i||!i.isReactComponent)}function In(i,l){var h=i.alternate;return h===null?(h=ma(i.tag,l,i.key,i.mode),h.elementType=i.elementType,h.type=i.type,h.stateNode=i.stateNode,h.alternate=i,i.alternate=h):(h.pendingProps=l,h.type=i.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=i.flags&65011712,h.childLanes=i.childLanes,h.lanes=i.lanes,h.child=i.child,h.memoizedProps=i.memoizedProps,h.memoizedState=i.memoizedState,h.updateQueue=i.updateQueue,l=i.dependencies,h.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},h.sibling=i.sibling,h.index=i.index,h.ref=i.ref,h.refCleanup=i.refCleanup,h}function Ay(i,l){i.flags&=65011714;var h=i.alternate;return h===null?(i.childLanes=0,i.lanes=l,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=h.childLanes,i.lanes=h.lanes,i.child=h.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=h.memoizedProps,i.memoizedState=h.memoizedState,i.updateQueue=h.updateQueue,i.type=h.type,l=h.dependencies,i.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),i}function wu(i,l,h,p,N,A){var Y=0;if(p=i,typeof i=="function")pm(i)&&(Y=1);else if(typeof i=="string")Y=$T(i,h,oe.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case U:return i=ma(31,h,l,N),i.elementType=U,i.lanes=A,i;case w:return wo(h.children,N,A,l);case S:Y=8,N|=24;break;case T:return i=ma(12,h,l,N|2),i.elementType=T,i.lanes=A,i;case K:return i=ma(13,h,l,N),i.elementType=K,i.lanes=A,i;case z:return i=ma(19,h,l,N),i.elementType=z,i.lanes=A,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case E:Y=10;break e;case k:Y=9;break e;case R:Y=11;break e;case D:Y=14;break e;case O:Y=16,p=null;break e}Y=29,h=Error(r(130,i===null?"null":typeof i,"")),p=null}return l=ma(Y,h,l,N),l.elementType=i,l.type=p,l.lanes=A,l}function wo(i,l,h,p){return i=ma(7,i,p,l),i.lanes=h,i}function xm(i,l,h){return i=ma(6,i,null,l),i.lanes=h,i}function Cy(i){var l=ma(18,null,null,0);return l.stateNode=i,l}function ym(i,l,h){return l=ma(4,i.children!==null?i.children:[],i.key,l),l.lanes=h,l.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},l}var ky=new WeakMap;function Ra(i,l){if(typeof i=="object"&&i!==null){var h=ky.get(i);return h!==void 0?h:(l={value:i,source:l,stack:He(l)},ky.set(i,l),l)}return{value:i,source:l,stack:He(l)}}var bl=[],vl=0,Su=null,Ic=0,La=[],Da=0,xi=null,dn=1,un="";function Mn(i,l){bl[vl++]=Ic,bl[vl++]=Su,Su=i,Ic=l}function Ry(i,l,h){La[Da++]=dn,La[Da++]=un,La[Da++]=xi,xi=i;var p=dn;i=un;var N=32-Fe(p)-1;p&=~(1<<N),h+=1;var A=32-Fe(l)+N;if(30<A){var Y=N-N%5;A=(p&(1<<Y)-1).toString(32),p>>=Y,N-=Y,dn=1<<32-Fe(l)+N|h<<N|p,un=A+i}else dn=1<<A|h<<N|p,un=i}function bm(i){i.return!==null&&(Mn(i,1),Ry(i,1,0))}function vm(i){for(;i===Su;)Su=bl[--vl],bl[vl]=null,Ic=bl[--vl],bl[vl]=null;for(;i===xi;)xi=La[--Da],La[Da]=null,un=La[--Da],La[Da]=null,dn=La[--Da],La[Da]=null}function Ly(i,l){La[Da++]=dn,La[Da++]=un,La[Da++]=xi,dn=l.id,un=l.overflow,xi=i}var Cr=null,Ws=null,bs=!1,yi=null,Ia=!1,wm=Error(r(519));function bi(i){var l=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Mc(Ra(l,i)),wm}function Dy(i){var l=i.stateNode,h=i.type,p=i.memoizedProps;switch(l[j]=i,l[_]=p,h){case"dialog":ms("cancel",l),ms("close",l);break;case"iframe":case"object":case"embed":ms("load",l);break;case"video":case"audio":for(h=0;h<rd.length;h++)ms(rd[h],l);break;case"source":ms("error",l);break;case"img":case"image":case"link":ms("error",l),ms("load",l);break;case"details":ms("toggle",l);break;case"input":ms("invalid",l),Nr(l,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":ms("invalid",l);break;case"textarea":ms("invalid",l),Aa(l,p.value,p.defaultValue,p.children)}h=p.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||l.textContent===""+h||p.suppressHydrationWarning===!0||Qv(l.textContent,h)?(p.popover!=null&&(ms("beforetoggle",l),ms("toggle",l)),p.onScroll!=null&&ms("scroll",l),p.onScrollEnd!=null&&ms("scrollend",l),p.onClick!=null&&(l.onclick=ha),l=!0):l=!1,l||bi(i,!0)}function Iy(i){for(Cr=i.return;Cr;)switch(Cr.tag){case 5:case 31:case 13:Ia=!1;return;case 27:case 3:Ia=!0;return;default:Cr=Cr.return}}function wl(i){if(i!==Cr)return!1;if(!bs)return Iy(i),bs=!0,!1;var l=i.tag,h;if((h=l!==3&&l!==27)&&((h=l===5)&&(h=i.type,h=!(h!=="form"&&h!=="button")||B0(i.type,i.memoizedProps)),h=!h),h&&Ws&&bi(i),Iy(i),l===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));Ws=nw(i)}else if(l===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));Ws=nw(i)}else l===27?(l=Ws,Di(i.type)?(i=V0,V0=null,Ws=i):Ws=l):Ws=Cr?Pa(i.stateNode.nextSibling):null;return!0}function So(){Ws=Cr=null,bs=!1}function Sm(){var i=yi;return i!==null&&(Jr===null?Jr=i:Jr.push.apply(Jr,i),yi=null),i}function Mc(i){yi===null?yi=[i]:yi.push(i)}var _m=V(null),_o=null,Pn=null;function vi(i,l,h){Z(_m,l._currentValue),l._currentValue=h}function On(i){i._currentValue=_m.current,G(_m)}function Nm(i,l,h){for(;i!==null;){var p=i.alternate;if((i.childLanes&l)!==l?(i.childLanes|=l,p!==null&&(p.childLanes|=l)):p!==null&&(p.childLanes&l)!==l&&(p.childLanes|=l),i===h)break;i=i.return}}function jm(i,l,h,p){var N=i.child;for(N!==null&&(N.return=i);N!==null;){var A=N.dependencies;if(A!==null){var Y=N.child;A=A.firstContext;e:for(;A!==null;){var ie=A;A=N;for(var Te=0;Te<l.length;Te++)if(ie.context===l[Te]){A.lanes|=h,ie=A.alternate,ie!==null&&(ie.lanes|=h),Nm(A.return,h,i),p||(Y=null);break e}A=ie.next}}else if(N.tag===18){if(Y=N.return,Y===null)throw Error(r(341));Y.lanes|=h,A=Y.alternate,A!==null&&(A.lanes|=h),Nm(Y,h,i),Y=null}else Y=N.child;if(Y!==null)Y.return=N;else for(Y=N;Y!==null;){if(Y===i){Y=null;break}if(N=Y.sibling,N!==null){N.return=Y.return,Y=N;break}Y=Y.return}N=Y}}function Sl(i,l,h,p){i=null;for(var N=l,A=!1;N!==null;){if(!A){if((N.flags&524288)!==0)A=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var Y=N.alternate;if(Y===null)throw Error(r(387));if(Y=Y.memoizedProps,Y!==null){var ie=N.type;fa(N.pendingProps.value,Y.value)||(i!==null?i.push(ie):i=[ie])}}else if(N===xe.current){if(Y=N.alternate,Y===null)throw Error(r(387));Y.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(i!==null?i.push(ld):i=[ld])}N=N.return}i!==null&&jm(l,i,h,p),l.flags|=262144}function _u(i){for(i=i.firstContext;i!==null;){if(!fa(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function No(i){_o=i,Pn=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function kr(i){return My(_o,i)}function Nu(i,l){return _o===null&&No(i),My(i,l)}function My(i,l){var h=l._currentValue;if(l={context:l,memoizedValue:h,next:null},Pn===null){if(i===null)throw Error(r(308));Pn=l,i.dependencies={lanes:0,firstContext:l},i.flags|=524288}else Pn=Pn.next=l;return h}var OE=typeof AbortController<"u"?AbortController:function(){var i=[],l=this.signal={aborted:!1,addEventListener:function(h,p){i.push(p)}};this.abort=function(){l.aborted=!0,i.forEach(function(h){return h()})}},FE=a.unstable_scheduleCallback,BE=a.unstable_NormalPriority,gr={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Em(){return{controller:new OE,data:new Map,refCount:0}}function Pc(i){i.refCount--,i.refCount===0&&FE(BE,function(){i.controller.abort()})}var Oc=null,Tm=0,_l=0,Nl=null;function UE(i,l){if(Oc===null){var h=Oc=[];Tm=0,_l=k0(),Nl={status:"pending",value:void 0,then:function(p){h.push(p)}}}return Tm++,l.then(Py,Py),l}function Py(){if(--Tm===0&&Oc!==null){Nl!==null&&(Nl.status="fulfilled");var i=Oc;Oc=null,_l=0,Nl=null;for(var l=0;l<i.length;l++)(0,i[l])()}}function $E(i,l){var h=[],p={status:"pending",value:null,reason:null,then:function(N){h.push(N)}};return i.then(function(){p.status="fulfilled",p.value=l;for(var N=0;N<h.length;N++)(0,h[N])(l)},function(N){for(p.status="rejected",p.reason=N,N=0;N<h.length;N++)(0,h[N])(void 0)}),p}var Oy=q.S;q.S=function(i,l){vv=nt(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&UE(i,l),Oy!==null&&Oy(i,l)};var jo=V(null);function Am(){var i=jo.current;return i!==null?i:$s.pooledCache}function ju(i,l){l===null?Z(jo,jo.current):Z(jo,l.pool)}function Fy(){var i=Am();return i===null?null:{parent:gr._currentValue,pool:i}}var jl=Error(r(460)),Cm=Error(r(474)),Eu=Error(r(542)),Tu={then:function(){}};function By(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Uy(i,l,h){switch(h=i[h],h===void 0?i.push(l):h!==l&&(l.then(ha,ha),l=h),l.status){case"fulfilled":return l.value;case"rejected":throw i=l.reason,Gy(i),i;default:if(typeof l.status=="string")l.then(ha,ha);else{if(i=$s,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=l,i.status="pending",i.then(function(p){if(l.status==="pending"){var N=l;N.status="fulfilled",N.value=p}},function(p){if(l.status==="pending"){var N=l;N.status="rejected",N.reason=p}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw i=l.reason,Gy(i),i}throw To=l,jl}}function Eo(i){try{var l=i._init;return l(i._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?(To=h,jl):h}}var To=null;function $y(){if(To===null)throw Error(r(459));var i=To;return To=null,i}function Gy(i){if(i===jl||i===Eu)throw Error(r(483))}var El=null,Fc=0;function Au(i){var l=Fc;return Fc+=1,El===null&&(El=[]),Uy(El,i,l)}function Bc(i,l){l=l.props.ref,i.ref=l!==void 0?l:null}function Cu(i,l){throw l.$$typeof===x?Error(r(525)):(i=Object.prototype.toString.call(l),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":i)))}function Hy(i){function l($e,Ie){if(i){var Ye=$e.deletions;Ye===null?($e.deletions=[Ie],$e.flags|=16):Ye.push(Ie)}}function h($e,Ie){if(!i)return null;for(;Ie!==null;)l($e,Ie),Ie=Ie.sibling;return null}function p($e){for(var Ie=new Map;$e!==null;)$e.key!==null?Ie.set($e.key,$e):Ie.set($e.index,$e),$e=$e.sibling;return Ie}function N($e,Ie){return $e=In($e,Ie),$e.index=0,$e.sibling=null,$e}function A($e,Ie,Ye){return $e.index=Ye,i?(Ye=$e.alternate,Ye!==null?(Ye=Ye.index,Ye<Ie?($e.flags|=67108866,Ie):Ye):($e.flags|=67108866,Ie)):($e.flags|=1048576,Ie)}function Y($e){return i&&$e.alternate===null&&($e.flags|=67108866),$e}function ie($e,Ie,Ye,ft){return Ie===null||Ie.tag!==6?(Ie=xm(Ye,$e.mode,ft),Ie.return=$e,Ie):(Ie=N(Ie,Ye),Ie.return=$e,Ie)}function Te($e,Ie,Ye,ft){var Gt=Ye.type;return Gt===w?ct($e,Ie,Ye.props.children,ft,Ye.key):Ie!==null&&(Ie.elementType===Gt||typeof Gt=="object"&&Gt!==null&&Gt.$$typeof===O&&Eo(Gt)===Ie.type)?(Ie=N(Ie,Ye.props),Bc(Ie,Ye),Ie.return=$e,Ie):(Ie=wu(Ye.type,Ye.key,Ye.props,null,$e.mode,ft),Bc(Ie,Ye),Ie.return=$e,Ie)}function We($e,Ie,Ye,ft){return Ie===null||Ie.tag!==4||Ie.stateNode.containerInfo!==Ye.containerInfo||Ie.stateNode.implementation!==Ye.implementation?(Ie=ym(Ye,$e.mode,ft),Ie.return=$e,Ie):(Ie=N(Ie,Ye.children||[]),Ie.return=$e,Ie)}function ct($e,Ie,Ye,ft,Gt){return Ie===null||Ie.tag!==7?(Ie=wo(Ye,$e.mode,ft,Gt),Ie.return=$e,Ie):(Ie=N(Ie,Ye),Ie.return=$e,Ie)}function pt($e,Ie,Ye){if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint")return Ie=xm(""+Ie,$e.mode,Ye),Ie.return=$e,Ie;if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case b:return Ye=wu(Ie.type,Ie.key,Ie.props,null,$e.mode,Ye),Bc(Ye,Ie),Ye.return=$e,Ye;case v:return Ie=ym(Ie,$e.mode,Ye),Ie.return=$e,Ie;case O:return Ie=Eo(Ie),pt($e,Ie,Ye)}if(X(Ie)||te(Ie))return Ie=wo(Ie,$e.mode,Ye,null),Ie.return=$e,Ie;if(typeof Ie.then=="function")return pt($e,Au(Ie),Ye);if(Ie.$$typeof===E)return pt($e,Nu($e,Ie),Ye);Cu($e,Ie)}return null}function Xe($e,Ie,Ye,ft){var Gt=Ie!==null?Ie.key:null;if(typeof Ye=="string"&&Ye!==""||typeof Ye=="number"||typeof Ye=="bigint")return Gt!==null?null:ie($e,Ie,""+Ye,ft);if(typeof Ye=="object"&&Ye!==null){switch(Ye.$$typeof){case b:return Ye.key===Gt?Te($e,Ie,Ye,ft):null;case v:return Ye.key===Gt?We($e,Ie,Ye,ft):null;case O:return Ye=Eo(Ye),Xe($e,Ie,Ye,ft)}if(X(Ye)||te(Ye))return Gt!==null?null:ct($e,Ie,Ye,ft,null);if(typeof Ye.then=="function")return Xe($e,Ie,Au(Ye),ft);if(Ye.$$typeof===E)return Xe($e,Ie,Nu($e,Ye),ft);Cu($e,Ye)}return null}function rt($e,Ie,Ye,ft,Gt){if(typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint")return $e=$e.get(Ye)||null,ie(Ie,$e,""+ft,Gt);if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case b:return $e=$e.get(ft.key===null?Ye:ft.key)||null,Te(Ie,$e,ft,Gt);case v:return $e=$e.get(ft.key===null?Ye:ft.key)||null,We(Ie,$e,ft,Gt);case O:return ft=Eo(ft),rt($e,Ie,Ye,ft,Gt)}if(X(ft)||te(ft))return $e=$e.get(Ye)||null,ct(Ie,$e,ft,Gt,null);if(typeof ft.then=="function")return rt($e,Ie,Ye,Au(ft),Gt);if(ft.$$typeof===E)return rt($e,Ie,Ye,Nu(Ie,ft),Gt);Cu(Ie,ft)}return null}function Lt($e,Ie,Ye,ft){for(var Gt=null,Ns=null,Ot=Ie,as=Ie=0,ps=null;Ot!==null&&as<Ye.length;as++){Ot.index>as?(ps=Ot,Ot=null):ps=Ot.sibling;var js=Xe($e,Ot,Ye[as],ft);if(js===null){Ot===null&&(Ot=ps);break}i&&Ot&&js.alternate===null&&l($e,Ot),Ie=A(js,Ie,as),Ns===null?Gt=js:Ns.sibling=js,Ns=js,Ot=ps}if(as===Ye.length)return h($e,Ot),bs&&Mn($e,as),Gt;if(Ot===null){for(;as<Ye.length;as++)Ot=pt($e,Ye[as],ft),Ot!==null&&(Ie=A(Ot,Ie,as),Ns===null?Gt=Ot:Ns.sibling=Ot,Ns=Ot);return bs&&Mn($e,as),Gt}for(Ot=p(Ot);as<Ye.length;as++)ps=rt(Ot,$e,as,Ye[as],ft),ps!==null&&(i&&ps.alternate!==null&&Ot.delete(ps.key===null?as:ps.key),Ie=A(ps,Ie,as),Ns===null?Gt=ps:Ns.sibling=ps,Ns=ps);return i&&Ot.forEach(function(Fi){return l($e,Fi)}),bs&&Mn($e,as),Gt}function zt($e,Ie,Ye,ft){if(Ye==null)throw Error(r(151));for(var Gt=null,Ns=null,Ot=Ie,as=Ie=0,ps=null,js=Ye.next();Ot!==null&&!js.done;as++,js=Ye.next()){Ot.index>as?(ps=Ot,Ot=null):ps=Ot.sibling;var Fi=Xe($e,Ot,js.value,ft);if(Fi===null){Ot===null&&(Ot=ps);break}i&&Ot&&Fi.alternate===null&&l($e,Ot),Ie=A(Fi,Ie,as),Ns===null?Gt=Fi:Ns.sibling=Fi,Ns=Fi,Ot=ps}if(js.done)return h($e,Ot),bs&&Mn($e,as),Gt;if(Ot===null){for(;!js.done;as++,js=Ye.next())js=pt($e,js.value,ft),js!==null&&(Ie=A(js,Ie,as),Ns===null?Gt=js:Ns.sibling=js,Ns=js);return bs&&Mn($e,as),Gt}for(Ot=p(Ot);!js.done;as++,js=Ye.next())js=rt(Ot,$e,as,js.value,ft),js!==null&&(i&&js.alternate!==null&&Ot.delete(js.key===null?as:js.key),Ie=A(js,Ie,as),Ns===null?Gt=js:Ns.sibling=js,Ns=js);return i&&Ot.forEach(function(ZT){return l($e,ZT)}),bs&&Mn($e,as),Gt}function Fs($e,Ie,Ye,ft){if(typeof Ye=="object"&&Ye!==null&&Ye.type===w&&Ye.key===null&&(Ye=Ye.props.children),typeof Ye=="object"&&Ye!==null){switch(Ye.$$typeof){case b:e:{for(var Gt=Ye.key;Ie!==null;){if(Ie.key===Gt){if(Gt=Ye.type,Gt===w){if(Ie.tag===7){h($e,Ie.sibling),ft=N(Ie,Ye.props.children),ft.return=$e,$e=ft;break e}}else if(Ie.elementType===Gt||typeof Gt=="object"&&Gt!==null&&Gt.$$typeof===O&&Eo(Gt)===Ie.type){h($e,Ie.sibling),ft=N(Ie,Ye.props),Bc(ft,Ye),ft.return=$e,$e=ft;break e}h($e,Ie);break}else l($e,Ie);Ie=Ie.sibling}Ye.type===w?(ft=wo(Ye.props.children,$e.mode,ft,Ye.key),ft.return=$e,$e=ft):(ft=wu(Ye.type,Ye.key,Ye.props,null,$e.mode,ft),Bc(ft,Ye),ft.return=$e,$e=ft)}return Y($e);case v:e:{for(Gt=Ye.key;Ie!==null;){if(Ie.key===Gt)if(Ie.tag===4&&Ie.stateNode.containerInfo===Ye.containerInfo&&Ie.stateNode.implementation===Ye.implementation){h($e,Ie.sibling),ft=N(Ie,Ye.children||[]),ft.return=$e,$e=ft;break e}else{h($e,Ie);break}else l($e,Ie);Ie=Ie.sibling}ft=ym(Ye,$e.mode,ft),ft.return=$e,$e=ft}return Y($e);case O:return Ye=Eo(Ye),Fs($e,Ie,Ye,ft)}if(X(Ye))return Lt($e,Ie,Ye,ft);if(te(Ye)){if(Gt=te(Ye),typeof Gt!="function")throw Error(r(150));return Ye=Gt.call(Ye),zt($e,Ie,Ye,ft)}if(typeof Ye.then=="function")return Fs($e,Ie,Au(Ye),ft);if(Ye.$$typeof===E)return Fs($e,Ie,Nu($e,Ye),ft);Cu($e,Ye)}return typeof Ye=="string"&&Ye!==""||typeof Ye=="number"||typeof Ye=="bigint"?(Ye=""+Ye,Ie!==null&&Ie.tag===6?(h($e,Ie.sibling),ft=N(Ie,Ye),ft.return=$e,$e=ft):(h($e,Ie),ft=xm(Ye,$e.mode,ft),ft.return=$e,$e=ft),Y($e)):h($e,Ie)}return function($e,Ie,Ye,ft){try{Fc=0;var Gt=Fs($e,Ie,Ye,ft);return El=null,Gt}catch(Ot){if(Ot===jl||Ot===Eu)throw Ot;var Ns=ma(29,Ot,null,$e.mode);return Ns.lanes=ft,Ns.return=$e,Ns}finally{}}}var Ao=Hy(!0),Vy=Hy(!1),wi=!1;function km(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Rm(i,l){i=i.updateQueue,l.updateQueue===i&&(l.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Si(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function _i(i,l,h){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(Ts&2)!==0){var N=p.pending;return N===null?l.next=l:(l.next=N.next,N.next=l),p.pending=l,l=vu(i),Ty(i,null,h),l}return bu(i,p,l,h),vu(i)}function Uc(i,l,h){if(l=l.updateQueue,l!==null&&(l=l.shared,(h&4194048)!==0)){var p=l.lanes;p&=i.pendingLanes,h|=p,l.lanes=h,vt(i,h)}}function Lm(i,l){var h=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,h===p)){var N=null,A=null;if(h=h.firstBaseUpdate,h!==null){do{var Y={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};A===null?N=A=Y:A=A.next=Y,h=h.next}while(h!==null);A===null?N=A=l:A=A.next=l}else N=A=l;h={baseState:p.baseState,firstBaseUpdate:N,lastBaseUpdate:A,shared:p.shared,callbacks:p.callbacks},i.updateQueue=h;return}i=h.lastBaseUpdate,i===null?h.firstBaseUpdate=l:i.next=l,h.lastBaseUpdate=l}var Dm=!1;function $c(){if(Dm){var i=Nl;if(i!==null)throw i}}function Gc(i,l,h,p){Dm=!1;var N=i.updateQueue;wi=!1;var A=N.firstBaseUpdate,Y=N.lastBaseUpdate,ie=N.shared.pending;if(ie!==null){N.shared.pending=null;var Te=ie,We=Te.next;Te.next=null,Y===null?A=We:Y.next=We,Y=Te;var ct=i.alternate;ct!==null&&(ct=ct.updateQueue,ie=ct.lastBaseUpdate,ie!==Y&&(ie===null?ct.firstBaseUpdate=We:ie.next=We,ct.lastBaseUpdate=Te))}if(A!==null){var pt=N.baseState;Y=0,ct=We=Te=null,ie=A;do{var Xe=ie.lane&-536870913,rt=Xe!==ie.lane;if(rt?(gs&Xe)===Xe:(p&Xe)===Xe){Xe!==0&&Xe===_l&&(Dm=!0),ct!==null&&(ct=ct.next={lane:0,tag:ie.tag,payload:ie.payload,callback:null,next:null});e:{var Lt=i,zt=ie;Xe=l;var Fs=h;switch(zt.tag){case 1:if(Lt=zt.payload,typeof Lt=="function"){pt=Lt.call(Fs,pt,Xe);break e}pt=Lt;break e;case 3:Lt.flags=Lt.flags&-65537|128;case 0:if(Lt=zt.payload,Xe=typeof Lt=="function"?Lt.call(Fs,pt,Xe):Lt,Xe==null)break e;pt=g({},pt,Xe);break e;case 2:wi=!0}}Xe=ie.callback,Xe!==null&&(i.flags|=64,rt&&(i.flags|=8192),rt=N.callbacks,rt===null?N.callbacks=[Xe]:rt.push(Xe))}else rt={lane:Xe,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null},ct===null?(We=ct=rt,Te=pt):ct=ct.next=rt,Y|=Xe;if(ie=ie.next,ie===null){if(ie=N.shared.pending,ie===null)break;rt=ie,ie=rt.next,rt.next=null,N.lastBaseUpdate=rt,N.shared.pending=null}}while(!0);ct===null&&(Te=pt),N.baseState=Te,N.firstBaseUpdate=We,N.lastBaseUpdate=ct,A===null&&(N.shared.lanes=0),Ai|=Y,i.lanes=Y,i.memoizedState=pt}}function zy(i,l){if(typeof i!="function")throw Error(r(191,i));i.call(l)}function qy(i,l){var h=i.callbacks;if(h!==null)for(i.callbacks=null,i=0;i<h.length;i++)zy(h[i],l)}var Tl=V(null),ku=V(0);function Ky(i,l){i=qn,Z(ku,i),Z(Tl,l),qn=i|l.baseLanes}function Im(){Z(ku,qn),Z(Tl,Tl.current)}function Mm(){qn=ku.current,G(Tl),G(ku)}var ga=V(null),Ma=null;function Ni(i){var l=i.alternate;Z(lr,lr.current&1),Z(ga,i),Ma===null&&(l===null||Tl.current!==null||l.memoizedState!==null)&&(Ma=i)}function Pm(i){Z(lr,lr.current),Z(ga,i),Ma===null&&(Ma=i)}function Yy(i){i.tag===22?(Z(lr,lr.current),Z(ga,i),Ma===null&&(Ma=i)):ji()}function ji(){Z(lr,lr.current),Z(ga,ga.current)}function pa(i){G(ga),Ma===i&&(Ma=null),G(lr)}var lr=V(0);function Ru(i){for(var l=i;l!==null;){if(l.tag===13){var h=l.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||G0(h)||H0(h)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Fn=0,ts=null,Ps=null,pr=null,Lu=!1,Al=!1,Co=!1,Du=0,Hc=0,Cl=null,GE=0;function ar(){throw Error(r(321))}function Om(i,l){if(l===null)return!1;for(var h=0;h<l.length&&h<i.length;h++)if(!fa(i[h],l[h]))return!1;return!0}function Fm(i,l,h,p,N,A){return Fn=A,ts=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,q.H=i===null||i.memoizedState===null?Rb:Jm,Co=!1,A=h(p,N),Co=!1,Al&&(A=Qy(l,h,p,N)),Wy(i),A}function Wy(i){q.H=qc;var l=Ps!==null&&Ps.next!==null;if(Fn=0,pr=Ps=ts=null,Lu=!1,Hc=0,Cl=null,l)throw Error(r(300));i===null||xr||(i=i.dependencies,i!==null&&_u(i)&&(xr=!0))}function Qy(i,l,h,p){ts=i;var N=0;do{if(Al&&(Cl=null),Hc=0,Al=!1,25<=N)throw Error(r(301));if(N+=1,pr=Ps=null,i.updateQueue!=null){var A=i.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}q.H=Lb,A=l(h,p)}while(Al);return A}function HE(){var i=q.H,l=i.useState()[0];return l=typeof l.then=="function"?Vc(l):l,i=i.useState()[0],(Ps!==null?Ps.memoizedState:null)!==i&&(ts.flags|=1024),l}function Bm(){var i=Du!==0;return Du=0,i}function Um(i,l,h){l.updateQueue=i.updateQueue,l.flags&=-2053,i.lanes&=~h}function $m(i){if(Lu){for(i=i.memoizedState;i!==null;){var l=i.queue;l!==null&&(l.pending=null),i=i.next}Lu=!1}Fn=0,pr=Ps=ts=null,Al=!1,Hc=Du=0,Cl=null}function Gr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pr===null?ts.memoizedState=pr=i:pr=pr.next=i,pr}function cr(){if(Ps===null){var i=ts.alternate;i=i!==null?i.memoizedState:null}else i=Ps.next;var l=pr===null?ts.memoizedState:pr.next;if(l!==null)pr=l,Ps=i;else{if(i===null)throw ts.alternate===null?Error(r(467)):Error(r(310));Ps=i,i={memoizedState:Ps.memoizedState,baseState:Ps.baseState,baseQueue:Ps.baseQueue,queue:Ps.queue,next:null},pr===null?ts.memoizedState=pr=i:pr=pr.next=i}return pr}function Iu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Vc(i){var l=Hc;return Hc+=1,Cl===null&&(Cl=[]),i=Uy(Cl,i,l),l=ts,(pr===null?l.memoizedState:pr.next)===null&&(l=l.alternate,q.H=l===null||l.memoizedState===null?Rb:Jm),i}function Mu(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Vc(i);if(i.$$typeof===E)return kr(i)}throw Error(r(438,String(i)))}function Gm(i){var l=null,h=ts.updateQueue;if(h!==null&&(l=h.memoCache),l==null){var p=ts.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(l={data:p.data.map(function(N){return N.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),h===null&&(h=Iu(),ts.updateQueue=h),h.memoCache=l,h=l.data[l.index],h===void 0)for(h=l.data[l.index]=Array(i),p=0;p<i;p++)h[p]=I;return l.index++,h}function Bn(i,l){return typeof l=="function"?l(i):l}function Pu(i){var l=cr();return Hm(l,Ps,i)}function Hm(i,l,h){var p=i.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=h;var N=i.baseQueue,A=p.pending;if(A!==null){if(N!==null){var Y=N.next;N.next=A.next,A.next=Y}l.baseQueue=N=A,p.pending=null}if(A=i.baseState,N===null)i.memoizedState=A;else{l=N.next;var ie=Y=null,Te=null,We=l,ct=!1;do{var pt=We.lane&-536870913;if(pt!==We.lane?(gs&pt)===pt:(Fn&pt)===pt){var Xe=We.revertLane;if(Xe===0)Te!==null&&(Te=Te.next={lane:0,revertLane:0,gesture:null,action:We.action,hasEagerState:We.hasEagerState,eagerState:We.eagerState,next:null}),pt===_l&&(ct=!0);else if((Fn&Xe)===Xe){We=We.next,Xe===_l&&(ct=!0);continue}else pt={lane:0,revertLane:We.revertLane,gesture:null,action:We.action,hasEagerState:We.hasEagerState,eagerState:We.eagerState,next:null},Te===null?(ie=Te=pt,Y=A):Te=Te.next=pt,ts.lanes|=Xe,Ai|=Xe;pt=We.action,Co&&h(A,pt),A=We.hasEagerState?We.eagerState:h(A,pt)}else Xe={lane:pt,revertLane:We.revertLane,gesture:We.gesture,action:We.action,hasEagerState:We.hasEagerState,eagerState:We.eagerState,next:null},Te===null?(ie=Te=Xe,Y=A):Te=Te.next=Xe,ts.lanes|=pt,Ai|=pt;We=We.next}while(We!==null&&We!==l);if(Te===null?Y=A:Te.next=ie,!fa(A,i.memoizedState)&&(xr=!0,ct&&(h=Nl,h!==null)))throw h;i.memoizedState=A,i.baseState=Y,i.baseQueue=Te,p.lastRenderedState=A}return N===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function Vm(i){var l=cr(),h=l.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=i;var p=h.dispatch,N=h.pending,A=l.memoizedState;if(N!==null){h.pending=null;var Y=N=N.next;do A=i(A,Y.action),Y=Y.next;while(Y!==N);fa(A,l.memoizedState)||(xr=!0),l.memoizedState=A,l.baseQueue===null&&(l.baseState=A),h.lastRenderedState=A}return[A,p]}function Xy(i,l,h){var p=ts,N=cr(),A=bs;if(A){if(h===void 0)throw Error(r(407));h=h()}else h=l();var Y=!fa((Ps||N).memoizedState,h);if(Y&&(N.memoizedState=h,xr=!0),N=N.queue,Km(eb.bind(null,p,N,i),[i]),N.getSnapshot!==l||Y||pr!==null&&pr.memoizedState.tag&1){if(p.flags|=2048,kl(9,{destroy:void 0},Jy.bind(null,p,N,h,l),null),$s===null)throw Error(r(349));A||(Fn&127)!==0||Zy(p,l,h)}return h}function Zy(i,l,h){i.flags|=16384,i={getSnapshot:l,value:h},l=ts.updateQueue,l===null?(l=Iu(),ts.updateQueue=l,l.stores=[i]):(h=l.stores,h===null?l.stores=[i]:h.push(i))}function Jy(i,l,h,p){l.value=h,l.getSnapshot=p,tb(l)&&sb(i)}function eb(i,l,h){return h(function(){tb(l)&&sb(i)})}function tb(i){var l=i.getSnapshot;i=i.value;try{var h=l();return!fa(i,h)}catch{return!0}}function sb(i){var l=vo(i,2);l!==null&&ea(l,i,2)}function zm(i){var l=Gr();if(typeof i=="function"){var h=i;if(i=h(),Co){ue(!0);try{h()}finally{ue(!1)}}}return l.memoizedState=l.baseState=i,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bn,lastRenderedState:i},l}function rb(i,l,h,p){return i.baseState=h,Hm(i,Ps,typeof p=="function"?p:Bn)}function VE(i,l,h,p,N){if(Bu(i))throw Error(r(485));if(i=l.action,i!==null){var A={payload:N,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Y){A.listeners.push(Y)}};q.T!==null?h(!0):A.isTransition=!1,p(A),h=l.pending,h===null?(A.next=l.pending=A,ab(l,A)):(A.next=h.next,l.pending=h.next=A)}}function ab(i,l){var h=l.action,p=l.payload,N=i.state;if(l.isTransition){var A=q.T,Y={};q.T=Y;try{var ie=h(N,p),Te=q.S;Te!==null&&Te(Y,ie),nb(i,l,ie)}catch(We){qm(i,l,We)}finally{A!==null&&Y.types!==null&&(A.types=Y.types),q.T=A}}else try{A=h(N,p),nb(i,l,A)}catch(We){qm(i,l,We)}}function nb(i,l,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(p){ib(i,l,p)},function(p){return qm(i,l,p)}):ib(i,l,h)}function ib(i,l,h){l.status="fulfilled",l.value=h,ob(l),i.state=h,l=i.pending,l!==null&&(h=l.next,h===l?i.pending=null:(h=h.next,l.next=h,ab(i,h)))}function qm(i,l,h){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do l.status="rejected",l.reason=h,ob(l),l=l.next;while(l!==p)}i.action=null}function ob(i){i=i.listeners;for(var l=0;l<i.length;l++)(0,i[l])()}function lb(i,l){return l}function cb(i,l){if(bs){var h=$s.formState;if(h!==null){e:{var p=ts;if(bs){if(Ws){t:{for(var N=Ws,A=Ia;N.nodeType!==8;){if(!A){N=null;break t}if(N=Pa(N.nextSibling),N===null){N=null;break t}}A=N.data,N=A==="F!"||A==="F"?N:null}if(N){Ws=Pa(N.nextSibling),p=N.data==="F!";break e}}bi(p)}p=!1}p&&(l=h[0])}}return h=Gr(),h.memoizedState=h.baseState=l,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:lb,lastRenderedState:l},h.queue=p,h=Ab.bind(null,ts,p),p.dispatch=h,p=zm(!1),A=Zm.bind(null,ts,!1,p.queue),p=Gr(),N={state:l,dispatch:null,action:i,pending:null},p.queue=N,h=VE.bind(null,ts,N,A,h),N.dispatch=h,p.memoizedState=i,[l,h,!1]}function db(i){var l=cr();return ub(l,Ps,i)}function ub(i,l,h){if(l=Hm(i,l,lb)[0],i=Pu(Bn)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var p=Vc(l)}catch(Y){throw Y===jl?Eu:Y}else p=l;l=cr();var N=l.queue,A=N.dispatch;return h!==l.memoizedState&&(ts.flags|=2048,kl(9,{destroy:void 0},zE.bind(null,N,h),null)),[p,A,i]}function zE(i,l){i.action=l}function hb(i){var l=cr(),h=Ps;if(h!==null)return ub(l,h,i);cr(),l=l.memoizedState,h=cr();var p=h.queue.dispatch;return h.memoizedState=i,[l,p,!1]}function kl(i,l,h,p){return i={tag:i,create:h,deps:p,inst:l,next:null},l=ts.updateQueue,l===null&&(l=Iu(),ts.updateQueue=l),h=l.lastEffect,h===null?l.lastEffect=i.next=i:(p=h.next,h.next=i,i.next=p,l.lastEffect=i),i}function fb(){return cr().memoizedState}function Ou(i,l,h,p){var N=Gr();ts.flags|=i,N.memoizedState=kl(1|l,{destroy:void 0},h,p===void 0?null:p)}function Fu(i,l,h,p){var N=cr();p=p===void 0?null:p;var A=N.memoizedState.inst;Ps!==null&&p!==null&&Om(p,Ps.memoizedState.deps)?N.memoizedState=kl(l,A,h,p):(ts.flags|=i,N.memoizedState=kl(1|l,A,h,p))}function mb(i,l){Ou(8390656,8,i,l)}function Km(i,l){Fu(2048,8,i,l)}function qE(i){ts.flags|=4;var l=ts.updateQueue;if(l===null)l=Iu(),ts.updateQueue=l,l.events=[i];else{var h=l.events;h===null?l.events=[i]:h.push(i)}}function gb(i){var l=cr().memoizedState;return qE({ref:l,nextImpl:i}),function(){if((Ts&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}function pb(i,l){return Fu(4,2,i,l)}function xb(i,l){return Fu(4,4,i,l)}function yb(i,l){if(typeof l=="function"){i=i();var h=l(i);return function(){typeof h=="function"?h():l(null)}}if(l!=null)return i=i(),l.current=i,function(){l.current=null}}function bb(i,l,h){h=h!=null?h.concat([i]):null,Fu(4,4,yb.bind(null,l,i),h)}function Ym(){}function vb(i,l){var h=cr();l=l===void 0?null:l;var p=h.memoizedState;return l!==null&&Om(l,p[1])?p[0]:(h.memoizedState=[i,l],i)}function wb(i,l){var h=cr();l=l===void 0?null:l;var p=h.memoizedState;if(l!==null&&Om(l,p[1]))return p[0];if(p=i(),Co){ue(!0);try{i()}finally{ue(!1)}}return h.memoizedState=[p,l],p}function Wm(i,l,h){return h===void 0||(Fn&1073741824)!==0&&(gs&261930)===0?i.memoizedState=l:(i.memoizedState=h,i=Sv(),ts.lanes|=i,Ai|=i,h)}function Sb(i,l,h,p){return fa(h,l)?h:Tl.current!==null?(i=Wm(i,h,p),fa(i,l)||(xr=!0),i):(Fn&42)===0||(Fn&1073741824)!==0&&(gs&261930)===0?(xr=!0,i.memoizedState=h):(i=Sv(),ts.lanes|=i,Ai|=i,l)}function _b(i,l,h,p,N){var A=ae.p;ae.p=A!==0&&8>A?A:8;var Y=q.T,ie={};q.T=ie,Zm(i,!1,l,h);try{var Te=N(),We=q.S;if(We!==null&&We(ie,Te),Te!==null&&typeof Te=="object"&&typeof Te.then=="function"){var ct=$E(Te,p);zc(i,l,ct,ba(i))}else zc(i,l,p,ba(i))}catch(pt){zc(i,l,{then:function(){},status:"rejected",reason:pt},ba())}finally{ae.p=A,Y!==null&&ie.types!==null&&(Y.types=ie.types),q.T=Y}}function KE(){}function Qm(i,l,h,p){if(i.tag!==5)throw Error(r(476));var N=Nb(i).queue;_b(i,N,l,ce,h===null?KE:function(){return jb(i),h(p)})}function Nb(i){var l=i.memoizedState;if(l!==null)return l;l={memoizedState:ce,baseState:ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bn,lastRenderedState:ce},next:null};var h={};return l.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bn,lastRenderedState:h},next:null},i.memoizedState=l,i=i.alternate,i!==null&&(i.memoizedState=l),l}function jb(i){var l=Nb(i);l.next===null&&(l=i.alternate.memoizedState),zc(i,l.next.queue,{},ba())}function Xm(){return kr(ld)}function Eb(){return cr().memoizedState}function Tb(){return cr().memoizedState}function YE(i){for(var l=i.return;l!==null;){switch(l.tag){case 24:case 3:var h=ba();i=Si(h);var p=_i(l,i,h);p!==null&&(ea(p,l,h),Uc(p,l,h)),l={cache:Em()},i.payload=l;return}l=l.return}}function WE(i,l,h){var p=ba();h={lane:p,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Bu(i)?Cb(l,h):(h=gm(i,l,h,p),h!==null&&(ea(h,i,p),kb(h,l,p)))}function Ab(i,l,h){var p=ba();zc(i,l,h,p)}function zc(i,l,h,p){var N={lane:p,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(Bu(i))Cb(l,N);else{var A=i.alternate;if(i.lanes===0&&(A===null||A.lanes===0)&&(A=l.lastRenderedReducer,A!==null))try{var Y=l.lastRenderedState,ie=A(Y,h);if(N.hasEagerState=!0,N.eagerState=ie,fa(ie,Y))return bu(i,l,N,0),$s===null&&yu(),!1}catch{}finally{}if(h=gm(i,l,N,p),h!==null)return ea(h,i,p),kb(h,l,p),!0}return!1}function Zm(i,l,h,p){if(p={lane:2,revertLane:k0(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Bu(i)){if(l)throw Error(r(479))}else l=gm(i,h,p,2),l!==null&&ea(l,i,2)}function Bu(i){var l=i.alternate;return i===ts||l!==null&&l===ts}function Cb(i,l){Al=Lu=!0;var h=i.pending;h===null?l.next=l:(l.next=h.next,h.next=l),i.pending=l}function kb(i,l,h){if((h&4194048)!==0){var p=l.lanes;p&=i.pendingLanes,h|=p,l.lanes=h,vt(i,h)}}var qc={readContext:kr,use:Mu,useCallback:ar,useContext:ar,useEffect:ar,useImperativeHandle:ar,useLayoutEffect:ar,useInsertionEffect:ar,useMemo:ar,useReducer:ar,useRef:ar,useState:ar,useDebugValue:ar,useDeferredValue:ar,useTransition:ar,useSyncExternalStore:ar,useId:ar,useHostTransitionStatus:ar,useFormState:ar,useActionState:ar,useOptimistic:ar,useMemoCache:ar,useCacheRefresh:ar};qc.useEffectEvent=ar;var Rb={readContext:kr,use:Mu,useCallback:function(i,l){return Gr().memoizedState=[i,l===void 0?null:l],i},useContext:kr,useEffect:mb,useImperativeHandle:function(i,l,h){h=h!=null?h.concat([i]):null,Ou(4194308,4,yb.bind(null,l,i),h)},useLayoutEffect:function(i,l){return Ou(4194308,4,i,l)},useInsertionEffect:function(i,l){Ou(4,2,i,l)},useMemo:function(i,l){var h=Gr();l=l===void 0?null:l;var p=i();if(Co){ue(!0);try{i()}finally{ue(!1)}}return h.memoizedState=[p,l],p},useReducer:function(i,l,h){var p=Gr();if(h!==void 0){var N=h(l);if(Co){ue(!0);try{h(l)}finally{ue(!1)}}}else N=l;return p.memoizedState=p.baseState=N,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:N},p.queue=i,i=i.dispatch=WE.bind(null,ts,i),[p.memoizedState,i]},useRef:function(i){var l=Gr();return i={current:i},l.memoizedState=i},useState:function(i){i=zm(i);var l=i.queue,h=Ab.bind(null,ts,l);return l.dispatch=h,[i.memoizedState,h]},useDebugValue:Ym,useDeferredValue:function(i,l){var h=Gr();return Wm(h,i,l)},useTransition:function(){var i=zm(!1);return i=_b.bind(null,ts,i.queue,!0,!1),Gr().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,l,h){var p=ts,N=Gr();if(bs){if(h===void 0)throw Error(r(407));h=h()}else{if(h=l(),$s===null)throw Error(r(349));(gs&127)!==0||Zy(p,l,h)}N.memoizedState=h;var A={value:h,getSnapshot:l};return N.queue=A,mb(eb.bind(null,p,A,i),[i]),p.flags|=2048,kl(9,{destroy:void 0},Jy.bind(null,p,A,h,l),null),h},useId:function(){var i=Gr(),l=$s.identifierPrefix;if(bs){var h=un,p=dn;h=(p&~(1<<32-Fe(p)-1)).toString(32)+h,l="_"+l+"R_"+h,h=Du++,0<h&&(l+="H"+h.toString(32)),l+="_"}else h=GE++,l="_"+l+"r_"+h.toString(32)+"_";return i.memoizedState=l},useHostTransitionStatus:Xm,useFormState:cb,useActionState:cb,useOptimistic:function(i){var l=Gr();l.memoizedState=l.baseState=i;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=h,l=Zm.bind(null,ts,!0,h),h.dispatch=l,[i,l]},useMemoCache:Gm,useCacheRefresh:function(){return Gr().memoizedState=YE.bind(null,ts)},useEffectEvent:function(i){var l=Gr(),h={impl:i};return l.memoizedState=h,function(){if((Ts&2)!==0)throw Error(r(440));return h.impl.apply(void 0,arguments)}}},Jm={readContext:kr,use:Mu,useCallback:vb,useContext:kr,useEffect:Km,useImperativeHandle:bb,useInsertionEffect:pb,useLayoutEffect:xb,useMemo:wb,useReducer:Pu,useRef:fb,useState:function(){return Pu(Bn)},useDebugValue:Ym,useDeferredValue:function(i,l){var h=cr();return Sb(h,Ps.memoizedState,i,l)},useTransition:function(){var i=Pu(Bn)[0],l=cr().memoizedState;return[typeof i=="boolean"?i:Vc(i),l]},useSyncExternalStore:Xy,useId:Eb,useHostTransitionStatus:Xm,useFormState:db,useActionState:db,useOptimistic:function(i,l){var h=cr();return rb(h,Ps,i,l)},useMemoCache:Gm,useCacheRefresh:Tb};Jm.useEffectEvent=gb;var Lb={readContext:kr,use:Mu,useCallback:vb,useContext:kr,useEffect:Km,useImperativeHandle:bb,useInsertionEffect:pb,useLayoutEffect:xb,useMemo:wb,useReducer:Vm,useRef:fb,useState:function(){return Vm(Bn)},useDebugValue:Ym,useDeferredValue:function(i,l){var h=cr();return Ps===null?Wm(h,i,l):Sb(h,Ps.memoizedState,i,l)},useTransition:function(){var i=Vm(Bn)[0],l=cr().memoizedState;return[typeof i=="boolean"?i:Vc(i),l]},useSyncExternalStore:Xy,useId:Eb,useHostTransitionStatus:Xm,useFormState:hb,useActionState:hb,useOptimistic:function(i,l){var h=cr();return Ps!==null?rb(h,Ps,i,l):(h.baseState=i,[i,h.queue.dispatch])},useMemoCache:Gm,useCacheRefresh:Tb};Lb.useEffectEvent=gb;function e0(i,l,h,p){l=i.memoizedState,h=h(p,l),h=h==null?l:g({},l,h),i.memoizedState=h,i.lanes===0&&(i.updateQueue.baseState=h)}var t0={enqueueSetState:function(i,l,h){i=i._reactInternals;var p=ba(),N=Si(p);N.payload=l,h!=null&&(N.callback=h),l=_i(i,N,p),l!==null&&(ea(l,i,p),Uc(l,i,p))},enqueueReplaceState:function(i,l,h){i=i._reactInternals;var p=ba(),N=Si(p);N.tag=1,N.payload=l,h!=null&&(N.callback=h),l=_i(i,N,p),l!==null&&(ea(l,i,p),Uc(l,i,p))},enqueueForceUpdate:function(i,l){i=i._reactInternals;var h=ba(),p=Si(h);p.tag=2,l!=null&&(p.callback=l),l=_i(i,p,h),l!==null&&(ea(l,i,h),Uc(l,i,h))}};function Db(i,l,h,p,N,A,Y){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,A,Y):l.prototype&&l.prototype.isPureReactComponent?!Lc(h,p)||!Lc(N,A):!0}function Ib(i,l,h,p){i=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(h,p),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(h,p),l.state!==i&&t0.enqueueReplaceState(l,l.state,null)}function ko(i,l){var h=l;if("ref"in l){h={};for(var p in l)p!=="ref"&&(h[p]=l[p])}if(i=i.defaultProps){h===l&&(h=g({},h));for(var N in i)h[N]===void 0&&(h[N]=i[N])}return h}function Mb(i){xu(i)}function Pb(i){console.error(i)}function Ob(i){xu(i)}function Uu(i,l){try{var h=i.onUncaughtError;h(l.value,{componentStack:l.stack})}catch(p){setTimeout(function(){throw p})}}function Fb(i,l,h){try{var p=i.onCaughtError;p(h.value,{componentStack:h.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function s0(i,l,h){return h=Si(h),h.tag=3,h.payload={element:null},h.callback=function(){Uu(i,l)},h}function Bb(i){return i=Si(i),i.tag=3,i}function Ub(i,l,h,p){var N=h.type.getDerivedStateFromError;if(typeof N=="function"){var A=p.value;i.payload=function(){return N(A)},i.callback=function(){Fb(l,h,p)}}var Y=h.stateNode;Y!==null&&typeof Y.componentDidCatch=="function"&&(i.callback=function(){Fb(l,h,p),typeof N!="function"&&(Ci===null?Ci=new Set([this]):Ci.add(this));var ie=p.stack;this.componentDidCatch(p.value,{componentStack:ie!==null?ie:""})})}function QE(i,l,h,p,N){if(h.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(l=h.alternate,l!==null&&Sl(l,h,N,!0),h=ga.current,h!==null){switch(h.tag){case 31:case 13:return Ma===null?Zu():h.alternate===null&&nr===0&&(nr=3),h.flags&=-257,h.flags|=65536,h.lanes=N,p===Tu?h.flags|=16384:(l=h.updateQueue,l===null?h.updateQueue=new Set([p]):l.add(p),T0(i,p,N)),!1;case 22:return h.flags|=65536,p===Tu?h.flags|=16384:(l=h.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([p])},h.updateQueue=l):(h=l.retryQueue,h===null?l.retryQueue=new Set([p]):h.add(p)),T0(i,p,N)),!1}throw Error(r(435,h.tag))}return T0(i,p,N),Zu(),!1}if(bs)return l=ga.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=N,p!==wm&&(i=Error(r(422),{cause:p}),Mc(Ra(i,h)))):(p!==wm&&(l=Error(r(423),{cause:p}),Mc(Ra(l,h))),i=i.current.alternate,i.flags|=65536,N&=-N,i.lanes|=N,p=Ra(p,h),N=s0(i.stateNode,p,N),Lm(i,N),nr!==4&&(nr=2)),!1;var A=Error(r(520),{cause:p});if(A=Ra(A,h),ed===null?ed=[A]:ed.push(A),nr!==4&&(nr=2),l===null)return!0;p=Ra(p,h),h=l;do{switch(h.tag){case 3:return h.flags|=65536,i=N&-N,h.lanes|=i,i=s0(h.stateNode,p,i),Lm(h,i),!1;case 1:if(l=h.type,A=h.stateNode,(h.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Ci===null||!Ci.has(A))))return h.flags|=65536,N&=-N,h.lanes|=N,N=Bb(N),Ub(N,i,h,p),Lm(h,N),!1}h=h.return}while(h!==null);return!1}var r0=Error(r(461)),xr=!1;function Rr(i,l,h,p){l.child=i===null?Vy(l,null,h,p):Ao(l,i.child,h,p)}function $b(i,l,h,p,N){h=h.render;var A=l.ref;if("ref"in p){var Y={};for(var ie in p)ie!=="ref"&&(Y[ie]=p[ie])}else Y=p;return No(l),p=Fm(i,l,h,Y,A,N),ie=Bm(),i!==null&&!xr?(Um(i,l,N),Un(i,l,N)):(bs&&ie&&bm(l),l.flags|=1,Rr(i,l,p,N),l.child)}function Gb(i,l,h,p,N){if(i===null){var A=h.type;return typeof A=="function"&&!pm(A)&&A.defaultProps===void 0&&h.compare===null?(l.tag=15,l.type=A,Hb(i,l,A,p,N)):(i=wu(h.type,null,p,l,l.mode,N),i.ref=l.ref,i.return=l,l.child=i)}if(A=i.child,!u0(i,N)){var Y=A.memoizedProps;if(h=h.compare,h=h!==null?h:Lc,h(Y,p)&&i.ref===l.ref)return Un(i,l,N)}return l.flags|=1,i=In(A,p),i.ref=l.ref,i.return=l,l.child=i}function Hb(i,l,h,p,N){if(i!==null){var A=i.memoizedProps;if(Lc(A,p)&&i.ref===l.ref)if(xr=!1,l.pendingProps=p=A,u0(i,N))(i.flags&131072)!==0&&(xr=!0);else return l.lanes=i.lanes,Un(i,l,N)}return a0(i,l,h,p,N)}function Vb(i,l,h,p){var N=p.children,A=i!==null?i.memoizedState:null;if(i===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((l.flags&128)!==0){if(A=A!==null?A.baseLanes|h:h,i!==null){for(p=l.child=i.child,N=0;p!==null;)N=N|p.lanes|p.childLanes,p=p.sibling;p=N&~A}else p=0,l.child=null;return zb(i,l,A,h,p)}if((h&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},i!==null&&ju(l,A!==null?A.cachePool:null),A!==null?Ky(l,A):Im(),Yy(l);else return p=l.lanes=536870912,zb(i,l,A!==null?A.baseLanes|h:h,h,p)}else A!==null?(ju(l,A.cachePool),Ky(l,A),ji(),l.memoizedState=null):(i!==null&&ju(l,null),Im(),ji());return Rr(i,l,N,h),l.child}function Kc(i,l){return i!==null&&i.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function zb(i,l,h,p,N){var A=Am();return A=A===null?null:{parent:gr._currentValue,pool:A},l.memoizedState={baseLanes:h,cachePool:A},i!==null&&ju(l,null),Im(),Yy(l),i!==null&&Sl(i,l,p,!0),l.childLanes=N,null}function $u(i,l){return l=Hu({mode:l.mode,children:l.children},i.mode),l.ref=i.ref,i.child=l,l.return=i,l}function qb(i,l,h){return Ao(l,i.child,null,h),i=$u(l,l.pendingProps),i.flags|=2,pa(l),l.memoizedState=null,i}function XE(i,l,h){var p=l.pendingProps,N=(l.flags&128)!==0;if(l.flags&=-129,i===null){if(bs){if(p.mode==="hidden")return i=$u(l,p),l.lanes=536870912,Kc(null,i);if(Pm(l),(i=Ws)?(i=aw(i,Ia),i=i!==null&&i.data==="&"?i:null,i!==null&&(l.memoizedState={dehydrated:i,treeContext:xi!==null?{id:dn,overflow:un}:null,retryLane:536870912,hydrationErrors:null},h=Cy(i),h.return=l,l.child=h,Cr=l,Ws=null)):i=null,i===null)throw bi(l);return l.lanes=536870912,null}return $u(l,p)}var A=i.memoizedState;if(A!==null){var Y=A.dehydrated;if(Pm(l),N)if(l.flags&256)l.flags&=-257,l=qb(i,l,h);else if(l.memoizedState!==null)l.child=i.child,l.flags|=128,l=null;else throw Error(r(558));else if(xr||Sl(i,l,h,!1),N=(h&i.childLanes)!==0,xr||N){if(p=$s,p!==null&&(Y=os(p,h),Y!==0&&Y!==A.retryLane))throw A.retryLane=Y,vo(i,Y),ea(p,i,Y),r0;Zu(),l=qb(i,l,h)}else i=A.treeContext,Ws=Pa(Y.nextSibling),Cr=l,bs=!0,yi=null,Ia=!1,i!==null&&Ly(l,i),l=$u(l,p),l.flags|=4096;return l}return i=In(i.child,{mode:p.mode,children:p.children}),i.ref=l.ref,l.child=i,i.return=l,i}function Gu(i,l){var h=l.ref;if(h===null)i!==null&&i.ref!==null&&(l.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(r(284));(i===null||i.ref!==h)&&(l.flags|=4194816)}}function a0(i,l,h,p,N){return No(l),h=Fm(i,l,h,p,void 0,N),p=Bm(),i!==null&&!xr?(Um(i,l,N),Un(i,l,N)):(bs&&p&&bm(l),l.flags|=1,Rr(i,l,h,N),l.child)}function Kb(i,l,h,p,N,A){return No(l),l.updateQueue=null,h=Qy(l,p,h,N),Wy(i),p=Bm(),i!==null&&!xr?(Um(i,l,A),Un(i,l,A)):(bs&&p&&bm(l),l.flags|=1,Rr(i,l,h,A),l.child)}function Yb(i,l,h,p,N){if(No(l),l.stateNode===null){var A=yl,Y=h.contextType;typeof Y=="object"&&Y!==null&&(A=kr(Y)),A=new h(p,A),l.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=t0,l.stateNode=A,A._reactInternals=l,A=l.stateNode,A.props=p,A.state=l.memoizedState,A.refs={},km(l),Y=h.contextType,A.context=typeof Y=="object"&&Y!==null?kr(Y):yl,A.state=l.memoizedState,Y=h.getDerivedStateFromProps,typeof Y=="function"&&(e0(l,h,Y,p),A.state=l.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(Y=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),Y!==A.state&&t0.enqueueReplaceState(A,A.state,null),Gc(l,p,A,N),$c(),A.state=l.memoizedState),typeof A.componentDidMount=="function"&&(l.flags|=4194308),p=!0}else if(i===null){A=l.stateNode;var ie=l.memoizedProps,Te=ko(h,ie);A.props=Te;var We=A.context,ct=h.contextType;Y=yl,typeof ct=="object"&&ct!==null&&(Y=kr(ct));var pt=h.getDerivedStateFromProps;ct=typeof pt=="function"||typeof A.getSnapshotBeforeUpdate=="function",ie=l.pendingProps!==ie,ct||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(ie||We!==Y)&&Ib(l,A,p,Y),wi=!1;var Xe=l.memoizedState;A.state=Xe,Gc(l,p,A,N),$c(),We=l.memoizedState,ie||Xe!==We||wi?(typeof pt=="function"&&(e0(l,h,pt,p),We=l.memoizedState),(Te=wi||Db(l,h,Te,p,Xe,We,Y))?(ct||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(l.flags|=4194308)):(typeof A.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=p,l.memoizedState=We),A.props=p,A.state=We,A.context=Y,p=Te):(typeof A.componentDidMount=="function"&&(l.flags|=4194308),p=!1)}else{A=l.stateNode,Rm(i,l),Y=l.memoizedProps,ct=ko(h,Y),A.props=ct,pt=l.pendingProps,Xe=A.context,We=h.contextType,Te=yl,typeof We=="object"&&We!==null&&(Te=kr(We)),ie=h.getDerivedStateFromProps,(We=typeof ie=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(Y!==pt||Xe!==Te)&&Ib(l,A,p,Te),wi=!1,Xe=l.memoizedState,A.state=Xe,Gc(l,p,A,N),$c();var rt=l.memoizedState;Y!==pt||Xe!==rt||wi||i!==null&&i.dependencies!==null&&_u(i.dependencies)?(typeof ie=="function"&&(e0(l,h,ie,p),rt=l.memoizedState),(ct=wi||Db(l,h,ct,p,Xe,rt,Te)||i!==null&&i.dependencies!==null&&_u(i.dependencies))?(We||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(p,rt,Te),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(p,rt,Te)),typeof A.componentDidUpdate=="function"&&(l.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof A.componentDidUpdate!="function"||Y===i.memoizedProps&&Xe===i.memoizedState||(l.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||Y===i.memoizedProps&&Xe===i.memoizedState||(l.flags|=1024),l.memoizedProps=p,l.memoizedState=rt),A.props=p,A.state=rt,A.context=Te,p=ct):(typeof A.componentDidUpdate!="function"||Y===i.memoizedProps&&Xe===i.memoizedState||(l.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||Y===i.memoizedProps&&Xe===i.memoizedState||(l.flags|=1024),p=!1)}return A=p,Gu(i,l),p=(l.flags&128)!==0,A||p?(A=l.stateNode,h=p&&typeof h.getDerivedStateFromError!="function"?null:A.render(),l.flags|=1,i!==null&&p?(l.child=Ao(l,i.child,null,N),l.child=Ao(l,null,h,N)):Rr(i,l,h,N),l.memoizedState=A.state,i=l.child):i=Un(i,l,N),i}function Wb(i,l,h,p){return So(),l.flags|=256,Rr(i,l,h,p),l.child}var n0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function i0(i){return{baseLanes:i,cachePool:Fy()}}function o0(i,l,h){return i=i!==null?i.childLanes&~h:0,l&&(i|=ya),i}function Qb(i,l,h){var p=l.pendingProps,N=!1,A=(l.flags&128)!==0,Y;if((Y=A)||(Y=i!==null&&i.memoizedState===null?!1:(lr.current&2)!==0),Y&&(N=!0,l.flags&=-129),Y=(l.flags&32)!==0,l.flags&=-33,i===null){if(bs){if(N?Ni(l):ji(),(i=Ws)?(i=aw(i,Ia),i=i!==null&&i.data!=="&"?i:null,i!==null&&(l.memoizedState={dehydrated:i,treeContext:xi!==null?{id:dn,overflow:un}:null,retryLane:536870912,hydrationErrors:null},h=Cy(i),h.return=l,l.child=h,Cr=l,Ws=null)):i=null,i===null)throw bi(l);return H0(i)?l.lanes=32:l.lanes=536870912,null}var ie=p.children;return p=p.fallback,N?(ji(),N=l.mode,ie=Hu({mode:"hidden",children:ie},N),p=wo(p,N,h,null),ie.return=l,p.return=l,ie.sibling=p,l.child=ie,p=l.child,p.memoizedState=i0(h),p.childLanes=o0(i,Y,h),l.memoizedState=n0,Kc(null,p)):(Ni(l),l0(l,ie))}var Te=i.memoizedState;if(Te!==null&&(ie=Te.dehydrated,ie!==null)){if(A)l.flags&256?(Ni(l),l.flags&=-257,l=c0(i,l,h)):l.memoizedState!==null?(ji(),l.child=i.child,l.flags|=128,l=null):(ji(),ie=p.fallback,N=l.mode,p=Hu({mode:"visible",children:p.children},N),ie=wo(ie,N,h,null),ie.flags|=2,p.return=l,ie.return=l,p.sibling=ie,l.child=p,Ao(l,i.child,null,h),p=l.child,p.memoizedState=i0(h),p.childLanes=o0(i,Y,h),l.memoizedState=n0,l=Kc(null,p));else if(Ni(l),H0(ie)){if(Y=ie.nextSibling&&ie.nextSibling.dataset,Y)var We=Y.dgst;Y=We,p=Error(r(419)),p.stack="",p.digest=Y,Mc({value:p,source:null,stack:null}),l=c0(i,l,h)}else if(xr||Sl(i,l,h,!1),Y=(h&i.childLanes)!==0,xr||Y){if(Y=$s,Y!==null&&(p=os(Y,h),p!==0&&p!==Te.retryLane))throw Te.retryLane=p,vo(i,p),ea(Y,i,p),r0;G0(ie)||Zu(),l=c0(i,l,h)}else G0(ie)?(l.flags|=192,l.child=i.child,l=null):(i=Te.treeContext,Ws=Pa(ie.nextSibling),Cr=l,bs=!0,yi=null,Ia=!1,i!==null&&Ly(l,i),l=l0(l,p.children),l.flags|=4096);return l}return N?(ji(),ie=p.fallback,N=l.mode,Te=i.child,We=Te.sibling,p=In(Te,{mode:"hidden",children:p.children}),p.subtreeFlags=Te.subtreeFlags&65011712,We!==null?ie=In(We,ie):(ie=wo(ie,N,h,null),ie.flags|=2),ie.return=l,p.return=l,p.sibling=ie,l.child=p,Kc(null,p),p=l.child,ie=i.child.memoizedState,ie===null?ie=i0(h):(N=ie.cachePool,N!==null?(Te=gr._currentValue,N=N.parent!==Te?{parent:Te,pool:Te}:N):N=Fy(),ie={baseLanes:ie.baseLanes|h,cachePool:N}),p.memoizedState=ie,p.childLanes=o0(i,Y,h),l.memoizedState=n0,Kc(i.child,p)):(Ni(l),h=i.child,i=h.sibling,h=In(h,{mode:"visible",children:p.children}),h.return=l,h.sibling=null,i!==null&&(Y=l.deletions,Y===null?(l.deletions=[i],l.flags|=16):Y.push(i)),l.child=h,l.memoizedState=null,h)}function l0(i,l){return l=Hu({mode:"visible",children:l},i.mode),l.return=i,i.child=l}function Hu(i,l){return i=ma(22,i,null,l),i.lanes=0,i}function c0(i,l,h){return Ao(l,i.child,null,h),i=l0(l,l.pendingProps.children),i.flags|=2,l.memoizedState=null,i}function Xb(i,l,h){i.lanes|=l;var p=i.alternate;p!==null&&(p.lanes|=l),Nm(i.return,l,h)}function d0(i,l,h,p,N,A){var Y=i.memoizedState;Y===null?i.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:p,tail:h,tailMode:N,treeForkCount:A}:(Y.isBackwards=l,Y.rendering=null,Y.renderingStartTime=0,Y.last=p,Y.tail=h,Y.tailMode=N,Y.treeForkCount=A)}function Zb(i,l,h){var p=l.pendingProps,N=p.revealOrder,A=p.tail;p=p.children;var Y=lr.current,ie=(Y&2)!==0;if(ie?(Y=Y&1|2,l.flags|=128):Y&=1,Z(lr,Y),Rr(i,l,p,h),p=bs?Ic:0,!ie&&i!==null&&(i.flags&128)!==0)e:for(i=l.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Xb(i,h,l);else if(i.tag===19)Xb(i,h,l);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===l)break e;for(;i.sibling===null;){if(i.return===null||i.return===l)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(N){case"forwards":for(h=l.child,N=null;h!==null;)i=h.alternate,i!==null&&Ru(i)===null&&(N=h),h=h.sibling;h=N,h===null?(N=l.child,l.child=null):(N=h.sibling,h.sibling=null),d0(l,!1,N,h,A,p);break;case"backwards":case"unstable_legacy-backwards":for(h=null,N=l.child,l.child=null;N!==null;){if(i=N.alternate,i!==null&&Ru(i)===null){l.child=N;break}i=N.sibling,N.sibling=h,h=N,N=i}d0(l,!0,h,null,A,p);break;case"together":d0(l,!1,null,null,void 0,p);break;default:l.memoizedState=null}return l.child}function Un(i,l,h){if(i!==null&&(l.dependencies=i.dependencies),Ai|=l.lanes,(h&l.childLanes)===0)if(i!==null){if(Sl(i,l,h,!1),(h&l.childLanes)===0)return null}else return null;if(i!==null&&l.child!==i.child)throw Error(r(153));if(l.child!==null){for(i=l.child,h=In(i,i.pendingProps),l.child=h,h.return=l;i.sibling!==null;)i=i.sibling,h=h.sibling=In(i,i.pendingProps),h.return=l;h.sibling=null}return l.child}function u0(i,l){return(i.lanes&l)!==0?!0:(i=i.dependencies,!!(i!==null&&_u(i)))}function ZE(i,l,h){switch(l.tag){case 3:Ee(l,l.stateNode.containerInfo),vi(l,gr,i.memoizedState.cache),So();break;case 27:case 5:Re(l);break;case 4:Ee(l,l.stateNode.containerInfo);break;case 10:vi(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,Pm(l),null;break;case 13:var p=l.memoizedState;if(p!==null)return p.dehydrated!==null?(Ni(l),l.flags|=128,null):(h&l.child.childLanes)!==0?Qb(i,l,h):(Ni(l),i=Un(i,l,h),i!==null?i.sibling:null);Ni(l);break;case 19:var N=(i.flags&128)!==0;if(p=(h&l.childLanes)!==0,p||(Sl(i,l,h,!1),p=(h&l.childLanes)!==0),N){if(p)return Zb(i,l,h);l.flags|=128}if(N=l.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),Z(lr,lr.current),p)break;return null;case 22:return l.lanes=0,Vb(i,l,h,l.pendingProps);case 24:vi(l,gr,i.memoizedState.cache)}return Un(i,l,h)}function Jb(i,l,h){if(i!==null)if(i.memoizedProps!==l.pendingProps)xr=!0;else{if(!u0(i,h)&&(l.flags&128)===0)return xr=!1,ZE(i,l,h);xr=(i.flags&131072)!==0}else xr=!1,bs&&(l.flags&1048576)!==0&&Ry(l,Ic,l.index);switch(l.lanes=0,l.tag){case 16:e:{var p=l.pendingProps;if(i=Eo(l.elementType),l.type=i,typeof i=="function")pm(i)?(p=ko(i,p),l.tag=1,l=Yb(null,l,i,p,h)):(l.tag=0,l=a0(null,l,i,p,h));else{if(i!=null){var N=i.$$typeof;if(N===R){l.tag=11,l=$b(null,l,i,p,h);break e}else if(N===D){l.tag=14,l=Gb(null,l,i,p,h);break e}}throw l=H(i)||i,Error(r(306,l,""))}}return l;case 0:return a0(i,l,l.type,l.pendingProps,h);case 1:return p=l.type,N=ko(p,l.pendingProps),Yb(i,l,p,N,h);case 3:e:{if(Ee(l,l.stateNode.containerInfo),i===null)throw Error(r(387));p=l.pendingProps;var A=l.memoizedState;N=A.element,Rm(i,l),Gc(l,p,null,h);var Y=l.memoizedState;if(p=Y.cache,vi(l,gr,p),p!==A.cache&&jm(l,[gr],h,!0),$c(),p=Y.element,A.isDehydrated)if(A={element:p,isDehydrated:!1,cache:Y.cache},l.updateQueue.baseState=A,l.memoizedState=A,l.flags&256){l=Wb(i,l,p,h);break e}else if(p!==N){N=Ra(Error(r(424)),l),Mc(N),l=Wb(i,l,p,h);break e}else{switch(i=l.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(Ws=Pa(i.firstChild),Cr=l,bs=!0,yi=null,Ia=!0,h=Vy(l,null,p,h),l.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(So(),p===N){l=Un(i,l,h);break e}Rr(i,l,p,h)}l=l.child}return l;case 26:return Gu(i,l),i===null?(h=dw(l.type,null,l.pendingProps,null))?l.memoizedState=h:bs||(h=l.type,i=l.pendingProps,p=nh(je.current).createElement(h),p[j]=l,p[_]=i,Lr(p,h,i),Ge(p),l.stateNode=p):l.memoizedState=dw(l.type,i.memoizedProps,l.pendingProps,i.memoizedState),null;case 27:return Re(l),i===null&&bs&&(p=l.stateNode=ow(l.type,l.pendingProps,je.current),Cr=l,Ia=!0,N=Ws,Di(l.type)?(V0=N,Ws=Pa(p.firstChild)):Ws=N),Rr(i,l,l.pendingProps.children,h),Gu(i,l),i===null&&(l.flags|=4194304),l.child;case 5:return i===null&&bs&&((N=p=Ws)&&(p=AT(p,l.type,l.pendingProps,Ia),p!==null?(l.stateNode=p,Cr=l,Ws=Pa(p.firstChild),Ia=!1,N=!0):N=!1),N||bi(l)),Re(l),N=l.type,A=l.pendingProps,Y=i!==null?i.memoizedProps:null,p=A.children,B0(N,A)?p=null:Y!==null&&B0(N,Y)&&(l.flags|=32),l.memoizedState!==null&&(N=Fm(i,l,HE,null,null,h),ld._currentValue=N),Gu(i,l),Rr(i,l,p,h),l.child;case 6:return i===null&&bs&&((i=h=Ws)&&(h=CT(h,l.pendingProps,Ia),h!==null?(l.stateNode=h,Cr=l,Ws=null,i=!0):i=!1),i||bi(l)),null;case 13:return Qb(i,l,h);case 4:return Ee(l,l.stateNode.containerInfo),p=l.pendingProps,i===null?l.child=Ao(l,null,p,h):Rr(i,l,p,h),l.child;case 11:return $b(i,l,l.type,l.pendingProps,h);case 7:return Rr(i,l,l.pendingProps,h),l.child;case 8:return Rr(i,l,l.pendingProps.children,h),l.child;case 12:return Rr(i,l,l.pendingProps.children,h),l.child;case 10:return p=l.pendingProps,vi(l,l.type,p.value),Rr(i,l,p.children,h),l.child;case 9:return N=l.type._context,p=l.pendingProps.children,No(l),N=kr(N),p=p(N),l.flags|=1,Rr(i,l,p,h),l.child;case 14:return Gb(i,l,l.type,l.pendingProps,h);case 15:return Hb(i,l,l.type,l.pendingProps,h);case 19:return Zb(i,l,h);case 31:return XE(i,l,h);case 22:return Vb(i,l,h,l.pendingProps);case 24:return No(l),p=kr(gr),i===null?(N=Am(),N===null&&(N=$s,A=Em(),N.pooledCache=A,A.refCount++,A!==null&&(N.pooledCacheLanes|=h),N=A),l.memoizedState={parent:p,cache:N},km(l),vi(l,gr,N)):((i.lanes&h)!==0&&(Rm(i,l),Gc(l,null,null,h),$c()),N=i.memoizedState,A=l.memoizedState,N.parent!==p?(N={parent:p,cache:p},l.memoizedState=N,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=N),vi(l,gr,p)):(p=A.cache,vi(l,gr,p),p!==N.cache&&jm(l,[gr],h,!0))),Rr(i,l,l.pendingProps.children,h),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}function $n(i){i.flags|=4}function h0(i,l,h,p,N){if((l=(i.mode&32)!==0)&&(l=!1),l){if(i.flags|=16777216,(N&335544128)===N)if(i.stateNode.complete)i.flags|=8192;else if(Ev())i.flags|=8192;else throw To=Tu,Cm}else i.flags&=-16777217}function ev(i,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!gw(l))if(Ev())i.flags|=8192;else throw To=Tu,Cm}function Vu(i,l){l!==null&&(i.flags|=4),i.flags&16384&&(l=i.tag!==22?Kt():536870912,i.lanes|=l,Il|=l)}function Yc(i,l){if(!bs)switch(i.tailMode){case"hidden":l=i.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?i.tail=null:h.sibling=null;break;case"collapsed":h=i.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?l||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function Qs(i){var l=i.alternate!==null&&i.alternate.child===i.child,h=0,p=0;if(l)for(var N=i.child;N!==null;)h|=N.lanes|N.childLanes,p|=N.subtreeFlags&65011712,p|=N.flags&65011712,N.return=i,N=N.sibling;else for(N=i.child;N!==null;)h|=N.lanes|N.childLanes,p|=N.subtreeFlags,p|=N.flags,N.return=i,N=N.sibling;return i.subtreeFlags|=p,i.childLanes=h,l}function JE(i,l,h){var p=l.pendingProps;switch(vm(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qs(l),null;case 1:return Qs(l),null;case 3:return h=l.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),l.memoizedState.cache!==p&&(l.flags|=2048),On(gr),Pe(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(i===null||i.child===null)&&(wl(l)?$n(l):i===null||i.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Sm())),Qs(l),null;case 26:var N=l.type,A=l.memoizedState;return i===null?($n(l),A!==null?(Qs(l),ev(l,A)):(Qs(l),h0(l,N,null,p,h))):A?A!==i.memoizedState?($n(l),Qs(l),ev(l,A)):(Qs(l),l.flags&=-16777217):(i=i.memoizedProps,i!==p&&$n(l),Qs(l),h0(l,N,i,p,h)),null;case 27:if(Qe(l),h=je.current,N=l.type,i!==null&&l.stateNode!=null)i.memoizedProps!==p&&$n(l);else{if(!p){if(l.stateNode===null)throw Error(r(166));return Qs(l),null}i=oe.current,wl(l)?Dy(l):(i=ow(N,p,h),l.stateNode=i,$n(l))}return Qs(l),null;case 5:if(Qe(l),N=l.type,i!==null&&l.stateNode!=null)i.memoizedProps!==p&&$n(l);else{if(!p){if(l.stateNode===null)throw Error(r(166));return Qs(l),null}if(A=oe.current,wl(l))Dy(l);else{var Y=nh(je.current);switch(A){case 1:A=Y.createElementNS("http://www.w3.org/2000/svg",N);break;case 2:A=Y.createElementNS("http://www.w3.org/1998/Math/MathML",N);break;default:switch(N){case"svg":A=Y.createElementNS("http://www.w3.org/2000/svg",N);break;case"math":A=Y.createElementNS("http://www.w3.org/1998/Math/MathML",N);break;case"script":A=Y.createElement("div"),A.innerHTML="<script><\/script>",A=A.removeChild(A.firstChild);break;case"select":A=typeof p.is=="string"?Y.createElement("select",{is:p.is}):Y.createElement("select"),p.multiple?A.multiple=!0:p.size&&(A.size=p.size);break;default:A=typeof p.is=="string"?Y.createElement(N,{is:p.is}):Y.createElement(N)}}A[j]=l,A[_]=p;e:for(Y=l.child;Y!==null;){if(Y.tag===5||Y.tag===6)A.appendChild(Y.stateNode);else if(Y.tag!==4&&Y.tag!==27&&Y.child!==null){Y.child.return=Y,Y=Y.child;continue}if(Y===l)break e;for(;Y.sibling===null;){if(Y.return===null||Y.return===l)break e;Y=Y.return}Y.sibling.return=Y.return,Y=Y.sibling}l.stateNode=A;e:switch(Lr(A,N,p),N){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&$n(l)}}return Qs(l),h0(l,l.type,i===null?null:i.memoizedProps,l.pendingProps,h),null;case 6:if(i&&l.stateNode!=null)i.memoizedProps!==p&&$n(l);else{if(typeof p!="string"&&l.stateNode===null)throw Error(r(166));if(i=je.current,wl(l)){if(i=l.stateNode,h=l.memoizedProps,p=null,N=Cr,N!==null)switch(N.tag){case 27:case 5:p=N.memoizedProps}i[j]=l,i=!!(i.nodeValue===h||p!==null&&p.suppressHydrationWarning===!0||Qv(i.nodeValue,h)),i||bi(l,!0)}else i=nh(i).createTextNode(p),i[j]=l,l.stateNode=i}return Qs(l),null;case 31:if(h=l.memoizedState,i===null||i.memoizedState!==null){if(p=wl(l),h!==null){if(i===null){if(!p)throw Error(r(318));if(i=l.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(557));i[j]=l}else So(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Qs(l),i=!1}else h=Sm(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=h),i=!0;if(!i)return l.flags&256?(pa(l),l):(pa(l),null);if((l.flags&128)!==0)throw Error(r(558))}return Qs(l),null;case 13:if(p=l.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(N=wl(l),p!==null&&p.dehydrated!==null){if(i===null){if(!N)throw Error(r(318));if(N=l.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(r(317));N[j]=l}else So(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Qs(l),N=!1}else N=Sm(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=N),N=!0;if(!N)return l.flags&256?(pa(l),l):(pa(l),null)}return pa(l),(l.flags&128)!==0?(l.lanes=h,l):(h=p!==null,i=i!==null&&i.memoizedState!==null,h&&(p=l.child,N=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(N=p.alternate.memoizedState.cachePool.pool),A=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(A=p.memoizedState.cachePool.pool),A!==N&&(p.flags|=2048)),h!==i&&h&&(l.child.flags|=8192),Vu(l,l.updateQueue),Qs(l),null);case 4:return Pe(),i===null&&I0(l.stateNode.containerInfo),Qs(l),null;case 10:return On(l.type),Qs(l),null;case 19:if(G(lr),p=l.memoizedState,p===null)return Qs(l),null;if(N=(l.flags&128)!==0,A=p.rendering,A===null)if(N)Yc(p,!1);else{if(nr!==0||i!==null&&(i.flags&128)!==0)for(i=l.child;i!==null;){if(A=Ru(i),A!==null){for(l.flags|=128,Yc(p,!1),i=A.updateQueue,l.updateQueue=i,Vu(l,i),l.subtreeFlags=0,i=h,h=l.child;h!==null;)Ay(h,i),h=h.sibling;return Z(lr,lr.current&1|2),bs&&Mn(l,p.treeForkCount),l.child}i=i.sibling}p.tail!==null&&nt()>Wu&&(l.flags|=128,N=!0,Yc(p,!1),l.lanes=4194304)}else{if(!N)if(i=Ru(A),i!==null){if(l.flags|=128,N=!0,i=i.updateQueue,l.updateQueue=i,Vu(l,i),Yc(p,!0),p.tail===null&&p.tailMode==="hidden"&&!A.alternate&&!bs)return Qs(l),null}else 2*nt()-p.renderingStartTime>Wu&&h!==536870912&&(l.flags|=128,N=!0,Yc(p,!1),l.lanes=4194304);p.isBackwards?(A.sibling=l.child,l.child=A):(i=p.last,i!==null?i.sibling=A:l.child=A,p.last=A)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=nt(),i.sibling=null,h=lr.current,Z(lr,N?h&1|2:h&1),bs&&Mn(l,p.treeForkCount),i):(Qs(l),null);case 22:case 23:return pa(l),Mm(),p=l.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(l.flags|=8192):p&&(l.flags|=8192),p?(h&536870912)!==0&&(l.flags&128)===0&&(Qs(l),l.subtreeFlags&6&&(l.flags|=8192)):Qs(l),h=l.updateQueue,h!==null&&Vu(l,h.retryQueue),h=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),p=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(p=l.memoizedState.cachePool.pool),p!==h&&(l.flags|=2048),i!==null&&G(jo),null;case 24:return h=null,i!==null&&(h=i.memoizedState.cache),l.memoizedState.cache!==h&&(l.flags|=2048),On(gr),Qs(l),null;case 25:return null;case 30:return null}throw Error(r(156,l.tag))}function eT(i,l){switch(vm(l),l.tag){case 1:return i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 3:return On(gr),Pe(),i=l.flags,(i&65536)!==0&&(i&128)===0?(l.flags=i&-65537|128,l):null;case 26:case 27:case 5:return Qe(l),null;case 31:if(l.memoizedState!==null){if(pa(l),l.alternate===null)throw Error(r(340));So()}return i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 13:if(pa(l),i=l.memoizedState,i!==null&&i.dehydrated!==null){if(l.alternate===null)throw Error(r(340));So()}return i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 19:return G(lr),null;case 4:return Pe(),null;case 10:return On(l.type),null;case 22:case 23:return pa(l),Mm(),i!==null&&G(jo),i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 24:return On(gr),null;case 25:return null;default:return null}}function tv(i,l){switch(vm(l),l.tag){case 3:On(gr),Pe();break;case 26:case 27:case 5:Qe(l);break;case 4:Pe();break;case 31:l.memoizedState!==null&&pa(l);break;case 13:pa(l);break;case 19:G(lr);break;case 10:On(l.type);break;case 22:case 23:pa(l),Mm(),i!==null&&G(jo);break;case 24:On(gr)}}function Wc(i,l){try{var h=l.updateQueue,p=h!==null?h.lastEffect:null;if(p!==null){var N=p.next;h=N;do{if((h.tag&i)===i){p=void 0;var A=h.create,Y=h.inst;p=A(),Y.destroy=p}h=h.next}while(h!==N)}}catch(ie){Ds(l,l.return,ie)}}function Ei(i,l,h){try{var p=l.updateQueue,N=p!==null?p.lastEffect:null;if(N!==null){var A=N.next;p=A;do{if((p.tag&i)===i){var Y=p.inst,ie=Y.destroy;if(ie!==void 0){Y.destroy=void 0,N=l;var Te=h,We=ie;try{We()}catch(ct){Ds(N,Te,ct)}}}p=p.next}while(p!==A)}}catch(ct){Ds(l,l.return,ct)}}function sv(i){var l=i.updateQueue;if(l!==null){var h=i.stateNode;try{qy(l,h)}catch(p){Ds(i,i.return,p)}}}function rv(i,l,h){h.props=ko(i.type,i.memoizedProps),h.state=i.memoizedState;try{h.componentWillUnmount()}catch(p){Ds(i,l,p)}}function Qc(i,l){try{var h=i.ref;if(h!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof h=="function"?i.refCleanup=h(p):h.current=p}}catch(N){Ds(i,l,N)}}function hn(i,l){var h=i.ref,p=i.refCleanup;if(h!==null)if(typeof p=="function")try{p()}catch(N){Ds(i,l,N)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(N){Ds(i,l,N)}else h.current=null}function av(i){var l=i.type,h=i.memoizedProps,p=i.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":h.autoFocus&&p.focus();break e;case"img":h.src?p.src=h.src:h.srcSet&&(p.srcset=h.srcSet)}}catch(N){Ds(i,i.return,N)}}function f0(i,l,h){try{var p=i.stateNode;ST(p,i.type,h,l),p[_]=l}catch(N){Ds(i,i.return,N)}}function nv(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Di(i.type)||i.tag===4}function m0(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||nv(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Di(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function g0(i,l,h){var p=i.tag;if(p===5||p===6)i=i.stateNode,l?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(i,l):(l=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,l.appendChild(i),h=h._reactRootContainer,h!=null||l.onclick!==null||(l.onclick=ha));else if(p!==4&&(p===27&&Di(i.type)&&(h=i.stateNode,l=null),i=i.child,i!==null))for(g0(i,l,h),i=i.sibling;i!==null;)g0(i,l,h),i=i.sibling}function zu(i,l,h){var p=i.tag;if(p===5||p===6)i=i.stateNode,l?h.insertBefore(i,l):h.appendChild(i);else if(p!==4&&(p===27&&Di(i.type)&&(h=i.stateNode),i=i.child,i!==null))for(zu(i,l,h),i=i.sibling;i!==null;)zu(i,l,h),i=i.sibling}function iv(i){var l=i.stateNode,h=i.memoizedProps;try{for(var p=i.type,N=l.attributes;N.length;)l.removeAttributeNode(N[0]);Lr(l,p,h),l[j]=i,l[_]=h}catch(A){Ds(i,i.return,A)}}var Gn=!1,yr=!1,p0=!1,ov=typeof WeakSet=="function"?WeakSet:Set,jr=null;function tT(i,l){if(i=i.containerInfo,O0=hh,i=by(i),cm(i)){if("selectionStart"in i)var h={start:i.selectionStart,end:i.selectionEnd};else e:{h=(h=i.ownerDocument)&&h.defaultView||window;var p=h.getSelection&&h.getSelection();if(p&&p.rangeCount!==0){h=p.anchorNode;var N=p.anchorOffset,A=p.focusNode;p=p.focusOffset;try{h.nodeType,A.nodeType}catch{h=null;break e}var Y=0,ie=-1,Te=-1,We=0,ct=0,pt=i,Xe=null;t:for(;;){for(var rt;pt!==h||N!==0&&pt.nodeType!==3||(ie=Y+N),pt!==A||p!==0&&pt.nodeType!==3||(Te=Y+p),pt.nodeType===3&&(Y+=pt.nodeValue.length),(rt=pt.firstChild)!==null;)Xe=pt,pt=rt;for(;;){if(pt===i)break t;if(Xe===h&&++We===N&&(ie=Y),Xe===A&&++ct===p&&(Te=Y),(rt=pt.nextSibling)!==null)break;pt=Xe,Xe=pt.parentNode}pt=rt}h=ie===-1||Te===-1?null:{start:ie,end:Te}}else h=null}h=h||{start:0,end:0}}else h=null;for(F0={focusedElem:i,selectionRange:h},hh=!1,jr=l;jr!==null;)if(l=jr,i=l.child,(l.subtreeFlags&1028)!==0&&i!==null)i.return=l,jr=i;else for(;jr!==null;){switch(l=jr,A=l.alternate,i=l.flags,l.tag){case 0:if((i&4)!==0&&(i=l.updateQueue,i=i!==null?i.events:null,i!==null))for(h=0;h<i.length;h++)N=i[h],N.ref.impl=N.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&A!==null){i=void 0,h=l,N=A.memoizedProps,A=A.memoizedState,p=h.stateNode;try{var Lt=ko(h.type,N);i=p.getSnapshotBeforeUpdate(Lt,A),p.__reactInternalSnapshotBeforeUpdate=i}catch(zt){Ds(h,h.return,zt)}}break;case 3:if((i&1024)!==0){if(i=l.stateNode.containerInfo,h=i.nodeType,h===9)$0(i);else if(h===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":$0(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(r(163))}if(i=l.sibling,i!==null){i.return=l.return,jr=i;break}jr=l.return}}function lv(i,l,h){var p=h.flags;switch(h.tag){case 0:case 11:case 15:Vn(i,h),p&4&&Wc(5,h);break;case 1:if(Vn(i,h),p&4)if(i=h.stateNode,l===null)try{i.componentDidMount()}catch(Y){Ds(h,h.return,Y)}else{var N=ko(h.type,l.memoizedProps);l=l.memoizedState;try{i.componentDidUpdate(N,l,i.__reactInternalSnapshotBeforeUpdate)}catch(Y){Ds(h,h.return,Y)}}p&64&&sv(h),p&512&&Qc(h,h.return);break;case 3:if(Vn(i,h),p&64&&(i=h.updateQueue,i!==null)){if(l=null,h.child!==null)switch(h.child.tag){case 27:case 5:l=h.child.stateNode;break;case 1:l=h.child.stateNode}try{qy(i,l)}catch(Y){Ds(h,h.return,Y)}}break;case 27:l===null&&p&4&&iv(h);case 26:case 5:Vn(i,h),l===null&&p&4&&av(h),p&512&&Qc(h,h.return);break;case 12:Vn(i,h);break;case 31:Vn(i,h),p&4&&uv(i,h);break;case 13:Vn(i,h),p&4&&hv(i,h),p&64&&(i=h.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(h=dT.bind(null,h),kT(i,h))));break;case 22:if(p=h.memoizedState!==null||Gn,!p){l=l!==null&&l.memoizedState!==null||yr,N=Gn;var A=yr;Gn=p,(yr=l)&&!A?zn(i,h,(h.subtreeFlags&8772)!==0):Vn(i,h),Gn=N,yr=A}break;case 30:break;default:Vn(i,h)}}function cv(i){var l=i.alternate;l!==null&&(i.alternate=null,cv(l)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(l=i.stateNode,l!==null&&se(l)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Zs=null,Qr=!1;function Hn(i,l,h){for(h=h.child;h!==null;)dv(i,l,h),h=h.sibling}function dv(i,l,h){if(De&&typeof De.onCommitFiberUnmount=="function")try{De.onCommitFiberUnmount(me,h)}catch{}switch(h.tag){case 26:yr||hn(h,l),Hn(i,l,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:yr||hn(h,l);var p=Zs,N=Qr;Di(h.type)&&(Zs=h.stateNode,Qr=!1),Hn(i,l,h),nd(h.stateNode),Zs=p,Qr=N;break;case 5:yr||hn(h,l);case 6:if(p=Zs,N=Qr,Zs=null,Hn(i,l,h),Zs=p,Qr=N,Zs!==null)if(Qr)try{(Zs.nodeType===9?Zs.body:Zs.nodeName==="HTML"?Zs.ownerDocument.body:Zs).removeChild(h.stateNode)}catch(A){Ds(h,l,A)}else try{Zs.removeChild(h.stateNode)}catch(A){Ds(h,l,A)}break;case 18:Zs!==null&&(Qr?(i=Zs,sw(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,h.stateNode),Gl(i)):sw(Zs,h.stateNode));break;case 4:p=Zs,N=Qr,Zs=h.stateNode.containerInfo,Qr=!0,Hn(i,l,h),Zs=p,Qr=N;break;case 0:case 11:case 14:case 15:Ei(2,h,l),yr||Ei(4,h,l),Hn(i,l,h);break;case 1:yr||(hn(h,l),p=h.stateNode,typeof p.componentWillUnmount=="function"&&rv(h,l,p)),Hn(i,l,h);break;case 21:Hn(i,l,h);break;case 22:yr=(p=yr)||h.memoizedState!==null,Hn(i,l,h),yr=p;break;default:Hn(i,l,h)}}function uv(i,l){if(l.memoizedState===null&&(i=l.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Gl(i)}catch(h){Ds(l,l.return,h)}}}function hv(i,l){if(l.memoizedState===null&&(i=l.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Gl(i)}catch(h){Ds(l,l.return,h)}}function sT(i){switch(i.tag){case 31:case 13:case 19:var l=i.stateNode;return l===null&&(l=i.stateNode=new ov),l;case 22:return i=i.stateNode,l=i._retryCache,l===null&&(l=i._retryCache=new ov),l;default:throw Error(r(435,i.tag))}}function qu(i,l){var h=sT(i);l.forEach(function(p){if(!h.has(p)){h.add(p);var N=uT.bind(null,i,p);p.then(N,N)}})}function Xr(i,l){var h=l.deletions;if(h!==null)for(var p=0;p<h.length;p++){var N=h[p],A=i,Y=l,ie=Y;e:for(;ie!==null;){switch(ie.tag){case 27:if(Di(ie.type)){Zs=ie.stateNode,Qr=!1;break e}break;case 5:Zs=ie.stateNode,Qr=!1;break e;case 3:case 4:Zs=ie.stateNode.containerInfo,Qr=!0;break e}ie=ie.return}if(Zs===null)throw Error(r(160));dv(A,Y,N),Zs=null,Qr=!1,A=N.alternate,A!==null&&(A.return=null),N.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)fv(l,i),l=l.sibling}var Wa=null;function fv(i,l){var h=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Xr(l,i),Zr(i),p&4&&(Ei(3,i,i.return),Wc(3,i),Ei(5,i,i.return));break;case 1:Xr(l,i),Zr(i),p&512&&(yr||h===null||hn(h,h.return)),p&64&&Gn&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(h=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=h===null?p:h.concat(p))));break;case 26:var N=Wa;if(Xr(l,i),Zr(i),p&512&&(yr||h===null||hn(h,h.return)),p&4){var A=h!==null?h.memoizedState:null;if(p=i.memoizedState,h===null)if(p===null)if(i.stateNode===null){e:{p=i.type,h=i.memoizedProps,N=N.ownerDocument||N;t:switch(p){case"title":A=N.getElementsByTagName("title")[0],(!A||A[B]||A[j]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=N.createElement(p),N.head.insertBefore(A,N.querySelector("head > title"))),Lr(A,p,h),A[j]=i,Ge(A),p=A;break e;case"link":var Y=fw("link","href",N).get(p+(h.href||""));if(Y){for(var ie=0;ie<Y.length;ie++)if(A=Y[ie],A.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&A.getAttribute("rel")===(h.rel==null?null:h.rel)&&A.getAttribute("title")===(h.title==null?null:h.title)&&A.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){Y.splice(ie,1);break t}}A=N.createElement(p),Lr(A,p,h),N.head.appendChild(A);break;case"meta":if(Y=fw("meta","content",N).get(p+(h.content||""))){for(ie=0;ie<Y.length;ie++)if(A=Y[ie],A.getAttribute("content")===(h.content==null?null:""+h.content)&&A.getAttribute("name")===(h.name==null?null:h.name)&&A.getAttribute("property")===(h.property==null?null:h.property)&&A.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&A.getAttribute("charset")===(h.charSet==null?null:h.charSet)){Y.splice(ie,1);break t}}A=N.createElement(p),Lr(A,p,h),N.head.appendChild(A);break;default:throw Error(r(468,p))}A[j]=i,Ge(A),p=A}i.stateNode=p}else mw(N,i.type,i.stateNode);else i.stateNode=hw(N,p,i.memoizedProps);else A!==p?(A===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):A.count--,p===null?mw(N,i.type,i.stateNode):hw(N,p,i.memoizedProps)):p===null&&i.stateNode!==null&&f0(i,i.memoizedProps,h.memoizedProps)}break;case 27:Xr(l,i),Zr(i),p&512&&(yr||h===null||hn(h,h.return)),h!==null&&p&4&&f0(i,i.memoizedProps,h.memoizedProps);break;case 5:if(Xr(l,i),Zr(i),p&512&&(yr||h===null||hn(h,h.return)),i.flags&32){N=i.stateNode;try{Fr(N,"")}catch(Lt){Ds(i,i.return,Lt)}}p&4&&i.stateNode!=null&&(N=i.memoizedProps,f0(i,N,h!==null?h.memoizedProps:N)),p&1024&&(p0=!0);break;case 6:if(Xr(l,i),Zr(i),p&4){if(i.stateNode===null)throw Error(r(162));p=i.memoizedProps,h=i.stateNode;try{h.nodeValue=p}catch(Lt){Ds(i,i.return,Lt)}}break;case 3:if(lh=null,N=Wa,Wa=ih(l.containerInfo),Xr(l,i),Wa=N,Zr(i),p&4&&h!==null&&h.memoizedState.isDehydrated)try{Gl(l.containerInfo)}catch(Lt){Ds(i,i.return,Lt)}p0&&(p0=!1,mv(i));break;case 4:p=Wa,Wa=ih(i.stateNode.containerInfo),Xr(l,i),Zr(i),Wa=p;break;case 12:Xr(l,i),Zr(i);break;case 31:Xr(l,i),Zr(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,qu(i,p)));break;case 13:Xr(l,i),Zr(i),i.child.flags&8192&&i.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(Yu=nt()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,qu(i,p)));break;case 22:N=i.memoizedState!==null;var Te=h!==null&&h.memoizedState!==null,We=Gn,ct=yr;if(Gn=We||N,yr=ct||Te,Xr(l,i),yr=ct,Gn=We,Zr(i),p&8192)e:for(l=i.stateNode,l._visibility=N?l._visibility&-2:l._visibility|1,N&&(h===null||Te||Gn||yr||Ro(i)),h=null,l=i;;){if(l.tag===5||l.tag===26){if(h===null){Te=h=l;try{if(A=Te.stateNode,N)Y=A.style,typeof Y.setProperty=="function"?Y.setProperty("display","none","important"):Y.display="none";else{ie=Te.stateNode;var pt=Te.memoizedProps.style,Xe=pt!=null&&pt.hasOwnProperty("display")?pt.display:null;ie.style.display=Xe==null||typeof Xe=="boolean"?"":(""+Xe).trim()}}catch(Lt){Ds(Te,Te.return,Lt)}}}else if(l.tag===6){if(h===null){Te=l;try{Te.stateNode.nodeValue=N?"":Te.memoizedProps}catch(Lt){Ds(Te,Te.return,Lt)}}}else if(l.tag===18){if(h===null){Te=l;try{var rt=Te.stateNode;N?rw(rt,!0):rw(Te.stateNode,!1)}catch(Lt){Ds(Te,Te.return,Lt)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===i)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break e;for(;l.sibling===null;){if(l.return===null||l.return===i)break e;h===l&&(h=null),l=l.return}h===l&&(h=null),l.sibling.return=l.return,l=l.sibling}p&4&&(p=i.updateQueue,p!==null&&(h=p.retryQueue,h!==null&&(p.retryQueue=null,qu(i,h))));break;case 19:Xr(l,i),Zr(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,qu(i,p)));break;case 30:break;case 21:break;default:Xr(l,i),Zr(i)}}function Zr(i){var l=i.flags;if(l&2){try{for(var h,p=i.return;p!==null;){if(nv(p)){h=p;break}p=p.return}if(h==null)throw Error(r(160));switch(h.tag){case 27:var N=h.stateNode,A=m0(i);zu(i,A,N);break;case 5:var Y=h.stateNode;h.flags&32&&(Fr(Y,""),h.flags&=-33);var ie=m0(i);zu(i,ie,Y);break;case 3:case 4:var Te=h.stateNode.containerInfo,We=m0(i);g0(i,We,Te);break;default:throw Error(r(161))}}catch(ct){Ds(i,i.return,ct)}i.flags&=-3}l&4096&&(i.flags&=-4097)}function mv(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var l=i;mv(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),i=i.sibling}}function Vn(i,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)lv(i,l.alternate,l),l=l.sibling}function Ro(i){for(i=i.child;i!==null;){var l=i;switch(l.tag){case 0:case 11:case 14:case 15:Ei(4,l,l.return),Ro(l);break;case 1:hn(l,l.return);var h=l.stateNode;typeof h.componentWillUnmount=="function"&&rv(l,l.return,h),Ro(l);break;case 27:nd(l.stateNode);case 26:case 5:hn(l,l.return),Ro(l);break;case 22:l.memoizedState===null&&Ro(l);break;case 30:Ro(l);break;default:Ro(l)}i=i.sibling}}function zn(i,l,h){for(h=h&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var p=l.alternate,N=i,A=l,Y=A.flags;switch(A.tag){case 0:case 11:case 15:zn(N,A,h),Wc(4,A);break;case 1:if(zn(N,A,h),p=A,N=p.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(We){Ds(p,p.return,We)}if(p=A,N=p.updateQueue,N!==null){var ie=p.stateNode;try{var Te=N.shared.hiddenCallbacks;if(Te!==null)for(N.shared.hiddenCallbacks=null,N=0;N<Te.length;N++)zy(Te[N],ie)}catch(We){Ds(p,p.return,We)}}h&&Y&64&&sv(A),Qc(A,A.return);break;case 27:iv(A);case 26:case 5:zn(N,A,h),h&&p===null&&Y&4&&av(A),Qc(A,A.return);break;case 12:zn(N,A,h);break;case 31:zn(N,A,h),h&&Y&4&&uv(N,A);break;case 13:zn(N,A,h),h&&Y&4&&hv(N,A);break;case 22:A.memoizedState===null&&zn(N,A,h),Qc(A,A.return);break;case 30:break;default:zn(N,A,h)}l=l.sibling}}function x0(i,l){var h=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),i=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(i=l.memoizedState.cachePool.pool),i!==h&&(i!=null&&i.refCount++,h!=null&&Pc(h))}function y0(i,l){i=null,l.alternate!==null&&(i=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==i&&(l.refCount++,i!=null&&Pc(i))}function Qa(i,l,h,p){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)gv(i,l,h,p),l=l.sibling}function gv(i,l,h,p){var N=l.flags;switch(l.tag){case 0:case 11:case 15:Qa(i,l,h,p),N&2048&&Wc(9,l);break;case 1:Qa(i,l,h,p);break;case 3:Qa(i,l,h,p),N&2048&&(i=null,l.alternate!==null&&(i=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==i&&(l.refCount++,i!=null&&Pc(i)));break;case 12:if(N&2048){Qa(i,l,h,p),i=l.stateNode;try{var A=l.memoizedProps,Y=A.id,ie=A.onPostCommit;typeof ie=="function"&&ie(Y,l.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Te){Ds(l,l.return,Te)}}else Qa(i,l,h,p);break;case 31:Qa(i,l,h,p);break;case 13:Qa(i,l,h,p);break;case 23:break;case 22:A=l.stateNode,Y=l.alternate,l.memoizedState!==null?A._visibility&2?Qa(i,l,h,p):Xc(i,l):A._visibility&2?Qa(i,l,h,p):(A._visibility|=2,Rl(i,l,h,p,(l.subtreeFlags&10256)!==0||!1)),N&2048&&x0(Y,l);break;case 24:Qa(i,l,h,p),N&2048&&y0(l.alternate,l);break;default:Qa(i,l,h,p)}}function Rl(i,l,h,p,N){for(N=N&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var A=i,Y=l,ie=h,Te=p,We=Y.flags;switch(Y.tag){case 0:case 11:case 15:Rl(A,Y,ie,Te,N),Wc(8,Y);break;case 23:break;case 22:var ct=Y.stateNode;Y.memoizedState!==null?ct._visibility&2?Rl(A,Y,ie,Te,N):Xc(A,Y):(ct._visibility|=2,Rl(A,Y,ie,Te,N)),N&&We&2048&&x0(Y.alternate,Y);break;case 24:Rl(A,Y,ie,Te,N),N&&We&2048&&y0(Y.alternate,Y);break;default:Rl(A,Y,ie,Te,N)}l=l.sibling}}function Xc(i,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var h=i,p=l,N=p.flags;switch(p.tag){case 22:Xc(h,p),N&2048&&x0(p.alternate,p);break;case 24:Xc(h,p),N&2048&&y0(p.alternate,p);break;default:Xc(h,p)}l=l.sibling}}var Zc=8192;function Ll(i,l,h){if(i.subtreeFlags&Zc)for(i=i.child;i!==null;)pv(i,l,h),i=i.sibling}function pv(i,l,h){switch(i.tag){case 26:Ll(i,l,h),i.flags&Zc&&i.memoizedState!==null&&GT(h,Wa,i.memoizedState,i.memoizedProps);break;case 5:Ll(i,l,h);break;case 3:case 4:var p=Wa;Wa=ih(i.stateNode.containerInfo),Ll(i,l,h),Wa=p;break;case 22:i.memoizedState===null&&(p=i.alternate,p!==null&&p.memoizedState!==null?(p=Zc,Zc=16777216,Ll(i,l,h),Zc=p):Ll(i,l,h));break;default:Ll(i,l,h)}}function xv(i){var l=i.alternate;if(l!==null&&(i=l.child,i!==null)){l.child=null;do l=i.sibling,i.sibling=null,i=l;while(i!==null)}}function Jc(i){var l=i.deletions;if((i.flags&16)!==0){if(l!==null)for(var h=0;h<l.length;h++){var p=l[h];jr=p,bv(p,i)}xv(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)yv(i),i=i.sibling}function yv(i){switch(i.tag){case 0:case 11:case 15:Jc(i),i.flags&2048&&Ei(9,i,i.return);break;case 3:Jc(i);break;case 12:Jc(i);break;case 22:var l=i.stateNode;i.memoizedState!==null&&l._visibility&2&&(i.return===null||i.return.tag!==13)?(l._visibility&=-3,Ku(i)):Jc(i);break;default:Jc(i)}}function Ku(i){var l=i.deletions;if((i.flags&16)!==0){if(l!==null)for(var h=0;h<l.length;h++){var p=l[h];jr=p,bv(p,i)}xv(i)}for(i=i.child;i!==null;){switch(l=i,l.tag){case 0:case 11:case 15:Ei(8,l,l.return),Ku(l);break;case 22:h=l.stateNode,h._visibility&2&&(h._visibility&=-3,Ku(l));break;default:Ku(l)}i=i.sibling}}function bv(i,l){for(;jr!==null;){var h=jr;switch(h.tag){case 0:case 11:case 15:Ei(8,h,l);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var p=h.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Pc(h.memoizedState.cache)}if(p=h.child,p!==null)p.return=h,jr=p;else e:for(h=i;jr!==null;){p=jr;var N=p.sibling,A=p.return;if(cv(p),p===h){jr=null;break e}if(N!==null){N.return=A,jr=N;break e}jr=A}}}var rT={getCacheForType:function(i){var l=kr(gr),h=l.data.get(i);return h===void 0&&(h=i(),l.data.set(i,h)),h},cacheSignal:function(){return kr(gr).controller.signal}},aT=typeof WeakMap=="function"?WeakMap:Map,Ts=0,$s=null,fs=null,gs=0,Ls=0,xa=null,Ti=!1,Dl=!1,b0=!1,qn=0,nr=0,Ai=0,Lo=0,v0=0,ya=0,Il=0,ed=null,Jr=null,w0=!1,Yu=0,vv=0,Wu=1/0,Qu=null,Ci=null,vr=0,ki=null,Ml=null,Kn=0,S0=0,_0=null,wv=null,td=0,N0=null;function ba(){return(Ts&2)!==0&&gs!==0?gs&-gs:q.T!==null?k0():Yr()}function Sv(){if(ya===0)if((gs&536870912)===0||bs){var i=yt;yt<<=1,(yt&3932160)===0&&(yt=262144),ya=i}else ya=536870912;return i=ga.current,i!==null&&(i.flags|=32),ya}function ea(i,l,h){(i===$s&&(Ls===2||Ls===9)||i.cancelPendingCommit!==null)&&(Pl(i,0),Ri(i,gs,ya,!1)),Ne(i,h),((Ts&2)===0||i!==$s)&&(i===$s&&((Ts&2)===0&&(Lo|=h),nr===4&&Ri(i,gs,ya,!1)),fn(i))}function _v(i,l,h){if((Ts&6)!==0)throw Error(r(327));var p=!h&&(l&127)===0&&(l&i.expiredLanes)===0||Nt(i,l),N=p?oT(i,l):E0(i,l,!0),A=p;do{if(N===0){Dl&&!p&&Ri(i,l,0,!1);break}else{if(h=i.current.alternate,A&&!nT(h)){N=E0(i,l,!1),A=!1;continue}if(N===2){if(A=l,i.errorRecoveryDisabledLanes&A)var Y=0;else Y=i.pendingLanes&-536870913,Y=Y!==0?Y:Y&536870912?536870912:0;if(Y!==0){l=Y;e:{var ie=i;N=ed;var Te=ie.current.memoizedState.isDehydrated;if(Te&&(Pl(ie,Y).flags|=256),Y=E0(ie,Y,!1),Y!==2){if(b0&&!Te){ie.errorRecoveryDisabledLanes|=A,Lo|=A,N=4;break e}A=Jr,Jr=N,A!==null&&(Jr===null?Jr=A:Jr.push.apply(Jr,A))}N=Y}if(A=!1,N!==2)continue}}if(N===1){Pl(i,0),Ri(i,l,0,!0);break}e:{switch(p=i,A=N,A){case 0:case 1:throw Error(r(345));case 4:if((l&4194048)!==l)break;case 6:Ri(p,l,ya,!Ti);break e;case 2:Jr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((l&62914560)===l&&(N=Yu+300-nt(),10<N)){if(Ri(p,l,ya,!Ti),Vt(p,0,!0)!==0)break e;Kn=l,p.timeoutHandle=ew(Nv.bind(null,p,h,Jr,Qu,w0,l,ya,Lo,Il,Ti,A,"Throttled",-0,0),N);break e}Nv(p,h,Jr,Qu,w0,l,ya,Lo,Il,Ti,A,null,-0,0)}}break}while(!0);fn(i)}function Nv(i,l,h,p,N,A,Y,ie,Te,We,ct,pt,Xe,rt){if(i.timeoutHandle=-1,pt=l.subtreeFlags,pt&8192||(pt&16785408)===16785408){pt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ha},pv(l,A,pt);var Lt=(A&62914560)===A?Yu-nt():(A&4194048)===A?vv-nt():0;if(Lt=HT(pt,Lt),Lt!==null){Kn=A,i.cancelPendingCommit=Lt(Lv.bind(null,i,l,A,h,p,N,Y,ie,Te,ct,pt,null,Xe,rt)),Ri(i,A,Y,!We);return}}Lv(i,l,A,h,p,N,Y,ie,Te)}function nT(i){for(var l=i;;){var h=l.tag;if((h===0||h===11||h===15)&&l.flags&16384&&(h=l.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var p=0;p<h.length;p++){var N=h[p],A=N.getSnapshot;N=N.value;try{if(!fa(A(),N))return!1}catch{return!1}}if(h=l.child,l.subtreeFlags&16384&&h!==null)h.return=l,l=h;else{if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Ri(i,l,h,p){l&=~v0,l&=~Lo,i.suspendedLanes|=l,i.pingedLanes&=~l,p&&(i.warmLanes|=l),p=i.expirationTimes;for(var N=l;0<N;){var A=31-Fe(N),Y=1<<A;p[A]=-1,N&=~Y}h!==0&&jt(i,h,l)}function Xu(){return(Ts&6)===0?(sd(0),!1):!0}function j0(){if(fs!==null){if(Ls===0)var i=fs.return;else i=fs,Pn=_o=null,$m(i),El=null,Fc=0,i=fs;for(;i!==null;)tv(i.alternate,i),i=i.return;fs=null}}function Pl(i,l){var h=i.timeoutHandle;h!==-1&&(i.timeoutHandle=-1,jT(h)),h=i.cancelPendingCommit,h!==null&&(i.cancelPendingCommit=null,h()),Kn=0,j0(),$s=i,fs=h=In(i.current,null),gs=l,Ls=0,xa=null,Ti=!1,Dl=Nt(i,l),b0=!1,Il=ya=v0=Lo=Ai=nr=0,Jr=ed=null,w0=!1,(l&8)!==0&&(l|=l&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=l;0<p;){var N=31-Fe(p),A=1<<N;l|=i[N],p&=~A}return qn=l,yu(),h}function jv(i,l){ts=null,q.H=qc,l===jl||l===Eu?(l=$y(),Ls=3):l===Cm?(l=$y(),Ls=4):Ls=l===r0?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,xa=l,fs===null&&(nr=1,Uu(i,Ra(l,i.current)))}function Ev(){var i=ga.current;return i===null?!0:(gs&4194048)===gs?Ma===null:(gs&62914560)===gs||(gs&536870912)!==0?i===Ma:!1}function Tv(){var i=q.H;return q.H=qc,i===null?qc:i}function Av(){var i=q.A;return q.A=rT,i}function Zu(){nr=4,Ti||(gs&4194048)!==gs&&ga.current!==null||(Dl=!0),(Ai&134217727)===0&&(Lo&134217727)===0||$s===null||Ri($s,gs,ya,!1)}function E0(i,l,h){var p=Ts;Ts|=2;var N=Tv(),A=Av();($s!==i||gs!==l)&&(Qu=null,Pl(i,l)),l=!1;var Y=nr;e:do try{if(Ls!==0&&fs!==null){var ie=fs,Te=xa;switch(Ls){case 8:j0(),Y=6;break e;case 3:case 2:case 9:case 6:ga.current===null&&(l=!0);var We=Ls;if(Ls=0,xa=null,Ol(i,ie,Te,We),h&&Dl){Y=0;break e}break;default:We=Ls,Ls=0,xa=null,Ol(i,ie,Te,We)}}iT(),Y=nr;break}catch(ct){jv(i,ct)}while(!0);return l&&i.shellSuspendCounter++,Pn=_o=null,Ts=p,q.H=N,q.A=A,fs===null&&($s=null,gs=0,yu()),Y}function iT(){for(;fs!==null;)Cv(fs)}function oT(i,l){var h=Ts;Ts|=2;var p=Tv(),N=Av();$s!==i||gs!==l?(Qu=null,Wu=nt()+500,Pl(i,l)):Dl=Nt(i,l);e:do try{if(Ls!==0&&fs!==null){l=fs;var A=xa;t:switch(Ls){case 1:Ls=0,xa=null,Ol(i,l,A,1);break;case 2:case 9:if(By(A)){Ls=0,xa=null,kv(l);break}l=function(){Ls!==2&&Ls!==9||$s!==i||(Ls=7),fn(i)},A.then(l,l);break e;case 3:Ls=7;break e;case 4:Ls=5;break e;case 7:By(A)?(Ls=0,xa=null,kv(l)):(Ls=0,xa=null,Ol(i,l,A,7));break;case 5:var Y=null;switch(fs.tag){case 26:Y=fs.memoizedState;case 5:case 27:var ie=fs;if(Y?gw(Y):ie.stateNode.complete){Ls=0,xa=null;var Te=ie.sibling;if(Te!==null)fs=Te;else{var We=ie.return;We!==null?(fs=We,Ju(We)):fs=null}break t}}Ls=0,xa=null,Ol(i,l,A,5);break;case 6:Ls=0,xa=null,Ol(i,l,A,6);break;case 8:j0(),nr=6;break e;default:throw Error(r(462))}}lT();break}catch(ct){jv(i,ct)}while(!0);return Pn=_o=null,q.H=p,q.A=N,Ts=h,fs!==null?0:($s=null,gs=0,yu(),nr)}function lT(){for(;fs!==null&&!Ze();)Cv(fs)}function Cv(i){var l=Jb(i.alternate,i,qn);i.memoizedProps=i.pendingProps,l===null?Ju(i):fs=l}function kv(i){var l=i,h=l.alternate;switch(l.tag){case 15:case 0:l=Kb(h,l,l.pendingProps,l.type,void 0,gs);break;case 11:l=Kb(h,l,l.pendingProps,l.type.render,l.ref,gs);break;case 5:$m(l);default:tv(h,l),l=fs=Ay(l,qn),l=Jb(h,l,qn)}i.memoizedProps=i.pendingProps,l===null?Ju(i):fs=l}function Ol(i,l,h,p){Pn=_o=null,$m(l),El=null,Fc=0;var N=l.return;try{if(QE(i,N,l,h,gs)){nr=1,Uu(i,Ra(h,i.current)),fs=null;return}}catch(A){if(N!==null)throw fs=N,A;nr=1,Uu(i,Ra(h,i.current)),fs=null;return}l.flags&32768?(bs||p===1?i=!0:Dl||(gs&536870912)!==0?i=!1:(Ti=i=!0,(p===2||p===9||p===3||p===6)&&(p=ga.current,p!==null&&p.tag===13&&(p.flags|=16384))),Rv(l,i)):Ju(l)}function Ju(i){var l=i;do{if((l.flags&32768)!==0){Rv(l,Ti);return}i=l.return;var h=JE(l.alternate,l,qn);if(h!==null){fs=h;return}if(l=l.sibling,l!==null){fs=l;return}fs=l=i}while(l!==null);nr===0&&(nr=5)}function Rv(i,l){do{var h=eT(i.alternate,i);if(h!==null){h.flags&=32767,fs=h;return}if(h=i.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!l&&(i=i.sibling,i!==null)){fs=i;return}fs=i=h}while(i!==null);nr=6,fs=null}function Lv(i,l,h,p,N,A,Y,ie,Te){i.cancelPendingCommit=null;do eh();while(vr!==0);if((Ts&6)!==0)throw Error(r(327));if(l!==null){if(l===i.current)throw Error(r(177));if(A=l.lanes|l.childLanes,A|=mm,gt(i,h,A,Y,ie,Te),i===$s&&(fs=$s=null,gs=0),Ml=l,ki=i,Kn=h,S0=A,_0=N,wv=p,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,hT(Ct,function(){return Ov(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||p){p=q.T,q.T=null,N=ae.p,ae.p=2,Y=Ts,Ts|=4;try{tT(i,l,h)}finally{Ts=Y,ae.p=N,q.T=p}}vr=1,Dv(),Iv(),Mv()}}function Dv(){if(vr===1){vr=0;var i=ki,l=Ml,h=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||h){h=q.T,q.T=null;var p=ae.p;ae.p=2;var N=Ts;Ts|=4;try{fv(l,i);var A=F0,Y=by(i.containerInfo),ie=A.focusedElem,Te=A.selectionRange;if(Y!==ie&&ie&&ie.ownerDocument&&yy(ie.ownerDocument.documentElement,ie)){if(Te!==null&&cm(ie)){var We=Te.start,ct=Te.end;if(ct===void 0&&(ct=We),"selectionStart"in ie)ie.selectionStart=We,ie.selectionEnd=Math.min(ct,ie.value.length);else{var pt=ie.ownerDocument||document,Xe=pt&&pt.defaultView||window;if(Xe.getSelection){var rt=Xe.getSelection(),Lt=ie.textContent.length,zt=Math.min(Te.start,Lt),Fs=Te.end===void 0?zt:Math.min(Te.end,Lt);!rt.extend&&zt>Fs&&(Y=Fs,Fs=zt,zt=Y);var $e=xy(ie,zt),Ie=xy(ie,Fs);if($e&&Ie&&(rt.rangeCount!==1||rt.anchorNode!==$e.node||rt.anchorOffset!==$e.offset||rt.focusNode!==Ie.node||rt.focusOffset!==Ie.offset)){var Ye=pt.createRange();Ye.setStart($e.node,$e.offset),rt.removeAllRanges(),zt>Fs?(rt.addRange(Ye),rt.extend(Ie.node,Ie.offset)):(Ye.setEnd(Ie.node,Ie.offset),rt.addRange(Ye))}}}}for(pt=[],rt=ie;rt=rt.parentNode;)rt.nodeType===1&&pt.push({element:rt,left:rt.scrollLeft,top:rt.scrollTop});for(typeof ie.focus=="function"&&ie.focus(),ie=0;ie<pt.length;ie++){var ft=pt[ie];ft.element.scrollLeft=ft.left,ft.element.scrollTop=ft.top}}hh=!!O0,F0=O0=null}finally{Ts=N,ae.p=p,q.T=h}}i.current=l,vr=2}}function Iv(){if(vr===2){vr=0;var i=ki,l=Ml,h=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||h){h=q.T,q.T=null;var p=ae.p;ae.p=2;var N=Ts;Ts|=4;try{lv(i,l.alternate,l)}finally{Ts=N,ae.p=p,q.T=h}}vr=3}}function Mv(){if(vr===4||vr===3){vr=0,Me();var i=ki,l=Ml,h=Kn,p=wv;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?vr=5:(vr=0,Ml=ki=null,Pv(i,i.pendingLanes));var N=i.pendingLanes;if(N===0&&(Ci=null),hs(h),l=l.stateNode,De&&typeof De.onCommitFiberRoot=="function")try{De.onCommitFiberRoot(me,l,void 0,(l.current.flags&128)===128)}catch{}if(p!==null){l=q.T,N=ae.p,ae.p=2,q.T=null;try{for(var A=i.onRecoverableError,Y=0;Y<p.length;Y++){var ie=p[Y];A(ie.value,{componentStack:ie.stack})}}finally{q.T=l,ae.p=N}}(Kn&3)!==0&&eh(),fn(i),N=i.pendingLanes,(h&261930)!==0&&(N&42)!==0?i===N0?td++:(td=0,N0=i):td=0,sd(0)}}function Pv(i,l){(i.pooledCacheLanes&=l)===0&&(l=i.pooledCache,l!=null&&(i.pooledCache=null,Pc(l)))}function eh(){return Dv(),Iv(),Mv(),Ov()}function Ov(){if(vr!==5)return!1;var i=ki,l=S0;S0=0;var h=hs(Kn),p=q.T,N=ae.p;try{ae.p=32>h?32:h,q.T=null,h=_0,_0=null;var A=ki,Y=Kn;if(vr=0,Ml=ki=null,Kn=0,(Ts&6)!==0)throw Error(r(331));var ie=Ts;if(Ts|=4,yv(A.current),gv(A,A.current,Y,h),Ts=ie,sd(0,!1),De&&typeof De.onPostCommitFiberRoot=="function")try{De.onPostCommitFiberRoot(me,A)}catch{}return!0}finally{ae.p=N,q.T=p,Pv(i,l)}}function Fv(i,l,h){l=Ra(h,l),l=s0(i.stateNode,l,2),i=_i(i,l,2),i!==null&&(Ne(i,2),fn(i))}function Ds(i,l,h){if(i.tag===3)Fv(i,i,h);else for(;l!==null;){if(l.tag===3){Fv(l,i,h);break}else if(l.tag===1){var p=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Ci===null||!Ci.has(p))){i=Ra(h,i),h=Bb(2),p=_i(l,h,2),p!==null&&(Ub(h,p,l,i),Ne(p,2),fn(p));break}}l=l.return}}function T0(i,l,h){var p=i.pingCache;if(p===null){p=i.pingCache=new aT;var N=new Set;p.set(l,N)}else N=p.get(l),N===void 0&&(N=new Set,p.set(l,N));N.has(h)||(b0=!0,N.add(h),i=cT.bind(null,i,l,h),l.then(i,i))}function cT(i,l,h){var p=i.pingCache;p!==null&&p.delete(l),i.pingedLanes|=i.suspendedLanes&h,i.warmLanes&=~h,$s===i&&(gs&h)===h&&(nr===4||nr===3&&(gs&62914560)===gs&&300>nt()-Yu?(Ts&2)===0&&Pl(i,0):v0|=h,Il===gs&&(Il=0)),fn(i)}function Bv(i,l){l===0&&(l=Kt()),i=vo(i,l),i!==null&&(Ne(i,l),fn(i))}function dT(i){var l=i.memoizedState,h=0;l!==null&&(h=l.retryLane),Bv(i,h)}function uT(i,l){var h=0;switch(i.tag){case 31:case 13:var p=i.stateNode,N=i.memoizedState;N!==null&&(h=N.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(r(314))}p!==null&&p.delete(l),Bv(i,h)}function hT(i,l){return _e(i,l)}var th=null,Fl=null,A0=!1,sh=!1,C0=!1,Li=0;function fn(i){i!==Fl&&i.next===null&&(Fl===null?th=Fl=i:Fl=Fl.next=i),sh=!0,A0||(A0=!0,mT())}function sd(i,l){if(!C0&&sh){C0=!0;do for(var h=!1,p=th;p!==null;){if(i!==0){var N=p.pendingLanes;if(N===0)var A=0;else{var Y=p.suspendedLanes,ie=p.pingedLanes;A=(1<<31-Fe(42|i)+1)-1,A&=N&~(Y&~ie),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(h=!0,Hv(p,A))}else A=gs,A=Vt(p,p===$s?A:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(A&3)===0||Nt(p,A)||(h=!0,Hv(p,A));p=p.next}while(h);C0=!1}}function fT(){Uv()}function Uv(){sh=A0=!1;var i=0;Li!==0&&NT()&&(i=Li);for(var l=nt(),h=null,p=th;p!==null;){var N=p.next,A=$v(p,l);A===0?(p.next=null,h===null?th=N:h.next=N,N===null&&(Fl=h)):(h=p,(i!==0||(A&3)!==0)&&(sh=!0)),p=N}vr!==0&&vr!==5||sd(i),Li!==0&&(Li=0)}function $v(i,l){for(var h=i.suspendedLanes,p=i.pingedLanes,N=i.expirationTimes,A=i.pendingLanes&-62914561;0<A;){var Y=31-Fe(A),ie=1<<Y,Te=N[Y];Te===-1?((ie&h)===0||(ie&p)!==0)&&(N[Y]=St(ie,l)):Te<=l&&(i.expiredLanes|=ie),A&=~ie}if(l=$s,h=gs,h=Vt(i,i===l?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,h===0||i===l&&(Ls===2||Ls===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&ge(p),i.callbackNode=null,i.callbackPriority=0;if((h&3)===0||Nt(i,h)){if(l=h&-h,l===i.callbackPriority)return l;switch(p!==null&&ge(p),hs(h)){case 2:case 8:h=tt;break;case 32:h=Ct;break;case 268435456:h=bt;break;default:h=Ct}return p=Gv.bind(null,i),h=_e(h,p),i.callbackPriority=l,i.callbackNode=h,l}return p!==null&&p!==null&&ge(p),i.callbackPriority=2,i.callbackNode=null,2}function Gv(i,l){if(vr!==0&&vr!==5)return i.callbackNode=null,i.callbackPriority=0,null;var h=i.callbackNode;if(eh()&&i.callbackNode!==h)return null;var p=gs;return p=Vt(i,i===$s?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(_v(i,p,l),$v(i,nt()),i.callbackNode!=null&&i.callbackNode===h?Gv.bind(null,i):null)}function Hv(i,l){if(eh())return null;_v(i,l,!0)}function mT(){ET(function(){(Ts&6)!==0?_e(Oe,fT):Uv()})}function k0(){if(Li===0){var i=_l;i===0&&(i=wt,wt<<=1,(wt&261888)===0&&(wt=256)),Li=i}return Li}function Vv(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:mo(""+i)}function zv(i,l){var h=l.ownerDocument.createElement("input");return h.name=l.name,h.value=l.value,i.id&&h.setAttribute("form",i.id),l.parentNode.insertBefore(h,l),i=new FormData(i),h.parentNode.removeChild(h),i}function gT(i,l,h,p,N){if(l==="submit"&&h&&h.stateNode===N){var A=Vv((N[_]||null).action),Y=p.submitter;Y&&(l=(l=Y[_]||null)?Vv(l.formAction):Y.getAttribute("formAction"),l!==null&&(A=l,Y=null));var ie=new mu("action","action",null,p,N);i.push({event:ie,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Li!==0){var Te=Y?zv(N,Y):new FormData(N);Qm(h,{pending:!0,data:Te,method:N.method,action:A},null,Te)}}else typeof A=="function"&&(ie.preventDefault(),Te=Y?zv(N,Y):new FormData(N),Qm(h,{pending:!0,data:Te,method:N.method,action:A},A,Te))},currentTarget:N}]})}}for(var R0=0;R0<fm.length;R0++){var L0=fm[R0],pT=L0.toLowerCase(),xT=L0[0].toUpperCase()+L0.slice(1);Ya(pT,"on"+xT)}Ya(Sy,"onAnimationEnd"),Ya(_y,"onAnimationIteration"),Ya(Ny,"onAnimationStart"),Ya("dblclick","onDoubleClick"),Ya("focusin","onFocus"),Ya("focusout","onBlur"),Ya(DE,"onTransitionRun"),Ya(IE,"onTransitionStart"),Ya(ME,"onTransitionCancel"),Ya(jy,"onTransitionEnd"),it("onMouseEnter",["mouseout","mouseover"]),it("onMouseLeave",["mouseout","mouseover"]),it("onPointerEnter",["pointerout","pointerover"]),it("onPointerLeave",["pointerout","pointerover"]),Je("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Je("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Je("onBeforeInput",["compositionend","keypress","textInput","paste"]),Je("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Je("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Je("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(rd));function qv(i,l){l=(l&4)!==0;for(var h=0;h<i.length;h++){var p=i[h],N=p.event;p=p.listeners;e:{var A=void 0;if(l)for(var Y=p.length-1;0<=Y;Y--){var ie=p[Y],Te=ie.instance,We=ie.currentTarget;if(ie=ie.listener,Te!==A&&N.isPropagationStopped())break e;A=ie,N.currentTarget=We;try{A(N)}catch(ct){xu(ct)}N.currentTarget=null,A=Te}else for(Y=0;Y<p.length;Y++){if(ie=p[Y],Te=ie.instance,We=ie.currentTarget,ie=ie.listener,Te!==A&&N.isPropagationStopped())break e;A=ie,N.currentTarget=We;try{A(N)}catch(ct){xu(ct)}N.currentTarget=null,A=Te}}}}function ms(i,l){var h=l[L];h===void 0&&(h=l[L]=new Set);var p=i+"__bubble";h.has(p)||(Kv(l,i,2,!1),h.add(p))}function D0(i,l,h){var p=0;l&&(p|=4),Kv(h,i,p,l)}var rh="_reactListening"+Math.random().toString(36).slice(2);function I0(i){if(!i[rh]){i[rh]=!0,re.forEach(function(h){h!=="selectionchange"&&(yT.has(h)||D0(h,!1,i),D0(h,!0,i))});var l=i.nodeType===9?i:i.ownerDocument;l===null||l[rh]||(l[rh]=!0,D0("selectionchange",!1,l))}}function Kv(i,l,h,p){switch(Sw(l)){case 2:var N=qT;break;case 8:N=KT;break;default:N=W0}h=N.bind(null,l,h,i),N=void 0,!Ec||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(N=!0),p?N!==void 0?i.addEventListener(l,h,{capture:!0,passive:N}):i.addEventListener(l,h,!0):N!==void 0?i.addEventListener(l,h,{passive:N}):i.addEventListener(l,h,!1)}function M0(i,l,h,p,N){var A=p;if((l&1)===0&&(l&2)===0&&p!==null)e:for(;;){if(p===null)return;var Y=p.tag;if(Y===3||Y===4){var ie=p.stateNode.containerInfo;if(ie===N)break;if(Y===4)for(Y=p.return;Y!==null;){var Te=Y.tag;if((Te===3||Te===4)&&Y.stateNode.containerInfo===N)return;Y=Y.return}for(;ie!==null;){if(Y=fe(ie),Y===null)return;if(Te=Y.tag,Te===5||Te===6||Te===26||Te===27){p=A=Y;continue e}ie=ie.parentNode}}p=p.return}jc(function(){var We=A,ct=Ln(h),pt=[];e:{var Xe=Ey.get(i);if(Xe!==void 0){var rt=mu,Lt=i;switch(i){case"keypress":if(hu(h)===0)break e;case"keydown":case"keyup":rt=uE;break;case"focusin":Lt="focus",rt=am;break;case"focusout":Lt="blur",rt=am;break;case"beforeblur":case"afterblur":rt=am;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":rt=ty;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":rt=J2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":rt=mE;break;case Sy:case _y:case Ny:rt=sE;break;case jy:rt=pE;break;case"scroll":case"scrollend":rt=X2;break;case"wheel":rt=yE;break;case"copy":case"cut":case"paste":rt=aE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":rt=ry;break;case"toggle":case"beforetoggle":rt=vE}var zt=(l&4)!==0,Fs=!zt&&(i==="scroll"||i==="scrollend"),$e=zt?Xe!==null?Xe+"Capture":null:Xe;zt=[];for(var Ie=We,Ye;Ie!==null;){var ft=Ie;if(Ye=ft.stateNode,ft=ft.tag,ft!==5&&ft!==26&&ft!==27||Ye===null||$e===null||(ft=Dn(Ie,$e),ft!=null&&zt.push(ad(Ie,ft,Ye))),Fs)break;Ie=Ie.return}0<zt.length&&(Xe=new rt(Xe,Lt,null,h,ct),pt.push({event:Xe,listeners:zt}))}}if((l&7)===0){e:{if(Xe=i==="mouseover"||i==="pointerover",rt=i==="mouseout"||i==="pointerout",Xe&&h!==go&&(Lt=h.relatedTarget||h.fromElement)&&(fe(Lt)||Lt[P]))break e;if((rt||Xe)&&(Xe=ct.window===ct?ct:(Xe=ct.ownerDocument)?Xe.defaultView||Xe.parentWindow:window,rt?(Lt=h.relatedTarget||h.toElement,rt=We,Lt=Lt?fe(Lt):null,Lt!==null&&(Fs=o(Lt),zt=Lt.tag,Lt!==Fs||zt!==5&&zt!==27&&zt!==6)&&(Lt=null)):(rt=null,Lt=We),rt!==Lt)){if(zt=ty,ft="onMouseLeave",$e="onMouseEnter",Ie="mouse",(i==="pointerout"||i==="pointerover")&&(zt=ry,ft="onPointerLeave",$e="onPointerEnter",Ie="pointer"),Fs=rt==null?Xe:pe(rt),Ye=Lt==null?Xe:pe(Lt),Xe=new zt(ft,Ie+"leave",rt,h,ct),Xe.target=Fs,Xe.relatedTarget=Ye,ft=null,fe(ct)===We&&(zt=new zt($e,Ie+"enter",Lt,h,ct),zt.target=Ye,zt.relatedTarget=Fs,ft=zt),Fs=ft,rt&&Lt)t:{for(zt=bT,$e=rt,Ie=Lt,Ye=0,ft=$e;ft;ft=zt(ft))Ye++;ft=0;for(var Gt=Ie;Gt;Gt=zt(Gt))ft++;for(;0<Ye-ft;)$e=zt($e),Ye--;for(;0<ft-Ye;)Ie=zt(Ie),ft--;for(;Ye--;){if($e===Ie||Ie!==null&&$e===Ie.alternate){zt=$e;break t}$e=zt($e),Ie=zt(Ie)}zt=null}else zt=null;rt!==null&&Yv(pt,Xe,rt,zt,!1),Lt!==null&&Fs!==null&&Yv(pt,Fs,Lt,zt,!0)}}e:{if(Xe=We?pe(We):window,rt=Xe.nodeName&&Xe.nodeName.toLowerCase(),rt==="select"||rt==="input"&&Xe.type==="file")var Ns=uy;else if(cy(Xe))if(hy)Ns=kE;else{Ns=AE;var Ot=TE}else rt=Xe.nodeName,!rt||rt.toLowerCase()!=="input"||Xe.type!=="checkbox"&&Xe.type!=="radio"?We&&ul(We.elementType)&&(Ns=uy):Ns=CE;if(Ns&&(Ns=Ns(i,We))){dy(pt,Ns,h,ct);break e}Ot&&Ot(i,Xe,We),i==="focusout"&&We&&Xe.type==="number"&&We.memoizedProps.value!=null&&mr(Xe,"number",Xe.value)}switch(Ot=We?pe(We):window,i){case"focusin":(cy(Ot)||Ot.contentEditable==="true")&&(gl=Ot,dm=We,Dc=null);break;case"focusout":Dc=dm=gl=null;break;case"mousedown":um=!0;break;case"contextmenu":case"mouseup":case"dragend":um=!1,vy(pt,h,ct);break;case"selectionchange":if(LE)break;case"keydown":case"keyup":vy(pt,h,ct)}var as;if(im)e:{switch(i){case"compositionstart":var ps="onCompositionStart";break e;case"compositionend":ps="onCompositionEnd";break e;case"compositionupdate":ps="onCompositionUpdate";break e}ps=void 0}else ml?oy(i,h)&&(ps="onCompositionEnd"):i==="keydown"&&h.keyCode===229&&(ps="onCompositionStart");ps&&(ay&&h.locale!=="ko"&&(ml||ps!=="onCompositionStart"?ps==="onCompositionEnd"&&ml&&(as=Jx()):(Ka=ct,fl="value"in Ka?Ka.value:Ka.textContent,ml=!0)),Ot=ah(We,ps),0<Ot.length&&(ps=new sy(ps,i,null,h,ct),pt.push({event:ps,listeners:Ot}),as?ps.data=as:(as=ly(h),as!==null&&(ps.data=as)))),(as=SE?_E(i,h):NE(i,h))&&(ps=ah(We,"onBeforeInput"),0<ps.length&&(Ot=new sy("onBeforeInput","beforeinput",null,h,ct),pt.push({event:Ot,listeners:ps}),Ot.data=as)),gT(pt,i,We,h,ct)}qv(pt,l)})}function ad(i,l,h){return{instance:i,listener:l,currentTarget:h}}function ah(i,l){for(var h=l+"Capture",p=[];i!==null;){var N=i,A=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||A===null||(N=Dn(i,h),N!=null&&p.unshift(ad(i,N,A)),N=Dn(i,l),N!=null&&p.push(ad(i,N,A))),i.tag===3)return p;i=i.return}return[]}function bT(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function Yv(i,l,h,p,N){for(var A=l._reactName,Y=[];h!==null&&h!==p;){var ie=h,Te=ie.alternate,We=ie.stateNode;if(ie=ie.tag,Te!==null&&Te===p)break;ie!==5&&ie!==26&&ie!==27||We===null||(Te=We,N?(We=Dn(h,A),We!=null&&Y.unshift(ad(h,We,Te))):N||(We=Dn(h,A),We!=null&&Y.push(ad(h,We,Te)))),h=h.return}Y.length!==0&&i.push({event:l,listeners:Y})}var vT=/\r\n?/g,wT=/\u0000|\uFFFD/g;function Wv(i){return(typeof i=="string"?i:""+i).replace(vT,`
`).replace(wT,"")}function Qv(i,l){return l=Wv(l),Wv(i)===l}function Os(i,l,h,p,N,A){switch(h){case"children":typeof p=="string"?l==="body"||l==="textarea"&&p===""||Fr(i,p):(typeof p=="number"||typeof p=="bigint")&&l!=="body"&&Fr(i,""+p);break;case"className":Bt(i,"class",p);break;case"tabIndex":Bt(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Bt(i,h,p);break;case"style":du(i,p,A);break;case"data":if(l!=="object"){Bt(i,"data",p);break}case"src":case"href":if(p===""&&(l!=="a"||h!=="href")){i.removeAttribute(h);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(h);break}p=mo(""+p),i.setAttribute(h,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(h==="formAction"?(l!=="input"&&Os(i,l,"name",N.name,N,null),Os(i,l,"formEncType",N.formEncType,N,null),Os(i,l,"formMethod",N.formMethod,N,null),Os(i,l,"formTarget",N.formTarget,N,null)):(Os(i,l,"encType",N.encType,N,null),Os(i,l,"method",N.method,N,null),Os(i,l,"target",N.target,N,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(h);break}p=mo(""+p),i.setAttribute(h,p);break;case"onClick":p!=null&&(i.onclick=ha);break;case"onScroll":p!=null&&ms("scroll",i);break;case"onScrollEnd":p!=null&&ms("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(h=p.__html,h!=null){if(N.children!=null)throw Error(r(60));i.innerHTML=h}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}h=mo(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(h,""+p):i.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(h,""):i.removeAttribute(h);break;case"capture":case"download":p===!0?i.setAttribute(h,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(h,p):i.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(h,p):i.removeAttribute(h);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(h):i.setAttribute(h,p);break;case"popover":ms("beforetoggle",i),ms("toggle",i),Wt(i,"popover",p);break;case"xlinkActuate":It(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":It(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":It(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":It(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":It(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":It(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":It(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":It(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":It(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Wt(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=ho.get(h)||h,Wt(i,h,p))}}function P0(i,l,h,p,N,A){switch(h){case"style":du(i,p,A);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(h=p.__html,h!=null){if(N.children!=null)throw Error(r(60));i.innerHTML=h}}break;case"children":typeof p=="string"?Fr(i,p):(typeof p=="number"||typeof p=="bigint")&&Fr(i,""+p);break;case"onScroll":p!=null&&ms("scroll",i);break;case"onScrollEnd":p!=null&&ms("scrollend",i);break;case"onClick":p!=null&&(i.onclick=ha);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Le.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(N=h.endsWith("Capture"),l=h.slice(2,N?h.length-7:void 0),A=i[_]||null,A=A!=null?A[h]:null,typeof A=="function"&&i.removeEventListener(l,A,N),typeof p=="function")){typeof A!="function"&&A!==null&&(h in i?i[h]=null:i.hasAttribute(h)&&i.removeAttribute(h)),i.addEventListener(l,p,N);break e}h in i?i[h]=p:p===!0?i.setAttribute(h,""):Wt(i,h,p)}}}function Lr(i,l,h){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ms("error",i),ms("load",i);var p=!1,N=!1,A;for(A in h)if(h.hasOwnProperty(A)){var Y=h[A];if(Y!=null)switch(A){case"src":p=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Os(i,l,A,Y,h,null)}}N&&Os(i,l,"srcSet",h.srcSet,h,null),p&&Os(i,l,"src",h.src,h,null);return;case"input":ms("invalid",i);var ie=A=Y=N=null,Te=null,We=null;for(p in h)if(h.hasOwnProperty(p)){var ct=h[p];if(ct!=null)switch(p){case"name":N=ct;break;case"type":Y=ct;break;case"checked":Te=ct;break;case"defaultChecked":We=ct;break;case"value":A=ct;break;case"defaultValue":ie=ct;break;case"children":case"dangerouslySetInnerHTML":if(ct!=null)throw Error(r(137,l));break;default:Os(i,l,p,ct,h,null)}}Nr(i,A,ie,Te,We,Y,N,!1);return;case"select":ms("invalid",i),p=Y=A=null;for(N in h)if(h.hasOwnProperty(N)&&(ie=h[N],ie!=null))switch(N){case"value":A=ie;break;case"defaultValue":Y=ie;break;case"multiple":p=ie;default:Os(i,l,N,ie,h,null)}l=A,h=Y,i.multiple=!!p,l!=null?rr(i,!!p,l,!1):h!=null&&rr(i,!!p,h,!0);return;case"textarea":ms("invalid",i),A=N=p=null;for(Y in h)if(h.hasOwnProperty(Y)&&(ie=h[Y],ie!=null))switch(Y){case"value":p=ie;break;case"defaultValue":N=ie;break;case"children":A=ie;break;case"dangerouslySetInnerHTML":if(ie!=null)throw Error(r(91));break;default:Os(i,l,Y,ie,h,null)}Aa(i,p,N,A);return;case"option":for(Te in h)if(h.hasOwnProperty(Te)&&(p=h[Te],p!=null))switch(Te){case"selected":i.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Os(i,l,Te,p,h,null)}return;case"dialog":ms("beforetoggle",i),ms("toggle",i),ms("cancel",i),ms("close",i);break;case"iframe":case"object":ms("load",i);break;case"video":case"audio":for(p=0;p<rd.length;p++)ms(rd[p],i);break;case"image":ms("error",i),ms("load",i);break;case"details":ms("toggle",i);break;case"embed":case"source":case"link":ms("error",i),ms("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(We in h)if(h.hasOwnProperty(We)&&(p=h[We],p!=null))switch(We){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Os(i,l,We,p,h,null)}return;default:if(ul(l)){for(ct in h)h.hasOwnProperty(ct)&&(p=h[ct],p!==void 0&&P0(i,l,ct,p,h,void 0));return}}for(ie in h)h.hasOwnProperty(ie)&&(p=h[ie],p!=null&&Os(i,l,ie,p,h,null))}function ST(i,l,h,p){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,A=null,Y=null,ie=null,Te=null,We=null,ct=null;for(rt in h){var pt=h[rt];if(h.hasOwnProperty(rt)&&pt!=null)switch(rt){case"checked":break;case"value":break;case"defaultValue":Te=pt;default:p.hasOwnProperty(rt)||Os(i,l,rt,null,p,pt)}}for(var Xe in p){var rt=p[Xe];if(pt=h[Xe],p.hasOwnProperty(Xe)&&(rt!=null||pt!=null))switch(Xe){case"type":A=rt;break;case"name":N=rt;break;case"checked":We=rt;break;case"defaultChecked":ct=rt;break;case"value":Y=rt;break;case"defaultValue":ie=rt;break;case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(r(137,l));break;default:rt!==pt&&Os(i,l,Xe,rt,p,pt)}}Ar(i,Y,ie,Te,We,ct,A,N);return;case"select":rt=Y=ie=Xe=null;for(A in h)if(Te=h[A],h.hasOwnProperty(A)&&Te!=null)switch(A){case"value":break;case"multiple":rt=Te;default:p.hasOwnProperty(A)||Os(i,l,A,null,p,Te)}for(N in p)if(A=p[N],Te=h[N],p.hasOwnProperty(N)&&(A!=null||Te!=null))switch(N){case"value":Xe=A;break;case"defaultValue":ie=A;break;case"multiple":Y=A;default:A!==Te&&Os(i,l,N,A,p,Te)}l=ie,h=Y,p=rt,Xe!=null?rr(i,!!h,Xe,!1):!!p!=!!h&&(l!=null?rr(i,!!h,l,!0):rr(i,!!h,h?[]:"",!1));return;case"textarea":rt=Xe=null;for(ie in h)if(N=h[ie],h.hasOwnProperty(ie)&&N!=null&&!p.hasOwnProperty(ie))switch(ie){case"value":break;case"children":break;default:Os(i,l,ie,null,p,N)}for(Y in p)if(N=p[Y],A=h[Y],p.hasOwnProperty(Y)&&(N!=null||A!=null))switch(Y){case"value":Xe=N;break;case"defaultValue":rt=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(r(91));break;default:N!==A&&Os(i,l,Y,N,p,A)}ys(i,Xe,rt);return;case"option":for(var Lt in h)if(Xe=h[Lt],h.hasOwnProperty(Lt)&&Xe!=null&&!p.hasOwnProperty(Lt))switch(Lt){case"selected":i.selected=!1;break;default:Os(i,l,Lt,null,p,Xe)}for(Te in p)if(Xe=p[Te],rt=h[Te],p.hasOwnProperty(Te)&&Xe!==rt&&(Xe!=null||rt!=null))switch(Te){case"selected":i.selected=Xe&&typeof Xe!="function"&&typeof Xe!="symbol";break;default:Os(i,l,Te,Xe,p,rt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var zt in h)Xe=h[zt],h.hasOwnProperty(zt)&&Xe!=null&&!p.hasOwnProperty(zt)&&Os(i,l,zt,null,p,Xe);for(We in p)if(Xe=p[We],rt=h[We],p.hasOwnProperty(We)&&Xe!==rt&&(Xe!=null||rt!=null))switch(We){case"children":case"dangerouslySetInnerHTML":if(Xe!=null)throw Error(r(137,l));break;default:Os(i,l,We,Xe,p,rt)}return;default:if(ul(l)){for(var Fs in h)Xe=h[Fs],h.hasOwnProperty(Fs)&&Xe!==void 0&&!p.hasOwnProperty(Fs)&&P0(i,l,Fs,void 0,p,Xe);for(ct in p)Xe=p[ct],rt=h[ct],!p.hasOwnProperty(ct)||Xe===rt||Xe===void 0&&rt===void 0||P0(i,l,ct,Xe,p,rt);return}}for(var $e in h)Xe=h[$e],h.hasOwnProperty($e)&&Xe!=null&&!p.hasOwnProperty($e)&&Os(i,l,$e,null,p,Xe);for(pt in p)Xe=p[pt],rt=h[pt],!p.hasOwnProperty(pt)||Xe===rt||Xe==null&&rt==null||Os(i,l,pt,Xe,p,rt)}function Xv(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function _T(){if(typeof performance.getEntriesByType=="function"){for(var i=0,l=0,h=performance.getEntriesByType("resource"),p=0;p<h.length;p++){var N=h[p],A=N.transferSize,Y=N.initiatorType,ie=N.duration;if(A&&ie&&Xv(Y)){for(Y=0,ie=N.responseEnd,p+=1;p<h.length;p++){var Te=h[p],We=Te.startTime;if(We>ie)break;var ct=Te.transferSize,pt=Te.initiatorType;ct&&Xv(pt)&&(Te=Te.responseEnd,Y+=ct*(Te<ie?1:(ie-We)/(Te-We)))}if(--p,l+=8*(A+Y)/(N.duration/1e3),i++,10<i)break}}if(0<i)return l/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var O0=null,F0=null;function nh(i){return i.nodeType===9?i:i.ownerDocument}function Zv(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Jv(i,l){if(i===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&l==="foreignObject"?0:i}function B0(i,l){return i==="textarea"||i==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var U0=null;function NT(){var i=window.event;return i&&i.type==="popstate"?i===U0?!1:(U0=i,!0):(U0=null,!1)}var ew=typeof setTimeout=="function"?setTimeout:void 0,jT=typeof clearTimeout=="function"?clearTimeout:void 0,tw=typeof Promise=="function"?Promise:void 0,ET=typeof queueMicrotask=="function"?queueMicrotask:typeof tw<"u"?function(i){return tw.resolve(null).then(i).catch(TT)}:ew;function TT(i){setTimeout(function(){throw i})}function Di(i){return i==="head"}function sw(i,l){var h=l,p=0;do{var N=h.nextSibling;if(i.removeChild(h),N&&N.nodeType===8)if(h=N.data,h==="/$"||h==="/&"){if(p===0){i.removeChild(N),Gl(l);return}p--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")p++;else if(h==="html")nd(i.ownerDocument.documentElement);else if(h==="head"){h=i.ownerDocument.head,nd(h);for(var A=h.firstChild;A;){var Y=A.nextSibling,ie=A.nodeName;A[B]||ie==="SCRIPT"||ie==="STYLE"||ie==="LINK"&&A.rel.toLowerCase()==="stylesheet"||h.removeChild(A),A=Y}}else h==="body"&&nd(i.ownerDocument.body);h=N}while(h);Gl(l)}function rw(i,l){var h=i;i=0;do{var p=h.nextSibling;if(h.nodeType===1?l?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(l?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),p&&p.nodeType===8)if(h=p.data,h==="/$"){if(i===0)break;i--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||i++;h=p}while(h)}function $0(i){var l=i.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var h=l;switch(l=l.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":$0(h),se(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}i.removeChild(h)}}function AT(i,l,h,p){for(;i.nodeType===1;){var N=h;if(i.nodeName.toLowerCase()!==l.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[B])switch(l){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(A=i.getAttribute("rel"),A==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(A!==N.rel||i.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||i.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||i.getAttribute("title")!==(N.title==null?null:N.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(A=i.getAttribute("src"),(A!==(N.src==null?null:N.src)||i.getAttribute("type")!==(N.type==null?null:N.type)||i.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&A&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(l==="input"&&i.type==="hidden"){var A=N.name==null?null:""+N.name;if(N.type==="hidden"&&i.getAttribute("name")===A)return i}else return i;if(i=Pa(i.nextSibling),i===null)break}return null}function CT(i,l,h){if(l==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!h||(i=Pa(i.nextSibling),i===null))return null;return i}function aw(i,l){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!l||(i=Pa(i.nextSibling),i===null))return null;return i}function G0(i){return i.data==="$?"||i.data==="$~"}function H0(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function kT(i,l){var h=i.ownerDocument;if(i.data==="$~")i._reactRetry=l;else if(i.data!=="$?"||h.readyState!=="loading")l();else{var p=function(){l(),h.removeEventListener("DOMContentLoaded",p)};h.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function Pa(i){for(;i!=null;i=i.nextSibling){var l=i.nodeType;if(l===1||l===3)break;if(l===8){if(l=i.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return i}var V0=null;function nw(i){i=i.nextSibling;for(var l=0;i;){if(i.nodeType===8){var h=i.data;if(h==="/$"||h==="/&"){if(l===0)return Pa(i.nextSibling);l--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||l++}i=i.nextSibling}return null}function iw(i){i=i.previousSibling;for(var l=0;i;){if(i.nodeType===8){var h=i.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(l===0)return i;l--}else h!=="/$"&&h!=="/&"||l++}i=i.previousSibling}return null}function ow(i,l,h){switch(l=nh(h),i){case"html":if(i=l.documentElement,!i)throw Error(r(452));return i;case"head":if(i=l.head,!i)throw Error(r(453));return i;case"body":if(i=l.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}function nd(i){for(var l=i.attributes;l.length;)i.removeAttributeNode(l[0]);se(i)}var Oa=new Map,lw=new Set;function ih(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Yn=ae.d;ae.d={f:RT,r:LT,D:DT,C:IT,L:MT,m:PT,X:FT,S:OT,M:BT};function RT(){var i=Yn.f(),l=Xu();return i||l}function LT(i){var l=he(i);l!==null&&l.tag===5&&l.type==="form"?jb(l):Yn.r(i)}var Bl=typeof document>"u"?null:document;function cw(i,l,h){var p=Bl;if(p&&typeof l=="string"&&l){var N=Rs(l);N='link[rel="'+i+'"][href="'+N+'"]',typeof h=="string"&&(N+='[crossorigin="'+h+'"]'),lw.has(N)||(lw.add(N),i={rel:i,crossOrigin:h,href:l},p.querySelector(N)===null&&(l=p.createElement("link"),Lr(l,"link",i),Ge(l),p.head.appendChild(l)))}}function DT(i){Yn.D(i),cw("dns-prefetch",i,null)}function IT(i,l){Yn.C(i,l),cw("preconnect",i,l)}function MT(i,l,h){Yn.L(i,l,h);var p=Bl;if(p&&i&&l){var N='link[rel="preload"][as="'+Rs(l)+'"]';l==="image"&&h&&h.imageSrcSet?(N+='[imagesrcset="'+Rs(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(N+='[imagesizes="'+Rs(h.imageSizes)+'"]')):N+='[href="'+Rs(i)+'"]';var A=N;switch(l){case"style":A=Ul(i);break;case"script":A=$l(i)}Oa.has(A)||(i=g({rel:"preload",href:l==="image"&&h&&h.imageSrcSet?void 0:i,as:l},h),Oa.set(A,i),p.querySelector(N)!==null||l==="style"&&p.querySelector(id(A))||l==="script"&&p.querySelector(od(A))||(l=p.createElement("link"),Lr(l,"link",i),Ge(l),p.head.appendChild(l)))}}function PT(i,l){Yn.m(i,l);var h=Bl;if(h&&i){var p=l&&typeof l.as=="string"?l.as:"script",N='link[rel="modulepreload"][as="'+Rs(p)+'"][href="'+Rs(i)+'"]',A=N;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=$l(i)}if(!Oa.has(A)&&(i=g({rel:"modulepreload",href:i},l),Oa.set(A,i),h.querySelector(N)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(od(A)))return}p=h.createElement("link"),Lr(p,"link",i),Ge(p),h.head.appendChild(p)}}}function OT(i,l,h){Yn.S(i,l,h);var p=Bl;if(p&&i){var N=Ue(p).hoistableStyles,A=Ul(i);l=l||"default";var Y=N.get(A);if(!Y){var ie={loading:0,preload:null};if(Y=p.querySelector(id(A)))ie.loading=5;else{i=g({rel:"stylesheet",href:i,"data-precedence":l},h),(h=Oa.get(A))&&z0(i,h);var Te=Y=p.createElement("link");Ge(Te),Lr(Te,"link",i),Te._p=new Promise(function(We,ct){Te.onload=We,Te.onerror=ct}),Te.addEventListener("load",function(){ie.loading|=1}),Te.addEventListener("error",function(){ie.loading|=2}),ie.loading|=4,oh(Y,l,p)}Y={type:"stylesheet",instance:Y,count:1,state:ie},N.set(A,Y)}}}function FT(i,l){Yn.X(i,l);var h=Bl;if(h&&i){var p=Ue(h).hoistableScripts,N=$l(i),A=p.get(N);A||(A=h.querySelector(od(N)),A||(i=g({src:i,async:!0},l),(l=Oa.get(N))&&q0(i,l),A=h.createElement("script"),Ge(A),Lr(A,"link",i),h.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},p.set(N,A))}}function BT(i,l){Yn.M(i,l);var h=Bl;if(h&&i){var p=Ue(h).hoistableScripts,N=$l(i),A=p.get(N);A||(A=h.querySelector(od(N)),A||(i=g({src:i,async:!0,type:"module"},l),(l=Oa.get(N))&&q0(i,l),A=h.createElement("script"),Ge(A),Lr(A,"link",i),h.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},p.set(N,A))}}function dw(i,l,h,p){var N=(N=je.current)?ih(N):null;if(!N)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(l=Ul(h.href),h=Ue(N).hoistableStyles,p=h.get(l),p||(p={type:"style",instance:null,count:0,state:null},h.set(l,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){i=Ul(h.href);var A=Ue(N).hoistableStyles,Y=A.get(i);if(Y||(N=N.ownerDocument||N,Y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(i,Y),(A=N.querySelector(id(i)))&&!A._p&&(Y.instance=A,Y.state.loading=5),Oa.has(i)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Oa.set(i,h),A||UT(N,i,h,Y.state))),l&&p===null)throw Error(r(528,""));return Y}if(l&&p!==null)throw Error(r(529,""));return null;case"script":return l=h.async,h=h.src,typeof h=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=$l(h),h=Ue(N).hoistableScripts,p=h.get(l),p||(p={type:"script",instance:null,count:0,state:null},h.set(l,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function Ul(i){return'href="'+Rs(i)+'"'}function id(i){return'link[rel="stylesheet"]['+i+"]"}function uw(i){return g({},i,{"data-precedence":i.precedence,precedence:null})}function UT(i,l,h,p){i.querySelector('link[rel="preload"][as="style"]['+l+"]")?p.loading=1:(l=i.createElement("link"),p.preload=l,l.addEventListener("load",function(){return p.loading|=1}),l.addEventListener("error",function(){return p.loading|=2}),Lr(l,"link",h),Ge(l),i.head.appendChild(l))}function $l(i){return'[src="'+Rs(i)+'"]'}function od(i){return"script[async]"+i}function hw(i,l,h){if(l.count++,l.instance===null)switch(l.type){case"style":var p=i.querySelector('style[data-href~="'+Rs(h.href)+'"]');if(p)return l.instance=p,Ge(p),p;var N=g({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),Ge(p),Lr(p,"style",N),oh(p,h.precedence,i),l.instance=p;case"stylesheet":N=Ul(h.href);var A=i.querySelector(id(N));if(A)return l.state.loading|=4,l.instance=A,Ge(A),A;p=uw(h),(N=Oa.get(N))&&z0(p,N),A=(i.ownerDocument||i).createElement("link"),Ge(A);var Y=A;return Y._p=new Promise(function(ie,Te){Y.onload=ie,Y.onerror=Te}),Lr(A,"link",p),l.state.loading|=4,oh(A,h.precedence,i),l.instance=A;case"script":return A=$l(h.src),(N=i.querySelector(od(A)))?(l.instance=N,Ge(N),N):(p=h,(N=Oa.get(A))&&(p=g({},h),q0(p,N)),i=i.ownerDocument||i,N=i.createElement("script"),Ge(N),Lr(N,"link",p),i.head.appendChild(N),l.instance=N);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(p=l.instance,l.state.loading|=4,oh(p,h.precedence,i));return l.instance}function oh(i,l,h){for(var p=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=p.length?p[p.length-1]:null,A=N,Y=0;Y<p.length;Y++){var ie=p[Y];if(ie.dataset.precedence===l)A=ie;else if(A!==N)break}A?A.parentNode.insertBefore(i,A.nextSibling):(l=h.nodeType===9?h.head:h,l.insertBefore(i,l.firstChild))}function z0(i,l){i.crossOrigin==null&&(i.crossOrigin=l.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=l.referrerPolicy),i.title==null&&(i.title=l.title)}function q0(i,l){i.crossOrigin==null&&(i.crossOrigin=l.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=l.referrerPolicy),i.integrity==null&&(i.integrity=l.integrity)}var lh=null;function fw(i,l,h){if(lh===null){var p=new Map,N=lh=new Map;N.set(h,p)}else N=lh,p=N.get(h),p||(p=new Map,N.set(h,p));if(p.has(i))return p;for(p.set(i,null),h=h.getElementsByTagName(i),N=0;N<h.length;N++){var A=h[N];if(!(A[B]||A[j]||i==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var Y=A.getAttribute(l)||"";Y=i+Y;var ie=p.get(Y);ie?ie.push(A):p.set(Y,[A])}}return p}function mw(i,l,h){i=i.ownerDocument||i,i.head.insertBefore(h,l==="title"?i.querySelector("head > title"):null)}function $T(i,l,h){if(h===1||l.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return i=l.disabled,typeof l.precedence=="string"&&i==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function gw(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function GT(i,l,h,p){if(h.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var N=Ul(p.href),A=l.querySelector(id(N));if(A){l=A._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(i.count++,i=ch.bind(i),l.then(i,i)),h.state.loading|=4,h.instance=A,Ge(A);return}A=l.ownerDocument||l,p=uw(p),(N=Oa.get(N))&&z0(p,N),A=A.createElement("link"),Ge(A);var Y=A;Y._p=new Promise(function(ie,Te){Y.onload=ie,Y.onerror=Te}),Lr(A,"link",p),h.instance=A}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(h,l),(l=h.state.preload)&&(h.state.loading&3)===0&&(i.count++,h=ch.bind(i),l.addEventListener("load",h),l.addEventListener("error",h))}}var K0=0;function HT(i,l){return i.stylesheets&&i.count===0&&uh(i,i.stylesheets),0<i.count||0<i.imgCount?function(h){var p=setTimeout(function(){if(i.stylesheets&&uh(i,i.stylesheets),i.unsuspend){var A=i.unsuspend;i.unsuspend=null,A()}},6e4+l);0<i.imgBytes&&K0===0&&(K0=62500*_T());var N=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&uh(i,i.stylesheets),i.unsuspend)){var A=i.unsuspend;i.unsuspend=null,A()}},(i.imgBytes>K0?50:800)+l);return i.unsuspend=h,function(){i.unsuspend=null,clearTimeout(p),clearTimeout(N)}}:null}function ch(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)uh(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var dh=null;function uh(i,l){i.stylesheets=null,i.unsuspend!==null&&(i.count++,dh=new Map,l.forEach(VT,i),dh=null,ch.call(i))}function VT(i,l){if(!(l.state.loading&4)){var h=dh.get(i);if(h)var p=h.get(null);else{h=new Map,dh.set(i,h);for(var N=i.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<N.length;A++){var Y=N[A];(Y.nodeName==="LINK"||Y.getAttribute("media")!=="not all")&&(h.set(Y.dataset.precedence,Y),p=Y)}p&&h.set(null,p)}N=l.instance,Y=N.getAttribute("data-precedence"),A=h.get(Y)||p,A===p&&h.set(null,N),h.set(Y,N),this.count++,p=ch.bind(this),N.addEventListener("load",p),N.addEventListener("error",p),A?A.parentNode.insertBefore(N,A.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(N,i.firstChild)),l.state.loading|=4}}var ld={$$typeof:E,Provider:null,Consumer:null,_currentValue:ce,_currentValue2:ce,_threadCount:0};function zT(i,l,h,p,N,A,Y,ie,Te){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ws(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ws(0),this.hiddenUpdates=ws(null),this.identifierPrefix=p,this.onUncaughtError=N,this.onCaughtError=A,this.onRecoverableError=Y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Te,this.incompleteTransitions=new Map}function pw(i,l,h,p,N,A,Y,ie,Te,We,ct,pt){return i=new zT(i,l,h,Y,Te,We,ct,pt,ie),l=1,A===!0&&(l|=24),A=ma(3,null,null,l),i.current=A,A.stateNode=i,l=Em(),l.refCount++,i.pooledCache=l,l.refCount++,A.memoizedState={element:p,isDehydrated:h,cache:l},km(A),i}function xw(i){return i?(i=yl,i):yl}function yw(i,l,h,p,N,A){N=xw(N),p.context===null?p.context=N:p.pendingContext=N,p=Si(l),p.payload={element:h},A=A===void 0?null:A,A!==null&&(p.callback=A),h=_i(i,p,l),h!==null&&(ea(h,i,l),Uc(h,i,l))}function bw(i,l){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var h=i.retryLane;i.retryLane=h!==0&&h<l?h:l}}function Y0(i,l){bw(i,l),(i=i.alternate)&&bw(i,l)}function vw(i){if(i.tag===13||i.tag===31){var l=vo(i,67108864);l!==null&&ea(l,i,67108864),Y0(i,67108864)}}function ww(i){if(i.tag===13||i.tag===31){var l=ba();l=xs(l);var h=vo(i,l);h!==null&&ea(h,i,l),Y0(i,l)}}var hh=!0;function qT(i,l,h,p){var N=q.T;q.T=null;var A=ae.p;try{ae.p=2,W0(i,l,h,p)}finally{ae.p=A,q.T=N}}function KT(i,l,h,p){var N=q.T;q.T=null;var A=ae.p;try{ae.p=8,W0(i,l,h,p)}finally{ae.p=A,q.T=N}}function W0(i,l,h,p){if(hh){var N=Q0(p);if(N===null)M0(i,l,p,fh,h),_w(i,p);else if(WT(N,i,l,h,p))p.stopPropagation();else if(_w(i,p),l&4&&-1<YT.indexOf(i)){for(;N!==null;){var A=he(N);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var Y=Ke(A.pendingLanes);if(Y!==0){var ie=A;for(ie.pendingLanes|=2,ie.entangledLanes|=2;Y;){var Te=1<<31-Fe(Y);ie.entanglements[1]|=Te,Y&=~Te}fn(A),(Ts&6)===0&&(Wu=nt()+500,sd(0))}}break;case 31:case 13:ie=vo(A,2),ie!==null&&ea(ie,A,2),Xu(),Y0(A,2)}if(A=Q0(p),A===null&&M0(i,l,p,fh,h),A===N)break;N=A}N!==null&&p.stopPropagation()}else M0(i,l,p,null,h)}}function Q0(i){return i=Ln(i),X0(i)}var fh=null;function X0(i){if(fh=null,i=fe(i),i!==null){var l=o(i);if(l===null)i=null;else{var h=l.tag;if(h===13){if(i=c(l),i!==null)return i;i=null}else if(h===31){if(i=d(l),i!==null)return i;i=null}else if(h===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;i=null}else l!==i&&(i=null)}}return fh=i,null}function Sw(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ht()){case Oe:return 2;case tt:return 8;case Ct:case we:return 32;case bt:return 268435456;default:return 32}default:return 32}}var Z0=!1,Ii=null,Mi=null,Pi=null,cd=new Map,dd=new Map,Oi=[],YT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function _w(i,l){switch(i){case"focusin":case"focusout":Ii=null;break;case"dragenter":case"dragleave":Mi=null;break;case"mouseover":case"mouseout":Pi=null;break;case"pointerover":case"pointerout":cd.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":dd.delete(l.pointerId)}}function ud(i,l,h,p,N,A){return i===null||i.nativeEvent!==A?(i={blockedOn:l,domEventName:h,eventSystemFlags:p,nativeEvent:A,targetContainers:[N]},l!==null&&(l=he(l),l!==null&&vw(l)),i):(i.eventSystemFlags|=p,l=i.targetContainers,N!==null&&l.indexOf(N)===-1&&l.push(N),i)}function WT(i,l,h,p,N){switch(l){case"focusin":return Ii=ud(Ii,i,l,h,p,N),!0;case"dragenter":return Mi=ud(Mi,i,l,h,p,N),!0;case"mouseover":return Pi=ud(Pi,i,l,h,p,N),!0;case"pointerover":var A=N.pointerId;return cd.set(A,ud(cd.get(A)||null,i,l,h,p,N)),!0;case"gotpointercapture":return A=N.pointerId,dd.set(A,ud(dd.get(A)||null,i,l,h,p,N)),!0}return!1}function Nw(i){var l=fe(i.target);if(l!==null){var h=o(l);if(h!==null){if(l=h.tag,l===13){if(l=c(h),l!==null){i.blockedOn=l,M(i.priority,function(){ww(h)});return}}else if(l===31){if(l=d(h),l!==null){i.blockedOn=l,M(i.priority,function(){ww(h)});return}}else if(l===3&&h.stateNode.current.memoizedState.isDehydrated){i.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}i.blockedOn=null}function mh(i){if(i.blockedOn!==null)return!1;for(var l=i.targetContainers;0<l.length;){var h=Q0(i.nativeEvent);if(h===null){h=i.nativeEvent;var p=new h.constructor(h.type,h);go=p,h.target.dispatchEvent(p),go=null}else return l=he(h),l!==null&&vw(l),i.blockedOn=h,!1;l.shift()}return!0}function jw(i,l,h){mh(i)&&h.delete(l)}function QT(){Z0=!1,Ii!==null&&mh(Ii)&&(Ii=null),Mi!==null&&mh(Mi)&&(Mi=null),Pi!==null&&mh(Pi)&&(Pi=null),cd.forEach(jw),dd.forEach(jw)}function gh(i,l){i.blockedOn===l&&(i.blockedOn=null,Z0||(Z0=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,QT)))}var ph=null;function Ew(i){ph!==i&&(ph=i,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){ph===i&&(ph=null);for(var l=0;l<i.length;l+=3){var h=i[l],p=i[l+1],N=i[l+2];if(typeof p!="function"){if(X0(p||h)===null)continue;break}var A=he(h);A!==null&&(i.splice(l,3),l-=3,Qm(A,{pending:!0,data:N,method:h.method,action:p},p,N))}}))}function Gl(i){function l(Te){return gh(Te,i)}Ii!==null&&gh(Ii,i),Mi!==null&&gh(Mi,i),Pi!==null&&gh(Pi,i),cd.forEach(l),dd.forEach(l);for(var h=0;h<Oi.length;h++){var p=Oi[h];p.blockedOn===i&&(p.blockedOn=null)}for(;0<Oi.length&&(h=Oi[0],h.blockedOn===null);)Nw(h),h.blockedOn===null&&Oi.shift();if(h=(i.ownerDocument||i).$$reactFormReplay,h!=null)for(p=0;p<h.length;p+=3){var N=h[p],A=h[p+1],Y=N[_]||null;if(typeof A=="function")Y||Ew(h);else if(Y){var ie=null;if(A&&A.hasAttribute("formAction")){if(N=A,Y=A[_]||null)ie=Y.formAction;else if(X0(N)!==null)continue}else ie=Y.action;typeof ie=="function"?h[p+1]=ie:(h.splice(p,3),p-=3),Ew(h)}}}function Tw(){function i(A){A.canIntercept&&A.info==="react-transition"&&A.intercept({handler:function(){return new Promise(function(Y){return N=Y})},focusReset:"manual",scroll:"manual"})}function l(){N!==null&&(N(),N=null),p||setTimeout(h,20)}function h(){if(!p&&!navigation.transition){var A=navigation.currentEntry;A&&A.url!=null&&navigation.navigate(A.url,{state:A.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,N=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(h,100),function(){p=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),N!==null&&(N(),N=null)}}}function J0(i){this._internalRoot=i}xh.prototype.render=J0.prototype.render=function(i){var l=this._internalRoot;if(l===null)throw Error(r(409));var h=l.current,p=ba();yw(h,p,i,l,null,null)},xh.prototype.unmount=J0.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var l=i.containerInfo;yw(i.current,2,null,i,null,null),Xu(),l[P]=null}};function xh(i){this._internalRoot=i}xh.prototype.unstable_scheduleHydration=function(i){if(i){var l=Yr();i={blockedOn:null,target:i,priority:l};for(var h=0;h<Oi.length&&l!==0&&l<Oi[h].priority;h++);Oi.splice(h,0,i),h===0&&Nw(i)}};var Aw=e.version;if(Aw!=="19.2.0")throw Error(r(527,Aw,"19.2.0"));ae.findDOMNode=function(i){var l=i._reactInternals;if(l===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=u(l),i=i!==null?m(i):null,i=i===null?null:i.stateNode,i};var XT={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yh.isDisabled&&yh.supportsFiber)try{me=yh.inject(XT),De=yh}catch{}}return fd.createRoot=function(i,l){if(!n(i))throw Error(r(299));var h=!1,p="",N=Mb,A=Pb,Y=Ob;return l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onUncaughtError!==void 0&&(N=l.onUncaughtError),l.onCaughtError!==void 0&&(A=l.onCaughtError),l.onRecoverableError!==void 0&&(Y=l.onRecoverableError)),l=pw(i,1,!1,null,null,h,p,null,N,A,Y,Tw),i[P]=l.current,I0(i),new J0(l)},fd.hydrateRoot=function(i,l,h){if(!n(i))throw Error(r(299));var p=!1,N="",A=Mb,Y=Pb,ie=Ob,Te=null;return h!=null&&(h.unstable_strictMode===!0&&(p=!0),h.identifierPrefix!==void 0&&(N=h.identifierPrefix),h.onUncaughtError!==void 0&&(A=h.onUncaughtError),h.onCaughtError!==void 0&&(Y=h.onCaughtError),h.onRecoverableError!==void 0&&(ie=h.onRecoverableError),h.formState!==void 0&&(Te=h.formState)),l=pw(i,1,!0,l,h??null,p,N,Te,A,Y,ie,Tw),l.context=xw(null),h=l.current,p=ba(),p=xs(p),N=Si(p),N.callback=null,_i(h,N,p),h=p,l.current.lanes=h,Ne(l,h),fn(l),i[P]=l.current,I0(i),new xh(l)},fd.version="19.2.0",fd}var Uw;function cA(){if(Uw)return ag.exports;Uw=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(e){console.error(e)}}return a(),ag.exports=lA(),ag.exports}var dA=cA(),xc=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(a){return this.listeners.add(a),this.onSubscribe(),()=>{this.listeners.delete(a),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},uA={setTimeout:(a,e)=>setTimeout(a,e),clearTimeout:a=>clearTimeout(a),setInterval:(a,e)=>setInterval(a,e),clearInterval:a=>clearInterval(a)},qi,ex,b_,hA=(b_=class{constructor(){$t(this,qi,uA);$t(this,ex,!1)}setTimeoutProvider(a){At(this,qi,a)}setTimeout(a,e){return Ae(this,qi).setTimeout(a,e)}clearTimeout(a){Ae(this,qi).clearTimeout(a)}setInterval(a,e){return Ae(this,qi).setInterval(a,e)}clearInterval(a){Ae(this,qi).clearInterval(a)}},qi=new WeakMap,ex=new WeakMap,b_),$o=new hA;function fA(a){setTimeout(a,0)}var rl=typeof window>"u"||"Deno"in globalThis;function zr(){}function mA(a,e){return typeof a=="function"?a(e):a}function ep(a){return typeof a=="number"&&a>=0&&a!==1/0}function L_(a,e){return Math.max(a+(e||0)-Date.now(),0)}function ao(a,e){return typeof a=="function"?a(e):a}function Ua(a,e){return typeof a=="function"?a(e):a}function $w(a,e){const{type:s="all",exact:r,fetchStatus:n,predicate:o,queryKey:c,stale:d}=a;if(c){if(r){if(e.queryHash!==sx(c,e.options))return!1}else if(!Pd(e.queryKey,c))return!1}if(s!=="all"){const f=e.isActive();if(s==="active"&&!f||s==="inactive"&&f)return!1}return!(typeof d=="boolean"&&e.isStale()!==d||n&&n!==e.state.fetchStatus||o&&!o(e))}function Gw(a,e){const{exact:s,status:r,predicate:n,mutationKey:o}=a;if(o){if(!e.options.mutationKey)return!1;if(s){if(al(e.options.mutationKey)!==al(o))return!1}else if(!Pd(e.options.mutationKey,o))return!1}return!(r&&e.state.status!==r||n&&!n(e))}function sx(a,e){return((e==null?void 0:e.queryKeyHashFn)||al)(a)}function al(a){return JSON.stringify(a,(e,s)=>tp(s)?Object.keys(s).sort().reduce((r,n)=>(r[n]=s[n],r),{}):s)}function Pd(a,e){return a===e?!0:typeof a!=typeof e?!1:a&&e&&typeof a=="object"&&typeof e=="object"?Object.keys(e).every(s=>Pd(a[s],e[s])):!1}var gA=Object.prototype.hasOwnProperty;function D_(a,e){if(a===e)return a;const s=Hw(a)&&Hw(e);if(!s&&!(tp(a)&&tp(e)))return e;const n=(s?a:Object.keys(a)).length,o=s?e:Object.keys(e),c=o.length,d=s?new Array(c):{};let f=0;for(let u=0;u<c;u++){const m=s?u:o[u],g=a[m],x=e[m];if(g===x){d[m]=g,(s?u<n:gA.call(a,m))&&f++;continue}if(g===null||x===null||typeof g!="object"||typeof x!="object"){d[m]=x;continue}const b=D_(g,x);d[m]=b,b===g&&f++}return n===c&&f===n?a:d}function ff(a,e){if(!e||Object.keys(a).length!==Object.keys(e).length)return!1;for(const s in a)if(a[s]!==e[s])return!1;return!0}function Hw(a){return Array.isArray(a)&&a.length===Object.keys(a).length}function tp(a){if(!Vw(a))return!1;const e=a.constructor;if(e===void 0)return!0;const s=e.prototype;return!(!Vw(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(a)!==Object.prototype)}function Vw(a){return Object.prototype.toString.call(a)==="[object Object]"}function pA(a){return new Promise(e=>{$o.setTimeout(e,a)})}function sp(a,e,s){return typeof s.structuralSharing=="function"?s.structuralSharing(a,e):s.structuralSharing!==!1?D_(a,e):e}function xA(a,e,s=0){const r=[...a,e];return s&&r.length>s?r.slice(1):r}function yA(a,e,s=0){const r=[e,...a];return s&&r.length>s?r.slice(0,-1):r}var rx=Symbol();function I_(a,e){return!a.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!a.queryFn||a.queryFn===rx?()=>Promise.reject(new Error(`Missing queryFn: '${a.queryHash}'`)):a.queryFn}function M_(a,e){return typeof a=="function"?a(...e):!!a}var Vo,Ki,sc,v_,bA=(v_=class extends xc{constructor(){super();$t(this,Vo);$t(this,Ki);$t(this,sc);At(this,sc,e=>{if(!rl&&window.addEventListener){const s=()=>e();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){Ae(this,Ki)||this.setEventListener(Ae(this,sc))}onUnsubscribe(){var e;this.hasListeners()||((e=Ae(this,Ki))==null||e.call(this),At(this,Ki,void 0))}setEventListener(e){var s;At(this,sc,e),(s=Ae(this,Ki))==null||s.call(this),At(this,Ki,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){Ae(this,Vo)!==e&&(At(this,Vo,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(s=>{s(e)})}isFocused(){var e;return typeof Ae(this,Vo)=="boolean"?Ae(this,Vo):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Vo=new WeakMap,Ki=new WeakMap,sc=new WeakMap,v_),ax=new bA;function rp(){let a,e;const s=new Promise((n,o)=>{a=n,e=o});s.status="pending",s.catch(()=>{});function r(n){Object.assign(s,n),delete s.resolve,delete s.reject}return s.resolve=n=>{r({status:"fulfilled",value:n}),a(n)},s.reject=n=>{r({status:"rejected",reason:n}),e(n)},s}var vA=fA;function wA(){let a=[],e=0,s=d=>{d()},r=d=>{d()},n=vA;const o=d=>{e?a.push(d):n(()=>{s(d)})},c=()=>{const d=a;a=[],d.length&&n(()=>{r(()=>{d.forEach(f=>{s(f)})})})};return{batch:d=>{let f;e++;try{f=d()}finally{e--,e||c()}return f},batchCalls:d=>(...f)=>{o(()=>{d(...f)})},schedule:o,setNotifyFunction:d=>{s=d},setBatchNotifyFunction:d=>{r=d},setScheduler:d=>{n=d}}}var _r=wA(),rc,Yi,ac,w_,SA=(w_=class extends xc{constructor(){super();$t(this,rc,!0);$t(this,Yi);$t(this,ac);At(this,ac,e=>{if(!rl&&window.addEventListener){const s=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",r)}}})}onSubscribe(){Ae(this,Yi)||this.setEventListener(Ae(this,ac))}onUnsubscribe(){var e;this.hasListeners()||((e=Ae(this,Yi))==null||e.call(this),At(this,Yi,void 0))}setEventListener(e){var s;At(this,ac,e),(s=Ae(this,Yi))==null||s.call(this),At(this,Yi,e(this.setOnline.bind(this)))}setOnline(e){Ae(this,rc)!==e&&(At(this,rc,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return Ae(this,rc)}},rc=new WeakMap,Yi=new WeakMap,ac=new WeakMap,w_),mf=new SA;function _A(a){return Math.min(1e3*2**a,3e4)}function P_(a){return(a??"online")==="online"?mf.isOnline():!0}var ap=class extends Error{constructor(a){super("CancelledError"),this.revert=a==null?void 0:a.revert,this.silent=a==null?void 0:a.silent}};function O_(a){let e=!1,s=0,r;const n=rp(),o=()=>n.status!=="pending",c=w=>{var S;if(!o()){const T=new ap(w);x(T),(S=a.onCancel)==null||S.call(a,T)}},d=()=>{e=!0},f=()=>{e=!1},u=()=>ax.isFocused()&&(a.networkMode==="always"||mf.isOnline())&&a.canRun(),m=()=>P_(a.networkMode)&&a.canRun(),g=w=>{o()||(r==null||r(),n.resolve(w))},x=w=>{o()||(r==null||r(),n.reject(w))},b=()=>new Promise(w=>{var S;r=T=>{(o()||u())&&w(T)},(S=a.onPause)==null||S.call(a)}).then(()=>{var w;r=void 0,o()||(w=a.onContinue)==null||w.call(a)}),v=()=>{if(o())return;let w;const S=s===0?a.initialPromise:void 0;try{w=S??a.fn()}catch(T){w=Promise.reject(T)}Promise.resolve(w).then(g).catch(T=>{var z;if(o())return;const k=a.retry??(rl?0:3),E=a.retryDelay??_A,R=typeof E=="function"?E(s,T):E,K=k===!0||typeof k=="number"&&s<k||typeof k=="function"&&k(s,T);if(e||!K){x(T);return}s++,(z=a.onFail)==null||z.call(a,s,T),pA(R).then(()=>u()?void 0:b()).then(()=>{e?x(T):v()})})};return{promise:n,status:()=>n.status,cancel:c,continue:()=>(r==null||r(),n),cancelRetry:d,continueRetry:f,canStart:m,start:()=>(m()?v():b().then(v),n)}}var zo,S_,F_=(S_=class{constructor(){$t(this,zo)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),ep(this.gcTime)&&At(this,zo,$o.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(a){this.gcTime=Math.max(this.gcTime||0,a??(rl?1/0:300*1e3))}clearGcTimeout(){Ae(this,zo)&&($o.clearTimeout(Ae(this,zo)),At(this,zo,void 0))}},zo=new WeakMap,S_),qo,nc,Ba,Ko,Tr,qd,Yo,tn,Zn,__,NA=(__=class extends F_{constructor(e){super();$t(this,tn);$t(this,qo);$t(this,nc);$t(this,Ba);$t(this,Ko);$t(this,Tr);$t(this,qd);$t(this,Yo);At(this,Yo,!1),At(this,qd,e.defaultOptions),this.setOptions(e.options),this.observers=[],At(this,Ko,e.client),At(this,Ba,Ae(this,Ko).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,At(this,qo,qw(this.options)),this.state=e.state??Ae(this,qo),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=Ae(this,Tr))==null?void 0:e.promise}setOptions(e){if(this.options={...Ae(this,qd),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const s=qw(this.options);s.data!==void 0&&(this.setState(zw(s.data,s.dataUpdatedAt)),At(this,qo,s))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Ae(this,Ba).remove(this)}setData(e,s){const r=sp(this.state.data,e,this.options);return is(this,tn,Zn).call(this,{data:r,type:"success",dataUpdatedAt:s==null?void 0:s.updatedAt,manual:s==null?void 0:s.manual}),r}setState(e,s){is(this,tn,Zn).call(this,{type:"setState",state:e,setStateOptions:s})}cancel(e){var r,n;const s=(r=Ae(this,Tr))==null?void 0:r.promise;return(n=Ae(this,Tr))==null||n.cancel(e),s?s.then(zr).catch(zr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Ae(this,qo))}isActive(){return this.observers.some(e=>Ua(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===rx||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>ao(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!L_(this.state.dataUpdatedAt,e)}onFocus(){var s;const e=this.observers.find(r=>r.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(s=Ae(this,Tr))==null||s.continue()}onOnline(){var s;const e=this.observers.find(r=>r.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(s=Ae(this,Tr))==null||s.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),Ae(this,Ba).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(s=>s!==e),this.observers.length||(Ae(this,Tr)&&(Ae(this,Yo)?Ae(this,Tr).cancel({revert:!0}):Ae(this,Tr).cancelRetry()),this.scheduleGc()),Ae(this,Ba).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||is(this,tn,Zn).call(this,{type:"invalidate"})}async fetch(e,s){var f,u,m,g,x,b,v,w,S,T,k,E;if(this.state.fetchStatus!=="idle"&&((f=Ae(this,Tr))==null?void 0:f.status())!=="rejected"){if(this.state.data!==void 0&&(s!=null&&s.cancelRefetch))this.cancel({silent:!0});else if(Ae(this,Tr))return Ae(this,Tr).continueRetry(),Ae(this,Tr).promise}if(e&&this.setOptions(e),!this.options.queryFn){const R=this.observers.find(K=>K.options.queryFn);R&&this.setOptions(R.options)}const r=new AbortController,n=R=>{Object.defineProperty(R,"signal",{enumerable:!0,get:()=>(At(this,Yo,!0),r.signal)})},o=()=>{const R=I_(this.options,s),z=(()=>{const D={client:Ae(this,Ko),queryKey:this.queryKey,meta:this.meta};return n(D),D})();return At(this,Yo,!1),this.options.persister?this.options.persister(R,z,this):R(z)},d=(()=>{const R={fetchOptions:s,options:this.options,queryKey:this.queryKey,client:Ae(this,Ko),state:this.state,fetchFn:o};return n(R),R})();(u=this.options.behavior)==null||u.onFetch(d,this),At(this,nc,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((m=d.fetchOptions)==null?void 0:m.meta))&&is(this,tn,Zn).call(this,{type:"fetch",meta:(g=d.fetchOptions)==null?void 0:g.meta}),At(this,Tr,O_({initialPromise:s==null?void 0:s.initialPromise,fn:d.fetchFn,onCancel:R=>{R instanceof ap&&R.revert&&this.setState({...Ae(this,nc),fetchStatus:"idle"}),r.abort()},onFail:(R,K)=>{is(this,tn,Zn).call(this,{type:"failed",failureCount:R,error:K})},onPause:()=>{is(this,tn,Zn).call(this,{type:"pause"})},onContinue:()=>{is(this,tn,Zn).call(this,{type:"continue"})},retry:d.options.retry,retryDelay:d.options.retryDelay,networkMode:d.options.networkMode,canRun:()=>!0}));try{const R=await Ae(this,Tr).start();if(R===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(R),(b=(x=Ae(this,Ba).config).onSuccess)==null||b.call(x,R,this),(w=(v=Ae(this,Ba).config).onSettled)==null||w.call(v,R,this.state.error,this),R}catch(R){if(R instanceof ap){if(R.silent)return Ae(this,Tr).promise;if(R.revert){if(this.state.data===void 0)throw R;return this.state.data}}throw is(this,tn,Zn).call(this,{type:"error",error:R}),(T=(S=Ae(this,Ba).config).onError)==null||T.call(S,R,this),(E=(k=Ae(this,Ba).config).onSettled)==null||E.call(k,this.state.data,R,this),R}finally{this.scheduleGc()}}},qo=new WeakMap,nc=new WeakMap,Ba=new WeakMap,Ko=new WeakMap,Tr=new WeakMap,qd=new WeakMap,Yo=new WeakMap,tn=new WeakSet,Zn=function(e){const s=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...B_(r.data,this.options),fetchMeta:e.meta??null};case"success":const n={...r,...zw(e.data,e.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return At(this,nc,e.manual?n:void 0),n;case"error":const o=e.error;return{...r,error:o,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=s(this.state),_r.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),Ae(this,Ba).notify({query:this,type:"updated",action:e})})},__);function B_(a,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:P_(e.networkMode)?"fetching":"paused",...a===void 0&&{error:null,status:"pending"}}}function zw(a,e){return{data:a,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function qw(a){const e=typeof a.initialData=="function"?a.initialData():a.initialData,s=e!==void 0,r=s?typeof a.initialDataUpdatedAt=="function"?a.initialDataUpdatedAt():a.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:s?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var sa,vs,Kd,Hr,Wo,ic,si,Wi,Yd,oc,lc,Qo,Xo,Qi,cc,ks,Sd,np,ip,op,lp,cp,dp,up,U_,N_,jA=(N_=class extends xc{constructor(e,s){super();$t(this,ks);$t(this,sa);$t(this,vs);$t(this,Kd);$t(this,Hr);$t(this,Wo);$t(this,ic);$t(this,si);$t(this,Wi);$t(this,Yd);$t(this,oc);$t(this,lc);$t(this,Qo);$t(this,Xo);$t(this,Qi);$t(this,cc,new Set);this.options=s,At(this,sa,e),At(this,Wi,null),At(this,si,rp()),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(Ae(this,vs).addObserver(this),Kw(Ae(this,vs),this.options)?is(this,ks,Sd).call(this):this.updateResult(),is(this,ks,lp).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return hp(Ae(this,vs),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return hp(Ae(this,vs),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,is(this,ks,cp).call(this),is(this,ks,dp).call(this),Ae(this,vs).removeObserver(this)}setOptions(e){const s=this.options,r=Ae(this,vs);if(this.options=Ae(this,sa).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Ua(this.options.enabled,Ae(this,vs))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");is(this,ks,up).call(this),Ae(this,vs).setOptions(this.options),s._defaulted&&!ff(this.options,s)&&Ae(this,sa).getQueryCache().notify({type:"observerOptionsUpdated",query:Ae(this,vs),observer:this});const n=this.hasListeners();n&&Yw(Ae(this,vs),r,this.options,s)&&is(this,ks,Sd).call(this),this.updateResult(),n&&(Ae(this,vs)!==r||Ua(this.options.enabled,Ae(this,vs))!==Ua(s.enabled,Ae(this,vs))||ao(this.options.staleTime,Ae(this,vs))!==ao(s.staleTime,Ae(this,vs)))&&is(this,ks,np).call(this);const o=is(this,ks,ip).call(this);n&&(Ae(this,vs)!==r||Ua(this.options.enabled,Ae(this,vs))!==Ua(s.enabled,Ae(this,vs))||o!==Ae(this,Qi))&&is(this,ks,op).call(this,o)}getOptimisticResult(e){const s=Ae(this,sa).getQueryCache().build(Ae(this,sa),e),r=this.createResult(s,e);return TA(this,r)&&(At(this,Hr,r),At(this,ic,this.options),At(this,Wo,Ae(this,vs).state)),r}getCurrentResult(){return Ae(this,Hr)}trackResult(e,s){return new Proxy(e,{get:(r,n)=>(this.trackProp(n),s==null||s(n),n==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&Ae(this,si).status==="pending"&&Ae(this,si).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,n))})}trackProp(e){Ae(this,cc).add(e)}getCurrentQuery(){return Ae(this,vs)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=Ae(this,sa).defaultQueryOptions(e),r=Ae(this,sa).getQueryCache().build(Ae(this,sa),s);return r.fetch().then(()=>this.createResult(r,s))}fetch(e){return is(this,ks,Sd).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),Ae(this,Hr)))}createResult(e,s){var U;const r=Ae(this,vs),n=this.options,o=Ae(this,Hr),c=Ae(this,Wo),d=Ae(this,ic),u=e!==r?e.state:Ae(this,Kd),{state:m}=e;let g={...m},x=!1,b;if(s._optimisticResults){const I=this.hasListeners(),F=!I&&Kw(e,s),te=I&&Yw(e,r,s,n);(F||te)&&(g={...g,...B_(m.data,e.options)}),s._optimisticResults==="isRestoring"&&(g.fetchStatus="idle")}let{error:v,errorUpdatedAt:w,status:S}=g;b=g.data;let T=!1;if(s.placeholderData!==void 0&&b===void 0&&S==="pending"){let I;o!=null&&o.isPlaceholderData&&s.placeholderData===(d==null?void 0:d.placeholderData)?(I=o.data,T=!0):I=typeof s.placeholderData=="function"?s.placeholderData((U=Ae(this,lc))==null?void 0:U.state.data,Ae(this,lc)):s.placeholderData,I!==void 0&&(S="success",b=sp(o==null?void 0:o.data,I,s),x=!0)}if(s.select&&b!==void 0&&!T)if(o&&b===(c==null?void 0:c.data)&&s.select===Ae(this,Yd))b=Ae(this,oc);else try{At(this,Yd,s.select),b=s.select(b),b=sp(o==null?void 0:o.data,b,s),At(this,oc,b),At(this,Wi,null)}catch(I){At(this,Wi,I)}Ae(this,Wi)&&(v=Ae(this,Wi),b=Ae(this,oc),w=Date.now(),S="error");const k=g.fetchStatus==="fetching",E=S==="pending",R=S==="error",K=E&&k,z=b!==void 0,O={status:S,fetchStatus:g.fetchStatus,isPending:E,isSuccess:S==="success",isError:R,isInitialLoading:K,isLoading:K,data:b,dataUpdatedAt:g.dataUpdatedAt,error:v,errorUpdatedAt:w,failureCount:g.fetchFailureCount,failureReason:g.fetchFailureReason,errorUpdateCount:g.errorUpdateCount,isFetched:g.dataUpdateCount>0||g.errorUpdateCount>0,isFetchedAfterMount:g.dataUpdateCount>u.dataUpdateCount||g.errorUpdateCount>u.errorUpdateCount,isFetching:k,isRefetching:k&&!E,isLoadingError:R&&!z,isPaused:g.fetchStatus==="paused",isPlaceholderData:x,isRefetchError:R&&z,isStale:nx(e,s),refetch:this.refetch,promise:Ae(this,si),isEnabled:Ua(s.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const I=le=>{O.status==="error"?le.reject(O.error):O.data!==void 0&&le.resolve(O.data)},F=()=>{const le=At(this,si,O.promise=rp());I(le)},te=Ae(this,si);switch(te.status){case"pending":e.queryHash===r.queryHash&&I(te);break;case"fulfilled":(O.status==="error"||O.data!==te.value)&&F();break;case"rejected":(O.status!=="error"||O.error!==te.reason)&&F();break}}return O}updateResult(){const e=Ae(this,Hr),s=this.createResult(Ae(this,vs),this.options);if(At(this,Wo,Ae(this,vs).state),At(this,ic,this.options),Ae(this,Wo).data!==void 0&&At(this,lc,Ae(this,vs)),ff(s,e))return;At(this,Hr,s);const r=()=>{if(!e)return!0;const{notifyOnChangeProps:n}=this.options,o=typeof n=="function"?n():n;if(o==="all"||!o&&!Ae(this,cc).size)return!0;const c=new Set(o??Ae(this,cc));return this.options.throwOnError&&c.add("error"),Object.keys(Ae(this,Hr)).some(d=>{const f=d;return Ae(this,Hr)[f]!==e[f]&&c.has(f)})};is(this,ks,U_).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&is(this,ks,lp).call(this)}},sa=new WeakMap,vs=new WeakMap,Kd=new WeakMap,Hr=new WeakMap,Wo=new WeakMap,ic=new WeakMap,si=new WeakMap,Wi=new WeakMap,Yd=new WeakMap,oc=new WeakMap,lc=new WeakMap,Qo=new WeakMap,Xo=new WeakMap,Qi=new WeakMap,cc=new WeakMap,ks=new WeakSet,Sd=function(e){is(this,ks,up).call(this);let s=Ae(this,vs).fetch(this.options,e);return e!=null&&e.throwOnError||(s=s.catch(zr)),s},np=function(){is(this,ks,cp).call(this);const e=ao(this.options.staleTime,Ae(this,vs));if(rl||Ae(this,Hr).isStale||!ep(e))return;const r=L_(Ae(this,Hr).dataUpdatedAt,e)+1;At(this,Qo,$o.setTimeout(()=>{Ae(this,Hr).isStale||this.updateResult()},r))},ip=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(Ae(this,vs)):this.options.refetchInterval)??!1},op=function(e){is(this,ks,dp).call(this),At(this,Qi,e),!(rl||Ua(this.options.enabled,Ae(this,vs))===!1||!ep(Ae(this,Qi))||Ae(this,Qi)===0)&&At(this,Xo,$o.setInterval(()=>{(this.options.refetchIntervalInBackground||ax.isFocused())&&is(this,ks,Sd).call(this)},Ae(this,Qi)))},lp=function(){is(this,ks,np).call(this),is(this,ks,op).call(this,is(this,ks,ip).call(this))},cp=function(){Ae(this,Qo)&&($o.clearTimeout(Ae(this,Qo)),At(this,Qo,void 0))},dp=function(){Ae(this,Xo)&&($o.clearInterval(Ae(this,Xo)),At(this,Xo,void 0))},up=function(){const e=Ae(this,sa).getQueryCache().build(Ae(this,sa),this.options);if(e===Ae(this,vs))return;const s=Ae(this,vs);At(this,vs,e),At(this,Kd,e.state),this.hasListeners()&&(s==null||s.removeObserver(this),e.addObserver(this))},U_=function(e){_r.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(Ae(this,Hr))}),Ae(this,sa).getQueryCache().notify({query:Ae(this,vs),type:"observerResultsUpdated"})})},N_);function EA(a,e){return Ua(e.enabled,a)!==!1&&a.state.data===void 0&&!(a.state.status==="error"&&e.retryOnMount===!1)}function Kw(a,e){return EA(a,e)||a.state.data!==void 0&&hp(a,e,e.refetchOnMount)}function hp(a,e,s){if(Ua(e.enabled,a)!==!1&&ao(e.staleTime,a)!=="static"){const r=typeof s=="function"?s(a):s;return r==="always"||r!==!1&&nx(a,e)}return!1}function Yw(a,e,s,r){return(a!==e||Ua(r.enabled,a)===!1)&&(!s.suspense||a.state.status!=="error")&&nx(a,s)}function nx(a,e){return Ua(e.enabled,a)!==!1&&a.isStaleByTime(ao(e.staleTime,a))}function TA(a,e){return!ff(a.getCurrentResult(),e)}function Ww(a){return{onFetch:(e,s)=>{var m,g,x,b,v;const r=e.options,n=(x=(g=(m=e.fetchOptions)==null?void 0:m.meta)==null?void 0:g.fetchMore)==null?void 0:x.direction,o=((b=e.state.data)==null?void 0:b.pages)||[],c=((v=e.state.data)==null?void 0:v.pageParams)||[];let d={pages:[],pageParams:[]},f=0;const u=async()=>{let w=!1;const S=E=>{Object.defineProperty(E,"signal",{enumerable:!0,get:()=>(e.signal.aborted?w=!0:e.signal.addEventListener("abort",()=>{w=!0}),e.signal)})},T=I_(e.options,e.fetchOptions),k=async(E,R,K)=>{if(w)return Promise.reject();if(R==null&&E.pages.length)return Promise.resolve(E);const D=(()=>{const F={client:e.client,queryKey:e.queryKey,pageParam:R,direction:K?"backward":"forward",meta:e.options.meta};return S(F),F})(),O=await T(D),{maxPages:U}=e.options,I=K?yA:xA;return{pages:I(E.pages,O,U),pageParams:I(E.pageParams,R,U)}};if(n&&o.length){const E=n==="backward",R=E?AA:Qw,K={pages:o,pageParams:c},z=R(r,K);d=await k(K,z,E)}else{const E=a??o.length;do{const R=f===0?c[0]??r.initialPageParam:Qw(r,d);if(f>0&&R==null)break;d=await k(d,R),f++}while(f<E)}return d};e.options.persister?e.fetchFn=()=>{var w,S;return(S=(w=e.options).persister)==null?void 0:S.call(w,u,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},s)}:e.fetchFn=u}}}function Qw(a,{pages:e,pageParams:s}){const r=e.length-1;return e.length>0?a.getNextPageParam(e[r],e,s[r],s):void 0}function AA(a,{pages:e,pageParams:s}){var r;return e.length>0?(r=a.getPreviousPageParam)==null?void 0:r.call(a,e[0],e,s[0],s):void 0}var Wd,bn,Vr,Zo,vn,Gi,j_,CA=(j_=class extends F_{constructor(e){super();$t(this,vn);$t(this,Wd);$t(this,bn);$t(this,Vr);$t(this,Zo);At(this,Wd,e.client),this.mutationId=e.mutationId,At(this,Vr,e.mutationCache),At(this,bn,[]),this.state=e.state||$_(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){Ae(this,bn).includes(e)||(Ae(this,bn).push(e),this.clearGcTimeout(),Ae(this,Vr).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){At(this,bn,Ae(this,bn).filter(s=>s!==e)),this.scheduleGc(),Ae(this,Vr).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){Ae(this,bn).length||(this.state.status==="pending"?this.scheduleGc():Ae(this,Vr).remove(this))}continue(){var e;return((e=Ae(this,Zo))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var c,d,f,u,m,g,x,b,v,w,S,T,k,E,R,K,z,D,O,U;const s=()=>{is(this,vn,Gi).call(this,{type:"continue"})},r={client:Ae(this,Wd),meta:this.options.meta,mutationKey:this.options.mutationKey};At(this,Zo,O_({fn:()=>this.options.mutationFn?this.options.mutationFn(e,r):Promise.reject(new Error("No mutationFn found")),onFail:(I,F)=>{is(this,vn,Gi).call(this,{type:"failed",failureCount:I,error:F})},onPause:()=>{is(this,vn,Gi).call(this,{type:"pause"})},onContinue:s,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Ae(this,Vr).canRun(this)}));const n=this.state.status==="pending",o=!Ae(this,Zo).canStart();try{if(n)s();else{is(this,vn,Gi).call(this,{type:"pending",variables:e,isPaused:o}),await((d=(c=Ae(this,Vr).config).onMutate)==null?void 0:d.call(c,e,this,r));const F=await((u=(f=this.options).onMutate)==null?void 0:u.call(f,e,r));F!==this.state.context&&is(this,vn,Gi).call(this,{type:"pending",context:F,variables:e,isPaused:o})}const I=await Ae(this,Zo).start();return await((g=(m=Ae(this,Vr).config).onSuccess)==null?void 0:g.call(m,I,e,this.state.context,this,r)),await((b=(x=this.options).onSuccess)==null?void 0:b.call(x,I,e,this.state.context,r)),await((w=(v=Ae(this,Vr).config).onSettled)==null?void 0:w.call(v,I,null,this.state.variables,this.state.context,this,r)),await((T=(S=this.options).onSettled)==null?void 0:T.call(S,I,null,e,this.state.context,r)),is(this,vn,Gi).call(this,{type:"success",data:I}),I}catch(I){try{throw await((E=(k=Ae(this,Vr).config).onError)==null?void 0:E.call(k,I,e,this.state.context,this,r)),await((K=(R=this.options).onError)==null?void 0:K.call(R,I,e,this.state.context,r)),await((D=(z=Ae(this,Vr).config).onSettled)==null?void 0:D.call(z,void 0,I,this.state.variables,this.state.context,this,r)),await((U=(O=this.options).onSettled)==null?void 0:U.call(O,void 0,I,e,this.state.context,r)),I}finally{is(this,vn,Gi).call(this,{type:"error",error:I})}}finally{Ae(this,Vr).runNext(this)}}},Wd=new WeakMap,bn=new WeakMap,Vr=new WeakMap,Zo=new WeakMap,vn=new WeakSet,Gi=function(e){const s=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=s(this.state),_r.batch(()=>{Ae(this,bn).forEach(r=>{r.onMutationUpdate(e)}),Ae(this,Vr).notify({mutation:this,type:"updated",action:e})})},j_);function $_(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ri,sn,Qd,E_,kA=(E_=class extends xc{constructor(e={}){super();$t(this,ri);$t(this,sn);$t(this,Qd);this.config=e,At(this,ri,new Set),At(this,sn,new Map),At(this,Qd,0)}build(e,s,r){const n=new CA({client:e,mutationCache:this,mutationId:++bh(this,Qd)._,options:e.defaultMutationOptions(s),state:r});return this.add(n),n}add(e){Ae(this,ri).add(e);const s=vh(e);if(typeof s=="string"){const r=Ae(this,sn).get(s);r?r.push(e):Ae(this,sn).set(s,[e])}this.notify({type:"added",mutation:e})}remove(e){if(Ae(this,ri).delete(e)){const s=vh(e);if(typeof s=="string"){const r=Ae(this,sn).get(s);if(r)if(r.length>1){const n=r.indexOf(e);n!==-1&&r.splice(n,1)}else r[0]===e&&Ae(this,sn).delete(s)}}this.notify({type:"removed",mutation:e})}canRun(e){const s=vh(e);if(typeof s=="string"){const r=Ae(this,sn).get(s),n=r==null?void 0:r.find(o=>o.state.status==="pending");return!n||n===e}else return!0}runNext(e){var r;const s=vh(e);if(typeof s=="string"){const n=(r=Ae(this,sn).get(s))==null?void 0:r.find(o=>o!==e&&o.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}else return Promise.resolve()}clear(){_r.batch(()=>{Ae(this,ri).forEach(e=>{this.notify({type:"removed",mutation:e})}),Ae(this,ri).clear(),Ae(this,sn).clear()})}getAll(){return Array.from(Ae(this,ri))}find(e){const s={exact:!0,...e};return this.getAll().find(r=>Gw(s,r))}findAll(e={}){return this.getAll().filter(s=>Gw(e,s))}notify(e){_r.batch(()=>{this.listeners.forEach(s=>{s(e)})})}resumePausedMutations(){const e=this.getAll().filter(s=>s.state.isPaused);return _r.batch(()=>Promise.all(e.map(s=>s.continue().catch(zr))))}},ri=new WeakMap,sn=new WeakMap,Qd=new WeakMap,E_);function vh(a){var e;return(e=a.options.scope)==null?void 0:e.id}var ai,Xi,ra,ni,hi,Wh,fp,T_,RA=(T_=class extends xc{constructor(s,r){super();$t(this,hi);$t(this,ai);$t(this,Xi);$t(this,ra);$t(this,ni);At(this,ai,s),this.setOptions(r),this.bindMethods(),is(this,hi,Wh).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(s){var n;const r=this.options;this.options=Ae(this,ai).defaultMutationOptions(s),ff(this.options,r)||Ae(this,ai).getMutationCache().notify({type:"observerOptionsUpdated",mutation:Ae(this,ra),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&al(r.mutationKey)!==al(this.options.mutationKey)?this.reset():((n=Ae(this,ra))==null?void 0:n.state.status)==="pending"&&Ae(this,ra).setOptions(this.options)}onUnsubscribe(){var s;this.hasListeners()||(s=Ae(this,ra))==null||s.removeObserver(this)}onMutationUpdate(s){is(this,hi,Wh).call(this),is(this,hi,fp).call(this,s)}getCurrentResult(){return Ae(this,Xi)}reset(){var s;(s=Ae(this,ra))==null||s.removeObserver(this),At(this,ra,void 0),is(this,hi,Wh).call(this),is(this,hi,fp).call(this)}mutate(s,r){var n;return At(this,ni,r),(n=Ae(this,ra))==null||n.removeObserver(this),At(this,ra,Ae(this,ai).getMutationCache().build(Ae(this,ai),this.options)),Ae(this,ra).addObserver(this),Ae(this,ra).execute(s)}},ai=new WeakMap,Xi=new WeakMap,ra=new WeakMap,ni=new WeakMap,hi=new WeakSet,Wh=function(){var r;const s=((r=Ae(this,ra))==null?void 0:r.state)??$_();At(this,Xi,{...s,isPending:s.status==="pending",isSuccess:s.status==="success",isError:s.status==="error",isIdle:s.status==="idle",mutate:this.mutate,reset:this.reset})},fp=function(s){_r.batch(()=>{var r,n,o,c,d,f,u,m;if(Ae(this,ni)&&this.hasListeners()){const g=Ae(this,Xi).variables,x=Ae(this,Xi).context,b={client:Ae(this,ai),meta:this.options.meta,mutationKey:this.options.mutationKey};(s==null?void 0:s.type)==="success"?((n=(r=Ae(this,ni)).onSuccess)==null||n.call(r,s.data,g,x,b),(c=(o=Ae(this,ni)).onSettled)==null||c.call(o,s.data,null,g,x,b)):(s==null?void 0:s.type)==="error"&&((f=(d=Ae(this,ni)).onError)==null||f.call(d,s.error,g,x,b),(m=(u=Ae(this,ni)).onSettled)==null||m.call(u,void 0,s.error,g,x,b))}this.listeners.forEach(g=>{g(Ae(this,Xi))})})},T_),wn,A_,LA=(A_=class extends xc{constructor(e={}){super();$t(this,wn);this.config=e,At(this,wn,new Map)}build(e,s,r){const n=s.queryKey,o=s.queryHash??sx(n,s);let c=this.get(o);return c||(c=new NA({client:e,queryKey:n,queryHash:o,options:e.defaultQueryOptions(s),state:r,defaultOptions:e.getQueryDefaults(n)}),this.add(c)),c}add(e){Ae(this,wn).has(e.queryHash)||(Ae(this,wn).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const s=Ae(this,wn).get(e.queryHash);s&&(e.destroy(),s===e&&Ae(this,wn).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){_r.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return Ae(this,wn).get(e)}getAll(){return[...Ae(this,wn).values()]}find(e){const s={exact:!0,...e};return this.getAll().find(r=>$w(s,r))}findAll(e={}){const s=this.getAll();return Object.keys(e).length>0?s.filter(r=>$w(e,r)):s}notify(e){_r.batch(()=>{this.listeners.forEach(s=>{s(e)})})}onFocus(){_r.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){_r.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},wn=new WeakMap,A_),or,Zi,Ji,dc,uc,eo,hc,fc,C_,DA=(C_=class{constructor(a={}){$t(this,or);$t(this,Zi);$t(this,Ji);$t(this,dc);$t(this,uc);$t(this,eo);$t(this,hc);$t(this,fc);At(this,or,a.queryCache||new LA),At(this,Zi,a.mutationCache||new kA),At(this,Ji,a.defaultOptions||{}),At(this,dc,new Map),At(this,uc,new Map),At(this,eo,0)}mount(){bh(this,eo)._++,Ae(this,eo)===1&&(At(this,hc,ax.subscribe(async a=>{a&&(await this.resumePausedMutations(),Ae(this,or).onFocus())})),At(this,fc,mf.subscribe(async a=>{a&&(await this.resumePausedMutations(),Ae(this,or).onOnline())})))}unmount(){var a,e;bh(this,eo)._--,Ae(this,eo)===0&&((a=Ae(this,hc))==null||a.call(this),At(this,hc,void 0),(e=Ae(this,fc))==null||e.call(this),At(this,fc,void 0))}isFetching(a){return Ae(this,or).findAll({...a,fetchStatus:"fetching"}).length}isMutating(a){return Ae(this,Zi).findAll({...a,status:"pending"}).length}getQueryData(a){var s;const e=this.defaultQueryOptions({queryKey:a});return(s=Ae(this,or).get(e.queryHash))==null?void 0:s.state.data}ensureQueryData(a){const e=this.defaultQueryOptions(a),s=Ae(this,or).build(this,e),r=s.state.data;return r===void 0?this.fetchQuery(a):(a.revalidateIfStale&&s.isStaleByTime(ao(e.staleTime,s))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(a){return Ae(this,or).findAll(a).map(({queryKey:e,state:s})=>{const r=s.data;return[e,r]})}setQueryData(a,e,s){const r=this.defaultQueryOptions({queryKey:a}),n=Ae(this,or).get(r.queryHash),o=n==null?void 0:n.state.data,c=mA(e,o);if(c!==void 0)return Ae(this,or).build(this,r).setData(c,{...s,manual:!0})}setQueriesData(a,e,s){return _r.batch(()=>Ae(this,or).findAll(a).map(({queryKey:r})=>[r,this.setQueryData(r,e,s)]))}getQueryState(a){var s;const e=this.defaultQueryOptions({queryKey:a});return(s=Ae(this,or).get(e.queryHash))==null?void 0:s.state}removeQueries(a){const e=Ae(this,or);_r.batch(()=>{e.findAll(a).forEach(s=>{e.remove(s)})})}resetQueries(a,e){const s=Ae(this,or);return _r.batch(()=>(s.findAll(a).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...a},e)))}cancelQueries(a,e={}){const s={revert:!0,...e},r=_r.batch(()=>Ae(this,or).findAll(a).map(n=>n.cancel(s)));return Promise.all(r).then(zr).catch(zr)}invalidateQueries(a,e={}){return _r.batch(()=>(Ae(this,or).findAll(a).forEach(s=>{s.invalidate()}),(a==null?void 0:a.refetchType)==="none"?Promise.resolve():this.refetchQueries({...a,type:(a==null?void 0:a.refetchType)??(a==null?void 0:a.type)??"active"},e)))}refetchQueries(a,e={}){const s={...e,cancelRefetch:e.cancelRefetch??!0},r=_r.batch(()=>Ae(this,or).findAll(a).filter(n=>!n.isDisabled()&&!n.isStatic()).map(n=>{let o=n.fetch(void 0,s);return s.throwOnError||(o=o.catch(zr)),n.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(r).then(zr)}fetchQuery(a){const e=this.defaultQueryOptions(a);e.retry===void 0&&(e.retry=!1);const s=Ae(this,or).build(this,e);return s.isStaleByTime(ao(e.staleTime,s))?s.fetch(e):Promise.resolve(s.state.data)}prefetchQuery(a){return this.fetchQuery(a).then(zr).catch(zr)}fetchInfiniteQuery(a){return a.behavior=Ww(a.pages),this.fetchQuery(a)}prefetchInfiniteQuery(a){return this.fetchInfiniteQuery(a).then(zr).catch(zr)}ensureInfiniteQueryData(a){return a.behavior=Ww(a.pages),this.ensureQueryData(a)}resumePausedMutations(){return mf.isOnline()?Ae(this,Zi).resumePausedMutations():Promise.resolve()}getQueryCache(){return Ae(this,or)}getMutationCache(){return Ae(this,Zi)}getDefaultOptions(){return Ae(this,Ji)}setDefaultOptions(a){At(this,Ji,a)}setQueryDefaults(a,e){Ae(this,dc).set(al(a),{queryKey:a,defaultOptions:e})}getQueryDefaults(a){const e=[...Ae(this,dc).values()],s={};return e.forEach(r=>{Pd(a,r.queryKey)&&Object.assign(s,r.defaultOptions)}),s}setMutationDefaults(a,e){Ae(this,uc).set(al(a),{mutationKey:a,defaultOptions:e})}getMutationDefaults(a){const e=[...Ae(this,uc).values()],s={};return e.forEach(r=>{Pd(a,r.mutationKey)&&Object.assign(s,r.defaultOptions)}),s}defaultQueryOptions(a){if(a._defaulted)return a;const e={...Ae(this,Ji).queries,...this.getQueryDefaults(a.queryKey),...a,_defaulted:!0};return e.queryHash||(e.queryHash=sx(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===rx&&(e.enabled=!1),e}defaultMutationOptions(a){return a!=null&&a._defaulted?a:{...Ae(this,Ji).mutations,...(a==null?void 0:a.mutationKey)&&this.getMutationDefaults(a.mutationKey),...a,_defaulted:!0}}clear(){Ae(this,or).clear(),Ae(this,Zi).clear()}},or=new WeakMap,Zi=new WeakMap,Ji=new WeakMap,dc=new WeakMap,uc=new WeakMap,eo=new WeakMap,hc=new WeakMap,fc=new WeakMap,C_),G_=y.createContext(void 0),ca=a=>{const e=y.useContext(G_);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},IA=({client:a,children:e})=>(y.useEffect(()=>(a.mount(),()=>{a.unmount()}),[a]),t.jsx(G_.Provider,{value:a,children:e})),H_=y.createContext(!1),MA=()=>y.useContext(H_);H_.Provider;function PA(){let a=!1;return{clearReset:()=>{a=!1},reset:()=>{a=!0},isReset:()=>a}}var OA=y.createContext(PA()),FA=()=>y.useContext(OA),BA=(a,e)=>{(a.suspense||a.throwOnError||a.experimental_prefetchInRender)&&(e.isReset()||(a.retryOnMount=!1))},UA=a=>{y.useEffect(()=>{a.clearReset()},[a])},$A=({result:a,errorResetBoundary:e,throwOnError:s,query:r,suspense:n})=>a.isError&&!e.isReset()&&!a.isFetching&&r&&(n&&a.data===void 0||M_(s,[a.error,r])),GA=a=>{if(a.suspense){const s=n=>n==="static"?n:Math.max(n??1e3,1e3),r=a.staleTime;a.staleTime=typeof r=="function"?(...n)=>s(r(...n)):s(r),typeof a.gcTime=="number"&&(a.gcTime=Math.max(a.gcTime,1e3))}},HA=(a,e)=>a.isLoading&&a.isFetching&&!e,VA=(a,e)=>(a==null?void 0:a.suspense)&&e.isPending,Xw=(a,e,s)=>e.fetchOptimistic(a).catch(()=>{s.clearReset()});function zA(a,e,s){var g,x,b,v,w;const r=MA(),n=FA(),o=ca(),c=o.defaultQueryOptions(a);(x=(g=o.getDefaultOptions().queries)==null?void 0:g._experimental_beforeQuery)==null||x.call(g,c),c._optimisticResults=r?"isRestoring":"optimistic",GA(c),BA(c,n),UA(n);const d=!o.getQueryCache().get(c.queryHash),[f]=y.useState(()=>new e(o,c)),u=f.getOptimisticResult(c),m=!r&&a.subscribed!==!1;if(y.useSyncExternalStore(y.useCallback(S=>{const T=m?f.subscribe(_r.batchCalls(S)):zr;return f.updateResult(),T},[f,m]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),y.useEffect(()=>{f.setOptions(c)},[c,f]),VA(c,u))throw Xw(c,f,n);if($A({result:u,errorResetBoundary:n,throwOnError:c.throwOnError,query:o.getQueryCache().get(c.queryHash),suspense:c.suspense}))throw u.error;if((v=(b=o.getDefaultOptions().queries)==null?void 0:b._experimental_afterQuery)==null||v.call(b,c,u),c.experimental_prefetchInRender&&!rl&&HA(u,r)){const S=d?Xw(c,f,n):(w=o.getQueryCache().get(c.queryHash))==null?void 0:w.promise;S==null||S.catch(zr).finally(()=>{f.updateResult()})}return c.notifyOnChangeProps?u:f.trackResult(u)}function Cs(a,e){return zA(a,jA)}function dr(a,e){const s=ca(),[r]=y.useState(()=>new RA(s,a));y.useEffect(()=>{r.setOptions(a)},[r,a]);const n=y.useSyncExternalStore(y.useCallback(c=>r.subscribe(_r.batchCalls(c)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),o=y.useCallback((c,d)=>{r.mutate(c,d).catch(zr)},[r]);if(n.error&&M_(r.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:o,mutateAsync:n.mutate}}var qA=function(){return null};/**
 * react-router v7.9.5
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Zw="popstate";function KA(a={}){function e(r,n){let{pathname:o,search:c,hash:d}=r.location;return mp("",{pathname:o,search:c,hash:d},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function s(r,n){return typeof n=="string"?n:Od(n)}return WA(e,s,null,a)}function er(a,e){if(a===!1||a===null||typeof a>"u")throw new Error(e)}function Ga(a,e){if(!a){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function YA(){return Math.random().toString(36).substring(2,10)}function Jw(a,e){return{usr:a.state,key:a.key,idx:e}}function mp(a,e,s=null,r){return{pathname:typeof a=="string"?a:a.pathname,search:"",hash:"",...typeof e=="string"?yc(e):e,state:s,key:e&&e.key||r||YA()}}function Od({pathname:a="/",search:e="",hash:s=""}){return e&&e!=="?"&&(a+=e.charAt(0)==="?"?e:"?"+e),s&&s!=="#"&&(a+=s.charAt(0)==="#"?s:"#"+s),a}function yc(a){let e={};if(a){let s=a.indexOf("#");s>=0&&(e.hash=a.substring(s),a=a.substring(0,s));let r=a.indexOf("?");r>=0&&(e.search=a.substring(r),a=a.substring(0,r)),a&&(e.pathname=a)}return e}function WA(a,e,s,r={}){let{window:n=document.defaultView,v5Compat:o=!1}=r,c=n.history,d="POP",f=null,u=m();u==null&&(u=0,c.replaceState({...c.state,idx:u},""));function m(){return(c.state||{idx:null}).idx}function g(){d="POP";let S=m(),T=S==null?null:S-u;u=S,f&&f({action:d,location:w.location,delta:T})}function x(S,T){d="PUSH";let k=mp(w.location,S,T);u=m()+1;let E=Jw(k,u),R=w.createHref(k);try{c.pushState(E,"",R)}catch(K){if(K instanceof DOMException&&K.name==="DataCloneError")throw K;n.location.assign(R)}o&&f&&f({action:d,location:w.location,delta:1})}function b(S,T){d="REPLACE";let k=mp(w.location,S,T);u=m();let E=Jw(k,u),R=w.createHref(k);c.replaceState(E,"",R),o&&f&&f({action:d,location:w.location,delta:0})}function v(S){return QA(S)}let w={get action(){return d},get location(){return a(n,c)},listen(S){if(f)throw new Error("A history only accepts one active listener");return n.addEventListener(Zw,g),f=S,()=>{n.removeEventListener(Zw,g),f=null}},createHref(S){return e(n,S)},createURL:v,encodeLocation(S){let T=v(S);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:x,replace:b,go(S){return c.go(S)}};return w}function QA(a,e=!1){let s="http://localhost";typeof window<"u"&&(s=window.location.origin!=="null"?window.location.origin:window.location.href),er(s,"No window.location.(origin|href) available to create URL");let r=typeof a=="string"?a:Od(a);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=s+r),new URL(r,s)}function V_(a,e,s="/"){return XA(a,e,s,!1)}function XA(a,e,s,r){let n=typeof e=="string"?yc(e):e,o=fi(n.pathname||"/",s);if(o==null)return null;let c=z_(a);ZA(c);let d=null;for(let f=0;d==null&&f<c.length;++f){let u=cC(o);d=oC(c[f],u,r)}return d}function z_(a,e=[],s=[],r="",n=!1){let o=(c,d,f=n,u)=>{let m={relativePath:u===void 0?c.path||"":u,caseSensitive:c.caseSensitive===!0,childrenIndex:d,route:c};if(m.relativePath.startsWith("/")){if(!m.relativePath.startsWith(r)&&f)return;er(m.relativePath.startsWith(r),`Absolute route path "${m.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(r.length)}let g=ci([r,m.relativePath]),x=s.concat(m);c.children&&c.children.length>0&&(er(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),z_(c.children,e,x,g,f)),!(c.path==null&&!c.index)&&e.push({path:g,score:nC(g,c.index),routesMeta:x})};return a.forEach((c,d)=>{var f;if(c.path===""||!((f=c.path)!=null&&f.includes("?")))o(c,d);else for(let u of q_(c.path))o(c,d,!0,u)}),e}function q_(a){let e=a.split("/");if(e.length===0)return[];let[s,...r]=e,n=s.endsWith("?"),o=s.replace(/\?$/,"");if(r.length===0)return n?[o,""]:[o];let c=q_(r.join("/")),d=[];return d.push(...c.map(f=>f===""?o:[o,f].join("/"))),n&&d.push(...c),d.map(f=>a.startsWith("/")&&f===""?"/":f)}function ZA(a){a.sort((e,s)=>e.score!==s.score?s.score-e.score:iC(e.routesMeta.map(r=>r.childrenIndex),s.routesMeta.map(r=>r.childrenIndex)))}var JA=/^:[\w-]+$/,eC=3,tC=2,sC=1,rC=10,aC=-2,eS=a=>a==="*";function nC(a,e){let s=a.split("/"),r=s.length;return s.some(eS)&&(r+=aC),e&&(r+=tC),s.filter(n=>!eS(n)).reduce((n,o)=>n+(JA.test(o)?eC:o===""?sC:rC),r)}function iC(a,e){return a.length===e.length&&a.slice(0,-1).every((r,n)=>r===e[n])?a[a.length-1]-e[e.length-1]:0}function oC(a,e,s=!1){let{routesMeta:r}=a,n={},o="/",c=[];for(let d=0;d<r.length;++d){let f=r[d],u=d===r.length-1,m=o==="/"?e:e.slice(o.length)||"/",g=gf({path:f.relativePath,caseSensitive:f.caseSensitive,end:u},m),x=f.route;if(!g&&u&&s&&!r[r.length-1].route.index&&(g=gf({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},m)),!g)return null;Object.assign(n,g.params),c.push({params:n,pathname:ci([o,g.pathname]),pathnameBase:fC(ci([o,g.pathnameBase])),route:x}),g.pathnameBase!=="/"&&(o=ci([o,g.pathnameBase]))}return c}function gf(a,e){typeof a=="string"&&(a={path:a,caseSensitive:!1,end:!0});let[s,r]=lC(a.path,a.caseSensitive,a.end),n=e.match(s);if(!n)return null;let o=n[0],c=o.replace(/(.)\/+$/,"$1"),d=n.slice(1);return{params:r.reduce((u,{paramName:m,isOptional:g},x)=>{if(m==="*"){let v=d[x]||"";c=o.slice(0,o.length-v.length).replace(/(.)\/+$/,"$1")}const b=d[x];return g&&!b?u[m]=void 0:u[m]=(b||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:c,pattern:a}}function lC(a,e=!1,s=!0){Ga(a==="*"||!a.endsWith("*")||a.endsWith("/*"),`Route path "${a}" will be treated as if it were "${a.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${a.replace(/\*$/,"/*")}".`);let r=[],n="^"+a.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,f)=>(r.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return a.endsWith("*")?(r.push({paramName:"*"}),n+=a==="*"||a==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?n+="\\/*$":a!==""&&a!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,e?void 0:"i"),r]}function cC(a){try{return a.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ga(!1,`The URL path "${a}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),a}}function fi(a,e){if(e==="/")return a;if(!a.toLowerCase().startsWith(e.toLowerCase()))return null;let s=e.endsWith("/")?e.length-1:e.length,r=a.charAt(s);return r&&r!=="/"?null:a.slice(s)||"/"}function dC(a,e="/"){let{pathname:s,search:r="",hash:n=""}=typeof a=="string"?yc(a):a;return{pathname:s?s.startsWith("/")?s:uC(s,e):e,search:mC(r),hash:gC(n)}}function uC(a,e){let s=e.replace(/\/+$/,"").split("/");return a.split("/").forEach(n=>{n===".."?s.length>1&&s.pop():n!=="."&&s.push(n)}),s.length>1?s.join("/"):"/"}function lg(a,e,s,r){return`Cannot include a '${a}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${s}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function hC(a){return a.filter((e,s)=>s===0||e.route.path&&e.route.path.length>0)}function ix(a){let e=hC(a);return e.map((s,r)=>r===e.length-1?s.pathname:s.pathnameBase)}function ox(a,e,s,r=!1){let n;typeof a=="string"?n=yc(a):(n={...a},er(!n.pathname||!n.pathname.includes("?"),lg("?","pathname","search",n)),er(!n.pathname||!n.pathname.includes("#"),lg("#","pathname","hash",n)),er(!n.search||!n.search.includes("#"),lg("#","search","hash",n)));let o=a===""||n.pathname==="",c=o?"/":n.pathname,d;if(c==null)d=s;else{let g=e.length-1;if(!r&&c.startsWith("..")){let x=c.split("/");for(;x[0]==="..";)x.shift(),g-=1;n.pathname=x.join("/")}d=g>=0?e[g]:"/"}let f=dC(n,d),u=c&&c!=="/"&&c.endsWith("/"),m=(o||c===".")&&s.endsWith("/");return!f.pathname.endsWith("/")&&(u||m)&&(f.pathname+="/"),f}var ci=a=>a.join("/").replace(/\/\/+/g,"/"),fC=a=>a.replace(/\/+$/,"").replace(/^\/*/,"/"),mC=a=>!a||a==="?"?"":a.startsWith("?")?a:"?"+a,gC=a=>!a||a==="#"?"":a.startsWith("#")?a:"#"+a;function pC(a){return a!=null&&typeof a.status=="number"&&typeof a.statusText=="string"&&typeof a.internal=="boolean"&&"data"in a}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var K_=["POST","PUT","PATCH","DELETE"];new Set(K_);var xC=["GET",...K_];new Set(xC);var bc=y.createContext(null);bc.displayName="DataRouter";var Mf=y.createContext(null);Mf.displayName="DataRouterState";y.createContext(!1);var Y_=y.createContext({isTransitioning:!1});Y_.displayName="ViewTransition";var yC=y.createContext(new Map);yC.displayName="Fetchers";var bC=y.createContext(null);bC.displayName="Await";var nn=y.createContext(null);nn.displayName="Navigation";var Xd=y.createContext(null);Xd.displayName="Location";var Va=y.createContext({outlet:null,matches:[],isDataRoute:!1});Va.displayName="Route";var lx=y.createContext(null);lx.displayName="RouteError";function vC(a,{relative:e}={}){er(vc(),"useHref() may be used only in the context of a <Router> component.");let{basename:s,navigator:r}=y.useContext(nn),{hash:n,pathname:o,search:c}=Zd(a,{relative:e}),d=o;return s!=="/"&&(d=o==="/"?s:ci([s,o])),r.createHref({pathname:d,search:c,hash:n})}function vc(){return y.useContext(Xd)!=null}function Ea(){return er(vc(),"useLocation() may be used only in the context of a <Router> component."),y.useContext(Xd).location}var W_="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Q_(a){y.useContext(nn).static||y.useLayoutEffect(a)}function Ta(){let{isDataRoute:a}=y.useContext(Va);return a?PC():wC()}function wC(){er(vc(),"useNavigate() may be used only in the context of a <Router> component.");let a=y.useContext(bc),{basename:e,navigator:s}=y.useContext(nn),{matches:r}=y.useContext(Va),{pathname:n}=Ea(),o=JSON.stringify(ix(r)),c=y.useRef(!1);return Q_(()=>{c.current=!0}),y.useCallback((f,u={})=>{if(Ga(c.current,W_),!c.current)return;if(typeof f=="number"){s.go(f);return}let m=ox(f,JSON.parse(o),n,u.relative==="path");a==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:ci([e,m.pathname])),(u.replace?s.replace:s.push)(m,u.state,u)},[e,s,o,n,a])}var SC=y.createContext(null);function _C(a){let e=y.useContext(Va).outlet;return y.useMemo(()=>e&&y.createElement(SC.Provider,{value:a},e),[e,a])}function NC(){let{matches:a}=y.useContext(Va),e=a[a.length-1];return e?e.params:{}}function Zd(a,{relative:e}={}){let{matches:s}=y.useContext(Va),{pathname:r}=Ea(),n=JSON.stringify(ix(s));return y.useMemo(()=>ox(a,JSON.parse(n),r,e==="path"),[a,n,r,e])}function jC(a,e){return X_(a,e)}function X_(a,e,s,r,n){var k;er(vc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=y.useContext(nn),{matches:c}=y.useContext(Va),d=c[c.length-1],f=d?d.params:{},u=d?d.pathname:"/",m=d?d.pathnameBase:"/",g=d&&d.route;{let E=g&&g.path||"";Z_(u,!g||E.endsWith("*")||E.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${E}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${E}"> to <Route path="${E==="/"?"*":`${E}/*`}">.`)}let x=Ea(),b;if(e){let E=typeof e=="string"?yc(e):e;er(m==="/"||((k=E.pathname)==null?void 0:k.startsWith(m)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${E.pathname}" was given in the \`location\` prop.`),b=E}else b=x;let v=b.pathname||"/",w=v;if(m!=="/"){let E=m.replace(/^\//,"").split("/");w="/"+v.replace(/^\//,"").split("/").slice(E.length).join("/")}let S=V_(a,{pathname:w});Ga(g||S!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),Ga(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=kC(S&&S.map(E=>Object.assign({},E,{params:Object.assign({},f,E.params),pathname:ci([m,o.encodeLocation?o.encodeLocation(E.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?m:ci([m,o.encodeLocation?o.encodeLocation(E.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:E.pathnameBase])})),c,s,r,n);return e&&T?y.createElement(Xd.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},T):T}function EC(){let a=MC(),e=pC(a)?`${a.status} ${a.statusText}`:a instanceof Error?a.message:JSON.stringify(a),s=a instanceof Error?a.stack:null,r="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},c=null;return console.error("Error handled by React Router default ErrorBoundary:",a),c=y.createElement(y.Fragment,null,y.createElement("p",null," Hey developer "),y.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",y.createElement("code",{style:o},"ErrorBoundary")," or"," ",y.createElement("code",{style:o},"errorElement")," prop on your route.")),y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},e),s?y.createElement("pre",{style:n},s):null,c)}var TC=y.createElement(EC,null),AC=class extends y.Component{constructor(a){super(a),this.state={location:a.location,revalidation:a.revalidation,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,e){return e.location!==a.location||e.revalidation!=="idle"&&a.revalidation==="idle"?{error:a.error,location:a.location,revalidation:a.revalidation}:{error:a.error!==void 0?a.error:e.error,location:e.location,revalidation:a.revalidation||e.revalidation}}componentDidCatch(a,e){this.props.unstable_onError?this.props.unstable_onError(a,e):console.error("React Router caught the following error during render",a)}render(){return this.state.error!==void 0?y.createElement(Va.Provider,{value:this.props.routeContext},y.createElement(lx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function CC({routeContext:a,match:e,children:s}){let r=y.useContext(bc);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),y.createElement(Va.Provider,{value:a},s)}function kC(a,e=[],s=null,r=null,n=null){if(a==null){if(!s)return null;if(s.errors)a=s.matches;else if(e.length===0&&!s.initialized&&s.matches.length>0)a=s.matches;else return null}let o=a,c=s==null?void 0:s.errors;if(c!=null){let u=o.findIndex(m=>m.route.id&&(c==null?void 0:c[m.route.id])!==void 0);er(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),o=o.slice(0,Math.min(o.length,u+1))}let d=!1,f=-1;if(s)for(let u=0;u<o.length;u++){let m=o[u];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(f=u),m.route.id){let{loaderData:g,errors:x}=s,b=m.route.loader&&!g.hasOwnProperty(m.route.id)&&(!x||x[m.route.id]===void 0);if(m.route.lazy||b){d=!0,f>=0?o=o.slice(0,f+1):o=[o[0]];break}}}return o.reduceRight((u,m,g)=>{let x,b=!1,v=null,w=null;s&&(x=c&&m.route.id?c[m.route.id]:void 0,v=m.route.errorElement||TC,d&&(f<0&&g===0?(Z_("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,w=null):f===g&&(b=!0,w=m.route.hydrateFallbackElement||null)));let S=e.concat(o.slice(0,g+1)),T=()=>{let k;return x?k=v:b?k=w:m.route.Component?k=y.createElement(m.route.Component,null):m.route.element?k=m.route.element:k=u,y.createElement(CC,{match:m,routeContext:{outlet:u,matches:S,isDataRoute:s!=null},children:k})};return s&&(m.route.ErrorBoundary||m.route.errorElement||g===0)?y.createElement(AC,{location:s.location,revalidation:s.revalidation,component:v,error:x,children:T(),routeContext:{outlet:null,matches:S,isDataRoute:!0},unstable_onError:r}):T()},null)}function cx(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function RC(a){let e=y.useContext(bc);return er(e,cx(a)),e}function LC(a){let e=y.useContext(Mf);return er(e,cx(a)),e}function DC(a){let e=y.useContext(Va);return er(e,cx(a)),e}function dx(a){let e=DC(a),s=e.matches[e.matches.length-1];return er(s.route.id,`${a} can only be used on routes that contain a unique "id"`),s.route.id}function IC(){return dx("useRouteId")}function MC(){var r;let a=y.useContext(lx),e=LC("useRouteError"),s=dx("useRouteError");return a!==void 0?a:(r=e.errors)==null?void 0:r[s]}function PC(){let{router:a}=RC("useNavigate"),e=dx("useNavigate"),s=y.useRef(!1);return Q_(()=>{s.current=!0}),y.useCallback(async(n,o={})=>{Ga(s.current,W_),s.current&&(typeof n=="number"?a.navigate(n):await a.navigate(n,{fromRouteId:e,...o}))},[a,e])}var tS={};function Z_(a,e,s){!e&&!tS[a]&&(tS[a]=!0,Ga(!1,s))}y.memo(OC);function OC({routes:a,future:e,state:s,unstable_onError:r}){return X_(a,void 0,s,r,e)}function Yl({to:a,replace:e,state:s,relative:r}){er(vc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:n}=y.useContext(nn);Ga(!n,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=y.useContext(Va),{pathname:c}=Ea(),d=Ta(),f=ox(a,ix(o),c,r==="path"),u=JSON.stringify(f);return y.useEffect(()=>{d(JSON.parse(u),{replace:e,state:s,relative:r})},[d,u,r,e,s]),null}function FC(a){return _C(a.context)}function ns(a){er(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function BC({basename:a="/",children:e=null,location:s,navigationType:r="POP",navigator:n,static:o=!1}){er(!vc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=a.replace(/^\/*/,"/"),d=y.useMemo(()=>({basename:c,navigator:n,static:o,future:{}}),[c,n,o]);typeof s=="string"&&(s=yc(s));let{pathname:f="/",search:u="",hash:m="",state:g=null,key:x="default"}=s,b=y.useMemo(()=>{let v=fi(f,c);return v==null?null:{location:{pathname:v,search:u,hash:m,state:g,key:x},navigationType:r}},[c,f,u,m,g,x,r]);return Ga(b!=null,`<Router basename="${c}"> is not able to match the URL "${f}${u}${m}" because it does not start with the basename, so the <Router> won't render anything.`),b==null?null:y.createElement(nn.Provider,{value:d},y.createElement(Xd.Provider,{children:e,value:b}))}function UC({children:a,location:e}){return jC(gp(a),e)}function gp(a,e=[]){let s=[];return y.Children.forEach(a,(r,n)=>{if(!y.isValidElement(r))return;let o=[...e,n];if(r.type===y.Fragment){s.push.apply(s,gp(r.props.children,o));return}er(r.type===ns,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),er(!r.props.index||!r.props.children,"An index route cannot have child routes.");let c={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(c.children=gp(r.props.children,o)),s.push(c)}),s}var Qh="get",Xh="application/x-www-form-urlencoded";function Pf(a){return a!=null&&typeof a.tagName=="string"}function $C(a){return Pf(a)&&a.tagName.toLowerCase()==="button"}function GC(a){return Pf(a)&&a.tagName.toLowerCase()==="form"}function HC(a){return Pf(a)&&a.tagName.toLowerCase()==="input"}function VC(a){return!!(a.metaKey||a.altKey||a.ctrlKey||a.shiftKey)}function zC(a,e){return a.button===0&&(!e||e==="_self")&&!VC(a)}function pp(a=""){return new URLSearchParams(typeof a=="string"||Array.isArray(a)||a instanceof URLSearchParams?a:Object.keys(a).reduce((e,s)=>{let r=a[s];return e.concat(Array.isArray(r)?r.map(n=>[s,n]):[[s,r]])},[]))}function qC(a,e){let s=pp(a);return e&&e.forEach((r,n)=>{s.has(n)||e.getAll(n).forEach(o=>{s.append(n,o)})}),s}var wh=null;function KC(){if(wh===null)try{new FormData(document.createElement("form"),0),wh=!1}catch{wh=!0}return wh}var YC=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function cg(a){return a!=null&&!YC.has(a)?(Ga(!1,`"${a}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Xh}"`),null):a}function WC(a,e){let s,r,n,o,c;if(GC(a)){let d=a.getAttribute("action");r=d?fi(d,e):null,s=a.getAttribute("method")||Qh,n=cg(a.getAttribute("enctype"))||Xh,o=new FormData(a)}else if($C(a)||HC(a)&&(a.type==="submit"||a.type==="image")){let d=a.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=a.getAttribute("formaction")||d.getAttribute("action");if(r=f?fi(f,e):null,s=a.getAttribute("formmethod")||d.getAttribute("method")||Qh,n=cg(a.getAttribute("formenctype"))||cg(d.getAttribute("enctype"))||Xh,o=new FormData(d,a),!KC()){let{name:u,type:m,value:g}=a;if(m==="image"){let x=u?`${u}.`:"";o.append(`${x}x`,"0"),o.append(`${x}y`,"0")}else u&&o.append(u,g)}}else{if(Pf(a))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');s=Qh,r=null,n=Xh,c=a}return o&&n==="text/plain"&&(c=o,o=void 0),{action:r,method:s.toLowerCase(),encType:n,formData:o,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ux(a,e){if(a===!1||a===null||typeof a>"u")throw new Error(e)}function QC(a,e,s){let r=typeof a=="string"?new URL(a,typeof window>"u"?"server://singlefetch/":window.location.origin):a;return r.pathname==="/"?r.pathname=`_root.${s}`:e&&fi(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${s}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${s}`,r}async function XC(a,e){if(a.id in e)return e[a.id];try{let s=await import(a.module);return e[a.id]=s,s}catch(s){return console.error(`Error loading route module \`${a.module}\`, reloading page...`),console.error(s),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function ZC(a){return a==null?!1:a.href==null?a.rel==="preload"&&typeof a.imageSrcSet=="string"&&typeof a.imageSizes=="string":typeof a.rel=="string"&&typeof a.href=="string"}async function JC(a,e,s){let r=await Promise.all(a.map(async n=>{let o=e.routes[n.route.id];if(o){let c=await XC(o,s);return c.links?c.links():[]}return[]}));return r4(r.flat(1).filter(ZC).filter(n=>n.rel==="stylesheet"||n.rel==="preload").map(n=>n.rel==="stylesheet"?{...n,rel:"prefetch",as:"style"}:{...n,rel:"prefetch"}))}function sS(a,e,s,r,n,o){let c=(f,u)=>s[u]?f.route.id!==s[u].route.id:!0,d=(f,u)=>{var m;return s[u].pathname!==f.pathname||((m=s[u].route.path)==null?void 0:m.endsWith("*"))&&s[u].params["*"]!==f.params["*"]};return o==="assets"?e.filter((f,u)=>c(f,u)||d(f,u)):o==="data"?e.filter((f,u)=>{var g;let m=r.routes[f.route.id];if(!m||!m.hasLoader)return!1;if(c(f,u)||d(f,u))return!0;if(f.route.shouldRevalidate){let x=f.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:((g=s[0])==null?void 0:g.params)||{},nextUrl:new URL(a,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function e4(a,e,{includeHydrateFallback:s}={}){return t4(a.map(r=>{let n=e.routes[r.route.id];if(!n)return[];let o=[n.module];return n.clientActionModule&&(o=o.concat(n.clientActionModule)),n.clientLoaderModule&&(o=o.concat(n.clientLoaderModule)),s&&n.hydrateFallbackModule&&(o=o.concat(n.hydrateFallbackModule)),n.imports&&(o=o.concat(n.imports)),o}).flat(1))}function t4(a){return[...new Set(a)]}function s4(a){let e={},s=Object.keys(a).sort();for(let r of s)e[r]=a[r];return e}function r4(a,e){let s=new Set;return new Set(e),a.reduce((r,n)=>{let o=JSON.stringify(s4(n));return s.has(o)||(s.add(o),r.push({key:o,link:n})),r},[])}function J_(){let a=y.useContext(bc);return ux(a,"You must render this element inside a <DataRouterContext.Provider> element"),a}function a4(){let a=y.useContext(Mf);return ux(a,"You must render this element inside a <DataRouterStateContext.Provider> element"),a}var hx=y.createContext(void 0);hx.displayName="FrameworkContext";function eN(){let a=y.useContext(hx);return ux(a,"You must render this element inside a <HydratedRouter> element"),a}function n4(a,e){let s=y.useContext(hx),[r,n]=y.useState(!1),[o,c]=y.useState(!1),{onFocus:d,onBlur:f,onMouseEnter:u,onMouseLeave:m,onTouchStart:g}=e,x=y.useRef(null);y.useEffect(()=>{if(a==="render"&&c(!0),a==="viewport"){let w=T=>{T.forEach(k=>{c(k.isIntersecting)})},S=new IntersectionObserver(w,{threshold:.5});return x.current&&S.observe(x.current),()=>{S.disconnect()}}},[a]),y.useEffect(()=>{if(r){let w=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(w)}}},[r]);let b=()=>{n(!0)},v=()=>{n(!1),c(!1)};return s?a!=="intent"?[o,x,{}]:[o,x,{onFocus:md(d,b),onBlur:md(f,v),onMouseEnter:md(u,b),onMouseLeave:md(m,v),onTouchStart:md(g,b)}]:[!1,x,{}]}function md(a,e){return s=>{a&&a(s),s.defaultPrevented||e(s)}}function i4({page:a,...e}){let{router:s}=J_(),r=y.useMemo(()=>V_(s.routes,a,s.basename),[s.routes,a,s.basename]);return r?y.createElement(l4,{page:a,matches:r,...e}):null}function o4(a){let{manifest:e,routeModules:s}=eN(),[r,n]=y.useState([]);return y.useEffect(()=>{let o=!1;return JC(a,e,s).then(c=>{o||n(c)}),()=>{o=!0}},[a,e,s]),r}function l4({page:a,matches:e,...s}){let r=Ea(),{manifest:n,routeModules:o}=eN(),{basename:c}=J_(),{loaderData:d,matches:f}=a4(),u=y.useMemo(()=>sS(a,e,f,n,r,"data"),[a,e,f,n,r]),m=y.useMemo(()=>sS(a,e,f,n,r,"assets"),[a,e,f,n,r]),g=y.useMemo(()=>{if(a===r.pathname+r.search+r.hash)return[];let v=new Set,w=!1;if(e.forEach(T=>{var E;let k=n.routes[T.route.id];!k||!k.hasLoader||(!u.some(R=>R.route.id===T.route.id)&&T.route.id in d&&((E=o[T.route.id])!=null&&E.shouldRevalidate)||k.hasClientLoader?w=!0:v.add(T.route.id))}),v.size===0)return[];let S=QC(a,c,"data");return w&&v.size>0&&S.searchParams.set("_routes",e.filter(T=>v.has(T.route.id)).map(T=>T.route.id).join(",")),[S.pathname+S.search]},[c,d,r,n,u,e,a,o]),x=y.useMemo(()=>e4(m,n),[m,n]),b=o4(m);return y.createElement(y.Fragment,null,g.map(v=>y.createElement("link",{key:v,rel:"prefetch",as:"fetch",href:v,...s})),x.map(v=>y.createElement("link",{key:v,rel:"modulepreload",href:v,...s})),b.map(({key:v,link:w})=>y.createElement("link",{key:v,nonce:s.nonce,...w})))}function c4(...a){return e=>{a.forEach(s=>{typeof s=="function"?s(e):s!=null&&(s.current=e)})}}var tN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{tN&&(window.__reactRouterVersion="7.9.5")}catch{}function d4({basename:a,children:e,window:s}){let r=y.useRef();r.current==null&&(r.current=KA({window:s,v5Compat:!0}));let n=r.current,[o,c]=y.useState({action:n.action,location:n.location}),d=y.useCallback(f=>{y.startTransition(()=>c(f))},[c]);return y.useLayoutEffect(()=>n.listen(d),[n,d]),y.createElement(BC,{basename:a,children:e,location:o.location,navigationType:o.action,navigator:n})}var sN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ql=y.forwardRef(function({onClick:e,discover:s="render",prefetch:r="none",relative:n,reloadDocument:o,replace:c,state:d,target:f,to:u,preventScrollReset:m,viewTransition:g,...x},b){let{basename:v}=y.useContext(nn),w=typeof u=="string"&&sN.test(u),S,T=!1;if(typeof u=="string"&&w&&(S=u,tN))try{let U=new URL(window.location.href),I=u.startsWith("//")?new URL(U.protocol+u):new URL(u),F=fi(I.pathname,v);I.origin===U.origin&&F!=null?u=F+I.search+I.hash:T=!0}catch{Ga(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let k=vC(u,{relative:n}),[E,R,K]=n4(r,x),z=m4(u,{replace:c,state:d,target:f,preventScrollReset:m,relative:n,viewTransition:g});function D(U){e&&e(U),U.defaultPrevented||z(U)}let O=y.createElement("a",{...x,...K,href:S||k,onClick:T||o?e:D,ref:c4(b,R),target:f,"data-discover":!w&&s==="render"?"true":void 0});return E&&!w?y.createElement(y.Fragment,null,O,y.createElement(i4,{page:k})):O});Ql.displayName="Link";var u4=y.forwardRef(function({"aria-current":e="page",caseSensitive:s=!1,className:r="",end:n=!1,style:o,to:c,viewTransition:d,children:f,...u},m){let g=Zd(c,{relative:u.relative}),x=Ea(),b=y.useContext(Mf),{navigator:v,basename:w}=y.useContext(nn),S=b!=null&&b4(g)&&d===!0,T=v.encodeLocation?v.encodeLocation(g).pathname:g.pathname,k=x.pathname,E=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;s||(k=k.toLowerCase(),E=E?E.toLowerCase():null,T=T.toLowerCase()),E&&w&&(E=fi(E,w)||E);const R=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let K=k===T||!n&&k.startsWith(T)&&k.charAt(R)==="/",z=E!=null&&(E===T||!n&&E.startsWith(T)&&E.charAt(T.length)==="/"),D={isActive:K,isPending:z,isTransitioning:S},O=K?e:void 0,U;typeof r=="function"?U=r(D):U=[r,K?"active":null,z?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let I=typeof o=="function"?o(D):o;return y.createElement(Ql,{...u,"aria-current":O,className:U,ref:m,style:I,to:c,viewTransition:d},typeof f=="function"?f(D):f)});u4.displayName="NavLink";var h4=y.forwardRef(({discover:a="render",fetcherKey:e,navigate:s,reloadDocument:r,replace:n,state:o,method:c=Qh,action:d,onSubmit:f,relative:u,preventScrollReset:m,viewTransition:g,...x},b)=>{let v=x4(),w=y4(d,{relative:u}),S=c.toLowerCase()==="get"?"get":"post",T=typeof d=="string"&&sN.test(d),k=E=>{if(f&&f(E),E.defaultPrevented)return;E.preventDefault();let R=E.nativeEvent.submitter,K=(R==null?void 0:R.getAttribute("formmethod"))||c;v(R||E.currentTarget,{fetcherKey:e,method:K,navigate:s,replace:n,state:o,relative:u,preventScrollReset:m,viewTransition:g})};return y.createElement("form",{ref:b,method:S,action:w,onSubmit:r?f:k,...x,"data-discover":!T&&a==="render"?"true":void 0})});h4.displayName="Form";function f4(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function rN(a){let e=y.useContext(bc);return er(e,f4(a)),e}function m4(a,{target:e,replace:s,state:r,preventScrollReset:n,relative:o,viewTransition:c}={}){let d=Ta(),f=Ea(),u=Zd(a,{relative:o});return y.useCallback(m=>{if(zC(m,e)){m.preventDefault();let g=s!==void 0?s:Od(f)===Od(u);d(a,{replace:g,state:r,preventScrollReset:n,relative:o,viewTransition:c})}},[f,d,u,s,r,e,a,n,o,c])}function aN(a){Ga(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=y.useRef(pp(a)),s=y.useRef(!1),r=Ea(),n=y.useMemo(()=>qC(r.search,s.current?null:e.current),[r.search]),o=Ta(),c=y.useCallback((d,f)=>{const u=pp(typeof d=="function"?d(new URLSearchParams(n)):d);s.current=!0,o("?"+u,f)},[o,n]);return[n,c]}var g4=0,p4=()=>`__${String(++g4)}__`;function x4(){let{router:a}=rN("useSubmit"),{basename:e}=y.useContext(nn),s=IC();return y.useCallback(async(r,n={})=>{let{action:o,method:c,encType:d,formData:f,body:u}=WC(r,e);if(n.navigate===!1){let m=n.fetcherKey||p4();await a.fetch(m,s,n.action||o,{preventScrollReset:n.preventScrollReset,formData:f,body:u,formMethod:n.method||c,formEncType:n.encType||d,flushSync:n.flushSync})}else await a.navigate(n.action||o,{preventScrollReset:n.preventScrollReset,formData:f,body:u,formMethod:n.method||c,formEncType:n.encType||d,replace:n.replace,state:n.state,fromRouteId:s,flushSync:n.flushSync,viewTransition:n.viewTransition})},[a,e,s])}function y4(a,{relative:e}={}){let{basename:s}=y.useContext(nn),r=y.useContext(Va);er(r,"useFormAction must be used inside a RouteContext");let[n]=r.matches.slice(-1),o={...Zd(a||".",{relative:e})},c=Ea();if(a==null){o.search=c.search;let d=new URLSearchParams(o.search),f=d.getAll("index");if(f.some(m=>m==="")){d.delete("index"),f.filter(g=>g).forEach(g=>d.append("index",g));let m=d.toString();o.search=m?`?${m}`:""}}return(!a||a===".")&&n.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),s!=="/"&&(o.pathname=o.pathname==="/"?s:ci([s,o.pathname])),Od(o)}function b4(a,{relative:e}={}){let s=y.useContext(Y_);er(s!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=rN("useViewTransitionState"),n=Zd(a,{relative:e});if(!s.isTransitioning)return!1;let o=fi(s.currentLocation.pathname,r)||s.currentLocation.pathname,c=fi(s.nextLocation.pathname,r)||s.nextLocation.pathname;return gf(n.pathname,c)!=null||gf(n.pathname,o)!=null}var fx=R_();const v4=tx(fx);var w4=a=>{switch(a){case"success":return N4;case"info":return E4;case"warning":return j4;case"error":return T4;default:return null}},S4=Array(12).fill(0),_4=({visible:a,className:e})=>lt.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":a},lt.createElement("div",{className:"sonner-spinner"},S4.map((s,r)=>lt.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),N4=lt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},lt.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),j4=lt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},lt.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),E4=lt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},lt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),T4=lt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},lt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),A4=lt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},lt.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),lt.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),C4=()=>{let[a,e]=lt.useState(document.hidden);return lt.useEffect(()=>{let s=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",s),()=>window.removeEventListener("visibilitychange",s)},[]),a},xp=1,k4=class{constructor(){this.subscribe=a=>(this.subscribers.push(a),()=>{let e=this.subscribers.indexOf(a);this.subscribers.splice(e,1)}),this.publish=a=>{this.subscribers.forEach(e=>e(a))},this.addToast=a=>{this.publish(a),this.toasts=[...this.toasts,a]},this.create=a=>{var e;let{message:s,...r}=a,n=typeof(a==null?void 0:a.id)=="number"||((e=a.id)==null?void 0:e.length)>0?a.id:xp++,o=this.toasts.find(d=>d.id===n),c=a.dismissible===void 0?!0:a.dismissible;return this.dismissedToasts.has(n)&&this.dismissedToasts.delete(n),o?this.toasts=this.toasts.map(d=>d.id===n?(this.publish({...d,...a,id:n,title:s}),{...d,...a,id:n,dismissible:c,title:s}):d):this.addToast({title:s,...r,dismissible:c,id:n}),n},this.dismiss=a=>(this.dismissedToasts.add(a),a||this.toasts.forEach(e=>{this.subscribers.forEach(s=>s({id:e.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:a,dismiss:!0})),a),this.message=(a,e)=>this.create({...e,message:a}),this.error=(a,e)=>this.create({...e,message:a,type:"error"}),this.success=(a,e)=>this.create({...e,type:"success",message:a}),this.info=(a,e)=>this.create({...e,type:"info",message:a}),this.warning=(a,e)=>this.create({...e,type:"warning",message:a}),this.loading=(a,e)=>this.create({...e,type:"loading",message:a}),this.promise=(a,e)=>{if(!e)return;let s;e.loading!==void 0&&(s=this.create({...e,promise:a,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));let r=a instanceof Promise?a:a(),n=s!==void 0,o,c=r.then(async f=>{if(o=["resolve",f],lt.isValidElement(f))n=!1,this.create({id:s,type:"default",message:f});else if(L4(f)&&!f.ok){n=!1;let u=typeof e.error=="function"?await e.error(`HTTP error! status: ${f.status}`):e.error,m=typeof e.description=="function"?await e.description(`HTTP error! status: ${f.status}`):e.description;this.create({id:s,type:"error",message:u,description:m})}else if(e.success!==void 0){n=!1;let u=typeof e.success=="function"?await e.success(f):e.success,m=typeof e.description=="function"?await e.description(f):e.description;this.create({id:s,type:"success",message:u,description:m})}}).catch(async f=>{if(o=["reject",f],e.error!==void 0){n=!1;let u=typeof e.error=="function"?await e.error(f):e.error,m=typeof e.description=="function"?await e.description(f):e.description;this.create({id:s,type:"error",message:u,description:m})}}).finally(()=>{var f;n&&(this.dismiss(s),s=void 0),(f=e.finally)==null||f.call(e)}),d=()=>new Promise((f,u)=>c.then(()=>o[0]==="reject"?u(o[1]):f(o[1])).catch(u));return typeof s!="string"&&typeof s!="number"?{unwrap:d}:Object.assign(s,{unwrap:d})},this.custom=(a,e)=>{let s=(e==null?void 0:e.id)||xp++;return this.create({jsx:a(s),id:s,...e}),s},this.getActiveToasts=()=>this.toasts.filter(a=>!this.dismissedToasts.has(a.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},aa=new k4,R4=(a,e)=>{let s=(e==null?void 0:e.id)||xp++;return aa.addToast({title:a,...e,id:s}),s},L4=a=>a&&typeof a=="object"&&"ok"in a&&typeof a.ok=="boolean"&&"status"in a&&typeof a.status=="number",D4=R4,I4=()=>aa.toasts,M4=()=>aa.getActiveToasts(),be=Object.assign(D4,{success:aa.success,info:aa.info,warning:aa.warning,error:aa.error,custom:aa.custom,message:aa.message,promise:aa.promise,dismiss:aa.dismiss,loading:aa.loading},{getHistory:I4,getToasts:M4});function P4(a,{insertAt:e}={}){if(typeof document>"u")return;let s=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&s.firstChild?s.insertBefore(r,s.firstChild):s.appendChild(r),r.styleSheet?r.styleSheet.cssText=a:r.appendChild(document.createTextNode(a))}P4(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Sh(a){return a.label!==void 0}var O4=3,F4="32px",B4="16px",rS=4e3,U4=356,$4=14,G4=20,H4=200;function Xa(...a){return a.filter(Boolean).join(" ")}function V4(a){let[e,s]=a.split("-"),r=[];return e&&r.push(e),s&&r.push(s),r}var z4=a=>{var e,s,r,n,o,c,d,f,u,m,g;let{invert:x,toast:b,unstyled:v,interacting:w,setHeights:S,visibleToasts:T,heights:k,index:E,toasts:R,expanded:K,removeToast:z,defaultRichColors:D,closeButton:O,style:U,cancelButtonStyle:I,actionButtonStyle:F,className:te="",descriptionClassName:le="",duration:H,position:X,gap:q,loadingIcon:ae,expandByDefault:ce,classNames:ee,icons:W,closeButtonAriaLabel:V="Close toast",pauseWhenPageIsHidden:G}=a,[Z,oe]=lt.useState(null),[ye,je]=lt.useState(null),[xe,Ee]=lt.useState(!1),[Pe,Re]=lt.useState(!1),[Qe,ot]=lt.useState(!1),[ne,ke]=lt.useState(!1),[Be,qe]=lt.useState(!1),[dt,He]=lt.useState(0),[Ce,_e]=lt.useState(0),ge=lt.useRef(b.duration||H||rS),Ze=lt.useRef(null),Me=lt.useRef(null),nt=E===0,ht=E+1<=T,Oe=b.type,tt=b.dismissible!==!1,Ct=b.className||"",we=b.descriptionClassName||"",bt=lt.useMemo(()=>k.findIndex(Nt=>Nt.toastId===b.id)||0,[k,b.id]),ve=lt.useMemo(()=>{var Nt;return(Nt=b.closeButton)!=null?Nt:O},[b.closeButton,O]),xt=lt.useMemo(()=>b.duration||H||rS,[b.duration,H]),me=lt.useRef(0),De=lt.useRef(0),ue=lt.useRef(0),Fe=lt.useRef(null),[mt,Se]=X.split("-"),st=lt.useMemo(()=>k.reduce((Nt,St,Kt)=>Kt>=bt?Nt:Nt+St.height,0),[k,bt]),wt=C4(),yt=b.invert||x,Mt=Oe==="loading";De.current=lt.useMemo(()=>bt*q+st,[bt,st]),lt.useEffect(()=>{ge.current=xt},[xt]),lt.useEffect(()=>{Ee(!0)},[]),lt.useEffect(()=>{let Nt=Me.current;if(Nt){let St=Nt.getBoundingClientRect().height;return _e(St),S(Kt=>[{toastId:b.id,height:St,position:b.position},...Kt]),()=>S(Kt=>Kt.filter(ws=>ws.toastId!==b.id))}},[S,b.id]),lt.useLayoutEffect(()=>{if(!xe)return;let Nt=Me.current,St=Nt.style.height;Nt.style.height="auto";let Kt=Nt.getBoundingClientRect().height;Nt.style.height=St,_e(Kt),S(ws=>ws.find(Ne=>Ne.toastId===b.id)?ws.map(Ne=>Ne.toastId===b.id?{...Ne,height:Kt}:Ne):[{toastId:b.id,height:Kt,position:b.position},...ws])},[xe,b.title,b.description,S,b.id]);let Ke=lt.useCallback(()=>{Re(!0),He(De.current),S(Nt=>Nt.filter(St=>St.toastId!==b.id)),setTimeout(()=>{z(b)},H4)},[b,z,S,De]);lt.useEffect(()=>{if(b.promise&&Oe==="loading"||b.duration===1/0||b.type==="loading")return;let Nt;return K||w||G&&wt?(()=>{if(ue.current<me.current){let St=new Date().getTime()-me.current;ge.current=ge.current-St}ue.current=new Date().getTime()})():ge.current!==1/0&&(me.current=new Date().getTime(),Nt=setTimeout(()=>{var St;(St=b.onAutoClose)==null||St.call(b,b),Ke()},ge.current)),()=>clearTimeout(Nt)},[K,w,b,Oe,G,wt,Ke]),lt.useEffect(()=>{b.delete&&Ke()},[Ke,b.delete]);function Vt(){var Nt,St,Kt;return W!=null&&W.loading?lt.createElement("div",{className:Xa(ee==null?void 0:ee.loader,(Nt=b==null?void 0:b.classNames)==null?void 0:Nt.loader,"sonner-loader"),"data-visible":Oe==="loading"},W.loading):ae?lt.createElement("div",{className:Xa(ee==null?void 0:ee.loader,(St=b==null?void 0:b.classNames)==null?void 0:St.loader,"sonner-loader"),"data-visible":Oe==="loading"},ae):lt.createElement(_4,{className:Xa(ee==null?void 0:ee.loader,(Kt=b==null?void 0:b.classNames)==null?void 0:Kt.loader),visible:Oe==="loading"})}return lt.createElement("li",{tabIndex:0,ref:Me,className:Xa(te,Ct,ee==null?void 0:ee.toast,(e=b==null?void 0:b.classNames)==null?void 0:e.toast,ee==null?void 0:ee.default,ee==null?void 0:ee[Oe],(s=b==null?void 0:b.classNames)==null?void 0:s[Oe]),"data-sonner-toast":"","data-rich-colors":(r=b.richColors)!=null?r:D,"data-styled":!(b.jsx||b.unstyled||v),"data-mounted":xe,"data-promise":!!b.promise,"data-swiped":Be,"data-removed":Pe,"data-visible":ht,"data-y-position":mt,"data-x-position":Se,"data-index":E,"data-front":nt,"data-swiping":Qe,"data-dismissible":tt,"data-type":Oe,"data-invert":yt,"data-swipe-out":ne,"data-swipe-direction":ye,"data-expanded":!!(K||ce&&xe),style:{"--index":E,"--toasts-before":E,"--z-index":R.length-E,"--offset":`${Pe?dt:De.current}px`,"--initial-height":ce?"auto":`${Ce}px`,...U,...b.style},onDragEnd:()=>{ot(!1),oe(null),Fe.current=null},onPointerDown:Nt=>{Mt||!tt||(Ze.current=new Date,He(De.current),Nt.target.setPointerCapture(Nt.pointerId),Nt.target.tagName!=="BUTTON"&&(ot(!0),Fe.current={x:Nt.clientX,y:Nt.clientY}))},onPointerUp:()=>{var Nt,St,Kt,ws;if(ne||!tt)return;Fe.current=null;let Ne=Number(((Nt=Me.current)==null?void 0:Nt.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),gt=Number(((St=Me.current)==null?void 0:St.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),jt=new Date().getTime()-((Kt=Ze.current)==null?void 0:Kt.getTime()),vt=Z==="x"?Ne:gt,os=Math.abs(vt)/jt;if(Math.abs(vt)>=G4||os>.11){He(De.current),(ws=b.onDismiss)==null||ws.call(b,b),je(Z==="x"?Ne>0?"right":"left":gt>0?"down":"up"),Ke(),ke(!0),qe(!1);return}ot(!1),oe(null)},onPointerMove:Nt=>{var St,Kt,ws,Ne;if(!Fe.current||!tt||((St=window.getSelection())==null?void 0:St.toString().length)>0)return;let gt=Nt.clientY-Fe.current.y,jt=Nt.clientX-Fe.current.x,vt=(Kt=a.swipeDirections)!=null?Kt:V4(X);!Z&&(Math.abs(jt)>1||Math.abs(gt)>1)&&oe(Math.abs(jt)>Math.abs(gt)?"x":"y");let os={x:0,y:0};Z==="y"?(vt.includes("top")||vt.includes("bottom"))&&(vt.includes("top")&&gt<0||vt.includes("bottom")&&gt>0)&&(os.y=gt):Z==="x"&&(vt.includes("left")||vt.includes("right"))&&(vt.includes("left")&&jt<0||vt.includes("right")&&jt>0)&&(os.x=jt),(Math.abs(os.x)>0||Math.abs(os.y)>0)&&qe(!0),(ws=Me.current)==null||ws.style.setProperty("--swipe-amount-x",`${os.x}px`),(Ne=Me.current)==null||Ne.style.setProperty("--swipe-amount-y",`${os.y}px`)}},ve&&!b.jsx?lt.createElement("button",{"aria-label":V,"data-disabled":Mt,"data-close-button":!0,onClick:Mt||!tt?()=>{}:()=>{var Nt;Ke(),(Nt=b.onDismiss)==null||Nt.call(b,b)},className:Xa(ee==null?void 0:ee.closeButton,(n=b==null?void 0:b.classNames)==null?void 0:n.closeButton)},(o=W==null?void 0:W.close)!=null?o:A4):null,b.jsx||y.isValidElement(b.title)?b.jsx?b.jsx:typeof b.title=="function"?b.title():b.title:lt.createElement(lt.Fragment,null,Oe||b.icon||b.promise?lt.createElement("div",{"data-icon":"",className:Xa(ee==null?void 0:ee.icon,(c=b==null?void 0:b.classNames)==null?void 0:c.icon)},b.promise||b.type==="loading"&&!b.icon?b.icon||Vt():null,b.type!=="loading"?b.icon||(W==null?void 0:W[Oe])||w4(Oe):null):null,lt.createElement("div",{"data-content":"",className:Xa(ee==null?void 0:ee.content,(d=b==null?void 0:b.classNames)==null?void 0:d.content)},lt.createElement("div",{"data-title":"",className:Xa(ee==null?void 0:ee.title,(f=b==null?void 0:b.classNames)==null?void 0:f.title)},typeof b.title=="function"?b.title():b.title),b.description?lt.createElement("div",{"data-description":"",className:Xa(le,we,ee==null?void 0:ee.description,(u=b==null?void 0:b.classNames)==null?void 0:u.description)},typeof b.description=="function"?b.description():b.description):null),y.isValidElement(b.cancel)?b.cancel:b.cancel&&Sh(b.cancel)?lt.createElement("button",{"data-button":!0,"data-cancel":!0,style:b.cancelButtonStyle||I,onClick:Nt=>{var St,Kt;Sh(b.cancel)&&tt&&((Kt=(St=b.cancel).onClick)==null||Kt.call(St,Nt),Ke())},className:Xa(ee==null?void 0:ee.cancelButton,(m=b==null?void 0:b.classNames)==null?void 0:m.cancelButton)},b.cancel.label):null,y.isValidElement(b.action)?b.action:b.action&&Sh(b.action)?lt.createElement("button",{"data-button":!0,"data-action":!0,style:b.actionButtonStyle||F,onClick:Nt=>{var St,Kt;Sh(b.action)&&((Kt=(St=b.action).onClick)==null||Kt.call(St,Nt),!Nt.defaultPrevented&&Ke())},className:Xa(ee==null?void 0:ee.actionButton,(g=b==null?void 0:b.classNames)==null?void 0:g.actionButton)},b.action.label):null))};function aS(){if(typeof window>"u"||typeof document>"u")return"ltr";let a=document.documentElement.getAttribute("dir");return a==="auto"||!a?window.getComputedStyle(document.documentElement).direction:a}function q4(a,e){let s={};return[a,e].forEach((r,n)=>{let o=n===1,c=o?"--mobile-offset":"--offset",d=o?B4:F4;function f(u){["top","right","bottom","left"].forEach(m=>{s[`${c}-${m}`]=typeof u=="number"?`${u}px`:u})}typeof r=="number"||typeof r=="string"?f(r):typeof r=="object"?["top","right","bottom","left"].forEach(u=>{r[u]===void 0?s[`${c}-${u}`]=d:s[`${c}-${u}`]=typeof r[u]=="number"?`${r[u]}px`:r[u]}):f(d)}),s}var K4=y.forwardRef(function(a,e){let{invert:s,position:r="bottom-right",hotkey:n=["altKey","KeyT"],expand:o,closeButton:c,className:d,offset:f,mobileOffset:u,theme:m="light",richColors:g,duration:x,style:b,visibleToasts:v=O4,toastOptions:w,dir:S=aS(),gap:T=$4,loadingIcon:k,icons:E,containerAriaLabel:R="Notifications",pauseWhenPageIsHidden:K}=a,[z,D]=lt.useState([]),O=lt.useMemo(()=>Array.from(new Set([r].concat(z.filter(G=>G.position).map(G=>G.position)))),[z,r]),[U,I]=lt.useState([]),[F,te]=lt.useState(!1),[le,H]=lt.useState(!1),[X,q]=lt.useState(m!=="system"?m:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),ae=lt.useRef(null),ce=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),ee=lt.useRef(null),W=lt.useRef(!1),V=lt.useCallback(G=>{D(Z=>{var oe;return(oe=Z.find(ye=>ye.id===G.id))!=null&&oe.delete||aa.dismiss(G.id),Z.filter(({id:ye})=>ye!==G.id)})},[]);return lt.useEffect(()=>aa.subscribe(G=>{if(G.dismiss){D(Z=>Z.map(oe=>oe.id===G.id?{...oe,delete:!0}:oe));return}setTimeout(()=>{v4.flushSync(()=>{D(Z=>{let oe=Z.findIndex(ye=>ye.id===G.id);return oe!==-1?[...Z.slice(0,oe),{...Z[oe],...G},...Z.slice(oe+1)]:[G,...Z]})})})}),[]),lt.useEffect(()=>{if(m!=="system"){q(m);return}if(m==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?q("dark"):q("light")),typeof window>"u")return;let G=window.matchMedia("(prefers-color-scheme: dark)");try{G.addEventListener("change",({matches:Z})=>{q(Z?"dark":"light")})}catch{G.addListener(({matches:oe})=>{try{q(oe?"dark":"light")}catch(ye){console.error(ye)}})}},[m]),lt.useEffect(()=>{z.length<=1&&te(!1)},[z]),lt.useEffect(()=>{let G=Z=>{var oe,ye;n.every(je=>Z[je]||Z.code===je)&&(te(!0),(oe=ae.current)==null||oe.focus()),Z.code==="Escape"&&(document.activeElement===ae.current||(ye=ae.current)!=null&&ye.contains(document.activeElement))&&te(!1)};return document.addEventListener("keydown",G),()=>document.removeEventListener("keydown",G)},[n]),lt.useEffect(()=>{if(ae.current)return()=>{ee.current&&(ee.current.focus({preventScroll:!0}),ee.current=null,W.current=!1)}},[ae.current]),lt.createElement("section",{ref:e,"aria-label":`${R} ${ce}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},O.map((G,Z)=>{var oe;let[ye,je]=G.split("-");return z.length?lt.createElement("ol",{key:G,dir:S==="auto"?aS():S,tabIndex:-1,ref:ae,className:d,"data-sonner-toaster":!0,"data-theme":X,"data-y-position":ye,"data-lifted":F&&z.length>1&&!o,"data-x-position":je,style:{"--front-toast-height":`${((oe=U[0])==null?void 0:oe.height)||0}px`,"--width":`${U4}px`,"--gap":`${T}px`,...b,...q4(f,u)},onBlur:xe=>{W.current&&!xe.currentTarget.contains(xe.relatedTarget)&&(W.current=!1,ee.current&&(ee.current.focus({preventScroll:!0}),ee.current=null))},onFocus:xe=>{xe.target instanceof HTMLElement&&xe.target.dataset.dismissible==="false"||W.current||(W.current=!0,ee.current=xe.relatedTarget)},onMouseEnter:()=>te(!0),onMouseMove:()=>te(!0),onMouseLeave:()=>{le||te(!1)},onDragEnd:()=>te(!1),onPointerDown:xe=>{xe.target instanceof HTMLElement&&xe.target.dataset.dismissible==="false"||H(!0)},onPointerUp:()=>H(!1)},z.filter(xe=>!xe.position&&Z===0||xe.position===G).map((xe,Ee)=>{var Pe,Re;return lt.createElement(z4,{key:xe.id,icons:E,index:Ee,toast:xe,defaultRichColors:g,duration:(Pe=w==null?void 0:w.duration)!=null?Pe:x,className:w==null?void 0:w.className,descriptionClassName:w==null?void 0:w.descriptionClassName,invert:s,visibleToasts:v,closeButton:(Re=w==null?void 0:w.closeButton)!=null?Re:c,interacting:le,position:G,style:w==null?void 0:w.style,unstyled:w==null?void 0:w.unstyled,classNames:w==null?void 0:w.classNames,cancelButtonStyle:w==null?void 0:w.cancelButtonStyle,actionButtonStyle:w==null?void 0:w.actionButtonStyle,removeToast:V,toasts:z.filter(Qe=>Qe.position==xe.position),heights:U.filter(Qe=>Qe.position==xe.position),setHeights:I,expandByDefault:o,gap:T,loadingIcon:k,expanded:F,pauseWhenPageIsHidden:K,swipeDirections:a.swipeDirections})})):null}))});function nN(a,e){return function(){return a.apply(e,arguments)}}const{toString:Y4}=Object.prototype,{getPrototypeOf:mx}=Object,{iterator:Of,toStringTag:iN}=Symbol,Ff=(a=>e=>{const s=Y4.call(e);return a[s]||(a[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),on=a=>(a=a.toLowerCase(),e=>Ff(e)===a),Bf=a=>e=>typeof e===a,{isArray:wc}=Array,mc=Bf("undefined");function Jd(a){return a!==null&&!mc(a)&&a.constructor!==null&&!mc(a.constructor)&&ia(a.constructor.isBuffer)&&a.constructor.isBuffer(a)}const oN=on("ArrayBuffer");function W4(a){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(a):e=a&&a.buffer&&oN(a.buffer),e}const Q4=Bf("string"),ia=Bf("function"),lN=Bf("number"),eu=a=>a!==null&&typeof a=="object",X4=a=>a===!0||a===!1,Zh=a=>{if(Ff(a)!=="object")return!1;const e=mx(a);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(iN in a)&&!(Of in a)},Z4=a=>{if(!eu(a)||Jd(a))return!1;try{return Object.keys(a).length===0&&Object.getPrototypeOf(a)===Object.prototype}catch{return!1}},J4=on("Date"),e5=on("File"),t5=on("Blob"),s5=on("FileList"),r5=a=>eu(a)&&ia(a.pipe),a5=a=>{let e;return a&&(typeof FormData=="function"&&a instanceof FormData||ia(a.append)&&((e=Ff(a))==="formdata"||e==="object"&&ia(a.toString)&&a.toString()==="[object FormData]"))},n5=on("URLSearchParams"),[i5,o5,l5,c5]=["ReadableStream","Request","Response","Headers"].map(on),d5=a=>a.trim?a.trim():a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function tu(a,e,{allOwnKeys:s=!1}={}){if(a===null||typeof a>"u")return;let r,n;if(typeof a!="object"&&(a=[a]),wc(a))for(r=0,n=a.length;r<n;r++)e.call(null,a[r],r,a);else{if(Jd(a))return;const o=s?Object.getOwnPropertyNames(a):Object.keys(a),c=o.length;let d;for(r=0;r<c;r++)d=o[r],e.call(null,a[d],d,a)}}function cN(a,e){if(Jd(a))return null;e=e.toLowerCase();const s=Object.keys(a);let r=s.length,n;for(;r-- >0;)if(n=s[r],e===n.toLowerCase())return n;return null}const Go=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,dN=a=>!mc(a)&&a!==Go;function yp(){const{caseless:a,skipUndefined:e}=dN(this)&&this||{},s={},r=(n,o)=>{const c=a&&cN(s,o)||o;Zh(s[c])&&Zh(n)?s[c]=yp(s[c],n):Zh(n)?s[c]=yp({},n):wc(n)?s[c]=n.slice():(!e||!mc(n))&&(s[c]=n)};for(let n=0,o=arguments.length;n<o;n++)arguments[n]&&tu(arguments[n],r);return s}const u5=(a,e,s,{allOwnKeys:r}={})=>(tu(e,(n,o)=>{s&&ia(n)?a[o]=nN(n,s):a[o]=n},{allOwnKeys:r}),a),h5=a=>(a.charCodeAt(0)===65279&&(a=a.slice(1)),a),f5=(a,e,s,r)=>{a.prototype=Object.create(e.prototype,r),a.prototype.constructor=a,Object.defineProperty(a,"super",{value:e.prototype}),s&&Object.assign(a.prototype,s)},m5=(a,e,s,r)=>{let n,o,c;const d={};if(e=e||{},a==null)return e;do{for(n=Object.getOwnPropertyNames(a),o=n.length;o-- >0;)c=n[o],(!r||r(c,a,e))&&!d[c]&&(e[c]=a[c],d[c]=!0);a=s!==!1&&mx(a)}while(a&&(!s||s(a,e))&&a!==Object.prototype);return e},g5=(a,e,s)=>{a=String(a),(s===void 0||s>a.length)&&(s=a.length),s-=e.length;const r=a.indexOf(e,s);return r!==-1&&r===s},p5=a=>{if(!a)return null;if(wc(a))return a;let e=a.length;if(!lN(e))return null;const s=new Array(e);for(;e-- >0;)s[e]=a[e];return s},x5=(a=>e=>a&&e instanceof a)(typeof Uint8Array<"u"&&mx(Uint8Array)),y5=(a,e)=>{const r=(a&&a[Of]).call(a);let n;for(;(n=r.next())&&!n.done;){const o=n.value;e.call(a,o[0],o[1])}},b5=(a,e)=>{let s;const r=[];for(;(s=a.exec(e))!==null;)r.push(s);return r},v5=on("HTMLFormElement"),w5=a=>a.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,r,n){return r.toUpperCase()+n}),nS=(({hasOwnProperty:a})=>(e,s)=>a.call(e,s))(Object.prototype),S5=on("RegExp"),uN=(a,e)=>{const s=Object.getOwnPropertyDescriptors(a),r={};tu(s,(n,o)=>{let c;(c=e(n,o,a))!==!1&&(r[o]=c||n)}),Object.defineProperties(a,r)},_5=a=>{uN(a,(e,s)=>{if(ia(a)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const r=a[s];if(ia(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},N5=(a,e)=>{const s={},r=n=>{n.forEach(o=>{s[o]=!0})};return wc(a)?r(a):r(String(a).split(e)),s},j5=()=>{},E5=(a,e)=>a!=null&&Number.isFinite(a=+a)?a:e;function T5(a){return!!(a&&ia(a.append)&&a[iN]==="FormData"&&a[Of])}const A5=a=>{const e=new Array(10),s=(r,n)=>{if(eu(r)){if(e.indexOf(r)>=0)return;if(Jd(r))return r;if(!("toJSON"in r)){e[n]=r;const o=wc(r)?[]:{};return tu(r,(c,d)=>{const f=s(c,n+1);!mc(f)&&(o[d]=f)}),e[n]=void 0,o}}return r};return s(a,0)},C5=on("AsyncFunction"),k5=a=>a&&(eu(a)||ia(a))&&ia(a.then)&&ia(a.catch),hN=((a,e)=>a?setImmediate:e?((s,r)=>(Go.addEventListener("message",({source:n,data:o})=>{n===Go&&o===s&&r.length&&r.shift()()},!1),n=>{r.push(n),Go.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",ia(Go.postMessage)),R5=typeof queueMicrotask<"u"?queueMicrotask.bind(Go):typeof process<"u"&&process.nextTick||hN,L5=a=>a!=null&&ia(a[Of]),et={isArray:wc,isArrayBuffer:oN,isBuffer:Jd,isFormData:a5,isArrayBufferView:W4,isString:Q4,isNumber:lN,isBoolean:X4,isObject:eu,isPlainObject:Zh,isEmptyObject:Z4,isReadableStream:i5,isRequest:o5,isResponse:l5,isHeaders:c5,isUndefined:mc,isDate:J4,isFile:e5,isBlob:t5,isRegExp:S5,isFunction:ia,isStream:r5,isURLSearchParams:n5,isTypedArray:x5,isFileList:s5,forEach:tu,merge:yp,extend:u5,trim:d5,stripBOM:h5,inherits:f5,toFlatObject:m5,kindOf:Ff,kindOfTest:on,endsWith:g5,toArray:p5,forEachEntry:y5,matchAll:b5,isHTMLForm:v5,hasOwnProperty:nS,hasOwnProp:nS,reduceDescriptors:uN,freezeMethods:_5,toObjectSet:N5,toCamelCase:w5,noop:j5,toFiniteNumber:E5,findKey:cN,global:Go,isContextDefined:dN,isSpecCompliantForm:T5,toJSONObject:A5,isAsyncFn:C5,isThenable:k5,setImmediate:hN,asap:R5,isIterable:L5};function ss(a,e,s,r,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=a,this.name="AxiosError",e&&(this.code=e),s&&(this.config=s),r&&(this.request=r),n&&(this.response=n,this.status=n.status?n.status:null)}et.inherits(ss,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:et.toJSONObject(this.config),code:this.code,status:this.status}}});const fN=ss.prototype,mN={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(a=>{mN[a]={value:a}});Object.defineProperties(ss,mN);Object.defineProperty(fN,"isAxiosError",{value:!0});ss.from=(a,e,s,r,n,o)=>{const c=Object.create(fN);et.toFlatObject(a,c,function(m){return m!==Error.prototype},u=>u!=="isAxiosError");const d=a&&a.message?a.message:"Error",f=e==null&&a?a.code:e;return ss.call(c,d,f,s,r,n),a&&c.cause==null&&Object.defineProperty(c,"cause",{value:a,configurable:!0}),c.name=a&&a.name||"Error",o&&Object.assign(c,o),c};const D5=null;function bp(a){return et.isPlainObject(a)||et.isArray(a)}function gN(a){return et.endsWith(a,"[]")?a.slice(0,-2):a}function iS(a,e,s){return a?a.concat(e).map(function(n,o){return n=gN(n),!s&&o?"["+n+"]":n}).join(s?".":""):e}function I5(a){return et.isArray(a)&&!a.some(bp)}const M5=et.toFlatObject(et,{},null,function(e){return/^is[A-Z]/.test(e)});function Uf(a,e,s){if(!et.isObject(a))throw new TypeError("target must be an object");e=e||new FormData,s=et.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,S){return!et.isUndefined(S[w])});const r=s.metaTokens,n=s.visitor||m,o=s.dots,c=s.indexes,f=(s.Blob||typeof Blob<"u"&&Blob)&&et.isSpecCompliantForm(e);if(!et.isFunction(n))throw new TypeError("visitor must be a function");function u(v){if(v===null)return"";if(et.isDate(v))return v.toISOString();if(et.isBoolean(v))return v.toString();if(!f&&et.isBlob(v))throw new ss("Blob is not supported. Use a Buffer instead.");return et.isArrayBuffer(v)||et.isTypedArray(v)?f&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function m(v,w,S){let T=v;if(v&&!S&&typeof v=="object"){if(et.endsWith(w,"{}"))w=r?w:w.slice(0,-2),v=JSON.stringify(v);else if(et.isArray(v)&&I5(v)||(et.isFileList(v)||et.endsWith(w,"[]"))&&(T=et.toArray(v)))return w=gN(w),T.forEach(function(E,R){!(et.isUndefined(E)||E===null)&&e.append(c===!0?iS([w],R,o):c===null?w:w+"[]",u(E))}),!1}return bp(v)?!0:(e.append(iS(S,w,o),u(v)),!1)}const g=[],x=Object.assign(M5,{defaultVisitor:m,convertValue:u,isVisitable:bp});function b(v,w){if(!et.isUndefined(v)){if(g.indexOf(v)!==-1)throw Error("Circular reference detected in "+w.join("."));g.push(v),et.forEach(v,function(T,k){(!(et.isUndefined(T)||T===null)&&n.call(e,T,et.isString(k)?k.trim():k,w,x))===!0&&b(T,w?w.concat(k):[k])}),g.pop()}}if(!et.isObject(a))throw new TypeError("data must be an object");return b(a),e}function oS(a){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(a).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function gx(a,e){this._pairs=[],a&&Uf(a,this,e)}const pN=gx.prototype;pN.append=function(e,s){this._pairs.push([e,s])};pN.toString=function(e){const s=e?function(r){return e.call(this,r,oS)}:oS;return this._pairs.map(function(n){return s(n[0])+"="+s(n[1])},"").join("&")};function P5(a){return encodeURIComponent(a).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function xN(a,e,s){if(!e)return a;const r=s&&s.encode||P5;et.isFunction(s)&&(s={serialize:s});const n=s&&s.serialize;let o;if(n?o=n(e,s):o=et.isURLSearchParams(e)?e.toString():new gx(e,s).toString(r),o){const c=a.indexOf("#");c!==-1&&(a=a.slice(0,c)),a+=(a.indexOf("?")===-1?"?":"&")+o}return a}class lS{constructor(){this.handlers=[]}use(e,s,r){return this.handlers.push({fulfilled:e,rejected:s,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){et.forEach(this.handlers,function(r){r!==null&&e(r)})}}const yN={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},O5=typeof URLSearchParams<"u"?URLSearchParams:gx,F5=typeof FormData<"u"?FormData:null,B5=typeof Blob<"u"?Blob:null,U5={isBrowser:!0,classes:{URLSearchParams:O5,FormData:F5,Blob:B5},protocols:["http","https","file","blob","url","data"]},px=typeof window<"u"&&typeof document<"u",vp=typeof navigator=="object"&&navigator||void 0,$5=px&&(!vp||["ReactNative","NativeScript","NS"].indexOf(vp.product)<0),G5=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",H5=px&&window.location.href||"http://localhost",V5=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:px,hasStandardBrowserEnv:$5,hasStandardBrowserWebWorkerEnv:G5,navigator:vp,origin:H5},Symbol.toStringTag,{value:"Module"})),Ur={...V5,...U5};function z5(a,e){return Uf(a,new Ur.classes.URLSearchParams,{visitor:function(s,r,n,o){return Ur.isNode&&et.isBuffer(s)?(this.append(r,s.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)},...e})}function q5(a){return et.matchAll(/\w+|\[(\w*)]/g,a).map(e=>e[0]==="[]"?"":e[1]||e[0])}function K5(a){const e={},s=Object.keys(a);let r;const n=s.length;let o;for(r=0;r<n;r++)o=s[r],e[o]=a[o];return e}function bN(a){function e(s,r,n,o){let c=s[o++];if(c==="__proto__")return!0;const d=Number.isFinite(+c),f=o>=s.length;return c=!c&&et.isArray(n)?n.length:c,f?(et.hasOwnProp(n,c)?n[c]=[n[c],r]:n[c]=r,!d):((!n[c]||!et.isObject(n[c]))&&(n[c]=[]),e(s,r,n[c],o)&&et.isArray(n[c])&&(n[c]=K5(n[c])),!d)}if(et.isFormData(a)&&et.isFunction(a.entries)){const s={};return et.forEachEntry(a,(r,n)=>{e(q5(r),n,s,0)}),s}return null}function Y5(a,e,s){if(et.isString(a))try{return(e||JSON.parse)(a),et.trim(a)}catch(r){if(r.name!=="SyntaxError")throw r}return(s||JSON.stringify)(a)}const su={transitional:yN,adapter:["xhr","http","fetch"],transformRequest:[function(e,s){const r=s.getContentType()||"",n=r.indexOf("application/json")>-1,o=et.isObject(e);if(o&&et.isHTMLForm(e)&&(e=new FormData(e)),et.isFormData(e))return n?JSON.stringify(bN(e)):e;if(et.isArrayBuffer(e)||et.isBuffer(e)||et.isStream(e)||et.isFile(e)||et.isBlob(e)||et.isReadableStream(e))return e;if(et.isArrayBufferView(e))return e.buffer;if(et.isURLSearchParams(e))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let d;if(o){if(r.indexOf("application/x-www-form-urlencoded")>-1)return z5(e,this.formSerializer).toString();if((d=et.isFileList(e))||r.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return Uf(d?{"files[]":e}:e,f&&new f,this.formSerializer)}}return o||n?(s.setContentType("application/json",!1),Y5(e)):e}],transformResponse:[function(e){const s=this.transitional||su.transitional,r=s&&s.forcedJSONParsing,n=this.responseType==="json";if(et.isResponse(e)||et.isReadableStream(e))return e;if(e&&et.isString(e)&&(r&&!this.responseType||n)){const c=!(s&&s.silentJSONParsing)&&n;try{return JSON.parse(e,this.parseReviver)}catch(d){if(c)throw d.name==="SyntaxError"?ss.from(d,ss.ERR_BAD_RESPONSE,this,null,this.response):d}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ur.classes.FormData,Blob:Ur.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};et.forEach(["delete","get","head","post","put","patch"],a=>{su.headers[a]={}});const W5=et.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Q5=a=>{const e={};let s,r,n;return a&&a.split(`
`).forEach(function(c){n=c.indexOf(":"),s=c.substring(0,n).trim().toLowerCase(),r=c.substring(n+1).trim(),!(!s||e[s]&&W5[s])&&(s==="set-cookie"?e[s]?e[s].push(r):e[s]=[r]:e[s]=e[s]?e[s]+", "+r:r)}),e},cS=Symbol("internals");function gd(a){return a&&String(a).trim().toLowerCase()}function Jh(a){return a===!1||a==null?a:et.isArray(a)?a.map(Jh):String(a)}function X5(a){const e=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=s.exec(a);)e[r[1]]=r[2];return e}const Z5=a=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(a.trim());function dg(a,e,s,r,n){if(et.isFunction(r))return r.call(this,e,s);if(n&&(e=s),!!et.isString(e)){if(et.isString(r))return e.indexOf(r)!==-1;if(et.isRegExp(r))return r.test(e)}}function J5(a){return a.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,s,r)=>s.toUpperCase()+r)}function ek(a,e){const s=et.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(a,r+s,{value:function(n,o,c){return this[r].call(this,e,n,o,c)},configurable:!0})})}let oa=class{constructor(e){e&&this.set(e)}set(e,s,r){const n=this;function o(d,f,u){const m=gd(f);if(!m)throw new Error("header name must be a non-empty string");const g=et.findKey(n,m);(!g||n[g]===void 0||u===!0||u===void 0&&n[g]!==!1)&&(n[g||f]=Jh(d))}const c=(d,f)=>et.forEach(d,(u,m)=>o(u,m,f));if(et.isPlainObject(e)||e instanceof this.constructor)c(e,s);else if(et.isString(e)&&(e=e.trim())&&!Z5(e))c(Q5(e),s);else if(et.isObject(e)&&et.isIterable(e)){let d={},f,u;for(const m of e){if(!et.isArray(m))throw TypeError("Object iterator must return a key-value pair");d[u=m[0]]=(f=d[u])?et.isArray(f)?[...f,m[1]]:[f,m[1]]:m[1]}c(d,s)}else e!=null&&o(s,e,r);return this}get(e,s){if(e=gd(e),e){const r=et.findKey(this,e);if(r){const n=this[r];if(!s)return n;if(s===!0)return X5(n);if(et.isFunction(s))return s.call(this,n,r);if(et.isRegExp(s))return s.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,s){if(e=gd(e),e){const r=et.findKey(this,e);return!!(r&&this[r]!==void 0&&(!s||dg(this,this[r],r,s)))}return!1}delete(e,s){const r=this;let n=!1;function o(c){if(c=gd(c),c){const d=et.findKey(r,c);d&&(!s||dg(r,r[d],d,s))&&(delete r[d],n=!0)}}return et.isArray(e)?e.forEach(o):o(e),n}clear(e){const s=Object.keys(this);let r=s.length,n=!1;for(;r--;){const o=s[r];(!e||dg(this,this[o],o,e,!0))&&(delete this[o],n=!0)}return n}normalize(e){const s=this,r={};return et.forEach(this,(n,o)=>{const c=et.findKey(r,o);if(c){s[c]=Jh(n),delete s[o];return}const d=e?J5(o):String(o).trim();d!==o&&delete s[o],s[d]=Jh(n),r[d]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const s=Object.create(null);return et.forEach(this,(r,n)=>{r!=null&&r!==!1&&(s[n]=e&&et.isArray(r)?r.join(", "):r)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,s])=>e+": "+s).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...s){const r=new this(e);return s.forEach(n=>r.set(n)),r}static accessor(e){const r=(this[cS]=this[cS]={accessors:{}}).accessors,n=this.prototype;function o(c){const d=gd(c);r[d]||(ek(n,c),r[d]=!0)}return et.isArray(e)?e.forEach(o):o(e),this}};oa.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);et.reduceDescriptors(oa.prototype,({value:a},e)=>{let s=e[0].toUpperCase()+e.slice(1);return{get:()=>a,set(r){this[s]=r}}});et.freezeMethods(oa);function ug(a,e){const s=this||su,r=e||s,n=oa.from(r.headers);let o=r.data;return et.forEach(a,function(d){o=d.call(s,o,n.normalize(),e?e.status:void 0)}),n.normalize(),o}function vN(a){return!!(a&&a.__CANCEL__)}function Sc(a,e,s){ss.call(this,a??"canceled",ss.ERR_CANCELED,e,s),this.name="CanceledError"}et.inherits(Sc,ss,{__CANCEL__:!0});function wN(a,e,s){const r=s.config.validateStatus;!s.status||!r||r(s.status)?a(s):e(new ss("Request failed with status code "+s.status,[ss.ERR_BAD_REQUEST,ss.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function tk(a){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(a);return e&&e[1]||""}function sk(a,e){a=a||10;const s=new Array(a),r=new Array(a);let n=0,o=0,c;return e=e!==void 0?e:1e3,function(f){const u=Date.now(),m=r[o];c||(c=u),s[n]=f,r[n]=u;let g=o,x=0;for(;g!==n;)x+=s[g++],g=g%a;if(n=(n+1)%a,n===o&&(o=(o+1)%a),u-c<e)return;const b=m&&u-m;return b?Math.round(x*1e3/b):void 0}}function rk(a,e){let s=0,r=1e3/e,n,o;const c=(u,m=Date.now())=>{s=m,n=null,o&&(clearTimeout(o),o=null),a(...u)};return[(...u)=>{const m=Date.now(),g=m-s;g>=r?c(u,m):(n=u,o||(o=setTimeout(()=>{o=null,c(n)},r-g)))},()=>n&&c(n)]}const pf=(a,e,s=3)=>{let r=0;const n=sk(50,250);return rk(o=>{const c=o.loaded,d=o.lengthComputable?o.total:void 0,f=c-r,u=n(f),m=c<=d;r=c;const g={loaded:c,total:d,progress:d?c/d:void 0,bytes:f,rate:u||void 0,estimated:u&&d&&m?(d-c)/u:void 0,event:o,lengthComputable:d!=null,[e?"download":"upload"]:!0};a(g)},s)},dS=(a,e)=>{const s=a!=null;return[r=>e[0]({lengthComputable:s,total:a,loaded:r}),e[1]]},uS=a=>(...e)=>et.asap(()=>a(...e)),ak=Ur.hasStandardBrowserEnv?((a,e)=>s=>(s=new URL(s,Ur.origin),a.protocol===s.protocol&&a.host===s.host&&(e||a.port===s.port)))(new URL(Ur.origin),Ur.navigator&&/(msie|trident)/i.test(Ur.navigator.userAgent)):()=>!0,nk=Ur.hasStandardBrowserEnv?{write(a,e,s,r,n,o,c){if(typeof document>"u")return;const d=[`${a}=${encodeURIComponent(e)}`];et.isNumber(s)&&d.push(`expires=${new Date(s).toUTCString()}`),et.isString(r)&&d.push(`path=${r}`),et.isString(n)&&d.push(`domain=${n}`),o===!0&&d.push("secure"),et.isString(c)&&d.push(`SameSite=${c}`),document.cookie=d.join("; ")},read(a){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+a+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(a){this.write(a,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function ik(a){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(a)}function ok(a,e){return e?a.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):a}function SN(a,e,s){let r=!ik(e);return a&&(r||s==!1)?ok(a,e):e}const hS=a=>a instanceof oa?{...a}:a;function nl(a,e){e=e||{};const s={};function r(u,m,g,x){return et.isPlainObject(u)&&et.isPlainObject(m)?et.merge.call({caseless:x},u,m):et.isPlainObject(m)?et.merge({},m):et.isArray(m)?m.slice():m}function n(u,m,g,x){if(et.isUndefined(m)){if(!et.isUndefined(u))return r(void 0,u,g,x)}else return r(u,m,g,x)}function o(u,m){if(!et.isUndefined(m))return r(void 0,m)}function c(u,m){if(et.isUndefined(m)){if(!et.isUndefined(u))return r(void 0,u)}else return r(void 0,m)}function d(u,m,g){if(g in e)return r(u,m);if(g in a)return r(void 0,u)}const f={url:o,method:o,data:o,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:d,headers:(u,m,g)=>n(hS(u),hS(m),g,!0)};return et.forEach(Object.keys({...a,...e}),function(m){const g=f[m]||n,x=g(a[m],e[m],m);et.isUndefined(x)&&g!==d||(s[m]=x)}),s}const _N=a=>{const e=nl({},a);let{data:s,withXSRFToken:r,xsrfHeaderName:n,xsrfCookieName:o,headers:c,auth:d}=e;if(e.headers=c=oa.from(c),e.url=xN(SN(e.baseURL,e.url,e.allowAbsoluteUrls),a.params,a.paramsSerializer),d&&c.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):""))),et.isFormData(s)){if(Ur.hasStandardBrowserEnv||Ur.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if(et.isFunction(s.getHeaders)){const f=s.getHeaders(),u=["content-type","content-length"];Object.entries(f).forEach(([m,g])=>{u.includes(m.toLowerCase())&&c.set(m,g)})}}if(Ur.hasStandardBrowserEnv&&(r&&et.isFunction(r)&&(r=r(e)),r||r!==!1&&ak(e.url))){const f=n&&o&&nk.read(o);f&&c.set(n,f)}return e},lk=typeof XMLHttpRequest<"u",ck=lk&&function(a){return new Promise(function(s,r){const n=_N(a);let o=n.data;const c=oa.from(n.headers).normalize();let{responseType:d,onUploadProgress:f,onDownloadProgress:u}=n,m,g,x,b,v;function w(){b&&b(),v&&v(),n.cancelToken&&n.cancelToken.unsubscribe(m),n.signal&&n.signal.removeEventListener("abort",m)}let S=new XMLHttpRequest;S.open(n.method.toUpperCase(),n.url,!0),S.timeout=n.timeout;function T(){if(!S)return;const E=oa.from("getAllResponseHeaders"in S&&S.getAllResponseHeaders()),K={data:!d||d==="text"||d==="json"?S.responseText:S.response,status:S.status,statusText:S.statusText,headers:E,config:a,request:S};wN(function(D){s(D),w()},function(D){r(D),w()},K),S=null}"onloadend"in S?S.onloadend=T:S.onreadystatechange=function(){!S||S.readyState!==4||S.status===0&&!(S.responseURL&&S.responseURL.indexOf("file:")===0)||setTimeout(T)},S.onabort=function(){S&&(r(new ss("Request aborted",ss.ECONNABORTED,a,S)),S=null)},S.onerror=function(R){const K=R&&R.message?R.message:"Network Error",z=new ss(K,ss.ERR_NETWORK,a,S);z.event=R||null,r(z),S=null},S.ontimeout=function(){let R=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const K=n.transitional||yN;n.timeoutErrorMessage&&(R=n.timeoutErrorMessage),r(new ss(R,K.clarifyTimeoutError?ss.ETIMEDOUT:ss.ECONNABORTED,a,S)),S=null},o===void 0&&c.setContentType(null),"setRequestHeader"in S&&et.forEach(c.toJSON(),function(R,K){S.setRequestHeader(K,R)}),et.isUndefined(n.withCredentials)||(S.withCredentials=!!n.withCredentials),d&&d!=="json"&&(S.responseType=n.responseType),u&&([x,v]=pf(u,!0),S.addEventListener("progress",x)),f&&S.upload&&([g,b]=pf(f),S.upload.addEventListener("progress",g),S.upload.addEventListener("loadend",b)),(n.cancelToken||n.signal)&&(m=E=>{S&&(r(!E||E.type?new Sc(null,a,S):E),S.abort(),S=null)},n.cancelToken&&n.cancelToken.subscribe(m),n.signal&&(n.signal.aborted?m():n.signal.addEventListener("abort",m)));const k=tk(n.url);if(k&&Ur.protocols.indexOf(k)===-1){r(new ss("Unsupported protocol "+k+":",ss.ERR_BAD_REQUEST,a));return}S.send(o||null)})},dk=(a,e)=>{const{length:s}=a=a?a.filter(Boolean):[];if(e||s){let r=new AbortController,n;const o=function(u){if(!n){n=!0,d();const m=u instanceof Error?u:this.reason;r.abort(m instanceof ss?m:new Sc(m instanceof Error?m.message:m))}};let c=e&&setTimeout(()=>{c=null,o(new ss(`timeout ${e} of ms exceeded`,ss.ETIMEDOUT))},e);const d=()=>{a&&(c&&clearTimeout(c),c=null,a.forEach(u=>{u.unsubscribe?u.unsubscribe(o):u.removeEventListener("abort",o)}),a=null)};a.forEach(u=>u.addEventListener("abort",o));const{signal:f}=r;return f.unsubscribe=()=>et.asap(d),f}},uk=function*(a,e){let s=a.byteLength;if(s<e){yield a;return}let r=0,n;for(;r<s;)n=r+e,yield a.slice(r,n),r=n},hk=async function*(a,e){for await(const s of fk(a))yield*uk(s,e)},fk=async function*(a){if(a[Symbol.asyncIterator]){yield*a;return}const e=a.getReader();try{for(;;){const{done:s,value:r}=await e.read();if(s)break;yield r}}finally{await e.cancel()}},fS=(a,e,s,r)=>{const n=hk(a,e);let o=0,c,d=f=>{c||(c=!0,r&&r(f))};return new ReadableStream({async pull(f){try{const{done:u,value:m}=await n.next();if(u){d(),f.close();return}let g=m.byteLength;if(s){let x=o+=g;s(x)}f.enqueue(new Uint8Array(m))}catch(u){throw d(u),u}},cancel(f){return d(f),n.return()}},{highWaterMark:2})},mS=64*1024,{isFunction:_h}=et,mk=(({Request:a,Response:e})=>({Request:a,Response:e}))(et.global),{ReadableStream:gS,TextEncoder:pS}=et.global,xS=(a,...e)=>{try{return!!a(...e)}catch{return!1}},gk=a=>{a=et.merge.call({skipUndefined:!0},mk,a);const{fetch:e,Request:s,Response:r}=a,n=e?_h(e):typeof fetch=="function",o=_h(s),c=_h(r);if(!n)return!1;const d=n&&_h(gS),f=n&&(typeof pS=="function"?(v=>w=>v.encode(w))(new pS):async v=>new Uint8Array(await new s(v).arrayBuffer())),u=o&&d&&xS(()=>{let v=!1;const w=new s(Ur.origin,{body:new gS,method:"POST",get duplex(){return v=!0,"half"}}).headers.has("Content-Type");return v&&!w}),m=c&&d&&xS(()=>et.isReadableStream(new r("").body)),g={stream:m&&(v=>v.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(v=>{!g[v]&&(g[v]=(w,S)=>{let T=w&&w[v];if(T)return T.call(w);throw new ss(`Response type '${v}' is not supported`,ss.ERR_NOT_SUPPORT,S)})});const x=async v=>{if(v==null)return 0;if(et.isBlob(v))return v.size;if(et.isSpecCompliantForm(v))return(await new s(Ur.origin,{method:"POST",body:v}).arrayBuffer()).byteLength;if(et.isArrayBufferView(v)||et.isArrayBuffer(v))return v.byteLength;if(et.isURLSearchParams(v)&&(v=v+""),et.isString(v))return(await f(v)).byteLength},b=async(v,w)=>{const S=et.toFiniteNumber(v.getContentLength());return S??x(w)};return async v=>{let{url:w,method:S,data:T,signal:k,cancelToken:E,timeout:R,onDownloadProgress:K,onUploadProgress:z,responseType:D,headers:O,withCredentials:U="same-origin",fetchOptions:I}=_N(v),F=e||fetch;D=D?(D+"").toLowerCase():"text";let te=dk([k,E&&E.toAbortSignal()],R),le=null;const H=te&&te.unsubscribe&&(()=>{te.unsubscribe()});let X;try{if(z&&u&&S!=="get"&&S!=="head"&&(X=await b(O,T))!==0){let V=new s(w,{method:"POST",body:T,duplex:"half"}),G;if(et.isFormData(T)&&(G=V.headers.get("content-type"))&&O.setContentType(G),V.body){const[Z,oe]=dS(X,pf(uS(z)));T=fS(V.body,mS,Z,oe)}}et.isString(U)||(U=U?"include":"omit");const q=o&&"credentials"in s.prototype,ae={...I,signal:te,method:S.toUpperCase(),headers:O.normalize().toJSON(),body:T,duplex:"half",credentials:q?U:void 0};le=o&&new s(w,ae);let ce=await(o?F(le,I):F(w,ae));const ee=m&&(D==="stream"||D==="response");if(m&&(K||ee&&H)){const V={};["status","statusText","headers"].forEach(ye=>{V[ye]=ce[ye]});const G=et.toFiniteNumber(ce.headers.get("content-length")),[Z,oe]=K&&dS(G,pf(uS(K),!0))||[];ce=new r(fS(ce.body,mS,Z,()=>{oe&&oe(),H&&H()}),V)}D=D||"text";let W=await g[et.findKey(g,D)||"text"](ce,v);return!ee&&H&&H(),await new Promise((V,G)=>{wN(V,G,{data:W,headers:oa.from(ce.headers),status:ce.status,statusText:ce.statusText,config:v,request:le})})}catch(q){throw H&&H(),q&&q.name==="TypeError"&&/Load failed|fetch/i.test(q.message)?Object.assign(new ss("Network Error",ss.ERR_NETWORK,v,le),{cause:q.cause||q}):ss.from(q,q&&q.code,v,le)}}},pk=new Map,NN=a=>{let e=a&&a.env||{};const{fetch:s,Request:r,Response:n}=e,o=[r,n,s];let c=o.length,d=c,f,u,m=pk;for(;d--;)f=o[d],u=m.get(f),u===void 0&&m.set(f,u=d?new Map:gk(e)),m=u;return u};NN();const xx={http:D5,xhr:ck,fetch:{get:NN}};et.forEach(xx,(a,e)=>{if(a){try{Object.defineProperty(a,"name",{value:e})}catch{}Object.defineProperty(a,"adapterName",{value:e})}});const yS=a=>`- ${a}`,xk=a=>et.isFunction(a)||a===null||a===!1;function yk(a,e){a=et.isArray(a)?a:[a];const{length:s}=a;let r,n;const o={};for(let c=0;c<s;c++){r=a[c];let d;if(n=r,!xk(r)&&(n=xx[(d=String(r)).toLowerCase()],n===void 0))throw new ss(`Unknown adapter '${d}'`);if(n&&(et.isFunction(n)||(n=n.get(e))))break;o[d||"#"+c]=n}if(!n){const c=Object.entries(o).map(([f,u])=>`adapter ${f} `+(u===!1?"is not supported by the environment":"is not available in the build"));let d=s?c.length>1?`since :
`+c.map(yS).join(`
`):" "+yS(c[0]):"as no adapter specified";throw new ss("There is no suitable adapter to dispatch the request "+d,"ERR_NOT_SUPPORT")}return n}const jN={getAdapter:yk,adapters:xx};function hg(a){if(a.cancelToken&&a.cancelToken.throwIfRequested(),a.signal&&a.signal.aborted)throw new Sc(null,a)}function bS(a){return hg(a),a.headers=oa.from(a.headers),a.data=ug.call(a,a.transformRequest),["post","put","patch"].indexOf(a.method)!==-1&&a.headers.setContentType("application/x-www-form-urlencoded",!1),jN.getAdapter(a.adapter||su.adapter,a)(a).then(function(r){return hg(a),r.data=ug.call(a,a.transformResponse,r),r.headers=oa.from(r.headers),r},function(r){return vN(r)||(hg(a),r&&r.response&&(r.response.data=ug.call(a,a.transformResponse,r.response),r.response.headers=oa.from(r.response.headers))),Promise.reject(r)})}const EN="1.13.1",$f={};["object","boolean","number","function","string","symbol"].forEach((a,e)=>{$f[a]=function(r){return typeof r===a||"a"+(e<1?"n ":" ")+a}});const vS={};$f.transitional=function(e,s,r){function n(o,c){return"[Axios v"+EN+"] Transitional option '"+o+"'"+c+(r?". "+r:"")}return(o,c,d)=>{if(e===!1)throw new ss(n(c," has been removed"+(s?" in "+s:"")),ss.ERR_DEPRECATED);return s&&!vS[c]&&(vS[c]=!0,console.warn(n(c," has been deprecated since v"+s+" and will be removed in the near future"))),e?e(o,c,d):!0}};$f.spelling=function(e){return(s,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function bk(a,e,s){if(typeof a!="object")throw new ss("options must be an object",ss.ERR_BAD_OPTION_VALUE);const r=Object.keys(a);let n=r.length;for(;n-- >0;){const o=r[n],c=e[o];if(c){const d=a[o],f=d===void 0||c(d,o,a);if(f!==!0)throw new ss("option "+o+" must be "+f,ss.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new ss("Unknown option "+o,ss.ERR_BAD_OPTION)}}const ef={assertOptions:bk,validators:$f},mn=ef.validators;let Jo=class{constructor(e){this.defaults=e||{},this.interceptors={request:new lS,response:new lS}}async request(e,s){try{return await this._request(e,s)}catch(r){if(r instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const o=n.stack?n.stack.replace(/^.+\n/,""):"";try{r.stack?o&&!String(r.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+o):r.stack=o}catch{}}throw r}}_request(e,s){typeof e=="string"?(s=s||{},s.url=e):s=e||{},s=nl(this.defaults,s);const{transitional:r,paramsSerializer:n,headers:o}=s;r!==void 0&&ef.assertOptions(r,{silentJSONParsing:mn.transitional(mn.boolean),forcedJSONParsing:mn.transitional(mn.boolean),clarifyTimeoutError:mn.transitional(mn.boolean)},!1),n!=null&&(et.isFunction(n)?s.paramsSerializer={serialize:n}:ef.assertOptions(n,{encode:mn.function,serialize:mn.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),ef.assertOptions(s,{baseUrl:mn.spelling("baseURL"),withXsrfToken:mn.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let c=o&&et.merge(o.common,o[s.method]);o&&et.forEach(["delete","get","head","post","put","patch","common"],v=>{delete o[v]}),s.headers=oa.concat(c,o);const d=[];let f=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(s)===!1||(f=f&&w.synchronous,d.unshift(w.fulfilled,w.rejected))});const u=[];this.interceptors.response.forEach(function(w){u.push(w.fulfilled,w.rejected)});let m,g=0,x;if(!f){const v=[bS.bind(this),void 0];for(v.unshift(...d),v.push(...u),x=v.length,m=Promise.resolve(s);g<x;)m=m.then(v[g++],v[g++]);return m}x=d.length;let b=s;for(;g<x;){const v=d[g++],w=d[g++];try{b=v(b)}catch(S){w.call(this,S);break}}try{m=bS.call(this,b)}catch(v){return Promise.reject(v)}for(g=0,x=u.length;g<x;)m=m.then(u[g++],u[g++]);return m}getUri(e){e=nl(this.defaults,e);const s=SN(e.baseURL,e.url,e.allowAbsoluteUrls);return xN(s,e.params,e.paramsSerializer)}};et.forEach(["delete","get","head","options"],function(e){Jo.prototype[e]=function(s,r){return this.request(nl(r||{},{method:e,url:s,data:(r||{}).data}))}});et.forEach(["post","put","patch"],function(e){function s(r){return function(o,c,d){return this.request(nl(d||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:o,data:c}))}}Jo.prototype[e]=s(),Jo.prototype[e+"Form"]=s(!0)});let vk=class TN{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(o){s=o});const r=this;this.promise.then(n=>{if(!r._listeners)return;let o=r._listeners.length;for(;o-- >0;)r._listeners[o](n);r._listeners=null}),this.promise.then=n=>{let o;const c=new Promise(d=>{r.subscribe(d),o=d}).then(n);return c.cancel=function(){r.unsubscribe(o)},c},e(function(o,c,d){r.reason||(r.reason=new Sc(o,c,d),s(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const s=this._listeners.indexOf(e);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const e=new AbortController,s=r=>{e.abort(r)};return this.subscribe(s),e.signal.unsubscribe=()=>this.unsubscribe(s),e.signal}static source(){let e;return{token:new TN(function(n){e=n}),cancel:e}}};function wk(a){return function(s){return a.apply(null,s)}}function Sk(a){return et.isObject(a)&&a.isAxiosError===!0}const wp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(wp).forEach(([a,e])=>{wp[e]=a});function AN(a){const e=new Jo(a),s=nN(Jo.prototype.request,e);return et.extend(s,Jo.prototype,e,{allOwnKeys:!0}),et.extend(s,e,null,{allOwnKeys:!0}),s.create=function(n){return AN(nl(a,n))},s}const fr=AN(su);fr.Axios=Jo;fr.CanceledError=Sc;fr.CancelToken=vk;fr.isCancel=vN;fr.VERSION=EN;fr.toFormData=Uf;fr.AxiosError=ss;fr.Cancel=fr.CanceledError;fr.all=function(e){return Promise.all(e)};fr.spread=wk;fr.isAxiosError=Sk;fr.mergeConfig=nl;fr.AxiosHeaders=oa;fr.formToJSON=a=>bN(et.isHTMLForm(a)?new FormData(a):a);fr.getAdapter=jN.getAdapter;fr.HttpStatusCode=wp;fr.default=fr;const{Axios:b8,AxiosError:v8,CanceledError:w8,isCancel:S8,CancelToken:_8,VERSION:N8,all:j8,Cancel:E8,isAxiosError:T8,spread:A8,toFormData:C8,AxiosHeaders:k8,HttpStatusCode:R8,formToJSON:L8,getAdapter:D8,mergeConfig:I8}=fr;var k_;const at=fr.create({baseURL:typeof window<"u"&&((k_=window.Sportarr)==null?void 0:k_.apiRoot)||"/api",headers:{"Content-Type":"application/json"}});at.interceptors.request.use(a=>{var e;return typeof window<"u"&&((e=window.Sportarr)!=null&&e.apiKey)&&(a.headers["X-Api-Key"]=window.Sportarr.apiKey),a});const _k=()=>Cs({queryKey:["events"],queryFn:async()=>{const{data:a}=await at.get("/events");return a}}),CN=()=>Cs({queryKey:["system","status"],queryFn:async()=>{const{data:a}=await at.get("/system/status");return a}}),Nk=()=>Cs({queryKey:["qualityProfiles"],queryFn:async()=>{const{data:a}=await at.get("/qualityprofile");return a}}),jk=()=>Cs({queryKey:["indexers"],queryFn:async()=>{const{data:a}=await at.get("/indexer");return a},refetchInterval:3e4}),Ek=()=>{const a=ca();return dr({mutationFn:async e=>{const{data:s}=await at.post("/indexer",e);return s},onSuccess:()=>{a.invalidateQueries({queryKey:["indexers"]})}})},Tk=()=>{const a=ca();return dr({mutationFn:async e=>{const{data:s}=await at.put(`/indexer/${e.id}`,e);return s},onSuccess:()=>{a.invalidateQueries({queryKey:["indexers"]})}})},Ak=()=>{const a=ca();return dr({mutationFn:async e=>{await at.delete(`/indexer/${e}`)},onSuccess:()=>{a.invalidateQueries({queryKey:["indexers"]})}})},Ck=()=>{const a=ca();return dr({mutationFn:async e=>{await at.post("/indexer/bulk/delete",{ids:e})},onSuccess:()=>{a.invalidateQueries({queryKey:["indexers"]})}})},kk=()=>Cs({queryKey:["logFiles"],queryFn:async()=>{const{data:a}=await at.get("/log/file");return a},refetchInterval:5e3}),Rk=a=>Cs({queryKey:["logFile",a],queryFn:async()=>{if(!a)return null;const{data:e}=await at.get("/log/file/content",{params:{filename:a}});return e},enabled:!!a,refetchInterval:3e3}),kN=a=>Cs({queryKey:["tasks",a],queryFn:async()=>{const e=a?`?pageSize=${a}`:"",{data:s}=await at.get(`/task${e}`);return s},refetchInterval:3e3,notifyOnChangeProps:["data"]}),Lk=()=>{const a=ca();return dr({mutationFn:async e=>{const{data:s}=await at.post("/task",e);return s},onSuccess:()=>{a.invalidateQueries({queryKey:["tasks"]})}})},Dk=()=>{const a=ca();return dr({mutationFn:async e=>{await at.delete(`/task/${e}`)},onSuccess:()=>{a.invalidateQueries({queryKey:["tasks"]})}})},RN=()=>Cs({queryKey:["searchQueueStatus"],queryFn:async()=>{const{data:a}=await at.get("/search/queue");return a},refetchInterval:3e3,notifyOnChangeProps:["data"]}),Ik=()=>Cs({queryKey:["activityCounts"],queryFn:async()=>{const{data:a}=await at.get("/activity/counts");return a},refetchInterval:3e4,notifyOnChangeProps:["data"]}),Mk=()=>Cs({queryKey:["downloadQueue"],queryFn:async()=>{const{data:a}=await at.get("/queue");return a},refetchInterval:3e3,notifyOnChangeProps:["data"],structuralSharing:(a,e)=>{if(!a||!e||!Array.isArray(a)||!Array.isArray(e)||a.length!==e.length)return e;let s=!0;for(let r=0;r<a.length;r++){const n=a[r],o=e.find(c=>c.id===n.id);if(!o){s=!1;break}if(n.status!==o.status||n.eventId!==o.eventId||n.title!==o.title||n.quality!==o.quality){s=!1;break}}return s?a:e}});function Pk({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"}))}const Ok=y.forwardRef(Pk);function Fk({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 8.25H7.5a2.25 2.25 0 0 0-2.25 2.25v9a2.25 2.25 0 0 0 2.25 2.25h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25H15M9 12l3 3m0 0 3-3m-3 3V2.25"}))}const wS=y.forwardRef(Fk);function Bk({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const qs=y.forwardRef(Bk);function Uk({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const xf=y.forwardRef(Uk);function $k({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 0 0-3.7-3.7 48.678 48.678 0 0 0-7.324 0 4.006 4.006 0 0 0-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 0 0 3.7 3.7 48.656 48.656 0 0 0 7.324 0 4.006 4.006 0 0 0 3.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3-3 3"}))}const Gk=y.forwardRef($k);function Hk({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const Dt=y.forwardRef(Hk);function Vk({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"}))}const zk=y.forwardRef(Vk);function qk({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"}))}const SS=y.forwardRef(qk);function Kk({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"}))}const Yk=y.forwardRef(Kk);function Wk({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"}))}const Qk=y.forwardRef(Wk);function Xk({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const tf=y.forwardRef(Xk);function Zk({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 3.104v5.714a2.25 2.25 0 0 1-.659 1.591L5 14.5M9.75 3.104c-.251.023-.501.05-.75.082m.75-.082a24.301 24.301 0 0 1 4.5 0m0 0v5.714c0 .597.237 1.17.659 1.591L19.8 15.3M14.25 3.104c.251.023.501.05.75.082M19.8 15.3l-1.57.393A9.065 9.065 0 0 1 12 15a9.065 9.065 0 0 0-6.23-.693L5 14.5m14.8.8 1.402 1.402c1.232 1.232.65 3.318-1.067 3.611A48.309 48.309 0 0 1 12 21c-2.773 0-5.491-.235-8.135-.687-1.718-.293-2.3-2.379-1.067-3.61L5 14.5"}))}const Jk=y.forwardRef(Zk);function eR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const fg=y.forwardRef(eR);function tR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"}))}const LN=y.forwardRef(tR);function sR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 12.75c1.148 0 2.278.08 3.383.237 1.037.146 1.866.966 1.866 2.013 0 3.728-2.35 6.75-5.25 6.75S6.75 18.728 6.75 15c0-1.046.83-1.867 1.866-2.013A24.204 24.204 0 0 1 12 12.75Zm0 0c2.883 0 5.647.508 8.207 1.44a23.91 23.91 0 0 1-1.152 6.06M12 12.75c-2.883 0-5.647.508-8.208 1.44.125 2.104.52 4.136 1.153 6.06M12 12.75a2.25 2.25 0 0 0 2.248-2.354M12 12.75a2.25 2.25 0 0 1-2.248-2.354M12 8.25c.995 0 1.971-.08 2.922-.236.403-.066.74-.358.795-.762a3.778 3.778 0 0 0-.399-2.25M12 8.25c-.995 0-1.97-.08-2.922-.236-.402-.066-.74-.358-.795-.762a3.734 3.734 0 0 1 .4-2.253M12 8.25a2.25 2.25 0 0 0-2.248 2.146M12 8.25a2.25 2.25 0 0 1 2.248 2.146M8.683 5a6.032 6.032 0 0 1-1.155-1.002c.07-.63.27-1.222.574-1.747m.581 2.749A3.75 3.75 0 0 1 15.318 5m0 0c.427-.283.815-.62 1.155-.999a4.471 4.471 0 0 0-.575-1.752M4.921 6a24.048 24.048 0 0 0-.392 3.314c1.668.546 3.416.914 5.223 1.082M19.08 6c.205 1.08.337 2.187.392 3.314a23.882 23.882 0 0 1-5.223 1.082"}))}const _S=y.forwardRef(sR);function rR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"}))}const aR=y.forwardRef(rR);function nR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}))}const el=y.forwardRef(nR);function iR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const Sp=y.forwardRef(iR);function oR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const rs=y.forwardRef(oR);function lR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const $a=y.forwardRef(lR);function cR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const As=y.forwardRef(cR);function dR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}const DN=y.forwardRef(dR);function uR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))}const _c=y.forwardRef(uR);function hR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 15 12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9"}))}const fR=y.forwardRef(hR);function mR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const Js=y.forwardRef(mR);function gR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5A3.375 3.375 0 0 0 6.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0 0 15 2.25h-1.5a2.251 2.251 0 0 0-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 0 0-9-9Z"}))}const li=y.forwardRef(gR);function pR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const $r=y.forwardRef(pR);function xR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9.75v6.75m0 0-3-3m3 3 3-3m-8.25 6a4.5 4.5 0 0 1-1.41-8.775 5.25 5.25 0 0 1 10.233-2.33 3 3 0 0 1 3.758 3.848A3.752 3.752 0 0 1 18 19.5H6.75Z"}))}const tl=y.forwardRef(xR);function yR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 16.5V9.75m0 0 3 3m-3-3-3 3M6.75 19.5a4.5 4.5 0 0 1-1.41-8.775 5.25 5.25 0 0 1 10.233-2.33 3 3 0 0 1 3.758 3.848A3.752 3.752 0 0 1 18 19.5H6.75Z"}))}const NS=y.forwardRef(yR);function bR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const ru=y.forwardRef(bR);function vR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 3v1.5M4.5 8.25H3m18 0h-1.5M4.5 12H3m18 0h-1.5m-15 3.75H3m18 0h-1.5M8.25 19.5V21M12 3v1.5m0 15V21m3.75-18v1.5m0 15V21m-9-1.5h10.5a2.25 2.25 0 0 0 2.25-2.25V6.75a2.25 2.25 0 0 0-2.25-2.25H6.75A2.25 2.25 0 0 0 4.5 6.75v10.5a2.25 2.25 0 0 0 2.25 2.25Zm.75-12h9v9h-9v-9Z"}))}const wR=y.forwardRef(vR);function SR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const _p=y.forwardRef(SR);function _R({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.125 2.25h-4.5c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125v-9M10.125 2.25h.375a9 9 0 0 1 9 9v.375M10.125 2.25A3.375 3.375 0 0 1 13.5 5.625v1.5c0 .621.504 1.125 1.125 1.125h1.5a3.375 3.375 0 0 1 3.375 3.375M9 15l2.25 2.25L15 12"}))}const Po=y.forwardRef(_R);function NR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"}))}const IN=y.forwardRef(NR);function jR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const MN=y.forwardRef(jR);function ER({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"}))}const di=y.forwardRef(ER);function TR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const Pr=y.forwardRef(TR);function AR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"}))}const pd=y.forwardRef(AR);function CR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const Cd=y.forwardRef(CR);function kR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125M3.375 19.5h1.5C5.496 19.5 6 18.996 6 18.375m-3.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-1.5A1.125 1.125 0 0 1 18 18.375M20.625 4.5H3.375m17.25 0c.621 0 1.125.504 1.125 1.125M20.625 4.5h-1.5C18.504 4.5 18 5.004 18 5.625m3.75 0v1.5c0 .621-.504 1.125-1.125 1.125M3.375 4.5c-.621 0-1.125.504-1.125 1.125M3.375 4.5h1.5C5.496 4.5 6 5.004 6 5.625m-3.75 0v1.5c0 .621.504 1.125 1.125 1.125m0 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m1.5-3.75C5.496 8.25 6 7.746 6 7.125v-1.5M4.875 8.25C5.496 8.25 6 8.754 6 9.375v1.5m0-5.25v5.25m0-5.25C6 5.004 6.504 4.5 7.125 4.5h9.75c.621 0 1.125.504 1.125 1.125m1.125 2.625h1.5m-1.5 0A1.125 1.125 0 0 1 18 7.125v-1.5m1.125 2.625c-.621 0-1.125.504-1.125 1.125v1.5m2.625-2.625c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125M18 5.625v5.25M7.125 12h9.75m-9.75 0A1.125 1.125 0 0 1 6 10.875M7.125 12C6.504 12 6 12.504 6 13.125m0-2.25C6 11.496 5.496 12 4.875 12M18 10.875c0 .621-.504 1.125-1.125 1.125M18 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m-12 5.25v-5.25m0 5.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125m-12 0v-1.5c0-.621-.504-1.125-1.125-1.125M18 18.375v-5.25m0 5.25v-1.5c0-.621.504-1.125 1.125-1.125M18 13.125v1.5c0 .621.504 1.125 1.125 1.125M18 13.125c0-.621.504-1.125 1.125-1.125M6 13.125v1.5c0 .621-.504 1.125-1.125 1.125M6 13.125C6 12.504 5.496 12 4.875 12m-1.5 0h1.5m-1.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M19.125 12h1.5m0 0c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h1.5m14.25 0h1.5"}))}const En=y.forwardRef(kR);function RR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9 13.5 3 3m0 0 3-3m-3 3v-6m1.06-4.19-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"}))}const LR=y.forwardRef(RR);function DR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 13.5H9m4.06-7.19-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"}))}const IR=y.forwardRef(DR);function MR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 9.776c.112-.017.227-.026.344-.026h15.812c.117 0 .232.009.344.026m-16.5 0a2.25 2.25 0 0 0-1.883 2.542l.857 6a2.25 2.25 0 0 0 2.227 1.932H19.05a2.25 2.25 0 0 0 2.227-1.932l.857-6a2.25 2.25 0 0 0-1.883-2.542m-16.5 0V6A2.25 2.25 0 0 1 6 3.75h3.879a1.5 1.5 0 0 1 1.06.44l2.122 2.12a1.5 1.5 0 0 0 1.06.44H18A2.25 2.25 0 0 1 20.25 9v.776"}))}const Np=y.forwardRef(MR);function PR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 10.5v6m3-3H9m4.06-7.19-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"}))}const OR=y.forwardRef(PR);function FR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"}))}const Kr=y.forwardRef(FR);function BR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const au=y.forwardRef(BR);function UR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"}))}const Gf=y.forwardRef(UR);function $R({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"}))}const GR=y.forwardRef($R);function HR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))}const yx=y.forwardRef(HR);function VR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"}))}const Or=y.forwardRef(VR);function zR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244"}))}const Fd=y.forwardRef(zR);function qR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm-.375 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const KR=y.forwardRef(qR);function YR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"}))}const WR=y.forwardRef(YR);function QR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const Ks=y.forwardRef(QR);function XR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"}))}const PN=y.forwardRef(XR);function ZR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 6.75V15m6-6v8.25m.503 3.498 4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 0 0-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0Z"}))}const Nh=y.forwardRef(ZR);function JR({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636"}))}const no=y.forwardRef(JR);function e3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.53 16.122a3 3 0 0 0-5.78 1.128 2.25 2.25 0 0 1-2.4 2.245 4.5 4.5 0 0 0 8.4-2.245c0-.399-.078-.78-.22-1.128Zm0 0a15.998 15.998 0 0 0 3.388-1.62m-5.043-.025a15.994 15.994 0 0 1 1.622-3.395m3.42 3.42a15.995 15.995 0 0 0 4.764-4.648l3.876-5.814a1.151 1.151 0 0 0-1.597-1.597L14.146 6.32a15.996 15.996 0 0 0-4.649 4.763m3.42 3.42a6.776 6.776 0 0 0-3.42-3.42"}))}const t3=y.forwardRef(e3);function s3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"}))}const r3=y.forwardRef(s3);function a3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"}))}const jS=y.forwardRef(a3);function n3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const an=y.forwardRef(n3);function i3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"}))}const nu=y.forwardRef(i3);function o3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const hr=y.forwardRef(o3);function l3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z"}))}const yf=y.forwardRef(l3);function c3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 17.25v-.228a4.5 4.5 0 0 0-.12-1.03l-2.268-9.64a3.375 3.375 0 0 0-3.285-2.602H7.923a3.375 3.375 0 0 0-3.285 2.602l-2.268 9.64a4.5 4.5 0 0 0-.12 1.03v.228m19.5 0a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3m19.5 0a3 3 0 0 0-3-3H5.25a3 3 0 0 0-3 3m16.5 0h.008v.008h-.008v-.008Zm-3 0h.008v.008h-.008v-.008Z"}))}const bx=y.forwardRef(c3);function d3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))}const jp=y.forwardRef(d3);function u3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.348 14.652a3.75 3.75 0 0 1 0-5.304m5.304 0a3.75 3.75 0 0 1 0 5.304m-7.425 2.121a6.75 6.75 0 0 1 0-9.546m9.546 0a6.75 6.75 0 0 1 0 9.546M5.106 18.894c-3.808-3.807-3.808-9.98 0-13.788m13.788 0c3.808 3.807 3.808 9.98 0 13.788M12 12h.008v.008H12V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const _n=y.forwardRef(u3);function h3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"}))}const f3=y.forwardRef(h3);function m3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 0 1 0 12.728M16.463 8.288a5.25 5.25 0 0 1 0 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"}))}const ON=y.forwardRef(m3);function g3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"}))}const p3=y.forwardRef(g3);function x3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"}))}const ES=y.forwardRef(x3);function y3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"}))}const _d=y.forwardRef(y3);function b3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6h.008v.008H6V6Z"}))}const vx=y.forwardRef(b3);function v3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const cs=y.forwardRef(v3);function w3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 18.75h-9m9 0a3 3 0 0 1 3 3h-15a3 3 0 0 1 3-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 0 1-.982-3.172M9.497 14.25a7.454 7.454 0 0 0 .981-3.172M5.25 4.236c-.982.143-1.954.317-2.916.52A6.003 6.003 0 0 0 7.73 9.728M5.25 4.236V4.5c0 2.108.966 3.99 2.48 5.228M5.25 4.236V2.721C7.456 2.41 9.71 2.25 12 2.25c2.291 0 4.545.16 6.75.47v1.516M7.73 9.728a6.726 6.726 0 0 0 2.748 1.35m8.272-6.842V4.5c0 2.108-.966 3.99-2.48 5.228m2.48-5.492a46.32 46.32 0 0 1 2.916.52 6.003 6.003 0 0 1-5.395 4.972m0 0a6.726 6.726 0 0 1-2.749 1.35m0 0a6.772 6.772 0 0 1-3.044 0"}))}const bf=y.forwardRef(w3);function S3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 20.25h12m-7.5-3v3m3-3v3m-10.125-3h17.25c.621 0 1.125-.504 1.125-1.125V4.875c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125Z"}))}const io=y.forwardRef(S3);function _3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const sf=y.forwardRef(_3);function N3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"}))}const j3=y.forwardRef(N3);function E3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15.75 10.5 4.72-4.72a.75.75 0 0 1 1.28.53v11.38a.75.75 0 0 1-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25h-9A2.25 2.25 0 0 0 2.25 7.5v9a2.25 2.25 0 0 0 2.25 2.25Z"}))}const ii=y.forwardRef(E3);function T3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Ss=y.forwardRef(T3);function A3({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const qt=y.forwardRef(A3),C3=()=>Cs({queryKey:["activeSearchStatus"],queryFn:async()=>{const{data:a}=await at.get("/search/active");return a},refetchInterval:3e3,notifyOnChangeProps:["data"]}),k3=()=>Cs({queryKey:["searchQueueStatus"],queryFn:async()=>{const{data:a}=await at.get("/search/queue");return a},refetchInterval:3e3,notifyOnChangeProps:["data"]}),R3=()=>Cs({queryKey:["downloadQueue"],queryFn:async()=>{const{data:a}=await at.get("/queue");return a},refetchInterval:5e3,notifyOnChangeProps:["data"],structuralSharing:(a,e)=>{if(!a||!e||!Array.isArray(a)||!Array.isArray(e)||a.length!==e.length)return e;let s=!0;for(let r=0;r<a.length;r++){const n=a[r],o=e.find(c=>c.id===n.id);if(!o){s=!1;break}if(n.status!==o.status||n.eventId!==o.eventId||n.title!==o.title){s=!1;break}}return s?a:e}});function L3(){const a=C3(),e=k3(),s=R3(),r=kN(10),n=a.data,o=e.data,c=s.data,d=r.data,[f,u]=y.useState(null),[m,g]=y.useState(!1),[x,b]=y.useState(null),[v,w]=y.useState(null),[S,T]=y.useState(!0),k=y.useRef(new Set),E=y.useRef(new Set),R=y.useRef(new Map),K=y.useRef(null),z=y.useRef(null);y.useEffect(()=>()=>{K.current&&clearTimeout(K.current),z.current&&clearTimeout(z.current)},[]),y.useEffect(()=>{var ce,ee;if(!c)return;if(R.current.size===0&&c.length>0){const W=c.find(oe=>oe.status===6),V=c.find(oe=>oe.status===1),G=c.find(oe=>oe.status===0),Z=W||V||G;if(Z){let oe;Z.status===6?oe="importing":Z.status===1?oe="downloading":oe="grabbed",w({id:Z.id,title:((ce=Z.event)==null?void 0:ce.title)||Z.title,quality:Z.quality,status:oe,timestamp:Date.now()})}c.forEach(oe=>{R.current.set(oe.id,oe.status)});return}for(const W of c){const V=R.current.get(W.id);if(V===void 0||V!==W.status){R.current.set(W.id,W.status);let G=null;V===void 0&&W.status===0?G="grabbed":W.status===1&&V!==1?G="downloading":W.status===6&&V!==6?G="importing":W.status===7&&V!==7&&(G="imported"),G&&(w({id:W.id,title:((ee=W.event)==null?void 0:ee.title)||W.title,quality:W.quality,status:G,timestamp:Date.now()}),z.current&&clearTimeout(z.current),G==="imported"&&(z.current=setTimeout(()=>{w(null)},5e3)))}}const ae=new Set(c.map(W=>W.id));R.current.forEach((W,V)=>{ae.has(V)||R.current.delete(V)}),v&&!ae.has(v.id)&&v.status!=="imported"&&w(null)},[c,v]),y.useEffect(()=>{if(!d||d.length===0){u(null);return}S&&(d.forEach(ae=>{ae.id&&k.current.add(ae.id)}),T(!1));const q=d.find(ae=>ae.status==="Running"||ae.status==="Queued"||ae.status==="Aborting");if(q)u(q),g(!1),q.id&&!k.current.has(q.id)&&k.current.add(q.id);else{const ae=d.find(ce=>{if(ce.status!=="Completed"&&ce.status!=="Failed"||!ce.ended||!ce.id||k.current.has(ce.id))return!1;const ee=new Date(ce.ended).getTime();return Date.now()-ee<5e3});ae&&ae.id!==(x==null?void 0:x.id)?(ae.id&&k.current.add(ae.id),b(ae),u(ae),g(!0),K.current&&clearTimeout(K.current),K.current=setTimeout(()=>{g(!1),u(null)},5e3)):m||u(null)}},[d,x==null?void 0:x.id,m,S]),y.useEffect(()=>{o!=null&&o.recentlyCompleted&&o.recentlyCompleted.forEach(q=>{if(q.completedAt){const ae=new Date(q.completedAt).getTime();Date.now()-ae>5e3&&E.current.add(q.id)}})},[o==null?void 0:o.recentlyCompleted]);const D=n&&!n.isComplete,O=o&&(o.pendingCount>0||o.activeCount>0),U=o&&o.recentlyCompleted.some(q=>{if(E.current.has(q.id)||!q.completedAt)return!1;const ae=new Date(q.completedAt).getTime();return Date.now()-ae<5e3}),I=v!==null;if(!D&&!O&&!U&&!f&&!I)return null;const F=(f==null?void 0:f.progress)??0,te=(f==null?void 0:f.status)==="Running",le=(f==null?void 0:f.status)==="Queued",H=(f==null?void 0:f.status)==="Completed",X=(f==null?void 0:f.status)==="Failed";return t.jsxs("div",{className:"px-3 py-2 space-y-2 border-t border-red-900/30",children:[D&&t.jsxs("div",{className:"bg-black/40 border border-gray-700/50 rounded px-3 py-2 flex items-center gap-2",children:[t.jsx(Ks,{className:"w-4 h-4 text-blue-400 animate-pulse flex-shrink-0"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"text-xs text-white font-medium truncate",children:[n.eventTitle||n.searchQuery,n.part&&` (${n.part})`]}),t.jsxs("div",{className:"text-xs text-gray-400",children:[n.activeIndexers," indexer",n.activeIndexers!==1?"s":"",n.releasesFound>0&&t.jsxs("span",{className:"text-green-400 ml-1",children:[" ",n.releasesFound," found"]})]})]})]}),!D&&O&&o.activeSearches.length>0&&t.jsxs("div",{className:"bg-black/40 border border-gray-700/50 rounded px-3 py-2 flex items-center gap-2",children:[t.jsx(Ks,{className:"w-4 h-4 text-blue-400 animate-pulse flex-shrink-0"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"text-xs text-white font-medium truncate",children:[o.activeSearches[0].eventTitle,o.activeSearches[0].part&&t.jsxs("span",{className:"text-gray-400",children:[" (",o.activeSearches[0].part,")"]})]}),t.jsx("div",{className:"text-xs text-gray-400 truncate",children:o.activeSearches[0].message})]})]}),!D&&!f&&U&&(o==null?void 0:o.recentlyCompleted)&&t.jsx(t.Fragment,{children:o.recentlyCompleted.filter(q=>{if(!q.completedAt)return!1;const ae=new Date(q.completedAt).getTime();return Date.now()-ae<5e3&&!E.current.has(q.id)}).slice(0,1).map(q=>t.jsxs("div",{className:"bg-black/40 border border-gray-700/50 rounded px-3 py-2 flex items-center gap-2",children:[q.success?t.jsx(rs,{className:"w-4 h-4 text-green-400 flex-shrink-0"}):t.jsx(Ss,{className:"w-4 h-4 text-yellow-400 flex-shrink-0"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"text-xs text-white font-medium truncate",children:[q.eventTitle,q.part&&t.jsxs("span",{className:"text-gray-400",children:[" (",q.part,")"]})]}),t.jsx("div",{className:`text-xs truncate ${q.success?"text-green-400":"text-yellow-400"}`,children:q.message})]})]},q.id))}),I&&v&&t.jsxs("div",{className:"bg-black/40 border border-gray-700/50 rounded px-3 py-2 flex items-center gap-2",children:[v.status==="grabbed"&&t.jsx(qs,{className:"w-4 h-4 text-blue-400 flex-shrink-0"}),v.status==="downloading"&&t.jsx(qs,{className:"w-4 h-4 text-blue-400 animate-pulse flex-shrink-0"}),v.status==="importing"&&t.jsx(Dt,{className:"w-4 h-4 text-yellow-400 animate-spin flex-shrink-0"}),v.status==="imported"&&t.jsx(Po,{className:"w-4 h-4 text-green-400 flex-shrink-0"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"text-xs text-white font-medium truncate",children:v.title}),t.jsxs("div",{className:`text-xs truncate ${v.status==="imported"?"text-green-400":v.status==="importing"?"text-yellow-400":"text-blue-400"}`,children:[v.status==="grabbed"&&"Release grabbed - sent to download client",v.status==="downloading"&&"Downloading...",v.status==="importing"&&"Importing to library...",v.status==="imported"&&"Successfully imported",v.quality&&t.jsxs("span",{className:"text-gray-400 ml-1",children:["(",v.quality,")"]})]})]})]}),f&&!D&&t.jsxs("div",{className:"bg-black/40 border border-gray-700/50 rounded px-3 py-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[(te||le)&&t.jsx(Dt,{className:"w-4 h-4 text-blue-400 animate-spin flex-shrink-0"}),H&&t.jsx(rs,{className:"w-4 h-4 text-green-400 flex-shrink-0"}),X&&t.jsx(Ss,{className:"w-4 h-4 text-red-400 flex-shrink-0"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"text-xs text-white font-medium truncate",children:f.name}),f.message&&t.jsx("div",{className:"text-xs text-gray-400 truncate",children:f.message})]}),te&&t.jsxs("div",{className:"text-xs text-gray-400 flex-shrink-0",children:[Math.round(F),"%"]})]}),te&&t.jsx("div",{className:"mt-1.5 w-full bg-gray-700 rounded-full h-1 overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-red-600 to-red-500 transition-all duration-300 ease-out",style:{width:`${Math.min(100,Math.max(0,F))}%`}})}),(H||X)&&t.jsx("div",{className:`text-xs mt-1 ${X?"text-red-400":"text-green-400"}`,children:X?"Task failed":"Task completed"})]}),O&&o.pendingCount>0&&t.jsxs("div",{className:"bg-black/40 border border-gray-700/50 rounded px-3 py-1.5 flex items-center gap-2",children:[t.jsx(yf,{className:"w-3.5 h-3.5 text-gray-400 flex-shrink-0"}),t.jsxs("div",{className:"text-xs text-gray-400",children:[o.pendingCount," search",o.pendingCount!==1?"es":""," queued"]})]})]})}const D3=y.memo(L3),FN=y.createContext(void 0);function I3({children:a}){const[e,s]=y.useState(!1),[r,n]=y.useState(!1),[o,c]=y.useState(!0),[d,f]=y.useState(!0),u=Ta(),m=Ea(),g=y.useRef(!1),x=y.useRef(m.pathname),b=y.useCallback(async()=>{try{console.log("[AUTH] Checking authentication status...");const S=new AbortController,T=setTimeout(()=>S.abort(),1e4),k=await fetch("/api/auth/check",{signal:S.signal});clearTimeout(T);const E=window.location.pathname;if(console.log("[AUTH] Current path:",E),k.ok){const R=await k.json();if(console.log("[AUTH] Auth check response:",R),s(R.authenticated),c(R.authDisabled===!0),n(!R.authDisabled&&!R.authenticated),R.authenticated){if(console.log("[AUTH] Authenticated, allowing access"),E==="/login"){const z=new URLSearchParams(window.location.search).get("returnUrl")||"/leagues";u(z,{replace:!0})}return}if(!R.authenticated&&!R.authDisabled){console.log("[AUTH] Not authenticated, redirecting to /login"),E!=="/login"&&u(`/login?returnUrl=${encodeURIComponent(E)}`,{replace:!0});return}}else console.error("[AUTH] Auth check failed with status:",k.status),s(!0),c(!0),n(!1)}catch(S){S instanceof Error&&S.name==="AbortError"?console.error("[AUTH] Auth check timed out after 10 seconds"):console.error("[AUTH] Failed to check authentication:",S),s(!0),c(!0),n(!1)}finally{f(!1)}},[u]);y.useEffect(()=>{g.current||(console.log("[AUTH] AuthContext mounted, checking auth once"),g.current=!0,b())},[b]),y.useEffect(()=>{const S=x.current;x.current=m.pathname,S==="/login"&&m.pathname!=="/login"&&(console.log("[AUTH] Navigated away from login page, re-checking"),b())},[m.pathname,b]);const v=async(S,T,k)=>{try{const E=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:S,password:T,rememberMe:k})});return E.ok&&(await E.json()).success?(s(!0),!0):!1}catch(E){return console.error("Login failed:",E),!1}},w=async()=>{try{await fetch("/api/logout",{method:"POST",credentials:"include"})}catch(S){console.error("Logout failed:",S)}finally{s(!1),u("/login")}};return t.jsx(FN.Provider,{value:{isAuthenticated:e,isAuthRequired:r,isAuthDisabled:o,isLoading:d,login:v,logout:w,checkAuth:b},children:a})}function wx(){const a=y.useContext(FN);if(a===void 0)throw new Error("useAuth must be used within an AuthProvider");return a}function M3(){const a=Ea(),e=Ta(),{data:s}=CN(),{data:r}=Ik(),{isAuthDisabled:n,logout:o}=wx(),[c,d]=y.useState(["Leagues"]),[f,u]=y.useState(!1);y.useEffect(()=>{document.querySelectorAll("[inert]").forEach(S=>{S.removeAttribute("inert")});const w=setTimeout(()=>{document.querySelectorAll("[inert]").forEach(S=>{S.removeAttribute("inert")})},100);return()=>clearTimeout(w)},[a.pathname]),y.useEffect(()=>{document.querySelectorAll("[inert]").forEach(w=>{w.removeAttribute("inert")})},[]);const m=[{label:"Leagues",icon:Kr,path:"/leagues",children:[{label:"Add League",path:"/add-league/search"},{label:"Library Import",path:"/library-import"}]},{label:"Calendar",icon:$r,path:"/calendar"},{label:"Activity",icon:$r,path:"/activity",badge:r==null?void 0:r.queueCount},{label:"Wanted",icon:di,path:"/wanted"},{label:"IPTV",icon:_n,path:"/iptv",children:[{label:"Sources",path:"/iptv/sources"},{label:"Channels",path:"/iptv/channels"},{label:"TV Guide",path:"/iptv/guide"},{label:"Recordings",path:"/iptv/recordings"}]},{label:"Settings",icon:ru,path:"/settings",children:[{label:"Media Management",path:"/settings/mediamanagement"},{label:"Profiles",path:"/settings/profiles"},{label:"Quality",path:"/settings/quality"},{label:"Custom Formats",path:"/settings/customformats"},{label:"TRaSH Guides",path:"/settings/trashguides"},{label:"Indexers",path:"/settings/indexers"},{label:"Import Lists",path:"/settings/importlists"},{label:"Download Clients",path:"/settings/downloadclients"},{label:"Notifications",path:"/settings/notifications"},{label:"General",path:"/settings/general"},{label:"UI",path:"/settings/ui"},{label:"Tags",path:"/settings/tags"}]},{label:"System",icon:bx,path:"/system",children:[{label:"Status",path:"/system/status"},{label:"Health",path:"/system/health"},{label:"Tasks",path:"/system/tasks"},{label:"Backup",path:"/system/backup"},{label:"Updates",path:"/system/updates"},{label:"Events",path:"/system/events"},{label:"Log Files",path:"/system/logs"}]}],g=w=>{d(S=>S.includes(w)?S.filter(T=>T!==w):[...S,w])},x=()=>{document.querySelectorAll("[inert]").forEach(w=>{w.removeAttribute("inert")})},b=(w,S)=>{var T;if(x(),w.path&&a.pathname===w.path){g(w.label),S.preventDefault();return}if(c.includes(w.label)&&((T=w.children)!=null&&T.some(k=>a.pathname===k.path))){g(w.label),S.preventDefault();return}g(w.label),w.path&&e(w.path)},v=(w,S)=>w?a.pathname===w:S?S.some(T=>a.pathname===T.path):!1;return y.useEffect(()=>{const w=m.find(S=>S.path&&a.pathname===S.path?!0:S.children?S.children.some(T=>a.pathname===T.path):!1);w&&d(w.children?[w.label]:[]),u(!1)},[a.pathname]),t.jsxs("div",{className:"flex h-screen bg-black text-gray-100",children:[t.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 md:hidden bg-gradient-to-r from-gray-900 to-black border-b border-red-900/30",children:t.jsxs("div",{className:"flex items-center justify-between p-3",children:[t.jsxs(Ql,{to:"/leagues",onClick:()=>{x(),u(!1)},className:"flex items-center space-x-2",children:[t.jsx("img",{src:"/logo-64.png",alt:"Sportarr Logo",className:"w-8 h-8 rounded-lg"}),t.jsx("h1",{className:"text-lg font-bold text-white",children:"Sportarr"})]}),t.jsx("button",{onClick:()=>u(!f),className:"p-2 text-gray-300 hover:text-white hover:bg-red-900/30 rounded-lg transition-colors",children:f?t.jsx(qt,{className:"w-6 h-6"}):t.jsx(tf,{className:"w-6 h-6"})})]})}),f&&t.jsx("div",{className:"fixed inset-0 bg-black/80 z-40 md:hidden",onClick:()=>u(!1)}),t.jsxs("aside",{className:`
        fixed md:relative inset-y-0 left-0 z-40
        w-64 bg-gradient-to-b from-gray-900 to-black border-r border-red-900/30 flex flex-col
        transform transition-transform duration-300 ease-in-out
        ${f?"translate-x-0":"-translate-x-full"}
        md:translate-x-0 md:flex
        pt-14 md:pt-0
      `,children:[t.jsx("div",{className:"hidden md:block p-4 border-b border-red-900/30",children:t.jsxs(Ql,{to:"/leagues",onClick:x,className:"flex items-center space-x-3",children:[t.jsx("img",{src:"/logo-64.png",alt:"Sportarr Logo",className:"w-10 h-10 rounded-lg"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl font-bold text-white",children:"Sportarr"}),s&&t.jsxs("p",{className:"text-xs text-gray-400",children:["v",s.version]})]})]})}),t.jsx("nav",{className:"flex-1 overflow-y-auto py-4",children:m.map(w=>t.jsx("div",{children:w.children?t.jsxs("div",{children:[t.jsxs("button",{onClick:S=>b(w,S),className:`w-full flex items-center justify-between px-4 py-2.5 text-sm font-medium transition-colors ${v(w.path,w.children)?"bg-red-900/30 text-white border-l-4 border-red-600":"text-gray-300 hover:bg-red-900/10 hover:text-white"}`,children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(w.icon,{className:"w-5 h-5"}),t.jsx("span",{children:w.label})]}),t.jsx(As,{className:`w-4 h-4 transition-transform ${c.includes(w.label)?"rotate-180":""}`})]}),c.includes(w.label)&&t.jsx("div",{className:"bg-black/30",children:w.children.map(S=>t.jsx(Ql,{to:S.path,onClick:x,className:`block px-4 py-2 pl-12 text-sm transition-colors ${a.pathname===S.path?"bg-red-900/30 text-white border-l-4 border-red-600":"text-gray-400 hover:bg-red-900/10 hover:text-white"}`,children:S.label},S.path))})]}):t.jsxs(Ql,{to:w.path,onClick:x,className:`flex items-center justify-between px-4 py-2.5 text-sm font-medium transition-colors ${a.pathname===w.path?"bg-red-900/30 text-white border-l-4 border-red-600":"text-gray-300 hover:bg-red-900/10 hover:text-white"}`,children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(w.icon,{className:"w-5 h-5"}),t.jsx("span",{children:w.label})]}),w.badge!==void 0&&w.badge>0&&t.jsx("span",{className:"px-2 py-0.5 bg-red-600 text-white text-xs rounded-full min-w-[20px] text-center",children:w.badge})]})},w.label))}),t.jsx(D3,{}),!n&&t.jsx("div",{className:"px-4 py-2 border-t border-red-900/30",children:t.jsxs("button",{onClick:o,className:"w-full flex items-center space-x-2 px-3 py-2 text-sm text-gray-400 hover:text-white hover:bg-red-900/20 rounded-lg transition-colors",children:[t.jsx(zk,{className:"w-5 h-5"}),t.jsx("span",{children:"Sign Out"})]})}),t.jsx("div",{className:"p-4 border-t border-red-900/30",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"text-xs text-gray-500",children:[t.jsx("p",{children:" 2025 Sportarr"}),t.jsx("p",{className:"mt-1",children:"Universal Sports Event Manager"})]}),t.jsx("a",{href:"https://discord.gg/YjHVWGWjjG",target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 hover:text-[#5865F2] transition-colors",title:"Join our Discord server for support",children:t.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",children:t.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515a.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0a12.64 12.64 0 0 0-.617-1.25a.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057a19.9 19.9 0 0 0 5.993 3.03a.078.078 0 0 0 .084-.028a14.09 14.09 0 0 0 1.226-1.994a.076.076 0 0 0-.041-.106a13.107 13.107 0 0 1-1.872-.892a.077.077 0 0 1-.008-.128a10.2 10.2 0 0 0 .372-.292a.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127a12.299 12.299 0 0 1-1.873.892a.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028a19.839 19.839 0 0 0 6.002-3.03a.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.956-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.955-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.946 2.418-2.157 2.418z"})})})]})})]}),t.jsx("main",{className:"flex-1 overflow-auto bg-gradient-to-br from-gray-950 via-black to-gray-950 pt-14 md:pt-0",children:t.jsx(FC,{})})]})}class P3 extends y.Component{constructor(s){super(s);eg(this,"handleReload",()=>{window.location.reload()});eg(this,"handleGoHome",()=>{window.location.href="/leagues"});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(s){return{hasError:!0}}componentDidCatch(s,r){console.error("ErrorBoundary caught an error:",s,r),be.error("Application Error",{description:s.message||"An unexpected error occurred. Please try reloading the page.",duration:1e4}),this.logErrorToService(s,r),this.setState({error:s,errorInfo:r})}logErrorToService(s,r){console.error("Error logged to service:",{error:s,errorInfo:r})}render(){var s;return this.state.hasError?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900 flex items-center justify-center p-4",children:t.jsxs("div",{className:"max-w-2xl w-full text-center",children:[t.jsx("div",{className:"mb-8",children:t.jsx("img",{src:"/error.png",alt:"Error",className:"w-full max-w-md mx-auto"})}),t.jsx("h1",{className:"text-6xl font-bold text-white mb-4",children:"Oops!"}),t.jsx("h2",{className:"text-3xl font-semibold text-red-500 mb-4",children:"Application Error"}),t.jsx("p",{className:"text-xl text-gray-400 mb-8",children:((s=this.state.error)==null?void 0:s.message)||"An unexpected error occurred"}),t.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[t.jsxs("button",{onClick:this.handleReload,className:"flex items-center px-6 py-3 bg-gray-800 hover:bg-gray-700 text-white font-semibold rounded-lg transition-colors",children:[t.jsx(Dt,{className:"w-5 h-5 mr-2"}),"Reload Page"]}),t.jsxs("button",{onClick:this.handleGoHome,className:"flex items-center px-6 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white font-semibold rounded-lg shadow-lg transform transition hover:scale-105",children:[t.jsx(yx,{className:"w-5 h-5 mr-2"}),"Go to Events"]})]}),this.state.error&&t.jsxs("details",{className:"mt-8 text-left",children:[t.jsx("summary",{className:"cursor-pointer text-gray-400 hover:text-white mb-2",children:"Technical Details (click to expand)"}),t.jsxs("div",{className:"p-4 bg-gray-900/80 border border-gray-800 rounded-lg text-xs",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("span",{className:"text-red-400 font-semibold",children:"Error:"}),t.jsx("pre",{className:"text-gray-400 mt-1 overflow-x-auto",children:this.state.error.toString()})]}),this.state.errorInfo&&t.jsxs("div",{children:[t.jsx("span",{className:"text-red-400 font-semibold",children:"Component Stack:"}),t.jsx("pre",{className:"text-gray-400 mt-1 overflow-x-auto",children:this.state.errorInfo.componentStack})]})]})]}),t.jsxs("div",{className:"mt-12 p-6 bg-gray-900/50 border border-gray-800 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Need Help?"}),t.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"If this error persists, try the following:"}),t.jsxs("ul",{className:"text-sm text-gray-400 space-y-2 text-left max-w-md mx-auto",children:[t.jsx("li",{children:" Clear your browser cache and reload the page"}),t.jsx("li",{children:" Check the browser console for additional error details"}),t.jsx("li",{children:" Disable browser extensions that might interfere"}),t.jsx("li",{children:" Try accessing the application in an incognito window"}),t.jsx("li",{children:" Report the issue on GitHub with the error details above"})]})]})]})}):this.props.children}}function O3({children:a}){const{isAuthenticated:e,isAuthDisabled:s,isLoading:r}=wx(),n=Ea();return r?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-600 mb-4"}),t.jsx("p",{className:"text-gray-400",children:"Loading..."})]})}):s?(console.log("[PROTECTED ROUTE] Authentication disabled, allowing access"),t.jsx(t.Fragment,{children:a})):e?(console.log("[PROTECTED ROUTE] User authenticated, allowing access to:",n.pathname),t.jsx(t.Fragment,{children:a})):(console.log("[PROTECTED ROUTE] Not authenticated, redirecting to /login"),t.jsx(Yl,{to:`/login?returnUrl=${encodeURIComponent(n.pathname)}`,replace:!0}))}var F3=Object.defineProperty,B3=(a,e,s)=>e in a?F3(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s,mg=(a,e,s)=>(B3(a,typeof e!="symbol"?e+"":e,s),s);let U3=class{constructor(){mg(this,"current",this.detect()),mg(this,"handoffState","pending"),mg(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},Tn=new U3;function iu(a){var e;return Tn.isServer?null:a==null?document:(e=a==null?void 0:a.ownerDocument)!=null?e:document}function Ep(a){var e,s;return Tn.isServer?null:a==null?document:(s=(e=a==null?void 0:a.getRootNode)==null?void 0:e.call(a))!=null?s:document}function BN(a){var e,s;return(s=(e=Ep(a))==null?void 0:e.activeElement)!=null?s:null}function $3(a){return BN(a)===a}function Hf(a){typeof queueMicrotask=="function"?queueMicrotask(a):Promise.resolve().then(a).catch(e=>setTimeout(()=>{throw e}))}function gi(){let a=[],e={addEventListener(s,r,n,o){return s.addEventListener(r,n,o),e.add(()=>s.removeEventListener(r,n,o))},requestAnimationFrame(...s){let r=requestAnimationFrame(...s);return e.add(()=>cancelAnimationFrame(r))},nextFrame(...s){return e.requestAnimationFrame(()=>e.requestAnimationFrame(...s))},setTimeout(...s){let r=setTimeout(...s);return e.add(()=>clearTimeout(r))},microTask(...s){let r={current:!0};return Hf(()=>{r.current&&s[0]()}),e.add(()=>{r.current=!1})},style(s,r,n){let o=s.style.getPropertyValue(r);return Object.assign(s.style,{[r]:n}),this.add(()=>{Object.assign(s.style,{[r]:o})})},group(s){let r=gi();return s(r),this.add(()=>r.dispose())},add(s){return a.includes(s)||a.push(s),()=>{let r=a.indexOf(s);if(r>=0)for(let n of a.splice(r,1))n()}},dispose(){for(let s of a.splice(0))s()}};return e}function Vf(){let[a]=y.useState(gi);return y.useEffect(()=>()=>a.dispose(),[a]),a}let la=(a,e)=>{Tn.isServer?y.useEffect(a,e):y.useLayoutEffect(a,e)};function ll(a){let e=y.useRef(a);return la(()=>{e.current=a},[a]),e}let Vs=function(a){let e=ll(a);return lt.useCallback((...s)=>e.current(...s),[e])};function ou(a){return y.useMemo(()=>a,Object.values(a))}let G3=y.createContext(void 0);function H3(){return y.useContext(G3)}function Tp(...a){return Array.from(new Set(a.flatMap(e=>typeof e=="string"?e.split(" "):[]))).filter(Boolean).join(" ")}function mi(a,e,...s){if(a in e){let n=e[a];return typeof n=="function"?n(...s):n}let r=new Error(`Tried to handle "${a}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(n=>`"${n}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,mi),r}var vf=(a=>(a[a.None=0]="None",a[a.RenderStrategy=1]="RenderStrategy",a[a.Static=2]="Static",a))(vf||{}),to=(a=>(a[a.Unmount=0]="Unmount",a[a.Hidden=1]="Hidden",a))(to||{});function za(){let a=z3();return y.useCallback(e=>V3({mergeRefs:a,...e}),[a])}function V3({ourProps:a,theirProps:e,slot:s,defaultTag:r,features:n,visible:o=!0,name:c,mergeRefs:d}){d=d??q3;let f=UN(e,a);if(o)return jh(f,s,r,c,d);let u=n??0;if(u&2){let{static:m=!1,...g}=f;if(m)return jh(g,s,r,c,d)}if(u&1){let{unmount:m=!0,...g}=f;return mi(m?0:1,{0(){return null},1(){return jh({...g,hidden:!0,style:{display:"none"}},s,r,c,d)}})}return jh(f,s,r,c,d)}function jh(a,e={},s,r,n){let{as:o=s,children:c,refName:d="ref",...f}=gg(a,["unmount","static"]),u=a.ref!==void 0?{[d]:a.ref}:{},m=typeof c=="function"?c(e):c;"className"in f&&f.className&&typeof f.className=="function"&&(f.className=f.className(e)),f["aria-labelledby"]&&f["aria-labelledby"]===f.id&&(f["aria-labelledby"]=void 0);let g={};if(e){let x=!1,b=[];for(let[v,w]of Object.entries(e))typeof w=="boolean"&&(x=!0),w===!0&&b.push(v.replace(/([A-Z])/g,S=>`-${S.toLowerCase()}`));if(x){g["data-headlessui-state"]=b.join(" ");for(let v of b)g[`data-${v}`]=""}}if(kd(o)&&(Object.keys(Oo(f)).length>0||Object.keys(Oo(g)).length>0))if(!y.isValidElement(m)||Array.isArray(m)&&m.length>1||Y3(m)){if(Object.keys(Oo(f)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${r} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(Oo(f)).concat(Object.keys(Oo(g))).map(x=>`  - ${x}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(x=>`  - ${x}`).join(`
`)].join(`
`))}else{let x=m.props,b=x==null?void 0:x.className,v=typeof b=="function"?(...T)=>Tp(b(...T),f.className):Tp(b,f.className),w=v?{className:v}:{},S=UN(m.props,Oo(gg(f,["ref"])));for(let T in g)T in S&&delete g[T];return y.cloneElement(m,Object.assign({},S,g,u,{ref:n(K3(m),u.ref)},w))}return y.createElement(o,Object.assign({},gg(f,["ref"]),!kd(o)&&u,!kd(o)&&g),m)}function z3(){let a=y.useRef([]),e=y.useCallback(s=>{for(let r of a.current)r!=null&&(typeof r=="function"?r(s):r.current=s)},[]);return(...s)=>{if(!s.every(r=>r==null))return a.current=s,e}}function q3(...a){return a.every(e=>e==null)?void 0:e=>{for(let s of a)s!=null&&(typeof s=="function"?s(e):s.current=e)}}function UN(...a){if(a.length===0)return{};if(a.length===1)return a[0];let e={},s={};for(let r of a)for(let n in r)n.startsWith("on")&&typeof r[n]=="function"?(s[n]!=null||(s[n]=[]),s[n].push(r[n])):e[n]=r[n];if(e.disabled||e["aria-disabled"])for(let r in s)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(r)&&(s[r]=[n=>{var o;return(o=n==null?void 0:n.preventDefault)==null?void 0:o.call(n)}]);for(let r in s)Object.assign(e,{[r](n,...o){let c=s[r];for(let d of c){if((n instanceof Event||(n==null?void 0:n.nativeEvent)instanceof Event)&&n.defaultPrevented)return;d(n,...o)}}});return e}function da(a){var e;return Object.assign(y.forwardRef(a),{displayName:(e=a.displayName)!=null?e:a.name})}function Oo(a){let e=Object.assign({},a);for(let s in e)e[s]===void 0&&delete e[s];return e}function gg(a,e=[]){let s=Object.assign({},a);for(let r of e)r in s&&delete s[r];return s}function K3(a){return lt.version.split(".")[0]>="19"?a.props.ref:a.ref}function kd(a){return a===y.Fragment||a===Symbol.for("react.fragment")}function Y3(a){return kd(a.type)}let W3="span";var wf=(a=>(a[a.None=1]="None",a[a.Focusable=2]="Focusable",a[a.Hidden=4]="Hidden",a))(wf||{});function Q3(a,e){var s;let{features:r=1,...n}=a,o={ref:e,"aria-hidden":(r&2)===2?!0:(s=n["aria-hidden"])!=null?s:void 0,hidden:(r&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(r&4)===4&&(r&2)!==2&&{display:"none"}}};return za()({ourProps:o,theirProps:n,slot:{},defaultTag:W3,name:"Hidden"})}let Ap=da(Q3);function X3(a){return typeof a!="object"||a===null?!1:"nodeType"in a}function oo(a){return X3(a)&&"tagName"in a}function il(a){return oo(a)&&"accessKey"in a}function so(a){return oo(a)&&"tabIndex"in a}function Z3(a){return oo(a)&&"style"in a}function J3(a){return il(a)&&a.nodeName==="IFRAME"}function eL(a){return il(a)&&a.nodeName==="INPUT"}let $N=Symbol();function tL(a,e=!0){return Object.assign(a,{[$N]:e})}function kn(...a){let e=y.useRef(a);y.useEffect(()=>{e.current=a},[a]);let s=Vs(r=>{for(let n of e.current)n!=null&&(typeof n=="function"?n(r):n.current=r)});return a.every(r=>r==null||(r==null?void 0:r[$N]))?void 0:s}let Sx=y.createContext(null);Sx.displayName="DescriptionContext";function GN(){let a=y.useContext(Sx);if(a===null){let e=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,GN),e}return a}function sL(){let[a,e]=y.useState([]);return[a.length>0?a.join(" "):void 0,y.useMemo(()=>function(s){let r=Vs(o=>(e(c=>[...c,o]),()=>e(c=>{let d=c.slice(),f=d.indexOf(o);return f!==-1&&d.splice(f,1),d}))),n=y.useMemo(()=>({register:r,slot:s.slot,name:s.name,props:s.props,value:s.value}),[r,s.slot,s.name,s.props,s.value]);return lt.createElement(Sx.Provider,{value:n},s.children)},[e])]}let rL="p";function aL(a,e){let s=y.useId(),r=H3(),{id:n=`headlessui-description-${s}`,...o}=a,c=GN(),d=kn(e);la(()=>c.register(n),[n,c.register]);let f=ou({...c.slot,disabled:r||!1}),u={ref:d,...c.props,id:n};return za()({ourProps:u,theirProps:o,slot:f,defaultTag:rL,name:c.name||"Description"})}let nL=da(aL),iL=Object.assign(nL,{});var HN=(a=>(a.Space=" ",a.Enter="Enter",a.Escape="Escape",a.Backspace="Backspace",a.Delete="Delete",a.ArrowLeft="ArrowLeft",a.ArrowUp="ArrowUp",a.ArrowRight="ArrowRight",a.ArrowDown="ArrowDown",a.Home="Home",a.End="End",a.PageUp="PageUp",a.PageDown="PageDown",a.Tab="Tab",a))(HN||{});let oL=y.createContext(()=>{});function lL({value:a,children:e}){return lt.createElement(oL.Provider,{value:a},e)}let VN=class extends Map{constructor(e){super(),this.factory=e}get(e){let s=super.get(e);return s===void 0&&(s=this.factory(e),this.set(e,s)),s}};var cL=Object.defineProperty,dL=(a,e,s)=>e in a?cL(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s,uL=(a,e,s)=>(dL(a,e+"",s),s),zN=(a,e,s)=>{if(!e.has(a))throw TypeError("Cannot "+s)},Fa=(a,e,s)=>(zN(a,e,"read from private field"),s?s.call(a):e.get(a)),pg=(a,e,s)=>{if(e.has(a))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(a):e.set(a,s)},TS=(a,e,s,r)=>(zN(a,e,"write to private field"),e.set(a,s),s),xn,Nd,jd;let hL=class{constructor(e){pg(this,xn,{}),pg(this,Nd,new VN(()=>new Set)),pg(this,jd,new Set),uL(this,"disposables",gi()),TS(this,xn,e),Tn.isServer&&this.disposables.microTask(()=>{this.dispose()})}dispose(){this.disposables.dispose()}get state(){return Fa(this,xn)}subscribe(e,s){if(Tn.isServer)return()=>{};let r={selector:e,callback:s,current:e(Fa(this,xn))};return Fa(this,jd).add(r),this.disposables.add(()=>{Fa(this,jd).delete(r)})}on(e,s){return Tn.isServer?()=>{}:(Fa(this,Nd).get(e).add(s),this.disposables.add(()=>{Fa(this,Nd).get(e).delete(s)}))}send(e){let s=this.reduce(Fa(this,xn),e);if(s!==Fa(this,xn)){TS(this,xn,s);for(let r of Fa(this,jd)){let n=r.selector(Fa(this,xn));qN(r.current,n)||(r.current=n,r.callback(n))}for(let r of Fa(this,Nd).get(e.type))r(Fa(this,xn),e)}}};xn=new WeakMap,Nd=new WeakMap,jd=new WeakMap;function qN(a,e){return Object.is(a,e)?!0:typeof a!="object"||a===null||typeof e!="object"||e===null?!1:Array.isArray(a)&&Array.isArray(e)?a.length!==e.length?!1:xg(a[Symbol.iterator](),e[Symbol.iterator]()):a instanceof Map&&e instanceof Map||a instanceof Set&&e instanceof Set?a.size!==e.size?!1:xg(a.entries(),e.entries()):AS(a)&&AS(e)?xg(Object.entries(a)[Symbol.iterator](),Object.entries(e)[Symbol.iterator]()):!1}function xg(a,e){do{let s=a.next(),r=e.next();if(s.done&&r.done)return!0;if(s.done||r.done||!Object.is(s.value,r.value))return!1}while(!0)}function AS(a){if(Object.prototype.toString.call(a)!=="[object Object]")return!1;let e=Object.getPrototypeOf(a);return e===null||Object.getPrototypeOf(e)===null}var fL=Object.defineProperty,mL=(a,e,s)=>e in a?fL(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s,CS=(a,e,s)=>(mL(a,typeof e!="symbol"?e+"":e,s),s),gL=(a=>(a[a.Push=0]="Push",a[a.Pop=1]="Pop",a))(gL||{});let pL={0(a,e){let s=e.id,r=a.stack,n=a.stack.indexOf(s);if(n!==-1){let o=a.stack.slice();return o.splice(n,1),o.push(s),r=o,{...a,stack:r}}return{...a,stack:[...a.stack,s]}},1(a,e){let s=e.id,r=a.stack.indexOf(s);if(r===-1)return a;let n=a.stack.slice();return n.splice(r,1),{...a,stack:n}}},xL=class KN extends hL{constructor(){super(...arguments),CS(this,"actions",{push:e=>this.send({type:0,id:e}),pop:e=>this.send({type:1,id:e})}),CS(this,"selectors",{isTop:(e,s)=>e.stack[e.stack.length-1]===s,inStack:(e,s)=>e.stack.includes(s)})}static new(){return new KN({stack:[]})}reduce(e,s){return mi(s.type,pL,e,s)}};const YN=new VN(()=>xL.new());var yg={exports:{}},bg={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kS;function yL(){if(kS)return bg;kS=1;var a=If();function e(f,u){return f===u&&(f!==0||1/f===1/u)||f!==f&&u!==u}var s=typeof Object.is=="function"?Object.is:e,r=a.useSyncExternalStore,n=a.useRef,o=a.useEffect,c=a.useMemo,d=a.useDebugValue;return bg.useSyncExternalStoreWithSelector=function(f,u,m,g,x){var b=n(null);if(b.current===null){var v={hasValue:!1,value:null};b.current=v}else v=b.current;b=c(function(){function S(K){if(!T){if(T=!0,k=K,K=g(K),x!==void 0&&v.hasValue){var z=v.value;if(x(z,K))return E=z}return E=K}if(z=E,s(k,K))return z;var D=g(K);return x!==void 0&&x(z,D)?(k=K,z):(k=K,E=D)}var T=!1,k,E,R=m===void 0?null:m;return[function(){return S(u())},R===null?void 0:function(){return S(R())}]},[u,m,g,x]);var w=r(f,b[0],b[1]);return o(function(){v.hasValue=!0,v.value=w},[w]),d(w),w},bg}var RS;function bL(){return RS||(RS=1,yg.exports=yL()),yg.exports}var vL=bL();function WN(a,e,s=qN){return vL.useSyncExternalStoreWithSelector(Vs(r=>a.subscribe(wL,r)),Vs(()=>a.state),Vs(()=>a.state),Vs(e),s)}function wL(a){return a}function lu(a,e){let s=y.useId(),r=YN.get(e),[n,o]=WN(r,y.useCallback(c=>[r.selectors.isTop(c,s),r.selectors.inStack(c,s)],[r,s]));return la(()=>{if(a)return r.actions.push(s),()=>r.actions.pop(s)},[r,a,s]),a?o?n:!0:!1}let Cp=new Map,Rd=new Map;function LS(a){var e;let s=(e=Rd.get(a))!=null?e:0;return Rd.set(a,s+1),s!==0?()=>DS(a):(Cp.set(a,{"aria-hidden":a.getAttribute("aria-hidden"),inert:a.inert}),a.setAttribute("aria-hidden","true"),a.inert=!0,()=>DS(a))}function DS(a){var e;let s=(e=Rd.get(a))!=null?e:1;if(s===1?Rd.delete(a):Rd.set(a,s-1),s!==1)return;let r=Cp.get(a);r&&(r["aria-hidden"]===null?a.removeAttribute("aria-hidden"):a.setAttribute("aria-hidden",r["aria-hidden"]),a.inert=r.inert,Cp.delete(a))}function SL(a,{allowed:e,disallowed:s}={}){let r=lu(a,"inert-others");la(()=>{var n,o;if(!r)return;let c=gi();for(let f of(n=s==null?void 0:s())!=null?n:[])f&&c.add(LS(f));let d=(o=e==null?void 0:e())!=null?o:[];for(let f of d){if(!f)continue;let u=iu(f);if(!u)continue;let m=f.parentElement;for(;m&&m!==u.body;){for(let g of m.children)d.some(x=>g.contains(x))||c.add(LS(g));m=m.parentElement}}return c.dispose},[r,e,s])}function _L(a,e,s){let r=ll(n=>{let o=n.getBoundingClientRect();o.x===0&&o.y===0&&o.width===0&&o.height===0&&s()});y.useEffect(()=>{if(!a)return;let n=e===null?null:il(e)?e:e.current;if(!n)return;let o=gi();if(typeof ResizeObserver<"u"){let c=new ResizeObserver(()=>r.current(n));c.observe(n),o.add(()=>c.disconnect())}if(typeof IntersectionObserver<"u"){let c=new IntersectionObserver(()=>r.current(n));c.observe(n),o.add(()=>c.disconnect())}return()=>o.dispose()},[e,r,a])}let Sf=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","details>summary","textarea:not([disabled])"].map(a=>`${a}:not([tabindex='-1'])`).join(","),NL=["[data-autofocus]"].map(a=>`${a}:not([tabindex='-1'])`).join(",");var oi=(a=>(a[a.First=1]="First",a[a.Previous=2]="Previous",a[a.Next=4]="Next",a[a.Last=8]="Last",a[a.WrapAround=16]="WrapAround",a[a.NoScroll=32]="NoScroll",a[a.AutoFocus=64]="AutoFocus",a))(oi||{}),kp=(a=>(a[a.Error=0]="Error",a[a.Overflow=1]="Overflow",a[a.Success=2]="Success",a[a.Underflow=3]="Underflow",a))(kp||{}),jL=(a=>(a[a.Previous=-1]="Previous",a[a.Next=1]="Next",a))(jL||{});function EL(a=document.body){return a==null?[]:Array.from(a.querySelectorAll(Sf)).sort((e,s)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(s.tabIndex||Number.MAX_SAFE_INTEGER)))}function TL(a=document.body){return a==null?[]:Array.from(a.querySelectorAll(NL)).sort((e,s)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(s.tabIndex||Number.MAX_SAFE_INTEGER)))}var QN=(a=>(a[a.Strict=0]="Strict",a[a.Loose=1]="Loose",a))(QN||{});function AL(a,e=0){var s;return a===((s=iu(a))==null?void 0:s.body)?!1:mi(e,{0(){return a.matches(Sf)},1(){let r=a;for(;r!==null;){if(r.matches(Sf))return!0;r=r.parentElement}return!1}})}var CL=(a=>(a[a.Keyboard=0]="Keyboard",a[a.Mouse=1]="Mouse",a))(CL||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",a=>{a.metaKey||a.altKey||a.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",a=>{a.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:a.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function ui(a){a==null||a.focus({preventScroll:!0})}let kL=["textarea","input"].join(",");function RL(a){var e,s;return(s=(e=a==null?void 0:a.matches)==null?void 0:e.call(a,kL))!=null?s:!1}function LL(a,e=s=>s){return a.slice().sort((s,r)=>{let n=e(s),o=e(r);if(n===null||o===null)return 0;let c=n.compareDocumentPosition(o);return c&Node.DOCUMENT_POSITION_FOLLOWING?-1:c&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function Ld(a,e,{sorted:s=!0,relativeTo:r=null,skipElements:n=[]}={}){let o=Array.isArray(a)?a.length>0?Ep(a[0]):document:Ep(a),c=Array.isArray(a)?s?LL(a):a:e&64?TL(a):EL(a);n.length>0&&c.length>1&&(c=c.filter(b=>!n.some(v=>v!=null&&"current"in v?(v==null?void 0:v.current)===b:v===b))),r=r??(o==null?void 0:o.activeElement);let d=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),f=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,c.indexOf(r))-1;if(e&4)return Math.max(0,c.indexOf(r))+1;if(e&8)return c.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=e&32?{preventScroll:!0}:{},m=0,g=c.length,x;do{if(m>=g||m+g<=0)return 0;let b=f+m;if(e&16)b=(b+g)%g;else{if(b<0)return 3;if(b>=g)return 1}x=c[b],x==null||x.focus(u),m+=d}while(x!==BN(x));return e&6&&RL(x)&&x.select(),2}function XN(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function DL(){return/Android/gi.test(window.navigator.userAgent)}function IS(){return XN()||DL()}function Eh(a,e,s,r){let n=ll(s);y.useEffect(()=>{if(!a)return;function o(c){n.current(c)}return document.addEventListener(e,o,r),()=>document.removeEventListener(e,o,r)},[a,e,r])}function ZN(a,e,s,r){let n=ll(s);y.useEffect(()=>{if(!a)return;function o(c){n.current(c)}return window.addEventListener(e,o,r),()=>window.removeEventListener(e,o,r)},[a,e,r])}const MS=30;function IL(a,e,s){let r=ll(s),n=y.useCallback(function(d,f){if(d.defaultPrevented)return;let u=f(d);if(u===null||!u.getRootNode().contains(u)||!u.isConnected)return;let m=(function g(x){return typeof x=="function"?g(x()):Array.isArray(x)||x instanceof Set?x:[x]})(e);for(let g of m)if(g!==null&&(g.contains(u)||d.composed&&d.composedPath().includes(g)))return;return!AL(u,QN.Loose)&&u.tabIndex!==-1&&d.preventDefault(),r.current(d,u)},[r,e]),o=y.useRef(null);Eh(a,"pointerdown",d=>{var f,u;IS()||(o.current=((u=(f=d.composedPath)==null?void 0:f.call(d))==null?void 0:u[0])||d.target)},!0),Eh(a,"pointerup",d=>{if(IS()||!o.current)return;let f=o.current;return o.current=null,n(d,()=>f)},!0);let c=y.useRef({x:0,y:0});Eh(a,"touchstart",d=>{c.current.x=d.touches[0].clientX,c.current.y=d.touches[0].clientY},!0),Eh(a,"touchend",d=>{let f={x:d.changedTouches[0].clientX,y:d.changedTouches[0].clientY};if(!(Math.abs(f.x-c.current.x)>=MS||Math.abs(f.y-c.current.y)>=MS))return n(d,()=>so(d.target)?d.target:null)},!0),ZN(a,"blur",d=>n(d,()=>J3(window.document.activeElement)?window.document.activeElement:null),!0)}function _x(...a){return y.useMemo(()=>iu(...a),[...a])}function JN(a,e,s,r){let n=ll(s);y.useEffect(()=>{a=a??window;function o(c){n.current(c)}return a.addEventListener(e,o,r),()=>a.removeEventListener(e,o,r)},[a,e,r])}function ML(a){return y.useSyncExternalStore(a.subscribe,a.getSnapshot,a.getSnapshot)}function PL(a,e){let s=a(),r=new Set;return{getSnapshot(){return s},subscribe(n){return r.add(n),()=>r.delete(n)},dispatch(n,...o){let c=e[n].call(s,...o);c&&(s=c,r.forEach(d=>d()))}}}function OL(){let a;return{before({doc:e}){var s;let r=e.documentElement,n=(s=e.defaultView)!=null?s:window;a=Math.max(0,n.innerWidth-r.clientWidth)},after({doc:e,d:s}){let r=e.documentElement,n=Math.max(0,r.clientWidth-r.offsetWidth),o=Math.max(0,a-n);s.style(r,"paddingRight",`${o}px`)}}}function FL(){return XN()?{before({doc:a,d:e,meta:s}){function r(n){for(let o of s().containers)for(let c of o())if(c.contains(n))return!0;return!1}e.microTask(()=>{var n;if(window.getComputedStyle(a.documentElement).scrollBehavior!=="auto"){let d=gi();d.style(a.documentElement,"scrollBehavior","auto"),e.add(()=>e.microTask(()=>d.dispose()))}let o=(n=window.scrollY)!=null?n:window.pageYOffset,c=null;e.addEventListener(a,"click",d=>{if(so(d.target))try{let f=d.target.closest("a");if(!f)return;let{hash:u}=new URL(f.href),m=a.querySelector(u);so(m)&&!r(m)&&(c=m)}catch{}},!0),e.group(d=>{e.addEventListener(a,"touchstart",f=>{if(d.dispose(),so(f.target)&&Z3(f.target))if(r(f.target)){let u=f.target;for(;u.parentElement&&r(u.parentElement);)u=u.parentElement;d.style(u,"overscrollBehavior","contain")}else d.style(f.target,"touchAction","none")})}),e.addEventListener(a,"touchmove",d=>{if(so(d.target)){if(eL(d.target))return;if(r(d.target)){let f=d.target;for(;f.parentElement&&f.dataset.headlessuiPortal!==""&&!(f.scrollHeight>f.clientHeight||f.scrollWidth>f.clientWidth);)f=f.parentElement;f.dataset.headlessuiPortal===""&&d.preventDefault()}else d.preventDefault()}},{passive:!1}),e.add(()=>{var d;let f=(d=window.scrollY)!=null?d:window.pageYOffset;o!==f&&window.scrollTo(0,o),c&&c.isConnected&&(c.scrollIntoView({block:"nearest"}),c=null)})})}}:{}}function BL(){return{before({doc:a,d:e}){e.style(a.documentElement,"overflow","hidden")}}}function PS(a){let e={};for(let s of a)Object.assign(e,s(e));return e}let Ho=PL(()=>new Map,{PUSH(a,e){var s;let r=(s=this.get(a))!=null?s:{doc:a,count:0,d:gi(),meta:new Set,computedMeta:{}};return r.count++,r.meta.add(e),r.computedMeta=PS(r.meta),this.set(a,r),this},POP(a,e){let s=this.get(a);return s&&(s.count--,s.meta.delete(e),s.computedMeta=PS(s.meta)),this},SCROLL_PREVENT(a){let e={doc:a.doc,d:a.d,meta(){return a.computedMeta}},s=[FL(),OL(),BL()];s.forEach(({before:r})=>r==null?void 0:r(e)),s.forEach(({after:r})=>r==null?void 0:r(e))},SCROLL_ALLOW({d:a}){a.dispose()},TEARDOWN({doc:a}){this.delete(a)}});Ho.subscribe(()=>{let a=Ho.getSnapshot(),e=new Map;for(let[s]of a)e.set(s,s.documentElement.style.overflow);for(let s of a.values()){let r=e.get(s.doc)==="hidden",n=s.count!==0;(n&&!r||!n&&r)&&Ho.dispatch(s.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",s),s.count===0&&Ho.dispatch("TEARDOWN",s)}});function UL(a,e,s=()=>({containers:[]})){let r=ML(Ho),n=e?r.get(e):void 0,o=n?n.count>0:!1;return la(()=>{if(!(!e||!a))return Ho.dispatch("PUSH",e,s),()=>Ho.dispatch("POP",e,s)},[a,e]),o}function $L(a,e,s=()=>[document.body]){let r=lu(a,"scroll-lock");UL(r,e,n=>{var o;return{containers:[...(o=n.containers)!=null?o:[],s]}})}function GL(a=0){let[e,s]=y.useState(a),r=y.useCallback(f=>s(f),[]),n=y.useCallback(f=>s(u=>u|f),[]),o=y.useCallback(f=>(e&f)===f,[e]),c=y.useCallback(f=>s(u=>u&~f),[]),d=y.useCallback(f=>s(u=>u^f),[]);return{flags:e,setFlag:r,addFlag:n,hasFlag:o,removeFlag:c,toggleFlag:d}}var HL={},OS,FS;typeof process<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&((OS=process==null?void 0:HL)==null?void 0:OS.NODE_ENV)==="test"&&typeof((FS=Element==null?void 0:Element.prototype)==null?void 0:FS.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var VL=(a=>(a[a.None=0]="None",a[a.Closed=1]="Closed",a[a.Enter=2]="Enter",a[a.Leave=4]="Leave",a))(VL||{});function zL(a){let e={};for(let s in a)a[s]===!0&&(e[`data-${s}`]="");return e}function qL(a,e,s,r){let[n,o]=y.useState(s),{hasFlag:c,addFlag:d,removeFlag:f}=GL(a&&n?3:0),u=y.useRef(!1),m=y.useRef(!1),g=Vf();return la(()=>{var x;if(a){if(s&&o(!0),!e){s&&d(3);return}return(x=r==null?void 0:r.start)==null||x.call(r,s),KL(e,{inFlight:u,prepare(){m.current?m.current=!1:m.current=u.current,u.current=!0,!m.current&&(s?(d(3),f(4)):(d(4),f(2)))},run(){m.current?s?(f(3),d(4)):(f(4),d(3)):s?f(1):d(1)},done(){var b;m.current&&QL(e)||(u.current=!1,f(7),s||o(!1),(b=r==null?void 0:r.end)==null||b.call(r,s))}})}},[a,s,e,g]),a?[n,{closed:c(1),enter:c(2),leave:c(4),transition:c(2)||c(4)}]:[s,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function KL(a,{prepare:e,run:s,done:r,inFlight:n}){let o=gi();return WL(a,{prepare:e,inFlight:n}),o.nextFrame(()=>{s(),o.requestAnimationFrame(()=>{o.add(YL(a,r))})}),o.dispose}function YL(a,e){var s,r;let n=gi();if(!a)return n.dispose;let o=!1;n.add(()=>{o=!0});let c=(r=(s=a.getAnimations)==null?void 0:s.call(a).filter(d=>d instanceof CSSTransition))!=null?r:[];return c.length===0?(e(),n.dispose):(Promise.allSettled(c.map(d=>d.finished)).then(()=>{o||e()}),n.dispose)}function WL(a,{inFlight:e,prepare:s}){if(e!=null&&e.current){s();return}let r=a.style.transition;a.style.transition="none",s(),a.offsetHeight,a.style.transition=r}function QL(a){var e,s;return((s=(e=a.getAnimations)==null?void 0:e.call(a))!=null?s:[]).some(r=>r instanceof CSSTransition&&r.playState!=="finished")}function Nx(a,e){let s=y.useRef([]),r=Vs(a);y.useEffect(()=>{let n=[...s.current];for(let[o,c]of e.entries())if(s.current[o]!==c){let d=r(e,n);return s.current=e,d}},[r,...e])}let zf=y.createContext(null);zf.displayName="OpenClosedContext";var rn=(a=>(a[a.Open=1]="Open",a[a.Closed=2]="Closed",a[a.Closing=4]="Closing",a[a.Opening=8]="Opening",a))(rn||{});function qf(){return y.useContext(zf)}function XL({value:a,children:e}){return lt.createElement(zf.Provider,{value:a},e)}function ZL({children:a}){return lt.createElement(zf.Provider,{value:null},a)}function JL(a){function e(){document.readyState!=="loading"&&(a(),document.removeEventListener("DOMContentLoaded",e))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",e),e())}let zi=[];JL(()=>{function a(e){if(!so(e.target)||e.target===document.body||zi[0]===e.target)return;let s=e.target;s=s.closest(Sf),zi.unshift(s??e.target),zi=zi.filter(r=>r!=null&&r.isConnected),zi.splice(10)}window.addEventListener("click",a,{capture:!0}),window.addEventListener("mousedown",a,{capture:!0}),window.addEventListener("focus",a,{capture:!0}),document.body.addEventListener("click",a,{capture:!0}),document.body.addEventListener("mousedown",a,{capture:!0}),document.body.addEventListener("focus",a,{capture:!0})});function ej(a){let e=Vs(a),s=y.useRef(!1);y.useEffect(()=>(s.current=!1,()=>{s.current=!0,Hf(()=>{s.current&&e()})}),[e])}let tj=y.createContext(!1);function eD(){return y.useContext(tj)}function BS(a){return lt.createElement(tj.Provider,{value:a.force},a.children)}function tD(a){let e=eD(),s=y.useContext(rj),[r,n]=y.useState(()=>{var o;if(!e&&s!==null)return(o=s.current)!=null?o:null;if(Tn.isServer)return null;let c=a==null?void 0:a.getElementById("headlessui-portal-root");if(c)return c;if(a===null)return null;let d=a.createElement("div");return d.setAttribute("id","headlessui-portal-root"),a.body.appendChild(d)});return y.useEffect(()=>{r!==null&&(a!=null&&a.body.contains(r)||a==null||a.body.appendChild(r))},[r,a]),y.useEffect(()=>{e||s!==null&&n(s.current)},[s,n,e]),r}let sj=y.Fragment,sD=da(function(a,e){let{ownerDocument:s=null,...r}=a,n=y.useRef(null),o=kn(tL(x=>{n.current=x}),e),c=_x(n.current),d=s??c,f=tD(d),u=y.useContext(Rp),m=Vf(),g=za();return ej(()=>{var x;f&&f.childNodes.length<=0&&((x=f.parentElement)==null||x.removeChild(f))}),f?fx.createPortal(lt.createElement("div",{"data-headlessui-portal":"",ref:x=>{m.dispose(),u&&x&&m.add(u.register(x))}},g({ourProps:{ref:o},theirProps:r,slot:{},defaultTag:sj,name:"Portal"})),f):null});function rD(a,e){let s=kn(e),{enabled:r=!0,ownerDocument:n,...o}=a,c=za();return r?lt.createElement(sD,{...o,ownerDocument:n,ref:s}):c({ourProps:{ref:s},theirProps:o,slot:{},defaultTag:sj,name:"Portal"})}let aD=y.Fragment,rj=y.createContext(null);function nD(a,e){let{target:s,...r}=a,n={ref:kn(e)},o=za();return lt.createElement(rj.Provider,{value:s},o({ourProps:n,theirProps:r,defaultTag:aD,name:"Popover.Group"}))}let Rp=y.createContext(null);function iD(){let a=y.useContext(Rp),e=y.useRef([]),s=Vs(o=>(e.current.push(o),a&&a.register(o),()=>r(o))),r=Vs(o=>{let c=e.current.indexOf(o);c!==-1&&e.current.splice(c,1),a&&a.unregister(o)}),n=y.useMemo(()=>({register:s,unregister:r,portals:e}),[s,r,e]);return[e,y.useMemo(()=>function({children:o}){return lt.createElement(Rp.Provider,{value:n},o)},[n])]}let oD=da(rD),aj=da(nD),lD=Object.assign(oD,{Group:aj});function cD(a,e=typeof document<"u"?document.defaultView:null,s){let r=lu(a,"escape");JN(e,"keydown",n=>{r&&(n.defaultPrevented||n.key===HN.Escape&&s(n))})}function dD(){var a;let[e]=y.useState(()=>typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(pointer: coarse)"):null),[s,r]=y.useState((a=e==null?void 0:e.matches)!=null?a:!1);return la(()=>{if(!e)return;function n(o){r(o.matches)}return e.addEventListener("change",n),()=>e.removeEventListener("change",n)},[e]),s}function uD({defaultContainers:a=[],portals:e,mainTreeNode:s}={}){let r=Vs(()=>{var n,o;let c=iu(s),d=[];for(let f of a)f!==null&&(oo(f)?d.push(f):"current"in f&&oo(f.current)&&d.push(f.current));if(e!=null&&e.current)for(let f of e.current)d.push(f);for(let f of(n=c==null?void 0:c.querySelectorAll("html > *, body > *"))!=null?n:[])f!==document.body&&f!==document.head&&oo(f)&&f.id!=="headlessui-portal-root"&&(s&&(f.contains(s)||f.contains((o=s==null?void 0:s.getRootNode())==null?void 0:o.host))||d.some(u=>f.contains(u))||d.push(f));return d});return{resolveContainers:r,contains:Vs(n=>r().some(o=>o.contains(n)))}}let nj=y.createContext(null);function US({children:a,node:e}){let[s,r]=y.useState(null),n=ij(e??s);return lt.createElement(nj.Provider,{value:n},a,n===null&&lt.createElement(Ap,{features:wf.Hidden,ref:o=>{var c,d;if(o){for(let f of(d=(c=iu(o))==null?void 0:c.querySelectorAll("html > *, body > *"))!=null?d:[])if(f!==document.body&&f!==document.head&&oo(f)&&f!=null&&f.contains(o)){r(f);break}}}}))}function ij(a=null){var e;return(e=y.useContext(nj))!=null?e:a}function hD(){let a=typeof document>"u";return"useSyncExternalStore"in Iw?(e=>e.useSyncExternalStore)(Iw)(()=>()=>{},()=>!1,()=>!a):!1}function Kf(){let a=hD(),[e,s]=y.useState(Tn.isHandoffComplete);return e&&Tn.isHandoffComplete===!1&&s(!1),y.useEffect(()=>{e!==!0&&s(!0)},[e]),y.useEffect(()=>Tn.handoff(),[]),a?!1:e}function jx(){let a=y.useRef(!1);return la(()=>(a.current=!0,()=>{a.current=!1}),[]),a}var Ed=(a=>(a[a.Forwards=0]="Forwards",a[a.Backwards=1]="Backwards",a))(Ed||{});function fD(){let a=y.useRef(0);return ZN(!0,"keydown",e=>{e.key==="Tab"&&(a.current=e.shiftKey?1:0)},!0),a}function oj(a){if(!a)return new Set;if(typeof a=="function")return new Set(a());let e=new Set;for(let s of a.current)oo(s.current)&&e.add(s.current);return e}let mD="div";var Uo=(a=>(a[a.None=0]="None",a[a.InitialFocus=1]="InitialFocus",a[a.TabLock=2]="TabLock",a[a.FocusLock=4]="FocusLock",a[a.RestoreFocus=8]="RestoreFocus",a[a.AutoFocus=16]="AutoFocus",a))(Uo||{});function gD(a,e){let s=y.useRef(null),r=kn(s,e),{initialFocus:n,initialFocusFallback:o,containers:c,features:d=15,...f}=a;Kf()||(d=0);let u=_x(s.current);bD(d,{ownerDocument:u});let m=vD(d,{ownerDocument:u,container:s,initialFocus:n,initialFocusFallback:o});wD(d,{ownerDocument:u,container:s,containers:c,previousActiveElement:m});let g=fD(),x=Vs(k=>{if(!il(s.current))return;let E=s.current;(R=>R())(()=>{mi(g.current,{[Ed.Forwards]:()=>{Ld(E,oi.First,{skipElements:[k.relatedTarget,o]})},[Ed.Backwards]:()=>{Ld(E,oi.Last,{skipElements:[k.relatedTarget,o]})}})})}),b=lu(!!(d&2),"focus-trap#tab-lock"),v=Vf(),w=y.useRef(!1),S={ref:r,onKeyDown(k){k.key=="Tab"&&(w.current=!0,v.requestAnimationFrame(()=>{w.current=!1}))},onBlur(k){if(!(d&4))return;let E=oj(c);il(s.current)&&E.add(s.current);let R=k.relatedTarget;so(R)&&R.dataset.headlessuiFocusGuard!=="true"&&(lj(E,R)||(w.current?Ld(s.current,mi(g.current,{[Ed.Forwards]:()=>oi.Next,[Ed.Backwards]:()=>oi.Previous})|oi.WrapAround,{relativeTo:k.target}):so(k.target)&&ui(k.target)))}},T=za();return lt.createElement(lt.Fragment,null,b&&lt.createElement(Ap,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:x,features:wf.Focusable}),T({ourProps:S,theirProps:f,defaultTag:mD,name:"FocusTrap"}),b&&lt.createElement(Ap,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:x,features:wf.Focusable}))}let pD=da(gD),xD=Object.assign(pD,{features:Uo});function yD(a=!0){let e=y.useRef(zi.slice());return Nx(([s],[r])=>{r===!0&&s===!1&&Hf(()=>{e.current.splice(0)}),r===!1&&s===!0&&(e.current=zi.slice())},[a,zi,e]),Vs(()=>{var s;return(s=e.current.find(r=>r!=null&&r.isConnected))!=null?s:null})}function bD(a,{ownerDocument:e}){let s=!!(a&8),r=yD(s);Nx(()=>{s||$3(e==null?void 0:e.body)&&ui(r())},[s]),ej(()=>{s&&ui(r())})}function vD(a,{ownerDocument:e,container:s,initialFocus:r,initialFocusFallback:n}){let o=y.useRef(null),c=lu(!!(a&1),"focus-trap#initial-focus"),d=jx();return Nx(()=>{if(a===0)return;if(!c){n!=null&&n.current&&ui(n.current);return}let f=s.current;f&&Hf(()=>{if(!d.current)return;let u=e==null?void 0:e.activeElement;if(r!=null&&r.current){if((r==null?void 0:r.current)===u){o.current=u;return}}else if(f.contains(u)){o.current=u;return}if(r!=null&&r.current)ui(r.current);else{if(a&16){if(Ld(f,oi.First|oi.AutoFocus)!==kp.Error)return}else if(Ld(f,oi.First)!==kp.Error)return;if(n!=null&&n.current&&(ui(n.current),(e==null?void 0:e.activeElement)===n.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}o.current=e==null?void 0:e.activeElement})},[n,c,a]),o}function wD(a,{ownerDocument:e,container:s,containers:r,previousActiveElement:n}){let o=jx(),c=!!(a&4);JN(e==null?void 0:e.defaultView,"focus",d=>{if(!c||!o.current)return;let f=oj(r);il(s.current)&&f.add(s.current);let u=n.current;if(!u)return;let m=d.target;il(m)?lj(f,m)?(n.current=m,ui(m)):(d.preventDefault(),d.stopPropagation(),ui(u)):ui(n.current)},!0)}function lj(a,e){for(let s of a)if(s.contains(e))return!0;return!1}function cj(a){var e;return!!(a.enter||a.enterFrom||a.enterTo||a.leave||a.leaveFrom||a.leaveTo)||!kd((e=a.as)!=null?e:uj)||lt.Children.count(a.children)===1}let Yf=y.createContext(null);Yf.displayName="TransitionContext";var SD=(a=>(a.Visible="visible",a.Hidden="hidden",a))(SD||{});function _D(){let a=y.useContext(Yf);if(a===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return a}function ND(){let a=y.useContext(Wf);if(a===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return a}let Wf=y.createContext(null);Wf.displayName="NestingContext";function Qf(a){return"children"in a?Qf(a.children):a.current.filter(({el:e})=>e.current!==null).filter(({state:e})=>e==="visible").length>0}function dj(a,e){let s=ll(a),r=y.useRef([]),n=jx(),o=Vf(),c=Vs((b,v=to.Hidden)=>{let w=r.current.findIndex(({el:S})=>S===b);w!==-1&&(mi(v,{[to.Unmount](){r.current.splice(w,1)},[to.Hidden](){r.current[w].state="hidden"}}),o.microTask(()=>{var S;!Qf(r)&&n.current&&((S=s.current)==null||S.call(s))}))}),d=Vs(b=>{let v=r.current.find(({el:w})=>w===b);return v?v.state!=="visible"&&(v.state="visible"):r.current.push({el:b,state:"visible"}),()=>c(b,to.Unmount)}),f=y.useRef([]),u=y.useRef(Promise.resolve()),m=y.useRef({enter:[],leave:[]}),g=Vs((b,v,w)=>{f.current.splice(0),e&&(e.chains.current[v]=e.chains.current[v].filter(([S])=>S!==b)),e==null||e.chains.current[v].push([b,new Promise(S=>{f.current.push(S)})]),e==null||e.chains.current[v].push([b,new Promise(S=>{Promise.all(m.current[v].map(([T,k])=>k)).then(()=>S())})]),v==="enter"?u.current=u.current.then(()=>e==null?void 0:e.wait.current).then(()=>w(v)):w(v)}),x=Vs((b,v,w)=>{Promise.all(m.current[v].splice(0).map(([S,T])=>T)).then(()=>{var S;(S=f.current.shift())==null||S()}).then(()=>w(v))});return y.useMemo(()=>({children:r,register:d,unregister:c,onStart:g,onStop:x,wait:u,chains:m}),[d,c,r,g,x,m,u])}let uj=y.Fragment,hj=vf.RenderStrategy;function jD(a,e){var s,r;let{transition:n=!0,beforeEnter:o,afterEnter:c,beforeLeave:d,afterLeave:f,enter:u,enterFrom:m,enterTo:g,entered:x,leave:b,leaveFrom:v,leaveTo:w,...S}=a,[T,k]=y.useState(null),E=y.useRef(null),R=cj(a),K=kn(...R?[E,e,k]:e===null?[]:[e]),z=(s=S.unmount)==null||s?to.Unmount:to.Hidden,{show:D,appear:O,initial:U}=_D(),[I,F]=y.useState(D?"visible":"hidden"),te=ND(),{register:le,unregister:H}=te;la(()=>le(E),[le,E]),la(()=>{if(z===to.Hidden&&E.current){if(D&&I!=="visible"){F("visible");return}return mi(I,{hidden:()=>H(E),visible:()=>le(E)})}},[I,E,le,H,D,z]);let X=Kf();la(()=>{if(R&&X&&I==="visible"&&E.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[E,I,X,R]);let q=U&&!O,ae=O&&D&&U,ce=y.useRef(!1),ee=dj(()=>{ce.current||(F("hidden"),H(E))},te),W=Vs(xe=>{ce.current=!0;let Ee=xe?"enter":"leave";ee.onStart(E,Ee,Pe=>{Pe==="enter"?o==null||o():Pe==="leave"&&(d==null||d())})}),V=Vs(xe=>{let Ee=xe?"enter":"leave";ce.current=!1,ee.onStop(E,Ee,Pe=>{Pe==="enter"?c==null||c():Pe==="leave"&&(f==null||f())}),Ee==="leave"&&!Qf(ee)&&(F("hidden"),H(E))});y.useEffect(()=>{R&&n||(W(D),V(D))},[D,R,n]);let G=!(!n||!R||!X||q),[,Z]=qL(G,T,D,{start:W,end:V}),oe=Oo({ref:K,className:((r=Tp(S.className,ae&&u,ae&&m,Z.enter&&u,Z.enter&&Z.closed&&m,Z.enter&&!Z.closed&&g,Z.leave&&b,Z.leave&&!Z.closed&&v,Z.leave&&Z.closed&&w,!Z.transition&&D&&x))==null?void 0:r.trim())||void 0,...zL(Z)}),ye=0;I==="visible"&&(ye|=rn.Open),I==="hidden"&&(ye|=rn.Closed),D&&I==="hidden"&&(ye|=rn.Opening),!D&&I==="visible"&&(ye|=rn.Closing);let je=za();return lt.createElement(Wf.Provider,{value:ee},lt.createElement(XL,{value:ye},je({ourProps:oe,theirProps:S,defaultTag:uj,features:hj,visible:I==="visible",name:"Transition.Child"})))}function ED(a,e){let{show:s,appear:r=!1,unmount:n=!0,...o}=a,c=y.useRef(null),d=cj(a),f=kn(...d?[c,e]:e===null?[]:[e]);Kf();let u=qf();if(s===void 0&&u!==null&&(s=(u&rn.Open)===rn.Open),s===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[m,g]=y.useState(s?"visible":"hidden"),x=dj(()=>{s||g("hidden")}),[b,v]=y.useState(!0),w=y.useRef([s]);la(()=>{b!==!1&&w.current[w.current.length-1]!==s&&(w.current.push(s),v(!1))},[w,s]);let S=y.useMemo(()=>({show:s,appear:r,initial:b}),[s,r,b]);la(()=>{s?g("visible"):!Qf(x)&&c.current!==null&&g("hidden")},[s,x]);let T={unmount:n},k=Vs(()=>{var K;b&&v(!1),(K=a.beforeEnter)==null||K.call(a)}),E=Vs(()=>{var K;b&&v(!1),(K=a.beforeLeave)==null||K.call(a)}),R=za();return lt.createElement(Wf.Provider,{value:x},lt.createElement(Yf.Provider,{value:S},R({ourProps:{...T,as:y.Fragment,children:lt.createElement(fj,{ref:f,...T,...o,beforeEnter:k,beforeLeave:E})},theirProps:{},defaultTag:y.Fragment,features:hj,visible:m==="visible",name:"Transition"})))}function TD(a,e){let s=y.useContext(Yf)!==null,r=qf()!==null;return lt.createElement(lt.Fragment,null,!s&&r?lt.createElement(Lp,{ref:e,...a}):lt.createElement(fj,{ref:e,...a}))}let Lp=da(ED),fj=da(jD),Ex=da(TD),Bs=Object.assign(Lp,{Child:Ex,Root:Lp});var AD=(a=>(a[a.Open=0]="Open",a[a.Closed=1]="Closed",a))(AD||{}),CD=(a=>(a[a.SetTitleId=0]="SetTitleId",a))(CD||{});let kD={0(a,e){return a.titleId===e.id?a:{...a,titleId:e.id}}},Tx=y.createContext(null);Tx.displayName="DialogContext";function Xf(a){let e=y.useContext(Tx);if(e===null){let s=new Error(`<${a} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,Xf),s}return e}function RD(a,e){return mi(e.type,kD,a,e)}let $S=da(function(a,e){let s=y.useId(),{id:r=`headlessui-dialog-${s}`,open:n,onClose:o,initialFocus:c,role:d="dialog",autoFocus:f=!0,__demoMode:u=!1,unmount:m=!1,...g}=a,x=y.useRef(!1);d=(function(){return d==="dialog"||d==="alertdialog"?d:(x.current||(x.current=!0,console.warn(`Invalid role [${d}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")})();let b=qf();n===void 0&&b!==null&&(n=(b&rn.Open)===rn.Open);let v=y.useRef(null),w=kn(v,e),S=_x(v.current),T=n?0:1,[k,E]=y.useReducer(RD,{titleId:null,descriptionId:null,panelRef:y.createRef()}),R=Vs(()=>o(!1)),K=Vs(Z=>E({type:0,id:Z})),z=Kf()?T===0:!1,[D,O]=iD(),U={get current(){var Z;return(Z=k.panelRef.current)!=null?Z:v.current}},I=ij(),{resolveContainers:F}=uD({mainTreeNode:I,portals:D,defaultContainers:[U]}),te=b!==null?(b&rn.Closing)===rn.Closing:!1;SL(u||te?!1:z,{allowed:Vs(()=>{var Z,oe;return[(oe=(Z=v.current)==null?void 0:Z.closest("[data-headlessui-portal]"))!=null?oe:null]}),disallowed:Vs(()=>{var Z;return[(Z=I==null?void 0:I.closest("body > *:not(#headlessui-portal-root)"))!=null?Z:null]})});let le=YN.get(null);la(()=>{if(z)return le.actions.push(r),()=>le.actions.pop(r)},[le,r,z]);let H=WN(le,y.useCallback(Z=>le.selectors.isTop(Z,r),[le,r]));IL(H,F,Z=>{Z.preventDefault(),R()}),cD(H,S==null?void 0:S.defaultView,Z=>{Z.preventDefault(),Z.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur(),R()}),$L(u||te?!1:z,S,F),_L(z,v,R);let[X,q]=sL(),ae=y.useMemo(()=>[{dialogState:T,close:R,setTitleId:K,unmount:m},k],[T,R,K,m,k]),ce=ou({open:T===0}),ee={ref:w,id:r,role:d,tabIndex:-1,"aria-modal":u?void 0:T===0?!0:void 0,"aria-labelledby":k.titleId,"aria-describedby":X,unmount:m},W=!dD(),V=Uo.None;z&&!u&&(V|=Uo.RestoreFocus,V|=Uo.TabLock,f&&(V|=Uo.AutoFocus),W&&(V|=Uo.InitialFocus));let G=za();return lt.createElement(ZL,null,lt.createElement(BS,{force:!0},lt.createElement(lD,null,lt.createElement(Tx.Provider,{value:ae},lt.createElement(aj,{target:v},lt.createElement(BS,{force:!1},lt.createElement(q,{slot:ce},lt.createElement(O,null,lt.createElement(xD,{initialFocus:c,initialFocusFallback:v,containers:F,features:V},lt.createElement(lL,{value:R},G({ourProps:ee,theirProps:g,slot:ce,defaultTag:LD,features:DD,visible:T===0,name:"Dialog"})))))))))))}),LD="div",DD=vf.RenderStrategy|vf.Static;function ID(a,e){let{transition:s=!1,open:r,...n}=a,o=qf(),c=a.hasOwnProperty("open")||o!==null,d=a.hasOwnProperty("onClose");if(!c&&!d)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!c)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!d)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!o&&typeof a.open!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${a.open}`);if(typeof a.onClose!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${a.onClose}`);return(r!==void 0||s)&&!n.static?lt.createElement(US,null,lt.createElement(Bs,{show:r,transition:s,unmount:n.unmount},lt.createElement($S,{ref:e,...n}))):lt.createElement(US,null,lt.createElement($S,{ref:e,open:r,...n}))}let MD="div";function PD(a,e){let s=y.useId(),{id:r=`headlessui-dialog-panel-${s}`,transition:n=!1,...o}=a,[{dialogState:c,unmount:d},f]=Xf("Dialog.Panel"),u=kn(e,f.panelRef),m=ou({open:c===0}),g=Vs(S=>{S.stopPropagation()}),x={ref:u,id:r,onClick:g},b=n?Ex:y.Fragment,v=n?{unmount:d}:{},w=za();return lt.createElement(b,{...v},w({ourProps:x,theirProps:o,slot:m,defaultTag:MD,name:"Dialog.Panel"}))}let OD="div";function FD(a,e){let{transition:s=!1,...r}=a,[{dialogState:n,unmount:o}]=Xf("Dialog.Backdrop"),c=ou({open:n===0}),d={ref:e,"aria-hidden":!0},f=s?Ex:y.Fragment,u=s?{unmount:o}:{},m=za();return lt.createElement(f,{...u},m({ourProps:d,theirProps:r,slot:c,defaultTag:OD,name:"Dialog.Backdrop"}))}let BD="h2";function UD(a,e){let s=y.useId(),{id:r=`headlessui-dialog-title-${s}`,...n}=a,[{dialogState:o,setTitleId:c}]=Xf("Dialog.Title"),d=kn(e);y.useEffect(()=>(c(r),()=>c(null)),[r,c]);let f=ou({open:o===0}),u={ref:d,id:r};return za()({ourProps:u,theirProps:n,slot:f,defaultTag:BD,name:"Dialog.Title"})}let $D=da(ID),GD=da(PD);da(FD);let HD=da(UD),Xs=Object.assign($D,{Panel:GD,Title:HD,Description:iL});function VD({isOpen:a,onClose:e,event:s,onSuccess:r}){var D,O,U,I,F,te;const[n,o]=y.useState(!0),[c,d]=y.useState(null),[f,u]=y.useState(!0),[m,g]=y.useState(!1),[x,b]=y.useState(!1),v=y.useRef(null);y.useEffect(()=>()=>{v.current&&clearTimeout(v.current)},[]);const w=s.sport||((D=s.league)==null?void 0:D.sport)||"Unknown";w==="Unknown"&&console.error(" TheSportsDB API Error - Missing sport field:",s);const S=w==="Fighting"||w==="Boxing"||w==="MMA",T=!S&&w!=="Unknown",{data:k}=Nk(),E=le=>typeof le=="string"?le:le.name,R=le=>{try{return new Date(le).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}catch{return le}},K=async()=>{var H,X,q;if(w==="Unknown"){console.error(" Sportarr-API Integration Error - Event missing sport field:",s),be.error("API Integration Error",{description:"This event is missing sport classification from TheSportsDB. This indicates an issue with the Sportarr-API integration."});return}if(c===null){be.error("Quality Profile Required",{description:"Please select a quality profile before adding this event."});return}if(!(k==null?void 0:k.some(ae=>ae.isDefault))){be.error("Default Quality Profile Required",{description:"Please set a default quality profile in Settings  Profiles before adding events."});return}g(!0);try{const ae={title:s.title,sport:w,eventDate:s.eventDate,venue:s.venue,location:s.location,monitored:n,qualityProfileId:c,externalId:s.externalId,broadcast:s.broadcast,status:s.status,season:s.season,round:s.round,leagueId:s.leagueId||((H=s.league)==null?void 0:H.id),homeTeamId:s.homeTeamId||((X=s.homeTeam)==null?void 0:X.id),awayTeamId:s.awayTeamId||((q=s.awayTeam)==null?void 0:q.id)},ce=await at.post("/events",ae);if(ce.data.alreadyAdded){be.info("Event Already Added",{description:`This event is already in your library.
Monitored: ${ce.data.monitored?"Yes":"No"}

You can change monitoring from the Leagues page.`}),e();return}be.success("Event Added Successfully",{description:`${s.title} has been added to your library.`}),r(),v.current=setTimeout(()=>{e()},100)}catch(ae){console.error("Failed to add event:",ae),be.error("Failed to Add Event",{description:ae instanceof Error?ae.message:"An unexpected error occurred. Please try again."})}finally{g(!1)}},z=new Date(s.eventDate)>new Date;return t.jsx(Bs,{appear:!0,show:a,as:y.Fragment,unmount:!0,afterLeave:()=>{document.querySelectorAll("[inert]").forEach(le=>{le.removeAttribute("inert")})},children:t.jsxs(Xs,{as:"div",className:"relative z-50",onClose:e,children:[t.jsx(Bs.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm"})}),t.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:t.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:t.jsx(Bs.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:t.jsxs(Xs.Panel,{className:"w-full max-w-4xl transform overflow-hidden rounded-2xl bg-gradient-to-br from-gray-900 to-black border border-red-900/30 text-left align-middle shadow-xl transition-all",children:[t.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-red-900/30",children:[t.jsxs(Xs.Title,{as:"h3",className:"text-2xl font-bold text-white flex items-center",children:[t.jsx(rs,{className:"w-7 h-7 text-red-600 mr-2"}),"Add Event"]}),t.jsx("button",{type:"button",className:"text-gray-400 hover:text-white transition-colors",onClick:e,children:t.jsx(qt,{className:"h-6 w-6"})})]}),t.jsx("div",{className:"p-6",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsx("div",{className:"md:col-span-1",children:t.jsxs("div",{className:"relative aspect-[2/3] bg-gray-950 rounded-lg overflow-hidden border border-red-900/30",children:[s.posterUrl?t.jsx("img",{src:s.posterUrl,alt:s.title,className:"w-full h-full object-cover"}):t.jsx("div",{className:"w-full h-full flex items-center justify-center",children:t.jsx("svg",{className:"w-24 h-24 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),z&&t.jsx("div",{className:"absolute top-2 left-2",children:t.jsx("span",{className:"px-3 py-1 bg-green-600 text-white text-sm font-semibold rounded-full",children:"UPCOMING"})})]})}),t.jsxs("div",{className:"md:col-span-2 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-2xl font-bold text-white mb-4",children:s.title}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(bf,{className:"w-5 h-5 text-red-400"}),t.jsx("span",{className:`px-3 py-1 font-semibold rounded-lg ${w==="Unknown"?"bg-yellow-900/30 text-yellow-400 border border-yellow-600":"bg-red-900/30 text-red-400"}`,children:w})]}),w==="Unknown"&&t.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-600/50 rounded-lg p-3",children:[t.jsx("p",{className:"text-yellow-400 text-sm font-semibold mb-1",children:" Sportarr-API Integration Error"}),t.jsx("p",{className:"text-yellow-300/80 text-xs",children:"This event is missing sport classification from TheSportsDB. Check Sportarr-API response or network connection."})]}),S&&s.organization&&t.jsxs("div",{className:"flex items-center text-gray-300",children:[t.jsx(Gf,{className:"w-5 h-5 mr-3 text-gray-500"}),t.jsx("span",{className:"font-semibold",children:s.organization})]}),T&&(s.league||s.leagueId)&&t.jsxs("div",{className:"flex items-center text-gray-300",children:[t.jsx(bf,{className:"w-5 h-5 mr-3 text-gray-500"}),t.jsx("span",{className:"font-semibold",children:((O=s.league)==null?void 0:O.name)||`League #${s.leagueId}`})]}),T&&(s.homeTeam||s.awayTeam)&&t.jsxs("div",{className:"pl-8 space-y-2 border-l-2 border-red-900/30",children:[s.homeTeam&&t.jsxs("div",{className:"flex items-center text-gray-300",children:[t.jsx("span",{className:"text-gray-500 text-sm mr-2",children:"Home:"}),t.jsx("span",{className:"font-semibold",children:s.homeTeam.name})]}),s.awayTeam&&t.jsxs("div",{className:"flex items-center text-gray-300",children:[t.jsx("span",{className:"text-gray-500 text-sm mr-2",children:"Away:"}),t.jsx("span",{className:"font-semibold",children:s.awayTeam.name})]})]}),(s.season||s.round)&&t.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-400",children:[s.season&&t.jsxs("span",{children:["Season: ",s.season]}),s.round&&t.jsxs("span",{children:["Round: ",s.round]})]}),t.jsxs("div",{className:"flex items-center text-gray-300",children:[t.jsx(el,{className:"w-5 h-5 mr-3 text-gray-500"}),t.jsx("span",{children:R(s.eventDate)})]}),(s.venue||s.location)&&t.jsxs("div",{className:"flex items-center text-gray-300",children:[t.jsx(PN,{className:"w-5 h-5 mr-3 text-gray-500"}),t.jsx("span",{children:s.venue&&s.location?`${s.venue}, ${s.location}`:s.venue||s.location})]}),s.broadcast&&t.jsxs("div",{className:"flex items-center text-gray-300",children:[t.jsx(io,{className:"w-5 h-5 mr-3 text-green-500"}),t.jsx("span",{className:"text-green-400 font-semibold",children:s.broadcast})]}),s.status&&t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("span",{className:"px-3 py-1 bg-gray-800 text-gray-300 text-sm rounded",children:["Status: ",s.status]})})]})]}),t.jsxs("div",{className:"space-y-4 bg-black/30 rounded-lg p-4 border border-red-900/20",children:[t.jsx("h5",{className:"text-lg font-semibold text-white mb-3",children:"Configuration"}),t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("input",{type:"checkbox",id:"monitored",checked:n,onChange:le=>o(le.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600 focus:ring-offset-gray-900"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{htmlFor:"monitored",className:"text-white font-medium cursor-pointer",children:"Monitor Event"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Search for monitored event when available"})]})]}),n&&t.jsx("div",{className:"pl-8 text-sm text-gray-400 border-l-2 border-red-900/30",children:S?"Combat sports events will be managed as complete events":"Team sports events will be managed as complete games"}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"qualityProfile",className:"block text-white font-medium mb-2",children:"Quality Profile"}),t.jsxs("select",{id:"qualityProfile",value:c??"",onChange:le=>d(le.target.value?Number(le.target.value):null),className:`w-full px-4 py-2.5 bg-gray-800 border rounded-lg focus:outline-none focus:border-red-600 focus:ring-2 focus:ring-red-600/20 transition-all ${c===null?"border-yellow-600 text-yellow-400":"border-gray-700 text-white"}`,children:[t.jsx("option",{value:"",children:"Select a Quality Profile *"}),k==null?void 0:k.map(le=>t.jsxs("option",{value:le.id,children:[le.name,le.isDefault?" (Default)":""]},le.id))]}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Select the quality settings for downloads"})]}),t.jsxs("button",{type:"button",onClick:()=>b(!x),className:"flex items-center text-red-400 hover:text-red-300 text-sm font-medium transition-colors",children:[t.jsx(As,{className:`w-4 h-4 mr-1 transition-transform ${x?"rotate-180":""}`}),x?"Hide":"Show"," Advanced Options"]}),x&&t.jsx("div",{className:"pt-2 space-y-4 border-t border-red-900/20",children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("input",{type:"checkbox",id:"searchOnAdd",checked:f,onChange:le=>u(le.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600 focus:ring-offset-gray-900"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("label",{htmlFor:"searchOnAdd",className:"text-white font-medium cursor-pointer",children:"Start search immediately"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Begin searching for this event as soon as it's added"})]})]})})]}),S&&s.fights&&s.fights.length>0&&t.jsxs("div",{className:"bg-black/30 rounded-lg p-4 border border-red-900/20",children:[t.jsxs("h5",{className:"text-white font-semibold mb-3",children:["Fight Card (",s.fights.length," ",s.fights.length===1?"fight":"fights",")"]}),t.jsxs("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:[s.fights.slice(0,8).map((le,H)=>t.jsxs("div",{className:"flex items-center justify-between text-sm p-2 bg-gray-950/50 rounded",children:[t.jsxs("span",{className:"text-white",children:[E(le.fighter1)," vs ",E(le.fighter2)]}),t.jsxs("div",{className:"flex items-center gap-2",children:[le.weightClass&&t.jsx("span",{className:"text-gray-400 text-xs",children:le.weightClass}),le.isMainEvent&&t.jsx("span",{className:"px-2 py-0.5 bg-red-600 text-white text-xs rounded-full",children:"MAIN"})]})]},H)),s.fights.length>8&&t.jsxs("p",{className:"text-gray-500 text-xs text-center pt-2",children:["+ ",s.fights.length-8," more fights"]})]})]}),T&&(s.homeTeam||s.awayTeam)&&t.jsxs("div",{className:"bg-black/30 rounded-lg p-4 border border-red-900/20",children:[t.jsx("h5",{className:"text-white font-semibold mb-3",children:"Matchup"}),t.jsxs("div",{className:"flex items-center justify-center gap-4 text-lg",children:[t.jsxs("div",{className:"flex-1 text-center",children:[t.jsx("div",{className:"font-bold text-white mb-1",children:((U=s.homeTeam)==null?void 0:U.name)||"TBD"}),((I=s.homeTeam)==null?void 0:I.shortName)&&t.jsx("div",{className:"text-sm text-gray-400",children:s.homeTeam.shortName})]}),t.jsx("div",{className:"text-2xl font-bold text-red-500",children:"VS"}),t.jsxs("div",{className:"flex-1 text-center",children:[t.jsx("div",{className:"font-bold text-white mb-1",children:((F=s.awayTeam)==null?void 0:F.name)||"TBD"}),((te=s.awayTeam)==null?void 0:te.shortName)&&t.jsx("div",{className:"text-sm text-gray-400",children:s.awayTeam.shortName})]})]})]})]})]})}),t.jsxs("div",{className:"flex items-center justify-end gap-3 px-6 py-4 border-t border-red-900/30 bg-black/30",children:[t.jsx("button",{type:"button",onClick:e,disabled:m,className:"px-6 py-2.5 bg-gray-800 hover:bg-gray-700 text-white font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),t.jsx("button",{type:"button",onClick:K,disabled:m||w==="Unknown",className:"px-6 py-2.5 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white font-semibold rounded-lg shadow-lg transform transition hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center",children:m?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Adding..."]}):t.jsxs(t.Fragment,{children:[t.jsx(rs,{className:"w-5 h-5 mr-2"}),"Add Event"]})})]})]})})})})]})})}let xd=null;async function zD(){if(xd)return xd;try{const a=await fetch("/initialize.json");if(!a.ok)throw new Error("Failed to fetch initialize data");if(xd=(await a.json()).apiKey,!xd)throw new Error("API key not found in initialize data");return xd}catch(a){throw console.error("Failed to get API key:",a),a}}async function cu(a,e={}){const s=await zD(),r=new Headers(e.headers);return r.set("X-Api-Key",s),fetch(a,{...e,headers:r,credentials:"include"})}async function kt(a){return cu(a,{method:"GET"})}async function ds(a,e){return cu(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}async function br(a,e){return cu(a,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}async function Na(a){return cu(a,{method:"DELETE"})}async function qD(a,e){return cu(a,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}function Zf(){const[a,e]=y.useState(null),[s,r]=y.useState(!0);y.useEffect(()=>{n()},[]);const n=async()=>{try{const o=await kt("/api/settings");if(o.ok){const c=await o.json();if(c.uiSettings){const f=JSON.parse(c.uiSettings).timeZone||null;e(f)}}}catch(o){console.error("Failed to load timezone settings:",o)}finally{r(!1)}};return{timezone:a,loading:s}}function Ax(a){return a?a.endsWith("Z")||/[+-]\d{2}:\d{2}$/.test(a)?new Date(a):/^\d{4}-\d{2}-\d{2}$/.test(a)?new Date(a+"T00:00:00Z"):/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}(:\d{2})?(\.\d+)?$/.test(a)?new Date(a+"Z"):new Date(a):new Date}function mj(a,e){const s=Ax(a);if(!e)return s;try{const r={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:e},o=new Intl.DateTimeFormat("en-US",r).formatToParts(s),c=b=>{var v;return((v=o.find(w=>w.type===b))==null?void 0:v.value)||"0"},d=parseInt(c("year")),f=parseInt(c("month"))-1,u=parseInt(c("day")),m=parseInt(c("hour")),g=parseInt(c("minute")),x=parseInt(c("second"));return new Date(d,f,u,m,g,x)}catch(r){return console.error("Failed to convert timezone:",r),s}}function KD(a,e){const s=mj(a,e),r=s.getFullYear(),n=String(s.getMonth()+1).padStart(2,"0"),o=String(s.getDate()).padStart(2,"0");return`${r}-${n}-${o}`}function Fo(a,e,s={hour:"2-digit",minute:"2-digit"}){const r=Ax(a);if(!e)return r.toLocaleTimeString([],s);try{return r.toLocaleTimeString([],{...s,timeZone:e})}catch(n){return console.error("Failed to format time in timezone:",n),r.toLocaleTimeString([],s)}}function ti(a,e,s={weekday:"short",month:"short",day:"numeric"}){const r=Ax(a);if(!e)return r.toLocaleDateString([],s);try{return r.toLocaleDateString([],{...s,timeZone:e})}catch(n){return console.error("Failed to format date in timezone:",n),r.toLocaleDateString([],s)}}function YD({progressPercent:a,progressStatus:e}){const s=()=>{switch(e){case"complete":return"bg-green-500";case"continuing":return"bg-blue-500";case"partial":return"bg-yellow-500";case"missing":return"bg-red-500";case"unmonitored":default:return"bg-gray-600"}},r=Math.min(100,Math.max(0,a));return t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-black/50",children:t.jsx("div",{className:`h-full transition-all duration-300 ${s()}`,style:{width:`${r}%`}})})}const Th={"American Football":"",Athletics:"","Australian Football":"",Badminton:"",Baseball:"",Basketball:"",Climbing:"",Cricket:"",Cycling:"",Darts:"",Esports:"",Equestrian:"","Extreme Sports":"","Field Hockey":"",Fighting:"",Gaelic:"",Gambling:"",Golf:"",Gymnastics:"",Handball:"","Ice Hockey":"",Lacrosse:"",Motorsport:"","Multi Sports":"",Netball:"",Rugby:"",Shooting:"",Skating:"",Skiing:"",Snooker:"",Soccer:"","Table Tennis":"",Tennis:"",Volleyball:"",Watersports:"",Weightlifting:"",Wintersports:""};function WD(){const[a,e]=y.useState(""),[s,r]=y.useState("all"),[n,o]=y.useState(!1),[c,d]=y.useState(new Set),[f,u]=y.useState(!1),[m,g]=y.useState(!1),[x,b]=y.useState(!1),[v,w]=y.useState(!1),[S,T]=y.useState(!1),[k,E]=y.useState([]),[R,K]=y.useState(!1),z=Ta(),D=ca(),{data:O,isLoading:U,error:I,refetch:F}=Cs({queryKey:["leagues"],queryFn:async()=>(await at.get("/leagues")).data,staleTime:120*1e3,refetchOnWindowFocus:!1}),te=(O==null?void 0:O.filter(Z=>{var je;const oe=s==="all"||Z.sport===s,ye=(je=Z.name)==null?void 0:je.toLowerCase().includes(a.toLowerCase());return oe&&ye}))||[],le=(O==null?void 0:O.reduce((Z,oe)=>(oe.sport&&(Z[oe.sport]=(Z[oe.sport]||0)+1),Z),{}))||{},H=y.useMemo(()=>{const Z=[{id:"all",name:"All Sports",icon:""}];return Array.from(new Set((O==null?void 0:O.map(ye=>ye.sport).filter(Boolean))||[])).forEach(ye=>{Z.push({id:ye,name:ye,icon:Th[ye]||""})}),Z},[O]),X=(Z,oe)=>{oe.stopPropagation(),d(ye=>{const je=new Set(ye);return je.has(Z)?je.delete(Z):je.add(Z),je})},q=()=>{d(new Set(te.map(Z=>Z.id)))},ae=()=>{d(new Set)},ce=()=>{o(!1),d(new Set)},ee=async()=>{if(c.size!==0){b(!0);try{await Promise.all(Array.from(c).map(Z=>at.delete(`/leagues/${Z}`,{params:{deleteFiles:m}}))),u(!1),g(!1),d(new Set),o(!1),D.invalidateQueries({queryKey:["leagues"]})}catch(Z){console.error("Failed to delete leagues:",Z)}finally{b(!1)}}},W=async()=>{if(c.size!==0){w(!0),K(!0),E([]);try{const Z=await at.post("/leagues/rename-preview",{leagueIds:Array.from(c)});E(Z.data||[])}catch(Z){console.error("Failed to load rename preview:",Z),be.error("Failed to load rename preview")}finally{K(!1)}}},V=async()=>{if(c.size!==0){T(!0);try{const Z=await at.post("/leagues/rename",{leagueIds:Array.from(c)}),{totalRenamed:oe}=Z.data;be.success("Files Renamed Successfully",{description:`${oe} file(s) have been renamed according to your naming scheme.`}),w(!1),d(new Set),o(!1),D.invalidateQueries({queryKey:["leagues"]})}catch(Z){console.error("Failed to rename files:",Z),be.error("Failed to rename files")}finally{T(!1)}}},G=y.useMemo(()=>(O==null?void 0:O.filter(Z=>c.has(Z.id)))||[],[O,c]);return U?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600"})}):I?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-red-500 text-xl mb-4",children:"Failed to load leagues"}),t.jsx("button",{onClick:()=>F(),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Retry"})]})}):t.jsxs("div",{className:"p-4 md:p-8",children:[t.jsx("div",{className:"mb-4 md:mb-6",children:t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-white mb-1 md:mb-2",children:"Leagues"}),t.jsx("p",{className:"text-sm md:text-base text-gray-400",children:"Manage your monitored leagues and competitions"})]}),t.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[n?t.jsxs("button",{onClick:ce,className:"px-3 md:px-6 py-2 md:py-3 bg-gray-700 text-white rounded-lg hover:bg-gray-600 font-semibold transition-colors flex items-center gap-1 md:gap-2 text-sm md:text-base",children:[t.jsx(qt,{className:"h-4 w-4 md:h-5 md:w-5"}),t.jsx("span",{className:"hidden sm:inline",children:"Cancel"})]}):t.jsxs("button",{onClick:()=>o(!0),className:"px-3 md:px-6 py-2 md:py-3 bg-gray-800 text-white rounded-lg hover:bg-gray-700 font-semibold transition-colors border border-red-900/30 flex items-center gap-1 md:gap-2 text-sm md:text-base",children:[t.jsx($a,{className:"h-4 w-4 md:h-5 md:w-5"}),t.jsx("span",{className:"hidden sm:inline",children:"Select"})]}),t.jsxs("button",{onClick:()=>z("/add-league/search"),className:"px-3 md:px-6 py-2 md:py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 font-semibold transition-colors text-sm md:text-base",children:[t.jsx("span",{className:"sm:hidden",children:"+ Add"}),t.jsx("span",{className:"hidden sm:inline",children:"+ Add League"})]})]})]})}),H.length>1&&t.jsx("div",{className:"mb-4 md:mb-8",children:t.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:H.map(Z=>t.jsxs("button",{onClick:()=>r(Z.id),className:`
                  flex items-center gap-1.5 md:gap-2 px-3 md:px-4 py-1.5 md:py-2 rounded-lg whitespace-nowrap font-medium transition-all text-sm md:text-base
                  ${s===Z.id?"bg-red-600 text-white":"bg-gray-900 text-gray-400 hover:bg-gray-800 hover:text-white border border-red-900/30"}
                `,children:[t.jsx("span",{className:"text-lg md:text-xl",children:Z.icon}),t.jsx("span",{className:"hidden sm:inline",children:Z.name}),Z.id!=="all"&&le[Z.id]&&t.jsx("span",{className:"ml-1 px-1.5 md:px-2 py-0.5 bg-black/30 rounded text-xs",children:le[Z.id]})]},Z.id))})}),t.jsx("div",{className:"mb-4 md:mb-8 max-w-2xl",children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 md:pl-4 flex items-center pointer-events-none",children:t.jsx(Ks,{className:"h-4 w-4 md:h-5 md:w-5 text-gray-400"})}),t.jsx("input",{type:"text",value:a,onChange:Z=>e(Z.target.value),placeholder:"Search leagues...",className:"w-full pl-10 md:pl-12 pr-4 py-2 md:py-3 bg-gray-900 border border-red-900/30 rounded-lg text-sm md:text-base text-white placeholder-gray-500 focus:outline-none focus:border-red-600 focus:ring-2 focus:ring-red-600/20 transition-all"})]})}),t.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-2 md:gap-4 mb-4 md:mb-8",children:[t.jsxs("div",{className:"bg-gray-900 border border-red-900/30 rounded-lg p-3 md:p-4",children:[t.jsx("p",{className:"text-gray-400 text-xs md:text-sm mb-1",children:"Total Leagues"}),t.jsx("p",{className:"text-xl md:text-3xl font-bold text-white",children:(O==null?void 0:O.length)||0})]}),t.jsxs("div",{className:"bg-gray-900 border border-red-900/30 rounded-lg p-3 md:p-4",children:[t.jsx("p",{className:"text-gray-400 text-xs md:text-sm mb-1",children:"Monitored"}),t.jsx("p",{className:"text-xl md:text-3xl font-bold text-white",children:(O==null?void 0:O.filter(Z=>Z.monitored).length)||0})]}),t.jsxs("div",{className:"bg-gray-900 border border-red-900/30 rounded-lg p-3 md:p-4",children:[t.jsx("p",{className:"text-gray-400 text-xs md:text-sm mb-1",children:"Total Events"}),t.jsx("p",{className:"text-xl md:text-3xl font-bold text-white",children:(O==null?void 0:O.reduce((Z,oe)=>Z+(oe.eventCount||0),0))||0})]}),t.jsxs("div",{className:"bg-gray-900 border border-red-900/30 rounded-lg p-3 md:p-4",children:[t.jsx("p",{className:"text-gray-400 text-xs md:text-sm mb-1",children:"Monitored Events"}),t.jsx("p",{className:"text-xl md:text-3xl font-bold text-white",children:(O==null?void 0:O.reduce((Z,oe)=>Z+(oe.monitoredEventCount||0),0))||0})]}),t.jsxs("div",{className:"bg-gray-900 border border-red-900/30 rounded-lg p-3 md:p-4 col-span-2 sm:col-span-1",children:[t.jsx("p",{className:"text-gray-400 text-xs md:text-sm mb-1",children:"Downloaded"}),t.jsx("p",{className:"text-xl md:text-3xl font-bold text-white",children:(O==null?void 0:O.reduce((Z,oe)=>Z+(oe.fileCount||0),0))||0})]})]}),te.length===0?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("p",{className:"text-gray-400 text-lg",children:a?"No leagues found":s==="all"?"No leagues yet":`No ${s} leagues`}),t.jsx("p",{className:"text-gray-500 text-sm mt-2",children:'Click "Add League" to start tracking sports competitions'})]}):t.jsx("div",{className:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 md:gap-6 ${n&&c.size>0?"pb-24":""}`,children:te.map(Z=>{const oe=c.has(Z.id);return t.jsxs("div",{onClick:()=>{n?d(ye=>{const je=new Set(ye);return je.has(Z.id)?je.delete(Z.id):je.add(Z.id),je}):z(`/leagues/${Z.id}`)},className:`bg-gray-900 border rounded-lg overflow-hidden hover:shadow-lg transition-all cursor-pointer group ${oe?"border-red-500 ring-2 ring-red-500/50 shadow-red-900/30":"border-red-900/30 hover:border-red-600/50 hover:shadow-red-900/20"}`,children:[t.jsxs("div",{className:"relative aspect-[16/9] bg-gray-800 overflow-hidden",children:[Z.logoUrl||Z.bannerUrl||Z.posterUrl?t.jsx("img",{src:Z.logoUrl||Z.bannerUrl||Z.posterUrl,alt:Z.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}):t.jsx("div",{className:"w-full h-full flex items-center justify-center",children:t.jsx("span",{className:"text-6xl font-bold text-gray-700",children:Z.name.charAt(0)})}),n&&t.jsx("div",{className:"absolute top-2 left-2 z-10",onClick:ye=>X(Z.id,ye),children:t.jsx("div",{className:`w-6 h-6 rounded border-2 flex items-center justify-center transition-colors ${oe?"bg-red-600 border-red-600":"bg-black/50 border-white/50 hover:border-white"}`,children:oe&&t.jsx($a,{className:"h-4 w-4 text-white"})})}),t.jsx("div",{className:`absolute top-2 ${n?"left-10":"left-2"} transition-all`,children:t.jsxs("span",{className:"px-2 py-1 bg-black/70 backdrop-blur-sm text-white text-xs font-semibold rounded",children:[Th[Z.sport]||""," ",Z.sport]})}),t.jsx("div",{className:"absolute top-2 right-2 flex flex-col gap-2 items-end",children:Z.monitored?t.jsx("span",{className:"px-2 py-1 bg-green-600/90 backdrop-blur-sm text-white text-xs font-semibold rounded",children:"Monitored"}):t.jsx("span",{className:"px-2 py-1 bg-gray-600/90 backdrop-blur-sm text-white text-xs font-semibold rounded",children:"Not Monitored"})}),t.jsx("div",{className:"absolute bottom-3 left-2",children:t.jsxs("span",{className:"px-3 py-1 bg-black/70 backdrop-blur-sm text-white text-sm font-semibold rounded",children:[Z.eventCount||0," ",(Z.eventCount||0)===1?"Event":"Events"]})}),t.jsx(YD,{progressPercent:Z.progressPercent||0,progressStatus:Z.progressStatus||"unmonitored"})]}),t.jsxs("div",{className:"p-4",children:[t.jsx("h3",{className:"text-white font-bold text-lg mb-2 truncate",children:Z.name}),Z.country&&t.jsx("p",{className:"text-gray-400 text-sm mb-3",children:Z.country}),t.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1 text-sm mb-3",children:[t.jsxs("div",{className:"flex items-center gap-1 whitespace-nowrap",children:[t.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500 flex-shrink-0"}),t.jsx("span",{className:"text-gray-400",children:"Monitored:"}),t.jsx("span",{className:"text-white font-semibold",children:Z.monitoredEventCount||0})]}),t.jsxs("div",{className:"flex items-center gap-1 whitespace-nowrap",children:[t.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500 flex-shrink-0"}),t.jsx("span",{className:"text-gray-400",children:"Have:"}),t.jsx("span",{className:"text-white font-semibold",children:Z.downloadedMonitoredCount||0})]}),(Z.missingCount||0)>0&&t.jsxs("div",{className:"flex items-center gap-1 whitespace-nowrap",children:[t.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500 flex-shrink-0"}),t.jsx("span",{className:"text-gray-400",children:"Missing:"}),t.jsx("span",{className:"text-red-400 font-semibold",children:Z.missingCount})]})]}),Z.qualityProfileId&&t.jsx("div",{className:"text-xs",children:t.jsxs("span",{className:"px-2 py-1 bg-gray-800 text-gray-300 rounded",children:["Quality Profile #",Z.qualityProfileId]})})]})]},Z.id)})}),n&&c.size>0&&t.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-gray-900 border-t border-red-900/50 shadow-lg shadow-black/50 z-50",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 md:px-8 py-3 md:py-4 flex flex-col sm:flex-row items-center justify-between gap-3",children:[t.jsxs("div",{className:"flex flex-wrap items-center justify-center sm:justify-start gap-2 md:gap-4",children:[t.jsxs("span",{className:"text-white font-semibold text-sm md:text-base",children:[c.size," ",c.size===1?"League":"Leagues"," Selected"]}),t.jsxs("button",{onClick:q,className:"text-xs md:text-sm text-gray-400 hover:text-white transition-colors",children:["Select All (",te.length,")"]}),t.jsx("button",{onClick:ae,className:"text-xs md:text-sm text-gray-400 hover:text-white transition-colors",children:"Clear"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("button",{onClick:W,className:"px-3 md:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold transition-colors flex items-center gap-2 text-sm md:text-base",children:[t.jsx(Dt,{className:"h-4 w-4 md:h-5 md:w-5"}),t.jsx("span",{className:"hidden sm:inline",children:"Rename Files"}),t.jsx("span",{className:"sm:hidden",children:"Rename"})]}),t.jsxs("button",{onClick:()=>u(!0),className:"px-3 md:px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-semibold transition-colors flex items-center gap-2 text-sm md:text-base",children:[t.jsx(cs,{className:"h-4 w-4 md:h-5 md:w-5"}),t.jsx("span",{className:"hidden sm:inline",children:"Delete Selected"}),t.jsx("span",{className:"sm:hidden",children:"Delete"})]})]})]})}),f&&t.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-gray-900 border border-red-900/50 rounded-lg p-6 max-w-lg w-full mx-4 shadow-2xl",children:[t.jsxs("h2",{className:"text-xl font-bold text-white mb-4",children:["Delete ",c.size," ",c.size===1?"League":"Leagues","?"]}),t.jsxs("p",{className:"text-gray-400 mb-4",children:["The following ",c.size===1?"league":"leagues"," and all associated events will be removed from Sportarr:"]}),t.jsx("div",{className:"bg-gray-800/50 rounded-lg p-3 mb-4 max-h-40 overflow-y-auto",children:G.map(Z=>t.jsxs("div",{className:"flex items-center gap-2 py-1 text-sm text-white",children:[t.jsx("span",{children:Th[Z.sport]||""}),t.jsx("span",{children:Z.name}),(Z.eventCount||0)>0&&t.jsxs("span",{className:"text-gray-500",children:["(",Z.eventCount," events)"]})]},Z.id))}),t.jsxs("label",{className:"flex items-start gap-3 mb-6 cursor-pointer group",children:[t.jsxs("div",{className:"relative flex items-center",children:[t.jsx("input",{type:"checkbox",checked:m,onChange:Z=>g(Z.target.checked),className:"sr-only"}),t.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${m?"bg-red-600 border-red-600":"border-gray-500 group-hover:border-gray-400"}`,children:m&&t.jsx($a,{className:"h-3 w-3 text-white"})})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Delete league folder(s)"}),t.jsx("p",{className:"text-gray-500 text-sm",children:"This will permanently delete the league folders and all files from disk."})]})]}),m&&t.jsx("div",{className:"bg-red-900/30 border border-red-600/50 rounded-lg p-3 mb-4",children:t.jsxs("p",{className:"text-red-400 text-sm",children:[t.jsx("strong",{children:"Warning:"})," This action cannot be undone. All media files in the selected league folders will be permanently deleted."]})}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{u(!1),g(!1)},disabled:x,className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 font-semibold transition-colors disabled:opacity-50",children:"Cancel"}),t.jsx("button",{onClick:ee,disabled:x,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-semibold transition-colors disabled:opacity-50 flex items-center gap-2",children:x?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Deleting..."]}):t.jsxs(t.Fragment,{children:[t.jsx(cs,{className:"h-5 w-5"}),"Delete"]})})]})]})}),v&&t.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-gray-900 border border-red-900/50 rounded-lg p-6 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] flex flex-col",children:[t.jsxs("h2",{className:"text-xl font-bold text-white mb-4",children:["Organize ",c.size," Selected ",c.size===1?"League":"Leagues"]}),t.jsx("p",{className:"text-gray-400 mb-4",children:"The following files will be renamed according to your naming settings:"}),t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3 mb-4",children:[t.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Selected Leagues:"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:G.map(Z=>t.jsxs("span",{className:"px-2 py-1 bg-gray-700 text-white text-sm rounded flex items-center gap-1",children:[t.jsx("span",{children:Th[Z.sport]||""}),t.jsx("span",{children:Z.name})]},Z.id))})]}),t.jsx("div",{className:"flex-1 overflow-y-auto mb-4",children:R?t.jsx("div",{className:"flex items-center justify-center h-32",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-600"})}):k.length>0?t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"bg-blue-900/20 border border-blue-600/50 rounded-lg p-3",children:t.jsxs("p",{className:"text-blue-400 text-sm",children:[t.jsx("strong",{children:k.length})," file",k.length!==1?"s":""," will be renamed"]})}),t.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:k.map((Z,oe)=>t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3 border border-red-900/20",children:[t.jsx("div",{className:"flex items-center gap-2 mb-2",children:t.jsx("span",{className:"text-xs text-gray-500",children:Z.leagueName})}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-400 text-xs",children:"Current:"}),t.jsx("p",{className:"text-gray-300 font-mono text-xs break-all",children:Z.existingPath})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-400 text-xs",children:"New:"}),t.jsx("p",{className:"text-green-400 font-mono text-xs break-all",children:Z.newPath})]})]})]},oe))})]}):t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-6 text-center",children:[t.jsx(Dt,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-400",children:"No files need renaming"}),t.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"All files are already using the correct naming format"})]})}),t.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-800",children:[t.jsx("button",{onClick:()=>w(!1),disabled:S,className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 font-semibold transition-colors disabled:opacity-50",children:"Cancel"}),k.length>0&&t.jsx("button",{onClick:V,disabled:S,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold transition-colors disabled:opacity-50 flex items-center gap-2",children:S?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Renaming..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Dt,{className:"h-5 w-5"}),"Organize"]})})]})]})})]})}function QD({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z",clipRule:"evenodd"}))}const yd=y.forwardRef(QD);function XD({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{fillRule:"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z",clipRule:"evenodd"}))}const Ah=y.forwardRef(XD);function ZD({title:a,titleId:e,...s},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},s),a?y.createElement("title",{id:e},a):null,y.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z",clipRule:"evenodd"}))}const vg=y.forwardRef(ZD);function wg({children:a,content:e,className:s="",preferTop:r=!1}){const[n,o]=y.useState(!1),[c,d]=y.useState({top:0,left:0,showAbove:!1}),f=y.useRef(null),u=y.useRef(null),m=y.useCallback(()=>{if(!f.current||!u.current)return;const g=f.current.getBoundingClientRect(),x=u.current.getBoundingClientRect(),b=window.innerHeight,v=window.innerWidth,w=b-g.bottom,S=g.top,T=x.height||100;let k=r;r?S<T+8&&(k=!1):w<T+8&&S>w&&(k=!0);let E;k?E=g.top-T-4:E=g.bottom+4;let R=g.right-(x.width||200);R<8&&(R=8),R+(x.width||200)>v-8&&(R=v-(x.width||200)-8),d({top:E,left:R,showAbove:k})},[r]);return y.useEffect(()=>{if(n){m();const g=()=>m();return window.addEventListener("scroll",g,!0),window.addEventListener("resize",g),()=>{window.removeEventListener("scroll",g,!0),window.removeEventListener("resize",g)}}},[n,m]),y.useEffect(()=>{if(n){const g=setTimeout(m,10);return()=>clearTimeout(g)}},[n,m]),t.jsxs(t.Fragment,{children:[t.jsx("div",{ref:f,className:"inline-flex",onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:a}),n&&fx.createPortal(t.jsx("div",{ref:u,className:`fixed z-[100] p-1.5 bg-gray-900 border border-gray-700 rounded-lg shadow-xl ${s}`,style:{top:c.top,left:c.left,opacity:c.top===0?0:1},children:e}),document.body)]})}function gj({isOpen:a,onClose:e,eventId:s,eventTitle:r,part:n,existingFiles:o}){const[c,d]=y.useState("search"),[f,u]=y.useState(!1),[m,g]=y.useState(!1),[x,b]=y.useState([]),[v,w]=y.useState(null),[S,T]=y.useState(null),[k,E]=y.useState(null),[R,K]=y.useState("score"),[z,D]=y.useState("desc"),[O,U]=y.useState(!1),[I,F]=y.useState([]),[te,le]=y.useState(!1),[H,X]=y.useState(!0),q=y.useRef(null),[ae,ce]=y.useState([]),[ee,W]=y.useState(!1),[V,G]=y.useState(null);y.useEffect(()=>{a&&(b([]),w(null),T(null),E(null),d("search"),le(!1),oe(),ye(),Z())},[a,s,n]),y.useEffect(()=>{const me=De=>{q.current&&!q.current.contains(De.target)&&le(!1)};return te&&document.addEventListener("mousedown",me),()=>{document.removeEventListener("mousedown",me)}},[te]);const Z=async()=>{u(!0),w(null);try{const me=`/api/event/${s}/search`,ue=await(await ds(me,{part:n})).json();b(ue||[])}catch(me){console.error("Search failed:",me),w("Failed to search indexers. Please try again.")}finally{u(!1)}},oe=async()=>{try{const me=o&&o.length>0,De=n?o==null?void 0:o.some(Fe=>Fe.partName===n):me;U(!!De);const ue=await kt("/api/queue");if(ue.ok){const mt=(await ue.json()).filter(Se=>Se.eventId===s);F(mt)}}catch(me){console.error("Failed to check existing files/queue:",me)}},ye=async()=>{W(!0);try{const me=n?`/api/event/${s}/history?part=${encodeURIComponent(n)}`:`/api/event/${s}/history`,De=await kt(me);if(De.ok){const ue=await De.json();ce(ue)}}catch(me){console.error("Failed to load history:",me)}finally{W(!1)}},je=me=>{if(!me)return"N/A";const De=me/(1024*1024*1024);return De>=1?`${De.toFixed(2)} GiB`:`${(me/(1024*1024)).toFixed(1)} MiB`},xe=me=>{const De=new Date,ue=new Date(me),Fe=De.getTime()-ue.getTime(),mt=Math.floor(Fe/(1e3*60*60*24));return mt===0?"Today":mt===1?"1 day":`${mt} days`},Ee=me=>new Date(me).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}),Pe=async(me=!1)=>{u(!0),w(null),b([]);try{const De=`/api/event/${s}/search`,Fe=await(await ds(De,{part:n,forceRefresh:me})).json();b(Fe||[])}catch(De){console.error("Search failed:",De),w("Failed to search indexers. Please try again.")}finally{u(!1)}},Re=async()=>{g(!0),w(null),b([]);try{const me=`/api/event/${s}/search-pack`,De=await ds(me,{});if(!De.ok){const Fe=await De.json();throw new Error(Fe.message||"Pack search failed")}const ue=await De.json();b(ue||[]),ue.length===0&&w("No week packs found. This event may not be part of a weekly schedule (e.g., NFL/NBA/NHL week).")}catch(me){console.error("Pack search failed:",me);const De=me instanceof Error?me.message:"Failed to search for week packs. Please try again.";w(De)}finally{g(!1)}},Qe=(me,De,ue=!1)=>{if(me.isBlocklisted){E({index:De,result:me});return}ot(me,De,ue)},ot=async(me,De,ue=!1)=>{E(null),T(De),w(null);try{if(ue&&I.length>0)for(const Se of I)try{await ds(`/api/queue/${Se.eventId}/remove`,{})}catch(st){console.warn("Failed to remove queue item:",st)}const Fe=await ds("/api/release/grab",{...me,eventId:s,overrideBlocklist:me.isBlocklisted,replaceExisting:ue});if(!Fe.ok){const Se=await Fe.json();throw new Error(Se.message||"Download failed")}const mt=await Fe.json();console.log("Download started:",mt),e()}catch(Fe){console.error("Download failed:",Fe);const mt=Fe instanceof Error?Fe.message:"Failed to start download. Please try again.";w(mt)}finally{T(null)}},ne=async(me,De)=>{try{const ue=De?"blocklistAndSearch":"blocklistOnly";(await Na(`/api/history/${me.id}?blocklistAction=${ue}`)).ok?(be.success("Marked as Failed",{description:De?"Release blocklisted and searching for replacement...":"Release added to blocklist."}),ye(),oe()):be.error("Failed",{description:"Could not mark release as failed."})}catch(ue){console.error("Mark as failed error:",ue),be.error("Error",{description:"Failed to mark release as failed."})}finally{G(null)}},ke=()=>n?`${r} (${n})`:r,Be=me=>{if(!me)return null;const De=me.match(/\b(2160p|1080p|720p|480p|360p)\b/i);return De?De[1].toLowerCase():null},qe=(me,De)=>{if(!me||!De)return null;const ue=me.toLowerCase().replace(/-/g,"").replace(/ /g,"");return ue.includes("web")?`WEB ${De}`:ue.includes("hdtv")?`HDTV ${De}`:ue.includes("blu")||ue.includes("bray")?`Bluray ${De}`:ue.includes("dvd")?"DVD":null},dt=me=>{if(!n||!o||o.length===0)return[];const De=o.filter(yt=>yt.partName&&yt.partName!==n);if(De.length===0)return[];const ue=[],Fe=De[0],mt=Be(Fe.quality),Se=Be(me.quality);mt&&Se&&mt!==Se&&ue.push(`Different resolution than ${Fe.partName}: ${mt}`),Fe.codec&&me.codec&&Fe.codec.toLowerCase()!==me.codec.toLowerCase()&&ue.push(`Different codec than ${Fe.partName}: ${Fe.codec}`);const st=qe(Fe.source,mt),wt=qe(me.source,Se);return st&&wt&&st!==wt&&ue.push(`Different source than ${Fe.partName}: ${st}`),ue},He=me=>me?me.filter(De=>{const ue=De.name.toLowerCase();return!ue.startsWith("not ")&&!ue.startsWith("not-")}):[],Ce=y.useMemo(()=>!o||o.length===0?null:n?o.find(me=>me.partName===n)||null:o[0]||null,[o,n]),_e=me=>{if(!(Ce!=null&&Ce.originalTitle))return!1;const De=mt=>mt.toLowerCase().replace(/[.\-_]/g," ").replace(/\s+/g," ").trim(),ue=De(me),Fe=De(Ce.originalTitle);return ue===Fe||ue.includes(Fe)||Fe.includes(ue)},ge=me=>{if(!Ce)return null;const De=Ce.customFormatScore??0,ue=me.customFormatScore??0,Fe=ue-De;return{existingIsBetter:De>ue,difference:Fe,existingScore:De,releaseScore:ue}},Ze=me=>{var ue;const De=[...me.rejections||[]];if(me.customFormatScore<0){const Fe=(ue=me.matchedFormats)==null?void 0:ue.filter(mt=>mt.score<0&&!mt.name.toLowerCase().startsWith("not ")).map(mt=>mt.name).join(", ");Fe&&De.push(`Custom Formats ${Fe} have score ${me.customFormatScore} below minimum`)}return De},Me=me=>{var De;if(me.protocol){const ue=me.protocol.toLowerCase();if(ue==="torrent"||ue.includes("torrent"))return"torrent";if(ue==="usenet"||ue.includes("usenet")||ue==="nzb")return"usenet"}return me.seeders!==null||me.leechers!==null?"torrent":((De=me.indexer)!=null&&De.toLowerCase().includes("nzb"),"usenet")},nt=me=>{if(!me)return 0;const De=me.toLowerCase();return De.includes("2160p")||De.includes("4k")?4:De.includes("1080p")?3:De.includes("720p")?2:De.includes("480p")?1:0},ht=me=>{if(!me)return 0;const De=me.toLowerCase().replace(/-/g,"").replace(/ /g,"");return De.includes("remux")?7:De.includes("bluray")||De.includes("bray")?6:De.includes("webdl")?5:De.includes("webrip")?4:De.includes("web")?3:De.includes("hdtv")?2:De.includes("dvd")?1:0},Oe=me=>{if(!me)return 1/0;const De=new Date(me);return Math.floor((new Date().getTime()-De.getTime())/(1e3*60*60*24))},tt=me=>{var ue;let De=((ue=me.rejections)==null?void 0:ue.length)??0;return me.isBlocklisted&&De++,De+=dt(me).length,De},Ct=y.useMemo(()=>H?x.filter(me=>!(Ze(me).length>0||me.isBlocklisted)):x,[x,H]),we=y.useMemo(()=>H?x.length-Ct.length:0,[x,Ct,H]),bt=y.useMemo(()=>[...Ct].sort((me,De)=>{let ue=0;switch(R){case"score":{const Fe=typeof me.customFormatScore=="number"?me.customFormatScore:0,mt=typeof De.customFormatScore=="number"?De.customFormatScore:0;ue=Fe-mt;break}case"quality":{const Fe=typeof me.qualityScore=="number"?me.qualityScore:0,mt=typeof De.qualityScore=="number"?De.qualityScore:0;if(Fe!==mt)ue=Fe-mt;else{const Se=nt(me.quality),st=nt(De.quality);Se!==st?ue=Se-st:ue=ht(me.source)-ht(De.source)}break}case"source":{ue=ht(me.source)-ht(De.source);break}case"age":{ue=Oe(me.publishDate)-Oe(De.publishDate);break}case"title":{ue=(me.title||"").localeCompare(De.title||"");break}case"indexer":{ue=(me.indexer||"").localeCompare(De.indexer||"");break}case"size":{ue=(me.size??0)-(De.size??0);break}case"peers":{const Fe=(me.seeders??0)+(me.leechers??0),mt=(De.seeders??0)+(De.leechers??0);ue=Fe-mt;break}case"language":{ue=(me.language||"Unknown").localeCompare(De.language||"Unknown");break}case"warnings":{ue=tt(me)-tt(De);break}}return z==="desc"?-ue:ue}),[Ct,R,z,o,n]),ve=me=>{R===me?D(De=>De==="desc"?"asc":"desc"):(K(me),D("desc"))},xt=me=>{switch(me){case"grabbed":return t.jsx(tl,{className:"w-4 h-4 text-blue-400",title:"Grabbed"});case"import":case"completed":return t.jsx(qs,{className:"w-4 h-4 text-green-400",title:"Imported"});case"failed":return t.jsx(qt,{className:"w-4 h-4 text-red-400",title:"Failed"});case"warning":return t.jsx(Pr,{className:"w-4 h-4 text-yellow-400",title:"Warning"});case"blocklist":return t.jsx(no,{className:"w-4 h-4 text-orange-400",title:"Blocklisted"});case"deleted":return t.jsx(cs,{className:"w-4 h-4 text-gray-400",title:"Deleted"});default:return t.jsx(Or,{className:"w-4 h-4 text-gray-400"})}};return t.jsxs(Bs,{appear:!0,show:a,as:y.Fragment,unmount:!0,afterLeave:()=>{document.querySelectorAll("[inert]").forEach(me=>{me.removeAttribute("inert")})},children:[t.jsxs(Xs,{as:"div",className:"relative z-50",onClose:e,children:[t.jsx(Bs.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t.jsx("div",{className:"fixed inset-0 bg-black/80"})}),t.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:t.jsx("div",{className:"flex min-h-full items-center justify-center p-2",children:t.jsx(Bs.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:t.jsxs(Xs.Panel,{className:"w-[98vw] max-w-none mx-2 md:mx-4 transform rounded-lg bg-gradient-to-br from-gray-900 to-black border border-red-900/30 shadow-2xl transition-all",children:[t.jsxs("div",{className:"relative bg-gradient-to-r from-gray-900 via-red-950/20 to-gray-900 border-b border-red-900/30",children:[t.jsxs("div",{className:"px-3 md:px-6 py-3 md:py-4 flex items-center justify-between",children:[t.jsx("div",{className:"min-w-0 flex-1 mr-2",children:t.jsx("h2",{className:"text-base md:text-xl font-bold text-white truncate",children:ke()})}),t.jsx("button",{onClick:e,className:"p-1.5 md:p-2 rounded-lg bg-black/50 hover:bg-black/70 transition-colors flex-shrink-0",children:t.jsx(qt,{className:"w-5 h-5 md:w-6 md:h-6 text-white"})})]}),t.jsxs("div",{className:"px-3 md:px-6 flex gap-1",children:[t.jsx("button",{onClick:()=>d("search"),className:`px-3 md:px-4 py-1.5 md:py-2 text-xs md:text-sm font-medium rounded-t-lg transition-colors ${c==="search"?"bg-gray-800 text-white border-t border-l border-r border-gray-700":"text-gray-400 hover:text-white hover:bg-gray-800/50"}`,children:"Search"}),t.jsx("button",{onClick:()=>d("history"),className:`px-3 md:px-4 py-1.5 md:py-2 text-xs md:text-sm font-medium rounded-t-lg transition-colors ${c==="history"?"bg-gray-800 text-white border-t border-l border-r border-gray-700":"text-gray-400 hover:text-white hover:bg-gray-800/50"}`,children:"History"})]})]}),c==="search"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"px-3 md:px-6 py-2 md:py-3 border-b border-gray-800 flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[t.jsx("p",{className:"text-gray-400 text-xs md:text-sm hidden sm:block",children:"Search indexers for available releases"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative",ref:q,children:[t.jsxs("button",{onClick:()=>le(!te),className:`px-2 md:px-3 py-1 md:py-1.5 ${H?"bg-green-800 hover:bg-green-700":"bg-gray-800 hover:bg-gray-700"} text-gray-300 rounded transition-colors flex items-center gap-1 md:gap-1.5 text-xs md:text-sm`,children:[t.jsx(au,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),"Filter",H&&t.jsx("span",{className:"text-green-400 text-[10px]",children:""})]}),te&&t.jsxs("div",{className:"absolute top-full left-0 mt-1 w-56 bg-gray-900 border border-gray-700 rounded-lg shadow-xl z-50",children:[t.jsx("div",{className:"p-2",children:t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-800 p-2 rounded transition-colors",children:[t.jsx("input",{type:"checkbox",checked:H,onChange:me=>X(me.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-green-500 focus:ring-green-500 focus:ring-offset-gray-900"}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-white text-sm",children:"Hide Rejected"}),t.jsx("span",{className:"text-gray-500 text-xs",children:"Hide results with rejections or blocklist"})]})]})}),we>0&&t.jsx("div",{className:"px-3 py-2 border-t border-gray-700",children:t.jsxs("span",{className:"text-gray-500 text-xs",children:[we," rejected result",we!==1?"s":""," hidden"]})})]})]}),t.jsx("button",{onClick:Re,disabled:f||m,className:"px-3 md:px-4 py-1 md:py-1.5 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 text-white rounded transition-colors flex items-center gap-1.5 md:gap-2 text-xs md:text-sm",title:"Search for week packs (e.g., NFL-2025-Week15) containing this event",children:m?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-3.5 w-3.5 md:h-4 md:w-4 border-b-2 border-white"}),t.jsx("span",{className:"hidden sm:inline",children:"Searching..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(Ok,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Search Weekly Pack"}),t.jsx("span",{className:"sm:hidden",children:"Pack"})]})}),t.jsx("button",{onClick:()=>Pe(!1),disabled:f||m,className:"px-3 md:px-4 py-1 md:py-1.5 bg-red-600 hover:bg-red-700 disabled:bg-gray-600 text-white rounded transition-colors flex items-center gap-1.5 md:gap-2 text-xs md:text-sm",title:"Search indexers (uses cached results if available)",children:f?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-3.5 w-3.5 md:h-4 md:w-4 border-b-2 border-white"}),t.jsx("span",{className:"hidden sm:inline",children:"Searching..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(Ks,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Search"}),t.jsx("span",{className:"sm:hidden",children:"Search"})]})}),t.jsxs("button",{onClick:()=>Pe(!0),disabled:f||m,className:"px-2 md:px-3 py-1 md:py-1.5 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 text-white rounded transition-colors flex items-center gap-1 md:gap-1.5 text-xs md:text-sm",title:"Force refresh - bypass cache and query indexers directly",children:[t.jsx(Dt,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]})]})]}),v&&t.jsx("div",{className:"mx-6 mt-3 bg-red-900/20 border border-red-600/50 rounded-lg p-3",children:t.jsx("p",{className:"text-red-400 text-sm",children:v})}),x.length>0&&t.jsxs("div",{className:"px-6 py-2 text-gray-400 text-sm flex items-center gap-2",children:[t.jsxs("span",{children:["Found ",bt.length," releases"]}),we>0&&t.jsxs("span",{className:"text-gray-500 text-xs",children:["(",we," rejected hidden)"]})]}),t.jsx("div",{className:"max-h-[65vh] overflow-y-auto overflow-x-hidden",children:f?t.jsxs("div",{className:"p-8 text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-400",children:"Searching indexers for releases..."})]}):bt.length>0?t.jsxs("table",{className:"w-full text-xs",children:[t.jsx("thead",{className:"bg-gray-900/80 sticky top-0 z-10",children:t.jsxs("tr",{className:"border-b border-gray-800",children:[t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[52px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>ve("source"),title:"Sort by source type",children:t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("span",{children:"Source"}),R==="source"&&(z==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[60px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>ve("age"),title:"Sort by age",children:t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("span",{children:"Age"}),R==="age"&&(z==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium min-w-[150px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>ve("title"),title:"Sort by title",children:t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("span",{children:"Title"}),R==="title"&&(z==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[100px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>ve("indexer"),title:"Sort by indexer",children:t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("span",{children:"Indexer"}),R==="indexer"&&(z==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[60px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>ve("size"),title:"Sort by size",children:t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("span",{children:"Size"}),R==="size"&&(z==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[70px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>ve("peers"),title:"Sort by peers (seeders + leechers)",children:t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("span",{children:"Peers"}),R==="peers"&&(z==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-left py-1.5 pl-4 pr-2 text-gray-400 font-medium w-[80px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>ve("language"),title:"Sort by language",children:t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("span",{children:"Language"}),R==="language"&&(z==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[120px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>ve("quality"),title:"Sort by quality/resolution",children:t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("span",{children:"Quality"}),R==="quality"&&(z==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-center py-1.5 px-2 text-gray-400 font-medium w-[50px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>ve("score"),title:"Sort by Custom Format score",children:t.jsxs("div",{className:"flex items-center justify-center gap-0.5",children:[t.jsx("span",{children:"CF"}),R==="score"&&(z==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-center py-1.5 px-2 text-gray-400 font-medium w-[80px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>ve("warnings"),title:"Sort by rejections",children:t.jsxs("div",{className:"flex items-center justify-center gap-0.5",children:[t.jsx("span",{children:"Rejections"}),R==="warnings"&&(z==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-right py-1.5 px-2 text-gray-400 font-medium w-[70px]",children:"Actions"})]})}),t.jsx("tbody",{children:bt.map((me,De)=>{const ue=Me(me),Fe=Ze(me),mt=dt(me),Se=Fe.length>0||me.isBlocklisted,st=O||I.length>0,wt=_e(me.title),yt=ge(me);return t.jsxs("tr",{className:`border-b border-gray-800/50 hover:bg-gray-800/30 transition-colors ${wt?"bg-gray-700/40":me.isBlocklisted?"bg-orange-900/10":""}`,children:[t.jsx("td",{className:"py-1 px-2",children:t.jsx("span",{className:`px-1 py-0.5 text-[10px] font-semibold rounded ${ue==="torrent"?"bg-green-900/50 text-green-400":"bg-blue-900/50 text-blue-400"}`,children:ue==="torrent"?"torrent":"nzb"})}),t.jsx("td",{className:"py-1 px-2 text-gray-400 whitespace-nowrap",children:xe(me.publishDate)}),t.jsx("td",{className:"py-1 px-2",style:{maxWidth:"300px"},children:t.jsxs("div",{className:"flex items-start gap-1",children:[wt&&t.jsx("span",{className:"px-1 py-0.5 bg-gray-600 text-gray-300 text-[9px] font-bold rounded flex-shrink-0",title:"This is your currently downloaded file",children:"DOWNLOADED"}),me.isPack&&t.jsx("span",{className:"px-1 py-0.5 bg-purple-600 text-white text-[9px] font-bold rounded flex-shrink-0",children:"PACK"}),me.isBlocklisted&&t.jsx(no,{className:"w-3 h-3 text-orange-400 flex-shrink-0 mt-0.5"}),t.jsx("span",{className:`truncate ${wt?"text-gray-400":me.isBlocklisted?"text-orange-300":"text-white"}`,title:me.title,children:me.title})]})}),t.jsx("td",{className:"py-1 px-2 overflow-hidden",children:t.jsx("span",{className:"text-gray-300 truncate block",title:me.indexer,children:me.indexer})}),t.jsx("td",{className:"py-1 px-2 text-gray-400 whitespace-nowrap",children:je(me.size)}),t.jsx("td",{className:"py-1 px-2",children:ue==="torrent"&&me.seeders!==null?t.jsxs("span",{className:"whitespace-nowrap",children:[t.jsxs("span",{className:"text-green-400",children:["",me.seeders]}),me.leechers!==null&&t.jsxs("span",{className:"text-red-400 ml-1",children:["",me.leechers]})]}):t.jsx("span",{className:"text-gray-600",children:"-"})}),t.jsx("td",{className:"py-1 pl-4 pr-2",children:t.jsx("span",{className:"px-1 py-0.5 bg-gray-700 text-gray-300 text-[10px] rounded whitespace-nowrap",children:me.language||"English"})}),t.jsx("td",{className:"py-1 px-2",children:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"px-1 py-0.5 bg-blue-900/50 text-blue-400 text-[10px] rounded inline-block w-fit whitespace-nowrap",children:me.quality||"Unknown"}),mt.length>0&&t.jsx(wg,{preferTop:De>=bt.length/2,className:"w-64 p-2 text-left",content:t.jsxs(t.Fragment,{children:[t.jsx("p",{className:"text-orange-400 text-[10px] font-semibold mb-1",children:"Quality Mismatch:"}),mt.map((Mt,Ke)=>t.jsxs("p",{className:"text-gray-400 text-[10px]",children:[" ",Mt]},Ke))]}),children:t.jsxs("div",{className:"flex items-center gap-0.5 mt-0.5",children:[t.jsx(Pr,{className:"w-3 h-3 text-orange-400 flex-shrink-0 cursor-help"}),t.jsx("span",{className:"text-[9px] text-orange-400 truncate max-w-[90px]",children:mt.length===1?mt[0].split(":")[0]:`${mt.length} warnings`})]})})]})}),t.jsx("td",{className:"py-1 px-2 text-center",children:He(me.matchedFormats).length>0||yt?t.jsx(wg,{preferTop:De>=bt.length/2,content:t.jsxs(t.Fragment,{children:[yt&&t.jsxs("div",{className:"mb-1.5 pb-1.5 border-b border-gray-700",children:[t.jsxs("p",{className:"text-gray-400 text-[9px] font-semibold mb-0.5",children:["Existing file: ",t.jsxs("span",{className:yt.existingScore>=0?"text-green-400":"text-red-400",children:[yt.existingScore>0?"+":"",yt.existingScore]})]}),wt?t.jsx("p",{className:"text-gray-500 text-[8px]",children:"This is your downloaded release"}):t.jsx("p",{className:`text-[8px] ${yt.difference>0?"text-green-400":yt.difference<0?"text-red-400":"text-gray-500"}`,children:yt.difference>0?`+${yt.difference} upgrade`:yt.difference<0?`${yt.difference} downgrade`:"Same score"})]}),He(me.matchedFormats).length>0&&t.jsx("div",{className:"flex flex-wrap gap-0.5 max-w-[200px]",children:He(me.matchedFormats).map((Mt,Ke)=>t.jsx("span",{className:`px-1 py-0.5 text-[9px] rounded whitespace-nowrap ${Mt.score>0?"bg-green-900/50 text-green-400":Mt.score<0?"bg-red-900/50 text-red-400":"bg-gray-700 text-gray-300"}`,children:Mt.name},Ke))})]}),children:t.jsxs("div",{className:"flex items-center justify-center gap-0.5 cursor-help",children:[t.jsxs("span",{className:`font-bold text-xs ${me.customFormatScore>0?"text-green-400":me.customFormatScore<0?"text-red-400":"text-gray-400"}`,children:[me.customFormatScore>0?"+":"",me.customFormatScore]}),yt&&!wt&&t.jsx("span",{className:`text-[9px] font-semibold ${yt.difference>0?"text-green-400":yt.difference<0?"text-red-400":"text-gray-500"}`,children:yt.difference>0?"":yt.difference<0?"":"="})]})}):t.jsx("div",{className:"flex items-center justify-center gap-0.5",children:t.jsxs("span",{className:`font-bold text-xs ${me.customFormatScore>0?"text-green-400":me.customFormatScore<0?"text-red-400":"text-gray-400"}`,children:[me.customFormatScore>0?"+":"",me.customFormatScore]})})}),t.jsx("td",{className:"py-1 px-2 text-center",children:Se?t.jsx(wg,{preferTop:De>=bt.length/2,className:"w-64 p-2 text-left",content:t.jsxs(t.Fragment,{children:[me.isBlocklisted&&t.jsxs("div",{className:"mb-1.5",children:[t.jsx("p",{className:"text-orange-400 text-[10px] font-semibold",children:"Blocklisted"}),me.blocklistReason&&t.jsx("p",{className:"text-gray-400 text-[10px]",children:me.blocklistReason})]}),Fe.length>0&&t.jsxs("div",{children:[t.jsx("p",{className:"text-red-400 text-[10px] font-semibold mb-0.5",children:"Rejections:"}),Fe.map((Mt,Ke)=>t.jsxs("p",{className:"text-gray-400 text-[10px]",children:[" ",Mt]},Ke))]})]}),children:t.jsx(Pr,{className:`w-3.5 h-3.5 mx-auto cursor-help ${me.isBlocklisted?"text-orange-400":"text-red-400"}`})}):t.jsx("span",{className:"text-gray-700",children:"-"})}),t.jsx("td",{className:"py-1 px-2",children:t.jsxs("div",{className:"flex items-center justify-end gap-0.5",children:[t.jsx("button",{onClick:()=>Qe(me,De,!1),disabled:S!==null,className:"p-1 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 disabled:cursor-not-allowed text-white rounded transition-colors",title:"Download",children:S===De?t.jsx("div",{className:"animate-spin rounded-full h-3.5 w-3.5 border-b-2 border-white"}):t.jsx(qs,{className:"w-3.5 h-3.5"})}),st&&t.jsx("button",{onClick:()=>Qe(me,De,!0),disabled:S!==null,className:"p-1 bg-orange-700 hover:bg-orange-600 disabled:bg-gray-800 disabled:cursor-not-allowed text-white rounded transition-colors",title:I.length>0?"Replace queued download":"Replace existing file",children:t.jsx(Gk,{className:"w-3.5 h-3.5"})})]})})]},De)})})]}):t.jsxs("div",{className:"p-8 text-center",children:[t.jsx(Ks,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-400 mb-2",children:"No search performed yet"}),t.jsx("p",{className:"text-gray-500 text-sm",children:'Click "Search Indexers" to manually search for releases'})]})})]}),c==="history"&&t.jsx("div",{className:"max-h-[65vh] overflow-y-auto",children:ee?t.jsxs("div",{className:"p-8 text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-400",children:"Loading history..."})]}):ae.length>0?t.jsxs("table",{className:"w-full text-xs",children:[t.jsx("thead",{className:"bg-gray-900/80 sticky top-0 z-10",children:t.jsxs("tr",{className:"border-b border-gray-800",children:[t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[28px]"}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium min-w-[150px]",children:"Source Title"}),!n&&ae.some(me=>me.part)&&t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[80px]",children:"Part"}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[70px]",children:"Language"}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[90px]",children:"Quality"}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[140px]",children:"Date"}),t.jsx("th",{className:"text-right py-1.5 px-2 text-gray-400 font-medium w-[60px]",children:"Actions"})]})}),t.jsx("tbody",{children:ae.map(me=>t.jsxs("tr",{className:"border-b border-gray-800/50 hover:bg-gray-800/30 transition-colors",children:[t.jsx("td",{className:"py-1 px-2",children:xt(me.type)}),t.jsx("td",{className:"py-1 px-2",style:{maxWidth:"300px"},children:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-white truncate",title:me.sourcePath,children:me.sourcePath}),me.destinationPath&&t.jsxs("span",{className:"text-gray-500 text-[10px] truncate",title:me.destinationPath,children:[" ",me.destinationPath]})]})}),!n&&ae.some(De=>De.part)&&t.jsx("td",{className:"py-1 px-2",children:me.part?t.jsx("span",{className:"px-1 py-0.5 bg-purple-900/50 text-purple-400 text-[10px] rounded whitespace-nowrap",children:me.part}):t.jsx("span",{className:"text-gray-600",children:"-"})}),t.jsx("td",{className:"py-1 px-2",children:t.jsx("span",{className:"px-1 py-0.5 bg-gray-700 text-gray-300 text-[10px] rounded whitespace-nowrap",children:"English"})}),t.jsx("td",{className:"py-1 px-2",children:me.quality?t.jsx("span",{className:"px-1 py-0.5 bg-blue-900/50 text-blue-400 text-[10px] rounded whitespace-nowrap",children:me.quality}):t.jsx("span",{className:"text-gray-600",children:"-"})}),t.jsx("td",{className:"py-1 px-2 text-gray-400 whitespace-nowrap",children:Ee(me.date)}),t.jsx("td",{className:"py-1 px-2",children:t.jsxs("div",{className:"flex items-center justify-end gap-0.5",children:[(me.errors.length>0||me.warnings.length>0)&&t.jsxs("div",{className:"relative group",children:[t.jsx(Or,{className:"w-3.5 h-3.5 text-gray-500 cursor-help"}),t.jsxs("div",{className:"absolute right-0 top-5 z-50 hidden group-hover:block w-56 p-1.5 bg-gray-900 border border-gray-700 rounded-lg shadow-xl text-left",children:[me.errors.map((De,ue)=>t.jsxs("p",{className:"text-red-400 text-[10px]",children:[" ",De]},ue)),me.warnings.map((De,ue)=>t.jsxs("p",{className:"text-yellow-400 text-[10px]",children:[" ",De]},ue))]})]}),me.type==="grabbed"&&t.jsx("button",{onClick:()=>G(me),className:"p-1 text-gray-500 hover:text-red-400 hover:bg-gray-800 rounded transition-colors",title:"Mark as Failed",children:t.jsx(qt,{className:"w-3.5 h-3.5"})})]})})]},`${me.type}-${me.id}`))})]}):t.jsxs("div",{className:"p-8 text-center",children:[t.jsx(Or,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-400 mb-2",children:"No history for this event"}),t.jsx("p",{className:"text-gray-500 text-sm",children:"Download history will appear here after grabbing releases"})]})}),t.jsx("div",{className:"px-6 py-3 bg-gray-900/50 border-t border-red-900/30 flex justify-end",children:t.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors text-sm",children:"Close"})})]})})})})]}),k&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-orange-700 rounded-lg max-w-lg w-full p-6",children:[t.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[t.jsx(no,{className:"w-8 h-8 text-orange-400 flex-shrink-0"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold text-white",children:"Download Blocklisted Release?"}),t.jsx("p",{className:"text-orange-400 text-sm mt-1",children:"This release has been blocklisted"})]})]}),t.jsxs("div",{className:"bg-orange-900/20 border border-orange-600/30 rounded-lg p-4 mb-4",children:[t.jsx("p",{className:"text-white font-medium text-sm truncate mb-2",title:k.result.title,children:k.result.title}),k.result.blocklistReason&&t.jsxs("p",{className:"text-orange-300 text-sm",children:[t.jsx("span",{className:"text-gray-400",children:"Reason: "}),k.result.blocklistReason]})]}),t.jsx("p",{className:"text-gray-300 text-sm mb-6",children:"This release was previously blocklisted. Are you sure you want to download it anyway? This will override the blocklist for this download only."}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>E(null),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsxs("button",{onClick:()=>ot(k.result,k.index),className:"px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg transition-colors flex items-center gap-2",children:[t.jsx(qs,{className:"w-4 h-4"}),"Download Anyway"]})]})]})}),V&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-700 rounded-lg max-w-lg w-full p-6",children:[t.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[t.jsx(cs,{className:"w-8 h-8 text-red-400 flex-shrink-0"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold text-white",children:"Mark as Failed?"}),t.jsx("p",{className:"text-red-400 text-sm mt-1",children:"This will blocklist the release"})]})]}),t.jsx("div",{className:"bg-red-900/20 border border-red-600/30 rounded-lg p-4 mb-4",children:t.jsx("p",{className:"text-white font-medium text-sm truncate",title:V.sourcePath,children:V.sourcePath})}),t.jsx("p",{className:"text-gray-300 text-sm mb-6",children:"This will add the release to the blocklist so it won't be downloaded again. Would you like to search for a replacement?"}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>G(null),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>ne(V,!1),className:"px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded-lg transition-colors",children:"Blocklist Only"}),t.jsxs("button",{onClick:()=>ne(V,!0),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors flex items-center gap-2",children:[t.jsx(Ks,{className:"w-4 h-4"}),"Blocklist & Search"]})]})]})})]})}function JD({isOpen:a,onClose:e,leagueId:s,leagueName:r,season:n,qualityProfileId:o}){const[c,d]=y.useState("search"),[f,u]=y.useState(!1),[m,g]=y.useState(null),[x,b]=y.useState(null),[v,w]=y.useState(null),[S,T]=y.useState("events"),[k,E]=y.useState("desc"),[R,K]=y.useState(new Set),[z,D]=y.useState(null),[O,U]=y.useState([]),[I,F]=y.useState(!1),[te,le]=y.useState(null);y.useEffect(()=>{a&&(g(null),b(null),w(null),K(new Set),d("search"),D(null),H())},[a,s,n]);const H=async()=>{F(!0);try{const ne=await kt(`/api/leagues/${s}/seasons/${encodeURIComponent(n)}/history`);if(ne.ok){const ke=await ne.json();U(ke)}}catch(ne){console.error("Failed to load history:",ne)}finally{F(!1)}},X=ne=>{if(!ne)return"N/A";const ke=ne/(1024*1024*1024);return ke>=1?`${ke.toFixed(2)} GiB`:`${(ne/(1024*1024)).toFixed(1)} MiB`},q=ne=>{const ke=new Date,Be=new Date(ne),qe=ke.getTime()-Be.getTime(),dt=Math.floor(qe/(1e3*60*60*24));return dt===0?"Today":dt===1?"1 day":`${dt} days`},ae=ne=>new Date(ne).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}),ce=async()=>{u(!0),b(null),g(null);try{const ne=`/api/leagues/${s}/seasons/${encodeURIComponent(n)}/search`,Be=await(await ds(ne,{qualityProfileId:o})).json();g(Be)}catch(ne){console.error("Season search failed:",ne),b("Failed to search indexers. Please try again.")}finally{u(!1)}},ee=(ne,ke)=>{if(ne.isBlocklisted){D({index:ke,result:ne});return}W(ne,ke)},W=async(ne,ke)=>{var Be;D(null),w(ke),b(null);try{const qe=await ds("/api/release/grab",{title:ne.title,guid:ne.guid,downloadUrl:ne.downloadUrl,indexer:ne.indexer,protocol:ne.protocol,size:ne.size,quality:ne.quality,source:ne.source,codec:ne.codec,language:ne.language,seeders:ne.seeders,leechers:ne.leechers,publishDate:ne.publishDate,score:ne.score,qualityScore:ne.qualityScore,torrentInfoHash:ne.torrentInfoHash,eventId:(Be=ne.matchedEvents[0])==null?void 0:Be.eventId,matchedEventIds:ne.matchedEvents.map(dt=>dt.eventId),isSeasonPack:ne.isSeasonPack,overrideBlocklist:ne.isBlocklisted});if(qe.ok)be.success("Release grabbed",{description:ne.isSeasonPack?`Season pack queued for download (${ne.matchedEventCount} events)`:"Release queued for download"}),e();else{const dt=await qe.json();throw new Error(dt.message||"Failed to grab release")}}catch(qe){console.error("Download failed:",qe),b(qe instanceof Error?qe.message:"Failed to grab release")}finally{w(null)}},V=ne=>{K(ke=>{const Be=new Set(ke);return Be.has(ne)?Be.delete(ne):Be.add(ne),Be})},G=async(ne,ke)=>{try{const Be=ke?"blocklistAndSearch":"blocklistOnly";(await Na(`/api/history/${ne.id}?blocklistAction=${Be}`)).ok?(be.success("Marked as Failed",{description:ke?"Release blocklisted and searching for replacement...":"Release added to blocklist."}),H()):be.error("Failed",{description:"Could not mark release as failed."})}catch(Be){console.error("Mark as failed error:",Be),be.error("Error",{description:"Failed to mark release as failed."})}finally{le(null)}},Z=ne=>{if(!ne)return 0;const ke=ne.toLowerCase();return ke.includes("2160p")||ke.includes("4k")?4:ke.includes("1080p")?3:ke.includes("720p")?2:ke.includes("480p")?1:0},oe=ne=>{if(!ne)return 0;const ke=ne.toLowerCase().replace(/-/g,"").replace(/ /g,"");return ke.includes("remux")?7:ke.includes("bluray")||ke.includes("bray")?6:ke.includes("webdl")?5:ke.includes("webrip")?4:ke.includes("web")?3:ke.includes("hdtv")?2:ke.includes("dvd")?1:0},ye=ne=>{if(!ne)return 1/0;const ke=new Date(ne);return Math.floor((new Date().getTime()-ke.getTime())/(1e3*60*60*24))},je=ne=>{var Be;let ke=((Be=ne.rejections)==null?void 0:Be.length)??0;return ne.isBlocklisted&&ke++,ke},xe=ne=>ne?ne.filter(ke=>{const Be=ke.name.toLowerCase();return!Be.startsWith("not ")&&!Be.startsWith("not-")}):[],Ee=ne=>{var qe;const ke=[...ne.rejections||[]],Be=ne.customFormatScore??0;if(Be<0){const dt=(qe=ne.matchedFormats)==null?void 0:qe.filter(He=>He.score<0&&!He.name.toLowerCase().startsWith("not ")).map(He=>He.name).join(", ");dt&&ke.push(`Custom Formats ${dt} have score ${Be} below minimum`)}return ke},Pe=y.useMemo(()=>m!=null&&m.releases?[...m.releases].sort((ne,ke)=>{let Be=0;switch(S){case"events":Be=ne.matchedEventCount-ke.matchedEventCount;break;case"score":{const He=ne.customFormatScore??0,Ce=ke.customFormatScore??0;Be=He-Ce;break}case"quality":{const He=ne.qualityScore??Z(ne.quality),Ce=ke.qualityScore??Z(ke.quality);He!==Ce?Be=He-Ce:Be=oe(ne.source)-oe(ke.source);break}case"source":Be=oe(ne.source)-oe(ke.source);break;case"age":Be=ye(ne.publishDate)-ye(ke.publishDate);break;case"title":Be=(ne.title||"").localeCompare(ke.title||"");break;case"indexer":Be=(ne.indexer||"").localeCompare(ke.indexer||"");break;case"size":Be=(ne.size??0)-(ke.size??0);break;case"peers":const qe=(ne.seeders??0)+(ne.leechers??0),dt=(ke.seeders??0)+(ke.leechers??0);Be=qe-dt;break;case"language":Be=(ne.language||"English").localeCompare(ke.language||"English");break;case"warnings":Be=je(ne)-je(ke);break}return k==="desc"?-Be:Be}):[],[m,S,k]),Re=ne=>{S===ne?E(ke=>ke==="desc"?"asc":"desc"):(T(ne),E("desc"))},Qe=ne=>{var ke;if(ne.protocol){const Be=ne.protocol.toLowerCase();if(Be==="torrent"||Be.includes("torrent"))return"torrent";if(Be==="usenet"||Be.includes("usenet")||Be==="nzb")return"usenet"}return ne.seeders!==null||ne.leechers!==null?"torrent":((ke=ne.indexer)!=null&&ke.toLowerCase().includes("nzb"),"usenet")},ot=ne=>{switch(ne){case"grabbed":return t.jsx(tl,{className:"w-4 h-4 text-blue-400",title:"Grabbed"});case"import":case"completed":return t.jsx(qs,{className:"w-4 h-4 text-green-400",title:"Imported"});case"failed":return t.jsx(qt,{className:"w-4 h-4 text-red-400",title:"Failed"});case"warning":return t.jsx(Pr,{className:"w-4 h-4 text-yellow-400",title:"Warning"});case"blocklist":return t.jsx(no,{className:"w-4 h-4 text-orange-400",title:"Blocklisted"});case"deleted":return t.jsx(cs,{className:"w-4 h-4 text-gray-400",title:"Deleted"});default:return t.jsx(Or,{className:"w-4 h-4 text-gray-400"})}};return t.jsxs(Bs,{appear:!0,show:a,as:y.Fragment,unmount:!0,afterLeave:()=>{document.querySelectorAll("[inert]").forEach(ne=>{ne.removeAttribute("inert")})},children:[t.jsxs(Xs,{as:"div",className:"relative z-50",onClose:e,children:[t.jsx(Bs.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t.jsx("div",{className:"fixed inset-0 bg-black/80"})}),t.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:t.jsx("div",{className:"flex min-h-full items-center justify-center p-2",children:t.jsx(Bs.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:t.jsxs(Xs.Panel,{className:"w-[98vw] max-w-none mx-2 md:mx-4 transform overflow-hidden rounded-lg bg-gradient-to-br from-gray-900 to-black border border-red-900/30 shadow-2xl transition-all",children:[t.jsxs("div",{className:"relative bg-gradient-to-r from-gray-900 via-red-950/20 to-gray-900 border-b border-red-900/30",children:[t.jsxs("div",{className:"px-3 md:px-6 py-3 md:py-4 flex items-center justify-between",children:[t.jsxs("div",{className:"min-w-0 flex-1 mr-2",children:[t.jsxs("h2",{className:"text-base md:text-xl font-bold text-white truncate",children:[r," - Season ",n]}),m&&t.jsxs("p",{className:"text-xs md:text-sm text-gray-400 mt-1",children:[m.eventCount," events (",m.monitoredEventCount," monitored, ",m.downloadedEventCount," downloaded)"]})]}),t.jsx("button",{onClick:e,className:"p-1.5 md:p-2 rounded-lg bg-black/50 hover:bg-black/70 transition-colors flex-shrink-0",children:t.jsx(qt,{className:"w-5 h-5 md:w-6 md:h-6 text-white"})})]}),t.jsxs("div",{className:"px-3 md:px-6 flex gap-1",children:[t.jsx("button",{onClick:()=>d("search"),className:`px-3 md:px-4 py-1.5 md:py-2 text-xs md:text-sm font-medium rounded-t-lg transition-colors ${c==="search"?"bg-gray-800 text-white border-t border-l border-r border-gray-700":"text-gray-400 hover:text-white hover:bg-gray-800/50"}`,children:"Search"}),t.jsx("button",{onClick:()=>d("history"),className:`px-3 md:px-4 py-1.5 md:py-2 text-xs md:text-sm font-medium rounded-t-lg transition-colors ${c==="history"?"bg-gray-800 text-white border-t border-l border-r border-gray-700":"text-gray-400 hover:text-white hover:bg-gray-800/50"}`,children:"History"})]})]}),c==="search"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"px-3 md:px-6 py-2 md:py-3 border-b border-gray-800 flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[t.jsx("p",{className:"text-gray-400 text-xs md:text-sm hidden sm:block",children:"Search for season packs containing multiple events"}),t.jsx("button",{onClick:ce,disabled:f,className:"px-3 md:px-4 py-1 md:py-1.5 bg-red-600 hover:bg-red-700 disabled:bg-gray-600 text-white rounded transition-colors flex items-center gap-1.5 md:gap-2 text-xs md:text-sm",children:f?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-3.5 w-3.5 md:h-4 md:w-4 border-b-2 border-white"}),t.jsx("span",{className:"hidden sm:inline",children:"Searching..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(Ks,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Search Indexers"}),t.jsx("span",{className:"sm:hidden",children:"Search"})]})})]}),x&&t.jsx("div",{className:"mx-3 md:mx-6 mt-3 bg-red-900/20 border border-red-600/50 rounded-lg p-3",children:t.jsx("p",{className:"text-red-400 text-sm",children:x})}),m&&m.releases.length>0&&t.jsxs("div",{className:"px-3 md:px-6 py-2 text-gray-400 text-sm",children:["Found ",m.releases.length," season pack",m.releases.length!==1?"s":""]}),t.jsx("div",{className:"max-h-[65vh] overflow-y-auto",children:f?t.jsxs("div",{className:"p-8 text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-400",children:"Searching indexers for season releases..."})]}):Pe.length>0?t.jsxs("table",{className:"w-full text-xs",children:[t.jsx("thead",{className:"bg-gray-900/80 sticky top-0 z-10",children:t.jsxs("tr",{className:"border-b border-gray-800",children:[t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[52px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>Re("source"),title:"Sort by source type",children:t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("span",{children:"Source"}),S==="source"&&(k==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[60px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>Re("events"),title:"Sort by matched events",children:t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("span",{children:"Events"}),S==="events"&&(k==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[60px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>Re("age"),title:"Sort by age",children:t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("span",{children:"Age"}),S==="age"&&(k==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium min-w-[150px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>Re("title"),title:"Sort by title",children:t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("span",{children:"Title"}),S==="title"&&(k==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[100px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>Re("indexer"),title:"Sort by indexer",children:t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("span",{children:"Indexer"}),S==="indexer"&&(k==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[60px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>Re("size"),title:"Sort by size",children:t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("span",{children:"Size"}),S==="size"&&(k==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[70px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>Re("peers"),title:"Sort by peers",children:t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("span",{children:"Peers"}),S==="peers"&&(k==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-left py-1.5 pl-4 pr-2 text-gray-400 font-medium w-[80px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>Re("language"),title:"Sort by language",children:t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("span",{children:"Language"}),S==="language"&&(k==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[120px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>Re("quality"),title:"Sort by quality",children:t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("span",{children:"Quality"}),S==="quality"&&(k==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-center py-1.5 px-2 text-gray-400 font-medium w-[50px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>Re("score"),title:"Sort by Custom Format score",children:t.jsxs("div",{className:"flex items-center justify-center gap-0.5",children:[t.jsx("span",{children:"CF"}),S==="score"&&(k==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"text-center py-1.5 px-2 text-gray-400 font-medium w-[24px] cursor-pointer hover:text-white transition-colors select-none",onClick:()=>Re("warnings"),title:"Sort by warnings",children:S==="warnings"&&(k==="desc"?t.jsx(As,{className:"w-3 h-3"}):t.jsx(Js,{className:"w-3 h-3"}))}),t.jsx("th",{className:"text-right py-1.5 px-2 text-gray-400 font-medium w-[70px]",children:"Actions"})]})}),t.jsx("tbody",{children:Pe.map((ne,ke)=>{const Be=Qe(ne),qe=R.has(ne.guid),dt=Ee(ne),He=dt.length>0||ne.isBlocklisted,Ce=ne.customFormatScore??0;return t.jsxs(y.Fragment,{children:[t.jsxs("tr",{className:`border-b border-gray-800/50 hover:bg-gray-800/30 transition-colors ${ne.isBlocklisted?"bg-orange-900/10":""}`,children:[t.jsx("td",{className:"py-1 px-2",children:t.jsx("span",{className:`px-1 py-0.5 text-[10px] font-semibold rounded ${Be==="torrent"?"bg-green-900/50 text-green-400":"bg-blue-900/50 text-blue-400"}`,children:Be==="torrent"?"torrent":"nzb"})}),t.jsx("td",{className:"py-1 px-2",children:t.jsxs("button",{onClick:()=>V(ne.guid),className:"flex items-center gap-1 text-white hover:text-red-400 transition-colors",title:`Click to see ${ne.matchedEventCount} matched events`,children:[ne.isSeasonPack?t.jsx(Kr,{className:"w-3.5 h-3.5 text-yellow-500"}):null,t.jsx("span",{className:ne.isSeasonPack?"text-yellow-400 font-medium":"",children:ne.matchedEventCount}),qe?t.jsx(Js,{className:"w-3 h-3"}):t.jsx(As,{className:"w-3 h-3"})]})}),t.jsx("td",{className:"py-1 px-2 text-gray-400 whitespace-nowrap",children:q(ne.publishDate)}),t.jsx("td",{className:"py-1 px-2",style:{maxWidth:"300px"},children:t.jsxs("div",{className:"flex items-start gap-1",children:[ne.isBlocklisted&&t.jsx(no,{className:"w-3 h-3 text-orange-400 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("span",{className:`truncate block ${ne.isBlocklisted?"text-orange-300":"text-white"}`,title:ne.title,children:ne.title}),ne.isSeasonPack&&t.jsx("span",{className:"text-yellow-500 text-[10px]",children:"Season Pack"})]})]})}),t.jsx("td",{className:"py-1 px-2 overflow-hidden",children:t.jsx("span",{className:"text-gray-300 truncate block",title:ne.indexer,children:ne.indexer})}),t.jsx("td",{className:"py-1 px-2 text-gray-400 whitespace-nowrap",children:X(ne.size)}),t.jsx("td",{className:"py-1 px-2",children:Be==="torrent"&&ne.seeders!==void 0?t.jsxs("span",{className:"whitespace-nowrap",children:[t.jsxs("span",{className:"text-green-400",children:["",ne.seeders??0]}),t.jsxs("span",{className:"text-red-400 ml-1",children:["",ne.leechers??0]})]}):t.jsx("span",{className:"text-gray-600",children:"-"})}),t.jsx("td",{className:"py-1 pl-4 pr-2",children:t.jsx("span",{className:"px-1 py-0.5 bg-gray-700 text-gray-300 text-[10px] rounded whitespace-nowrap",children:ne.language||"English"})}),t.jsx("td",{className:"py-1 px-2",children:t.jsx("span",{className:"px-1 py-0.5 bg-blue-900/50 text-blue-400 text-[10px] rounded inline-block w-fit whitespace-nowrap",children:ne.quality||"Unknown"})}),t.jsx("td",{className:"py-1 px-2 text-center",children:t.jsxs("div",{className:"relative group",children:[t.jsxs("span",{className:`font-bold text-xs cursor-help ${Ce>0?"text-green-400":Ce<0?"text-red-400":"text-gray-400"}`,children:[Ce>0?"+":"",Ce]}),xe(ne.matchedFormats).length>0&&t.jsx("div",{className:"absolute right-0 top-5 z-50 hidden group-hover:block p-1.5 bg-gray-900 border border-gray-700 rounded-lg shadow-xl",children:t.jsx("div",{className:"flex flex-wrap gap-0.5 max-w-[200px]",children:xe(ne.matchedFormats).map((_e,ge)=>t.jsx("span",{className:`px-1 py-0.5 text-[9px] rounded whitespace-nowrap ${_e.score>0?"bg-green-900/50 text-green-400":_e.score<0?"bg-red-900/50 text-red-400":"bg-gray-700 text-gray-300"}`,children:_e.name},ge))})})]})}),t.jsx("td",{className:"py-1 px-2 text-center",children:He?t.jsxs("div",{className:"relative group",children:[t.jsx(Pr,{className:`w-3.5 h-3.5 mx-auto cursor-help ${ne.isBlocklisted?"text-orange-400":"text-red-400"}`}),t.jsxs("div",{className:"absolute right-0 top-5 z-50 hidden group-hover:block w-64 p-2 bg-gray-900 border border-gray-700 rounded-lg shadow-xl text-left",children:[ne.isBlocklisted&&t.jsxs("div",{className:"mb-1.5",children:[t.jsx("p",{className:"text-orange-400 text-[10px] font-semibold",children:"Blocklisted"}),ne.blocklistReason&&t.jsx("p",{className:"text-gray-400 text-[10px]",children:ne.blocklistReason})]}),dt.length>0&&t.jsxs("div",{children:[t.jsx("p",{className:"text-red-400 text-[10px] font-semibold mb-0.5",children:"Rejections:"}),dt.map((_e,ge)=>t.jsxs("p",{className:"text-gray-400 text-[10px]",children:[" ",_e]},ge))]})]})]}):t.jsx("span",{className:"text-gray-700",children:"-"})}),t.jsx("td",{className:"py-1 px-2",children:t.jsx("div",{className:"flex items-center justify-end gap-0.5",children:t.jsx("button",{onClick:()=>ee(ne,ke),disabled:v!==null,className:"p-1 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 disabled:cursor-not-allowed text-white rounded transition-colors",title:ne.isSeasonPack?`Download season pack (${ne.matchedEventCount} events)`:"Download",children:v===ke?t.jsx("div",{className:"animate-spin rounded-full h-3.5 w-3.5 border-b-2 border-white"}):t.jsx(qs,{className:"w-3.5 h-3.5"})})})})]}),qe&&t.jsx("tr",{className:"bg-gray-900/50",children:t.jsx("td",{colSpan:12,className:"py-2 px-4",children:t.jsxs("div",{className:"text-xs",children:[t.jsx("p",{className:"text-gray-400 mb-2 font-medium",children:"Matched Events:"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:ne.matchedEvents.map(_e=>t.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 bg-gray-800/50 rounded",children:[_e.hasFile?t.jsx(rs,{className:"w-4 h-4 text-green-500 flex-shrink-0"}):_e.monitored?t.jsx(Ss,{className:"w-4 h-4 text-red-500 flex-shrink-0"}):t.jsx("div",{className:"w-4 h-4 border border-gray-600 rounded flex-shrink-0"}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("p",{className:"text-white truncate",title:_e.eventTitle,children:_e.eventTitle}),t.jsxs("p",{className:"text-gray-500 text-[10px]",children:[new Date(_e.eventDate).toLocaleDateString(),_e.detectedPart&&t.jsx("span",{className:"ml-1 px-1 bg-purple-900/50 text-purple-400 rounded",children:_e.detectedPart})]})]}),t.jsxs("span",{className:`text-[10px] px-1 rounded ${_e.confidence>=80?"bg-green-900/50 text-green-400":_e.confidence>=50?"bg-yellow-900/50 text-yellow-400":"bg-gray-700 text-gray-400"}`,children:[_e.confidence,"%"]})]},_e.eventId))})]})})})]},ne.guid)})})]}):m?t.jsxs("div",{className:"p-8 text-center text-gray-400",children:[t.jsx("p",{children:"No season packs found for this season."}),t.jsx("p",{className:"text-sm mt-2",children:"Season packs are releases containing multiple events. For individual events, use the event-level search instead."})]}):t.jsxs("div",{className:"p-8 text-center",children:[t.jsx(Ks,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-400 mb-2",children:"No search performed yet"}),t.jsx("p",{className:"text-gray-500 text-sm",children:'Click "Search Indexers" to find season packs'})]})})]}),c==="history"&&t.jsx("div",{className:"max-h-[65vh] overflow-y-auto",children:I?t.jsxs("div",{className:"p-8 text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-400",children:"Loading history..."})]}):O.length>0?t.jsxs("table",{className:"w-full text-xs",children:[t.jsx("thead",{className:"bg-gray-900/80 sticky top-0 z-10",children:t.jsxs("tr",{className:"border-b border-gray-800",children:[t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[28px]"}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[120px]",children:"Event"}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium min-w-[150px]",children:"Source Title"}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[70px]",children:"Language"}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[90px]",children:"Quality"}),t.jsx("th",{className:"text-left py-1.5 px-2 text-gray-400 font-medium w-[140px]",children:"Date"}),t.jsx("th",{className:"text-right py-1.5 px-2 text-gray-400 font-medium w-[60px]",children:"Actions"})]})}),t.jsx("tbody",{children:O.map(ne=>t.jsxs("tr",{className:"border-b border-gray-800/50 hover:bg-gray-800/30 transition-colors",children:[t.jsx("td",{className:"py-1 px-2",children:ot(ne.type)}),t.jsx("td",{className:"py-1 px-2",children:t.jsx("span",{className:"text-gray-300 truncate block",title:ne.eventTitle,children:ne.eventTitle||"-"})}),t.jsx("td",{className:"py-1 px-2",style:{maxWidth:"300px"},children:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-white truncate",title:ne.sourcePath,children:ne.sourcePath}),ne.destinationPath&&t.jsxs("span",{className:"text-gray-500 text-[10px] truncate",title:ne.destinationPath,children:[" ",ne.destinationPath]})]})}),t.jsx("td",{className:"py-1 px-2",children:t.jsx("span",{className:"px-1 py-0.5 bg-gray-700 text-gray-300 text-[10px] rounded whitespace-nowrap",children:"English"})}),t.jsx("td",{className:"py-1 px-2",children:ne.quality?t.jsx("span",{className:"px-1 py-0.5 bg-blue-900/50 text-blue-400 text-[10px] rounded whitespace-nowrap",children:ne.quality}):t.jsx("span",{className:"text-gray-600",children:"-"})}),t.jsx("td",{className:"py-1 px-2 text-gray-400 whitespace-nowrap",children:ae(ne.date)}),t.jsx("td",{className:"py-1 px-2",children:t.jsxs("div",{className:"flex items-center justify-end gap-0.5",children:[(ne.errors.length>0||ne.warnings.length>0)&&t.jsxs("div",{className:"relative group",children:[t.jsx(Or,{className:"w-3.5 h-3.5 text-gray-500 cursor-help"}),t.jsxs("div",{className:"absolute right-0 top-5 z-50 hidden group-hover:block w-56 p-1.5 bg-gray-900 border border-gray-700 rounded-lg shadow-xl text-left",children:[ne.errors.map((ke,Be)=>t.jsxs("p",{className:"text-red-400 text-[10px]",children:[" ",ke]},Be)),ne.warnings.map((ke,Be)=>t.jsxs("p",{className:"text-yellow-400 text-[10px]",children:[" ",ke]},Be))]})]}),ne.type==="grabbed"&&t.jsx("button",{onClick:()=>le(ne),className:"p-1 text-gray-500 hover:text-red-400 hover:bg-gray-800 rounded transition-colors",title:"Mark as Failed",children:t.jsx(qt,{className:"w-3.5 h-3.5"})})]})})]},`${ne.type}-${ne.id}`))})]}):t.jsxs("div",{className:"p-8 text-center",children:[t.jsx(Or,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-400 mb-2",children:"No history for this season"}),t.jsx("p",{className:"text-gray-500 text-sm",children:"Download history will appear here after grabbing releases"})]})}),t.jsx("div",{className:"px-6 py-3 bg-gray-900/50 border-t border-red-900/30 flex justify-end",children:t.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors text-sm",children:"Close"})})]})})})})]}),z&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-orange-700 rounded-lg max-w-lg w-full p-6",children:[t.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[t.jsx(no,{className:"w-8 h-8 text-orange-400 flex-shrink-0"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold text-white",children:"Download Blocklisted Release?"}),t.jsx("p",{className:"text-orange-400 text-sm mt-1",children:"This release has been blocklisted"})]})]}),t.jsxs("div",{className:"bg-orange-900/20 border border-orange-600/30 rounded-lg p-4 mb-4",children:[t.jsx("p",{className:"text-white font-medium text-sm truncate mb-2",title:z.result.title,children:z.result.title}),z.result.blocklistReason&&t.jsxs("p",{className:"text-orange-300 text-sm",children:[t.jsx("span",{className:"text-gray-400",children:"Reason: "}),z.result.blocklistReason]})]}),t.jsx("p",{className:"text-gray-300 text-sm mb-6",children:"This release was previously blocklisted. Are you sure you want to download it anyway?"}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>D(null),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsxs("button",{onClick:()=>W(z.result,z.index),className:"px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg transition-colors flex items-center gap-2",children:[t.jsx(qs,{className:"w-4 h-4"}),"Download Anyway"]})]})]})}),te&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-700 rounded-lg max-w-lg w-full p-6",children:[t.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[t.jsx(cs,{className:"w-8 h-8 text-red-400 flex-shrink-0"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold text-white",children:"Mark as Failed?"}),t.jsx("p",{className:"text-red-400 text-sm mt-1",children:"This will blocklist the release"})]})]}),t.jsx("div",{className:"bg-red-900/20 border border-red-600/30 rounded-lg p-4 mb-4",children:t.jsx("p",{className:"text-white font-medium text-sm truncate",title:te.sourcePath,children:te.sourcePath})}),t.jsx("p",{className:"text-gray-300 text-sm mb-6",children:"This will add the release to the blocklist so it won't be downloaded again. Would you like to search for a replacement?"}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>le(null),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>G(te,!1),className:"px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded-lg transition-colors",children:"Blocklist Only"}),t.jsxs("button",{onClick:()=>G(te,!0),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors flex items-center gap-2",children:[t.jsx(Ks,{className:"w-4 h-4"}),"Blocklist & Search"]})]})]})})]})}const Td=a=>["Fighting","MMA","UFC","Boxing","Kickboxing","Wrestling"].some(s=>a.toLowerCase().includes(s.toLowerCase())),Bi=a=>["Motorsport","Racing","Formula 1","F1","NASCAR","IndyCar","MotoGP","WEC","Formula E","Rally","WRC","DTM","Super GT","IMSA","V8 Supercars","Supercars","Le Mans"].some(s=>a.toLowerCase().includes(s.toLowerCase())),bd=a=>Td(a)?["Early Prelims","Prelims","Main Card"]:[];function pj({league:a,isOpen:e,onClose:s,onAdd:r,isAdding:n,editMode:o=!1,leagueId:c}){const[d,f]=y.useState(new Set),[u,m]=y.useState(!1),[g,x]=y.useState("All"),[b,v]=y.useState(null),[w,S]=y.useState(!1),[T,k]=y.useState(!1),[E,R]=y.useState(new Set),[K,z]=y.useState(!1),[D,O]=y.useState(!0),[U,I]=y.useState(new Set),[F,te]=y.useState(!1),le=y.useRef(!1),H=y.useRef(!1),X=y.useRef(null),{data:q,isLoading:ae}=Cs({queryKey:["league-teams",a==null?void 0:a.idLeague],queryFn:async()=>{if(!(a!=null&&a.idLeague))return null;const He=await kt(`/api/leagues/external/${a.idLeague}/teams`);if(!He.ok)throw new Error("Failed to fetch teams");return He.json()},enabled:e&&!!a&&!Bi(a.strSport),staleTime:300*1e3}),ce=q||[],{data:ee=[]}=Cs({queryKey:["quality-profiles"],queryFn:async()=>{const He=await kt("/api/qualityprofile");if(!He.ok)throw new Error("Failed to fetch quality profiles");return He.json()},staleTime:300*1e3}),{data:W}=Cs({queryKey:["config"],queryFn:async()=>{const He=await kt("/api/config");if(!He.ok)throw new Error("Failed to fetch config");return He.json()}}),{data:V}=Cs({queryKey:["motorsport-session-types",a==null?void 0:a.strLeague],queryFn:async()=>{if(!(a!=null&&a.strLeague))return[];const He=await kt(`/api/motorsport/session-types?leagueName=${encodeURIComponent(a.strLeague)}`);if(!He.ok)throw new Error("Failed to fetch session types");return He.json()},enabled:e&&!!a&&Bi(a.strSport),staleTime:300*1e3}),G=V||[],Z=c==null?void 0:c.toString(),{data:oe}=Cs({queryKey:["league",Z],queryFn:async()=>{if(!c)return null;const He=await kt(`/api/leagues/${c}`);if(!He.ok)throw new Error("Failed to fetch league");return He.json()},enabled:e&&o&&!!c,refetchOnMount:"always"});y.useEffect(()=>{if(o&&e&&oe&&oe.monitoredTeams&&ce.length>0&&a&&!Bi(a.strSport)){if(le.current)return;le.current=!0;const He=oe.monitoredTeams.filter(Ce=>Ce.monitored&&Ce.team).map(Ce=>Ce.team.externalId);f(new Set(He)),m(He.length===ce.length)}},[o,e,oe,ce,a]),y.useEffect(()=>{if(o&&e&&oe&&(a!=null&&a.strSport)){const He=JSON.stringify({id:oe.id,monitorType:oe.monitorType,qualityProfileId:oe.qualityProfileId,monitoredParts:oe.monitoredParts,monitoredSessionTypes:oe.monitoredSessionTypes,searchForMissingEvents:oe.searchForMissingEvents,searchForCutoffUnmetEvents:oe.searchForCutoffUnmetEvents,availableSessionTypesCount:G.length});if(H.current&&X.current===He)return;if(H.current=!0,X.current=He,x(oe.monitorType||"All"),v(oe.qualityProfileId||null),S(oe.searchForMissingEvents||!1),k(oe.searchForCutoffUnmetEvents||!1),Td(a.strSport)){const Ce=bd(a.strSport);if(oe.monitoredParts===null||oe.monitoredParts===void 0)R(new Set(Ce)),z(!0);else if(oe.monitoredParts==="")R(new Set),z(!1);else{const _e=oe.monitoredParts.split(",").filter(ge=>ge.trim());R(new Set(_e)),z(_e.length===Ce.length)}}if(Bi(a.strSport)&&G.length>0)if(oe.monitoredSessionTypes===null||oe.monitoredSessionTypes===void 0)I(new Set(G)),te(!0);else if(oe.monitoredSessionTypes==="")I(new Set),te(!1);else{const Ce=oe.monitoredSessionTypes.split(",").filter(_e=>_e.trim());I(new Set(Ce)),te(Ce.length===G.length)}}},[o,e,oe,a==null?void 0:a.strSport,G]),y.useEffect(()=>{if(!o&&e&&(a!=null&&a.idLeague)){if(H.current)return;if(H.current=!0,f(new Set),m(!1),x("Future"),v(ee.length>0?ee[0].id:null),S(!1),k(!1),Td(a.strSport)){const He=bd(a.strSport);R(new Set(He)),z(He.length>0)}else R(new Set),z(!1);Bi(a.strSport)&&G.length>0?(I(new Set(G)),te(!0)):(I(new Set),te(!1))}},[a==null?void 0:a.idLeague,a==null?void 0:a.strSport,o,e,ee,G]),y.useEffect(()=>{e||(le.current=!1,H.current=!1,X.current=null)},[e]);const ye=He=>{f(Ce=>{const _e=new Set(Ce);return _e.has(He)?_e.delete(He):_e.add(He),_e})},je=()=>{u?(f(new Set),m(!1)):(f(new Set(ce.map(He=>He.idTeam))),m(!0))},xe=He=>{R(Ce=>{const _e=new Set(Ce);if(_e.has(He)?_e.delete(He):_e.add(He),a!=null&&a.strSport){const ge=bd(a.strSport);z(_e.size===ge.length)}return _e})},Ee=He=>{I(Ce=>{const _e=new Set(Ce);return _e.has(He)?_e.delete(He):_e.add(He),te(_e.size===G.length),_e})},Pe=()=>{F?(I(new Set),te(!1)):(I(new Set(G)),te(!0))},Re=()=>{if(!a)return;const He=Array.from(d),Ce=bd(a.strSport);let _e=null;W!=null&&W.enableMultiPartEpisodes&&Td(a.strSport)&&(E.size===Ce.length?_e=null:E.size===0?_e="":_e=Array.from(E).join(","));let ge=null;Bi(a.strSport)&&G.length>0&&(U.size===G.length?ge=null:U.size===0?ge="":ge=Array.from(U).join(",")),r(a,He,g,b,w,T,_e,D,ge)},Qe=d.size,ot=(a==null?void 0:a.strBadge)||(a==null?void 0:a.strLogo),ne=a?bd(a.strSport):[];E.size;const ke=U.size,Be=a?!Bi(a.strSport):!1,qe=(W==null?void 0:W.enableMultiPartEpisodes)&&a&&Td(a.strSport),dt=a&&Bi(a.strSport)&&G.length>0;return t.jsx(Bs,{appear:!0,show:e&&!!a,as:y.Fragment,unmount:!0,afterLeave:()=>{document.querySelectorAll("[inert]").forEach(He=>{He.removeAttribute("inert")})},children:t.jsxs(Xs,{as:"div",className:"relative z-50",onClose:s,children:[t.jsx(Bs.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t.jsx("div",{className:"fixed inset-0 bg-black/80"})}),t.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:t.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:t.jsx(Bs.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:t.jsxs(Xs.Panel,{className:"w-full max-w-4xl mx-2 md:mx-4 transform overflow-hidden rounded-lg bg-gradient-to-br from-gray-900 to-black border border-red-900/30 text-left align-middle shadow-xl transition-all",children:[t.jsx("div",{className:"border-b border-red-900/30 p-4 md:p-6",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3 md:gap-4 min-w-0 flex-1",children:[ot&&t.jsx("img",{src:ot,alt:(a==null?void 0:a.strLeague)||"League",className:"w-10 h-10 md:w-16 md:h-16 object-contain flex-shrink-0"}),t.jsxs("div",{className:"min-w-0",children:[t.jsxs(Xs.Title,{as:"h3",className:"text-lg md:text-2xl font-bold text-white truncate",children:[o?"Edit ":"Add ",(a==null?void 0:a.strLeague)||""]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-1",children:[t.jsx("span",{className:"px-2 py-0.5 md:py-1 bg-red-600/20 text-red-400 text-xs rounded font-medium",children:(a==null?void 0:a.strSport)||""}),(a==null?void 0:a.strCountry)&&t.jsx("span",{className:"text-xs md:text-sm text-gray-400",children:a.strCountry})]})]})]}),t.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white transition-colors flex-shrink-0 ml-2",children:t.jsx(qt,{className:"w-5 h-5 md:w-6 md:h-6"})})]})}),Be&&t.jsxs("div",{className:"p-4 md:p-6",children:[t.jsxs("div",{className:"mb-3 md:mb-4",children:[t.jsx("h4",{className:"text-base md:text-lg font-semibold text-white mb-1 md:mb-2",children:"Select Teams to Monitor"}),t.jsxs("p",{className:"text-xs md:text-sm text-gray-400",children:["Choose which teams you want to follow. Only events involving selected teams will be synced.",Qe===0&&t.jsx("span",{className:"text-yellow-500",children:" No teams selected = league will not be monitored."})]})]}),ae&&t.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mb-4"}),t.jsx("p",{className:"text-gray-400",children:"Loading teams..."})]}),!ae&&ce.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"mb-4 p-3 bg-black/50 rounded-lg border border-red-900/20",children:t.jsxs("button",{onClick:je,className:"flex items-center justify-between w-full text-left",children:[t.jsxs("span",{className:"font-medium text-white",children:[u?"Deselect All":"Select All"," (",ce.length," teams)"]}),t.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${u?"bg-red-600 border-red-600":"border-gray-600"}`,children:u&&t.jsx($a,{className:"w-4 h-4 text-white"})})]})}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-96 overflow-y-auto",children:ce.map(He=>{const Ce=d.has(He.idTeam);return t.jsxs("button",{onClick:()=>ye(He.idTeam),className:`flex items-center gap-3 p-3 rounded-lg border transition-all text-left ${Ce?"bg-red-600/20 border-red-600":"bg-black/30 border-gray-700 hover:border-gray-600"}`,children:[He.strTeamBadge&&t.jsx("img",{src:He.strTeamBadge,alt:He.strTeam,className:"w-10 h-10 object-contain"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium text-white",children:He.strTeam}),He.strTeamShort&&t.jsx("div",{className:"text-xs text-gray-400",children:He.strTeamShort})]}),t.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${Ce?"bg-red-600 border-red-600":"border-gray-600"}`,children:Ce&&t.jsx($a,{className:"w-4 h-4 text-white"})})]},He.idTeam)})})]}),!ae&&ce.length===0&&t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-400",children:"No teams found for this league. All events will be monitored."})})]}),dt&&t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("h4",{className:"text-lg font-semibold text-white mb-2",children:"Select Session Types to Monitor"}),t.jsxs("p",{className:"text-sm text-gray-400",children:["Choose which types of sessions you want to monitor. Each session is a separate event.",ke===0&&t.jsx("span",{className:"text-yellow-500",children:" No sessions selected = none will be monitored."})]})]}),t.jsx("div",{className:"mb-4 p-3 bg-black/50 rounded-lg border border-red-900/20",children:t.jsxs("button",{onClick:Pe,className:"flex items-center justify-between w-full text-left",children:[t.jsxs("span",{className:"font-medium text-white",children:[F?"Deselect All":"Select All"," (",G.length," session types)"]}),t.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${F?"bg-red-600 border-red-600":"border-gray-600"}`,children:F&&t.jsx($a,{className:"w-4 h-4 text-white"})})]})}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:G.map(He=>{const Ce=U.has(He);return t.jsxs("button",{onClick:()=>Ee(He),className:`flex items-center gap-3 p-3 rounded-lg border transition-all text-left ${Ce?"bg-red-600/20 border-red-600":"bg-black/30 border-gray-700 hover:border-gray-600"}`,children:[t.jsx("div",{className:"flex-1",children:t.jsx("div",{className:"font-medium text-white",children:He})}),t.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${Ce?"bg-red-600 border-red-600":"border-gray-600"}`,children:Ce&&t.jsx($a,{className:"w-4 h-4 text-white"})})]},He)})})]}),t.jsxs("div",{className:"px-6 pb-6 border-t border-red-900/20 pt-6",children:[t.jsx("h4",{className:"text-lg font-semibold text-white mb-4",children:"Monitoring Options"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Monitor Events"}),t.jsxs("select",{value:g,onChange:He=>x(He.target.value),className:"w-full px-3 py-2 bg-black border border-red-900/30 rounded-lg text-white focus:outline-none focus:border-red-600 focus:ring-1 focus:ring-red-600",children:[t.jsx("option",{value:"All",children:"All Events (past, present, and future)"}),t.jsx("option",{value:"Future",children:"Future Events (events that haven't occurred yet)"}),t.jsx("option",{value:"CurrentSeason",children:"Current Season Only"}),t.jsx("option",{value:"LatestSeason",children:"Latest Season Only"}),t.jsx("option",{value:"NextSeason",children:"Next Season Only"}),t.jsx("option",{value:"Recent",children:"Recent Events (last 30 days)"}),t.jsx("option",{value:"None",children:"None (manual monitoring only)"})]})]}),qe&&t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Monitor Parts"}),t.jsx("div",{className:"space-y-2",children:ne.map(He=>t.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:E.has(He),onChange:()=>xe(He),className:"w-5 h-5 bg-black border-2 border-gray-600 rounded text-red-600 focus:ring-red-600 focus:ring-offset-0 focus:ring-2"}),t.jsx("span",{className:"text-sm text-white",children:He})]},He))}),t.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Select which parts of fight cards to monitor. Unselected parts will not be searched.",o&&" Changes will apply to all existing events in this league."]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Quality Profile"}),t.jsxs("select",{value:b||"",onChange:He=>v(He.target.value?parseInt(He.target.value):null),className:"w-full px-3 py-2 bg-black border border-red-900/30 rounded-lg text-white focus:outline-none focus:border-red-600 focus:ring-1 focus:ring-red-600",children:[t.jsx("option",{value:"",children:"No Quality Profile"}),ee.map(He=>t.jsx("option",{value:He.id,children:He.name},He.id))]}),o&&t.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Changes will apply to all events in this league."})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:w,onChange:He=>S(He.target.checked),className:"w-5 h-5 bg-black border-2 border-gray-600 rounded text-red-600 focus:ring-red-600 focus:ring-offset-0 focus:ring-2"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-white",children:"Search on add/update"}),t.jsx("div",{className:"text-xs text-gray-400",children:"Automatically search when league is added or settings change"})]})]}),t.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:T,onChange:He=>k(He.target.checked),className:"w-5 h-5 bg-black border-2 border-gray-600 rounded text-red-600 focus:ring-red-600 focus:ring-offset-0 focus:ring-2"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-white",children:"Search for upgrades on add/update"}),t.jsx("div",{className:"text-xs text-gray-400",children:"Search for quality upgrades when league is added or settings change"})]})]})]})]}),t.jsx("div",{className:"border-t border-red-900/30 p-6 bg-black/30",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"text-sm text-gray-400",children:dt?ke>0?t.jsxs("span",{children:[t.jsx("span",{className:"font-semibold text-white",children:ke})," session type",ke!==1?"s":""," selected"]}):t.jsx("span",{className:"text-yellow-500",children:"No session types selected - no events will be monitored"}):Be?Qe>0?t.jsxs("span",{children:[t.jsx("span",{className:"font-semibold text-white",children:Qe})," team",Qe!==1?"s":""," selected"]}):t.jsx("span",{className:"text-yellow-500",children:"No teams selected - league will not be monitored"}):t.jsx("span",{children:"All events will be monitored"})}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:s,disabled:n,className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),t.jsx("button",{onClick:Re,disabled:n||Be&&ae,className:"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:n?o?"Updating...":"Adding...":o?"Update":"Add to Library"})]})]})})]})})})})]})})}function xj({isOpen:a,onClose:e,onConfirm:s,title:r="",message:n="",confirmText:o="Confirm",confirmButtonClass:c="bg-red-600 hover:bg-red-700",isLoading:d=!1}){const f=!!r||!!n;return t.jsx(Bs,{appear:!0,show:a&&f,as:y.Fragment,unmount:!0,afterLeave:()=>{document.querySelectorAll("[inert]").forEach(u=>{u.removeAttribute("inert")})},children:t.jsxs(Xs,{as:"div",className:"relative z-50",onClose:e,children:[t.jsx(Bs.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t.jsx("div",{className:"fixed inset-0 bg-black/80"})}),t.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:t.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:t.jsx(Bs.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:t.jsxs(Xs.Panel,{className:"w-full max-w-md mx-4 transform overflow-hidden rounded-lg bg-gradient-to-br from-gray-900 to-black border border-red-900/30 text-left align-middle shadow-xl transition-all",children:[t.jsx("div",{className:"p-4 md:p-6",children:t.jsxs("div",{className:"flex items-start gap-3 md:gap-4",children:[t.jsx("div",{className:"flex-shrink-0 w-10 h-10 md:w-12 md:h-12 rounded-full bg-red-600/20 flex items-center justify-center",children:t.jsx(Pr,{className:"w-5 h-5 md:w-6 md:h-6 text-red-400"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx(Xs.Title,{as:"h3",className:"text-base md:text-lg font-bold text-white mb-1 md:mb-2",children:r}),t.jsx("p",{className:"text-xs md:text-sm text-gray-400",children:n})]})]})}),t.jsxs("div",{className:"border-t border-red-900/30 p-3 md:p-4 bg-black/30 flex gap-2 md:gap-3 justify-end",children:[t.jsx("button",{onClick:e,disabled:d,className:"px-3 md:px-4 py-1.5 md:py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg text-sm md:text-base font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),t.jsx("button",{onClick:s,disabled:d,className:`px-3 md:px-4 py-1.5 md:py-2 text-white rounded-lg text-sm md:text-base font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${c}`,children:d?"Processing...":o})]})]})})})})]})})}function GS(a){if(a===0)return"0 B";const e=1024,s=["B","KB","MB","GB","TB"],r=Math.floor(Math.log(a)/Math.log(e));return parseFloat((a/Math.pow(e,r)).toFixed(2))+" "+s[r]}function eI(a){return new Date(a).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function tI({isOpen:a,onClose:e,eventId:s,eventTitle:r,files:n,leagueId:o,isFightingSport:c=!1}){const d=ca(),[f,u]=y.useState(n),[m,g]=y.useState(null),[x,b]=y.useState("none"),[v,w]=y.useState(!1);y.useEffect(()=>{u(n)},[n]);const S=dr({mutationFn:async({fileId:D,blocklistAction:O})=>({data:(await at.delete(`/events/${s}/files/${D}`,{params:{blocklistAction:O}})).data,fileId:D}),onSuccess:async({data:D,fileId:O})=>{const U=m==null?void 0:m.blocklistAction;let I="File deleted";U==="blocklistAndSearch"?I="File deleted, release blocklisted, searching for replacement...":U==="blocklistOnly"&&(I="File deleted and release blocklisted"),be.success(I),g(null),u(F=>F.filter(te=>te.id!==O)),o&&(await d.refetchQueries({queryKey:["league-events",o]}),await d.refetchQueries({queryKey:["league",o]})),await d.refetchQueries({queryKey:["leagues"]}),D.eventHasFiles||e()},onError:D=>{var O,U;be.error(((U=(O=D.response)==null?void 0:O.data)==null?void 0:U.detail)||"Failed to delete file")}}),T=dr({mutationFn:async D=>(await at.delete(`/events/${s}/files`,{params:{blocklistAction:D}})).data,onSuccess:async D=>{let O="All files deleted";x==="blocklistAndSearch"?O="All files deleted, releases blocklisted, searching for replacements...":x==="blocklistOnly"&&(O="All files deleted and releases blocklisted"),be.success(O),w(!1),u([]),o&&(await d.refetchQueries({queryKey:["league-events",o]}),await d.refetchQueries({queryKey:["league",o]})),await d.refetchQueries({queryKey:["leagues"]}),e()},onError:D=>{var O,U;be.error(((U=(O=D.response)==null?void 0:O.data)==null?void 0:U.detail)||"Failed to delete files")}}),k=f.filter(D=>D.exists),E=k.reduce((D,O)=>D+O.size,0),R=()=>{m&&S.mutate({fileId:m.file.id,blocklistAction:m.blocklistAction})},K=()=>{T.mutate(x)},z=D=>{g({file:D,blocklistAction:"none"})};return t.jsxs(t.Fragment,{children:[t.jsx(Bs,{appear:!0,show:a,as:y.Fragment,unmount:!0,afterLeave:()=>{document.querySelectorAll("[inert]").forEach(D=>{D.removeAttribute("inert")}),g(null),w(!1),b("none")},children:t.jsxs(Xs,{as:"div",className:"relative z-50",onClose:()=>{!m&&!v&&e()},children:[t.jsx(Bs.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t.jsx("div",{className:"fixed inset-0 bg-black/80"})}),t.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:t.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:t.jsx(Bs.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:t.jsxs(Xs.Panel,{className:"w-full max-w-2xl mx-2 md:mx-4 transform overflow-hidden rounded-lg bg-gray-900 text-left align-middle shadow-xl transition-all border border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 md:p-4 border-b border-gray-700",children:[t.jsxs("div",{className:"min-w-0 flex-1 mr-2",children:[t.jsx(Xs.Title,{className:"text-base md:text-lg font-medium text-white",children:"Event Files"}),t.jsx("p",{className:"text-xs md:text-sm text-gray-400 mt-1 truncate",children:r})]}),t.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors flex-shrink-0",children:t.jsx(qt,{className:"w-5 h-5 md:w-6 md:h-6"})})]}),t.jsx("div",{className:"p-3 md:p-4 bg-gray-800/50 border-b border-gray-700",children:t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[t.jsxs("div",{className:"flex items-center gap-3 md:gap-4",children:[t.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2 text-gray-300 text-sm",children:[t.jsx(En,{className:"w-4 h-4 md:w-5 md:h-5"}),t.jsxs("span",{children:[k.length," file",k.length!==1?"s":""]})]}),t.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2 text-gray-300 text-sm",children:[t.jsx(Kr,{className:"w-4 h-4 md:w-5 md:h-5"}),t.jsx("span",{children:GS(E)})]})]}),k.length>1&&t.jsxs("button",{onClick:()=>{b("none"),w(!0)},disabled:T.isPending||S.isPending,className:"px-2 md:px-3 py-1 md:py-1.5 bg-red-600 hover:bg-red-700 disabled:bg-red-600/50 text-white text-xs md:text-sm font-medium rounded transition-colors flex items-center gap-1.5 md:gap-2",children:[t.jsx(cs,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),"Delete All"]})]})}),t.jsx("div",{className:"p-4 max-h-96 overflow-y-auto",children:k.length===0?t.jsx("div",{className:"text-center py-8 text-gray-400",children:"No files found for this event"}):t.jsx("div",{className:"space-y-3",children:k.map(D=>t.jsx("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[c&&D.partName&&t.jsx("div",{className:"text-sm font-medium text-red-400 mb-1",children:D.partName}),t.jsx("div",{className:"text-sm text-gray-200 font-mono truncate",title:D.filePath,children:D.filePath.split(/[/\\]/).pop()}),t.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 mt-2 text-xs text-gray-400",children:[t.jsx("span",{children:GS(D.size)}),D.quality&&t.jsx("span",{className:"px-2 py-0.5 bg-blue-600/20 text-blue-400 rounded",children:D.quality}),D.customFormatScore!==void 0&&D.customFormatScore!==0&&t.jsxs("span",{className:"px-2 py-0.5 bg-purple-600/20 text-purple-400 rounded",title:"Custom Format Score - Higher is better",children:["CF Score: ",D.customFormatScore]}),t.jsxs("span",{children:["Added: ",eI(D.added)]})]}),D.originalTitle&&t.jsxs("details",{className:"mt-2",children:[t.jsx("summary",{className:"text-xs text-gray-500 cursor-pointer hover:text-gray-400",children:"Original grabbed title"}),t.jsx("div",{className:"mt-1 p-2 bg-yellow-900/20 border border-yellow-600/30 rounded text-xs text-yellow-300 font-mono break-all",children:D.originalTitle})]}),t.jsxs("details",{className:"mt-2",children:[t.jsx("summary",{className:"text-xs text-gray-500 cursor-pointer hover:text-gray-400",children:"Full path"}),t.jsx("div",{className:"mt-1 p-2 bg-gray-900 rounded text-xs text-gray-400 font-mono break-all",children:D.filePath})]})]}),t.jsx("button",{onClick:()=>z(D),disabled:S.isPending||T.isPending,className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-600/10 rounded transition-colors disabled:opacity-50",title:"Delete file",children:t.jsx(cs,{className:"w-5 h-5"})})]})},D.id))})}),t.jsx("div",{className:"flex justify-end gap-3 p-4 border-t border-gray-700 bg-gray-800/50",children:t.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded transition-colors",children:"Close"})})]})})})})]})}),m&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",onClick:D=>{D.stopPropagation(),D.target===D.currentTarget&&g(null)},children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-700 rounded-lg max-w-lg w-full p-6",onClick:D=>D.stopPropagation(),children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsx("h3",{className:"text-xl font-bold text-white",children:"Delete File"}),t.jsx("button",{onClick:()=>g(null),className:"text-gray-400 hover:text-white transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsx("p",{className:"text-gray-300 mb-2",children:"Are you sure you want to delete this file?"}),m.file.partName&&t.jsxs("p",{className:"text-red-400 text-sm mb-2",children:["Part: ",m.file.partName]}),t.jsx("p",{className:"text-gray-400 text-sm font-mono mb-6 break-all",children:m.file.filePath.split(/[/\\]/).pop()}),t.jsxs("div",{className:"mb-6",children:[t.jsx("label",{className:"block text-gray-300 font-medium mb-2",children:"Blocklist Release"}),t.jsxs("select",{value:m.blocklistAction,onChange:D=>g({...m,blocklistAction:D.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600",children:[t.jsx("option",{value:"none",children:"Do not Blocklist"}),t.jsx("option",{value:"blocklistAndSearch",children:"Blocklist and Search for Replacement"}),t.jsx("option",{value:"blocklistOnly",children:"Blocklist Only"})]}),t.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:[m.blocklistAction==="none"&&"The release will remain eligible for future searches",m.blocklistAction==="blocklistAndSearch"&&"Blocklist this release and automatically search for a replacement",m.blocklistAction==="blocklistOnly"&&"Blocklist this release without searching for a replacement"]})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>g(null),className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:R,disabled:S.isPending,className:"px-6 py-2 bg-red-600 hover:bg-red-700 disabled:bg-red-600/50 text-white rounded-lg transition-colors",children:S.isPending?"Deleting...":"Delete"})]})]})}),v&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] p-4",onClick:D=>{D.stopPropagation(),D.target===D.currentTarget&&w(!1)},children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-700 rounded-lg max-w-lg w-full p-6",onClick:D=>D.stopPropagation(),children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsx("h3",{className:"text-xl font-bold text-white",children:"Delete All Files"}),t.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-white transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsxs("p",{className:"text-gray-300 mb-2",children:["Are you sure you want to delete ALL ",k.length," files for this event?"]}),t.jsx("p",{className:"text-red-400 text-sm mb-6",children:"This action cannot be undone."}),t.jsxs("div",{className:"mb-6",children:[t.jsx("label",{className:"block text-gray-300 font-medium mb-2",children:"Blocklist Releases"}),t.jsxs("select",{value:x,onChange:D=>b(D.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600",children:[t.jsx("option",{value:"none",children:"Do not Blocklist"}),t.jsx("option",{value:"blocklistAndSearch",children:"Blocklist All and Search for Replacements"}),t.jsx("option",{value:"blocklistOnly",children:"Blocklist All Only"})]}),t.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:[x==="none"&&"Releases will remain eligible for future searches",x==="blocklistAndSearch"&&"Blocklist all releases and automatically search for replacements",x==="blocklistOnly"&&"Blocklist all releases without searching for replacements"]})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>w(!1),className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:K,disabled:T.isPending,className:"px-6 py-2 bg-red-600 hover:bg-red-700 disabled:bg-red-600/50 text-white rounded-lg transition-colors",children:T.isPending?"Deleting...":"Delete All"})]})]})})]})}function Dp(a){if(a===0)return"0 B";const e=1024,s=["B","KB","MB","GB","TB"],r=Math.floor(Math.log(a)/Math.log(e));return parseFloat((a/Math.pow(e,r)).toFixed(2))+" "+s[r]}function sI(a){return new Date(a).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function rI({isOpen:a,onClose:e,leagueId:s,leagueName:r,season:n}){const o=ca(),[c,d]=y.useState(new Set),[f,u]=y.useState(new Set);y.useEffect(()=>{a||u(new Set)},[a]);const{data:m,isLoading:g}=Cs({queryKey:n?["league-season-files",s,n]:["league-files",s],queryFn:async()=>{const k=n?`/leagues/${s}/seasons/${encodeURIComponent(n)}/files`:`/leagues/${s}/files`;return(await at.get(k)).data},enabled:a&&!!s}),x=(m==null?void 0:m.files.filter(k=>!f.has(k.id)))||[],b=dr({mutationFn:async({eventId:k,fileId:E})=>({data:(await at.delete(`/events/${k}/files/${E}`)).data,fileId:E}),onSuccess:async({fileId:k})=>{be.success("File deleted"),u(E=>new Set(E).add(k)),n?await o.refetchQueries({queryKey:["league-season-files",s,n]}):await o.refetchQueries({queryKey:["league-files",s]}),await o.refetchQueries({queryKey:["league-events",s.toString()]}),await o.refetchQueries({queryKey:["league",s.toString()]}),await o.refetchQueries({queryKey:["leagues"]})},onError:k=>{var E,R;be.error(((R=(E=k.response)==null?void 0:E.data)==null?void 0:R.detail)||"Failed to delete file")}}),v=x.reduce((k,E)=>{const R=E.season||"Unknown";return k[R]||(k[R]=[]),k[R].push(E),k},{}),w=Object.keys(v).sort((k,E)=>{const R=parseInt(k.replace(/\D/g,""))||0;return(parseInt(E.replace(/\D/g,""))||0)-R}),S=k=>{d(E=>{const R=new Set(E);return R.has(k)?R.delete(k):R.add(k),R})},T=n?`${r} - ${n} Files`:`${r} - All Files`;return t.jsx(Bs,{appear:!0,show:a,as:y.Fragment,unmount:!0,afterLeave:()=>{document.querySelectorAll("[inert]").forEach(k=>{k.removeAttribute("inert")}),d(new Set)},children:t.jsxs(Xs,{as:"div",className:"relative z-50",onClose:e,children:[t.jsx(Bs.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t.jsx("div",{className:"fixed inset-0 bg-black/80"})}),t.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:t.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:t.jsx(Bs.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:t.jsxs(Xs.Panel,{className:"w-full max-w-4xl transform overflow-hidden rounded-lg bg-gray-900 text-left align-middle shadow-xl transition-all border border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[t.jsxs("div",{children:[t.jsx(Xs.Title,{className:"text-lg font-medium text-white",children:T}),m&&t.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[x.length," file",x.length!==1?"s":"","  ",Dp(x.reduce((k,E)=>k+E.size,0))]})]}),t.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsx("div",{className:"max-h-[70vh] overflow-y-auto",children:g?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-red-500"})}):x.length===0?t.jsxs("div",{className:"text-center py-12 text-gray-400",children:[t.jsx(Kr,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No files found"})]}):n?t.jsx("div",{className:"p-4 space-y-2",children:x.map(k=>t.jsx(HS,{file:k,onDelete:()=>b.mutate({eventId:k.eventId,fileId:k.id}),isDeleting:b.isPending,showEventInfo:!0},k.id))}):t.jsx("div",{className:"divide-y divide-gray-700",children:w.map(k=>{const E=v[k],R=E.reduce((z,D)=>z+D.size,0),K=c.has(k);return t.jsxs("div",{children:[t.jsxs("button",{onClick:()=>S(k),className:"w-full flex items-center justify-between p-4 hover:bg-gray-800/50 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[K?t.jsx(As,{className:"w-5 h-5 text-gray-400"}):t.jsx(_c,{className:"w-5 h-5 text-gray-400"}),t.jsx("span",{className:"text-white font-medium",children:k}),t.jsxs("span",{className:"text-sm text-gray-400",children:[E.length," file",E.length!==1?"s":""]})]}),t.jsx("span",{className:"text-sm text-gray-400",children:Dp(R)})]}),K&&t.jsx("div",{className:"px-4 pb-4 space-y-2",children:E.map(z=>t.jsx(HS,{file:z,onDelete:()=>b.mutate({eventId:z.eventId,fileId:z.id}),isDeleting:b.isPending,showEventInfo:!0},z.id))})]},k)})})}),t.jsx("div",{className:"flex justify-end gap-3 p-4 border-t border-gray-700 bg-gray-800/50",children:t.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded transition-colors",children:"Close"})})]})})})})]})})}function HS({file:a,onDelete:e,isDeleting:s,showEventInfo:r}){return t.jsx("div",{className:"bg-gray-800 rounded-lg p-3 border border-gray-700",children:t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[r&&t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("span",{className:"text-sm font-medium text-white truncate",children:a.eventTitle}),t.jsx("span",{className:"text-xs text-gray-500",children:sI(a.eventDate)})]}),a.partName&&t.jsx("div",{className:"text-xs font-medium text-red-400 mb-1",children:a.partName}),t.jsxs("div",{className:"text-sm text-gray-300 font-mono truncate",title:a.filePath,children:[t.jsx(En,{className:"w-4 h-4 inline mr-1.5 text-gray-500"}),a.fileName]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1 mt-1.5 text-xs text-gray-400",children:[t.jsx("span",{children:Dp(a.size)}),a.quality&&t.jsx("span",{className:"px-1.5 py-0.5 bg-blue-600/20 text-blue-400 rounded",children:a.quality}),a.customFormatScore!==void 0&&a.customFormatScore!==0&&t.jsxs("span",{className:"px-1.5 py-0.5 bg-purple-600/20 text-purple-400 rounded",title:"Custom Format Score - Higher is better",children:["CF Score: ",a.customFormatScore]})]})]}),t.jsx("button",{onClick:()=>{confirm(`Delete "${a.fileName}"? This action cannot be undone.`)&&e()},disabled:s,className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-600/10 rounded transition-colors disabled:opacity-50 flex-shrink-0",title:"Delete file",children:t.jsx(cs,{className:"w-5 h-5"})})]})})}function aI(a,e,s,r){const n=c=>c.eventId!==a?!1:e?c.part===e:!c.part,o=c=>c.eventId!==a?!1:e?c.part===e:!c.part;return{activeSearch:s==null?void 0:s.activeSearches.find(n),pendingSearch:s==null?void 0:s.pendingSearches.find(n),recentSearch:s==null?void 0:s.recentlyCompleted.find(n),downloadItem:r==null?void 0:r.find(o)}}const VS=y.memo(function({eventId:e,part:s,searchQueue:r,downloadQueue:n}){const o=y.useMemo(()=>aI(e,s,r,n),[e,s,r,n]),c=y.useMemo(()=>{const{activeSearch:f,pendingSearch:u,recentSearch:m,downloadItem:g}=o;if(f)return{type:"searching",label:"Searching",message:f.message,releasesFound:f.releasesFound,accentColor:"bg-blue-500",bgColor:"bg-blue-900/30",textColor:"text-blue-400",icon:Ks,animate:!0};if(u)return{type:"queued",label:"Queued",message:"Waiting to search...",accentColor:"bg-gray-500",bgColor:"bg-gray-800/50",textColor:"text-gray-400",icon:yf};if(m){const x=m.completedAt?new Date(m.completedAt).getTime():0;if(Date.now()-x<3e3){if(m.success)return{type:"completed",label:"Found",message:m.selectedRelease||`${m.releasesFound} releases`,quality:m.quality||void 0,accentColor:"bg-green-500",bgColor:"bg-green-900/30",textColor:"text-green-400",icon:rs};if(m.status==="NoResults")return{type:"noResults",label:"No Results",message:"No matching releases found",accentColor:"bg-yellow-500",bgColor:"bg-yellow-900/30",textColor:"text-yellow-400",icon:Ss};if(m.status==="Failed")return{type:"failed",label:"Failed",message:m.message||"Search failed",accentColor:"bg-red-500",bgColor:"bg-red-900/30",textColor:"text-red-400",icon:Ss}}}if(g)switch(g.status){case 0:return{type:"grabbed",label:"Grabbed",message:"Sent to download client",quality:g.quality,accentColor:"bg-blue-500",bgColor:"bg-blue-900/30",textColor:"text-blue-400",icon:qs};case 1:return{type:"downloading",label:"Downloading",message:g.progress>0?`${Math.round(g.progress)}%`:"In progress...",quality:g.quality,progress:g.progress,accentColor:"bg-blue-500",bgColor:"bg-blue-900/30",textColor:"text-blue-400",icon:qs,animate:!0};case 2:return{type:"downloading",label:"Paused",message:"Download paused",quality:g.quality,progress:g.progress,accentColor:"bg-yellow-500",bgColor:"bg-yellow-900/30",textColor:"text-yellow-400",icon:$r};case 6:return{type:"importing",label:"Importing",message:"Importing to library...",quality:g.quality,accentColor:"bg-yellow-500",bgColor:"bg-yellow-900/30",textColor:"text-yellow-400",icon:Dt,animate:!0};case 7:return{type:"imported",label:"Imported",message:"Successfully imported",quality:g.quality,accentColor:"bg-green-500",bgColor:"bg-green-900/30",textColor:"text-green-400",icon:rs};case 4:return{type:"failed",label:"Failed",message:"Download failed",accentColor:"bg-red-500",bgColor:"bg-red-900/30",textColor:"text-red-400",icon:Ss};case 5:return{type:"failed",label:"Warning",message:"Download warning",accentColor:"bg-yellow-500",bgColor:"bg-yellow-900/30",textColor:"text-yellow-400",icon:Ss}}return null},[o]);if(!c)return null;const d=c.icon;return t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("div",{className:`relative px-2.5 py-1 rounded ${c.bgColor} overflow-hidden`,children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx(d,{className:`w-3.5 h-3.5 ${c.textColor} ${c.animate?"animate-pulse":""}`}),t.jsx("span",{className:`text-xs font-medium ${c.textColor}`,children:c.label}),c.quality&&t.jsxs("span",{className:"text-xs text-gray-400",children:["(",c.quality,")"]}),c.releasesFound!==void 0&&c.releasesFound>0&&t.jsxs("span",{className:"text-xs text-green-400",children:[" ",c.releasesFound," found"]})]}),t.jsxs("div",{className:`absolute bottom-0 left-0 right-0 h-0.5 ${c.accentColor}`,children:[c.type==="downloading"&&c.progress!==void 0&&c.progress>0&&t.jsx("div",{className:"absolute inset-0 bg-black/50",style:{left:`${Math.min(100,c.progress)}%`,right:0}}),c.animate&&t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-shimmer"})]})]})})});function nI(a,e){if(!e.trim())return!0;const s=a.toLowerCase(),r=e.toLowerCase().trim();if(s.includes(r))return!0;const n=r.split(/\s+/).filter(d=>d.length>0);if(n.length===0||n.every(d=>d.length>=2?s.includes(d):!0))return!0;let c=0;for(let d=0;d<s.length&&c<r.length;d++)s[d]===r[c]&&c++;return c>=r.length*.7}function iI(){var Fe,mt;const{id:a}=NC(),e=Ta();Ea();const s=ca(),{timezone:r}=Zf(),[n,o]=y.useState({isOpen:!1,eventId:0,eventTitle:""}),[c,d]=y.useState({isOpen:!1,eventId:0,eventTitle:"",files:[],isFightingSport:!1}),[f,u]=y.useState({isOpen:!1}),[m,g]=y.useState({isOpen:!1,season:""}),[x,b]=y.useState(!1),[v,w]=y.useState(!1),S=y.useRef(null),T=y.useRef(null),[k,E]=y.useState(new Set),[R,K]=y.useState(""),{data:z}=Cs({queryKey:["config"],queryFn:async()=>(await at.get("/config")).data}),{data:D,isLoading:O,error:U}=Cs({queryKey:["league",a],queryFn:async()=>(await at.get(`/leagues/${a}`)).data}),{data:I=[],isLoading:F}=Cs({queryKey:["league-events",a],queryFn:async()=>(await at.get(`/leagues/${a}/events`)).data,enabled:!!a,refetchInterval:Se=>{const st=Se.state.data;return!st||st.length===0?3e3:!1}}),{data:te=[]}=Cs({queryKey:["quality-profiles"],queryFn:async()=>(await at.get("/qualityprofile")).data}),{data:le=!1}=Cs({queryKey:["iptv-sources-exist"],queryFn:async()=>{const Se=await at.get("/iptv/sources");return Array.isArray(Se.data)&&Se.data.length>0},staleTime:6e4}),{data:H=[],isLoading:X}=Cs({queryKey:["dvr-channels",a],queryFn:async()=>(await at.get(`/iptv/leagues/${a}/channels-by-quality`)).data,enabled:!!a&&le}),q=y.useMemo(()=>H.filter(Se=>nI(Se.channel.name,R)),[H,R]),{data:ae}=RN(),{data:ce}=Mk(),[ee,W]=y.useState([]),[V,G]=y.useState(!1),[Z,oe]=y.useState(new Set),ye=y.useRef(void 0),je=y.useMemo(()=>(Se,st)=>{var wt,yt;if(ee.some(Mt=>Mt.eventId===Se&&Mt.part===st))return"queued";if(ae){const Mt=Ke=>Ke.eventId!==Se?!1:st?Ke.part===st:!Ke.part;if((wt=ae.activeSearches)!=null&&wt.some(Mt))return"searching";if((yt=ae.pendingSearches)!=null&&yt.some(Mt))return"queued"}return"idle"},[ee,ae]);y.useEffect(()=>{const Se=setInterval(()=>{const st=Date.now();W(wt=>wt.filter(yt=>{var Mt,Ke;if(st-yt.queuedAt>1e4)return!1;if(ae){const Vt=Kt=>Kt.eventId!==yt.eventId?!1:yt.part?Kt.part===yt.part:!Kt.part,Nt=(Mt=ae.pendingSearches)==null?void 0:Mt.some(Vt),St=(Ke=ae.activeSearches)==null?void 0:Ke.some(Vt);if(Nt||St)return!1}return!0}))},1e3);return()=>clearInterval(Se)},[ae]),y.useEffect(()=>{if(!ce||!ye.current){ye.current=ce;return}const Se=ye.current,st=ce,wt=Se.filter(Ke=>(Ke.status===6||Ke.status===7)&&!st.some(Nt=>Nt.id===Ke.id)),yt=st.filter(Ke=>{if(Ke.status===7){const Vt=Se.find(Nt=>Nt.id===Ke.id);if(!Vt||Vt.status!==7)return!0}return!1});[...wt,...yt].length>0&&a&&setTimeout(()=>{s.refetchQueries({queryKey:["league-events",a]}),s.refetchQueries({queryKey:["league",a]})},500),ye.current=ce},[ce,a,s]);const xe=dr({mutationFn:async({eventId:Se,monitored:st,monitoredParts:wt})=>(await at.put(`/events/${Se}`,{monitored:st,monitoredParts:st?wt:null})).data,onSuccess:async()=>{await s.refetchQueries({queryKey:["league-events",a]}),await s.refetchQueries({queryKey:["league",a]}),await s.refetchQueries({queryKey:["leagues"]}),be.success("Event updated")},onError:()=>{be.error("Failed to update event")}}),Ee=dr({mutationFn:async({eventId:Se,qualityProfileId:st})=>(await at.put(`/events/${Se}`,{qualityProfileId:st})).data,onSuccess:async()=>{await s.refetchQueries({queryKey:["league-events",a]}),be.success("Quality profile updated")},onError:()=>{be.error("Failed to update quality profile")}}),Pe=dr({mutationFn:async Se=>(await at.post(`/iptv/leagues/${a}/preferred-channel`,{channelId:Se})).data,onSuccess:async Se=>{await s.refetchQueries({queryKey:["dvr-channels",a]}),be.success(Se.message||"Preferred channel updated")},onError:()=>{be.error("Failed to update preferred channel")}}),Re=dr({mutationFn:async Se=>(await at.put(`/leagues/${a}`,{monitored:Se})).data,onSuccess:async()=>{await s.refetchQueries({queryKey:["league",a]}),await s.refetchQueries({queryKey:["league-events",a]}),await s.refetchQueries({queryKey:["leagues"]}),be.success("League monitoring updated")},onError:()=>{be.error("Failed to update league monitoring")}}),Qe=Se=>["Motorsport","Racing","Formula 1","F1","NASCAR","IndyCar","MotoGP","WEC","Formula E","Rally","WRC","DTM","Super GT","IMSA","V8 Supercars","Supercars","Le Mans"].some(wt=>Se.toLowerCase().includes(wt.toLowerCase())),ot=dr({mutationFn:async Se=>{const st=D!=null&&D.sport?Qe(D.sport):!1,wt={...Se};delete wt.monitoredTeamIds,Se.monitoredTeamIds!==void 0&&(wt.monitored=st?!0:Se.monitoredTeamIds.length>0);const yt=await at.put(`/leagues/${a}`,wt);return!st&&Se.monitoredTeamIds!==void 0&&await at.put(`/leagues/${a}/teams`,{monitoredTeamIds:Se.monitoredTeamIds.length>0?Se.monitoredTeamIds:null}),yt.data},onSuccess:async(Se,st)=>{await s.refetchQueries({queryKey:["league",a]}),await s.refetchQueries({queryKey:["league-events",a]}),await s.refetchQueries({queryKey:["leagues"]}),st.monitoredTeamIds!==void 0&&(Ce(),be.success("League settings updated"))},onError:()=>{be.error("Failed to update league settings"),s.invalidateQueries({queryKey:["league",a]})}}),ne=dr({mutationFn:async()=>(await at.delete(`/leagues/${a}`,{params:{deleteFiles:!1}})).data,onSuccess:async()=>{be.success("League deleted successfully"),await s.invalidateQueries({queryKey:["leagues"]}),e("/leagues")},onError:Se=>{var wt,yt;const st=((yt=(wt=Se.response)==null?void 0:wt.data)==null?void 0:yt.error)||"Failed to delete league";be.error(st)}}),ke=dr({mutationFn:async({eventId:Se,monitoredParts:st})=>(await at.put(`/events/${Se}/parts`,{monitoredParts:st})).data,onSuccess:async()=>{await s.refetchQueries({queryKey:["league-events",a]}),await s.refetchQueries({queryKey:["league",a]}),be.success("Event parts updated")},onError:()=>{be.error("Failed to update event parts")}}),Be=dr({mutationFn:async({eventId:Se,fileId:st})=>(await at.delete(`/events/${Se}/files/${st}`)).data,onSuccess:async Se=>{await s.refetchQueries({queryKey:["league-events",a]}),await s.refetchQueries({queryKey:["league",a]}),await s.refetchQueries({queryKey:["leagues"]}),be.success(Se.message||"File deleted")},onError:Se=>{var st,wt;be.error(((wt=(st=Se.response)==null?void 0:st.data)==null?void 0:wt.detail)||"Failed to delete file")}}),qe=dr({mutationFn:async({leagueId:Se,season:st,monitored:wt})=>(await at.put(`/leagues/${Se}/seasons/${st}/toggle`,{monitored:wt})).data,onSuccess:async Se=>{await s.refetchQueries({queryKey:["league-events",a]}),await s.refetchQueries({queryKey:["league",a]}),be.success(Se.message||"Season monitoring updated")},onError:()=>{be.error("Failed to toggle season monitoring")}}),dt=(Se,st,wt,yt,Mt,Ke,Vt,Nt,St)=>{ot.mutate({monitoredTeamIds:st,monitorType:wt,qualityProfileId:yt,searchForMissingEvents:Mt,searchForCutoffUnmetEvents:Ke,monitoredParts:Vt,applyMonitoredPartsToEvents:Nt,monitoredSessionTypes:St})},He=()=>{var Se;D&&D.externalId&&(S.current={league:{idLeague:D.externalId,strLeague:D.name,strSport:D.sport,strCountry:D.country,strLeagueAlternate:void 0,strDescriptionEN:D.description,strBadge:D.logoUrl,strLogo:D.logoUrl,strBanner:D.bannerUrl,strPoster:D.posterUrl,strWebsite:D.website,intFormedYear:(Se=D.formedYear)==null?void 0:Se.toString()},leagueId:D.id},b(!0))},Ce=()=>{b(!1),setTimeout(()=>{S.current=null},300)},_e=()=>{D&&(T.current={name:D.name,eventCount:D.eventCount},w(!0))},ge=()=>{w(!1),setTimeout(()=>{T.current=null},300)},Ze=(Se,st,wt,yt)=>{o({isOpen:!0,eventId:Se,eventTitle:st,part:wt,existingFiles:yt})},Me=async(Se,st,wt,yt)=>{const Mt=je(Se,yt);if(Mt==="searching"){be.info("Search in progress",{description:`Already searching for "${st}"${yt?` (${yt})`:""}`});return}if(Mt==="queued"){be.info("Search already queued",{description:`"${st}"${yt?` (${yt})`:""} is waiting in queue`});return}W(Ke=>[...Ke,{eventId:Se,part:yt,queuedAt:Date.now()}]);try{const Ke=await at.post(`/event/${Se}/automatic-search`,{qualityProfileId:wt,part:yt});Ke.data.success||(W(Vt=>Vt.filter(Nt=>!(Nt.eventId===Se&&Nt.part===yt))),be.error("Automatic search failed",{description:Ke.data.message||"Failed to queue automatic search"}))}catch(Ke){W(Vt=>Vt.filter(Nt=>!(Nt.eventId===Se&&Nt.part===yt))),console.error("Automatic search error:",Ke),be.error("Automatic search failed",{description:"Failed to start automatic search. Please try again."})}},nt=async()=>{if(!(!a||V)){G(!0);try{const Se=await at.post(`/league/${a}/automatic-search`);Se.data.success?s.invalidateQueries({queryKey:["league",a]}):be.error("League search failed",{description:Se.data.message||"Failed to queue league search"})}catch(Se){console.error("League search error:",Se),be.error("League search failed",{description:"Failed to start league search. Please try again."})}finally{G(!1)}}},ht=async()=>{if(a)try{be.info("Refreshing events...",{description:`Fetching events from TheSportsDB for ${D==null?void 0:D.name}`});const Se=await at.post(`/leagues/${a}/refresh-events`,{});if(Se.data.success){be.success("Events refreshed successfully",{description:`${Se.data.newEvents} new events added, ${Se.data.updatedEvents} updated, ${Se.data.skippedEvents} skipped`});try{const st=await at.post(`/leagues/${a}/recalculate-episodes`);st.data.success&&st.data.renumberedCount>0&&be.info("Episode numbers fixed",{description:`${st.data.renumberedCount} events renumbered`})}catch(st){console.error("Recalculate episodes error:",st)}s.invalidateQueries({queryKey:["league",a]}),s.invalidateQueries({queryKey:["league",a,"events"]}),s.invalidateQueries({queryKey:["leagues"]})}else be.error("Failed to refresh events",{description:Se.data.message||"Failed to fetch events from TheSportsDB"})}catch(Se){console.error("Refresh events error:",Se),be.error("Failed to refresh events",{description:"An error occurred while fetching events. Please try again."})}};if(O)return t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600"})});if(U||!D)return t.jsx("div",{className:"p-8",children:t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("button",{onClick:()=>e("/leagues"),className:"flex items-center gap-2 text-gray-400 hover:text-white mb-4 transition-colors",children:[t.jsx(xf,{className:"w-5 h-5"}),"Back to Leagues"]}),t.jsxs("div",{className:"text-center py-12",children:[t.jsx("p",{className:"text-red-500 text-xl mb-4",children:"League not found"}),t.jsx("button",{onClick:()=>e("/leagues"),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Go to Leagues"})]})]})});const Oe=(I||[]).reduce((Se,st)=>{const wt=st.season||"Unknown";return Se[wt]||(Se[wt]=[]),Se[wt].push(st),Se},{});Object.keys(Oe).forEach(Se=>{Oe[Se].sort((st,wt)=>{const yt=st.episodeNumber??0,Mt=wt.episodeNumber??0;return yt!==Mt?Mt-yt:new Date(wt.eventDate).getTime()-new Date(st.eventDate).getTime()})});const tt=Object.keys(Oe).sort((Se,st)=>{if(Se==="Unknown")return 1;if(st==="Unknown")return-1;const wt=parseInt(Se.split("-")[0]);return parseInt(st.split("-")[0])-wt}),Ct=Se=>{E(st=>{const wt=new Set(st);return wt.has(Se)?wt.delete(Se):wt.add(Se),wt})},we=Se=>["Fighting","MMA","UFC","Boxing","Kickboxing","Wrestling"].some(wt=>Se.toLowerCase().includes(wt.toLowerCase())),bt=Se=>{if(Se===0)return"0 B";const st=1024,wt=["B","KB","MB","GB","TB"],yt=Math.floor(Math.log(Se)/Math.log(st));return parseFloat((Se/Math.pow(st,yt)).toFixed(1))+" "+wt[yt]},ve=[{name:"Early Prelims",label:"Early Prelims"},{name:"Prelims",label:"Prelims"},{name:"Main Card",label:"Main Card"}],xt=Se=>Se.partStatuses!==void 0?Se.partStatuses.map(st=>({name:st.partName,label:st.partName})):ve,me=Se=>!(Se.partStatuses!==void 0&&Se.partStatuses.length===0),De=Se=>{if(!Se)return null;const st=Se.match(/\b(2160p|1080p|720p|480p|360p)\b/i);return st?st[1].toLowerCase():null},ue=Se=>{if(!Se||Se.length<2)return[];const st=Se.filter(Ke=>Ke.exists&&Ke.partName);if(st.length<2)return[];const wt=[],yt=st[0],Mt=De(yt.quality);for(let Ke=1;Ke<st.length;Ke++){const Vt=st[Ke],Nt=De(Vt.quality);Mt&&Nt&&Mt!==Nt&&wt.push(`Resolution mismatch: ${yt.partName} (${Mt}) vs ${Vt.partName} (${Nt})`),yt.codec&&Vt.codec&&yt.codec!==Vt.codec&&wt.push(`Codec mismatch: ${yt.partName} (${yt.codec}) vs ${Vt.partName} (${Vt.codec})`),yt.source&&Vt.source&&yt.source!==Vt.source&&wt.push(`Source mismatch: ${yt.partName} (${yt.source}) vs ${Vt.partName} (${Vt.source})`)}return wt};return t.jsxs("div",{className:"p-4 md:p-8",children:[t.jsxs("div",{className:"max-w-6xl mx-auto",children:[t.jsxs("button",{onClick:()=>e("/leagues"),className:"flex items-center gap-2 text-gray-400 hover:text-white mb-4 md:mb-6 transition-colors text-sm md:text-base",children:[t.jsx(xf,{className:"w-4 h-4 md:w-5 md:h-5"}),"Back to Leagues"]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg overflow-hidden mb-4 md:mb-8",children:[(D.bannerUrl||D.logoUrl||D.posterUrl)&&t.jsxs("div",{className:"relative h-40 md:h-64 bg-gray-800",children:[t.jsx("img",{src:D.bannerUrl||D.logoUrl||D.posterUrl,alt:D.name,className:"w-full h-full object-cover"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/50 to-transparent"})]}),t.jsxs("div",{className:"p-4 md:p-8",children:[t.jsxs("div",{className:"flex flex-col md:flex-row md:items-start justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl md:text-4xl font-bold text-white mb-2",children:D.name}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-4 text-gray-400",children:[t.jsx("span",{className:"px-2 md:px-3 py-1 bg-red-600/20 text-red-400 text-xs md:text-sm rounded font-medium",children:D.sport}),D.country&&t.jsx("span",{className:"text-xs md:text-sm",children:D.country}),D.formedYear&&t.jsxs("span",{className:"text-xs md:text-sm",children:["Est. ",D.formedYear]})]})]}),t.jsxs("div",{className:"flex flex-wrap md:flex-col gap-2 md:gap-3",children:[t.jsx("button",{onClick:()=>Re.mutate(!D.monitored),disabled:Re.isPending,className:`px-3 md:px-4 py-1.5 md:py-2 text-white text-xs md:text-sm font-semibold rounded-lg transition-colors ${D.monitored?"bg-green-600 hover:bg-green-700":"bg-gray-600 hover:bg-gray-700"} ${Re.isPending?"opacity-50 cursor-not-allowed":""}`,title:"Toggle league monitoring - When monitored, events will be tracked for downloads",children:D.monitored?"Monitored":"Not Monitored"}),t.jsxs("button",{onClick:He,className:"px-3 md:px-4 py-1.5 md:py-2 bg-blue-600 hover:bg-blue-700 text-white text-xs md:text-sm font-semibold rounded-lg transition-colors flex items-center justify-center gap-1.5 md:gap-2",title:"Edit monitored teams and monitoring settings",children:[t.jsx(j3,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),"Edit"]}),D.fileCount>0&&t.jsxs("button",{onClick:()=>u({isOpen:!0}),className:"px-3 md:px-4 py-1.5 md:py-2 bg-gray-600 hover:bg-gray-700 text-white text-xs md:text-sm font-semibold rounded-lg transition-colors flex items-center justify-center gap-1.5 md:gap-2",title:"View all downloaded files for this league",children:[t.jsx(Np,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"All Files"})," (",D.fileCount,")"]}),t.jsx("button",{onClick:_e,disabled:ne.isPending,className:"px-3 md:px-4 py-1.5 md:py-2 bg-red-600/80 hover:bg-red-700 text-white text-xs md:text-sm font-semibold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Remove league from library",children:ne.isPending?"Deleting...":"Delete"})]})]}),D.description&&t.jsx("p",{className:"text-gray-400 mt-4 leading-relaxed",children:D.description}),D.website&&t.jsx("a",{href:D.website.startsWith("http://")||D.website.startsWith("https://")?D.website:`https://${D.website}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 mt-4 text-red-400 hover:text-red-300 transition-colors",children:"Visit Official Website "}),t.jsx("div",{className:"mt-4 md:mt-6 pt-4 md:pt-6 border-t border-red-900/30",children:t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs md:text-sm font-semibold text-white mb-0.5 md:mb-1",children:"Search All Monitored Events"}),t.jsx("p",{className:"text-xs text-gray-400",children:"Search for missing files and quality upgrades"})]}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsxs("button",{onClick:nt,disabled:V,className:"px-3 md:px-4 py-1.5 md:py-2 bg-red-600 hover:bg-red-700 disabled:bg-red-600/50 disabled:cursor-not-allowed text-white text-xs md:text-sm font-medium rounded transition-colors flex items-center gap-1.5 md:gap-2",title:"Search all monitored events - downloads missing files and upgrades existing files if better quality is available",children:[V?t.jsx(Dt,{className:"w-3.5 h-3.5 md:w-4 md:h-4 animate-spin"}):t.jsx(Ks,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),t.jsx("span",{className:"hidden sm:inline",children:V?"Searching...":"Search League"}),t.jsx("span",{className:"sm:hidden",children:V?"...":"Search"})]}),t.jsxs("button",{onClick:ht,className:"px-3 md:px-4 py-1.5 md:py-2 bg-blue-600 hover:bg-blue-700 text-white text-xs md:text-sm font-medium rounded transition-colors flex items-center gap-1.5 md:gap-2",title:"Refresh events from TheSportsDB API - fetches and adds new events to the league",children:[t.jsx(Dt,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),"Refresh"]})]})]})}),t.jsxs("div",{className:"mt-4 md:mt-6 pt-4 md:pt-6 border-t border-red-900/30",children:[t.jsx("h3",{className:"text-xs md:text-sm font-semibold text-white mb-3 md:mb-4",children:"Monitoring Settings"}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 md:gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Monitor Events"}),t.jsxs("select",{value:(D==null?void 0:D.monitorType)||"Future",onChange:Se=>ot.mutate({monitorType:Se.target.value}),disabled:ot.isPending,className:"w-full px-3 py-2 bg-black border border-red-900/30 rounded text-white text-sm focus:outline-none focus:border-red-600 focus:ring-1 focus:ring-red-600 disabled:opacity-50",children:[t.jsx("option",{value:"All",children:"All Events"}),t.jsx("option",{value:"Future",children:"Future Events"}),t.jsx("option",{value:"CurrentSeason",children:"Current Season"}),t.jsx("option",{value:"LatestSeason",children:"Latest Season"}),t.jsx("option",{value:"NextSeason",children:"Next Season"}),t.jsx("option",{value:"Recent",children:"Recent (30 days)"}),t.jsx("option",{value:"None",children:"None"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-2",children:"Quality Profile"}),t.jsxs("select",{value:(D==null?void 0:D.qualityProfileId)||"",onChange:Se=>ot.mutate({qualityProfileId:Se.target.value?parseInt(Se.target.value):null}),disabled:ot.isPending,className:"w-full px-3 py-2 bg-black border border-red-900/30 rounded text-white text-sm focus:outline-none focus:border-red-600 focus:ring-1 focus:ring-red-600 disabled:opacity-50",children:[t.jsx("option",{value:"",children:"No Quality Profile"}),te.map(Se=>t.jsx("option",{value:Se.id,children:Se.name},Se.id))]})]}),t.jsx("div",{children:t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:(D==null?void 0:D.searchForMissingEvents)||!1,onChange:Se=>ot.mutate({searchForMissingEvents:Se.target.checked}),disabled:ot.isPending,className:"w-4 h-4 bg-black border-2 border-gray-600 rounded text-red-600 focus:ring-red-600 focus:ring-offset-0 focus:ring-2 disabled:opacity-50"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-xs font-medium text-white",children:"Search on add/update"}),t.jsx("div",{className:"text-xs text-gray-400",children:"Search when league settings change"})]})]})}),t.jsx("div",{children:t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:(D==null?void 0:D.searchForCutoffUnmetEvents)||!1,onChange:Se=>ot.mutate({searchForCutoffUnmetEvents:Se.target.checked}),disabled:ot.isPending,className:"w-4 h-4 bg-black border-2 border-gray-600 rounded text-red-600 focus:ring-red-600 focus:ring-offset-0 focus:ring-2 disabled:opacity-50"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-xs font-medium text-white",children:"Search for upgrades on add/update"}),t.jsx("div",{className:"text-xs text-gray-400",children:"Search for quality upgrades when settings change"})]})]})})]})]}),le&&t.jsxs("div",{className:"mt-4 md:mt-6 pt-4 md:pt-6 border-t border-red-900/30",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3 md:mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ii,{className:"w-4 h-4 md:w-5 md:h-5 text-red-400"}),t.jsx("h3",{className:"text-xs md:text-sm font-semibold text-white",children:"DVR Channel Preference"})]}),H.length>0&&t.jsxs("span",{className:"text-xs text-gray-500",children:[R&&q.length!==H.length?`${q.length} of ${H.length}`:H.length," channel",(R?q.length:H.length)!==1?"s":""]})]}),X?t.jsx("div",{className:"text-sm text-gray-400",children:"Loading channels..."}):H.length===0?t.jsx("div",{className:"bg-gray-800/50 border border-gray-700 rounded-lg p-3",children:t.jsx("p",{className:"text-xs text-gray-400",children:"No channels mapped to this league. Map channels in Settings  IPTV Channels."})}):t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Ks,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),t.jsx("input",{type:"text",placeholder:"Search channels...",value:R,onChange:Se=>K(Se.target.value),className:"w-full pl-8 pr-3 py-1.5 bg-black border border-gray-700 rounded text-white text-xs placeholder-gray-500 focus:outline-none focus:border-red-600 focus:ring-1 focus:ring-red-600"})]}),t.jsxs("button",{onClick:()=>Pe.mutate(null),disabled:Pe.isPending,className:`w-full flex items-center gap-2 p-2 rounded-lg border transition-colors ${H.some(Se=>Se.isPreferred)?"bg-gray-800/50 border-gray-700 hover:border-gray-600":"bg-red-950/30 border-red-900/50 ring-1 ring-red-600"}`,children:[t.jsx(_n,{className:"w-4 h-4 text-gray-400"}),t.jsx("div",{className:"flex-1 text-left",children:t.jsx("div",{className:"text-xs font-medium text-white",children:"Auto-select best quality"})}),!H.some(Se=>Se.isPreferred)&&t.jsx(yd,{className:"w-4 h-4 text-green-500"})]}),t.jsxs("div",{className:"max-h-48 overflow-y-auto space-y-1.5 pr-1",children:[q.map(Se=>t.jsxs("button",{onClick:()=>Pe.mutate(Se.channel.id),disabled:Pe.isPending,className:`w-full flex items-center gap-2 p-2 rounded-lg border transition-colors ${Se.isPreferred?"bg-red-950/30 border-red-900/50 ring-1 ring-red-600":"bg-gray-800/50 border-gray-700 hover:border-gray-600"}`,children:[Se.channel.logoUrl?t.jsx("img",{src:Se.channel.logoUrl,alt:Se.channel.name,className:"w-6 h-6 rounded object-contain bg-gray-800 flex-shrink-0",onError:st=>{st.target.style.display="none"}}):t.jsx("div",{className:"w-6 h-6 rounded bg-gray-800 flex items-center justify-center flex-shrink-0",children:t.jsx(_n,{className:"w-3 h-3 text-gray-600"})}),t.jsx("div",{className:"flex-1 text-left min-w-0",children:t.jsx("div",{className:"text-xs font-medium text-white truncate",children:Se.channel.name})}),t.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[t.jsx("span",{className:`px-1 py-0.5 text-[10px] rounded ${Se.quality==="4K"?"bg-purple-900/30 text-purple-400":Se.quality==="FHD"?"bg-blue-900/30 text-blue-400":Se.quality==="HD"?"bg-green-900/30 text-green-400":"bg-yellow-900/30 text-yellow-400"}`,children:Se.quality}),Se.isPreferred&&t.jsx(yd,{className:"w-4 h-4 text-green-500"})]})]},Se.channel.id)),R&&q.length===0&&t.jsx("div",{className:"text-xs text-gray-500 text-center py-2",children:"No matching channels"})]})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-2 md:gap-6 mb-4 md:mb-8",children:[t.jsxs("div",{className:"bg-gray-900 border border-red-900/30 rounded-lg p-3 md:p-6",children:[t.jsx("div",{className:"text-gray-400 text-xs md:text-sm mb-1",children:"Total Events"}),t.jsx("div",{className:"text-xl md:text-3xl font-bold text-white",children:D.eventCount})]}),t.jsxs("div",{className:"bg-gray-900 border border-red-900/30 rounded-lg p-3 md:p-6",children:[t.jsx("div",{className:"text-gray-400 text-xs md:text-sm mb-1",children:"Monitored"}),t.jsx("div",{className:"text-xl md:text-3xl font-bold text-green-400",children:D.monitoredEventCount})]}),t.jsxs("div",{className:"bg-gray-900 border border-red-900/30 rounded-lg p-3 md:p-6",children:[t.jsx("div",{className:"text-gray-400 text-xs md:text-sm mb-1",children:"Downloaded"}),t.jsx("div",{className:"text-xl md:text-3xl font-bold text-blue-400",children:D.fileCount})]})]}),t.jsxs("div",{className:"bg-gray-900 border border-red-900/30 rounded-lg overflow-hidden",children:[t.jsxs("div",{className:"p-4 md:p-6 border-b border-red-900/30",children:[t.jsx("h2",{className:"text-xl md:text-2xl font-bold text-white",children:"Events"}),t.jsxs("p",{className:"text-gray-400 text-xs md:text-sm mt-1",children:[Array.isArray(I)?I.length:0," event",Array.isArray(I)&&I.length!==1?"s":""," in this league"]})]}),F?t.jsxs("div",{className:"p-12 text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-400",children:"Loading events..."})]}):!Array.isArray(I)||I.length===0?t.jsxs("div",{className:"p-12 text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-400 mb-2",children:"Syncing events from TheSportsDB..."}),t.jsx("p",{className:"text-gray-500 text-sm",children:"This may take a moment for leagues with many seasons"})]}):t.jsx("div",{children:tt.map(Se=>{const st=Oe[Se],wt=k.has(Se),yt=st.filter(Ke=>Ke.monitored).length,Mt=st.filter(Ke=>Ke.hasFile).length;return t.jsxs("div",{className:"border-b border-red-900/30 last:border-b-0",children:[t.jsxs("div",{className:"p-4 md:p-6 hover:bg-gray-800/30 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[t.jsx("button",{onClick:Ke=>{Ke.stopPropagation(),qe.mutate({leagueId:Number(a),season:Se,monitored:yt===0})},className:"focus:outline-none focus:ring-2 focus:ring-red-500 rounded flex-shrink-0",disabled:qe.isPending,title:yt>0?"Unmonitor all events in this season":"Monitor all events in this season",children:yt>0?t.jsx(yd,{className:"w-5 h-5 md:w-6 md:h-6 text-green-500"}):t.jsx(vg,{className:"w-5 h-5 md:w-6 md:h-6 text-gray-600"})}),t.jsxs("button",{onClick:()=>Ct(Se),className:"flex items-center gap-2 flex-1 text-left",children:[wt?t.jsx(As,{className:"w-4 h-4 md:w-5 md:h-5 text-gray-400"}):t.jsx(_c,{className:"w-4 h-4 md:w-5 md:h-5 text-gray-400"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-base md:text-xl font-bold text-white",children:Se==="Unknown"?"No Season Info":`Season ${Se}`}),t.jsxs("p",{className:"text-xs md:text-sm text-gray-400 mt-0.5 md:mt-1",children:[st.length," event",st.length!==1?"s":"",yt>0&&`  ${yt} monitored`,Mt>0&&`  ${Mt} downloaded`]})]})]})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-3 mt-3 md:mt-4 ml-7 md:ml-10",children:[t.jsxs("select",{value:(D==null?void 0:D.qualityProfileId)||"",onChange:Ke=>ot.mutate({qualityProfileId:Ke.target.value?parseInt(Ke.target.value):null}),disabled:ot.isPending,className:"px-2 md:px-3 py-1 md:py-1.5 bg-gray-800 border border-gray-700 text-gray-200 text-xs md:text-sm rounded focus:outline-none focus:ring-2 focus:ring-red-500",onClick:Ke=>Ke.stopPropagation(),children:[t.jsx("option",{value:"",children:"No Quality Profile"}),te.map(Ke=>t.jsx("option",{value:Ke.id,children:Ke.name},Ke.id))]}),t.jsxs("button",{onClick:Ke=>{Ke.stopPropagation(),g({isOpen:!0,season:Se})},className:"px-2 md:px-4 py-1 md:py-1.5 bg-gray-700 hover:bg-gray-600 text-white text-xs md:text-sm font-medium rounded transition-colors flex items-center gap-1 md:gap-2",title:"Manual Search - Browse and select releases for all events in this season",children:[t.jsx(sf,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Manual Search"}),t.jsx("span",{className:"sm:hidden",children:"Manual"})]}),t.jsxs("button",{onClick:async Ke=>{if(Ke.stopPropagation(),!(!(D!=null&&D.id)||Z.has(Se))){oe(Vt=>new Set(Vt).add(Se));try{const Vt=await at.post(`/leagues/${D.id}/seasons/${Se}/automatic-search`);Vt.data.success?(be.success("Season search queued",{description:Vt.data.message||`Queued searches for all monitored events in ${Se}`}),await s.refetchQueries({queryKey:["league-events",a]}),await s.refetchQueries({queryKey:["league",a]})):be.error("Season search failed",{description:Vt.data.message||"Failed to queue season search"})}catch(Vt){console.error("Season search error:",Vt),be.error("Season search failed",{description:"Failed to start season search. Please try again."})}finally{oe(Vt=>{const Nt=new Set(Vt);return Nt.delete(Se),Nt})}}},disabled:Z.has(Se),className:"px-2 md:px-4 py-1 md:py-1.5 bg-red-600 hover:bg-red-700 disabled:bg-red-600/50 disabled:cursor-not-allowed text-white text-xs md:text-sm font-medium rounded transition-colors flex items-center gap-1 md:gap-2",title:"Automatic Search - Search for all monitored events in this season",children:[Z.has(Se)?t.jsx(Dt,{className:"w-3.5 h-3.5 md:w-4 md:h-4 animate-spin"}):t.jsx(Ks,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),t.jsx("span",{className:"hidden sm:inline",children:Z.has(Se)?"Searching...":"Auto Search"}),t.jsx("span",{className:"sm:hidden",children:Z.has(Se)?"...":"Auto"})]}),Mt>0&&t.jsxs("button",{onClick:Ke=>{Ke.stopPropagation(),u({isOpen:!0,season:Se})},className:"px-2 md:px-4 py-1 md:py-1.5 bg-gray-700 hover:bg-gray-600 text-white text-xs md:text-sm font-medium rounded transition-colors flex items-center gap-1 md:gap-2",title:`View all downloaded files for ${Se}`,children:[t.jsx(Np,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Files"})," (",Mt,")"]})]})]}),wt&&t.jsx("div",{className:"divide-y divide-red-900/30",children:st.map(Ke=>{var Nt;const Vt=Ke.hasFile;return new Date(Ke.eventDate),t.jsx("div",{className:"hover:bg-gray-800/50 transition-colors",children:t.jsxs("div",{className:"p-3 md:p-6",children:[t.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[t.jsx("button",{onClick:()=>xe.mutate({eventId:Ke.id,monitored:!Ke.monitored,monitoredParts:D==null?void 0:D.monitoredParts}),className:"focus:outline-none focus:ring-2 focus:ring-red-500 rounded flex-shrink-0",disabled:xe.isPending,children:Ke.monitored?t.jsx(yd,{className:"w-5 h-5 md:w-6 md:h-6 text-green-500"}):t.jsx(vg,{className:"w-5 h-5 md:w-6 md:h-6 text-gray-600"})}),Ke.images&&Ke.images.length>0?t.jsx("img",{src:Ke.images[0],alt:Ke.title,className:"w-10 h-10 md:w-12 md:h-12 rounded object-cover flex-shrink-0 bg-gray-800",onError:St=>{St.target.style.display="none"}}):t.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded bg-gray-800 flex items-center justify-center flex-shrink-0",children:t.jsx(En,{className:"w-5 h-5 md:w-6 md:h-6 text-gray-600"})}),t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx("h3",{className:"text-sm md:text-lg font-semibold text-white truncate",children:Ke.title})}),!(z!=null&&z.enableMultiPartEpisodes&&we(Ke.sport)&&me(Ke))&&t.jsx(VS,{eventId:Ke.id,searchQueue:ae,downloadQueue:ce}),Vt&&t.jsxs("button",{onClick:()=>d({isOpen:!0,eventId:Ke.id,eventTitle:Ke.title,files:Ke.files||[],isFightingSport:we(Ke.sport)}),className:"px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-xs font-semibold rounded transition-colors flex items-center gap-1.5",title:"Click to view and manage downloaded files",children:[t.jsx(En,{className:"w-3.5 h-3.5"}),Ke.files&&Ke.files.length>1?`${Ke.files.length} Files`:"Downloaded"]})]}),t.jsxs("div",{className:"ml-7 md:ml-10 mt-2 space-y-1",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-3 text-xs md:text-sm text-gray-400",children:[t.jsx("span",{children:ti(Ke.eventDate,r,{year:"numeric",month:"short",day:"numeric"})}),Ke.seasonNumber&&Ke.episodeNumber&&t.jsxs("span",{className:"px-2 py-0.5 bg-blue-600/20 text-blue-400 rounded font-mono",children:["S",Ke.seasonNumber,"E",String(Ke.episodeNumber).padStart(2,"0")]}),(()=>{var os;const ws=new Date(Ke.eventDate)<new Date,Ne=(os=Ke.status)==null?void 0:os.toUpperCase(),gt=Ke.hasFile||Ne==="FT"||Ne==="COMPLETED"||Ne==="MATCH FINISHED"||ws&&(!Ne||Ne==="NS"||Ne==="NOT STARTED"),jt=Ne==="LIVE",vt=!gt&&!jt;return gt?t.jsx("span",{className:"px-2 py-0.5 rounded bg-blue-600/20 text-blue-400",children:"Completed"}):jt?t.jsx("span",{className:"px-2 py-0.5 rounded bg-green-600/20 text-green-400",children:"Live"}):vt?t.jsx("span",{className:"px-2 py-0.5 rounded bg-gray-600/20 text-gray-400",children:"Not Started"}):Ke.status?t.jsx("span",{className:"px-2 py-0.5 rounded bg-gray-600/20 text-gray-400",children:Ke.status}):null})()]}),Ke.homeTeamName&&Ke.awayTeamName&&t.jsxs("div",{className:"text-xs md:text-sm text-gray-300",children:[Ke.homeTeamName," vs ",Ke.awayTeamName,Ke.homeScore!==void 0&&Ke.awayScore!==void 0&&t.jsxs("span",{className:"ml-2 text-gray-400",children:["(",Ke.homeScore," - ",Ke.awayScore,")"]})]}),Ke.venue&&t.jsxs("div",{className:"text-xs md:text-sm text-gray-400 hidden sm:block",children:[Ke.venue,Ke.location&&`, ${Ke.location}`]})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-3 mt-3 md:mt-4 ml-7 md:ml-10",children:[t.jsx("div",{className:"flex-1 max-w-[150px] md:max-w-xs",children:t.jsxs("select",{value:Ke.qualityProfileId||(D==null?void 0:D.qualityProfileId)||"",onChange:St=>Ee.mutate({eventId:Ke.id,qualityProfileId:St.target.value?Number(St.target.value):null}),className:"w-full px-2 md:px-3 py-1 md:py-1.5 bg-gray-800 border border-gray-700 text-gray-200 text-xs md:text-sm rounded focus:outline-none focus:ring-2 focus:ring-red-500",disabled:Ee.isPending,children:[t.jsx("option",{value:"",children:D!=null&&D.qualityProfileId?`League (${Array.isArray(te)&&((Nt=te.find(St=>St.id===D.qualityProfileId))==null?void 0:Nt.name)||"?"})`:"No Profile"}),Array.isArray(te)&&te.map(St=>t.jsxs("option",{value:St.id,children:[St.name,Ke.qualityProfileId===St.id&&" (Custom)"]},St.id))]})}),!(z!=null&&z.enableMultiPartEpisodes&&we(Ke.sport)&&me(Ke))&&t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>Ze(Ke.id,Ke.title,void 0,Ke.files),className:"px-2 md:px-4 py-1 md:py-1.5 bg-gray-700 hover:bg-gray-600 text-white text-xs md:text-sm font-medium rounded transition-colors flex items-center gap-1 md:gap-2",title:"Manual Search - Browse and select from available releases",children:[t.jsx(sf,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Manual"})]}),t.jsxs("button",{onClick:()=>Me(Ke.id,Ke.title,Ke.qualityProfileId||(D==null?void 0:D.qualityProfileId)),disabled:je(Ke.id)!=="idle",className:"px-2 md:px-4 py-1 md:py-1.5 bg-red-600 hover:bg-red-700 disabled:bg-red-600/50 disabled:cursor-not-allowed text-white text-xs md:text-sm font-medium rounded transition-colors flex items-center gap-1 md:gap-2",title:"Search for monitored event",children:[je(Ke.id)!=="idle"?t.jsx(Dt,{className:"w-3.5 h-3.5 md:w-4 md:h-4 animate-spin"}):t.jsx(Ks,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),t.jsx("span",{className:"hidden sm:inline",children:je(Ke.id)!=="idle"?"...":"Auto"})]})]})]}),(z==null?void 0:z.enableMultiPartEpisodes)&&we(Ke.sport)&&me(Ke)&&t.jsxs("div",{className:"mt-3 md:mt-4 ml-7 md:ml-10 space-y-2 md:space-y-3",children:[xt(Ke).map(St=>{var hs,Yr,M;const Kt=Ke.monitoredParts!==null&&Ke.monitoredParts!==void 0?Ke.monitoredParts:(D==null?void 0:D.monitoredParts)??null,ws=Kt==null,Ne=Kt?Kt.split(",").map(C=>C.trim()).filter(Boolean):[],gt=((hs=D==null?void 0:D.monitoredTeams)==null?void 0:hs.some(C=>C.monitored))??!1,vt=(Ke.monitored||gt)&&(ws||Ne.includes(St.name)),os=(Yr=Ke.partStatuses)==null?void 0:Yr.find(C=>C.partName===St.name),xs=(os==null?void 0:os.file)??((M=Ke.files)==null?void 0:M.find(C=>C.partName===St.name&&C.exists));return t.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-3",children:[t.jsx("button",{onClick:()=>{let C;const j=xt(Ke);vt?ws?C=j.map(L=>L.name).filter(L=>L!==St.name):C=Ne.filter(L=>L!==St.name):C=[...Ne,St.name];const _=j.map(L=>L.name),P=C.length===_.length&&_.every(L=>C.includes(L));ke.mutate({eventId:Ke.id,monitoredParts:P?null:C.length>0?C.join(","):""})},className:"focus:outline-none focus:ring-2 focus:ring-red-500 rounded flex-shrink-0",disabled:ke.isPending,title:`${vt?"Unmonitor":"Monitor"} ${St.label}`,children:vt?t.jsx(yd,{className:"w-4 h-4 md:w-5 md:h-5 text-green-500"}):t.jsx(vg,{className:"w-4 h-4 md:w-5 md:h-5 text-gray-600"})}),t.jsxs("div",{className:"flex-1 flex flex-wrap items-center gap-1 md:gap-2 min-w-0",children:[t.jsx("span",{className:`text-xs md:text-sm font-medium ${vt?"text-white":"text-gray-500"}`,children:St.label}),xs?t.jsxs("span",{className:"text-xs text-gray-400 flex items-center gap-1 md:gap-1.5",children:[t.jsx(En,{className:"w-3 h-3 md:w-3.5 md:h-3.5 text-green-500"}),xs.quality&&t.jsx("span",{className:"text-blue-400 hidden sm:inline",children:xs.quality}),t.jsxs("span",{className:"hidden sm:inline",children:["(",bt(xs.size),")"]}),xs.customFormatScore!==void 0&&xs.customFormatScore!==0&&t.jsxs("span",{className:`px-1 md:px-1.5 py-0.5 rounded text-xs font-medium hidden md:inline ${xs.customFormatScore>0?"bg-green-900/40 text-green-400":"bg-red-900/40 text-red-400"}`,children:["CF: ",xs.customFormatScore>0?"+":"",xs.customFormatScore]})]}):t.jsx(VS,{eventId:Ke.id,part:St.name,searchQueue:ae,downloadQueue:ce})]}),xs&&t.jsx("button",{onClick:()=>{confirm(`Delete the downloaded file for ${St.label}? This cannot be undone.`)&&Be.mutate({eventId:Ke.id,fileId:xs.id})},className:"p-1 md:p-1.5 text-gray-400 hover:text-red-400 hover:bg-red-600/10 rounded transition-colors",disabled:Be.isPending,title:`Delete ${St.label} file`,children:t.jsx(cs,{className:"w-3.5 h-3.5 md:w-4 md:h-4"})}),t.jsxs("button",{onClick:()=>Ze(Ke.id,Ke.title,St.name,Ke.files),className:"px-2 md:px-4 py-1 md:py-1.5 bg-gray-700 hover:bg-gray-600 text-white text-xs md:text-sm font-medium rounded transition-colors flex items-center gap-1 md:gap-2",title:`Manual Search - Browse and select ${St.label} releases`,children:[t.jsx(sf,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Manual"})]}),t.jsxs("button",{onClick:()=>Me(Ke.id,Ke.title,Ke.qualityProfileId||(D==null?void 0:D.qualityProfileId),St.name),disabled:je(Ke.id,St.name)!=="idle",className:"px-2 md:px-4 py-1 md:py-1.5 bg-red-600 hover:bg-red-700 disabled:bg-red-600/50 disabled:cursor-not-allowed text-white text-xs md:text-sm font-medium rounded transition-colors flex items-center gap-1 md:gap-2",title:`Search for monitored ${St.label}`,children:[je(Ke.id,St.name)!=="idle"?t.jsx(Dt,{className:"w-3.5 h-3.5 md:w-4 md:h-4 animate-spin"}):t.jsx(Ks,{className:"w-3.5 h-3.5 md:w-4 md:h-4"}),t.jsx("span",{className:"hidden sm:inline",children:je(Ke.id,St.name)!=="idle"?"...":"Auto"})]})]},St.name)}),(()=>{const St=ue(Ke.files);return St.length===0?null:t.jsx("div",{className:"mt-3 p-3 bg-yellow-900/20 border border-yellow-600/30 rounded-lg",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx(Pr,{className:"w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-yellow-400 text-sm font-medium mb-1",children:"Part files may not play back-to-back correctly in Plex"}),t.jsx("ul",{className:"text-yellow-300/80 text-xs space-y-0.5",children:St.map((Kt,ws)=>t.jsxs("li",{children:[" ",Kt]},ws))}),t.jsx("p",{className:"text-yellow-300/60 text-xs mt-2",children:"For seamless playback, all parts should have the same quality, codec, and source."})]})]})})})()]})]})},Ke.id)})})]},Se)})})]})]}),t.jsx(gj,{isOpen:n.isOpen,onClose:()=>o({...n,isOpen:!1}),eventId:n.eventId,eventTitle:n.eventTitle,part:n.part,existingFiles:n.existingFiles}),t.jsx(tI,{isOpen:c.isOpen,onClose:()=>d({...c,isOpen:!1}),eventId:c.eventId,eventTitle:c.eventTitle,files:c.files,leagueId:a,isFightingSport:c.isFightingSport}),D&&t.jsx(rI,{isOpen:f.isOpen,onClose:()=>u({isOpen:!1}),leagueId:D.id,leagueName:D.name,season:f.season}),D&&t.jsx(JD,{isOpen:m.isOpen,onClose:()=>g({isOpen:!1,season:""}),leagueId:D.id,leagueName:D.name,season:m.season,qualityProfileId:D.qualityProfileId}),t.jsx(pj,{league:((Fe=S.current)==null?void 0:Fe.league)||null,isOpen:x,onClose:Ce,onAdd:dt,isAdding:ot.isPending,editMode:!0,leagueId:((mt=S.current)==null?void 0:mt.leagueId)||null}),t.jsx(xj,{isOpen:v,onClose:ge,onConfirm:()=>{ne.mutate(),ge()},title:T.current?"Delete League":void 0,message:T.current?`Are you sure you want to delete "${T.current.name}"? This will remove the league${T.current.eventCount>0?` and all ${T.current.eventCount} event${T.current.eventCount!==1?"s":""}`:""} from your library.`:void 0,confirmText:"Delete League",confirmButtonClass:"bg-red-600 hover:bg-red-700",isLoading:ne.isPending})]})}const oI=[{id:"Soccer",name:"Soccer",icon:""},{id:"Basketball",name:"Basketball",icon:""},{id:"Fighting",name:"Fighting",icon:""},{id:"Baseball",name:"Baseball",icon:""},{id:"Football",name:"Football",icon:""},{id:"Hockey",name:"Hockey",icon:""},{id:"Tennis",name:"Tennis",icon:""},{id:"Golf",name:"Golf",icon:""},{id:"Racing",name:"Racing",icon:""}];function lI(){const[a,e]=y.useState("Soccer"),[s,r]=y.useState(w()),[n,o]=y.useState(""),[c,d]=y.useState(null),[f,u]=y.useState(!1),{data:m,isLoading:g,error:x,refetch:b}=Cs({queryKey:["tv-schedule",a,s],queryFn:async()=>{const E=new URLSearchParams({sport:a,date:s}),R=await kt(`/api/events/tv-schedule?${E}`);if(!R.ok)throw new Error("Failed to fetch TV schedule");return R.json()}}),v=(m==null?void 0:m.filter(E=>{var K,z,D;if(!n)return!0;const R=n.toLowerCase();return E.strEvent.toLowerCase().includes(R)||((K=E.strLeague)==null?void 0:K.toLowerCase().includes(R))||((z=E.strHomeTeam)==null?void 0:z.toLowerCase().includes(R))||((D=E.strAwayTeam)==null?void 0:D.toLowerCase().includes(R))}))||[];function w(){return new Date().toISOString().split("T")[0]}const S=E=>new Date(E).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),T=E=>{const R=E.strSport==="Fighting"||E.strSport==="Boxing"||E.strSport==="MMA";d({externalId:E.idEvent,title:E.strEvent,sport:E.strSport,eventDate:E.dateEvent+(E.strTime?`T${E.strTime}`:"T00:00:00"),venue:E.strVenue,location:E.strCity&&E.strCountry?`${E.strCity}, ${E.strCountry}`:E.strCountry||void 0,posterUrl:E.strPoster||E.strThumb||E.strBanner,status:E.strStatus,season:E.strSeason,round:E.intRound,...R&&{organization:E.strLeague},...!R&&{league:{id:0,name:E.strLeague,sport:E.strSport},homeTeam:E.strHomeTeam?{id:0,name:E.strHomeTeam}:void 0,awayTeam:E.strAwayTeam?{id:0,name:E.strAwayTeam}:void 0}}),u(!0)},k=()=>{u(!1),d(null)};return x?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-red-500 text-xl mb-4",children:"Failed to load events"}),t.jsx("button",{onClick:()=>b(),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Retry"})]})}):t.jsx("div",{className:"p-8",children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Add Events"}),t.jsx("p",{className:"text-gray-400",children:"Browse and add sporting events from TheSportsDB"})]}),t.jsx("div",{className:"mb-6",children:t.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:oI.map(E=>t.jsxs("button",{onClick:()=>e(E.id),className:`
                flex items-center gap-2 px-4 py-2 rounded-lg whitespace-nowrap font-medium transition-all
                ${a===E.id?"bg-red-600 text-white":"bg-gray-900 text-gray-400 hover:bg-gray-800 hover:text-white border border-red-900/30"}
              `,children:[t.jsx("span",{className:"text-xl",children:E.icon}),t.jsx("span",{children:E.name})]},E.id))})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:[t.jsx(el,{className:"inline w-4 h-4 mr-1"}),"Select Date"]}),t.jsx("input",{type:"date",value:s,onChange:E=>r(E.target.value),className:"w-full px-4 py-3 bg-gray-900 border border-red-900/30 rounded-lg text-white focus:outline-none focus:border-red-600 focus:ring-2 focus:ring-red-600/20"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:[t.jsx(Ks,{className:"inline w-4 h-4 mr-1"}),"Filter Events"]}),t.jsx("input",{type:"text",value:n,onChange:E=>o(E.target.value),placeholder:"Search by event, league, or team...",className:"w-full px-4 py-3 bg-gray-900 border border-red-900/30 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-red-600 focus:ring-2 focus:ring-red-600/20"})]})]}),g&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-600 mb-4"}),t.jsx("p",{className:"text-gray-400",children:"Loading events..."})]}),!g&&v.length===0&&t.jsxs("div",{className:"text-center py-12 bg-gray-800/50 rounded-lg border border-gray-700",children:[t.jsx("p",{className:"text-gray-400 text-lg",children:"No events found"}),t.jsx("p",{className:"text-gray-500 text-sm mt-2",children:n?"Try a different search term":"No events scheduled for this date"})]}),!g&&v.length>0&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("p",{className:"text-gray-400 mb-4",children:["Found ",v.length," event",v.length!==1?"s":""," on ",S(s)]}),v.map(E=>t.jsx("div",{className:"bg-gradient-to-r from-gray-900 to-gray-800 border border-gray-700 rounded-lg p-6 hover:border-red-600 transition-colors",children:t.jsxs("div",{className:"flex gap-6",children:[t.jsx("div",{className:"flex-shrink-0",children:E.strPoster||E.strThumb||E.strBanner?t.jsx("img",{src:E.strPoster||E.strThumb||E.strBanner,alt:E.strEvent,className:"w-32 h-48 object-cover rounded-lg",onError:R=>{R.currentTarget.style.display="none"}}):t.jsx("div",{className:"w-32 h-48 bg-gray-700 rounded-lg flex items-center justify-center",children:t.jsx(el,{className:"w-12 h-12 text-gray-500"})})}),t.jsxs("div",{className:"flex-grow",children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:E.strEvent}),t.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-400",children:[t.jsx("span",{className:"px-2 py-1 bg-red-900/30 text-red-400 rounded",children:E.strSport}),t.jsx("span",{className:"px-2 py-1 bg-gray-800 text-gray-300 rounded",children:E.strLeague})]})]}),t.jsx("button",{onClick:()=>T(E),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-semibold transition-colors",children:"+ Add to Library"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[t.jsx(el,{className:"w-5 h-5 text-gray-500"}),t.jsx("span",{children:S(E.dateEvent)}),E.strTimeLocal&&t.jsxs("span",{className:"text-gray-400 text-sm",children:["at ",E.strTimeLocal]})]}),E.strVenue&&t.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[t.jsx(PN,{className:"w-5 h-5 text-gray-500"}),t.jsx("span",{children:E.strVenue})]}),(E.strCity||E.strCountry)&&t.jsxs("div",{className:"flex items-center gap-2 text-gray-300 text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Location:"}),t.jsx("span",{children:E.strCity&&E.strCountry?`${E.strCity}, ${E.strCountry}`:E.strCountry||E.strCity})]})]}),E.strHomeTeam&&E.strAwayTeam&&t.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-center gap-4 text-lg",children:[t.jsx("span",{className:"text-white font-semibold",children:E.strHomeTeam}),t.jsx("span",{className:"text-gray-500",children:"vs"}),t.jsx("span",{className:"text-white font-semibold",children:E.strAwayTeam})]}),E.strSeason&&t.jsxs("p",{className:"text-center text-gray-400 text-sm mt-2",children:["Season ",E.strSeason,E.intRound&&`  Round ${E.intRound}`]})]}),E.strStatus&&E.strStatus!=="Scheduled"&&t.jsx("div",{className:"mt-3",children:t.jsx("span",{className:`px-3 py-1 rounded text-sm font-semibold ${E.strStatus==="Live"?"bg-green-900/30 text-green-400":E.strStatus==="Completed"?"bg-gray-800 text-gray-400":"bg-yellow-900/30 text-yellow-400"}`,children:E.strStatus})})]})]})},E.idEvent))]}),c&&t.jsx(VD,{isOpen:f,onClose:()=>{u(!1),d(null)},event:c,onSuccess:k}),!g&&v.length===0&&!n&&t.jsxs("div",{className:"mt-12 text-center",children:[t.jsx("p",{className:"text-gray-500 mb-4",children:"Browse events by:"}),t.jsxs("div",{className:"flex flex-wrap justify-center gap-3",children:[t.jsx("span",{className:"px-4 py-2 bg-gray-800 text-gray-400 rounded-lg",children:"Select a sport"}),t.jsx("span",{className:"px-4 py-2 bg-gray-800 text-gray-400 rounded-lg",children:"Choose a date"}),t.jsx("span",{className:"px-4 py-2 bg-gray-800 text-gray-400 rounded-lg",children:"Search by name"})]})]})]})})}const rf=[{id:"all",name:"All Sports",icon:""},{id:"American Football",name:"American Football",icon:""},{id:"Athletics",name:"Athletics",icon:""},{id:"Australian Football",name:"Australian Football",icon:""},{id:"Badminton",name:"Badminton",icon:""},{id:"Baseball",name:"Baseball",icon:""},{id:"Basketball",name:"Basketball",icon:""},{id:"Climbing",name:"Climbing",icon:""},{id:"Cricket",name:"Cricket",icon:""},{id:"Cycling",name:"Cycling",icon:""},{id:"Darts",name:"Darts",icon:""},{id:"Esports",name:"Esports",icon:""},{id:"Equestrian",name:"Equestrian",icon:""},{id:"Extreme Sports",name:"Extreme Sports",icon:""},{id:"Field Hockey",name:"Field Hockey",icon:""},{id:"Fighting",name:"Fighting",icon:""},{id:"Gaelic",name:"Gaelic",icon:""},{id:"Gambling",name:"Gambling",icon:""},{id:"Golf",name:"Golf",icon:""},{id:"Gymnastics",name:"Gymnastics",icon:""},{id:"Handball",name:"Handball",icon:""},{id:"Ice Hockey",name:"Ice Hockey",icon:""},{id:"Lacrosse",name:"Lacrosse",icon:""},{id:"Motorsport",name:"Motorsport",icon:""},{id:"Multi Sports",name:"Multi Sports",icon:""},{id:"Netball",name:"Netball",icon:""},{id:"Rugby",name:"Rugby",icon:""},{id:"Shooting",name:"Shooting",icon:""},{id:"Skating",name:"Skating",icon:""},{id:"Skiing",name:"Skiing",icon:""},{id:"Snooker",name:"Snooker",icon:""},{id:"Soccer",name:"Soccer",icon:""},{id:"Table Tennis",name:"Table Tennis",icon:""},{id:"Tennis",name:"Tennis",icon:""},{id:"Volleyball",name:"Volleyball",icon:""},{id:"Watersports",name:"Watersports",icon:""},{id:"Weightlifting",name:"Weightlifting",icon:""},{id:"Wintersports",name:"Wintersports",icon:""}],Ch=a=>["Motorsport","Racing","Formula 1","F1","NASCAR","IndyCar","MotoGP","WEC","Formula E","Rally","WRC","DTM","Super GT","IMSA","V8 Supercars","Supercars","Le Mans"].some(s=>a.toLowerCase().includes(s.toLowerCase())),cI=a=>{const e=a.toLowerCase(),s=rf.find(n=>n.id.toLowerCase()===e||e.includes(n.id.toLowerCase()));if(s&&s.id!=="all")return s.icon;const r={boxing:"",mma:"","mixed martial arts":"",ufc:"",kickboxing:"","muay thai":"",wrestling:"",sumo:"",football:"",futsal:"","arena football":"","canadian football":"",gridiron:"",racing:"","formula 1":"",f1:"",nascar:"",indycar:"",motogp:"",superbike:"",rally:"",wrc:"",endurance:"","le mans":"",pool:"",billiards:"",surfing:"",swimming:"",diving:"",rowing:"",sailing:"",triathlon:"",marathon:"","track and field":"","figure skating":"","speed skating":"",curling:"",bobsled:"",snowboard:"","cross country":"",biathlon:"",fencing:"",archery:"",powerlifting:"",bodybuilding:"",crossfit:"",cheerleading:"",chess:"",poker:""};for(const[n,o]of Object.entries(r))if(e.includes(n))return o;return""};function dI(){var ae,ce,ee,W,V;const a=Ta(),[e,s]=y.useState(""),[r,n]=y.useState("all"),[o,c]=y.useState(!1),[d,f]=y.useState(!1),[u,m]=y.useState(null),[g,x]=y.useState(!1),b=ca(),v=y.useRef(null),w=y.useRef(null),{data:S=[],isLoading:T}=Cs({queryKey:["thesportsdb-leagues","all"],queryFn:async()=>{const G=await kt("/api/leagues/all");if(!G.ok)throw new Error("Failed to fetch leagues");return G.json()},staleTime:300*1e3,refetchOnWindowFocus:!1}),{data:k=[]}=Cs({queryKey:["leagues"],queryFn:async()=>{const G=await kt("/api/leagues");if(!G.ok)throw new Error("Failed to fetch user leagues");return G.json()}}),E=y.useMemo(()=>{const G=new Map;return k.forEach(Z=>{Z.externalId&&G.set(Z.externalId,{id:Z.id,externalId:Z.externalId,logoUrl:Z.logoUrl})}),G},[k]),R=y.useMemo(()=>{let G=S;if(r!=="all"&&(G=G.filter(Z=>Z.strSport===r)),e.trim()){const Z=e.toLowerCase();G=G.filter(oe=>{var ye,je;return oe.strLeague.toLowerCase().includes(Z)||((ye=oe.strLeagueAlternate)==null?void 0:ye.toLowerCase().includes(Z))||oe.strSport.toLowerCase().includes(Z)||((je=oe.strCountry)==null?void 0:je.toLowerCase().includes(Z))})}return G},[S,r,e]),K=dr({mutationFn:async({league:G,monitoredTeamIds:Z,monitorType:oe,qualityProfileId:ye,searchForMissingEvents:je,searchForCutoffUnmetEvents:xe,monitoredParts:Ee,monitoredSessionTypes:Pe})=>{const Qe=Ch(G.strSport)?!0:Z.length>0,ot=await ds("/api/leagues",{externalId:G.idLeague,name:G.strLeague,sport:G.strSport,country:G.strCountry,description:G.strDescriptionEN,monitored:Qe,monitorType:oe,qualityProfileId:ye,searchForMissingEvents:je,searchForCutoffUnmetEvents:xe,monitoredParts:Ee,monitoredSessionTypes:Pe,logoUrl:G.strBadge||G.strLogo,bannerUrl:G.strBanner,posterUrl:G.strPoster,website:G.strWebsite,formedYear:G.intFormedYear||null,monitoredTeamIds:Z.length>0?Z:null});if(!ot.ok){const ne=await ot.json();throw new Error(ne.error||"Failed to add league")}return ot.json()},onSuccess:(G,Z)=>{const oe=Ch(Z.league.strSport);let ye;if(oe){const je=Z.monitoredSessionTypes?Z.monitoredSessionTypes.split(",").length:0;ye=je>0?`Added ${Z.league.strLeague} with ${je} monitored session type${je!==1?"s":""}!`:`Added ${Z.league.strLeague} (all session types monitored)`}else{const je=Z.monitoredTeamIds.length;ye=je>0?`Added ${Z.league.strLeague} with ${je} monitored team${je!==1?"s":""}!`:`Added ${Z.league.strLeague} (not monitored - no teams selected)`}be.success(ye),I(),b.invalidateQueries({queryKey:["leagues"]}),b.invalidateQueries({queryKey:["thesportsdb-leagues"]})},onError:G=>{be.error(G.message)}}),z=dr({mutationFn:async({leagueId:G,monitoredTeamIds:Z,monitorType:oe,qualityProfileId:ye,searchForMissingEvents:je,searchForCutoffUnmetEvents:xe,monitoredParts:Ee,monitoredSessionTypes:Pe,applyMonitoredPartsToEvents:Re,sport:Qe})=>{const ot=Ch(Qe),ne=ot?!0:Z.length>0,ke=await br(`/api/leagues/${G}`,{monitored:ne,monitorType:oe,qualityProfileId:ye,searchForMissingEvents:je,searchForCutoffUnmetEvents:xe,monitoredParts:Ee,monitoredSessionTypes:Pe,applyMonitoredPartsToEvents:Re});if(!ke.ok){const Be=await ke.json();throw new Error(Be.error||"Failed to update league settings")}if(!ot){const Be=await br(`/api/leagues/${G}/teams`,{monitoredTeamIds:Z.length>0?Z:null});if(!Be.ok){const qe=await Be.json();throw new Error(qe.error||"Failed to update monitored teams")}return Be.json()}return ke.json()},onSuccess:async(G,Z)=>{var Ee;const oe=Ch(Z.sport);let ye;if(oe){const Pe=Z.monitoredParts?Z.monitoredParts.split(",").length:0;ye=Pe>0?`Updated settings with ${Pe} monitored session${Pe!==1?"s":""}`:"League settings updated (no sessions selected)"}else{const Pe=G.teamCount||Z.monitoredTeamIds.length;ye=Pe>0?`Updated monitored teams (${Pe} team${Pe!==1?"s":""})`:"League set to not monitored (no teams selected)"}be.success(ye);const je=(Ee=v.current)==null?void 0:Ee.leagueId,xe=je==null?void 0:je.toString();await b.refetchQueries({queryKey:["leagues"]}),xe&&(await b.refetchQueries({queryKey:["league",xe]}),await b.refetchQueries({queryKey:["league-events",xe]})),I()},onError:G=>{be.error(G.message)}}),D=dr({mutationFn:async G=>{const Z=await Na(`/api/leagues/${G}`);if(!Z.ok){const oe=await Z.json();throw new Error(oe.error||"Failed to delete league")}return Z.json()},onSuccess:()=>{be.success("League removed from library"),te(),b.invalidateQueries({queryKey:["leagues"]})},onError:G=>{be.error(G.message)}}),O=G=>{v.current={league:G,leagueId:null,editMode:!1},f(!1),c(!0)},U=(G,Z)=>{v.current={league:G,leagueId:Z,editMode:!0},f(!0),c(!0)},I=()=>{c(!1),f(!1),setTimeout(()=>{v.current=null},300)},F=(G,Z)=>{const oe=k.find(je=>je.id===G),ye=(oe==null?void 0:oe.eventCount)||0;w.current={leagueId:G,leagueName:Z,eventCount:ye},x(!0)},te=()=>{x(!1),setTimeout(()=>{w.current=null},300)},le=(G,Z,oe,ye,je,xe,Ee,Pe,Re)=>{const Qe=v.current;Qe!=null&&Qe.editMode&&Qe.leagueId?z.mutate({leagueId:Qe.leagueId,monitoredTeamIds:Z,monitorType:oe,qualityProfileId:ye,searchForMissingEvents:je,searchForCutoffUnmetEvents:xe,monitoredParts:Ee,monitoredSessionTypes:Re,applyMonitoredPartsToEvents:Pe,sport:G.strSport}):K.mutate({league:G,monitoredTeamIds:Z,monitorType:oe,qualityProfileId:ye,searchForMissingEvents:je,searchForCutoffUnmetEvents:xe,monitoredParts:Ee,monitoredSessionTypes:Re})},H=()=>{!K.isPending&&!z.isPending&&I()},X=()=>{w.current&&D.mutate(w.current.leagueId)},q=(G,Z,oe)=>{Z&&oe?a(`/leagues/${oe.id}`):O(G)};return t.jsxs("div",{className:"p-8",children:[t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Add League"}),t.jsx("p",{className:"text-gray-400",children:"Browse and add leagues from TheSportsDB to monitor their events"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6 mb-6",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Filter by Sport"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:rf.map(G=>t.jsxs("button",{onClick:()=>n(G.id),className:`px-4 py-2 rounded-lg font-medium transition-all ${r===G.id?"bg-red-600 text-white shadow-lg shadow-red-900/30":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`,children:[t.jsx("span",{className:"mr-2",children:G.icon}),G.name]},G.id))})]}),t.jsxs("div",{className:"relative",children:[t.jsx(Ks,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),t.jsx("input",{type:"text",value:e,onChange:G=>s(G.target.value),placeholder:"Filter leagues (e.g., UFC, Premier League, NBA)...",className:"w-full pl-10 pr-4 py-3 bg-black border border-red-900/30 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-red-600 focus:ring-1 focus:ring-red-600"})]}),t.jsxs("p",{className:"text-sm text-gray-500 mt-3",children:[" Showing ",T?"...":R.length," of ",S.length," leagues",e&&` matching "${e}"`,r!=="all"&&` in ${(ae=rf.find(G=>G.id===r))==null?void 0:ae.name}`]})]}),T&&t.jsxs("div",{className:"text-center py-16",children:[t.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-red-600 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-semibold text-gray-400 mb-2",children:"Loading Leagues..."}),t.jsx("p",{className:"text-gray-500",children:"Fetching all available leagues from TheSportsDB"})]}),!T&&R.length>0&&t.jsxs("div",{children:[t.jsx("div",{className:"flex items-center justify-between mb-4",children:t.jsxs("h2",{className:"text-xl font-semibold text-white",children:[r==="all"?"All Leagues":`${(ce=rf.find(G=>G.id===r))==null?void 0:ce.name} Leagues`," ","(",R.length,")"]})}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:R.map(G=>{const Z=E.get(G.idLeague),oe=!!Z,ye=(Z==null?void 0:Z.logoUrl)||G.strBadge||G.strLogo||G.logoUrl;return t.jsxs("div",{onClick:()=>q(G,oe,Z),className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg overflow-hidden hover:border-red-700/50 transition-all cursor-pointer",children:[t.jsx("div",{className:"h-32 bg-black/50 flex items-center justify-center p-4",children:ye?t.jsx("img",{src:ye,alt:G.strLeague,className:"max-h-full max-w-full object-contain"}):t.jsx("span",{className:"text-6xl opacity-50",title:G.strSport,children:cI(G.strSport)})}),t.jsxs("div",{className:"p-4",children:[t.jsx("div",{className:"flex items-start justify-between mb-2",children:t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:G.strLeague}),G.strLeagueAlternate&&t.jsx("p",{className:"text-sm text-gray-400 mb-2",children:G.strLeagueAlternate})]})}),t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx("span",{className:"px-2 py-1 bg-red-600/20 text-red-400 text-xs rounded font-medium",children:G.strSport}),G.strCountry&&t.jsxs("span",{className:"flex items-center gap-1 text-xs text-gray-400",children:[t.jsx(Gf,{className:"w-3 h-3"}),G.strCountry]}),G.intFormedYear&&t.jsxs("span",{className:"text-xs text-gray-500",children:["Est. ",G.intFormedYear]})]}),G.strDescriptionEN&&t.jsx("p",{className:"text-sm text-gray-400 mb-4 line-clamp-3",children:G.strDescriptionEN}),oe?t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onMouseEnter:()=>m(G.idLeague),onMouseLeave:()=>m(null),onClick:je=>{je.stopPropagation(),Z&&F(Z.id,G.strLeague)},className:`flex-1 py-2 rounded-lg font-medium border transition-all flex items-center justify-center gap-2 ${u===G.idLeague?"bg-red-900/40 text-red-300 border-red-700 hover:bg-red-900/60":"bg-green-900/30 text-green-400 border-green-700"}`,children:[t.jsx(rs,{className:"w-5 h-5"}),u===G.idLeague?"Remove from Library":"Added to Library"]}),t.jsx("button",{onClick:je=>{je.stopPropagation(),Z&&U(G,Z.id)},className:"px-4 py-2 rounded-lg font-medium bg-blue-600 hover:bg-blue-700 text-white transition-colors",children:"Edit"})]}):t.jsx("button",{onClick:je=>{je.stopPropagation(),O(G)},className:"w-full py-2 rounded-lg font-medium transition-all bg-red-600 hover:bg-red-700 text-white",children:t.jsxs("span",{className:"flex items-center justify-center gap-2",children:[t.jsx(bf,{className:"w-5 h-5"}),"Add to Library"]})})]})]},G.idLeague)})})]}),!T&&R.length===0&&t.jsxs("div",{className:"text-center py-16",children:[t.jsx(bf,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-semibold text-gray-400 mb-2",children:e||r!=="all"?"No Leagues Found":"No Leagues Available"}),t.jsx("p",{className:"text-gray-500",children:e||r!=="all"?"Try adjusting your search or filter to see more results":"No leagues are available in the database"})]})]}),t.jsx(pj,{league:((ee=v.current)==null?void 0:ee.league)||null,isOpen:o,onClose:H,onAdd:le,isAdding:K.isPending||z.isPending,editMode:((W=v.current)==null?void 0:W.editMode)||!1,leagueId:((V=v.current)==null?void 0:V.leagueId)||null}),t.jsx(xj,{isOpen:g,onClose:te,onConfirm:X,title:w.current?"Remove League from Library":void 0,message:w.current?`Are you sure you want to remove "${w.current.leagueName}" from your library?${w.current.eventCount>0?` This will remove the league and all ${w.current.eventCount} event${w.current.eventCount!==1?"s":""}.`:""}`:void 0,confirmText:"Remove League",confirmButtonClass:"bg-red-600 hover:bg-red-700",isLoading:D.isPending})]})}const Ip={Fighting:{bg:"bg-fuchsia-900/30",border:"border-fuchsia-700",text:"text-fuchsia-400",badge:"bg-fuchsia-600"},Soccer:{bg:"bg-green-900/30",border:"border-green-700",text:"text-green-400",badge:"bg-green-600"},Basketball:{bg:"bg-orange-900/30",border:"border-orange-700",text:"text-orange-400",badge:"bg-orange-600"},Football:{bg:"bg-blue-900/30",border:"border-blue-700",text:"text-blue-400",badge:"bg-blue-600"},Baseball:{bg:"bg-indigo-900/30",border:"border-indigo-700",text:"text-indigo-400",badge:"bg-indigo-600"},Hockey:{bg:"bg-cyan-900/30",border:"border-cyan-700",text:"text-cyan-400",badge:"bg-cyan-600"},Tennis:{bg:"bg-yellow-900/30",border:"border-yellow-700",text:"text-yellow-400",badge:"bg-yellow-600"},Golf:{bg:"bg-lime-900/30",border:"border-lime-700",text:"text-lime-400",badge:"bg-lime-600"},Racing:{bg:"bg-purple-900/30",border:"border-purple-700",text:"text-purple-400",badge:"bg-purple-600"},default:{bg:"bg-gray-900/30",border:"border-gray-700",text:"text-gray-400",badge:"bg-gray-600"}},uI=a=>Ip[a]||Ip.default,hI=(a,e)=>{if(a.status==="Live")return!0;const s=new Date,r=mj(a.eventDate,e),n=new Date(r.getTime()+14400*1e3);return s>=r&&s<=n};function fI(){const{data:a,isLoading:e,error:s}=_k(),{timezone:r}=Zf(),n=Ta(),[o,c]=y.useState(0),[d,f]=y.useState("all"),[u,m]=y.useState(!1),[g,x]=y.useState(!1),b=y.useRef(null),v=Array.from(new Set(a==null?void 0:a.map(F=>F.sport).filter(Boolean))),w=()=>{const F=new Date;if(r){const te={year:"numeric",month:"2-digit",day:"2-digit",timeZone:r},H=new Intl.DateTimeFormat("en-US",te).formatToParts(F),X=ee=>{var W;return((W=H.find(V=>V.type===ee))==null?void 0:W.value)||"0"},q=parseInt(X("year")),ae=parseInt(X("month"))-1,ce=parseInt(X("day"));return new Date(q,ae,ce,0,0,0,0)}return new Date(F.getFullYear(),F.getMonth(),F.getDate(),0,0,0,0)},S=(F=0)=>{const te=w(),le=te.getDay(),H=new Date(te);return H.setDate(te.getDate()-le+F*7),H.setHours(0,0,0,0),H},T=(F=0)=>{const te=S(F),le=[];for(let H=0;H<7;H++){const X=new Date(te);X.setDate(te.getDate()+H),le.push(X)}return le},k=(F,te)=>{if(!te)return[];const le=`${F.getFullYear()}-${String(F.getMonth()+1).padStart(2,"0")}-${String(F.getDate()).padStart(2,"0")}`;return te.filter(H=>!H.monitored||d!=="all"&&H.sport!==d||u&&!H.broadcast?!1:KD(H.eventDate,r)===le)},E=T(o),R=E[0],K=E[6],z=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],D=["January","February","March","April","May","June","July","August","September","October","November","December"],O=()=>{const F=D[R.getMonth()],te=D[K.getMonth()],le=R.getDate(),H=K.getDate(),X=K.getFullYear();return F===te?`${F} ${le} - ${H}, ${X}`:`${F} ${le} - ${te} ${H}, ${X}`},U=F=>{const te=new Date(F+"T00:00:00"),le=w(),H=le.getDay(),X=new Date(le);X.setDate(le.getDate()-H);const q=te.getDay(),ae=new Date(te);ae.setDate(te.getDate()-q);const ce=ae.getTime()-X.getTime(),ee=Math.round(ce/(10080*60*1e3));c(ee)},I=F=>{const te=w();return F.getDate()===te.getDate()&&F.getMonth()===te.getMonth()&&F.getFullYear()===te.getFullYear()};return e?t.jsx("div",{className:"p-8",children:t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600"})})}):s?t.jsx("div",{className:"p-8",children:t.jsxs("div",{className:"bg-red-900 border border-red-700 text-red-100 px-4 py-3 rounded",children:[t.jsx("p",{className:"font-bold",children:"Error loading events"}),t.jsx("p",{className:"text-sm",children:s.message})]})}):t.jsx("div",{className:"p-4 md:p-8",children:t.jsxs("div",{className:"mx-auto",children:[t.jsxs("div",{className:"mb-4 md:mb-6",children:[t.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-white mb-1 md:mb-2",children:"Calendar"}),t.jsx("p",{className:"text-sm md:text-base text-gray-400",children:"View your monitored sports events"})]}),t.jsxs("div",{className:"flex items-center justify-center gap-2 md:gap-3",children:[t.jsx("button",{onClick:()=>c(o-1),className:"p-2 hover:bg-red-900/20 rounded-lg transition-colors",title:"Previous week",children:t.jsx(DN,{className:"w-5 md:w-6 h-5 md:h-6 text-gray-400 hover:text-white"})}),t.jsxs("div",{className:"text-center w-[180px] md:w-[280px]",children:[t.jsx("p",{className:"text-sm md:text-lg font-semibold text-white truncate",children:O()}),o===0&&t.jsx("p",{className:"text-xs md:text-sm text-red-400",children:"Current Week"})]}),t.jsx("button",{onClick:()=>c(o+1),className:"p-2 hover:bg-red-900/20 rounded-lg transition-colors",title:"Next week",children:t.jsx(_c,{className:"w-5 md:w-6 h-5 md:h-6 text-gray-400 hover:text-white"})}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{ref:b,type:"date",className:"absolute opacity-0 w-0 h-0",onChange:F=>F.target.value&&U(F.target.value)}),t.jsx("button",{onClick:()=>{var F;return(F=b.current)==null?void 0:F.showPicker()},className:"p-2 hover:bg-red-900/20 rounded-lg transition-colors",title:"Go to date",children:t.jsx(aR,{className:"w-5 md:w-6 h-5 md:h-6 text-gray-400 hover:text-white"})})]}),o!==0&&t.jsx("button",{onClick:()=>c(0),className:"px-2 md:px-3 py-1 text-xs md:text-sm bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",title:"Go to current week",children:"Today"})]})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-4",children:[t.jsxs("button",{onClick:()=>x(!g),className:"flex items-center gap-2 px-3 md:px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors text-sm md:text-base",children:[t.jsx(au,{className:"w-4 md:w-5 h-4 md:h-5"}),"Filters",(d!=="all"||u)&&t.jsx("span",{className:"px-1.5 md:px-2 py-0.5 bg-red-600 text-white text-xs rounded-full",children:(d!=="all"?1:0)+(u?1:0)})]}),g&&t.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-4 animate-fade-in w-full md:w-auto",children:[t.jsxs("select",{value:d,onChange:F=>f(F.target.value),className:"px-2 md:px-3 py-2 bg-gray-800 border border-gray-700 text-white rounded-lg focus:outline-none focus:border-red-600 text-sm md:text-base",children:[t.jsx("option",{value:"all",children:"All Sports"}),v.map(F=>t.jsx("option",{value:F,children:F},F))]}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-sm md:text-base",children:[t.jsx("input",{type:"checkbox",checked:u,onChange:F=>m(F.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx(io,{className:"w-4 md:w-5 h-4 md:h-5 text-green-400"}),t.jsx("span",{className:"text-white",children:"TV Only"})]}),(d!=="all"||u)&&t.jsx("button",{onClick:()=>{f("all"),m(!1)},className:"text-red-400 hover:text-red-300 text-xs md:text-sm",children:"Clear"})]})]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-7 gap-2 md:gap-2",children:E.map((F,te)=>{const le=k(F,a),H=I(F);return t.jsxs("div",{className:`bg-gradient-to-br from-gray-900 to-black border rounded-lg overflow-hidden min-h-[100px] md:min-h-[200px] ${H?"border-amber-500 shadow-lg shadow-amber-900/30":"border-red-900/30"}`,children:[t.jsx("div",{className:`px-2 md:px-3 py-1.5 md:py-2 border-b ${H?"bg-amber-950/40 border-amber-900/40":"bg-gray-800/30 border-red-900/20"}`,children:t.jsxs("div",{className:"flex md:block items-center gap-2",children:[t.jsx("div",{className:"text-xs text-gray-400 font-medium",children:z[te]}),t.jsx("div",{className:`text-base md:text-lg font-bold ${H?"text-amber-400":"text-white"}`,children:F.getDate()})]})}),t.jsx("div",{className:`p-1.5 md:p-2 grid gap-1.5 md:gap-2 ${le.length===1?"grid-cols-1":le.length===2?"grid-cols-2":le.length>=3?"grid-cols-3":"grid-cols-1"}`,children:le.length>0?le.map(X=>{const q=uI(X.sport||"default"),ae=hI(X,r),ce=le.length>=2;return t.jsx("div",{onClick:()=>X.leagueId&&n(`/leagues/${X.leagueId}`),className:`${q.bg} hover:opacity-80 border ${ae?"border-red-500 ring-2 ring-red-500/50 animate-pulse":q.border} rounded p-1.5 transition-all cursor-pointer group relative`,title:`${X.title}${X.venue?`
${X.venue}`:""}${X.broadcast?`
 ${X.broadcast}`:""}`,children:t.jsxs("div",{className:"min-w-0",children:[X.sport&&t.jsx("span",{className:`inline-block px-1 py-0.5 ${q.badge} text-white text-[10px] rounded mb-0.5`,children:X.sport}),t.jsx("p",{className:"text-[11px] font-semibold text-white group-hover:text-gray-200 transition-colors line-clamp-2",children:X.title}),t.jsxs("div",{className:"flex items-center gap-1 mt-0.5 flex-wrap",children:[ae&&t.jsx("span",{className:"px-1 py-0.5 bg-red-600 text-white text-[9px] rounded animate-pulse font-bold",children:"LIVE"}),X.hasFile&&t.jsx("span",{className:"px-1 py-0.5 bg-green-600/30 text-green-400 text-[9px] rounded",children:""}),X.broadcast&&!ce&&t.jsx("span",{className:"flex items-center gap-0.5 text-[9px] text-green-400",children:t.jsx(io,{className:"w-2.5 h-2.5"})})]})]})},X.id)}):t.jsx("div",{className:"text-center py-4 text-gray-600 text-xs",children:"No events"})})]},F.toISOString())})}),t.jsxs("div",{className:"mt-6",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-400 mb-3",children:"Legend"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[t.jsx("div",{className:"w-3 h-3 bg-amber-500 rounded"}),t.jsx("span",{children:"Today"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[t.jsx("div",{className:"w-3 h-3 bg-green-600 rounded"}),t.jsx("span",{children:"Downloaded"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[t.jsx(io,{className:"w-3 h-3 text-green-400"}),t.jsx("span",{children:"TV Schedule Available"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[t.jsx("div",{className:"w-3 h-3 bg-red-600 rounded ring-2 ring-red-500/50 animate-pulse"}),t.jsx("span",{children:"Live Now"})]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("h4",{className:"text-xs font-semibold text-gray-500 mb-2",children:"Sport Colors"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(Ip).filter(([F])=>F!=="default").map(([F,te])=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:`w-3 h-3 ${te.badge} rounded`}),t.jsx("span",{className:"text-xs text-gray-500",children:F})]},F))})]})]})]})})}function mI({pendingImport:a,onClose:e,onSuccess:s}){var Ce,_e,ge,Ze;const[r,n]=y.useState(!1),[o,c]=y.useState(((_e=(Ce=a.suggestedEvent)==null?void 0:Ce.league)==null?void 0:_e.id)||null),[d,f]=y.useState(((ge=a.suggestedEvent)==null?void 0:ge.season)||null),[u,m]=y.useState(a.suggestedEventId||null),[g,x]=y.useState(a.suggestedPart||null),[b,v]=y.useState(null),[w,S]=y.useState([]),[T,k]=y.useState([]),[E,R]=y.useState([]),[K,z]=y.useState([]),[D,O]=y.useState([]),[U,I]=y.useState(!0),[F,te]=y.useState(!1),[le,H]=y.useState(!1),[X,q]=y.useState(!1),[ae,ce]=y.useState(""),[ee,W]=y.useState(""),[V,G]=y.useState(!0);y.useEffect(()=>{const Me=setTimeout(()=>{W(ae)},300);return()=>clearTimeout(Me)},[ae]),y.useEffect(()=>{Z(),xe()},[]),y.useEffect(()=>{var Me,nt;o?(oe(o),(!((nt=(Me=a.suggestedEvent)==null?void 0:Me.league)!=null&&nt.id)||o!==a.suggestedEvent.league.id)&&(f(null),m(null),R([]))):(k([]),R([]))},[o]),y.useEffect(()=>{o&&ye(o,d,ee)},[o,d,ee]),y.useEffect(()=>{a.suggestedEventId||m(null)},[o,d]),y.useEffect(()=>{if(u){const Me=E.find(nt=>nt.id===u);Me!=null&&Me.usesMultiPart?je(Me.sport):(z([]),x(null),v(null))}else z([])},[u,E]);const Z=async()=>{I(!0);try{const Me=await kt("/api/leagues");if(Me.ok){const nt=await Me.json();S(nt)}}catch(Me){console.error("Failed to load leagues:",Me)}finally{I(!1)}},oe=async Me=>{te(!0);try{const nt=await kt(`/api/library/leagues/${Me}/seasons`);if(nt.ok){const ht=await nt.json();k(ht.seasons||[])}}catch(nt){console.error("Failed to load seasons:",nt)}finally{te(!1)}},ye=async(Me,nt,ht="")=>{H(!0);try{const Oe=new URLSearchParams;nt&&Oe.append("season",nt),ht&&Oe.append("search",ht),ht&&Oe.append("limit","200");const tt=Oe.toString(),Ct=`/api/library/leagues/${Me}/events${tt?`?${tt}`:""}`,we=await kt(Ct);if(we.ok){const bt=await we.json();R(bt.events||[])}}catch(Oe){console.error("Failed to load events:",Oe)}finally{H(!1)}},je=async Me=>{q(!0);try{const nt=await kt(`/api/library/parts/${encodeURIComponent(Me)}`);if(nt.ok){const ht=await nt.json();z(ht.parts||[])}}catch(nt){console.error("Failed to load parts:",nt)}finally{q(!1)}},xe=async()=>{try{const Me=await kt(`/api/pending-imports/${a.id}/matches`);Me.ok&&O(await Me.json())}catch(Me){console.error("Failed to load matches:",Me)}},Ee=Me=>{const nt=K.find(ht=>ht.name===Me);x(Me||null),v((nt==null?void 0:nt.partNumber)??null)},Pe=async()=>{var Me,nt;if(!u){alert("Please select an event to import to");return}n(!0);try{(u!==a.suggestedEventId||g!==a.suggestedPart)&&await br(`/api/pending-imports/${a.id}/suggestion`,{eventId:u,part:g}),await ds(`/api/pending-imports/${a.id}/accept`,{}),s()}catch(ht){console.error("Failed to import:",ht),alert(`Import failed: ${((nt=(Me=ht.response)==null?void 0:Me.data)==null?void 0:nt.error)||ht.message}`)}finally{n(!1)}},Re=async()=>{n(!0);try{await ds(`/api/pending-imports/${a.id}/reject`,{}),s()}catch(Me){console.error("Failed to reject:",Me)}finally{n(!1)}},Qe=Me=>{Me.eventId&&(m(Me.eventId),x(Me.part||null),Me.leagueId&&c(Me.leagueId),Me.season&&f(Me.season),G(!1))},ot=Me=>{if(Me===0)return"0 B";const nt=1024,ht=["B","KB","MB","GB","TB"],Oe=Math.floor(Math.log(Me)/Math.log(nt));return Math.round(Me/Math.pow(nt,Oe)*100)/100+" "+ht[Oe]},ne=Me=>new Date(Me).toLocaleDateString(),ke=Me=>Me>=80?"text-green-400":Me>=60?"text-yellow-400":"text-orange-400",Be=Me=>Me>=80?"bg-green-900/30 border-green-700":Me>=60?"bg-yellow-900/30 border-yellow-700":"bg-orange-900/30 border-orange-700",qe=E,dt=E.find(Me=>Me.id===u),He=w.find(Me=>Me.id===o);return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-700 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"sticky top-0 bg-gradient-to-br from-gray-900 to-black border-b border-gray-700 px-6 py-4 flex items-center justify-between z-10",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold text-white",children:"Manual Import"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Map download to an event in your library"})]}),t.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h4",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[t.jsx(Or,{className:"w-5 h-5 text-blue-400"}),"Download Information"]}),t.jsxs("div",{className:"grid grid-cols-2 gap-x-8 gap-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between col-span-2",children:[t.jsx("span",{className:"text-gray-400",children:"Title:"}),t.jsx("span",{className:"text-white max-w-lg truncate text-right",title:a.title,children:a.title})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-400",children:"Size:"}),t.jsx("span",{className:"text-white",children:ot(a.size)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-400",children:"Detected:"}),t.jsx("span",{className:"text-white",children:ne(a.detected)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-400",children:"Quality:"}),t.jsx("span",{className:"px-2 py-0.5 bg-purple-900/30 text-purple-400 text-xs rounded",children:a.quality||"Unknown"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-400",children:"Protocol:"}),t.jsx("span",{className:"px-2 py-0.5 bg-blue-900/30 text-blue-400 text-xs rounded uppercase",children:a.protocol||"Unknown"})]})]})]}),(a.suggestedEvent||D.length>0)&&V&&t.jsxs("div",{className:`rounded-lg p-4 border ${a.suggestedEvent?Be(a.suggestionConfidence):"bg-gray-800/50 border-gray-700"}`,children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(rs,{className:"w-5 h-5 text-green-400"}),t.jsx("h4",{className:"text-white font-medium",children:"AI Suggested Matches"})]}),t.jsx("button",{onClick:()=>G(!1),className:"text-xs text-gray-400 hover:text-white",children:"Hide suggestions"})]}),a.suggestedEvent&&t.jsx("div",{onClick:()=>{var Me,nt,ht,Oe,tt,Ct;return Qe({eventId:a.suggestedEventId,eventTitle:(Me=a.suggestedEvent)==null?void 0:Me.title,league:(ht=(nt=a.suggestedEvent)==null?void 0:nt.league)==null?void 0:ht.name,leagueId:(tt=(Oe=a.suggestedEvent)==null?void 0:Oe.league)==null?void 0:tt.id,season:(Ct=a.suggestedEvent)==null?void 0:Ct.season,part:a.suggestedPart,confidence:a.suggestionConfidence})},className:`p-3 rounded-lg border cursor-pointer transition-colors mb-2 ${u===a.suggestedEventId?"bg-red-900/30 border-red-500":"bg-gray-800/50 border-gray-600 hover:border-gray-500"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-white font-medium",children:a.suggestedEvent.title}),t.jsxs("div",{className:"text-sm text-gray-400",children:[((Ze=a.suggestedEvent.league)==null?void 0:Ze.name)||a.suggestedEvent.organization,a.suggestedEvent.season&&`  ${a.suggestedEvent.season}`]}),a.suggestedPart&&t.jsxs("div",{className:"text-sm text-blue-400 mt-1",children:["Part: ",a.suggestedPart]})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("span",{className:`text-sm font-bold ${ke(a.suggestionConfidence)}`,children:[a.suggestionConfidence,"%"]}),t.jsx("div",{className:"text-xs text-gray-500",children:"confidence"})]})]})}),D.length>0&&t.jsxs("div",{className:"mt-3",children:[t.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Other potential matches:"}),t.jsx("div",{className:"max-h-32 overflow-y-auto space-y-1",children:D.filter(Me=>Me.eventId!==a.suggestedEventId).slice(0,5).map((Me,nt)=>t.jsx("div",{onClick:()=>Qe(Me),className:`p-2 rounded border cursor-pointer transition-colors text-sm ${u===Me.eventId?"bg-red-900/30 border-red-500":"bg-gray-800/30 border-gray-700 hover:border-gray-600"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"truncate",children:[t.jsx("span",{className:"text-white",children:Me.eventTitle}),t.jsx("span",{className:"text-gray-500 ml-2",children:Me.league})]}),t.jsxs("span",{className:`text-xs font-medium ${ke(Me.confidence)}`,children:[Me.confidence,"%"]})]})},nt))})]})]}),t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h4",{className:"text-white font-medium flex items-center gap-2",children:[t.jsx(Ks,{className:"w-5 h-5 text-gray-400"}),V?"Or Select Manually":"Select Event"]}),!V&&(a.suggestedEvent||D.length>0)&&t.jsx("button",{onClick:()=>G(!0),className:"text-xs text-blue-400 hover:text-blue-300",children:"Show AI suggestions"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2 flex items-center gap-2",children:[t.jsx(Kr,{className:"w-4 h-4"}),"League"]}),t.jsxs("select",{value:o??"",onChange:Me=>c(Me.target.value?Number(Me.target.value):null),className:"w-full px-4 py-3 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-red-500 disabled:opacity-50",disabled:U,children:[t.jsx("option",{value:"",children:"Select a league..."}),w.map(Me=>t.jsxs("option",{value:Me.id,children:[Me.name," (",Me.sport,")"]},Me.id))]}),U&&t.jsxs("p",{className:"text-sm text-gray-500 mt-1 flex items-center gap-1",children:[t.jsx(Dt,{className:"w-3 h-3 animate-spin"})," Loading leagues..."]})]}),o&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2 flex items-center gap-2",children:[t.jsx(el,{className:"w-4 h-4"}),"Season"]}),t.jsxs("select",{value:d??"",onChange:Me=>f(Me.target.value||null),className:"w-full px-4 py-3 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-red-500 disabled:opacity-50",disabled:F,children:[t.jsx("option",{value:"",children:"All seasons"}),T.map(Me=>t.jsx("option",{value:Me,children:Me},Me))]}),F&&t.jsxs("p",{className:"text-sm text-gray-500 mt-1 flex items-center gap-1",children:[t.jsx(Dt,{className:"w-3 h-3 animate-spin"})," Loading seasons..."]})]}),o&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2 flex items-center gap-2",children:[t.jsx(En,{className:"w-4 h-4"}),"Event"]}),t.jsxs("div",{className:"relative mb-2",children:[t.jsx(Ks,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx("input",{type:"text",value:ae,onChange:Me=>ce(Me.target.value),placeholder:"Search by title, team, date, or event number...",className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-red-500"}),le&&ae&&t.jsx(Dt,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 animate-spin"})]}),ae&&E.length>0&&t.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:["Found ",E.length,' events matching "',ae,'"']}),le?t.jsxs("div",{className:"p-4 text-center text-gray-400",children:[t.jsx(Dt,{className:"w-5 h-5 animate-spin mx-auto mb-2"}),ae?`Searching for "${ae}"...`:"Loading events..."]}):qe.length===0?t.jsx("div",{className:"p-4 text-center text-gray-400 bg-gray-800 rounded-lg border border-gray-700",children:ae?t.jsxs(t.Fragment,{children:[t.jsxs("p",{children:['No events found matching "',ae,'"']}),t.jsx("p",{className:"text-xs mt-1",children:"Try a different search term or check if the event exists in this league"})]}):t.jsxs(t.Fragment,{children:[t.jsx("p",{children:"No events found in this league"}),t.jsx("p",{className:"text-xs mt-1",children:"Events may need to be synced first"})]})}):t.jsx("div",{className:"max-h-48 overflow-y-auto border border-gray-700 rounded-lg",children:qe.map(Me=>{const nt=u===Me.id;return t.jsx("div",{onClick:()=>m(Me.id),className:`p-3 cursor-pointer transition-colors ${nt?"bg-red-900/30 border-l-4 border-l-red-500":"bg-gray-800 hover:bg-gray-700 border-l-4 border-l-transparent"} ${Me.hasFile?"opacity-60":""}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:`font-medium truncate ${nt?"text-white":"text-gray-200"}`,children:Me.title}),t.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:[new Date(Me.eventDate).toLocaleDateString(),Me.season&&`  Season ${Me.season}`,Me.episodeNumber&&`  Episode ${Me.episodeNumber}`]})]}),Me.hasFile&&t.jsx("span",{className:"text-xs bg-yellow-900/50 text-yellow-400 px-2 py-0.5 rounded ml-2",children:"Has File"})]})},Me.id)})})]}),(dt==null?void 0:dt.usesMultiPart)&&K.length>0&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2 flex items-center gap-2",children:[t.jsx(vx,{className:"w-4 h-4"}),"Part / Session"]}),t.jsxs("select",{value:g??"",onChange:Me=>Ee(Me.target.value),className:"w-full px-4 py-3 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-red-500 disabled:opacity-50",disabled:X,children:[t.jsx("option",{value:"",children:"Auto-detect from filename"}),K.map(Me=>{const nt=dt.files.find(ht=>ht.partNumber===Me.partNumber);return t.jsxs("option",{value:Me.name,children:[Me.name," (pt",Me.partNumber,")",nt&&" - Has File"]},Me.name)})]}),X&&t.jsxs("p",{className:"text-sm text-gray-500 mt-1 flex items-center gap-1",children:[t.jsx(Dt,{className:"w-3 h-3 animate-spin"})," Loading parts..."]}),t.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Select the specific part/session this file represents, or leave as auto-detect"})]})]})]}),u&&dt&&t.jsxs("div",{className:"p-4 bg-green-900/20 border border-green-700 rounded-lg",children:[t.jsx("p",{className:"text-sm text-green-400 font-medium mb-1",children:"Ready to Import:"}),t.jsx("p",{className:"text-white",children:t.jsx("strong",{children:dt.title})}),t.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[He==null?void 0:He.name,d&&`  ${d}`,g&&`  ${g}`]})]}),!u&&!a.suggestedEvent&&D.length===0&&t.jsx("div",{className:"bg-yellow-900/20 border border-yellow-700/50 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Pr,{className:"w-5 h-5 text-yellow-400"}),t.jsx("p",{className:"text-yellow-400 text-sm",children:"No matching events found automatically. Please select a league and event manually, or ensure the event exists in your library."})]})})]}),t.jsxs("div",{className:"sticky bottom-0 bg-gradient-to-br from-gray-900 to-black border-t border-gray-700 px-6 py-4 flex justify-end gap-3",children:[t.jsx("button",{onClick:Re,disabled:r,className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 disabled:opacity-50 text-white rounded-lg transition-colors",children:"Reject"}),t.jsx("button",{onClick:e,className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:Pe,disabled:r||!u,className:"px-6 py-2 bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors font-medium",children:r?t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(Dt,{className:"w-4 h-4 animate-spin"}),"Importing..."]}):"Import"})]})]})})}const gI=["Queued","Downloading","Paused","Completed","Failed","Warning","Importing","Imported"],pI=["text-gray-400","text-blue-400","text-yellow-400","text-green-400","text-red-400","text-orange-400","text-purple-400","text-green-500"],xI=["Approved","Rejected","Already Imported","Upgraded"],yI=["text-green-400","text-red-400","text-yellow-400","text-blue-400"],bI=["Failed Download","Missing Files","Corrupted Files","Quality Mismatch","Manual Block","Import Failed"],vI=["text-red-400","text-orange-400","text-yellow-400","text-purple-400","text-blue-400","text-red-500"];function wI(){const[a,e]=y.useState("queue"),[s,r]=y.useState([]),[n,o]=y.useState([]),[c,d]=y.useState([]),[f,u]=y.useState([]),[m,g]=y.useState([]),[x,b]=y.useState(!1),[v,w]=y.useState(null),[S,T]=y.useState(!1),[k,E]=y.useState(null),[R,K]=y.useState(null),[z,D]=y.useState([]),[O,U]=y.useState(!1),[I,F]=y.useState(null),[te,le]=y.useState(!0),[H,X]=y.useState(!0),[q,ae]=y.useState(null),[ce,ee]=y.useState(null),[W,V]=y.useState(null),[G,Z]=y.useState("removeFromClient"),[oe,ye]=y.useState("none"),[je,xe]=y.useState("none"),[Ee,Pe]=y.useState(1),[Re,Qe]=y.useState(1),[ot,ne]=y.useState(null),[ke,Be]=y.useState(!1),[qe,dt]=y.useState(()=>{const re=localStorage.getItem("queuePageSize");return re?parseInt(re):200}),[He,Ce]=y.useState(()=>{const re=localStorage.getItem("queueShowUnknownEvents");return re?JSON.parse(re):!0}),[_e,ge]=y.useState(()=>{const re=localStorage.getItem("queueColumnOrder");return re?JSON.parse(re):["event","title","quality","protocol","indexer","status","progress","size","timeLeft","client","added","actions"]}),[Ze,Me]=y.useState(()=>{const re=localStorage.getItem("queueColumnVisibility");return re?JSON.parse(re):{event:!0,title:!0,quality:!0,protocol:!1,indexer:!1,status:!0,progress:!0,size:!0,timeLeft:!1,client:!0,added:!0,actions:!0}}),[nt,ht]=y.useState(null),[Oe,tt]=y.useState(!1),Ct=lt.useRef(null);lt.useRef(null);const[we,bt]=y.useState(new Set);y.useEffect(()=>{const re=()=>{tt(!0),Ct.current&&clearTimeout(Ct.current),Ct.current=setTimeout(()=>{tt(!1)},3e3)};return window.addEventListener("scroll",re),()=>{window.removeEventListener("scroll",re),Ct.current&&clearTimeout(Ct.current)}},[]);const ve=lt.useRef(a),xt=lt.useRef(Ee);y.useEffect(()=>{const re=ve.current!==a,Le=xt.current!==Ee;if(me(H||re||Le),ve.current=a,xt.current=Ee,a==="queue"){const it=setInterval(()=>{Oe||De(!1)},5e3);return ne(it),()=>clearInterval(it)}else ot&&(clearInterval(ot),ne(null))},[a,Ee]);const me=(re=!1)=>{a==="queue"?De(re):a==="history"?ue(re):a==="grabHistory"?mt(re):Fe(re)},De=async(re=!1)=>{try{re&&le(!0);const[Le,Je]=await Promise.all([at.get("/queue"),at.get("/pending-imports")]);r(Le.data),o(Je.data)}catch(Le){console.error("Failed to load queue:",Le)}finally{re&&(le(!1),X(!1))}},ue=async(re=!1)=>{try{re&&le(!0);const Le=await at.get(`/history?page=${Ee}&pageSize=50`);d(Le.data.history),Qe(Le.data.totalPages)}catch(Le){console.error("Failed to load history:",Le)}finally{re&&(le(!1),X(!1))}},Fe=async(re=!1)=>{try{re&&le(!0);const Le=await at.get(`/blocklist?page=${Ee}&pageSize=50`);u(Le.data.blocklist),Qe(Le.data.totalPages)}catch(Le){console.error("Failed to load blocklist:",Le)}finally{re&&(le(!1),X(!1))}},mt=async(re=!1)=>{try{re&&le(!0);const Le=await at.get(`/grab-history?page=${Ee}&pageSize=50&missingOnly=${x}`);g(Le.data.history),Qe(Le.data.totalPages)}catch(Le){console.error("Failed to load grab history:",Le)}finally{re&&(le(!1),X(!1))}};lt.useEffect(()=>{a==="grabHistory"&&mt(!0)},[x]);const Se=async re=>{var Le,Je;try{w(re),await at.post(`/grab-history/${re}/regrab`),mt()}catch(it){console.error("Failed to re-grab:",it),alert(((Je=(Le=it.response)==null?void 0:Le.data)==null?void 0:Je.error)||"Failed to re-grab release")}finally{w(null)}},st=async()=>{var re,Le;try{T(!0);const it=(await at.post("/grab-history/regrab-missing")).data;alert(`Re-grabbed ${it.regrabbed} releases. ${it.failed} failed.`),mt()}catch(Je){console.error("Failed to bulk re-grab:",Je),alert(((Le=(re=Je.response)==null?void 0:re.data)==null?void 0:Le.error)||"Failed to re-grab missing releases")}finally{T(!1)}},wt=()=>{me()},yt=async re=>{var Le,Je;try{K(re),U(!0);const it=await at.get(`/pending-imports/${re.id}/pack-matches`);D(it.data.matches||[])}catch(it){console.error("Failed to load pack matches:",it),alert(((Je=(Le=it.response)==null?void 0:Le.data)==null?void 0:Je.error)||"Failed to load pack preview"),K(null)}finally{U(!1)}},Mt=async re=>{var Le,Je;try{F(re.id);const Et=(await at.post(`/pending-imports/${re.id}/import-pack`)).data;alert(`Pack imported: ${Et.filesImported} files imported, ${Et.filesSkipped} skipped, ${Et.filesDeleted} deleted`),K(null),De()}catch(it){console.error("Failed to import pack:",it),alert(((Je=(Le=it.response)==null?void 0:Le.data)==null?void 0:Je.error)||"Failed to import pack")}finally{F(null)}},Ke=re=>{ae({type:"queue",items:[{id:re.id,title:re.title,status:re.status,downloadClient:re.downloadClient}]}),Z("removeFromClient"),ye("none")},Vt=()=>{const re=P.filter(Le=>we.has(Le.id)).map(Le=>({id:Le.id,title:Le.title,status:Le.status,downloadClient:Le.downloadClient}));re.length!==0&&(ae({type:"queue",items:re}),Z("removeFromClient"),ye("none"))},Nt=async()=>{if(!(!q||q.items.length===0))try{await Promise.all(q.items.map(re=>at.delete(`/queue/${re.id}`,{params:{removalMethod:G,blocklistAction:oe}}))),ae(null),bt(new Set),De()}catch(re){console.error("Failed to remove queue item(s):",re)}},St=async re=>{try{await at.post(`/queue/${re.id}/import`),De()}catch(Le){console.error("Failed to force import:",Le)}},Kt=async re=>{var Le,Je;try{await at.post(`/queue/${re.id}/retry`),De()}catch(it){console.error("Failed to retry import:",it),alert(((Je=(Le=it.response)==null?void 0:Le.data)==null?void 0:Je.error)||"Failed to retry import")}},ws=async re=>{try{await at.delete(`/queue/${re.id}`,{params:{removalMethod:"removeFromClient",blocklistAction:"none"}}),De()}catch(Le){console.error("Failed to delete unmonitored download:",Le)}},Ne=re=>{ee({type:"history",id:re.id,eventId:re.eventId,title:re.destinationPath.split("/").pop()||re.destinationPath}),xe("none")},gt=async()=>{if(ce)try{await at.delete(`/history/${ce.id}`,{params:{blocklistAction:je}}),ee(null),ue()}catch(re){console.error("Failed to delete history item:",re)}},jt=re=>{V({type:"blocklist",id:re.id,eventId:re.eventId,title:re.title})},vt=async()=>{if(W)try{await at.delete(`/blocklist/${W.id}`),V(null),Fe()}catch(re){console.error("Failed to delete blocklist item:",re)}},os=re=>{if(re===0)return"0 B";const Le=1024,Je=["B","KB","MB","GB","TB"],it=Math.floor(Math.log(re)/Math.log(Le));return Math.round(re/Math.pow(Le,it)*100)/100+" "+Je[it]},xs=re=>{const Le=new Date(re),it=new Date().getTime()-Le.getTime(),Et=Math.floor(it/6e4),Ht=Math.floor(Et/60),_t=Math.floor(Ht/24);return Et<1?"Just now":Et<60?`${Et}m ago`:Ht<24?`${Ht}h ago`:_t<7?`${_t}d ago`:Le.toLocaleDateString()},hs=re=>{const Le={...Ze,[re]:!Ze[re]};Me(Le),localStorage.setItem("queueColumnVisibility",JSON.stringify(Le))},Yr=re=>{dt(re),localStorage.setItem("queuePageSize",re.toString())},M=()=>{const re=!He;Ce(re),localStorage.setItem("queueShowUnknownEvents",JSON.stringify(re))},C=re=>{ht(re)},j=(re,Le)=>{if(re.preventDefault(),!nt||nt===Le)return;const Je=[..._e],it=Je.indexOf(nt),Et=Je.indexOf(Le);Je.splice(it,1),Je.splice(Et,0,nt),ge(Je),localStorage.setItem("queueColumnOrder",JSON.stringify(Je))},_=()=>{ht(null)},P=He?s:s.filter(re=>re.event&&re.event.id),L=re=>{bt(Le=>{const Je=new Set(Le);return Je.has(re)?Je.delete(re):Je.add(re),Je})},$=()=>{we.size===P.length?bt(new Set):bt(new Set(P.map(re=>re.id)))},J=P.length>0&&we.size===P.length,de=we.size>0&&we.size<P.length,B=re=>({event:"Event",title:"Episode Title",quality:"Quality",protocol:"Protocol",indexer:"Indexer",status:"Status",progress:"Progress",size:"Size",timeLeft:"Time Left",client:"Download Client",added:"Added",actions:"Actions"})[re],se=(re,Le)=>{var Je,it,Et,Ht,_t;switch(re){case"event":return t.jsxs("td",{className:"px-3 py-2 min-w-[150px]",children:[t.jsxs("div",{className:"text-white text-xs font-medium break-words",children:[((Je=Le.event)==null?void 0:Je.title)||"Unknown Event",Le.part&&t.jsxs("span",{className:"text-blue-400 ml-1",children:["(",Le.part,")"]})]}),t.jsx("div",{className:"text-xs text-gray-400 break-words",children:(it=Le.event)==null?void 0:it.organization})]},"event");case"title":return t.jsx("td",{className:"px-3 py-2 min-w-[200px]",children:t.jsx("div",{className:"text-gray-300 text-xs break-words",children:Le.title})},"title");case"quality":return t.jsx("td",{className:"px-3 py-2 text-center",children:t.jsx("span",{className:"px-1.5 py-0.5 bg-purple-900/30 text-purple-400 text-xs rounded",children:Le.quality||"Unknown"})},"quality");case"protocol":return t.jsx("td",{className:"px-3 py-2 text-center",children:t.jsx("span",{className:"px-1.5 py-0.5 bg-blue-900/30 text-blue-400 text-xs rounded uppercase",children:Le.protocol||"Unknown"})},"protocol");case"indexer":return t.jsx("td",{className:"px-3 py-2 text-center",children:t.jsx("span",{className:"text-gray-400 text-xs",children:Le.indexer||"Unknown"})},"indexer");case"status":return t.jsxs("td",{className:"px-3 py-2 text-center",children:[t.jsxs("div",{className:`flex items-center justify-center gap-1 ${pI[Le.status]}`,children:[fe(Le.status),t.jsx("span",{className:"text-xs",children:gI[Le.status]})]}),Le.statusMessages&&Le.statusMessages.length>0&&t.jsx("div",{className:"mt-1 text-center",children:Le.statusMessages.map((It,Qt)=>t.jsx("div",{className:"text-xs text-orange-400 whitespace-nowrap",title:It,children:It},Qt))}),Le.errorMessage&&!((Et=Le.statusMessages)!=null&&Et.length)&&t.jsx("div",{className:"text-xs text-red-400 mt-1 text-center",title:Le.errorMessage,children:Le.errorMessage})]},"status");case"progress":return t.jsx("td",{className:"px-3 py-2",children:t.jsxs("div",{className:"w-20",children:[t.jsx("div",{className:"flex items-center justify-between text-xs text-gray-400 mb-0.5",children:t.jsxs("span",{children:[Le.progress.toFixed(1),"%"]})}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-1.5",children:t.jsx("div",{className:"bg-red-600 h-1.5 rounded-full transition-all",style:{width:`${Le.progress}%`}})})]})},"progress");case"size":return t.jsx("td",{className:"px-3 py-2 text-center",children:t.jsxs("div",{className:"text-gray-300 text-xs whitespace-nowrap",children:[os(Le.downloaded)," / ",os(Le.size)]})},"size");case"timeLeft":return t.jsx("td",{className:"px-3 py-2 text-center",children:t.jsx("span",{className:"text-gray-400 text-xs",children:Le.timeRemaining||"-"})},"timeLeft");case"client":return t.jsx("td",{className:"px-3 py-2 text-center",children:t.jsx("span",{className:"text-gray-400 text-xs",children:((Ht=Le.downloadClient)==null?void 0:Ht.name)||"Unknown"})},"client");case"added":return t.jsx("td",{className:"px-3 py-2 text-center",children:t.jsx("span",{className:"text-gray-400 text-xs",children:xs(Le.added)})},"added");case"actions":const Wt=((_t=Le.statusMessages)==null?void 0:_t.some(It=>It.includes("no longer monitored")))&&(Le.status===5||Le.status===3),Bt=Le.status===4&&Le.progress>=100;return t.jsx("td",{className:"px-3 py-2",children:t.jsxs("div",{className:"flex items-center justify-end gap-1",children:[Bt&&t.jsx("button",{onClick:()=>Kt(Le),className:"p-1.5 text-yellow-400 hover:text-yellow-300 hover:bg-yellow-900/30 rounded transition-colors",title:"Retry Import",children:t.jsx(Dt,{className:"w-4 h-4"})}),Wt&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>St(Le),className:"p-1.5 text-green-400 hover:text-green-300 hover:bg-green-900/30 rounded transition-colors",title:"Import Anyway",children:t.jsx(Po,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>ws(Le),className:"p-1.5 text-red-400 hover:text-red-300 hover:bg-red-900/30 rounded transition-colors",title:"Delete Download",children:t.jsx(cs,{className:"w-4 h-4"})})]}),t.jsx("button",{onClick:()=>Ke(Le),className:"p-1.5 text-red-400 hover:text-red-300 hover:bg-red-900/30 rounded transition-colors",title:"Remove",children:t.jsx(cs,{className:"w-4 h-4"})})]})},"actions");default:return null}},fe=re=>{switch(re){case 0:return t.jsx($r,{className:"w-4 h-4"});case 1:return t.jsx(qs,{className:"w-4 h-4 animate-bounce"});case 2:return t.jsx(Ss,{className:"w-4 h-4"});case 3:return t.jsx(rs,{className:"w-4 h-4"});case 4:return t.jsx(Ss,{className:"w-4 h-4"});case 5:return t.jsx(Pr,{className:"w-4 h-4"});case 6:return t.jsx(Po,{className:"w-4 h-4 animate-pulse"});case 7:return t.jsx(rs,{className:"w-4 h-4"});default:return t.jsx($r,{className:"w-4 h-4"})}},he=re=>{switch(re){case 0:return t.jsx(rs,{className:"w-4 h-4"});case 1:return t.jsx(Ss,{className:"w-4 h-4"});case 2:return t.jsx(Pr,{className:"w-4 h-4"});case 3:return t.jsx(Dt,{className:"w-4 h-4"});default:return t.jsx(rs,{className:"w-4 h-4"})}},pe=q==null?void 0:q.items.some(re=>re.status===3||re.status===7),Ue=q==null?void 0:q.items.some(re=>{var Le,Je;return((Le=re.downloadClient)==null?void 0:Le.postImportCategory)!=null&&((Je=re.downloadClient)==null?void 0:Je.postImportCategory)!==""}),Ge=pe&&!Ue;return t.jsx("div",{className:"p-4 md:p-8",children:t.jsxs("div",{className:"max-w-full mx-auto",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-white mb-1 md:mb-2",children:"Activity"}),t.jsx("p",{className:"text-sm md:text-base text-gray-400",children:"Monitor downloads and import history"})]}),t.jsxs("div",{className:"flex gap-2",children:[a==="queue"&&t.jsx("button",{onClick:()=>Be(!0),className:"flex items-center px-3 md:px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",title:"Table Options",children:t.jsx(ru,{className:"w-5 h-5"})}),t.jsxs("button",{onClick:wt,className:"flex items-center px-3 md:px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[t.jsx(Dt,{className:"w-5 h-5 md:mr-2"}),t.jsx("span",{className:"hidden md:inline",children:"Refresh"})]})]})]}),t.jsx("div",{className:"overflow-x-auto -mx-4 px-4 md:mx-0 md:px-0 mb-6",children:t.jsxs("div",{className:"flex space-x-1 bg-gray-900 p-1 rounded-lg inline-flex min-w-max",children:[t.jsxs("button",{onClick:()=>{e("queue"),Pe(1)},className:`px-3 md:px-6 py-2 rounded-md transition-all whitespace-nowrap text-sm md:text-base ${a==="queue"?"bg-red-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-800"}`,children:["Queue",s.length>0&&t.jsx("span",{className:"ml-1 md:ml-2 px-1.5 md:px-2 py-0.5 bg-red-700 text-white text-xs rounded-full",children:s.length})]}),t.jsx("button",{onClick:()=>{e("history"),Pe(1)},className:`px-3 md:px-6 py-2 rounded-md transition-all whitespace-nowrap text-sm md:text-base ${a==="history"?"bg-red-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-800"}`,children:"History"}),t.jsxs("button",{onClick:()=>{e("blocklist"),Pe(1)},className:`px-3 md:px-6 py-2 rounded-md transition-all whitespace-nowrap text-sm md:text-base ${a==="blocklist"?"bg-red-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-800"}`,children:["Blocklist",f.length>0&&t.jsx("span",{className:"ml-1 md:ml-2 px-1.5 md:px-2 py-0.5 bg-red-700 text-white text-xs rounded-full",children:f.length})]}),t.jsx("button",{onClick:()=>{e("grabHistory"),Pe(1)},className:`px-3 md:px-6 py-2 rounded-md transition-all whitespace-nowrap text-sm md:text-base ${a==="grabHistory"?"bg-red-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-800"}`,children:"Grab History"})]})}),te?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-4 border-red-600 border-t-transparent"}),t.jsx("p",{className:"mt-4 text-gray-400",children:"Loading..."})]}):a==="queue"?t.jsx("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-gray-700 rounded-lg overflow-hidden",children:P.length===0&&n.length===0?t.jsxs("div",{className:"p-12 text-center text-gray-400",children:[t.jsx(qs,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),t.jsx("p",{className:"text-lg",children:"No active downloads"}),t.jsx("p",{className:"text-sm mt-2",children:"Downloads will appear here when events are searched and sent to download clients"})]}):t.jsxs(t.Fragment,{children:[we.size>0&&t.jsxs("div",{className:"px-4 py-3 bg-gray-800 border-b border-gray-700 flex items-center justify-between",children:[t.jsxs("span",{className:"text-gray-300 text-sm",children:[we.size," item",we.size!==1?"s":""," selected"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>bt(new Set),className:"px-3 py-1.5 text-gray-400 hover:text-white text-sm transition-colors",children:"Clear Selection"}),t.jsxs("button",{onClick:Vt,className:"px-4 py-1.5 bg-red-600 hover:bg-red-700 text-white text-sm rounded transition-colors flex items-center gap-2",children:[t.jsx(cs,{className:"w-4 h-4"}),"Remove Selected"]})]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-800 text-gray-300 text-xs",children:[t.jsx("th",{className:"px-3 py-2 w-10",children:t.jsx("input",{type:"checkbox",checked:J,ref:re=>{re&&(re.indeterminate=de)},onChange:$,className:"w-4 h-4 bg-gray-700 border-gray-600 rounded text-red-600 focus:ring-red-600 focus:ring-2 cursor-pointer",title:J?"Deselect all":"Select all"})}),_e.map(re=>{if(!Ze[re])return null;const Le=re==="event"||re==="title"?"text-left":re==="actions"?"text-right":"text-center";return t.jsx("th",{className:`px-3 py-2 ${Le} font-medium`,children:B(re)},re)})]})}),t.jsxs("tbody",{className:"divide-y divide-gray-700",children:[n.map(re=>t.jsx("tr",{className:`${re.isPack?"bg-purple-900/10 hover:bg-purple-900/20 border-l-4 border-purple-500":"bg-yellow-900/10 hover:bg-yellow-900/20 border-l-4 border-yellow-500"} transition-colors`,children:t.jsx("td",{colSpan:_e.filter(Le=>Ze[Le]).length+1,className:"px-6 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(di,{className:`w-6 h-6 ${re.isPack?"text-purple-400":"text-yellow-400"} flex-shrink-0`}),t.jsxs("div",{children:[t.jsx("div",{className:"text-white font-medium flex items-center gap-2",children:re.isPack?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"px-2 py-0.5 bg-purple-600 text-white text-xs rounded-full",children:"PACK"}),"Multi-File Pack - ",re.fileCount," files, ",re.matchedEventsCount," matching events"]}):"External Download - Manual Import Needed"}),t.jsx("div",{className:"text-sm text-gray-300 mt-1",children:re.title}),!re.isPack&&re.suggestedEvent&&t.jsxs("div",{className:"text-sm text-gray-400 mt-1",children:["Suggested: ",re.suggestedEvent.title," (",re.suggestionConfidence,"% confidence)"]})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:async()=>{try{await at.post(`/pending-imports/${re.id}/remove-from-client`),De()}catch(Le){console.error("Failed to remove pending import from client:",Le)}},className:"px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors flex items-center gap-2",title:"Remove download from client and delete files",children:[t.jsx(cs,{className:"w-5 h-5"}),"Remove"]}),re.isPack?t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>yt(re),className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors flex items-center gap-2",title:"Preview which files will be imported",children:"Preview"}),t.jsxs("button",{onClick:()=>Mt(re),disabled:I===re.id,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:opacity-50 text-white rounded-lg transition-colors flex items-center gap-2",title:"Import all matching files from this pack",children:[I===re.id?t.jsx(Dt,{className:"w-5 h-5 animate-spin"}):t.jsx(Po,{className:"w-5 h-5"}),"Import Pack"]})]}):t.jsxs("button",{onClick:()=>E(re),className:"px-4 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg transition-colors flex items-center gap-2",children:[t.jsx(Po,{className:"w-5 h-5"}),"Manual Import"]})]})]})})},`pending-${re.id}`)),P.map(re=>t.jsxs("tr",{className:`hover:bg-gray-800/50 transition-colors ${we.has(re.id)?"bg-red-900/20":""}`,children:[t.jsx("td",{className:"px-3 py-2 w-10",children:t.jsx("input",{type:"checkbox",checked:we.has(re.id),onChange:()=>L(re.id),className:"w-4 h-4 bg-gray-700 border-gray-600 rounded text-red-600 focus:ring-red-600 focus:ring-2 cursor-pointer"})}),_e.map(Le=>Ze[Le]?se(Le,re):null)]},re.id))]})]})})]})}):a==="history"?t.jsx("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-gray-700 rounded-lg overflow-hidden",children:c.length===0?t.jsxs("div",{className:"p-12 text-center text-gray-400",children:[t.jsx(Po,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),t.jsx("p",{className:"text-lg",children:"No import history"}),t.jsx("p",{className:"text-sm mt-2",children:"Imported events will appear here once downloads complete"})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-800 text-gray-300 text-xs",children:[t.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Event"}),t.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Imported Path"}),t.jsx("th",{className:"px-3 py-2 text-center font-medium",children:"Quality"}),t.jsx("th",{className:"px-3 py-2 text-center font-medium",children:"Decision"}),t.jsx("th",{className:"px-3 py-2 text-center font-medium",children:"Size"}),t.jsx("th",{className:"px-3 py-2 text-center font-medium",children:"Imported"}),t.jsx("th",{className:"px-3 py-2 text-right font-medium",children:"Actions"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-700",children:c.map(re=>{var Le,Je;return t.jsxs("tr",{className:"hover:bg-gray-800/50 transition-colors",children:[t.jsxs("td",{className:"px-3 py-2 min-w-[150px]",children:[t.jsxs("div",{className:`text-xs font-medium break-words ${re.event?"text-white":"text-gray-500 italic"}`,children:[((Le=re.event)==null?void 0:Le.title)||"Unknown Event",re.part&&t.jsxs("span",{className:"text-blue-400 ml-1",children:["(",re.part,")"]})]}),t.jsx("div",{className:"text-xs text-gray-400 break-words",children:((Je=re.event)==null?void 0:Je.organization)||(re.eventId?`Event ID: ${re.eventId}`:"N/A")})]}),t.jsxs("td",{className:"px-3 py-2 min-w-[250px]",children:[t.jsx("div",{className:"text-gray-300 text-xs break-words",children:re.destinationPath}),re.warnings.length>0&&t.jsxs("div",{className:"text-xs text-yellow-400 mt-0.5",children:[re.warnings.length," warning(s)"]}),re.errors.length>0&&t.jsxs("div",{className:"text-xs text-red-400 mt-0.5",children:[re.errors.length," error(s)"]})]}),t.jsx("td",{className:"px-3 py-2 text-center",children:t.jsx("span",{className:"px-1.5 py-0.5 bg-purple-900/30 text-purple-400 text-xs rounded",children:re.quality})}),t.jsx("td",{className:"px-3 py-2",children:t.jsxs("div",{className:`flex items-center justify-center gap-1 ${yI[re.decision]}`,children:[he(re.decision),t.jsx("span",{className:"text-xs",children:xI[re.decision]})]})}),t.jsx("td",{className:"px-3 py-2 text-center",children:t.jsx("span",{className:"text-gray-300 text-xs",children:os(re.size)})}),t.jsx("td",{className:"px-3 py-2 text-center",children:t.jsx("span",{className:"text-gray-400 text-xs",children:xs(re.importedAt)})}),t.jsx("td",{className:"px-3 py-2",children:t.jsx("div",{className:"flex items-center justify-end",children:t.jsx("button",{onClick:()=>Ne(re),className:"p-1.5 text-red-400 hover:text-red-300 hover:bg-red-900/30 rounded transition-colors",title:"Delete",children:t.jsx(cs,{className:"w-4 h-4"})})})})]},re.id)})})]})}),Re>1&&t.jsxs("div",{className:"px-6 py-4 border-t border-gray-700 flex items-center justify-between",children:[t.jsx("button",{onClick:()=>Pe(Math.max(1,Ee-1)),disabled:Ee===1,className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded transition-colors",children:"Previous"}),t.jsxs("span",{className:"text-gray-400",children:["Page ",Ee," of ",Re]}),t.jsx("button",{onClick:()=>Pe(Math.min(Re,Ee+1)),disabled:Ee===Re,className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded transition-colors",children:"Next"})]})]})}):a==="blocklist"?t.jsx("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-gray-700 rounded-lg overflow-hidden",children:f.length===0?t.jsxs("div",{className:"p-12 text-center text-gray-400",children:[t.jsx(no,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),t.jsx("p",{className:"text-lg",children:"No blocked releases"}),t.jsx("p",{className:"text-sm mt-2",children:"Failed or rejected releases will appear here"})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-800 text-gray-300 text-xs",children:[t.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Event"}),t.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Title"}),t.jsx("th",{className:"px-3 py-2 text-center font-medium",children:"Indexer"}),t.jsx("th",{className:"px-3 py-2 text-center font-medium",children:"Reason"}),t.jsx("th",{className:"px-3 py-2 text-center font-medium",children:"Blocked"}),t.jsx("th",{className:"px-3 py-2 text-right font-medium",children:"Actions"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-700",children:f.map(re=>{var Le,Je;return t.jsxs("tr",{className:"hover:bg-gray-800/50 transition-colors",children:[t.jsxs("td",{className:"px-3 py-2 min-w-[150px]",children:[t.jsxs("div",{className:"text-white text-xs font-medium break-words",children:[((Le=re.event)==null?void 0:Le.title)||"Unknown Event",re.part&&t.jsxs("span",{className:"text-blue-400 ml-1",children:["(",re.part,")"]})]}),t.jsx("div",{className:"text-xs text-gray-400 break-words",children:(Je=re.event)==null?void 0:Je.organization})]}),t.jsxs("td",{className:"px-3 py-2 min-w-[200px]",children:[t.jsx("div",{className:"text-gray-300 text-xs break-words",children:re.title}),re.message&&t.jsx("div",{className:"text-xs text-gray-400 mt-0.5 break-words",children:re.message}),t.jsxs("div",{className:"text-xs text-gray-500 mt-0.5 font-mono",children:["Hash: ",re.torrentInfoHash.substring(0,16),"..."]})]}),t.jsx("td",{className:"px-3 py-2 text-center",children:t.jsx("span",{className:"text-gray-400 text-xs",children:re.indexer||"Unknown"})}),t.jsx("td",{className:"px-3 py-2",children:t.jsxs("div",{className:`flex items-center justify-center gap-1 ${vI[re.reason]}`,children:[t.jsx(no,{className:"w-4 h-4"}),t.jsx("span",{className:"text-xs",children:bI[re.reason]})]})}),t.jsx("td",{className:"px-3 py-2 text-center",children:t.jsx("span",{className:"text-gray-400 text-xs",children:xs(re.blockedAt)})}),t.jsx("td",{className:"px-3 py-2",children:t.jsx("div",{className:"flex items-center justify-end",children:t.jsx("button",{onClick:()=>jt(re),className:"p-1.5 text-red-400 hover:text-red-300 hover:bg-red-900/30 rounded transition-colors",title:"Remove from Blocklist",children:t.jsx(cs,{className:"w-4 h-4"})})})})]},re.id)})})]})}),Re>1&&t.jsxs("div",{className:"px-6 py-4 border-t border-gray-700 flex items-center justify-between",children:[t.jsx("button",{onClick:()=>Pe(Math.max(1,Ee-1)),disabled:Ee===1,className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded transition-colors",children:"Previous"}),t.jsxs("span",{className:"text-gray-400",children:["Page ",Ee," of ",Re]}),t.jsx("button",{onClick:()=>Pe(Math.min(Re,Ee+1)),disabled:Ee===Re,className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded transition-colors",children:"Next"})]})]})}):t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-gray-700 rounded-lg overflow-hidden",children:[t.jsxs("div",{className:"px-4 py-3 bg-gray-800 border-b border-gray-700 flex items-center justify-between",children:[t.jsx("div",{className:"flex items-center gap-4",children:t.jsxs("label",{className:"flex items-center gap-2 text-gray-300 text-sm cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:x,onChange:re=>b(re.target.checked),className:"w-4 h-4 bg-gray-700 border-gray-600 rounded text-red-600 focus:ring-red-600 focus:ring-2"}),"Show Missing Files Only"]})}),t.jsx("button",{onClick:st,disabled:S||m.filter(re=>!re.fileExists&&(re.hasDownloadUrl||re.hasTorrentHash)).length===0,className:"px-4 py-2 bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors flex items-center gap-2",children:S?t.jsxs(t.Fragment,{children:[t.jsx(Dt,{className:"w-4 h-4 animate-spin"}),"Re-grabbing..."]}):t.jsxs(t.Fragment,{children:[t.jsx(qs,{className:"w-4 h-4"}),"Re-grab All Missing"]})})]}),m.length===0?t.jsxs("div",{className:"p-12 text-center text-gray-400",children:[t.jsx(qs,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),t.jsx("p",{className:"text-lg",children:"No grab history"}),t.jsx("p",{className:"text-sm mt-2",children:x?"No missing files found in grab history":"Grabbed releases will appear here once downloads are sent to clients"})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-gray-800 text-gray-300 text-xs",children:[t.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Event"}),t.jsx("th",{className:"px-3 py-2 text-left font-medium",children:"Release"}),t.jsx("th",{className:"px-3 py-2 text-center font-medium",children:"Quality"}),t.jsx("th",{className:"px-3 py-2 text-center font-medium",children:"Indexer"}),t.jsx("th",{className:"px-3 py-2 text-center font-medium",children:"Protocol"}),t.jsx("th",{className:"px-3 py-2 text-center font-medium",children:"Size"}),t.jsx("th",{className:"px-3 py-2 text-center font-medium",children:"Status"}),t.jsx("th",{className:"px-3 py-2 text-center font-medium",children:"Grabbed"}),t.jsx("th",{className:"px-3 py-2 text-right font-medium",children:"Actions"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-700",children:m.map(re=>t.jsxs("tr",{className:"hover:bg-gray-800/50 transition-colors",children:[t.jsxs("td",{className:"px-3 py-2 min-w-[150px]",children:[t.jsxs("div",{className:"text-white text-xs font-medium break-words",children:[re.eventTitle||"Unknown Event",re.partName&&t.jsxs("span",{className:"text-blue-400 ml-1",children:["(",re.partName,")"]})]}),t.jsx("div",{className:"text-xs text-gray-400 break-words",children:re.leagueName})]}),t.jsx("td",{className:"px-3 py-2 min-w-[200px]",children:t.jsx("div",{className:"text-gray-300 text-xs break-words",children:re.title})}),t.jsx("td",{className:"px-3 py-2 text-center",children:t.jsx("span",{className:"px-1.5 py-0.5 bg-purple-900/30 text-purple-400 text-xs rounded",children:re.quality||"Unknown"})}),t.jsx("td",{className:"px-3 py-2 text-center",children:t.jsx("span",{className:"text-gray-400 text-xs",children:re.indexer})}),t.jsx("td",{className:"px-3 py-2 text-center",children:t.jsx("span",{className:"px-1.5 py-0.5 bg-blue-900/30 text-blue-400 text-xs rounded uppercase",children:re.protocol})}),t.jsx("td",{className:"px-3 py-2 text-center",children:t.jsx("span",{className:"text-gray-300 text-xs",children:os(re.size)})}),t.jsx("td",{className:"px-3 py-2 text-center",children:t.jsxs("div",{className:"flex flex-col items-center gap-1",children:[re.fileExists?t.jsxs("span",{className:"flex items-center gap-1 text-green-400 text-xs",children:[t.jsx(rs,{className:"w-4 h-4"}),"File Exists"]}):re.wasImported?t.jsxs("span",{className:"flex items-center gap-1 text-orange-400 text-xs",children:[t.jsx(Pr,{className:"w-4 h-4"}),"Missing"]}):t.jsxs("span",{className:"flex items-center gap-1 text-gray-400 text-xs",children:[t.jsx($r,{className:"w-4 h-4"}),"Not Imported"]}),re.regrabCount>0&&t.jsxs("span",{className:"text-xs text-gray-500",children:["Re-grabbed ",re.regrabCount,"x"]})]})}),t.jsx("td",{className:"px-3 py-2 text-center",children:t.jsx("span",{className:"text-gray-400 text-xs",children:xs(re.grabbedAt)})}),t.jsx("td",{className:"px-3 py-2",children:t.jsx("div",{className:"flex items-center justify-end gap-1",children:t.jsx("button",{onClick:()=>Se(re.id),disabled:v===re.id||!re.hasDownloadUrl&&!re.hasTorrentHash,className:"p-1.5 text-green-400 hover:text-green-300 hover:bg-green-900/30 disabled:opacity-50 disabled:cursor-not-allowed rounded transition-colors",title:!re.hasDownloadUrl&&!re.hasTorrentHash?"No download URL or torrent hash available":"Re-grab this release",children:v===re.id?t.jsx(Dt,{className:"w-4 h-4 animate-spin"}):t.jsx(qs,{className:"w-4 h-4"})})})})]},re.id))})]})}),Re>1&&t.jsxs("div",{className:"px-6 py-4 border-t border-gray-700 flex items-center justify-between",children:[t.jsx("button",{onClick:()=>Pe(Math.max(1,Ee-1)),disabled:Ee===1,className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded transition-colors",children:"Previous"}),t.jsxs("span",{className:"text-gray-400",children:["Page ",Ee," of ",Re]}),t.jsx("button",{onClick:()=>Pe(Math.min(Re,Ee+1)),disabled:Ee===Re,className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded transition-colors",children:"Next"})]})]})]}),q&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-700 rounded-lg max-w-2xl w-full p-6",children:[t.jsxs("div",{className:"flex items-start justify-between mb-6",children:[t.jsx("h3",{className:"text-xl font-bold text-white",children:q.items.length===1?`Remove - ${q.items[0].title.length>60?q.items[0].title.substring(0,60)+"...":q.items[0].title}`:`Remove ${q.items.length} Selected Downloads`}),t.jsx("button",{onClick:()=>ae(null),className:"text-gray-400 hover:text-white transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),q.items.length===1?t.jsxs("p",{className:"text-gray-300 mb-6",children:["Are you sure you want to remove '",q.items[0].title,"' from the queue?"]}):t.jsxs("div",{className:"mb-6",children:[t.jsxs("p",{className:"text-gray-300 mb-3",children:["Are you sure you want to remove the following ",q.items.length," downloads from the queue?"]}),t.jsx("div",{className:"max-h-40 overflow-y-auto bg-gray-800/50 rounded-lg p-3 space-y-1",children:q.items.map(re=>t.jsx("div",{className:"text-sm text-gray-400 truncate",title:re.title,children:re.title},re.id))})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("label",{className:"block text-gray-300 font-medium mb-2",children:"Removal Method"}),t.jsxs("select",{value:G,onChange:re=>Z(re.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600",children:[t.jsx("option",{value:"removeFromClient",children:"Remove from Download Client"}),Ge&&t.jsx("option",{value:"changeCategory",children:"Change Category"}),t.jsx("option",{value:"ignoreDownload",children:"Ignore Download"})]}),t.jsxs("p",{className:"text-sm text-yellow-500 mt-2",children:[G==="removeFromClient"&&"Removes download and file(s) from download client",G==="changeCategory"&&"Changes download to the 'Post-Import Category' from Download Client",G==="ignoreDownload"&&"Stops Sportarr from processing this download further"]})]}),t.jsxs("div",{className:"mb-6",children:[t.jsxs("label",{className:"block text-gray-300 font-medium mb-2",children:["Blocklist Release",q.items.length>1?"s":""]}),t.jsxs("select",{value:oe,onChange:re=>ye(re.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600",children:[t.jsx("option",{value:"none",children:"Do not Blocklist"}),t.jsxs("option",{value:"blocklistAndSearch",children:["Blocklist and Search for Replacement",q.items.length>1?"s":""]}),t.jsx("option",{value:"blocklistOnly",children:"Blocklist Only"})]}),t.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:[oe==="none"&&`The release${q.items.length>1?"s":""} will remain eligible for future RSS and Automatic searches`,oe==="blocklistAndSearch"&&`Blocklist release${q.items.length>1?"s":""} and search for replacement${q.items.length>1?"s":""}`,oe==="blocklistOnly"&&`Blocklist release${q.items.length>1?"s":""} without searching for replacement${q.items.length>1?"s":""}`]})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>ae(null),className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Close"}),t.jsxs("button",{onClick:Nt,className:"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:["Remove",q.items.length>1?` ${q.items.length} Downloads`:""]})]})]})}),ce&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-700 rounded-lg max-w-2xl w-full p-6",children:[t.jsxs("div",{className:"flex items-start justify-between mb-6",children:[t.jsxs("h3",{className:"text-xl font-bold text-white",children:["Remove - ",ce.title.length>60?ce.title.substring(0,60)+"...":ce.title]}),t.jsx("button",{onClick:()=>ee(null),className:"text-gray-400 hover:text-white transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsxs("p",{className:"text-gray-300 mb-6",children:["Are you sure you want to remove '",ce.title,"' from history?"]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("label",{className:"block text-gray-300 font-medium mb-2",children:"Blocklist Release"}),t.jsxs("select",{value:je,onChange:re=>xe(re.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600",children:[t.jsx("option",{value:"none",children:"Do not Blocklist"}),t.jsx("option",{value:"blocklistAndSearch",children:"Blocklist and Search"}),t.jsx("option",{value:"blocklistOnly",children:"Blocklist Only"})]}),t.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:[je==="none"&&"The release will remain eligible for future RSS and Automatic searches",je==="blocklistAndSearch"&&"Blocklist release and search for a replacement",je==="blocklistOnly"&&"Blocklist release without searching for a replacement"]})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>ee(null),className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Close"}),t.jsx("button",{onClick:gt,className:"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Remove"})]})]})}),W&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-700 rounded-lg max-w-2xl w-full p-6",children:[t.jsxs("div",{className:"flex items-start justify-between mb-6",children:[t.jsx("h3",{className:"text-xl font-bold text-white",children:"Remove from Blocklist"}),t.jsx("button",{onClick:()=>V(null),className:"text-gray-400 hover:text-white transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsxs("p",{className:"text-gray-300 mb-6",children:["Are you sure you want to remove '",W.title.length>60?W.title.substring(0,60)+"...":W.title,"' from the blocklist?"]}),t.jsx("p",{className:"text-sm text-yellow-500 mb-6",children:"This release will be allowed in future RSS and Automatic searches."}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>V(null),className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Close"}),t.jsx("button",{onClick:vt,className:"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Remove"})]})]})}),ke&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-700 rounded-lg max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"sticky top-0 bg-gradient-to-br from-gray-900 to-black border-b border-gray-700 px-6 py-4 flex items-center justify-between",children:[t.jsx("h3",{className:"text-xl font-bold text-white",children:"Table Options"}),t.jsx("button",{onClick:()=>Be(!1),className:"text-gray-400 hover:text-white transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"border-b border-gray-700 pb-4",children:[t.jsx("label",{className:"block text-gray-300 font-medium mb-2",children:"Page Size"}),t.jsx("input",{type:"number",value:qe,onChange:re=>Yr(parseInt(re.target.value)||200),min:"10",max:"1000",step:"10",className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600"}),t.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Number of items to show on each page"})]}),t.jsx("div",{className:"border-b border-gray-700 pb-4",children:t.jsxs("label",{className:"flex items-center gap-3 text-gray-300 hover:text-white cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:He,onChange:M,className:"w-4 h-4 bg-gray-700 border-gray-600 rounded text-red-600 focus:ring-red-600 focus:ring-2"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:"Show Unknown Events Items"}),t.jsx("div",{className:"text-sm text-gray-400",children:"Show items without a event in the queue, this could include removed events or anything else in Sportarr's category"})]})]})}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-gray-300 font-medium mb-3",children:"Columns"}),t.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Choose which columns are visible and drag to reorder"}),t.jsx("div",{className:"space-y-1 bg-gray-800/50 rounded-lg p-3",children:_e.map(re=>t.jsxs("div",{draggable:!0,onDragStart:()=>C(re),onDragOver:Le=>j(Le,re),onDragEnd:_,className:`flex items-center gap-3 px-3 py-2 rounded cursor-move transition-all ${nt===re?"bg-red-900/30 opacity-50":"hover:bg-gray-700/50"} group`,children:[t.jsx("input",{type:"checkbox",checked:Ze[re],onChange:()=>hs(re),onClick:Le=>Le.stopPropagation(),className:"w-4 h-4 bg-gray-700 border-gray-600 rounded text-red-600 focus:ring-red-600 focus:ring-2"}),t.jsx(fR,{className:"w-5 h-5 text-gray-500 group-hover:text-gray-400"}),t.jsx("span",{className:"flex-1 text-gray-300 group-hover:text-white",children:B(re)})]},re))})]})]}),t.jsx("div",{className:"sticky bottom-0 bg-gradient-to-br from-gray-900 to-black border-t border-gray-700 px-6 py-4 flex justify-end",children:t.jsx("button",{onClick:()=>Be(!1),className:"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Close"})})]})}),k&&t.jsx(mI,{pendingImport:k,onClose:()=>E(null),onSuccess:()=>{E(null),De()}}),R&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-purple-700 rounded-lg max-w-3xl w-full max-h-[80vh] overflow-hidden flex flex-col",children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-700 flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[t.jsx("span",{className:"px-2 py-0.5 bg-purple-600 text-white text-xs rounded-full",children:"PACK"}),"Pack Preview"]}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:R.title})]}),t.jsx("button",{onClick:()=>K(null),className:"text-gray-400 hover:text-white transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:O?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-purple-600 border-t-transparent"}),t.jsx("p",{className:"mt-4 text-gray-400",children:"Scanning pack for matching events..."})]}):z.length===0?t.jsxs("div",{className:"text-center py-12 text-gray-400",children:[t.jsx(Pr,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No matching monitored events found in this pack"}),t.jsx("p",{className:"text-sm mt-2",children:"Make sure you have events monitored that match the files in this pack"})]}):t.jsxs("div",{className:"space-y-2",children:[t.jsxs("p",{className:"text-gray-300 mb-4",children:["Found ",t.jsx("span",{className:"text-purple-400 font-bold",children:z.length})," files matching monitored events:"]}),t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"text-gray-400 text-xs border-b border-gray-700",children:[t.jsx("th",{className:"text-left py-2 px-2",children:"File"}),t.jsx("th",{className:"text-left py-2 px-2",children:"Matched Event"}),t.jsx("th",{className:"text-center py-2 px-2",children:"Confidence"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-800",children:z.map((re,Le)=>t.jsxs("tr",{className:"hover:bg-gray-800/50",children:[t.jsx("td",{className:"py-2 px-2 text-sm text-gray-300 break-all",children:re.fileName}),t.jsx("td",{className:"py-2 px-2 text-sm text-white",children:re.eventTitle}),t.jsx("td",{className:"py-2 px-2 text-center",children:t.jsxs("span",{className:`px-2 py-0.5 rounded text-xs ${re.matchConfidence>=80?"bg-green-900/50 text-green-400":re.matchConfidence>=50?"bg-yellow-900/50 text-yellow-400":"bg-red-900/50 text-red-400"}`,children:[re.matchConfidence,"%"]})})]},Le))})]})]})}),t.jsxs("div",{className:"px-6 py-4 border-t border-gray-700 flex justify-between items-center",children:[t.jsx("p",{className:"text-sm text-gray-400",children:"Unmatched files will be deleted after import"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>K(null),className:"px-6 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Close"}),t.jsx("button",{onClick:()=>Mt(R),disabled:I===R.id||z.length===0,className:"px-6 py-2 bg-purple-600 hover:bg-purple-700 disabled:opacity-50 text-white rounded-lg transition-colors flex items-center gap-2",children:I===R.id?t.jsxs(t.Fragment,{children:[t.jsx(Dt,{className:"w-5 h-5 animate-spin"}),"Importing..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Po,{className:"w-5 h-5"}),"Import ",z.length," Files"]})})]})]})]})})]})})}const SI=()=>{const[a,e]=y.useState("missing"),[s,r]=y.useState([]),[n,o]=y.useState([]),[c,d]=y.useState(!0),[f,u]=y.useState(null),[m,g]=y.useState(1),[x,b]=y.useState(0),v=20,[w,S]=y.useState({isOpen:!1,eventId:0,eventTitle:""}),[T,k]=y.useState([]),{data:E}=RN(),R=Math.ceil(x/v);y.useEffect(()=>{const H=setInterval(()=>{const X=Date.now();k(q=>q.filter(ae=>{var ce,ee;if(X-ae.queuedAt>1e4)return!1;if(E){const W=(ce=E.pendingSearches)==null?void 0:ce.some(G=>G.eventId===ae.eventId),V=(ee=E.activeSearches)==null?void 0:ee.some(G=>G.eventId===ae.eventId);if(W||V)return!1}return!0}))},1e3);return()=>clearInterval(H)},[E]),y.useEffect(()=>{K()},[a,m]);const K=async()=>{d(!0),u(null);try{const H=a==="missing"?`/api/wanted/missing?page=${m}&pageSize=${v}`:`/api/wanted/cutoff-unmet?page=${m}&pageSize=${v}`,X=await kt(H);if(!X.ok)throw new Error("Failed to fetch wanted events");const q=await X.json();a==="missing"?r(q.events):o(q.events),b(q.totalRecords)}catch(H){u(H instanceof Error?H.message:"An error occurred")}finally{d(!1)}},z=y.useCallback(H=>{var X,q;if(T.some(ae=>ae.eventId===H))return"queued";if(E){if((X=E.activeSearches)!=null&&X.some(ae=>ae.eventId===H))return"searching";if((q=E.pendingSearches)!=null&&q.some(ae=>ae.eventId===H))return"queued"}return"idle"},[T,E]),D=async(H,X)=>{const q=z(H);if(q==="searching"){be.info("Search in progress",{description:`Already searching for "${X}"`});return}if(q==="queued"){be.info("Search already queued",{description:`"${X}" is waiting in queue`});return}k(ae=>[...ae,{eventId:H,queuedAt:Date.now()}]);try{if(!(await ds("/api/search/queue",{eventId:H})).ok)throw k(ce=>ce.filter(ee=>ee.eventId!==H)),new Error("Failed to trigger search");be.success("Search Queued",{description:"Search added to queue. Check sidebar for progress."})}catch(ae){k(ce=>ce.filter(ee=>ee.eventId!==H)),be.error("Search Failed",{description:ae instanceof Error?ae.message:"Failed to queue search."})}},O=(H,X)=>{S({isOpen:!0,eventId:H,eventTitle:X})},U=async H=>{try{if(!(await br(`/api/events/${H.id}`,{monitored:!H.monitored})).ok)throw new Error("Failed to update event");be.success("Event Updated",{description:`${H.title} is now ${H.monitored?"unmonitored":"monitored"}.`}),K()}catch(X){be.error("Update Failed",{description:X instanceof Error?X.message:"Failed to update event."})}},I=H=>new Date(H).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),F=H=>{const X=new Date(H),q=new Date,ae=X.getTime()-q.getTime(),ce=Math.ceil(ae/(1e3*60*60*24));return ce<0?`${Math.abs(ce)} days ago`:ce===0?"Today":ce===1?"Tomorrow":`In ${ce} days`},te=H=>{const X=new Date(H.eventDate)<new Date,q=H.homeTeamName&&H.awayTeamName?`${H.homeTeamName} vs ${H.awayTeamName}`:null,ae=z(H.id);return t.jsx("div",{className:"bg-gray-800 rounded-lg p-4 hover:bg-gray-750 transition-colors border border-gray-700",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("h3",{className:"text-lg font-semibold text-white",children:H.title}),H.leagueName&&t.jsx("span",{className:"px-2 py-1 bg-blue-900/30 text-blue-400 text-xs rounded",children:H.leagueName}),t.jsx("span",{className:"px-2 py-1 bg-red-600/20 text-red-400 text-xs rounded",children:H.sport}),X&&t.jsxs("span",{className:"px-2 py-1 bg-red-900/30 text-red-400 text-xs rounded flex items-center gap-1",children:[t.jsx($r,{className:"w-3 h-3"}),"Past Event"]}),ae==="queued"&&t.jsxs("span",{className:"px-2 py-1 bg-yellow-900/30 text-yellow-400 text-xs rounded flex items-center gap-1 animate-pulse",children:[t.jsx(yf,{className:"w-3 h-3"}),"Queued"]}),ae==="searching"&&t.jsxs("span",{className:"px-2 py-1 bg-blue-900/30 text-blue-400 text-xs rounded flex items-center gap-1",children:[t.jsx(Ks,{className:"w-3 h-3 animate-spin"}),"Searching..."]})]}),q&&t.jsxs("p",{className:"text-sm text-gray-400 mb-2",children:[q,H.round&&` - ${H.round}`]}),t.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[t.jsx("span",{children:I(H.eventDate)}),t.jsx("span",{className:"text-gray-600",children:""}),t.jsx("span",{className:X?"text-red-400":"text-blue-400",children:F(H.eventDate)}),H.location&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"text-gray-600",children:""}),t.jsx("span",{children:H.location})]})]}),a==="cutoff-unmet"&&H.quality&&t.jsx("div",{className:"mt-2",children:t.jsxs("span",{className:"text-xs text-yellow-400",children:["Current Quality: ",H.quality," (Below cutoff)"]})})]}),t.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[t.jsx("button",{onClick:()=>U(H),className:`px-3 py-1 rounded text-sm transition-colors ${H.monitored?"bg-green-900/30 text-green-400 hover:bg-green-900/50":"bg-gray-700 text-gray-400 hover:bg-gray-600"}`,children:H.monitored?"Monitored":"Unmonitored"}),t.jsx("button",{onClick:()=>O(H.id,H.title),className:"p-2 bg-gray-700 text-gray-300 rounded hover:bg-gray-600 transition-colors",title:"Manual Search - Browse and select from available releases",children:t.jsx(sf,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>D(H.id,H.title),disabled:ae!=="idle",className:`p-2 rounded transition-colors ${ae==="idle"?"bg-blue-900/30 text-blue-400 hover:bg-blue-900/50":ae==="queued"?"bg-yellow-900/30 text-yellow-400 cursor-not-allowed":"bg-blue-900/50 text-blue-300 cursor-not-allowed"}`,title:ae==="idle"?"Auto Search - Queue automatic search for event":ae==="queued"?"Search queued - waiting to start":"Search in progress",children:ae==="searching"?t.jsx(Ks,{className:"w-5 h-5 animate-spin"}):ae==="queued"?t.jsx(yf,{className:"w-5 h-5"}):t.jsx(Ks,{className:"w-5 h-5"})})]})]})},H.id)},le=()=>R<=1?null:t.jsxs("div",{className:"flex items-center justify-between mt-6",children:[t.jsxs("div",{className:"text-sm text-gray-400",children:["Showing ",(m-1)*v+1," to"," ",Math.min(m*v,x)," of ",x," events"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>g(H=>Math.max(1,H-1)),disabled:m===1,className:"px-3 py-1 bg-gray-700 text-white rounded hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),t.jsxs("span",{className:"px-3 py-1 bg-gray-800 text-white rounded",children:["Page ",m," of ",R]}),t.jsx("button",{onClick:()=>g(H=>Math.min(R,H+1)),disabled:m===R,className:"px-3 py-1 bg-gray-700 text-white rounded hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]});return t.jsxs("div",{className:"p-8",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Wanted"}),t.jsx("p",{className:"text-gray-400",children:"Events that are monitored but missing files or below quality cutoff"})]}),t.jsxs("div",{className:"flex gap-4 mb-6 border-b border-gray-700",children:[t.jsxs("button",{onClick:()=>{e("missing"),g(1)},className:`px-4 py-2 font-medium transition-colors ${a==="missing"?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-white"}`,children:["Missing (",a==="missing"?x:"...",")"]}),t.jsxs("button",{onClick:()=>{e("cutoff-unmet"),g(1)},className:`px-4 py-2 font-medium transition-colors ${a==="cutoff-unmet"?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-white"}`,children:["Cutoff Unmet (",a==="cutoff-unmet"?x:"...",")"]})]}),t.jsx("div",{className:"mb-6 p-4 bg-blue-900/20 border border-blue-800 rounded-lg",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(di,{className:"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"}),t.jsx("div",{className:"text-sm text-gray-300",children:a==="missing"?t.jsxs(t.Fragment,{children:[t.jsx("strong",{className:"text-white",children:"Missing Events:"})," These are monitored events that don't have any files yet. Click the search icon to automatically search, or the person icon to manually browse and select releases."]}):t.jsxs(t.Fragment,{children:[t.jsx("strong",{className:"text-white",children:"Cutoff Unmet:"})," These events have files, but the quality is below your configured cutoff. Sportarr will continue searching for better quality releases to upgrade them."]})})]})}),c?t.jsxs("div",{className:"flex items-center justify-center py-12",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-400"}),t.jsx("span",{className:"ml-3 text-gray-400",children:"Loading wanted events..."})]}):f?t.jsx("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-4",children:t.jsxs("p",{className:"text-red-400",children:["Error: ",f]})}):t.jsxs(t.Fragment,{children:[a==="missing"&&t.jsx("div",{className:"space-y-3",children:s.length===0?t.jsxs("div",{className:"text-center py-12 text-gray-400",children:[t.jsx(di,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{children:"No missing events! All monitored events have files."})]}):s.map(te)}),a==="cutoff-unmet"&&t.jsx("div",{className:"space-y-3",children:n.length===0?t.jsxs("div",{className:"text-center py-12 text-gray-400",children:[t.jsx(di,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{children:"No events below quality cutoff! All files meet your quality standards."})]}):n.map(te)}),le()]}),t.jsx(gj,{isOpen:w.isOpen,onClose:()=>S({...w,isOpen:!1}),eventId:w.eventId,eventTitle:w.eventTitle})]})};function yj({isOpen:a,onClose:e,onSelect:s,title:r="Select Folder"}){const[n,o]=y.useState(""),[c,d]=y.useState([]),[f,u]=y.useState(null),[m,g]=y.useState(!1),[x,b]=y.useState(null);y.useEffect(()=>{a&&v("")},[a]);const v=async R=>{g(!0),b(null);try{const K=R?`?path=${encodeURIComponent(R)}`:"",z=await kt(`/api/filesystem${K}`);if(z.ok){const D=await z.json();d(D.directories),u(D.parent),o(R)}else{const D=await z.json();b(D.error||"Failed to load directory")}}catch(K){b("Failed to load directory"),console.error("Failed to load directory:",K)}finally{g(!1)}},w=R=>{(R.type==="drive"||R.type==="folder")&&v(R.path)},S=()=>{f!==null&&v(f)},T=()=>{n&&(s(n),e())},k=R=>`${(R/1073741824).toFixed(2)} GB`,E=()=>{if(!n)return[];const K=n.includes("\\")||n.includes(":")?"\\":"/",z=n.split(/[\\/]/).filter(Boolean),D=[];let O="";return z.forEach((U,I)=>{I===0?O=U.includes(":")?`${U}${K}`:`${K}${U}`:O+=`${K}${U}`,D.push({name:U,path:O})}),D};return a?t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg max-w-3xl w-full max-h-[80vh] flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-800",children:[t.jsx("h3",{className:"text-2xl font-bold text-white",children:r}),t.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsx("div",{className:"px-6 py-3 border-b border-gray-800 bg-black/30",children:t.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[t.jsx("button",{onClick:()=>v(""),className:"text-gray-400 hover:text-white transition-colors",children:t.jsx(yx,{className:"w-4 h-4"})}),E().map((R,K)=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(_c,{className:"w-3 h-3 text-gray-600"}),t.jsx("button",{onClick:()=>v(R.path),className:"text-gray-400 hover:text-white transition-colors",children:R.name})]},K))]})}),t.jsx("div",{className:"px-6 py-2 bg-gray-900/50 border-b border-gray-800",children:t.jsxs("p",{className:"text-sm text-gray-400",children:["Current: ",t.jsx("span",{className:"text-white",children:n||"Root"})]})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[x&&t.jsx("div",{className:"mb-4 p-4 bg-red-950/30 border border-red-900/50 rounded-lg",children:t.jsx("p",{className:"text-red-400",children:x})}),m?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-red-600"}),t.jsx("p",{className:"text-gray-400 mt-4",children:"Loading..."})]}):t.jsxs("div",{className:"space-y-1",children:[f!==null&&t.jsxs("button",{onClick:S,className:"w-full flex items-center p-3 hover:bg-gray-800/50 rounded-lg transition-colors text-left",children:[t.jsx(Kr,{className:"w-5 h-5 text-yellow-500 mr-3"}),t.jsx("span",{className:"text-white",children:".."})]}),c.map((R,K)=>t.jsxs("button",{onClick:()=>w(R),className:"w-full flex items-center justify-between p-3 hover:bg-gray-800/50 rounded-lg transition-colors text-left",children:[t.jsxs("div",{className:"flex items-center flex-1",children:[R.type==="drive"?t.jsx(bx,{className:"w-5 h-5 text-blue-500 mr-3"}):t.jsx(Kr,{className:"w-5 h-5 text-yellow-500 mr-3"}),t.jsx("span",{className:"text-white",children:R.name})]}),R.type==="drive"&&R.freeSpace&&R.totalSpace&&t.jsxs("span",{className:"text-sm text-gray-400 ml-4",children:[k(R.freeSpace)," free of ",k(R.totalSpace)]})]},K)),c.length===0&&!x&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx(Kr,{className:"w-16 h-16 text-gray-700 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500",children:"No folders found"})]})]})]}),t.jsxs("div",{className:"p-6 border-t border-gray-800 flex items-center justify-between",children:[t.jsx("div",{className:"text-sm text-gray-400",children:n?t.jsxs(t.Fragment,{children:["Selected: ",t.jsx("span",{className:"text-white",children:n})]}):"Select a folder from the list"}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:T,disabled:!n,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Select Folder"})]})]})]})}):null}function _I({isOpen:a,onClose:e,onSave:s,fileName:r,parsedTitle:n,parsedDate:o,currentMapping:c}){const[d,f]=y.useState((c==null?void 0:c.leagueId)??null),[u,m]=y.useState((c==null?void 0:c.season)??null),[g,x]=y.useState((c==null?void 0:c.eventId)??null),[b,v]=y.useState((c==null?void 0:c.partName)??null),[w,S]=y.useState((c==null?void 0:c.partNumber)??null),[T,k]=y.useState([]),[E,R]=y.useState([]),[K,z]=y.useState([]),[D,O]=y.useState([]),[U,I]=y.useState(!0),[F,te]=y.useState(!1),[le,H]=y.useState(!1),[X,q]=y.useState(!1),[ae,ce]=y.useState(""),[ee,W]=y.useState("");y.useEffect(()=>{const Re=setTimeout(()=>{W(ae)},300);return()=>clearTimeout(Re)},[ae]),y.useEffect(()=>{a&&V()},[a]),y.useEffect(()=>{d?(G(d),m(null),x(null),z([])):(R([]),z([]))},[d]),y.useEffect(()=>{d&&Z(d,u,ee)},[d,u,ee]),y.useEffect(()=>{x(null)},[d,u]),y.useEffect(()=>{if(g){const Re=K.find(Qe=>Qe.id===g);Re!=null&&Re.usesMultiPart?oe(Re.sport):(O([]),v(null),S(null))}else O([])},[g,K]);const V=async()=>{I(!0);try{const Re=await kt("/api/leagues");if(Re.ok){const Qe=await Re.json();k(Qe)}}catch(Re){console.error("Failed to load leagues:",Re)}finally{I(!1)}},G=async Re=>{te(!0);try{const Qe=await kt(`/api/library/leagues/${Re}/seasons`);if(Qe.ok){const ot=await Qe.json();R(ot.seasons||[])}}catch(Qe){console.error("Failed to load seasons:",Qe)}finally{te(!1)}},Z=async(Re,Qe,ot="")=>{H(!0);try{const ne=new URLSearchParams;Qe&&ne.append("season",Qe),ot&&ne.append("search",ot),ot&&ne.append("limit","200");const ke=ne.toString(),Be=`/api/library/leagues/${Re}/events${ke?`?${ke}`:""}`,qe=await kt(Be);if(qe.ok){const dt=await qe.json();z(dt.events||[])}}catch(ne){console.error("Failed to load events:",ne)}finally{H(!1)}},oe=async Re=>{q(!0);try{const Qe=await kt(`/api/library/parts/${encodeURIComponent(Re)}`);if(Qe.ok){const ot=await Qe.json();O(ot.parts||[])}}catch(Qe){console.error("Failed to load parts:",Qe)}finally{q(!1)}},ye=Re=>{const Qe=D.find(ot=>ot.name===Re);v(Re),S((Qe==null?void 0:Qe.partNumber)??null)},je=()=>{const Re=K.find(ne=>ne.id===g),Qe=T.find(ne=>ne.id===d),ot={eventId:g??void 0,eventTitle:Re==null?void 0:Re.title,leagueId:d??void 0,leagueName:Qe==null?void 0:Qe.name,season:u??void 0,partName:b??void 0,partNumber:w??void 0,createNew:!g};s(ot),e()},xe=K,Ee=K.find(Re=>Re.id===g),Pe=T.find(Re=>Re.id===d);return t.jsx(Bs,{show:a,as:lt.Fragment,children:t.jsxs(Xs,{onClose:e,className:"relative z-50",children:[t.jsx(Bs.Child,{as:lt.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t.jsx("div",{className:"fixed inset-0 bg-black/70"})}),t.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:t.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:t.jsx(Bs.Child,{as:lt.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:t.jsxs(Xs.Panel,{className:"w-full max-w-2xl transform overflow-hidden rounded-xl bg-gray-900 border border-gray-700 shadow-xl transition-all",children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-700 flex items-center justify-between",children:[t.jsx(Xs.Title,{className:"text-lg font-semibold text-white",children:"Edit File Details"}),t.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"p-6 space-y-6 max-h-[70vh] overflow-y-auto",children:[t.jsx("div",{className:"p-4 bg-gray-800 rounded-lg border border-gray-700",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(En,{className:"w-5 h-5 text-gray-400 mt-0.5"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-white font-medium truncate",children:r}),n&&t.jsxs("p",{className:"text-sm text-gray-400",children:["Parsed: ",n]}),o&&t.jsxs("p",{className:"text-sm text-gray-400",children:["Date: ",new Date(o).toLocaleDateString()]})]})]})}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2 flex items-center gap-2",children:[t.jsx(Kr,{className:"w-4 h-4"}),"League"]}),t.jsxs("select",{value:d??"",onChange:Re=>f(Re.target.value?Number(Re.target.value):null),className:"w-full px-4 py-3 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-red-500 disabled:opacity-50",disabled:U,children:[t.jsx("option",{value:"",children:"Select a league..."}),T.map(Re=>t.jsxs("option",{value:Re.id,children:[Re.name," (",Re.sport,")"]},Re.id))]}),U&&t.jsxs("p",{className:"text-sm text-gray-500 mt-1 flex items-center gap-1",children:[t.jsx(Dt,{className:"w-3 h-3 animate-spin"})," Loading leagues..."]})]}),d&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2 flex items-center gap-2",children:[t.jsx(el,{className:"w-4 h-4"}),"Season"]}),t.jsxs("select",{value:u??"",onChange:Re=>m(Re.target.value||null),className:"w-full px-4 py-3 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-red-500 disabled:opacity-50",disabled:F,children:[t.jsx("option",{value:"",children:"All seasons"}),E.map(Re=>t.jsx("option",{value:Re,children:Re},Re))]}),F&&t.jsxs("p",{className:"text-sm text-gray-500 mt-1 flex items-center gap-1",children:[t.jsx(Dt,{className:"w-3 h-3 animate-spin"})," Loading seasons..."]})]}),d&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2 flex items-center gap-2",children:[t.jsx(En,{className:"w-4 h-4"}),"Event"]}),t.jsxs("div",{className:"relative mb-2",children:[t.jsx(Ks,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx("input",{type:"text",value:ae,onChange:Re=>ce(Re.target.value),placeholder:"Search by title, team, date, or event number...",className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-red-500"}),le&&ae&&t.jsx(Dt,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 animate-spin"})]}),ae&&K.length>0&&t.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:["Found ",K.length,' events matching "',ae,'"']}),le?t.jsxs("div",{className:"p-4 text-center text-gray-400",children:[t.jsx(Dt,{className:"w-5 h-5 animate-spin mx-auto mb-2"}),ae?`Searching for "${ae}"...`:"Loading events..."]}):xe.length===0?t.jsx("div",{className:"p-4 text-center text-gray-400 bg-gray-800 rounded-lg border border-gray-700",children:ae?t.jsxs(t.Fragment,{children:[t.jsxs("p",{children:['No events found matching "',ae,'"']}),t.jsx("p",{className:"text-xs mt-1",children:"Try a different search term or check if the event exists in this league"})]}):t.jsxs(t.Fragment,{children:[t.jsx("p",{children:"No events found in this league"}),t.jsx("p",{className:"text-xs mt-1",children:"Events may need to be synced first"})]})}):t.jsx("div",{className:"max-h-48 overflow-y-auto border border-gray-700 rounded-lg",children:xe.map(Re=>{const Qe=g===Re.id;return t.jsx("div",{onClick:()=>x(Re.id),className:`p-3 cursor-pointer transition-colors ${Qe?"bg-red-900/30 border-l-4 border-l-red-500":"bg-gray-800 hover:bg-gray-700 border-l-4 border-l-transparent"} ${Re.hasFile?"opacity-50":""}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:`font-medium truncate ${Qe?"text-white":"text-gray-200"}`,children:Re.title}),t.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:[new Date(Re.eventDate).toLocaleDateString(),Re.season&&`  Season ${Re.season}`,Re.episodeNumber&&`  Episode ${Re.episodeNumber}`]})]}),Re.hasFile&&t.jsx("span",{className:"text-xs bg-yellow-900/50 text-yellow-400 px-2 py-0.5 rounded ml-2",children:"Has File"})]})},Re.id)})})]}),(Ee==null?void 0:Ee.usesMultiPart)&&D.length>0&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2 flex items-center gap-2",children:[t.jsx(vx,{className:"w-4 h-4"}),"Part / Session"]}),t.jsxs("select",{value:b??"",onChange:Re=>ye(Re.target.value),className:"w-full px-4 py-3 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-red-500 disabled:opacity-50",disabled:X,children:[t.jsx("option",{value:"",children:"Auto-detect from filename"}),D.map(Re=>{const Qe=Ee.files.find(ot=>ot.partNumber===Re.partNumber);return t.jsxs("option",{value:Re.name,children:[Re.name," (pt",Re.partNumber,")",Qe&&" - Has File"]},Re.name)})]}),X&&t.jsxs("p",{className:"text-sm text-gray-500 mt-1 flex items-center gap-1",children:[t.jsx(Dt,{className:"w-3 h-3 animate-spin"})," Loading parts..."]}),t.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Select the specific part/session this file represents, or leave as auto-detect"})]}),g&&t.jsxs("div",{className:"p-4 bg-green-900/20 border border-green-700 rounded-lg",children:[t.jsx("p",{className:"text-sm text-green-400 font-medium",children:"Import Summary:"}),t.jsxs("p",{className:"text-sm text-white mt-1",children:["File will be imported to: ",t.jsx("strong",{children:Ee==null?void 0:Ee.title})]}),Pe&&t.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["League: ",Pe.name,u&&`  Season: ${u}`,b&&`  Part: ${b}`]})]})]}),t.jsxs("div",{className:"px-6 py-4 border-t border-gray-700 flex justify-end gap-3",children:[t.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:je,disabled:!g,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Save"})]})]})})})})]})})}const NI=()=>{const[a,e]=y.useState("select"),[s,r]=y.useState(""),[n,o]=y.useState(!0),[c,d]=y.useState(!1),[f,u]=y.useState(!1),[m,g]=y.useState(null),[x,b]=y.useState(null),[v,w]=y.useState(new Set),[S,T]=y.useState(new Map),[k,E]=y.useState(!1),[R,K]=y.useState(null),[z,D]=y.useState(!1),[O,U]=y.useState(null),[I,F]=y.useState(!1),[te,le]=y.useState(""),[H,X]=y.useState([]),[q,ae]=y.useState(!1),ce=y.useRef(null),ee=[{key:"select",label:"Select Folder",number:1},{key:"review",label:"Review & Select",number:2},{key:"complete",label:"Complete",number:3}],W=async()=>{if(!s.trim()){b("Please select a folder path");return}e("scan"),u(!0),b(null),g(null),w(new Set),T(new Map);try{const ne=await ds(`/api/library/scan?folderPath=${encodeURIComponent(s)}&includeSubfolders=${n}`,{});if(!ne.ok)throw new Error("Failed to scan folder");const ke=await ne.json();g(ke);const Be=new Set(ke.matchedFiles.map(qe=>qe.filePath));w(Be),e("review")}catch(ne){b(ne instanceof Error?ne.message:"An error occurred"),e("select")}finally{u(!1)}},V=y.useCallback(ne=>{if(ce.current&&clearTimeout(ce.current),!ne.trim()||ne.length<3){X([]);return}ce.current=setTimeout(async()=>{ae(!0);try{const ke=await kt(`/api/library/search?query=${encodeURIComponent(ne)}`);if(ke.ok){const Be=await ke.json();X(Be.results||[])}}catch{console.error("Failed to search events")}finally{ae(!1)}},300)},[]);y.useEffect(()=>()=>{ce.current&&clearTimeout(ce.current)},[]);const G=ne=>{U(ne),D(!0)},Z=ne=>{if(!O)return;const ke=new Map(S);ke.set(O.filePath,ne),T(ke);const Be=new Set(v);Be.add(O.filePath),w(Be),U(null)},oe=ne=>{if(!O||!ne.id)return;const ke=new Map(S);ke.set(O.filePath,{eventId:ne.id,eventTitle:ne.title}),T(ke);const Be=new Set(v);Be.add(O.filePath),w(Be),F(!1),U(null),le(""),X([])},ye=async()=>{if(!m||v.size===0){b("No files selected for import");return}e("importing"),E(!0),b(null);try{const ne=Array.from(v).map(qe=>{const dt=[...m.matchedFiles,...m.unmatchedFiles,...m.alreadyInLibrary].find(Ce=>Ce.filePath===qe);if(!dt)throw new Error(`File not found: ${qe}`);const He=S.get(qe);return He?{filePath:dt.filePath,eventId:He.eventId,createNew:He.createNew??!1,eventTitle:He.eventTitle,partName:He.partName,partNumber:He.partNumber,leagueId:He.leagueId,season:He.season}:dt.matchedEventId||dt.existingEventId?{filePath:dt.filePath,eventId:dt.matchedEventId||dt.existingEventId,createNew:!1}:{filePath:dt.filePath,createNew:!0,eventTitle:dt.parsedTitle,organization:dt.parsedOrganization,eventDate:dt.parsedDate,quality:dt.quality}}),ke=await ds("/api/library/import",ne);if(!ke.ok)throw new Error("Failed to import files");const Be=await ke.json();K(Be),e("complete")}catch(ne){b(ne instanceof Error?ne.message:"An error occurred"),e("review")}finally{E(!1)}},je=ne=>{const ke=new Set(v);ke.has(ne)?ke.delete(ne):ke.add(ne),w(ke)},xe=()=>{if(!m)return;const ne=[...m.matchedFiles,...m.unmatchedFiles,...m.alreadyInLibrary].map(ke=>ke.filePath);w(new Set(ne))},Ee=()=>{if(!m)return;const ne=[...m.matchedFiles,...m.alreadyInLibrary].map(ke=>ke.filePath);w(new Set(ne))},Pe=()=>{w(new Set)},Re=()=>{e("select"),r(""),g(null),b(null),w(new Set),T(new Map),K(null)},Qe=ne=>{if(!ne)return null;let ke="bg-red-600";return ne>=80?ke="bg-green-600":ne>=60?ke="bg-yellow-600":ne>=40&&(ke="bg-orange-600"),t.jsxs("span",{className:`${ke} text-white text-xs px-2 py-0.5 rounded-full`,children:[ne,"%"]})},ot=ne=>ne==="select"||ne==="scan"?0:ne==="review"||ne==="importing"?1:ne==="complete"?2:0;return t.jsxs("div",{className:"p-8 max-w-6xl mx-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("h1",{className:"text-3xl font-bold text-white mb-2 flex items-center gap-3",children:[t.jsx(_p,{className:"w-8 h-8 text-red-500"}),"Library Import"]}),t.jsx("p",{className:"text-gray-400",children:"Import existing video files into your Sportarr library with proper organization and renaming"})]}),t.jsx("div",{className:"mb-8",children:t.jsx("div",{className:"flex items-center gap-2",children:ee.map((ne,ke)=>t.jsxs(lt.Fragment,{children:[t.jsxs("div",{className:`flex items-center gap-2 ${ot(a)===ke?"text-red-400":ot(a)>ke?"text-green-400":"text-gray-500"}`,children:[t.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold ${ot(a)===ke?"bg-red-600 text-white":ot(a)>ke?"bg-green-600 text-white":"bg-gray-700 text-gray-400"}`,children:ot(a)>ke?t.jsx(rs,{className:"w-6 h-6"}):ne.number}),t.jsx("span",{className:"font-medium hidden sm:inline",children:ne.label})]}),ke<ee.length-1&&t.jsx("div",{className:`flex-1 h-1 rounded ${ot(a)>ke?"bg-green-600":"bg-gray-700"}`})]},ne.key))})}),x&&t.jsx("div",{className:"mb-6 bg-red-900/20 border border-red-800 rounded-lg p-4",children:t.jsxs("p",{className:"text-red-400 flex items-center gap-2",children:[t.jsx(Ss,{className:"w-5 h-5"}),x]})}),a==="select"&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-red-900/30",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[t.jsx(Kr,{className:"w-12 h-12 text-yellow-400"}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold text-white",children:"Select Import Folder"}),t.jsx("p",{className:"text-gray-400",children:"Choose a folder containing video files to import"})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Folder Path"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",value:s,onChange:ne=>r(ne.target.value),placeholder:"Click Browse to select a folder...",className:"flex-1 px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-red-500",readOnly:!0}),t.jsxs("button",{onClick:()=>d(!0),className:"px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg border border-gray-600 flex items-center gap-2 transition-colors",children:[t.jsx(Np,{className:"w-5 h-5"}),"Browse"]})]})]}),t.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:n,onChange:ne=>o(ne.target.checked),className:"w-5 h-5 rounded border-gray-600 bg-gray-700 text-red-600 focus:ring-red-500"}),t.jsx("span",{className:"text-gray-300",children:"Include subfolders (recursive scan)"})]})]}),t.jsx("div",{className:"mt-6 p-4 bg-blue-900/20 border border-blue-800 rounded-lg",children:t.jsxs("p",{className:"text-sm text-gray-300",children:[t.jsx("strong",{className:"text-blue-400",children:"How it works:"})," Files will be scanned and matched to events using sports-specific filename parsing. Matched files will be moved/copied to your library folder with proper naming. Configure import behavior (move vs copy) in Settings  Media Management."]})}),t.jsx("div",{className:"mt-6 flex justify-end",children:t.jsxs("button",{onClick:W,disabled:!s.trim(),className:"px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg flex items-center gap-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:["Scan Folder",t.jsx(SS,{className:"w-5 h-5"})]})})]}),a==="scan"&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 border border-red-900/30 text-center",children:[t.jsx(Dt,{className:"w-16 h-16 mx-auto mb-4 text-red-400 animate-spin"}),t.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Scanning..."}),t.jsx("p",{className:"text-gray-400",children:"Analyzing video files and matching to events"})]}),a==="review"&&m&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700 text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-white",children:m.totalFiles}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Total Files"})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-green-700 text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-green-400",children:m.matchedFiles.length}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Auto-Matched"})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-yellow-700 text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-yellow-400",children:m.unmatchedFiles.length}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Unmatched"})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700 text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-gray-400",children:m.alreadyInLibrary.length}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Already Imported"})]})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-red-900/30 flex items-center gap-3 flex-wrap",children:[t.jsx("button",{onClick:xe,className:"px-3 py-1.5 bg-gray-700 text-white rounded hover:bg-gray-600 text-sm transition-colors",children:"Select All"}),t.jsx("button",{onClick:Ee,className:"px-3 py-1.5 bg-gray-700 text-white rounded hover:bg-gray-600 text-sm transition-colors",children:"Select Matched Only"}),t.jsx("button",{onClick:Pe,className:"px-3 py-1.5 bg-gray-700 text-white rounded hover:bg-gray-600 text-sm transition-colors",children:"Clear Selection"}),t.jsx("div",{className:"flex-1"}),t.jsxs("span",{className:"text-gray-400 text-sm",children:[v.size," file(s) selected"]})]}),t.jsxs("div",{className:"space-y-6",children:[m.matchedFiles.length>0&&t.jsxs("div",{children:[t.jsxs("h3",{className:"text-lg font-semibold text-white mb-3 flex items-center gap-2",children:[t.jsx(rs,{className:"w-6 h-6 text-green-400"}),"Matched Files (",m.matchedFiles.length,")"]}),t.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:m.matchedFiles.map(ne=>{const ke=v.has(ne.filePath),Be=S.get(ne.filePath);return t.jsx("div",{className:`p-3 bg-gray-800 rounded-lg border ${ke?"border-green-500":"border-gray-700"}`,children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("input",{type:"checkbox",checked:ke,onChange:()=>je(ne.filePath),className:"w-5 h-5 rounded border-gray-600 bg-gray-700 text-green-600"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-white font-medium truncate",children:ne.fileName}),t.jsxs("p",{className:"text-sm text-gray-400",children:[" ",t.jsx("span",{className:"text-green-400",children:(Be==null?void 0:Be.eventTitle)||ne.matchedEventTitle}),(Be==null?void 0:Be.partName)&&t.jsxs("span",{className:"text-blue-400 ml-1",children:["(",Be.partName,")"]}),t.jsxs("span",{className:"text-gray-500 ml-2",children:["(",ne.fileSizeFormatted,")"]})]})]}),!Be&&Qe(ne.matchConfidence),t.jsxs("button",{onClick:()=>G(ne),className:"px-3 py-1 bg-gray-600 hover:bg-gray-500 text-white text-sm rounded transition-colors flex items-center gap-1",title:"Edit match details",children:[t.jsx(jS,{className:"w-4 h-4"}),"Edit"]})]})},ne.filePath)})})]}),m.unmatchedFiles.length>0&&t.jsxs("div",{children:[t.jsxs("h3",{className:"text-lg font-semibold text-white mb-3 flex items-center gap-2",children:[t.jsx(di,{className:"w-6 h-6 text-yellow-400"}),"Unmatched Files (",m.unmatchedFiles.length,")"]}),t.jsx("p",{className:"text-sm text-gray-400 mb-2",children:'Click "Match" to manually select the league, season, event, and part for each file'}),t.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:m.unmatchedFiles.map(ne=>{const ke=v.has(ne.filePath),Be=S.get(ne.filePath);return t.jsx("div",{className:`p-3 bg-gray-800 rounded-lg border ${Be?"border-green-500":ke?"border-yellow-500":"border-gray-700"}`,children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("input",{type:"checkbox",checked:ke,onChange:()=>je(ne.filePath),className:"w-5 h-5 rounded border-gray-600 bg-gray-700 text-yellow-600"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-white font-medium truncate",children:ne.fileName}),t.jsxs("p",{className:"text-sm text-gray-400",children:[Be?t.jsxs(t.Fragment,{children:[t.jsx(Fd,{className:"w-3 h-3 inline mr-1"}),t.jsx("span",{className:"text-green-400",children:Be.eventTitle}),Be.partName&&t.jsxs("span",{className:"text-blue-400 ml-1",children:["(",Be.partName,")"]}),Be.leagueName&&t.jsxs("span",{className:"text-gray-500 ml-1",children:[" ",Be.leagueName]})]}):ne.parsedTitle?t.jsxs(t.Fragment,{children:["Parsed: ",ne.parsedTitle]}):t.jsx("span",{className:"text-yellow-400",children:"Will create new event"}),t.jsxs("span",{className:"text-gray-500 ml-2",children:["(",ne.fileSizeFormatted,")"]})]})]}),t.jsxs("button",{onClick:()=>G(ne),className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded transition-colors flex items-center gap-1",children:[t.jsx(jS,{className:"w-4 h-4"}),Be?"Edit":"Match"]})]})},ne.filePath)})})]}),m.alreadyInLibrary.length>0&&t.jsxs("div",{children:[t.jsxs("h3",{className:"text-lg font-semibold text-white mb-3 flex items-center gap-2",children:[t.jsx(rs,{className:"w-6 h-6 text-blue-400"}),"Already in Library (",m.alreadyInLibrary.length,")"]}),t.jsx("p",{className:"text-sm text-gray-400 mb-2",children:`These files are linked to events but may need re-importing if they weren't properly moved/renamed. Click "Re-import" to move them to the correct location with proper naming.`}),t.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:m.alreadyInLibrary.map(ne=>{const ke=v.has(ne.filePath),Be=S.get(ne.filePath);return t.jsx("div",{className:`p-3 bg-gray-800 rounded-lg border ${ke?"border-blue-500":"border-gray-700"}`,children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("input",{type:"checkbox",checked:ke,onChange:()=>je(ne.filePath),className:"w-5 h-5 rounded border-gray-600 bg-gray-700 text-blue-600"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-white font-medium truncate",children:ne.fileName}),t.jsxs("p",{className:"text-sm text-gray-400",children:[Be?t.jsxs(t.Fragment,{children:[t.jsx(Fd,{className:"w-3 h-3 inline mr-1"}),t.jsx("span",{className:"text-green-400",children:Be.eventTitle}),Be.partName&&t.jsxs("span",{className:"text-blue-400 ml-1",children:["(",Be.partName,")"]})]}):ne.matchedEventTitle?t.jsxs(t.Fragment,{children:["Current: ",t.jsx("span",{className:"text-blue-400",children:ne.matchedEventTitle})]}):t.jsxs("span",{className:"text-gray-500",children:["Linked to event #",ne.existingEventId]}),t.jsxs("span",{className:"text-gray-500 ml-2",children:["(",ne.fileSizeFormatted,")"]})]})]}),t.jsxs("button",{onClick:()=>G(ne),className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded transition-colors flex items-center gap-1",children:[t.jsx(Dt,{className:"w-4 h-4"}),"Re-import"]})]})},ne.filePath)})})]})]}),t.jsxs("div",{className:"flex justify-between pt-4",children:[t.jsxs("button",{onClick:()=>e("select"),className:"px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-lg flex items-center gap-2 transition-colors",children:[t.jsx(xf,{className:"w-5 h-5"}),"Back"]}),t.jsxs("button",{onClick:ye,disabled:v.size===0,className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg flex items-center gap-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:["Import ",v.size," File(s)",t.jsx(SS,{className:"w-5 h-5"})]})]})]}),a==="importing"&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-12 border border-red-900/30 text-center",children:[t.jsx(Dt,{className:"w-16 h-16 mx-auto mb-4 text-green-400 animate-spin"}),t.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Importing..."}),t.jsx("p",{className:"text-gray-400",children:"Moving files to library and updating database"})]}),a==="complete"&&R&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 border border-green-700",children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsx(rs,{className:"w-20 h-20 mx-auto mb-4 text-green-400"}),t.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Import Complete!"}),t.jsx("p",{className:"text-gray-400",children:"Your files have been imported to the library"})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[t.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-green-400",children:R.imported.length}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Imported"})]}),t.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-blue-400",children:R.created.length}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Created"})]}),t.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-gray-400",children:R.skipped.length}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Skipped"})]}),t.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-red-400",children:R.failed.length}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Failed"})]})]}),R.errors.length>0&&t.jsxs("div",{className:"mb-8 p-4 bg-red-900/20 border border-red-800 rounded-lg",children:[t.jsx("h3",{className:"text-red-400 font-medium mb-2",children:"Errors:"}),t.jsx("ul",{className:"text-sm text-red-400 space-y-1",children:R.errors.map((ne,ke)=>t.jsxs("li",{children:[" ",ne]},ke))})]}),t.jsx("div",{className:"flex justify-center",children:t.jsx("button",{onClick:Re,className:"px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg flex items-center gap-2 transition-colors font-medium",children:"Import More Files"})})]}),t.jsx(yj,{isOpen:c,onClose:()=>d(!1),onSelect:ne=>r(ne),title:"Select Import Folder"}),I&&t.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-gray-900 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-hidden border border-gray-700",children:[t.jsxs("div",{className:"p-4 border-b border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-white",children:"Search Events"}),t.jsx("button",{onClick:()=>{F(!1),U(null),le(""),X([])},className:"text-gray-400 hover:text-white",children:t.jsx(Ss,{className:"w-6 h-6"})})]}),O&&t.jsxs("p",{className:"text-sm text-gray-400 mb-3",children:["Matching: ",t.jsx("span",{className:"text-white",children:O.fileName})]}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",value:te,onChange:ne=>{le(ne.target.value),V(ne.target.value)},placeholder:"Search for events...",className:"w-full px-4 py-2 bg-gray-800 border border-gray-600 rounded text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-red-500",autoFocus:!0}),q&&t.jsx(Dt,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 animate-spin"})]})]}),t.jsxs("div",{className:"p-4 overflow-y-auto max-h-[50vh]",children:[H.length===0&&!q&&te.length>=3&&t.jsx("p",{className:"text-gray-400 text-center py-8",children:"No events found"}),H.length===0&&!q&&te.length<3&&t.jsx("p",{className:"text-gray-400 text-center py-8",children:"Enter at least 3 characters"}),H.length>0&&t.jsx("div",{className:"space-y-2",children:H.map((ne,ke)=>t.jsx("div",{className:`p-3 rounded-lg border cursor-pointer transition-colors ${ne.hasFile?"border-gray-700 bg-gray-800/50 opacity-50 cursor-not-allowed":ne.existsInDatabase?"border-green-700 bg-green-900/20 hover:bg-green-900/40":"border-gray-700 bg-gray-800 hover:bg-gray-700"}`,onClick:()=>{!ne.hasFile&&ne.id&&oe(ne)},children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h4",{className:"font-medium text-white truncate",children:ne.title}),t.jsxs("div",{className:"text-sm text-gray-400 mt-1",children:[ne.sport,"  ",new Date(ne.eventDate).toLocaleDateString()]})]}),t.jsx("div",{className:"ml-4",children:ne.hasFile?t.jsx("span",{className:"text-xs text-red-400 bg-red-900/30 px-2 py-1 rounded",children:"Has File"}):ne.existsInDatabase?t.jsx("span",{className:"text-xs text-green-400 bg-green-900/30 px-2 py-1 rounded",children:"In Database"}):t.jsx("span",{className:"text-xs text-blue-400 bg-blue-900/30 px-2 py-1 rounded",children:"From API"})})]})},`${ne.externalId||ne.id}-${ke}`))})]}),t.jsx("div",{className:"p-4 border-t border-gray-700 flex justify-end",children:t.jsx("button",{onClick:()=>{F(!1),U(null),le(""),X([])},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded transition-colors",children:"Cancel"})})]})}),t.jsx(_I,{isOpen:z,onClose:()=>{D(!1),U(null)},onSave:Z,fileName:(O==null?void 0:O.fileName)||"",parsedTitle:O==null?void 0:O.parsedTitle,parsedDate:O==null?void 0:O.parsedDate,currentMapping:O?S.get(O.filePath):void 0})]})};function jI(){const{data:a,isLoading:e,error:s}=CN(),[r,n]=y.useState(!1),[o,c]=y.useState(!1),d="bc1qtruhe6ffsa6gmcjd46kgufggqvgfx3tvq6ykwq",f=async()=>{try{await navigator.clipboard.writeText(d),n(!0),setTimeout(()=>n(!1),2e3)}catch{const x=document.createElement("textarea");x.value=d,x.style.position="fixed",x.style.left="-999999px",document.body.appendChild(x),x.select(),document.execCommand("copy"),document.body.removeChild(x),n(!0),setTimeout(()=>n(!1),2e3)}},u=async()=>{if(!a)return;const g=`### System Information
| Property | Value |
|----------|-------|
| Version | ${a.version} |
| Branch | ${a.branch} |
| OS | ${a.osName} ${a.osVersion} |
| Runtime | ${a.runtimeVersion} |
| Database | ${a.databaseType} ${a.databaseVersion} |
| Migration Version | ${a.migrationVersion} |
| Docker | ${a.isDocker?"Yes":"No"} |
| Production | ${a.isProduction?"Yes":"No"} |
| Authentication | ${a.authentication} |
| Start Time | ${new Date(a.startTime).toISOString()} |
| Build Time | ${new Date(a.buildTime).toISOString()} |
`;try{await navigator.clipboard.writeText(g),c(!0),setTimeout(()=>c(!1),2e3)}catch{const b=document.createElement("textarea");b.value=g,b.style.position="fixed",b.style.left="-999999px",document.body.appendChild(b),b.select(),document.execCommand("copy"),document.body.removeChild(b),c(!0),setTimeout(()=>c(!1),2e3)}};if(e)return t.jsx("div",{className:"p-8",children:t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600"})})});if(s)return t.jsx("div",{className:"p-8",children:t.jsxs("div",{className:"bg-red-900 border border-red-700 text-red-100 px-4 py-3 rounded",children:[t.jsx("p",{className:"font-bold",children:"Error loading system status"}),t.jsx("p",{className:"text-sm",children:s.message})]})});if(!a)return null;const m=[{label:"Version",value:a.version},{label:"Build Time",value:new Date(a.buildTime).toLocaleString()},{label:"Start Time",value:new Date(a.startTime).toLocaleString()},{label:"Runtime",value:a.runtimeVersion},{label:"Database",value:`${a.databaseType} ${a.databaseVersion}`},{label:"OS",value:`${a.osName} ${a.osVersion}`},{label:"Branch",value:a.branch},{label:"Authentication",value:a.authentication},{label:"Is Docker",value:a.isDocker?"Yes":"No"},{label:"Is Production",value:a.isProduction?"Yes":"No"},{label:"Data Directory",value:a.appData}];return t.jsx("div",{className:"p-8",children:t.jsxs("div",{className:"max-w-6xl mx-auto",children:[t.jsxs("div",{className:"mb-6 flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"System Status"}),t.jsx("p",{className:"text-gray-400",children:"View system information and application status"})]}),t.jsx("button",{onClick:u,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white font-medium rounded-lg transition-colors flex items-center gap-2",title:"Copy system info for GitHub issues",children:o?t.jsxs(t.Fragment,{children:[t.jsx($a,{className:"w-5 h-5 text-green-400"}),"Copied!"]}):t.jsxs(t.Fragment,{children:[t.jsx(li,{className:"w-5 h-5"}),"Copy for GitHub Issue"]})})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg shadow-xl overflow-hidden",children:[t.jsx("div",{className:"px-6 py-4 bg-red-950/30 border-b border-red-900/30",children:t.jsx("h2",{className:"text-xl font-semibold text-white",children:a.appName})}),t.jsx("div",{className:"divide-y divide-red-900/20",children:m.map(g=>t.jsxs("div",{className:"px-6 py-4 flex justify-between items-center hover:bg-red-900/10 transition-colors",children:[t.jsx("span",{className:"text-gray-400 font-medium",children:g.label}),t.jsx("span",{className:"font-mono text-sm text-white",children:g.value})]},g.label))})]}),t.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6 shadow-xl",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Status"}),t.jsx("p",{className:"text-2xl font-bold text-green-400",children:"Running"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6 shadow-xl",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Mode"}),t.jsx("p",{className:"text-2xl font-bold text-white",children:a.isProduction?"Production":"Development"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6 shadow-xl",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Migration Version"}),t.jsx("p",{className:"text-2xl font-bold text-white",children:a.migrationVersion})]})]}),t.jsx("div",{className:"mt-12 mb-8",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-8 shadow-xl text-center",children:[t.jsxs("p",{className:"text-gray-300 text-lg mb-6",children:["Sportarr is a free, open-source project made for sports fans, by sports fans.",t.jsx("br",{}),"If it's helped you catch every game, consider throwing some support our way!"]}),t.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 mb-6",children:[t.jsxs("a",{href:"#",target:"_blank",rel:"noopener noreferrer",className:"group relative px-6 py-3 bg-red-600 hover:bg-red-500 text-white font-semibold rounded-lg transition-all duration-300 flex items-center gap-2 shadow-lg shadow-red-600/30 hover:shadow-red-500/50 hover:scale-105 animate-pulse hover:animate-none",style:{boxShadow:"0 0 20px rgba(220, 38, 38, 0.4), 0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:[t.jsx(GR,{className:"w-5 h-5"}),"Sponsor the Team"]}),t.jsxs("a",{href:"#",target:"_blank",rel:"noopener noreferrer",className:"group relative px-6 py-3 bg-red-600 hover:bg-red-500 text-white font-semibold rounded-lg transition-all duration-300 flex items-center gap-2 shadow-lg shadow-red-600/30 hover:shadow-red-500/50 hover:scale-105 animate-pulse hover:animate-none",style:{boxShadow:"0 0 20px rgba(220, 38, 38, 0.4), 0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:[t.jsx("span",{className:"text-lg",children:""}),"Buy Me a Coffee"]}),t.jsxs("button",{onClick:f,className:"group relative px-6 py-3 bg-red-600 hover:bg-red-500 text-white font-semibold rounded-lg transition-all duration-300 flex items-center gap-2 shadow-lg shadow-red-600/30 hover:shadow-red-500/50 hover:scale-105 animate-pulse hover:animate-none",style:{boxShadow:"0 0 20px rgba(220, 38, 38, 0.4), 0 4px 6px -1px rgba(0, 0, 0, 0.1)"},title:"Click to copy BTC address",children:[t.jsx("span",{className:"text-lg",children:""}),r?t.jsxs(t.Fragment,{children:[t.jsx($a,{className:"w-5 h-5 text-green-300"}),"Copied!"]}):t.jsxs(t.Fragment,{children:["Send Bitcoin",t.jsx(li,{className:"w-4 h-4 opacity-70"})]})]})]}),t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3 max-w-lg mx-auto",children:[t.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"BTC Wallet Address"}),t.jsx("p",{className:"text-sm text-gray-300 font-mono break-all select-all",children:d})]}),t.jsx("p",{className:"text-gray-500 text-sm mt-6",children:"Every contribution helps keep the scoreboard running. Thanks for being part of the team!"})]})})]})})}const EI={0:"Root Folder",1:"Root Folder Access",2:"Download Client",3:"Indexer",4:"Disk Space",5:"Disk Space Critical",6:"Update Available",7:"Database Migration",8:"Metadata API",9:"Notification Test",10:"Authentication",11:"API Key",12:"Orphaned Events",13:"Database Corruption"},TI=["All OK","Notice","Warning","Error"],kh=["text-green-400","text-blue-400","text-yellow-400","text-red-400"],Sg=["bg-green-900/20","bg-blue-900/20","bg-yellow-900/20","bg-red-900/20"],_g=["border-green-700/50","border-blue-700/50","border-yellow-700/50","border-red-700/50"];function AI(){const[a,e]=y.useState([]),[s,r]=y.useState(!1),[n,o]=y.useState(null),[c,d]=y.useState(!0);y.useEffect(()=>{f();let w=null;return c&&(w=window.setInterval(f,6e4)),()=>{w&&clearInterval(w)}},[c]);const f=async()=>{try{r(!0);const w=await at.get("/system/health");e(w.data),o(new Date)}catch(w){console.error("Failed to load health checks:",w)}finally{r(!1)}},u=w=>{switch(w){case 0:return t.jsx(rs,{className:"w-6 h-6"});case 1:return t.jsx(Or,{className:"w-6 h-6"});case 2:return t.jsx(Pr,{className:"w-6 h-6"});case 3:return t.jsx(Ss,{className:"w-6 h-6"});default:return t.jsx(rs,{className:"w-6 h-6"})}},g=(()=>{if(a.length===0)return{level:0,message:"Loading..."};const w=Math.max(...a.map(S=>S.level));return w===3?{level:3,message:"Critical Issues Detected"}:w===2?{level:2,message:"Warnings Present"}:w===1?{level:1,message:"Minor Notices"}:{level:0,message:"All Systems Healthy"}})(),x=a.filter(w=>w.level===3).length,b=a.filter(w=>w.level===2).length,v=a.filter(w=>w.level===1).length;return t.jsx("div",{className:"p-8",children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"System Health"}),t.jsx("p",{className:"text-gray-400",children:"Monitor system status and configuration issues"})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("label",{className:"flex items-center gap-2 text-gray-300 text-sm",children:[t.jsx("input",{type:"checkbox",checked:c,onChange:w=>d(w.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600 focus:ring-offset-gray-900"}),"Auto-refresh"]}),t.jsxs("button",{onClick:f,disabled:s,className:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 disabled:opacity-50 text-white rounded-lg transition-colors",children:[t.jsx(Dt,{className:`w-5 h-5 mr-2 ${s?"animate-spin":""}`}),"Refresh"]})]})]}),t.jsx("div",{className:`mb-6 ${Sg[g.level]} border ${_g[g.level]} rounded-lg p-6`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:kh[g.level],children:t.jsx(jp,{className:"w-12 h-12"})}),t.jsxs("div",{children:[t.jsx("h2",{className:`text-2xl font-bold ${kh[g.level]}`,children:g.message}),n&&t.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["Last checked: ",n.toLocaleTimeString()]})]})]}),t.jsxs("div",{className:"flex gap-6",children:[x>0&&t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-3xl font-bold text-red-400",children:x}),t.jsxs("div",{className:"text-sm text-gray-400",children:["Error",x!==1?"s":""]})]}),b>0&&t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-3xl font-bold text-yellow-400",children:b}),t.jsxs("div",{className:"text-sm text-gray-400",children:["Warning",b!==1?"s":""]})]}),v>0&&t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-3xl font-bold text-blue-400",children:v}),t.jsxs("div",{className:"text-sm text-gray-400",children:["Notice",v!==1?"s":""]})]}),x===0&&b===0&&v===0&&t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-3xl font-bold text-green-400",children:""}),t.jsx("div",{className:"text-sm text-gray-400",children:"Healthy"})]})]})]})}),s&&a.length===0?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-4 border-red-600 border-t-transparent"}),t.jsx("p",{className:"mt-4 text-gray-400",children:"Running health checks..."})]}):a.length===0?t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-gray-700 rounded-lg p-12 text-center",children:[t.jsx(jp,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-400",children:"No health check results available"})]}):t.jsx("div",{className:"space-y-3",children:a.map((w,S)=>t.jsx("div",{className:`${Sg[w.level]} border ${_g[w.level]} rounded-lg p-4 transition-all hover:shadow-lg`,children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("div",{className:`${kh[w.level]} flex-shrink-0 mt-0.5`,children:u(w.level)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center justify-between gap-4 mb-2",children:[t.jsx("h3",{className:"text-lg font-semibold text-white",children:w.message}),t.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[t.jsx("span",{className:`px-3 py-1 ${Sg[w.level]} ${kh[w.level]} text-sm font-medium rounded-full border ${_g[w.level]}`,children:TI[w.level]}),t.jsx("span",{className:"px-3 py-1 bg-gray-800 text-gray-400 text-xs rounded-full",children:EI[w.type]||"System"})]})]}),w.details&&t.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:w.details})]})]})},S))}),t.jsx("div",{className:"mt-8 bg-gray-900 border border-gray-700 rounded-lg p-6",children:t.jsxs("div",{className:"flex items-start",children:[t.jsx(Or,{className:"w-5 h-5 text-blue-400 mr-3 mt-0.5 flex-shrink-0"}),t.jsxs("div",{className:"text-sm text-gray-300",children:[t.jsx("p",{className:"font-semibold text-white mb-2",children:"About Health Checks"}),t.jsx("p",{className:"mb-2",children:"Sportarr performs automated health checks to ensure your system is configured correctly and operating properly. Health checks run periodically and can be manually refreshed."}),t.jsxs("p",{children:[t.jsx("strong",{className:"text-white",children:"Errors"})," indicate critical issues that prevent functionality."," ",t.jsx("strong",{className:"text-white",children:"Warnings"})," are issues that should be addressed but don't block operations."," ",t.jsx("strong",{className:"text-white",children:"Notices"})," are informational messages about your configuration."]})]})]})})]})})}const CI=()=>{const[a,e]=y.useState([]),[s,r]=y.useState(!0),[n,o]=y.useState(null),[c,d]=y.useState(!1),[f,u]=y.useState(!1),[m,g]=y.useState(null),[x,b]=y.useState(null),[v,w]=y.useState("");y.useEffect(()=>{S()},[]);const S=async()=>{r(!0),o(null);try{const z=await kt("/api/system/backup");if(!z.ok)throw new Error("Failed to fetch backups");const D=await z.json();e(D)}catch(z){o(z instanceof Error?z.message:"An error occurred")}finally{r(!1)}},T=async()=>{d(!0),o(null);try{const z=v?`/api/system/backup?note=${encodeURIComponent(v)}`:"/api/system/backup";if(!(await ds(z,{})).ok)throw new Error("Failed to create backup");w(""),await S(),be.success("Backup Created",{description:"Backup created successfully!"})}catch(z){o(z instanceof Error?z.message:"Failed to create backup")}finally{d(!1)}},k=async z=>{u(!0),o(null);try{const D=await ds(`/api/system/backup/restore/${encodeURIComponent(z)}`,{});if(!D.ok)throw new Error("Failed to restore backup");const O=await D.json();be.success("Backup Restored",{description:O.message||"Backup restored successfully! Please restart Sportarr.",duration:1e4}),g(null)}catch(D){o(D instanceof Error?D.message:"Failed to restore backup")}finally{u(!1)}},E=async z=>{o(null);try{if(!(await Na(`/api/system/backup/${encodeURIComponent(z)}`)).ok)throw new Error("Failed to delete backup");await S(),b(null)}catch(D){o(D instanceof Error?D.message:"Failed to delete backup")}},R=async()=>{if(confirm("This will delete backups older than the configured retention period. Continue?")){o(null);try{const z=await ds("/api/system/backup/cleanup",{});if(!z.ok)throw new Error("Failed to cleanup old backups");const D=await z.json();be.success("Cleanup Complete",{description:D.message||"Old backups cleaned up successfully."}),await S()}catch(z){o(z instanceof Error?z.message:"Failed to cleanup backups")}}},K=z=>new Date(z).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return t.jsxs("div",{className:"p-8",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Backup"}),t.jsx("p",{className:"text-gray-400",children:"Create and manage database backups for disaster recovery"})]}),t.jsx("div",{className:"mb-6 p-4 bg-blue-900/20 border border-blue-800 rounded-lg",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(Or,{className:"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"text-sm text-gray-300",children:[t.jsx("strong",{className:"text-white",children:"About Backups:"})," Backups are stored as ZIP files containing your Sportarr database. Configure backup folder and retention settings in Media Management settings. After restoring a backup, you must restart Sportarr for changes to take effect."]})]})}),t.jsxs("div",{className:"mb-6 bg-gray-800 rounded-lg p-6 border border-gray-700",children:[t.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Create New Backup"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("input",{type:"text",placeholder:"Optional note for this backup...",value:v,onChange:z=>w(z.target.value),className:"flex-1 px-4 py-2 bg-gray-700 border border-gray-600 rounded text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.jsxs("button",{onClick:T,disabled:c,className:"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[t.jsx(qs,{className:"w-5 h-5"}),c?"Creating...":"Backup Now"]}),t.jsxs("button",{onClick:R,className:"px-4 py-2 bg-gray-700 text-white rounded hover:bg-gray-600 flex items-center gap-2",children:[t.jsx(cs,{className:"w-5 h-5"}),"Cleanup Old"]})]})]}),n&&t.jsx("div",{className:"mb-6 p-4 bg-red-900/20 border border-red-800 rounded-lg",children:t.jsxs("p",{className:"text-red-400",children:["Error: ",n]})}),t.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[t.jsx("div",{className:"p-4 border-b border-gray-700",children:t.jsx("h2",{className:"text-xl font-semibold text-white",children:"Available Backups"})}),s?t.jsxs("div",{className:"flex items-center justify-center py-12",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-400"}),t.jsx("span",{className:"ml-3 text-gray-400",children:"Loading backups..."})]}):a.length===0?t.jsxs("div",{className:"text-center py-12 text-gray-400",children:[t.jsx(qs,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{children:"No backups found. Create your first backup above."})]}):t.jsx("div",{className:"divide-y divide-gray-700",children:a.map(z=>t.jsx("div",{className:"p-4 hover:bg-gray-750 transition-colors",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-white font-medium mb-1",children:z.name}),t.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-400",children:[t.jsx("span",{children:K(z.createdAt)}),t.jsx("span",{className:"text-gray-600",children:""}),t.jsx("span",{children:z.sizeFormatted})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:()=>g(z.name),disabled:f,className:"px-4 py-2 bg-green-900/30 text-green-400 rounded hover:bg-green-900/50 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition-colors",children:[t.jsx(Yk,{className:"w-4 h-4"}),"Restore"]}),t.jsxs("button",{onClick:()=>b(z.name),className:"px-4 py-2 bg-red-900/30 text-red-400 rounded hover:bg-red-900/50 flex items-center gap-2 transition-colors",children:[t.jsx(cs,{className:"w-4 h-4"}),"Delete"]})]})]})},z.name))})]}),m&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4 border border-gray-700",children:[t.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[t.jsx(Pr,{className:"w-6 h-6 text-yellow-400 flex-shrink-0"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Restore Backup?"}),t.jsx("p",{className:"text-sm text-gray-300 mb-2",children:"This will replace your current database with the backup:"}),t.jsx("p",{className:"text-sm text-white font-mono bg-gray-900 p-2 rounded mb-2",children:m}),t.jsx("p",{className:"text-sm text-yellow-400",children:" Your current database will be backed up before restoration, but you will need to restart Sportarr after the restore."})]})]}),t.jsxs("div",{className:"flex gap-3 justify-end",children:[t.jsx("button",{onClick:()=>g(null),className:"px-4 py-2 bg-gray-700 text-white rounded hover:bg-gray-600",children:"Cancel"}),t.jsx("button",{onClick:()=>k(m),disabled:f,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Restoring...":"Restore"})]})]})}),x&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4 border border-gray-700",children:[t.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[t.jsx(cs,{className:"w-6 h-6 text-red-400 flex-shrink-0"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Delete Backup?"}),t.jsx("p",{className:"text-sm text-gray-300 mb-2",children:"Are you sure you want to delete this backup?"}),t.jsx("p",{className:"text-sm text-white font-mono bg-gray-900 p-2 rounded",children:x})]})]}),t.jsxs("div",{className:"flex gap-3 justify-end",children:[t.jsx("button",{onClick:()=>b(null),className:"px-4 py-2 bg-gray-700 text-white rounded hover:bg-gray-600",children:"Cancel"}),t.jsx("button",{onClick:()=>E(x),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Delete"})]})]})})]})},kI=()=>{const[a,e]=y.useState([]),[s,r]=y.useState(!0),[n,o]=y.useState(null),[c,d]=y.useState(1),[f,u]=y.useState(0),[m,g]=y.useState(""),[x,b]=y.useState(""),v=50,w=Math.ceil(f/v),S=["Info","Success","Warning","Error"],T=["System","Database","Download","Import","Indexer","Search","Quality","Backup","Update","Settings","Authentication","Task","Notification","Metadata"],k=["text-blue-400 bg-blue-900/20","text-green-400 bg-green-900/20","text-yellow-400 bg-yellow-900/20","text-red-400 bg-red-900/20"];y.useEffect(()=>{E()},[c,m,x]);const E=async()=>{r(!0),o(null);try{let z=`/api/system/event?page=${c}&pageSize=${v}`;m&&(z+=`&type=${m}`),x&&(z+=`&category=${x}`);const D=await kt(z);if(!D.ok)throw new Error("Failed to fetch system events");const O=await D.json();e(O.events),u(O.totalRecords)}catch(z){o(z instanceof Error?z.message:"An error occurred")}finally{r(!1)}},R=async()=>{if(confirm("Delete system events older than 30 days?"))try{const z=await ds("/api/system/event/cleanup?days=30",{});if(!z.ok)throw new Error("Failed to cleanup events");const D=await z.json();be.success("Cleanup Complete",{description:D.message}),E()}catch(z){be.error("Cleanup Failed",{description:z instanceof Error?z.message:"Failed to cleanup events."})}},K=z=>new Date(z).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});return t.jsxs("div",{className:"p-8",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"System Events"}),t.jsx("p",{className:"text-gray-400",children:"Audit trail of system operations and user actions"})]}),t.jsx("div",{className:"mb-6 p-4 bg-blue-900/20 border border-blue-800 rounded-lg",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(Or,{className:"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"text-sm text-gray-300",children:[t.jsx("strong",{className:"text-white",children:"System Events:"})," This page shows an audit trail of system operations. For detailed application logs, visit the ",t.jsx("a",{href:"/system/logs",className:"text-blue-400 hover:underline",children:"Log Files"})," page."]})]})}),t.jsxs("div",{className:"mb-6 flex gap-4 items-center",children:[t.jsxs("select",{value:m,onChange:z=>{g(z.target.value),d(1)},className:"px-4 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"All Types"}),S.map(z=>t.jsx("option",{value:z,children:z},z))]}),t.jsxs("select",{value:x,onChange:z=>{b(z.target.value),d(1)},className:"px-4 py-2 bg-gray-700 border border-gray-600 rounded text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"All Categories"}),T.map(z=>t.jsx("option",{value:z,children:z},z))]}),t.jsxs("button",{onClick:R,className:"ml-auto px-4 py-2 bg-red-900/30 text-red-400 rounded hover:bg-red-900/50 flex items-center gap-2",children:[t.jsx(cs,{className:"w-4 h-4"}),"Cleanup Old Events"]})]}),n&&t.jsx("div",{className:"mb-6 p-4 bg-red-900/20 border border-red-800 rounded-lg",children:t.jsxs("p",{className:"text-red-400",children:["Error: ",n]})}),t.jsx("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:s?t.jsxs("div",{className:"flex items-center justify-center py-12",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-400"}),t.jsx("span",{className:"ml-3 text-gray-400",children:"Loading events..."})]}):a.length===0?t.jsxs("div",{className:"text-center py-12 text-gray-400",children:[t.jsx(Or,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{children:"No system events found."})]}):t.jsx("div",{className:"divide-y divide-gray-700",children:a.map(z=>t.jsx("div",{className:"p-4 hover:bg-gray-750 transition-colors",children:t.jsx("div",{className:"flex items-start justify-between",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("span",{className:`px-2 py-1 text-xs rounded ${k[z.type]}`,children:S[z.type]}),t.jsx("span",{className:"px-2 py-1 bg-gray-700 text-gray-300 text-xs rounded",children:T[z.category]}),t.jsx("span",{className:"text-sm text-gray-500",children:K(z.timestamp)}),z.user&&t.jsxs("span",{className:"text-sm text-gray-500",children:["by ",z.user]})]}),t.jsx("p",{className:"text-white mb-1",children:z.message}),z.details&&t.jsx("p",{className:"text-sm text-gray-400",children:z.details}),z.relatedEntityType&&z.relatedEntityId&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Related: ",z.relatedEntityType," #",z.relatedEntityId]})]})})},z.id))})}),w>1&&t.jsxs("div",{className:"flex items-center justify-between mt-6",children:[t.jsxs("div",{className:"text-sm text-gray-400",children:["Showing ",(c-1)*v+1," to ",Math.min(c*v,f)," of ",f," events"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>d(z=>Math.max(1,z-1)),disabled:c===1,className:"px-3 py-1 bg-gray-700 text-white rounded hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),t.jsxs("span",{className:"px-3 py-1 bg-gray-800 text-white rounded",children:["Page ",c," of ",w]}),t.jsx("button",{onClick:()=>d(z=>Math.min(w,z+1)),disabled:c===w,className:"px-3 py-1 bg-gray-700 text-white rounded hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})},RI=()=>{const[a,e]=y.useState(null),[s,r]=y.useState(!0),[n,o]=y.useState(!1),[c,d]=y.useState(null);y.useEffect(()=>{f()},[]);const f=async()=>{o(!0),d(null);try{const m=await kt("/api/system/updates");if(!m.ok)throw new Error("Failed to check for updates");const g=await m.json();e(g)}catch(m){console.error("Error checking for updates:",m),d(m instanceof Error?m.message:"An error occurred")}finally{r(!1),o(!1)}},u=m=>new Date(m).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return s?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"text-gray-400",children:"Checking for updates..."})}):t.jsxs("div",{className:"p-8",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h1",{className:"text-3xl font-bold text-white",children:"Updates"}),t.jsxs("button",{onClick:f,disabled:n,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors disabled:opacity-50 flex items-center gap-2",children:[t.jsx(Dt,{className:`w-5 h-5 ${n?"animate-spin":""}`}),n?"Checking...":"Check for Updates"]})]}),t.jsx("p",{className:"text-gray-400",children:"Check for new versions and view release history"})]}),c&&t.jsx("div",{className:"mb-6 bg-red-900/20 border border-red-800 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(di,{className:"w-6 h-6 text-red-400 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-red-400 mb-1",children:"Error Checking for Updates"}),t.jsx("p",{className:"text-red-400/80",children:c})]})]})}),a&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:`mb-6 rounded-lg p-6 border ${a.updateAvailable?"bg-blue-900/20 border-blue-800":"bg-green-900/20 border-green-800"}`,children:t.jsxs("div",{className:"flex items-start gap-4",children:[a.updateAvailable?t.jsx(di,{className:"w-8 h-8 text-blue-400 flex-shrink-0"}):t.jsx(rs,{className:"w-8 h-8 text-green-400 flex-shrink-0"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h2",{className:`text-2xl font-bold mb-2 ${a.updateAvailable?"text-blue-400":"text-green-400"}`,children:a.updateAvailable?"Update Available!":"Up to Date"}),t.jsxs("div",{className:"space-y-2 text-gray-300",children:[t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-400",children:"Current Version:"})," ",t.jsx("span",{className:"font-semibold text-white",children:a.currentVersion})]}),a.updateAvailable&&t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-400",children:"Latest Version:"})," ",t.jsx("span",{className:"font-semibold text-blue-400",children:a.latestVersion})]})]}),a.updateAvailable&&t.jsxs("div",{className:"mt-4 p-4 bg-blue-900/30 border border-blue-700 rounded-lg",children:[t.jsxs("p",{className:"text-sm text-blue-300",children:[t.jsx("strong",{children:"Docker Users:"})," To update, pull the latest image and restart your container:"]}),t.jsxs("pre",{className:"mt-2 p-3 bg-gray-900 border border-gray-700 rounded text-xs text-gray-300 overflow-x-auto",children:["docker pull ghcr.io/sportarr/sportarr:latest",`
`,"docker restart sportarr"]})]})]})]})}),t.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[t.jsx("div",{className:"p-6 border-b border-gray-700",children:t.jsx("h2",{className:"text-xl font-semibold text-white",children:"Release History"})}),t.jsx("div",{className:"divide-y divide-gray-700",children:a.releases.map(m=>t.jsxs("div",{className:`p-6 ${m.isInstalled?"bg-gray-900/50":""}`,children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("h3",{className:"text-lg font-bold text-white",children:["Version ",m.version]}),m.isInstalled&&t.jsx("span",{className:"px-2 py-1 bg-green-900/50 border border-green-700 text-green-400 text-xs font-medium rounded",children:"Installed"}),m.isLatest&&!m.isInstalled&&t.jsx("span",{className:"px-2 py-1 bg-blue-900/50 border border-blue-700 text-blue-400 text-xs font-medium rounded",children:"Latest"})]}),t.jsx("div",{className:"text-sm text-gray-400",children:u(m.releaseDate)})]}),m.changes&&m.changes.length>0&&t.jsxs("div",{className:"mb-4",children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-400 mb-2",children:"Changes:"}),t.jsx("ul",{className:"space-y-1",children:m.changes.map((g,x)=>t.jsxs("li",{className:"text-sm text-gray-300 flex items-start gap-2",children:[t.jsx("span",{className:"text-gray-600 mt-1",children:""}),t.jsx("span",{className:"flex-1",children:g})]},x))})]}),m.downloadUrl&&t.jsxs("a",{href:m.downloadUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white text-sm rounded-lg transition-colors",children:[t.jsx(qs,{className:"w-4 h-4"}),"View on GitHub"]})]},m.version))})]}),t.jsx("div",{className:"mt-6 p-4 bg-gray-800 border border-gray-700 rounded-lg",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(di,{className:"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"text-sm text-gray-300",children:[t.jsx("strong",{className:"text-white",children:"Update Instructions:"}),t.jsxs("ul",{className:"mt-2 space-y-1 list-disc list-inside",children:[t.jsx("li",{children:"Updates are pulled from the GitHub repository releases"}),t.jsx("li",{children:"Docker users should pull the latest image and restart the container"}),t.jsx("li",{children:"Manual installations should download the latest release from GitHub"}),t.jsx("li",{children:"Always backup your database before updating"})]})]})]})})]})]})},zS=["TRC","DBG","INF","WRN","ERR","FTL"];function LI(){const{data:a,isLoading:e,error:s}=kk(),[r,n]=y.useState(null),[o,c]=y.useState("ALL"),{data:d,isLoading:f}=Rk(r),u=y.useMemo(()=>{if(!(d!=null&&d.content)||o==="ALL")return(d==null?void 0:d.content)||"";const b=zS.indexOf(o);return b===-1?d.content:d.content.split(`
`).filter(S=>{const T=S.match(/\[(TRC|DBG|INF|WRN|ERR|FTL)\]/);if(!T)return!0;const k=T[1];return zS.indexOf(k)>=b}).join(`
`)},[d==null?void 0:d.content,o]),m=b=>b<1024?`${b} B`:b<1024*1024?`${(b/1024).toFixed(2)} KB`:`${(b/(1024*1024)).toFixed(2)} MB`,g=b=>new Date(b).toLocaleString(),x=async b=>{var v,w;try{const S=((v=window.Sportarr)==null?void 0:v.urlBase)||"",T=((w=window.Sportarr)==null?void 0:w.apiKey)||"",k=await fetch(`${S}/api/log/file/download?filename=${encodeURIComponent(b)}`,{credentials:"include",headers:{"X-Api-Key":T}});if(!k.ok)throw new Error(`Failed to download: ${k.statusText}`);const E=await k.blob(),R=window.URL.createObjectURL(E),K=document.createElement("a");K.href=R,K.download=b,document.body.appendChild(K),K.click(),document.body.removeChild(K),window.URL.revokeObjectURL(R)}catch(S){console.error("Download failed:",S)}};return e?t.jsx("div",{className:"p-8",children:t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600"})})}):s?t.jsx("div",{className:"p-8",children:t.jsxs("div",{className:"bg-red-900 border border-red-700 text-red-100 px-4 py-3 rounded",children:[t.jsx("p",{className:"font-bold",children:"Error loading log files"}),t.jsx("p",{className:"text-sm",children:s.message})]})}):t.jsx("div",{className:"p-8",children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Log Files"}),t.jsx("p",{className:"text-gray-400",children:"View and download application log files"})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx("div",{className:"lg:col-span-1",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg shadow-xl overflow-hidden",children:[t.jsx("div",{className:"px-6 py-4 bg-red-950/30 border-b border-red-900/30",children:t.jsx("h2",{className:"text-xl font-semibold text-white",children:"Available Logs"})}),t.jsx("div",{className:"divide-y divide-red-900/20 max-h-[600px] overflow-y-auto",children:a&&a.length>0?a.map(b=>t.jsx("div",{className:`px-6 py-4 hover:bg-red-900/10 transition-colors cursor-pointer ${r===b.filename?"bg-red-900/20":""}`,onClick:()=>n(b.filename),children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(MN,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),t.jsx("p",{className:"text-white font-medium truncate",children:b.filename})]}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:m(b.size)}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:g(b.lastWriteTime)})]}),t.jsx("button",{onClick:v=>{v.stopPropagation(),x(b.filename)},className:"ml-3 p-2 text-gray-400 hover:text-white hover:bg-red-900/20 rounded transition-colors",title:"Download",children:t.jsx(qs,{className:"w-5 h-5"})})]})},b.filename)):t.jsx("div",{className:"px-6 py-8 text-center text-gray-400",children:"No log files available"})})]})}),t.jsx("div",{className:"lg:col-span-2",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg shadow-xl overflow-hidden h-[600px] flex flex-col",children:[t.jsxs("div",{className:"px-6 py-4 bg-red-950/30 border-b border-red-900/30 flex items-center justify-between",children:[t.jsx("h2",{className:"text-xl font-semibold text-white",children:r||"Select a log file"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(au,{className:"w-4 h-4 text-gray-400"}),t.jsxs("select",{value:o,onChange:b=>c(b.target.value),className:"bg-gray-800 border border-gray-700 text-white text-sm rounded px-2 py-1 focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"ALL",children:"All Levels"}),t.jsx("option",{value:"TRC",children:"Trace & Above"}),t.jsx("option",{value:"DBG",children:"Debug & Above"}),t.jsx("option",{value:"INF",children:"Info & Above"}),t.jsx("option",{value:"WRN",children:"Warn & Above"}),t.jsx("option",{value:"ERR",children:"Error & Above"}),t.jsx("option",{value:"FTL",children:"Fatal Only"})]})]}),r&&t.jsx("button",{onClick:()=>n(null),className:"p-2 text-gray-400 hover:text-white hover:bg-red-900/20 rounded transition-colors",title:"Close",children:t.jsx(qt,{className:"w-5 h-5"})})]})]}),t.jsx("div",{className:"flex-1 overflow-auto p-6",children:r?f?t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600"})}):d?t.jsx("div",{className:"font-mono text-xs text-gray-300 whitespace-pre-wrap break-all bg-black/50 p-4 rounded border border-red-900/20",children:u}):t.jsx("div",{className:"flex items-center justify-center h-full text-red-400",children:t.jsx("p",{children:"Error loading log file content"})}):t.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:t.jsx("p",{children:"Select a log file from the list to view its contents"})})}),d&&t.jsxs("div",{className:"px-6 py-3 bg-red-950/20 border-t border-red-900/30 text-sm text-gray-400 flex items-center justify-between",children:[t.jsxs("span",{children:["Size: ",m(d.size)]}),t.jsxs("span",{children:["Last updated: ",g(d.lastWriteTime)]}),o!=="ALL"&&t.jsxs("span",{className:"text-yellow-400",children:["Filtered: ",o,"+"]}),t.jsx("span",{className:"text-green-400",children:"Auto-refreshing"})]})]})})]})]})})}function DI(){const{data:a,isLoading:e,error:s}=kN(100),r=Lk(),n=Dk(),[o,c]=y.useState(null),d=S=>S?new Date(S).toLocaleString():"-",f=S=>{if(!S)return"-";const T=S.split(":");if(T.length===3){const k=parseInt(T[0]),E=parseInt(T[1]),R=parseFloat(T[2]);return k>0?`${k}h ${E}m ${Math.floor(R)}s`:E>0?`${E}m ${Math.floor(R)}s`:`${R.toFixed(1)}s`}return S},u=S=>{switch(S){case"Queued":return"text-blue-400";case"Running":case"Aborting":return"text-yellow-400";case"Completed":return"text-green-400";case"Failed":return"text-red-400";case"Cancelled":return"text-gray-400";default:return"text-gray-400"}},m=S=>{switch(S){case"Queued":return t.jsx($r,{className:"w-5 h-5"});case"Running":return t.jsx(nu,{className:"w-5 h-5"});case"Aborting":return t.jsx(_d,{className:"w-5 h-5"});case"Completed":return t.jsx(rs,{className:"w-5 h-5"});case"Failed":return t.jsx(Ss,{className:"w-5 h-5"});case"Cancelled":return t.jsx(_d,{className:"w-5 h-5"});default:return t.jsx($r,{className:"w-5 h-5"})}},g=async S=>{if(confirm("Are you sure you want to cancel this task?"))try{await n.mutateAsync(S)}catch(T){console.error("Failed to cancel task:",T),be.error("Cancel Failed",{description:"Failed to cancel task. Please try again."})}},x=async()=>{try{await r.mutateAsync({name:"Test Task",commandName:"TestTask",priority:0})}catch(S){console.error("Failed to queue test task:",S),be.error("Queue Failed",{description:"Failed to queue test task. Please try again."})}};if(e)return t.jsx("div",{className:"p-8",children:t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600"})})});if(s)return t.jsx("div",{className:"p-8",children:t.jsxs("div",{className:"bg-red-900 border border-red-700 text-red-100 px-4 py-3 rounded",children:[t.jsx("p",{className:"font-bold",children:"Error loading tasks"}),t.jsx("p",{className:"text-sm",children:s.message})]})});const b=(a==null?void 0:a.filter(S=>S.status==="Running"||S.status==="Aborting"))||[],v=(a==null?void 0:a.filter(S=>S.status==="Queued"))||[],w=(a==null?void 0:a.filter(S=>S.status==="Completed"||S.status==="Failed"||S.status==="Cancelled"))||[];return t.jsx("div",{className:"p-8",children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Tasks"}),t.jsx("p",{className:"text-gray-400",children:"View and manage background tasks"})]}),t.jsx("button",{onClick:x,disabled:r.isPending,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:r.isPending?"Queuing...":"Queue Test Task"})]}),b.length>0&&t.jsxs("div",{className:"mb-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-white mb-3",children:"Running"}),t.jsx("div",{className:"space-y-3",children:b.map(S=>t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6 shadow-xl",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[t.jsx("div",{className:`mt-1 ${u(S.status)}`,children:m(S.status)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"text-lg font-semibold text-white",children:S.name}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:S.commandName}),S.message&&t.jsx("p",{className:"text-sm text-gray-300 mt-2",children:S.message})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:`px-3 py-1 rounded text-sm font-medium ${u(S.status)}`,children:S.status}),(S.status==="Running"||S.status==="Queued")&&t.jsx("button",{onClick:()=>g(S.id),disabled:n.isPending,className:"p-2 text-red-400 hover:text-red-300 hover:bg-red-900/20 rounded transition-colors disabled:opacity-50",title:"Cancel task",children:t.jsx(_d,{className:"w-5 h-5"})})]})]}),S.progress!==null&&t.jsxs("div",{className:"mt-4",children:[t.jsxs("div",{className:"flex justify-between text-sm text-gray-400 mb-2",children:[t.jsx("span",{children:"Progress"}),t.jsxs("span",{children:[S.progress,"%"]})]}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:t.jsx("div",{className:"bg-red-600 h-2 rounded-full transition-all duration-300",style:{width:`${S.progress}%`}})})]}),t.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Started:"}),t.jsx("span",{className:"text-white ml-2",children:d(S.started)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Priority:"}),t.jsx("span",{className:"text-white ml-2",children:S.priority})]})]})]},S.id))})]}),v.length>0&&t.jsxs("div",{className:"mb-6",children:[t.jsxs("h2",{className:"text-xl font-semibold text-white mb-3",children:["Queued (",v.length,")"]}),t.jsx("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg shadow-xl overflow-hidden",children:t.jsx("div",{className:"divide-y divide-red-900/20",children:v.map(S=>t.jsx("div",{className:"px-6 py-4 hover:bg-red-900/10 transition-colors cursor-pointer",onClick:()=>c(S),children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[t.jsx("div",{className:u(S.status),children:m(S.status)}),t.jsxs("div",{children:[t.jsx("p",{className:"text-white font-medium",children:S.name}),t.jsx("p",{className:"text-sm text-gray-400",children:S.commandName})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("span",{className:"text-sm text-gray-400",children:["Queued: ",d(S.queued)]}),t.jsx("button",{onClick:T=>{T.stopPropagation(),g(S.id)},disabled:n.isPending,className:"p-2 text-red-400 hover:text-red-300 hover:bg-red-900/20 rounded transition-colors disabled:opacity-50",title:"Cancel task",children:t.jsx(_d,{className:"w-5 h-5"})})]})]})},S.id))})})]}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold text-white mb-3",children:"History"}),t.jsx("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg shadow-xl overflow-hidden",children:w.length===0?t.jsx("div",{className:"px-6 py-12 text-center text-gray-400",children:"No completed tasks yet"}):t.jsx("div",{className:"divide-y divide-red-900/20",children:w.map(S=>t.jsx("div",{className:"px-6 py-4 hover:bg-red-900/10 transition-colors cursor-pointer",onClick:()=>c(S),children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[t.jsx("div",{className:`mt-1 ${u(S.status)}`,children:m(S.status)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-white font-medium",children:S.name}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:S.commandName}),S.message&&t.jsx("p",{className:"text-sm text-gray-300 mt-1",children:S.message}),S.status==="Failed"&&S.exception&&t.jsx("div",{className:"mt-2 p-2 bg-red-900/20 border border-red-900/30 rounded",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx(Pr,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),t.jsx("pre",{className:"text-xs text-red-300 font-mono whitespace-pre-wrap break-all",children:S.exception})]})})]})]}),t.jsxs("div",{className:"flex flex-col items-end gap-2",children:[t.jsx("span",{className:`px-3 py-1 rounded text-sm font-medium ${u(S.status)}`,children:S.status}),t.jsxs("div",{className:"text-sm text-gray-400 text-right",children:[t.jsxs("div",{children:["Duration: ",f(S.duration)]}),t.jsxs("div",{className:"mt-1",children:["Ended: ",d(S.ended)]})]})]})]})},S.id))})})]})]})})}function II(){const a=Ta();return t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900 flex items-center justify-center p-4",children:t.jsxs("div",{className:"max-w-2xl w-full text-center",children:[t.jsx("div",{className:"mb-8",children:t.jsx("img",{src:"/404.png",alt:"404 - Page Not Found",className:"w-full max-w-md mx-auto"})}),t.jsx("h1",{className:"text-6xl font-bold text-white mb-4",children:"404"}),t.jsx("h2",{className:"text-3xl font-semibold text-red-500 mb-4",children:"Page Not Found"}),t.jsx("p",{className:"text-xl text-gray-400 mb-8",children:"The page you're looking for doesn't exist or has been moved."}),t.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[t.jsxs("button",{onClick:()=>a(-1),className:"flex items-center px-6 py-3 bg-gray-800 hover:bg-gray-700 text-white font-semibold rounded-lg transition-colors",children:[t.jsx(xf,{className:"w-5 h-5 mr-2"}),"Go Back"]}),t.jsxs("button",{onClick:()=>a("/leagues"),className:"flex items-center px-6 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white font-semibold rounded-lg shadow-lg transform transition hover:scale-105",children:[t.jsx(yx,{className:"w-5 h-5 mr-2"}),"Go to Leagues"]})]}),t.jsxs("div",{className:"mt-12 p-6 bg-gray-900/50 border border-gray-800 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Common Pages"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[t.jsx("button",{onClick:()=>a("/leagues"),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors",children:"Leagues"}),t.jsx("button",{onClick:()=>a("/calendar"),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors",children:"Calendar"}),t.jsx("button",{onClick:()=>a("/activity"),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors",children:"Activity"}),t.jsx("button",{onClick:()=>a("/settings/general"),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-gray-300 hover:text-white rounded transition-colors",children:"Settings"})]})]})]})})}function MI(){const[a,e]=y.useState(""),[s,r]=y.useState(""),[n,o]=y.useState(!1),[c,d]=y.useState(""),[f,u]=y.useState(!1);Ta();const[m]=aN(),{login:g}=wx(),x=m.get("returnUrl")||"/leagues",b=async v=>{v.preventDefault(),d(""),u(!0);try{await g(a,s,n)?window.location.href=x:d("Invalid username or password")}catch{d("An error occurred. Please try again.")}finally{u(!1)}};return t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900 flex items-center justify-center p-4",children:t.jsxs("div",{className:"max-w-md w-full",children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsx("h1",{className:"text-5xl font-bold text-white mb-2",children:"Sportarr"}),t.jsx("p",{className:"text-gray-400",children:"Universal Sports PVR"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-8 shadow-2xl",children:[t.jsx("div",{className:"flex items-center justify-center mb-6",children:t.jsx("div",{className:"p-3 bg-red-900/30 rounded-full",children:t.jsx(WR,{className:"w-8 h-8 text-red-500"})})}),t.jsx("h2",{className:"text-2xl font-bold text-white text-center mb-6",children:"Sign In"}),c&&t.jsx("div",{className:"mb-4 p-3 bg-red-900/30 border border-red-900/50 rounded-lg text-red-400 text-sm",children:c}),t.jsxs("form",{onSubmit:b,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-300 mb-2",children:"Username"}),t.jsx("input",{id:"username",type:"text",value:a,onChange:v=>e(v.target.value),required:!0,autoComplete:"username",className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600 transition-colors",placeholder:"Enter your username"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),t.jsx("input",{id:"password",type:"password",value:s,onChange:v=>r(v.target.value),required:!0,autoComplete:"current-password",className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600 transition-colors",placeholder:"Enter your password"})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("input",{id:"remember-me",type:"checkbox",checked:n,onChange:v=>o(v.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("label",{htmlFor:"remember-me",className:"ml-2 text-sm text-gray-400",children:"Remember me for 30 days"})]}),t.jsx("button",{type:"submit",disabled:f,className:"w-full px-6 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white font-semibold rounded-lg shadow-lg transform transition hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",children:f?"Signing in...":"Sign In"})]}),t.jsx("div",{className:"mt-6 pt-6 border-t border-gray-800",children:t.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Secure login powered by Sportarr authentication"})})]}),t.jsx("div",{className:"mt-6 text-center",children:t.jsx("p",{className:"text-sm text-gray-400",children:"Default credentials can be configured in Settings  General  Security"})})]})})}function Rn({title:a,subtitle:e,onSave:s,isSaving:r=!1,hasUnsavedChanges:n=!1,saveButtonText:o="Save Settings",showSaveButton:c=!0,children:d}){return t.jsx("div",{className:"sticky top-0 z-30 bg-gradient-to-r from-gray-900 via-black to-gray-900 border-b border-red-900/30 backdrop-blur-sm mb-8",children:t.jsxs("div",{className:"flex items-center justify-between p-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-white mb-1",children:a}),e&&t.jsx("p",{className:"text-gray-400",children:e})]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[d,c&&s&&t.jsxs("div",{className:"relative",children:[t.jsx("button",{onClick:s,disabled:r,className:`px-6 py-2 rounded-lg transition-all flex items-center space-x-2 ${n?"bg-red-600 hover:bg-red-700 text-white shadow-lg shadow-red-600/50 animate-pulse":"bg-red-600 hover:bg-red-700 text-white"} disabled:opacity-50 disabled:cursor-not-allowed disabled:animate-none`,children:r?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),t.jsx("span",{children:"Saving..."})]}):t.jsx("span",{children:o})}),n&&!r&&t.jsxs("span",{className:"absolute -top-1 -right-1 flex h-3 w-3",children:[t.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),t.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-red-500"})]})]})]})]})})}function cl(a){return y.useEffect(()=>{const s=r=>{if(a)return r.preventDefault(),r.returnValue="",""};return window.addEventListener("beforeunload",s),()=>window.removeEventListener("beforeunload",s)},[a]),{blockNavigation:y.useCallback(()=>a?window.confirm("You have unsaved changes. Are you sure you want to leave this page? Your changes will be lost."):!0,[a])}}const PI=["American Football","Athletics","Australian Football","Badminton","Baseball","Basketball","Climbing","Cricket","Cycling","Darts","Esports","Equestrian","Extreme Sports","Field Hockey","Fighting","Gaelic","Golf","Gymnastics","Handball","Ice Hockey","Lacrosse","Motorsport","Multi Sports","Netball","Rugby","Shooting","Skating","Skiing","Snooker","Soccer","Table Tennis","Tennis","Volleyball","Watersports","Weightlifting","Wintersports"];function OI({showAdvanced:a=!1}){const e=ca(),[s,r]=y.useState([]),[n,o]=y.useState(!0),[c,d]=y.useState(!1),[f,u]=y.useState(!1),[m,g]=y.useState(null),[x,b]=y.useState(""),[v,w]=y.useState(!1),[S,T]=y.useState(!1),k=y.useRef(null),[E,R]=y.useState(null),[K,z]=y.useState(""),[D,O]=y.useState(()=>localStorage.getItem("sportarr-showAdvanced-mediamanagement")==="true"||a);y.useEffect(()=>{localStorage.setItem("sportarr-showAdvanced-mediamanagement",D.toString())},[D]);const[U,I]=y.useState([]),[F,te]=y.useState(!1),[le,H]=y.useState(!1),[X,q]=y.useState(!1),[ae,ce]=y.useState(null),[ee,W]=y.useState(!1),[V,G]=y.useState(null),[Z,oe]=y.useState(""),[ye,je]=y.useState(""),[xe,Ee]=y.useState(""),[Pe,Re]=y.useState(""),[Qe,ot]=y.useState(""),[ne,ke]=y.useState("");y.useEffect(()=>{D&&(async()=>{try{const Fe=await kt("/api/eventmapping/request/status");if(!Fe.ok)return;const Se=(await Fe.json()).updates||[];for(const st of Se){const wt=st.status==="approved",yt=wt?"Mapping Request Approved!":"Mapping Request Rejected",Mt=st.leagueName?`Your request for ${st.sportType} / ${st.leagueName} has been ${st.status}.`:`Your request for ${st.sportType} has been ${st.status}.`;wt?be.success(yt,{description:st.reviewNotes?`${Mt}

Note: ${st.reviewNotes}`:`${Mt}

The mapping is now available - sync to get it.`,duration:1/0}):be.error(yt,{description:st.reviewNotes?`${Mt}

Reason: ${st.reviewNotes}`:Mt,duration:1/0}),await ds(`/api/eventmapping/request/status/${st.id}/acknowledge`,{})}}catch(Fe){console.error("Failed to check mapping request status:",Fe)}})()},[D]);const{data:Be=[]}=Cs({queryKey:["leagues-for-mapping"],queryFn:async()=>{const ue=await kt("/api/leagues");return ue.ok?(await ue.json()).filter(mt=>mt.name&&mt.sport).map(mt=>({id:mt.id,name:mt.name||"",sportType:mt.sport||"",externalId:mt.externalId||"",badge:mt.logoUrl||mt.posterUrl})):[]},enabled:D,staleTime:300*1e3}),qe=y.useMemo(()=>{if(!Z.trim())return Be;const ue=Z.toLowerCase();return Be.filter(Fe=>(Fe.name||"").toLowerCase().includes(ue)||(Fe.sportType||"").toLowerCase().includes(ue))},[Be,Z]),{data:dt=[]}=Cs({queryKey:["all-leagues-for-mapping"],queryFn:async()=>{const ue=await kt("/api/leagues/all");return ue.ok?(await ue.json()).filter(mt=>mt.strLeague&&mt.strSport).map(mt=>({name:mt.strLeague,sport:mt.strSport})):[]},enabled:D&&ee,staleTime:600*1e3}),He=y.useMemo(()=>ye?dt.filter(ue=>(ue.sport||"").toLowerCase()===ye.toLowerCase()).sort((ue,Fe)=>ue.name.localeCompare(Fe.name)):[],[dt,ye]);cl(S);const[Ce,_e]=y.useState({renameEvents:!1,replaceIllegalCharacters:!0,enableMultiPartEpisodes:!0,standardFileFormat:"{Series} - {Season}{Episode}{Part} - {Event Title} - {Quality Full}",createEventFolders:!0,deleteEmptyFolders:!1,skipFreeSpaceCheck:!1,minimumFreeSpace:100,useHardlinks:!0,copyFiles:!1,importExtraFiles:!1,extraFileExtensions:"srt,nfo",changeFileDate:"None",recycleBin:"",recycleBinCleanup:7,setPermissions:!1,chmodFolder:"755",chownGroup:""});y.useEffect(()=>{tt(),Ct(),ge()},[]);const ge=async()=>{try{const ue=await kt(`/api/trash/naming-presets?enableMultiPartEpisodes=${Ce.enableMultiPartEpisodes}`);if(ue.ok){const Fe=await ue.json();R(Fe)}}catch(ue){console.error("Failed to load naming presets:",ue)}};y.useEffect(()=>{E&&ge()},[Ce.enableMultiPartEpisodes]),y.useEffect(()=>{D&&U.length===0&&!F&&Ze()},[D]);const Ze=async()=>{te(!0);try{const ue=await kt("/api/eventmapping");if(ue.ok){const Fe=await ue.json();I(Fe)}else console.error("Failed to load event mappings:",ue.status)}catch(ue){console.error("Failed to load event mappings:",ue)}finally{te(!1)}},Me=async(ue=!1)=>{H(!0);try{const mt=await ds(ue?"/api/eventmapping/sync/full":"/api/eventmapping/sync",{});if(mt.ok){const Se=await mt.json();ce(Se),Se.success?(be.success("Sync Complete",{description:`Added: ${Se.added}, Updated: ${Se.updated}, Unchanged: ${Se.unchanged}`}),await Ze()):be.error("Sync Issues",{description:Se.errors.join(", ")||"Some errors occurred during sync"})}else{const Se=await mt.text();be.error("Sync Failed",{description:Se||"Failed to sync mappings from server"})}}catch(Fe){console.error("Sync failed:",Fe),be.error("Sync Failed",{description:Fe instanceof Error?Fe.message:"An unexpected error occurred"})}finally{H(!1)}},nt=async()=>{if(!ye.trim()){be.error("Sport Type Required",{description:"Please enter a sport type (e.g., Motorsport, Fighting, Basketball)"});return}if(!Pe.trim()){be.error("Release Names Required",{description:"Please enter at least one release name pattern"});return}q(!0);try{const ue=await ds("/api/eventmapping/request",{sportType:ye.trim(),leagueName:xe.trim()||null,releaseNames:Pe.split(",").map(Fe=>Fe.trim()).filter(Fe=>Fe),reason:Qe.trim()||null,exampleRelease:ne.trim()||null});if(ue.ok){const Fe=await ue.json();Fe.success?(be.success("Request Submitted",{description:Fe.message,duration:8e3}),G(null),oe(""),je(""),Ee(""),Re(""),ot(""),ke(""),W(!1)):be.error("Submission Failed",{description:Fe.message})}else{const Fe=await ue.text();be.error("Submission Failed",{description:Fe||"Failed to submit mapping request"})}}catch(ue){console.error("Submit failed:",ue),be.error("Submission Failed",{description:ue instanceof Error?ue.message:"An unexpected error occurred"})}finally{q(!1)}},ht=ue=>{switch(ue){case"local":return t.jsx("span",{className:"px-2 py-0.5 bg-blue-600/20 text-blue-400 text-xs rounded",children:"Local Override"});case"admin":return t.jsx("span",{className:"px-2 py-0.5 bg-purple-600/20 text-purple-400 text-xs rounded",children:"Official"});case"community":default:return t.jsx("span",{className:"px-2 py-0.5 bg-green-600/20 text-green-400 text-xs rounded",children:"Community"})}},Oe=ue=>{var mt;if(!((mt=E==null?void 0:E.file)!=null&&mt[ue]))return;const Fe=E.file[ue];me("standardFileFormat",Fe.format),z(ue),be.success("Naming preset applied",{description:Fe.description})},tt=async()=>{try{const ue=await kt("/api/settings");if(ue.ok){const Fe=await ue.json();if(Fe.mediaManagementSettings){const mt=JSON.parse(Fe.mediaManagementSettings);_e(mt),k.current=mt,T(!1)}}}catch(ue){console.error("Failed to load media management settings:",ue)}};y.useEffect(()=>{if(!k.current)return;const ue=JSON.stringify(Ce)!==JSON.stringify(k.current);T(ue)},[Ce]);const Ct=async()=>{try{const ue=await kt("/api/rootfolder");if(ue.ok){const Fe=await ue.json();r(Fe)}}catch(ue){console.error("Failed to fetch root folders:",ue)}finally{o(!1)}},we=ue=>`${(ue/1073741824).toFixed(2)} GB`,bt=async()=>{if(x.trim())try{const ue=await ds("/api/rootfolder",{path:x.trim()});if(ue.ok){const Fe=await ue.json();r(mt=>[...mt,Fe]),u(!1),b("")}else{const Fe=await ue.json();console.error("Failed to add root folder:",Fe.error)}}catch(ue){console.error("Failed to add folder:",ue)}},ve=async ue=>{try{(await Na(`/api/rootfolder/${ue}`)).ok&&(r(mt=>mt.filter(Se=>Se.id!==ue)),g(null))}catch(Fe){console.error("Failed to delete folder:",Fe)}},xt=async()=>{d(!0);try{const ue=await kt("/api/settings");if(!ue.ok)throw new Error("Failed to fetch current settings");const mt={...await ue.json(),mediaManagementSettings:JSON.stringify(Ce)};if(!(await br("/api/settings",mt)).ok)throw new Error("Failed to save settings");await e.invalidateQueries({queryKey:["config"]}),k.current=Ce,T(!1)}catch(ue){console.error("Failed to save settings:",ue),be.error("Save Failed",{description:"Failed to save settings. Please try again."})}finally{d(!1)}},me=(ue,Fe)=>{_e(mt=>({...mt,[ue]:Fe}))},De=y.useRef(null);return y.useEffect(()=>{if(De.current===null){De.current=Ce.enableMultiPartEpisodes;return}const ue=De.current,Fe=Ce.enableMultiPartEpisodes;if(ue!==Fe){const mt=Ce.standardFileFormat||"";if(Fe&&!mt.includes("{Part}")){let Se;mt.includes("{Episode}")?Se=mt.replace("{Episode}","{Episode}{Part}"):Se=mt.trim()+"{Part}",_e(st=>({...st,standardFileFormat:Se}))}else if(!Fe&&mt.includes("{Part}")){const Se=mt.replace("{Part}","");_e(st=>({...st,standardFileFormat:Se}))}De.current=Fe}},[Ce.enableMultiPartEpisodes]),t.jsxs("div",{children:[t.jsx(Rn,{title:"Media Management",subtitle:"Settings for file naming, root folders, and file management",onSave:xt,isSaving:c,hasUnsavedChanges:S,children:t.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer text-sm",children:[t.jsx("input",{type:"checkbox",checked:D,onChange:ue=>O(ue.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600 focus:ring-offset-gray-900"}),t.jsx("span",{className:"text-gray-300",children:"Show Advanced"})]})}),t.jsxs("div",{className:"max-w-4xl mx-auto px-6",children:[t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Root Folders"}),t.jsxs("button",{onClick:()=>u(!0),className:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[t.jsx(hr,{className:"w-4 h-4 mr-2"}),"Add Root Folder"]})]}),t.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Root folders where Sportarr will store sports events"}),t.jsx("div",{className:"space-y-2",children:s.map(ue=>t.jsxs("div",{className:"flex items-center justify-between p-4 bg-black/30 rounded-lg border border-gray-800",children:[t.jsxs("div",{className:"flex items-center flex-1",children:[t.jsx(Kr,{className:"w-5 h-5 text-red-400 mr-3"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-white font-medium",children:ue.path}),t.jsxs("p",{className:"text-sm text-gray-400",children:["Free Space: ",we(ue.freeSpace)]})]})]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[ue.accessible?t.jsx($a,{className:"w-5 h-5 text-green-500"}):t.jsx(qt,{className:"w-5 h-5 text-red-500"}),t.jsx("button",{onClick:()=>g(ue.id),className:"text-gray-400 hover:text-red-400 text-sm transition-colors",children:"Delete"})]})]},ue.id))}),s.length===0&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx(Kr,{className:"w-16 h-16 text-gray-700 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500 mb-2",children:"No root folders configured"}),t.jsx("p",{className:"text-sm text-gray-400",children:"Add at least one root folder where Sportarr will store events"})]})]}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Event Naming"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:Ce.renameEvents,onChange:ue=>me("renameEvents",ue.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Rename Events"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Rename event files based on naming scheme"})]})]}),t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:Ce.replaceIllegalCharacters,onChange:ue=>me("replaceIllegalCharacters",ue.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Replace Illegal Characters"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Replace illegal characters with replacement character"})]})]}),t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:Ce.enableMultiPartEpisodes,onChange:ue=>me("enableMultiPartEpisodes",ue.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Enable Multi-Part Episodes"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Detect and name multi-part episodes for Fighting sports (Early Prelims, Prelims, Main Card)"}),t.jsxs("div",{className:"mt-2 px-3 py-2 bg-blue-950/30 border border-blue-900/50 rounded text-xs",children:[t.jsx("p",{className:"text-blue-300 font-medium mb-1",children:"Plex TV Show Structure:"}),t.jsx("p",{className:"text-gray-400",children:"MMA League - s2024e12 - pt1 - Event 100 Main Event - Bluray-1080p.mkv (Early Prelims)"}),t.jsx("p",{className:"text-gray-400",children:"MMA League - s2024e12 - pt2 - Event 100 Main Event - Bluray-1080p.mkv (Prelims)"}),t.jsx("p",{className:"text-gray-400",children:"MMA League - s2024e12 - pt3 - Event 100 Main Event - Bluray-1080p.mkv (Main Card)"})]})]})]}),Ce.renameEvents&&t.jsx(t.Fragment,{children:t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("label",{className:"block text-white font-medium",children:"Standard Event Format"}),(E==null?void 0:E.file)&&Object.keys(E.file).length>0&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(tl,{className:"w-4 h-4 text-purple-400"}),t.jsxs("select",{value:K,onChange:ue=>Oe(ue.target.value),className:"px-3 py-1 bg-gray-800 border border-purple-700 rounded text-sm text-purple-200 focus:outline-none focus:border-purple-500",children:[t.jsx("option",{value:"",className:"bg-gray-800 text-gray-300",children:"TRaSH Naming Presets..."}),Object.entries(E.file).map(([ue,Fe])=>t.jsxs("option",{value:ue,className:"bg-gray-800 text-white",children:[ue.replace(/-/g," ").replace(/\b\w/g,mt=>mt.toUpperCase()),Fe.supportsMultiPart?" (Multi-Part)":""]},ue))]})]})]}),t.jsx("div",{className:"relative",children:t.jsx("input",{type:"text",value:Ce.standardFileFormat,onChange:ue=>{me("standardFileFormat",ue.target.value),z("")},className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600 font-mono",placeholder:"{Series} - {Season}{Episode}{Part} - {Event Title} - {Quality Full}"})}),t.jsxs("div",{className:"mt-3 p-4 bg-black/30 rounded-lg border border-gray-800",children:[t.jsx("p",{className:"text-sm font-medium text-gray-300 mb-2",children:"Available Tokens (click to insert):"}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[{token:"{Series}",desc:"MMA League",category:"Plex"},{token:"{Season}",desc:"s2024",category:"Plex"},{token:"{Episode}",desc:"e12",category:"Plex"},{token:"{Part}",desc:"pt1/pt2/pt3",category:"Plex"},{token:"{Event Title}",desc:"Event 100",category:"Event"},{token:"{Event Date}",desc:"2024-04-13",category:"Event"},{token:"{Quality Full}",desc:"Bluray-1080p",category:"Quality"},{token:"{Release Group}",desc:"GROUP",category:"Release"}].map(ue=>t.jsxs("button",{onClick:()=>{const Fe=document.querySelector('input[placeholder*="Series"]');if(Fe){const mt=Ce.standardFileFormat||"",Se=Fe.selectionStart||mt.length,st=mt.slice(0,Se)+ue.token+mt.slice(Se);me("standardFileFormat",st)}},className:"text-left px-3 py-2 bg-gray-800 hover:bg-gray-700 border border-gray-700 hover:border-red-600 rounded text-sm transition-colors group",children:[t.jsx("div",{className:"font-mono text-purple-400 text-xs group-hover:text-purple-300",children:ue.token}),t.jsx("div",{className:"text-gray-500 text-xs mt-0.5",children:ue.desc})]},ue.token))})]}),t.jsxs("div",{className:"mt-3 p-4 bg-gradient-to-r from-blue-950/30 to-purple-950/30 border border-blue-900/50 rounded-lg",children:[t.jsx("p",{className:"text-sm font-medium text-blue-300 mb-2",children:"Preview:"}),t.jsxs("p",{className:"text-white font-mono text-sm break-all",children:[(Ce.standardFileFormat||"").replace(/{Series}/g,"MMA League").replace(/{Season}/g,"s2024").replace(/{Episode}/g,"e12").replace(/{Part}/g,Ce.enableMultiPartEpisodes?" - pt3":"").replace(/{Event Title}/g,"Event 100 Main Event").replace(/{League}/g,"MMA League").replace(/{Event Date}/g,"2024-11-16").replace(/{Quality Full}/g,"Bluray-1080p").replace(/{Release Group}/g,"GROUP"),".mkv"]}),t.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["This shows how your events will be named with the current format",Ce.enableMultiPartEpisodes&&t.jsx("span",{className:"text-blue-400",children:" (with multi-part enabled, showing Main Card example)"})]})]})]})})]})]}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Folders"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:Ce.createEventFolders,onChange:ue=>me("createEventFolders",ue.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Create Event Folders"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Create individual folders for each event"})]})]}),D&&t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:Ce.deleteEmptyFolders,onChange:ue=>me("deleteEmptyFolders",ue.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Delete Empty Folders"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Delete empty event folders during disk scan"}),t.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 bg-yellow-900/30 text-yellow-400 text-xs rounded",children:"Advanced"})]})]})]})]}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Importing"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:Ce.useHardlinks,onChange:ue=>me("useHardlinks",ue.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Use Hardlinks instead of Copy"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Use hardlinks when copying files from torrents (requires same filesystem)"})]})]}),t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:Ce.copyFiles,onChange:ue=>me("copyFiles",ue.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Copy Files (instead of Move)"}),t.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[t.jsx("strong",{children:"Disabled (recommended):"})," Files are moved from downloads to your library, freeing up space.",t.jsx("br",{}),t.jsx("strong",{children:"Enabled:"})," Files are copied, keeping the original in downloads (uses more disk space).",t.jsx("br",{}),t.jsx("span",{className:"text-gray-500 italic",children:"Debrid users: This setting doesn't affect you - symlinks are always handled correctly."})]})]})]}),t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:Ce.importExtraFiles,onChange:ue=>me("importExtraFiles",ue.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Import Extra Files"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Import matching extra files (subtitles, nfo, etc)"})]})]}),Ce.importExtraFiles&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Extra File Extensions"}),t.jsx("input",{type:"text",value:Ce.extraFileExtensions,onChange:ue=>me("extraFileExtensions",ue.target.value),placeholder:"srt,nfo,jpg,png",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Comma separated list of extra file extensions to import"})]}),D&&t.jsxs(t.Fragment,{children:[t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:Ce.skipFreeSpaceCheck,onChange:ue=>me("skipFreeSpaceCheck",ue.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Skip Free Space Check"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Skip checking free space before importing"}),t.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 bg-yellow-900/30 text-yellow-400 text-xs rounded",children:"Advanced"})]})]}),!Ce.skipFreeSpaceCheck&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Minimum Free Space"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"number",value:Ce.minimumFreeSpace,onChange:ue=>me("minimumFreeSpace",Number(ue.target.value)),className:"w-32 px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("span",{className:"text-gray-400",children:"MB"})]}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Prevent import if it would leave less than this amount of free space"}),t.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 bg-yellow-900/30 text-yellow-400 text-xs rounded",children:"Advanced"})]})]})]})]}),D&&t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("h3",{className:"text-xl font-semibold text-white mb-4",children:["File Management",t.jsx("span",{className:"ml-2 px-2 py-0.5 bg-yellow-900/30 text-yellow-400 text-xs rounded",children:"Advanced"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Recycle Bin Path"}),t.jsx("input",{type:"text",value:Ce.recycleBin,onChange:ue=>me("recycleBin",ue.target.value),placeholder:"/path/to/recycle/bin",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Files will be moved here instead of being deleted"})]}),Ce.recycleBin&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Recycle Bin Cleanup"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"number",value:Ce.recycleBinCleanup,onChange:ue=>me("recycleBinCleanup",Number(ue.target.value)),className:"w-32 px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("span",{className:"text-gray-400",children:"days"})]}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Set to 0 to disable automatic cleanup"})]}),t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:Ce.setPermissions,onChange:ue=>me("setPermissions",ue.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Set Permissions"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Set file permissions during import/rename (Linux/macOS only)"})]})]}),Ce.setPermissions&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"chmod Folder"}),t.jsx("input",{type:"text",value:Ce.chmodFolder,onChange:ue=>me("chmodFolder",ue.target.value),placeholder:"755",className:"w-32 px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"chown Group"}),t.jsx("input",{type:"text",value:Ce.chownGroup,onChange:ue=>me("chownGroup",ue.target.value),placeholder:"media",className:"w-64 px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"})]})]})]})]}),D&&t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsx("div",{className:"flex items-center justify-between mb-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(Nh,{className:"w-6 h-6 text-red-400 mr-3"}),t.jsxs("h3",{className:"text-xl font-semibold text-white",children:["Event Mappings",t.jsx("span",{className:"ml-2 px-2 py-0.5 bg-yellow-900/30 text-yellow-400 text-xs rounded",children:"Advanced"})]})]})}),t.jsx("div",{className:"mb-4 p-3 bg-blue-900/20 border border-blue-900/30 rounded-lg",children:t.jsxs("p",{className:"text-blue-300 text-sm",children:[t.jsx("strong",{children:"Event Mappings"}),' help Sportarr match release names (like "Formula1", "F1", "UFC") to official database names. Mappings sync automatically every 12 hours from the Sportarr API.']})}),t.jsxs("div",{className:"mb-4 p-4 bg-black/30 rounded-lg",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-white font-medium",children:"Sync Mappings"}),t.jsx("p",{className:"text-gray-400 text-sm",children:"Mappings auto-sync every 12 hours. Manual sync is available below."})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>Me(!1),disabled:le,className:"px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-white text-sm rounded-lg transition-colors flex items-center space-x-1.5 disabled:opacity-50 disabled:cursor-not-allowed",children:le?t.jsxs(t.Fragment,{children:[t.jsx(Dt,{className:"w-4 h-4 animate-spin"}),t.jsx("span",{children:"Syncing..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(Dt,{className:"w-4 h-4"}),t.jsx("span",{children:"Sync Updates"})]})}),t.jsxs("button",{onClick:()=>Me(!0),disabled:le,className:"px-3 py-1.5 bg-red-600 hover:bg-red-700 text-white text-sm rounded-lg transition-colors flex items-center space-x-1.5 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx(Dt,{className:"w-4 h-4"}),t.jsx("span",{children:"Full Sync"})]})]})]}),ae&&t.jsx("div",{className:`p-2 rounded text-sm ${ae.success?"bg-green-900/20 border border-green-900/30":"bg-yellow-900/20 border border-yellow-900/30"}`,children:t.jsxs("div",{className:"flex items-center space-x-3",children:[ae.success?t.jsx(rs,{className:"w-4 h-4 text-green-400"}):t.jsx(Ss,{className:"w-4 h-4 text-yellow-400"}),t.jsxs("span",{className:ae.success?"text-green-300":"text-yellow-300",children:["Added: ",ae.added," | Updated: ",ae.updated," | Unchanged: ",ae.unchanged]}),t.jsxs("span",{className:"text-gray-500 text-xs",children:["(",(ae.duration/1e3).toFixed(1),"s)"]})]})})]}),t.jsxs("div",{className:"mb-4 p-4 bg-black/30 rounded-lg",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(NS,{className:"w-5 h-5 text-green-400 mr-2"}),t.jsx("span",{className:"text-white font-medium",children:"Request New Mapping"})]}),!ee&&t.jsxs("button",{onClick:()=>W(!0),className:"px-3 py-1.5 bg-green-600 hover:bg-green-700 text-white text-sm rounded-lg transition-colors flex items-center space-x-1.5",children:[t.jsx(hr,{className:"w-4 h-4"}),t.jsx("span",{children:"New Request"})]})]}),t.jsx("p",{className:"text-gray-400 text-sm",children:"Missing a mapping? Submit a request and it will be reviewed by the Sportarr team."}),ee&&t.jsxs("div",{className:"mt-4 grid grid-cols-1 lg:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"lg:col-span-2 space-y-3",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-white text-sm font-medium mb-1",children:["Select League ",t.jsx("span",{className:"text-gray-500",children:"(from your library)"})]}),Be.length>0?t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Ks,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),t.jsx("input",{type:"text",value:Z,onChange:ue=>oe(ue.target.value),className:"w-full pl-9 pr-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-red-600",placeholder:"Search leagues..."})]}),t.jsx("div",{className:"max-h-48 overflow-y-auto border border-gray-700 rounded-lg bg-gray-900/50",children:qe.length===0?t.jsx("p",{className:"text-gray-500 text-sm p-3 text-center",children:"No leagues found"}):t.jsx("div",{className:"divide-y divide-gray-800",children:qe.map(ue=>t.jsxs("button",{onClick:()=>{G(ue),je(ue.sportType),Ee(ue.name),oe("")},className:`w-full flex items-center gap-2 p-2 text-left transition-colors ${(V==null?void 0:V.id)===ue.id?"bg-red-600/20 border-l-2 border-l-red-600":"hover:bg-gray-800"}`,children:[ue.badge&&t.jsx("img",{src:ue.badge,alt:"",className:"w-6 h-6 object-contain"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"text-white text-sm truncate",children:ue.name}),t.jsx("div",{className:"text-gray-500 text-xs",children:ue.sportType})]}),(V==null?void 0:V.id)===ue.id&&t.jsx($a,{className:"w-4 h-4 text-red-400 flex-shrink-0"})]},ue.id))})}),V&&t.jsxs("div",{className:"flex items-center gap-2 p-2 bg-red-900/20 border border-red-900/30 rounded-lg",children:[t.jsx(rs,{className:"w-4 h-4 text-green-400"}),t.jsxs("span",{className:"text-green-300 text-sm",children:["Selected: ",V.name]}),t.jsx("button",{onClick:()=>{G(null),je(""),Ee("")},className:"ml-auto text-gray-400 hover:text-white",children:t.jsx(qt,{className:"w-4 h-4"})})]})]}):t.jsx("p",{className:"text-gray-500 text-sm p-2 bg-gray-800 rounded-lg",children:"No leagues in your library. Add leagues first, or manually enter details below."})]}),t.jsxs("div",{className:"pt-2 border-t border-gray-800",children:[t.jsx("p",{className:"text-gray-500 text-xs mb-2",children:V?"Override auto-filled values if needed:":"Or enter details manually:"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-white text-sm font-medium mb-1",children:["Sport Type ",t.jsx("span",{className:"text-red-400",children:"*"})]}),t.jsxs("select",{value:ye,onChange:ue=>{je(ue.target.value),Ee("")},className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"",children:"Select sport type..."}),PI.map(ue=>t.jsx("option",{value:ue,children:ue},ue))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white text-sm font-medium mb-1",children:"League Name"}),t.jsxs("select",{value:xe,onChange:ue=>Ee(ue.target.value),disabled:!ye||He.length===0,className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-red-600 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx("option",{value:"",children:ye?He.length===0?"No leagues found for this sport":"Select league...":"Select sport type first..."}),He.map(ue=>t.jsx("option",{value:ue.name,children:ue.name},ue.name))]})]})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-white text-sm font-medium mb-1",children:["Release Names ",t.jsx("span",{className:"text-red-400",children:"*"})]}),t.jsx("input",{type:"text",value:Pe,onChange:ue=>Re(ue.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-red-600",placeholder:"Comma-separated: Formula1, F1, Formula.1"}),t.jsx("p",{className:"text-gray-500 text-xs mt-1",children:"Common variations of how this league appears in release names"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white text-sm font-medium mb-1",children:"Example Release"}),t.jsx("input",{type:"text",value:ne,onChange:ue=>ke(ue.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-red-600",placeholder:"e.g., Formula1.2024.Round.23.Abu.Dhabi.Grand.Prix.Race.1080p"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white text-sm font-medium mb-1",children:"Reason / Notes"}),t.jsx("textarea",{value:Qe,onChange:ue=>ot(ue.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-red-600 h-16 resize-none",placeholder:"Why is this mapping needed?"})]}),t.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[t.jsx("button",{onClick:()=>{W(!1),G(null),oe(""),je(""),Ee(""),Re(""),ot(""),ke("")},className:"px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-white text-sm rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:nt,disabled:X||!ye.trim()||!Pe.trim(),className:"px-3 py-1.5 bg-green-600 hover:bg-green-700 text-white text-sm rounded-lg transition-colors flex items-center space-x-1.5 disabled:opacity-50 disabled:cursor-not-allowed",children:X?t.jsxs(t.Fragment,{children:[t.jsx(Dt,{className:"w-4 h-4 animate-spin"}),t.jsx("span",{children:"Submitting..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(NS,{className:"w-4 h-4"}),t.jsx("span",{children:"Submit"})]})})]})]}),t.jsx("div",{className:"lg:col-span-1",children:t.jsxs("div",{className:"p-3 bg-blue-900/20 border border-blue-900/30 rounded-lg",children:[t.jsxs("h4",{className:"text-blue-300 text-sm font-medium mb-2 flex items-center",children:[t.jsx(Nh,{className:"w-4 h-4 mr-1.5"}),"Example Mapping"]}),t.jsxs("div",{className:"space-y-2 text-xs",children:[t.jsxs("div",{className:"p-2 bg-black/30 rounded",children:[t.jsx("div",{className:"text-gray-400 mb-1",children:"Sport Type:"}),t.jsx("div",{className:"text-white font-mono",children:"Motorsport"})]}),t.jsxs("div",{className:"p-2 bg-black/30 rounded",children:[t.jsx("div",{className:"text-gray-400 mb-1",children:"League Name:"}),t.jsx("div",{className:"text-white font-mono",children:"Formula 1"})]}),t.jsxs("div",{className:"p-2 bg-black/30 rounded",children:[t.jsx("div",{className:"text-gray-400 mb-1",children:"Release Names:"}),t.jsx("div",{className:"text-white font-mono",children:"Formula1, F1, Formula.1, Formula.One"})]}),t.jsxs("div",{className:"p-2 bg-black/30 rounded",children:[t.jsx("div",{className:"text-gray-400 mb-1",children:"Example Release:"}),t.jsx("div",{className:"text-white font-mono text-[10px] break-all",children:"Formula1.2024.Round.23.Abu.Dhabi.Grand.Prix.Race.1080p.WEB-DL"})]})]}),t.jsx("p",{className:"text-gray-500 text-xs mt-3",children:"Release names are the variations used in torrent/usenet releases. They help Sportarr match releases to the correct league."})]})})]})]}),t.jsxs("div",{className:"p-4 bg-black/30 rounded-lg",children:[t.jsxs("div",{className:"flex items-center mb-3",children:[t.jsx(Nh,{className:"w-5 h-5 text-red-400 mr-2"}),t.jsx("span",{className:"text-white font-medium",children:"Current Mappings"}),t.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-gray-700 text-gray-300 text-xs rounded",children:[U.length," total"]})]}),F?t.jsxs("div",{className:"text-center py-4",children:[t.jsx(Dt,{className:"w-6 h-6 text-gray-500 animate-spin mx-auto mb-2"}),t.jsx("p",{className:"text-gray-500 text-sm",children:"Loading mappings..."})]}):U.length===0?t.jsxs("div",{className:"text-center py-4",children:[t.jsx(Nh,{className:"w-8 h-8 text-gray-600 mx-auto mb-2"}),t.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"No event mappings configured"}),t.jsx("p",{className:"text-gray-600 text-xs",children:'Mappings will sync automatically, or click "Sync Updates" above'})]}):t.jsxs("div",{className:"overflow-x-auto max-h-64 overflow-y-auto",children:[t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"sticky top-0 bg-gray-900",children:t.jsxs("tr",{className:"text-left text-gray-400 text-xs border-b border-gray-800",children:[t.jsx("th",{className:"pb-2 pr-3",children:"Sport / League"}),t.jsx("th",{className:"pb-2 pr-3",children:"Release Names"}),t.jsx("th",{className:"pb-2 pr-3",children:"Source"}),t.jsx("th",{className:"pb-2 pr-3",children:"Status"}),t.jsx("th",{className:"pb-2",children:"Last Synced"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-800",children:U.slice(0,10).map(ue=>t.jsxs("tr",{className:"text-xs",children:[t.jsxs("td",{className:"py-2 pr-3",children:[t.jsx("div",{className:"text-white",children:ue.sportType}),ue.leagueName&&t.jsx("div",{className:"text-gray-500 text-xs",children:ue.leagueName})]}),t.jsx("td",{className:"py-2 pr-3",children:t.jsxs("div",{className:"flex flex-wrap gap-1",children:[ue.releaseNames.slice(0,2).map((Fe,mt)=>t.jsx("span",{className:"px-1.5 py-0.5 bg-gray-800 text-gray-300 text-xs rounded",children:Fe},mt)),ue.releaseNames.length>2&&t.jsxs("span",{className:"px-1.5 py-0.5 bg-gray-700 text-gray-400 text-xs rounded",children:["+",ue.releaseNames.length-2]})]})}),t.jsx("td",{className:"py-2 pr-3",children:ht(ue.source)}),t.jsx("td",{className:"py-2 pr-3",children:ue.isActive?t.jsxs("span",{className:"flex items-center text-green-400",children:[t.jsx(rs,{className:"w-3.5 h-3.5 mr-1"}),"Active"]}):t.jsxs("span",{className:"flex items-center text-gray-500",children:[t.jsx(Ss,{className:"w-3.5 h-3.5 mr-1"}),"Inactive"]})}),t.jsx("td",{className:"py-2 text-gray-500",children:ue.lastSyncedAt?t.jsxs("span",{className:"flex items-center",children:[t.jsx($r,{className:"w-3 h-3 mr-1"}),new Date(ue.lastSyncedAt).toLocaleDateString()]}):t.jsx("span",{className:"text-gray-600",children:"Never"})})]},ue.id))})]}),U.length>10&&t.jsxs("p",{className:"text-center text-gray-500 text-xs mt-2",children:["Showing 10 of ",U.length," mappings"]})]})]})]}),f&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-2xl w-full",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-2xl font-bold text-white",children:"Add Root Folder"}),t.jsx("button",{onClick:()=>{u(!1),b("")},className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Folder Path *"}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("input",{type:"text",value:x,onChange:ue=>b(ue.target.value),className:"flex-1 px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"/data/sportarr or C:\\Media\\Sportarr"}),t.jsx("button",{type:"button",onClick:()=>w(!0),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 border border-gray-700 text-white rounded-lg transition-colors flex items-center",children:t.jsx(Kr,{className:"w-5 h-5"})})]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Full path to directory where events will be stored"})]}),t.jsx("div",{className:"p-4 bg-blue-950/30 border border-blue-900/50 rounded-lg",children:t.jsxs("p",{className:"text-sm text-blue-300",children:[t.jsx("strong",{children:"Note:"})," The path will be validated when you click Add. Make sure the directory exists and Sportarr has read/write permissions."]})})]}),t.jsxs("div",{className:"mt-6 flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>{u(!1),b("")},className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:bt,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Add Folder"})]})]})}),t.jsx(yj,{isOpen:v,onClose:()=>w(!1),onSelect:ue=>{b(ue),w(!1)},title:"Select Root Folder"}),m!==null&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-md w-full",children:[t.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Delete Root Folder?"}),t.jsx("p",{className:"text-gray-400 mb-6",children:"Are you sure you want to remove this root folder? This will not delete any files, only remove it from Sportarr's configuration."}),t.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>g(null),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>ve(m),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Delete"})]})]})})]})]})}const Za=a=>a.items!==void 0&&a.items!==null&&a.items.length>0,Ng=a=>a.map(e=>({...e,items:e.items?e.items.map(s=>({...s})):void 0})),jg=[{name:"WEB 2160p",quality:19,allowed:!1,id:1019,items:[{name:"WEBDL-2160p",quality:18,allowed:!1,id:18},{name:"WEBRip-2160p",quality:17,allowed:!1,id:17}]},{name:"Bluray-2160p",quality:16,allowed:!1,id:16},{name:"Bluray-2160p Remux",quality:15,allowed:!1,id:15},{name:"HDTV-2160p",quality:14,allowed:!1,id:14},{name:"WEB 1080p",quality:13,allowed:!1,id:1013,items:[{name:"WEBDL-1080p",quality:12,allowed:!1,id:12},{name:"WEBRip-1080p",quality:11,allowed:!1,id:11}]},{name:"Bluray-1080p",quality:10,allowed:!1,id:10},{name:"Bluray-1080p Remux",quality:9,allowed:!1,id:9},{name:"HDTV-1080p",quality:8,allowed:!1,id:8},{name:"WEB 720p",quality:7,allowed:!1,id:1007,items:[{name:"WEBDL-720p",quality:6,allowed:!1,id:6},{name:"WEBRip-720p",quality:5,allowed:!1,id:5}]},{name:"Bluray-720p",quality:4,allowed:!1,id:4},{name:"HDTV-720p",quality:3,allowed:!1,id:3},{name:"Raw-HD",quality:2,allowed:!1,id:2},{name:"WEB 480p",quality:1,allowed:!1,id:1001,items:[{name:"WEBDL-480p",quality:-1,allowed:!1,id:-1},{name:"WEBRip-480p",quality:-2,allowed:!1,id:-2}]},{name:"Bluray-480p",quality:-3,allowed:!1,id:-3},{name:"DVD",quality:-4,allowed:!1,id:-4},{name:"SDTV",quality:-5,allowed:!1,id:-5},{name:"Unknown",quality:0,allowed:!1,id:0}];function FI({showAdvanced:a=!1}){var J,de;const[e,s]=y.useState([]),[r,n]=y.useState([]),[o,c]=y.useState(null),[d,f]=y.useState(!1),[u,m]=y.useState(null),[g,x]=y.useState(!0),[b,v]=y.useState(!1),[w,S]=y.useState(null),[T,k]=y.useState(null),[E,R]=y.useState("alphabetical"),[K,z]=y.useState(!1),[D,O]=y.useState({}),[U,I]=y.useState("default"),[F,te]=y.useState(!1),[le,H]=y.useState([]),[X,q]=y.useState([]),[ae,ce]=y.useState(null),[ee,W]=y.useState(!1),[V,G]=y.useState(null),[Z,oe]=y.useState([]),[ye,je]=y.useState([]),[xe,Ee]=y.useState(null),[Pe,Re]=y.useState(!1),[Qe,ot]=y.useState(null),[ne,ke]=y.useState({name:"",isDefault:!1,upgradesAllowed:!0,cutoffQuality:null,items:Ng(jg),formatItems:[],minFormatScore:0,cutoffFormatScore:1e4,formatScoreIncrement:1,minSize:null,maxSize:null}),[Be,qe]=y.useState({id:0,order:1,preferredProtocol:"Torrent",usenetDelay:0,torrentDelay:0,bypassIfHighestQuality:!1,bypassIfAboveCustomFormatScore:!1,minimumCustomFormatScore:0,tags:[]}),[dt,He]=y.useState({name:"",enabled:!0,required:"",ignored:"",preferred:[],includePreferredWhenRenaming:!1,tags:[],indexerId:[]});y.useEffect(()=>{Ce(),_e(),ge(),Ze(),Me(),nt(),ht()},[]);const Ce=async()=>{try{const B=await kt("/api/qualityprofile");if(B.ok){const se=await B.json();s(se)}}catch(B){console.error("Failed to load quality profiles:",B)}finally{x(!1)}},_e=async()=>{try{const B=await kt("/api/customformat");if(B.ok){const se=await B.json();n(se)}}catch(B){console.error("Failed to load custom formats:",B)}},ge=async()=>{try{const B=await kt("/api/delayprofile");if(B.ok){const se=await B.json();H(se)}}catch(B){console.error("Error loading delay profiles:",B)}},Ze=async()=>{try{const B=await kt("/api/tag");if(B.ok){const se=await B.json();q(se)}}catch(B){console.error("Error loading tags:",B)}},Me=async()=>{try{const B=await kt("/api/releaseprofile");if(B.ok){const se=await B.json();oe(se)}}catch(B){console.error("Error loading release profiles:",B)}},nt=async()=>{try{const B=await kt("/api/indexer");if(B.ok){const se=await B.json();je(se)}}catch(B){console.error("Error loading indexers:",B)}},ht=async()=>{try{const B=await kt("/api/trash/scoresets");if(B.ok){const se=await B.json();O(se)}}catch(B){console.error("Error loading TRaSH score sets:",B)}},Oe=async()=>{var B;if(!(o!=null&&o.id)){be.error("Please save the profile first before applying TRaSH scores");return}te(!0);try{const se=await ds(`/api/trash/apply-scores/${o.id}?scoreSet=${U}`,{});if(se.ok){const fe=await se.json();if(fe.success){be.success("TRaSH Scores Applied",{description:`Updated ${fe.updated} format scores, added ${fe.created} new scores`}),await Ce(),await _e();const he=await kt(`/api/qualityprofile/${o.id}`);if(he.ok){const Ue=((B=(await he.json()).formatItems)==null?void 0:B.map(Ge=>{const re=r.find(Le=>Le.id===Ge.formatId);return{...Ge,formatName:(re==null?void 0:re.name)||`Format #${Ge.formatId}`,trashDefaultScore:re==null?void 0:re.trashDefaultScore,isSynced:re==null?void 0:re.isSynced}}))||[];ke(Ge=>({...Ge,formatItems:Ue}))}z(!1)}else be.error("Failed to apply scores",{description:fe.error||"Unknown error"})}else be.error("Failed to apply TRaSH scores")}catch(se){console.error("Error applying TRaSH scores:",se),be.error("Failed to apply TRaSH scores")}finally{te(!1)}},tt=()=>{c(null),v(!1),ke({name:"",isDefault:!1,upgradesAllowed:!0,cutoffQuality:null,items:Ng(jg),formatItems:r.map(B=>({formatId:B.id,formatName:B.name,score:0})),minFormatScore:0,cutoffFormatScore:1e4,formatScoreIncrement:1,minSize:null,maxSize:null}),f(!0)},Ct=B=>{var fe;c(B),v(!1);const se=((fe=B.formatItems)==null?void 0:fe.map(he=>{const pe=r.find(Ue=>Ue.id===he.formatId);return{...he,formatName:(pe==null?void 0:pe.name)||he.formatName||`Format ${he.formatId}`,trashDefaultScore:pe==null?void 0:pe.trashDefaultScore,isSynced:pe==null?void 0:pe.isSynced}}))||[];ke({...B,formatItems:se}),f(!0)},we=B=>{var fe;c(null),v(!1);const se=((fe=B.formatItems)==null?void 0:fe.map(he=>{const pe=r.find(Ue=>Ue.id===he.formatId);return{...he,formatName:(pe==null?void 0:pe.name)||he.formatName||`Format ${he.formatId}`,trashDefaultScore:pe==null?void 0:pe.trashDefaultScore,isSynced:pe==null?void 0:pe.isSynced}}))||[];ke({...B,id:void 0,name:`${B.name} (Copy)`,isDefault:!1,items:Ng(B.items),formatItems:se}),f(!0)},bt=async()=>{if(ne.name)try{const B=o?`/api/qualityprofile/${o.id}`:"/api/qualityprofile",se=o?await br(B,ne):await ds(B,ne);if(se.ok)await Ce(),f(!1),c(null);else if(se.status===400){const fe=await se.json();alert(fe.error||"A quality profile with this name already exists")}}catch(B){console.error("Failed to save quality profile:",B)}},ve=async B=>{try{(await Na(`/api/qualityprofile/${B}`)).ok&&(await Ce(),m(null))}catch(se){console.error("Failed to delete quality profile:",se)}},xt=async B=>{try{const se=e.map(fe=>({...fe,isDefault:fe.id===B}));for(const fe of se){const he=await br(`/api/qualityprofile/${fe.id}`,fe);if(!he.ok){const pe=await he.json();console.error("Failed to update profile:",pe),alert(`Failed to set default profile: ${pe.error||"Unknown error"}`);return}}await Ce()}catch(se){console.error("Failed to set default quality profile:",se),alert("Failed to set default quality profile. Check console for details.")}},me=(B,se=!1)=>{ke(fe=>{var he;return{...fe,items:(he=fe.items)==null?void 0:he.map(pe=>{if(pe.id===B){const Ue=!pe.allowed;return se&&pe.items?{...pe,allowed:Ue,items:pe.items.map(Ge=>({...Ge,allowed:Ue}))}:{...pe,allowed:Ue}}if(pe.items){const Ue=pe.items.map(re=>re.id===B?{...re,allowed:!re.allowed}:re),Ge=Ue.some(re=>re.allowed);return{...pe,items:Ue,allowed:Ge}}return pe})}})},De=B=>{B!==0&&ke(se=>{const fe=[...se.items||[]];return[fe[B-1],fe[B]]=[fe[B],fe[B-1]],{...se,items:fe}})},ue=B=>{ke(se=>{const fe=se.items||[];if(B>=fe.length-1)return se;const he=[...fe];return[he[B],he[B+1]]=[he[B+1],he[B]],{...se,items:he}})},Fe=B=>{ke(se=>{const fe=[...se.items||[]],he=fe[B];return Za(he)?se:(fe[B]={name:he.name,quality:he.quality,allowed:he.allowed,id:he.id?he.id+1e3:1e3+B,items:[{...he}]},{...se,items:fe})})},mt=B=>{ke(se=>{const fe=[...se.items||[]],he=fe[B];return!Za(he)||!he.items?se:(fe.splice(B,1,...he.items),{...se,items:fe})})},Se=(B,se,fe,he)=>{S({index:se,isGroup:fe,parentIndex:he}),B.dataTransfer.effectAllowed="move"},st=(B,se,fe,he)=>{var Ue;if(B.preventDefault(),!w)return;if(w.index===se&&w.parentIndex===he){k(null);return}const pe=(Ue=B.target.closest("[data-droppable]"))==null?void 0:Ue.getBoundingClientRect();if(pe){const Ge=pe.top+pe.height/2,re=B.clientY<Ge?"above":"below";k({index:se,parentIndex:he,position:re})}},wt=B=>{const se=B.relatedTarget;se!=null&&se.closest("[data-droppable]")||k(null)},yt=()=>{S(null),k(null)},Mt=(B,se,fe,he)=>{if(B.preventDefault(),!w)return;let pe=se;(T==null?void 0:T.position)==="below"&&(pe=se+1),ke(Ue=>{const Ge=[...Ue.items||[]];if(w.parentIndex===void 0&&he===void 0){const[re]=Ge.splice(w.index,1),Le=pe>w.index?pe-1:pe;Ge.splice(Le,0,re)}else if(w.parentIndex!==void 0&&he!==void 0&&w.parentIndex===he){const re=Ge[he];if(re.items){const Le=[...re.items],[Je]=Le.splice(w.index,1),it=pe>w.index?pe-1:pe;Le.splice(it,0,Je),Ge[he]={...re,items:Le}}}else if(w.parentIndex===void 0&&he!==void 0){const[re]=Ge.splice(w.index,1),Le=he>w.index?he-1:he,Je=Ge[Le];if(Je.items){const it=[...Je.items];it.splice(pe,0,re),Ge[Le]={...Je,items:it}}}else if(w.parentIndex!==void 0&&he===void 0){const re=Ge[w.parentIndex];if(re.items){const Le=[...re.items],[Je]=Le.splice(w.index,1);Ge[w.parentIndex]={...re,items:Le},Ge.splice(pe,0,Je)}}return{...Ue,items:Ge}}),S(null),k(null)},Ke=(B,se)=>{ke(fe=>{var he;return{...fe,formatItems:(he=fe.formatItems)==null?void 0:he.map(pe=>pe.formatId===B?{...pe,score:se}:pe)}})},Vt=B=>{if(B==null)return"Not Set";for(const se of jg){if(se.quality===B||se.id===B)return se.name;if(se.items){const fe=se.items.find(he=>he.quality===B||he.id===B);if(fe)return fe.name}}return"Unknown"},Nt=B=>{if(B.cutoffQuality===null||B.cutoffQuality===void 0)return"Not Set";for(const se of B.items){if(se.quality===B.cutoffQuality)return se.name;if(se.items){const fe=se.items.find(he=>he.quality===B.cutoffQuality);if(fe)return fe.name}}return Vt(B.cutoffQuality)},St=B=>{if(!B)return[];const se=[];for(const fe of B)if(fe.allowed&&se.push(fe),fe.items)for(const he of fe.items)he.allowed&&se.push(he);return se},Kt=async()=>{try{const B=ae?`/api/delayprofile/${ae.id}`:"/api/delayprofile";(ae?await br(B,Be):await ds(B,Be)).ok&&(await ge(),W(!1),ce(null),jt())}catch(B){console.error("Error saving delay profile:",B)}},ws=async B=>{try{(await Na(`/api/delayprofile/${B}`)).ok&&(await ge(),G(null))}catch(se){console.error("Error deleting delay profile:",se)}},Ne=B=>{ce(B),qe({...B}),W(!0)},gt=()=>{ce(null),jt(),W(!0)},jt=()=>{qe({id:0,order:le.length+1,preferredProtocol:"Torrent",usenetDelay:0,torrentDelay:0,bypassIfHighestQuality:!1,bypassIfAboveCustomFormatScore:!1,minimumCustomFormatScore:0,tags:[]})},vt=B=>{qe(se=>({...se,tags:se.tags.includes(B)?se.tags.filter(fe=>fe!==B):[...se.tags,B]}))},os=B=>B.length===0?"All Events (Default)":B.map(se=>{var fe;return((fe=X.find(he=>he.id===se))==null?void 0:fe.label)||"Unknown"}).join(", "),xs=async()=>{if(dt.name)try{const B=xe?`/api/releaseprofile/${xe.id}`:"/api/releaseprofile";(xe?await br(B,dt):await ds(B,dt)).ok&&(await Me(),Re(!1),Ee(null),C())}catch(B){console.error("Error saving release profile:",B)}},hs=async B=>{try{(await Na(`/api/releaseprofile/${B}`)).ok&&(await Me(),ot(null))}catch(se){console.error("Error deleting release profile:",se)}},Yr=B=>{Ee(B),He({...B}),Re(!0)},M=()=>{Ee(null),C(),Re(!0)},C=()=>{He({name:"",enabled:!0,required:"",ignored:"",preferred:[],includePreferredWhenRenaming:!1,tags:[],indexerId:[]})},j=B=>{He(se=>({...se,tags:se.tags.includes(B)?se.tags.filter(fe=>fe!==B):[...se.tags,B]}))},_=B=>{He(se=>({...se,indexerId:se.indexerId.includes(B)?se.indexerId.filter(fe=>fe!==B):[...se.indexerId,B]}))},P=()=>{He(B=>({...B,preferred:[...B.preferred,{key:"",value:0}]}))},L=(B,se,fe)=>{He(he=>({...he,preferred:he.preferred.map((pe,Ue)=>Ue===B?{...pe,[se]:fe}:pe)}))},$=B=>{He(se=>({...se,preferred:se.preferred.filter((fe,he)=>he!==B)}))};return g?t.jsx("div",{className:"max-w-6xl mx-auto text-center py-12",children:t.jsx("div",{className:"text-gray-400",children:"Loading profiles..."})}):t.jsxs("div",{className:"max-w-6xl mx-auto",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Quality Profiles"}),t.jsx("p",{className:"text-gray-400",children:"Quality profiles determine which releases Sportarr will download and upgrade"})]}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Profiles"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Configure quality settings and custom format scoring"})]}),t.jsxs("button",{onClick:tt,className:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[t.jsx(hr,{className:"w-4 h-4 mr-2"}),"Add Profile"]})]}),e.length===0?t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsx("p",{className:"mb-2",children:"No quality profiles configured"}),t.jsx("p",{className:"text-sm",children:"Create your first profile to get started"})]}):t.jsx("div",{className:"space-y-3",children:e.map(B=>t.jsxs("div",{className:"group bg-black/30 border border-gray-800 hover:border-red-900/50 rounded-lg p-4 transition-all",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:B.name}),B.isDefault&&t.jsx("span",{className:"px-2 py-0.5 bg-blue-900/30 text-blue-400 text-xs rounded font-semibold",children:" Default"}),B.upgradesAllowed&&t.jsx("span",{className:"px-2 py-0.5 bg-green-900/30 text-green-400 text-xs rounded",children:"Upgrades Allowed"})]}),t.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-400",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Cutoff:"})," ",t.jsx("span",{className:"text-white",children:Nt(B)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Qualities:"})," ",t.jsxs("span",{className:"text-white",children:[B.items.filter(se=>se.allowed).length," enabled"]})]}),a&&t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Format Score:"})," ",t.jsxs("span",{className:"text-white",children:[B.minFormatScore," - ",B.cutoffFormatScore]})]})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[!B.isDefault&&t.jsx("button",{onClick:()=>xt(B.id),className:"px-3 py-1.5 text-sm bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors",title:"Set as Default",children:"Set Default"}),t.jsx("button",{onClick:()=>Ct(B),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",title:"Edit",children:t.jsx(an,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>we(B),className:"p-2 text-gray-400 hover:text-blue-400 hover:bg-blue-950/30 rounded transition-colors",title:"Clone Profile",children:t.jsx(IN,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>m(B.id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-950/30 rounded transition-colors",title:"Delete",children:t.jsx(cs,{className:"w-5 h-5"})})]})]}),t.jsx("div",{className:"mt-4 pt-4 border-t border-gray-800",children:t.jsx("div",{className:"grid grid-cols-3 gap-2",children:B.items.filter(se=>se.allowed).map(se=>t.jsxs("div",{className:"px-3 py-2 rounded text-sm bg-green-950/30 text-green-400 border border-green-900/50",children:[" ",se.name]},se.quality))})})]},B.id))})]}),t.jsxs("div",{className:"mb-8",children:[t.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Delay Profiles"}),t.jsx("p",{className:"text-gray-400 mb-6",children:"Delay profiles allow you to reduce the number of releases downloaded by adding a delay while Sportarr continues to watch for better releases"}),t.jsxs("div",{className:"mb-6 bg-gradient-to-br from-blue-950/30 to-blue-900/20 border border-blue-900/50 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"How Delay Profiles Work"}),t.jsxs("ul",{className:"text-sm text-gray-300 space-y-2",children:[t.jsx("li",{children:" Timer begins when Sportarr detects an event has a release available"}),t.jsx("li",{children:" During the delay period, any new releases are noted by Sportarr"}),t.jsx("li",{children:" When the delay timer expires, Sportarr downloads the single release which best matches your quality preferences"}),t.jsx("li",{children:" Timer starts from the releases uploaded time (not when Sportarr sees it)"}),t.jsx("li",{children:" Manual searches ignore delay profile settings"})]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Delay Profiles"}),t.jsxs("button",{onClick:gt,className:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[t.jsx(hr,{className:"w-4 h-4 mr-2"}),"Add Delay Profile"]})]}),le.length===0?t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-500 mb-4",children:"No delay profiles configured"})}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-gray-800",children:[t.jsx("th",{className:"text-left py-3 px-4 text-gray-400 font-medium w-12",children:"#"}),t.jsx("th",{className:"text-left py-3 px-4 text-gray-400 font-medium",children:"Protocol"}),t.jsx("th",{className:"text-left py-3 px-4 text-gray-400 font-medium",children:"Usenet Delay"}),t.jsx("th",{className:"text-left py-3 px-4 text-gray-400 font-medium",children:"Torrent Delay"}),t.jsx("th",{className:"text-left py-3 px-4 text-gray-400 font-medium",children:"Tags"}),t.jsx("th",{className:"text-right py-3 px-4 text-gray-400 font-medium",children:"Actions"})]})}),t.jsx("tbody",{children:le.map(B=>t.jsxs("tr",{className:"border-b border-gray-800 hover:bg-gray-900/50 transition-colors",children:[t.jsx("td",{className:"py-3 px-4 text-gray-400",children:t.jsx(tf,{className:"w-5 h-5"})}),t.jsx("td",{className:"py-3 px-4",children:t.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${B.preferredProtocol==="Usenet"?"bg-purple-900/30 text-purple-400":"bg-green-900/30 text-green-400"}`,children:B.preferredProtocol})}),t.jsxs("td",{className:"py-3 px-4 text-white",children:[B.usenetDelay," min"]}),t.jsxs("td",{className:"py-3 px-4 text-white",children:[B.torrentDelay," min"]}),t.jsx("td",{className:"py-3 px-4 text-gray-400",children:os(B.tags)}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[t.jsx("button",{onClick:()=>Ne(B),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",title:"Edit",children:t.jsx(an,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>G(B.id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-950/30 rounded transition-colors",title:"Delete",children:t.jsx(cs,{className:"w-5 h-5"})})]})})]},B.id))})]})})]})]}),t.jsxs("div",{className:"mb-8",children:[t.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Release Profiles"}),t.jsx("p",{className:"text-gray-400 mb-6",children:"Filter and score releases based on preferred or unwanted keywords using regex patterns"}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Release Profiles"}),t.jsxs("button",{onClick:M,className:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[t.jsx(hr,{className:"w-4 h-4 mr-2"}),"Add Release Profile"]})]}),Z.length===0?t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-500 mb-4",children:"No release profiles configured"})}):t.jsx("div",{className:"space-y-3",children:Z.map(B=>t.jsx("div",{className:"group bg-black/30 border border-gray-800 hover:border-red-900/50 rounded-lg p-4 transition-all",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:B.name}),B.enabled?t.jsx("span",{className:"px-2 py-0.5 bg-green-900/30 text-green-400 text-xs rounded",children:"Enabled"}):t.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-400 text-xs rounded",children:"Disabled"})]}),t.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-400",children:[B.required&&t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Required:"})," ",t.jsxs("span",{className:"text-green-400",children:[B.required.split(",").length," term(s)"]})]}),B.ignored&&t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Ignored:"})," ",t.jsxs("span",{className:"text-red-400",children:[B.ignored.split(",").length," term(s)"]})]}),B.preferred.length>0&&t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Preferred:"})," ",t.jsxs("span",{className:"text-purple-400",children:[B.preferred.length," term(s)"]})]})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>Yr(B),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",title:"Edit",children:t.jsx(an,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>ot(B.id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-950/30 rounded transition-colors",title:"Delete",children:t.jsx(cs,{className:"w-5 h-5"})})]})]})},B.id))})]})]}),d&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 overflow-y-auto",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-4xl w-full my-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-2xl font-bold text-white",children:o?`Edit ${o.name}`:"Add Quality Profile"}),t.jsx("button",{onClick:()=>f(!1),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"space-y-6 max-h-[70vh] overflow-y-auto pr-2",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Name *"}),t.jsx("input",{type:"text",value:ne.name||"",onChange:B=>ke(se=>({...se,name:B.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"4K Quality"})]}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:ne.upgradesAllowed||!1,onChange:B=>ke(se=>({...se,upgradesAllowed:B.target.checked})),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Upgrades Allowed (If disabled qualities will not be upgraded)"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:"Qualities"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Qualities higher in the list are more preferred. Qualities within the same group are equal. Only checked qualities are wanted."})]}),t.jsx("button",{onClick:()=>v(!b),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${b?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-700 hover:bg-gray-600 text-white"}`,children:b?"Done Editing Groups":"Edit Groups"})]}),t.jsx("div",{className:"bg-black/30 rounded-lg p-2 max-h-80 overflow-y-auto",children:(J=ne.items)==null?void 0:J.map((B,se)=>{var Ue;const fe=(w==null?void 0:w.index)===se&&(w==null?void 0:w.parentIndex)===void 0,he=(T==null?void 0:T.index)===se&&(T==null?void 0:T.parentIndex)===void 0&&(T==null?void 0:T.position)==="above",pe=(T==null?void 0:T.index)===se&&(T==null?void 0:T.parentIndex)===void 0&&(T==null?void 0:T.position)==="below";return t.jsxs("div",{className:"mb-1",children:[he&&t.jsx("div",{className:"h-1 bg-blue-500 rounded-full mx-2 mb-1 animate-pulse"}),t.jsxs("div",{"data-droppable":"true",draggable:b,onDragStart:Ge=>Se(Ge,se,Za(B)),onDragOver:Ge=>st(Ge,se,Za(B)),onDragLeave:wt,onDragEnd:yt,onDrop:Ge=>Mt(Ge,se,Za(B)),className:`flex items-center px-3 py-2 rounded transition-all ${B.allowed?"bg-green-950/30 border border-green-900/50":"bg-gray-900/50 border border-gray-800"} ${b?"cursor-grab hover:border-blue-500":""} ${fe?"opacity-50 border-dashed border-blue-500":""}`,children:[b&&t.jsx("div",{className:"mr-2 text-gray-500",children:t.jsx(tf,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>me(B.id,Za(B)),className:`w-5 h-5 mr-3 rounded border flex items-center justify-center transition-colors ${B.allowed?"bg-green-600 border-green-600 text-white":"bg-transparent border-gray-600 text-transparent hover:border-gray-500"}`,children:B.allowed&&t.jsx("span",{className:"text-xs",children:""})}),t.jsxs("div",{className:"flex-1 flex items-center flex-wrap gap-1",children:[t.jsx("span",{className:`text-sm ${B.allowed?"text-green-400":"text-gray-400"}`,children:B.name}),Za(B)&&B.items&&!b&&t.jsx("div",{className:"flex flex-wrap gap-1 ml-2",children:B.items.map(Ge=>t.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Ge.allowed?"bg-green-900/40 text-green-400 border border-green-800/50":"bg-gray-800/60 text-gray-500 border border-gray-700/50"}`,children:Ge.name},Ge.id??Ge.quality))})]}),b&&t.jsxs("div",{className:"flex items-center space-x-1",children:[t.jsx("button",{onClick:()=>De(se),disabled:se===0,className:"p-1 text-gray-500 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed",title:"Move up",children:t.jsx(Js,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>ue(se),disabled:se===(((Ue=ne.items)==null?void 0:Ue.length)??0)-1,className:"p-1 text-gray-500 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed",title:"Move down",children:t.jsx(As,{className:"w-4 h-4"})}),Za(B)?t.jsx("button",{onClick:()=>mt(se),className:"p-1 text-gray-500 hover:text-red-400",title:"Ungroup",children:t.jsx(IR,{className:"w-4 h-4"})}):t.jsx("button",{onClick:()=>Fe(se),className:"p-1 text-gray-500 hover:text-blue-400",title:"Create group",children:t.jsx(OR,{className:"w-4 h-4"})})]})]}),pe&&!Za(B)&&t.jsx("div",{className:"h-1 bg-blue-500 rounded-full mx-2 mt-1 animate-pulse"}),b&&Za(B)&&B.items&&t.jsx("div",{className:"ml-6 border-l border-gray-700",children:B.items.map((Ge,re)=>{const Le=(w==null?void 0:w.index)===re&&(w==null?void 0:w.parentIndex)===se,Je=(T==null?void 0:T.index)===re&&(T==null?void 0:T.parentIndex)===se&&(T==null?void 0:T.position)==="above",it=(T==null?void 0:T.index)===re&&(T==null?void 0:T.parentIndex)===se&&(T==null?void 0:T.position)==="below";return t.jsxs("div",{children:[Je&&t.jsx("div",{className:"h-1 bg-blue-500 rounded-full mx-2 mb-1 animate-pulse"}),t.jsxs("div",{"data-droppable":"true",draggable:b,onDragStart:Et=>Se(Et,re,!1,se),onDragOver:Et=>st(Et,re,!1,se),onDragLeave:wt,onDragEnd:yt,onDrop:Et=>Mt(Et,re,!1,se),className:`flex items-center px-3 py-2 ml-2 rounded transition-all ${Ge.allowed?"bg-green-950/30 border border-green-900/50":"bg-gray-900/50 border border-gray-800"} cursor-grab hover:border-blue-500 ${Le?"opacity-50 border-dashed border-blue-500":""}`,children:[t.jsx("div",{className:"mr-2 text-gray-500",children:t.jsx(tf,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>me(Ge.id,!1),className:`w-5 h-5 mr-3 rounded border flex items-center justify-center transition-colors ${Ge.allowed?"bg-green-600 border-green-600 text-white":"bg-transparent border-gray-600 text-transparent hover:border-gray-500"}`,children:Ge.allowed&&t.jsx("span",{className:"text-xs",children:""})}),t.jsx("span",{className:`flex-1 text-sm ${Ge.allowed?"text-green-400":"text-gray-400"}`,children:Ge.name})]}),it&&t.jsx("div",{className:"h-1 bg-blue-500 rounded-full mx-2 mt-1 animate-pulse"})]},Ge.id??Ge.quality)})}),pe&&Za(B)&&t.jsx("div",{className:"h-1 bg-blue-500 rounded-full mx-2 mt-1 animate-pulse"})]},B.id??B.quality)})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Upgrade Until"}),t.jsxs("select",{value:ne.cutoffQuality||"",onChange:B=>ke(se=>({...se,cutoffQuality:parseInt(B.target.value)||null})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"",children:"Select upgrade cutoff..."}),St(ne.items).map(B=>t.jsx("option",{value:B.id??B.quality,children:B.name},B.id??B.quality))]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Once this quality is reached Sportarr will no longer download episodes"})]}),t.jsxs("div",{className:"space-y-4 p-4 bg-purple-950/10 border border-purple-900/30 rounded-lg",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:"Custom Formats"}),t.jsx("p",{className:"text-sm text-gray-400",children:"Sportarr scores each release using the sum of scores for matching custom formats. If a new release would improve the score, at the same or better quality, then Sportarr will grab it."}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2 h-10 flex items-end",children:"Minimum Custom Format Score"}),t.jsx("input",{type:"number",value:ne.minFormatScore||0,onChange:B=>ke(se=>({...se,minFormatScore:parseInt(B.target.value)||0})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1 min-h-[2.5rem]",children:"Minimum custom format score allowed to download"})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2 h-10 flex items-end",children:"Upgrade Until Custom Format Score"}),t.jsx("input",{type:"number",value:ne.cutoffFormatScore||1e4,onChange:B=>ke(se=>({...se,cutoffFormatScore:parseInt(B.target.value)||1e4})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1 min-h-[2.5rem]",children:"Once this score is reached Sportarr will no longer grab releases"})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2 h-10 flex items-end",children:"Minimum Score Increment"}),t.jsx("input",{type:"number",value:ne.formatScoreIncrement||1,onChange:B=>ke(se=>({...se,formatScoreIncrement:parseInt(B.target.value)||1})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1 min-h-[2.5rem]",children:"Minimum improvement needed before considering it an upgrade"})]})]}),r.length>0?t.jsxs("div",{className:"mt-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("h5",{className:"text-md font-semibold text-white",children:"Custom Format Scoring"}),(o==null?void 0:o.id)&&t.jsxs("button",{onClick:()=>z(!0),className:"flex items-center gap-1.5 px-3 py-1 bg-purple-600 hover:bg-purple-700 text-white text-sm rounded-lg transition-colors",title:"Apply recommended scores from TRaSH Guides",children:[t.jsx(tl,{className:"w-4 h-4"}),"Apply TRaSH Scores"]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"text-sm text-gray-400",children:"Sort by:"}),t.jsxs("select",{value:E,onChange:B=>R(B.target.value),className:"px-3 py-1 bg-gray-800 border border-gray-700 rounded text-sm text-white focus:outline-none focus:border-purple-600",children:[t.jsx("option",{value:"alphabetical",children:"Name (A-Z)"}),t.jsx("option",{value:"score",children:"Score"})]})]})]}),t.jsx("div",{className:"max-h-[32rem] overflow-y-auto space-y-2 p-3 bg-black/30 rounded-lg",children:(de=ne.formatItems)==null?void 0:de.slice().sort((B,se)=>E==="alphabetical"?(B.formatName||"").localeCompare(se.formatName||""):se.score!==B.score?se.score-B.score:(B.formatName||"").localeCompare(se.formatName||"")).map(B=>t.jsxs("div",{className:`flex items-center justify-between p-2 rounded hover:bg-gray-800 transition-colors ${B.isSynced?"bg-purple-900/20 border-l-2 border-purple-500":"bg-gray-800/50"}`,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-white font-medium",children:B.formatName}),B.isSynced&&t.jsx("span",{className:"text-[10px] bg-purple-600/50 text-purple-300 px-1.5 py-0.5 rounded",title:"Synced from TRaSH Guides",children:"TRaSH"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[B.isSynced&&B.trashDefaultScore!==null&&B.trashDefaultScore!==void 0&&t.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${B.score===B.trashDefaultScore?"bg-green-900/30 text-green-400":"bg-yellow-900/30 text-yellow-400"}`,title:B.score===B.trashDefaultScore?"Using TRaSH recommended score":`TRaSH recommends: ${B.trashDefaultScore>0?"+":""}${B.trashDefaultScore}`,children:B.score===B.trashDefaultScore?"REC":`${B.trashDefaultScore>0?"+":""}${B.trashDefaultScore}`}),t.jsx("input",{type:"number",value:B.score,onChange:se=>Ke(B.formatId,parseInt(se.target.value)||0),className:"w-24 px-3 py-1 bg-gray-900 border border-gray-700 rounded text-white text-center focus:outline-none focus:border-purple-600",placeholder:"0"}),t.jsxs("span",{className:`text-xs px-2 py-1 rounded min-w-[60px] text-center ${B.score>0?"bg-green-900/30 text-green-400":B.score<0?"bg-red-900/30 text-red-400":"bg-gray-700 text-gray-400"}`,children:[B.score>0?"+":"",B.score]})]})]},B.formatId))})]}):t.jsxs("div",{className:"p-6 bg-black/30 rounded-lg text-center",children:[t.jsx("p",{className:"text-gray-500 mb-2",children:"No custom formats configured"}),t.jsx("p",{className:"text-sm text-gray-400",children:"Create custom formats in Settings  Custom Formats to enable scoring"})]})]})]}),t.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-800 flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:bt,disabled:!ne.name,className:"px-4 py-2 bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:"Save"})]})]})}),u!==null&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-md w-full",children:[t.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Delete Profile?"}),t.jsx("p",{className:"text-gray-400 mb-6",children:"Are you sure you want to delete this quality profile? This action cannot be undone."}),t.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>m(null),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>ve(u),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Delete"})]})]})}),ee&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-2xl w-full",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-2xl font-bold text-white",children:ae?"Edit Delay Profile":"Add Delay Profile"}),t.jsx("button",{onClick:()=>{W(!1),ce(null)},className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Preferred Protocol"}),t.jsxs("select",{value:Be.preferredProtocol,onChange:B=>qe({...Be,preferredProtocol:B.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"Usenet",children:"Usenet"}),t.jsx("option",{value:"Torrent",children:"Torrent"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Usenet Delay (minutes)"}),t.jsx("input",{type:"number",min:"0",value:Be.usenetDelay,onChange:B=>qe({...Be,usenetDelay:parseInt(B.target.value)||0}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Torrent Delay (minutes)"}),t.jsx("input",{type:"number",min:"0",value:Be.torrentDelay,onChange:B=>qe({...Be,torrentDelay:parseInt(B.target.value)||0}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"})]}),t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:Be.bypassIfHighestQuality,onChange:B=>qe({...Be,bypassIfHighestQuality:B.target.checked}),className:"mt-1 w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Bypass if Highest Quality"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Bypass delay when release has the highest enabled quality profile with the preferred protocol"})]})]}),a&&t.jsxs(t.Fragment,{children:[t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:Be.bypassIfAboveCustomFormatScore,onChange:B=>qe({...Be,bypassIfAboveCustomFormatScore:B.target.checked}),className:"mt-1 w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Bypass if Above Custom Format Score"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Bypass delay when custom format score is above minimum"})]})]}),Be.bypassIfAboveCustomFormatScore&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Minimum Custom Format Score"}),t.jsx("input",{type:"number",value:Be.minimumCustomFormatScore,onChange:B=>qe({...Be,minimumCustomFormatScore:parseInt(B.target.value)||0}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tags (Leave empty for default profile)"}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[X.map(B=>t.jsx("button",{onClick:()=>vt(B.id),className:`px-3 py-1 rounded text-sm transition-colors ${Be.tags.includes(B.id)?"bg-red-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"}`,children:B.label},B.id)),X.length===0&&t.jsx("p",{className:"text-sm text-gray-500",children:"No tags available. Create tags in the Tags settings."})]})]})]}),t.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-800 flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>{W(!1),ce(null)},className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:Kt,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Save"})]})]})}),V!==null&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-md w-full",children:[t.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Delete Delay Profile?"}),t.jsx("p",{className:"text-gray-400 mb-6",children:"Are you sure you want to delete this delay profile? This action cannot be undone."}),t.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>G(null),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>ws(V),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Delete"})]})]})}),Pe&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 overflow-y-auto",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-4xl w-full my-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-2xl font-bold text-white",children:xe?"Edit Release Profile":"Add Release Profile"}),t.jsx("button",{onClick:()=>{Re(!1),Ee(null)},className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"space-y-6 max-h-[70vh] overflow-y-auto pr-2",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Name *"}),t.jsx("input",{type:"text",value:dt.name,onChange:B=>He({...dt,name:B.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"HD Releases"})]}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:dt.enabled,onChange:B=>He({...dt,enabled:B.target.checked}),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Enable this release profile"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Required Keywords"}),t.jsx("textarea",{value:dt.required,onChange:B=>He({...dt,required:B.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600 font-mono text-sm",placeholder:"1080p, BluRay",rows:3}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Comma-separated regex patterns. Release must contain at least one of these terms."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ignored Keywords"}),t.jsx("textarea",{value:dt.ignored,onChange:B=>He({...dt,ignored:B.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600 font-mono text-sm",placeholder:"HDCAM, CAM",rows:3}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Comma-separated regex patterns. Release will be rejected if it contains any of these terms."})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Preferred Keywords (with scores)"}),t.jsx("button",{onClick:P,className:"px-3 py-1 bg-purple-600 hover:bg-purple-700 text-white text-sm rounded transition-colors",children:"Add Preferred"})]}),dt.preferred.length===0?t.jsx("div",{className:"p-4 bg-black/30 rounded-lg text-center text-gray-500 text-sm",children:'No preferred keywords. Click "Add Preferred" to add scoring rules.'}):t.jsx("div",{className:"space-y-2",children:dt.preferred.map((B,se)=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"text",value:B.key,onChange:fe=>L(se,"key",fe.target.value),className:"flex-1 px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-purple-600 font-mono text-sm",placeholder:"REPACK|PROPER"}),t.jsx("input",{type:"number",value:B.value,onChange:fe=>L(se,"value",parseInt(fe.target.value)||0),className:"w-24 px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-purple-600 text-center",placeholder:"Score"}),t.jsx("button",{onClick:()=>$(se),className:"p-2 text-red-400 hover:text-red-300 hover:bg-red-950/30 rounded transition-colors",children:t.jsx(cs,{className:"w-5 h-5"})})]},se))}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Add score (positive or negative) to releases matching these regex patterns."})]}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:dt.includePreferredWhenRenaming,onChange:B=>He({...dt,includePreferredWhenRenaming:B.target.checked}),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Include preferred when renaming"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tags (Leave empty to apply to all)"}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[X.map(B=>t.jsx("button",{onClick:()=>j(B.id),className:`px-3 py-1 rounded text-sm transition-colors ${dt.tags.includes(B.id)?"bg-red-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"}`,children:B.label},B.id)),X.length===0&&t.jsx("p",{className:"text-sm text-gray-500",children:"No tags available. Create tags in the Tags settings."})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Indexers (Leave empty to apply to all)"}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[ye.map(B=>t.jsx("button",{onClick:()=>_(B.id),className:`px-3 py-1 rounded text-sm transition-colors ${dt.indexerId.includes(B.id)?"bg-blue-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"}`,children:B.name},B.id)),ye.length===0&&t.jsx("p",{className:"text-sm text-gray-500",children:"No indexers configured. Add indexers in the Indexers settings."})]})]})]}),t.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-800 flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>{Re(!1),Ee(null)},className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:xs,disabled:!dt.name,className:"px-4 py-2 bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:"Save"})]})]})}),Qe!==null&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-md w-full",children:[t.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Delete Release Profile?"}),t.jsx("p",{className:"text-gray-400 mb-6",children:"Are you sure you want to delete this release profile? This action cannot be undone."}),t.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>ot(null),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>hs(Qe),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Delete"})]})]})}),K&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-purple-900/50 rounded-lg p-6 max-w-md w-full",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx(tl,{className:"w-8 h-8 text-purple-500"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold text-white",children:"Apply TRaSH Scores"}),t.jsx("p",{className:"text-sm text-gray-400",children:"Set recommended scores from TRaSH Guides for all synced custom formats"})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Score Set"}),t.jsx("select",{value:U,onChange:B=>I(B.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-purple-600",children:Object.entries(D).map(([B,se])=>t.jsx("option",{value:B,children:se},B))}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Different score sets are optimized for different language preferences"})]}),t.jsx("div",{className:"bg-yellow-900/20 border border-yellow-800/50 rounded-lg p-3",children:t.jsx("p",{className:"text-sm text-yellow-200",children:"This will update scores for all TRaSH-synced custom formats in this profile. Custom formats you've manually added will not be affected."})})]}),t.jsxs("div",{className:"mt-6 flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>z(!1),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:Oe,disabled:F,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 text-white rounded-lg transition-colors",children:F?t.jsxs(t.Fragment,{children:[t.jsx(Dt,{className:"w-4 h-4 animate-spin"}),"Applying..."]}):t.jsxs(t.Fragment,{children:[t.jsx(tl,{className:"w-4 h-4"}),"Apply Scores"]})})]})]})})]})}function BI({showAdvanced:a=!1}){const[e,s]=y.useState([]),[r,n]=y.useState(!0),[o,c]=y.useState(!1),[d,f]=y.useState(!1),u=y.useRef(null);cl(d);const[m,g]=y.useState(!1),[x,b]=y.useState(null),[v,w]=y.useState(!1);y.useEffect(()=>{S()},[]);const S=async()=>{try{const R=await kt("/api/qualitydefinition");if(R.ok){const K=await R.json();s(K),u.current=K,f(!1)}}catch(R){console.error("Failed to load quality definitions:",R)}finally{n(!1)}};y.useEffect(()=>{if(!u.current)return;const R=JSON.stringify(e)!==JSON.stringify(u.current);f(R)},[e]);const T=(R,K,z)=>{s(D=>D.map(O=>O.id===R?{...O,[K]:z}:O))},k=async()=>{c(!0);try{(await br("/api/qualitydefinition/bulk",e)).ok&&(await S(),u.current=e,f(!1))}catch(R){console.error("Failed to save quality definitions:",R)}finally{c(!1)}},E=async()=>{g(!0),b(null);try{const K=await(await ds("/api/qualitydefinition/trash/import",{})).json();b(K),w(!0),K.success&&await S()}catch(R){console.error("Failed to import from TRaSH:",R),b({success:!1,error:"Failed to connect to server",created:0,updated:0,syncedFormats:[]}),w(!0)}finally{g(!1)}};return r?t.jsx("div",{className:"max-w-6xl mx-auto text-center py-12",children:t.jsx("div",{className:"text-gray-400",children:"Loading quality definitions..."})}):t.jsxs("div",{children:[t.jsx(Rn,{title:"Quality Definitions",subtitle:"Quality settings control file size limits for each quality level",onSave:k,isSaving:o,hasUnsavedChanges:d,saveButtonText:"Save Changes"}),t.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[t.jsx("div",{className:"mb-8 bg-blue-950/30 border border-blue-900/50 rounded-lg p-6",children:t.jsxs("div",{className:"flex items-start",children:[t.jsx(Or,{className:"w-6 h-6 text-blue-400 mr-3 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"About Quality Definitions"}),t.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"Min Size:"})," Minimum file size in MB per minute. Files smaller will be rejected. Example: 15 MB/min  180 min = 2.7 GB minimum for a 3-hour event."]})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"Max Size:"})," Maximum file size in MB per minute. Files larger will be rejected. Set high (e.g., 1000) for effectively unlimited."]})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"Preferred Size:"})," Target size for tiebreaking. When releases have equal scores, Sportarr prefers files closer to this size (rounded to 200MB chunks like Sonarr)."]})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:""}),t.jsx("span",{children:"Sports events typically run 2-4 hours (120-240 min). Values match Sonarr/Radarr quality definitions from TRaSH Guides."})]})]})]})]})}),t.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[t.jsx("p",{className:"text-sm text-gray-400",children:"Sizes are in MB per minute of runtime. Adjust based on your preferences and storage capacity."}),t.jsx("button",{onClick:E,disabled:m,className:"px-4 py-2 bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 disabled:from-purple-800 disabled:to-purple-900 disabled:opacity-50 text-white font-medium rounded-lg transition-all inline-flex items-center",children:m?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Importing..."]}):t.jsxs(t.Fragment,{children:[t.jsx(qs,{className:"w-4 h-4 mr-2"}),"Import from TRaSH Guides"]})})]}),t.jsx("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"bg-black/50 border-b border-red-900/30",children:[t.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white",children:"Quality"}),t.jsxs("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white",children:["Min Size",t.jsx("span",{className:"block text-xs text-gray-400 font-normal",children:"(MB/min)"})]}),t.jsxs("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white",children:["Preferred",t.jsx("span",{className:"block text-xs text-gray-400 font-normal",children:"(MB/min)"})]}),t.jsxs("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white",children:["Max Size",t.jsx("span",{className:"block text-xs text-gray-400 font-normal",children:"(MB/min)"})]}),t.jsxs("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white",children:["Range",t.jsx("span",{className:"block text-xs text-gray-400 font-normal",children:"(3hr/180min event)"})]})]})}),t.jsx("tbody",{className:"divide-y divide-gray-800",children:e.length===0?t.jsx("tr",{children:t.jsxs("td",{colSpan:5,className:"px-6 py-12 text-center",children:[t.jsx("p",{className:"text-gray-500 mb-2",children:"No quality definitions found"}),t.jsx("p",{className:"text-sm text-gray-400",children:"Quality definitions should be seeded automatically. Try restarting the application."})]})}):e.map((R,K)=>t.jsxs("tr",{className:K%2===0?"bg-black/20":"bg-black/10",children:[t.jsx("td",{className:"px-6 py-4",children:t.jsx("span",{className:"text-white font-medium",children:R.title})}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("input",{type:"number",value:R.minSize,onChange:z=>T(R.id,"minSize",Number(z.target.value)),className:"w-24 px-3 py-2 bg-gray-800 border border-gray-700 rounded text-white text-sm focus:outline-none focus:border-red-600",step:"0.5",min:"0"})}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("input",{type:"number",value:R.preferredSize,onChange:z=>T(R.id,"preferredSize",Number(z.target.value)),className:"w-24 px-3 py-2 bg-gray-800 border border-gray-700 rounded text-white text-sm focus:outline-none focus:border-red-600",step:"0.5",min:"0"})}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("input",{type:"number",value:R.maxSize??"",onChange:z=>T(R.id,"maxSize",Number(z.target.value)),className:"w-24 px-3 py-2 bg-gray-800 border border-gray-700 rounded text-white text-sm focus:outline-none focus:border-red-600",step:"0.5",min:"0"})}),t.jsx("td",{className:"px-6 py-4",children:t.jsxs("span",{className:"text-gray-400 text-sm",children:[(R.minSize*180/1024).toFixed(1)," -"," ",R.maxSize?(R.maxSize*180/1024).toFixed(1):""," GB"]})})]},R.id))})]})})}),a&&t.jsx("div",{className:"mt-6 p-4 bg-yellow-950/30 border border-yellow-900/50 rounded-lg",children:t.jsxs("p",{className:"text-sm text-yellow-300",children:[t.jsx("strong",{children:"Advanced:"})," These values affect all quality profiles. Changes here impact which releases are accepted across your entire library. Be careful when adjusting these settings."]})})]}),v&&x&&t.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg w-full max-w-md mx-4 shadow-xl",children:[t.jsx("div",{className:"p-6",children:x.success?t.jsxs("div",{className:"flex items-start",children:[t.jsx(rs,{className:"w-8 h-8 text-green-400 mr-4 flex-shrink-0"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Import Successful"}),t.jsxs("p",{className:"text-gray-300",children:["Updated ",x.updated," quality definitions",x.created>0&&`, created ${x.created} new`]}),t.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Quality sizes have been set to TRaSH Guides recommended values."})]})]}):t.jsxs("div",{className:"flex items-start",children:[t.jsx(Ss,{className:"w-8 h-8 text-red-400 mr-4 flex-shrink-0"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Import Failed"}),t.jsx("p",{className:"text-gray-300",children:x.error})]})]})}),t.jsx("div",{className:"p-4 border-t border-gray-700 flex justify-end",children:t.jsx("button",{onClick:()=>w(!1),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Close"})})]})})]})}const UI=[{value:"ReleaseTitle",label:"Release Title",hasPresets:!0},{value:"Language",label:"Language",hasPresets:!0},{value:"IndexerFlag",label:"Indexer Flag",hasPresets:!1},{value:"Source",label:"Source",hasPresets:!0},{value:"Resolution",label:"Resolution",hasPresets:!0},{value:"Size",label:"Size",hasPresets:!1},{value:"ReleaseGroup",label:"Release Group",hasPresets:!0},{value:"ReleaseType",label:"Release Type",hasPresets:!1}],qS=["BluRay","WEB-DL","WEBDL","WEBRip","HDTV","DVDRip","CAM","TELESYNC"],KS=["2160p","1080p","720p","480p","4K","UHD","HD","SD"],YS=["English","Spanish","French","Japanese","Portuguese"];function $I({showAdvanced:a=!1}){const[e,s]=y.useState([]),[r,n]=y.useState(!0),[o,c]=y.useState(""),[d,f]=y.useState(!1),[u,m]=y.useState(!1),[g,x]=y.useState(null),[b,v]=y.useState(null),[w,S]=y.useState(!1),[T,k]=y.useState({id:0,name:"",includeCustomFormatWhenRenaming:!1,specifications:[]}),[E,R]=y.useState({name:"",implementation:"ReleaseTitle",negate:!1,required:!1,fields:{value:""}});y.useEffect(()=>{K()},[]);const K=async()=>{try{const H=await kt("/api/customformat");if(H.ok){const X=await H.json();s(X)}}catch(H){console.error("Error loading custom formats:",H)}finally{n(!1)}},z=async()=>{if(!T.name.trim()){be.error("Validation Error",{description:"Please enter a format name"});return}try{const H=g?`/api/customformat/${g.id}`:"/api/customformat";(g?await br(H,T):await ds(H,T)).ok?(await K(),be.success(g?"Format Updated":"Format Created",{description:`Custom format "${T.name}" has been ${g?"updated":"created"} successfully.`}),m(!1),x(null),k({id:0,name:"",includeCustomFormatWhenRenaming:!1,specifications:[]})):be.error("Save Failed",{description:"Failed to save custom format. Please try again."})}catch(H){console.error("Error saving custom format:",H),be.error("Save Failed",{description:H instanceof Error?H.message:"An unexpected error occurred."})}},D=async H=>{try{(await Na(`/api/customformat/${H}`)).ok?(await K(),be.success("Format Deleted",{description:"Custom format has been deleted successfully."}),v(null)):be.error("Delete Failed",{description:"Failed to delete custom format. Please try again."})}catch(X){console.error("Error deleting custom format:",X),be.error("Delete Failed",{description:X instanceof Error?X.message:"An unexpected error occurred."})}},O=H=>{const X=JSON.stringify(H,null,2),q=new Blob([X],{type:"application/json"}),ae=URL.createObjectURL(q),ce=document.createElement("a");ce.href=ae,ce.download=`${H.name.replace(/\s+/g,"_")}.json`,document.body.appendChild(ce),ce.click(),document.body.removeChild(ce),URL.revokeObjectURL(ae)},U=async()=>{try{const H=JSON.parse(o);if(!H.name){be.error("Invalid Format",{description:'JSON must include a "name" field.'});return}if(u){const ae=(H.specifications||[]).map(ce=>({...ce,fields:Array.isArray(ce.fields)?ce.fields.reduce((ee,W)=>(W.name&&W.value!==void 0&&(ee[W.name]=W.value),ee),{}):ce.fields||{value:""}}));k({id:T.id,name:H.name,includeCustomFormatWhenRenaming:H.includeCustomFormatWhenRenaming||!1,specifications:ae}),be.success("Format Imported",{description:"Format data loaded successfully. Review and save to apply."}),f(!1),c("");return}const X=JSON.parse(o),q=await ds("/api/customformat/import",X);if(q.ok){const ae=await q.json();await K();const ce=ae.defaultScore?` (default score: ${ae.defaultScore})`:"";be.success("Format Imported",{description:`Custom format "${H.name}" imported with ${ae.specifications} specifications${ce}.`}),f(!1),c("")}else if(q.status===409){const ae=await q.json();be.error("Import Failed",{description:ae.error||"A custom format with this name already exists."})}else{const ae=await q.json();be.error("Import Failed",{description:ae.error||"Failed to import custom format. Please try again."})}}catch(H){console.error("Error parsing JSON:",H),be.error("Invalid JSON",{description:"The JSON format is invalid. Please check and try again."})}},I=()=>{if(!E.name.trim()){be.error("Validation Error",{description:"Please enter a condition name"});return}if(E.implementation!=="Size"&&!E.fields.value){be.error("Validation Error",{description:"Please enter a value for this condition"});return}k(H=>({...H,specifications:[...H.specifications,{...E}]})),R({name:"",implementation:"ReleaseTitle",negate:!1,required:!1,fields:{value:""}}),S(!1)},F=H=>{k(X=>({...X,specifications:X.specifications.filter((q,ae)=>ae!==H)}))},te=H=>{x(H),k({...H}),m(!0)},le=()=>{x(null),k({id:0,name:"",includeCustomFormatWhenRenaming:!1,specifications:[]}),m(!0)};return r?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"text-white",children:"Loading custom formats..."})}):t.jsxs("div",{className:"max-w-6xl mx-auto",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Custom Formats"}),t.jsx("p",{className:"text-gray-400",children:"Custom Formats allow fine control over release scoring and prioritization"})]}),t.jsx("div",{className:"mb-8 bg-gradient-to-br from-purple-950/30 to-purple-900/20 border border-purple-900/50 rounded-lg p-6",children:t.jsxs("div",{className:"flex items-start",children:[t.jsx(_p,{className:"w-6 h-6 text-purple-400 mr-3 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Sportarr supports custom conditions against the release properties below."}),t.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"Use regex patterns to match specific release characteristics and score them accordingly."}),t.jsx("div",{className:"flex items-center space-x-3",children:t.jsxs("button",{onClick:()=>f(!0),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white text-sm font-medium rounded-lg transition-colors",children:[t.jsx(_p,{className:"w-4 h-4 inline mr-2"}),"Import"]})})]})]})}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Custom Formats"}),t.jsxs("button",{onClick:le,className:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[t.jsx(hr,{className:"w-4 h-4 mr-2"}),"Add Custom Format"]})]}),e.length===0?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("p",{className:"text-gray-500 mb-4",children:"No custom formats configured"}),t.jsx("p",{className:"text-sm text-gray-400",children:"Add custom formats to score and prioritize releases based on specific criteria"})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-gray-800",children:[t.jsx("th",{className:"text-left py-3 px-4 text-gray-400 font-medium",children:"Name"}),t.jsx("th",{className:"text-left py-3 px-4 text-gray-400 font-medium",children:"Conditions"}),t.jsx("th",{className:"text-right py-3 px-4 text-gray-400 font-medium",children:"Actions"})]})}),t.jsx("tbody",{children:[...e].sort((H,X)=>(H.name||"").localeCompare(X.name||"")).map(H=>t.jsxs("tr",{className:"border-b border-gray-800 hover:bg-gray-900/50 transition-colors",children:[t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-white font-medium",children:H.name}),H.includeCustomFormatWhenRenaming&&t.jsx("span",{className:"text-xs text-green-400 mt-1",children:"Included in renaming"})]})}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("span",{className:"text-gray-400",children:[H.specifications.length," condition(s)"]})}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[t.jsx("button",{onClick:()=>O(H),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",title:"Export to JSON",children:t.jsx(li,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>te(H),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",title:"Edit",children:t.jsx(an,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>v(H.id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-950/30 rounded transition-colors",title:"Delete",children:t.jsx(cs,{className:"w-5 h-5"})})]})})]},H.id))})]})})]}),b!==null&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-md w-full",children:[t.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Delete Custom Format?"}),t.jsx("p",{className:"text-gray-400 mb-6",children:"Are you sure you want to delete this custom format? This action cannot be undone."}),t.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>v(null),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>D(b),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Delete"})]})]})}),u&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 overflow-y-auto",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-4xl w-full my-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-2xl font-bold text-white",children:g?"Edit Custom Format":"Add Custom Format"}),t.jsx("button",{onClick:()=>{m(!1),x(null)},className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Name"}),t.jsx("input",{type:"text",value:T.name,onChange:H=>k({...T,name:H.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"e.g., Preferred Source, Better Audio, etc."})]}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:T.includeCustomFormatWhenRenaming,onChange:H=>k({...T,includeCustomFormatWhenRenaming:H.target.checked}),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("span",{className:"text-sm font-medium text-gray-300",children:["Include in ","{"," Custom Formats","}"," renaming format"]})]}),t.jsxs("div",{className:"border-t border-gray-800 pt-6",children:[t.jsx("h4",{className:"text-lg font-semibold text-white mb-4",children:"Conditions"}),t.jsx("div",{className:"p-4 bg-blue-950/30 border border-blue-900/50 rounded-lg mb-4",children:t.jsx("p",{className:"text-sm text-blue-300",children:"A Custom Format will be applied to a release or file when it matches at least one of each of the different condition types chosen."})}),T.specifications.length===0?t.jsx("div",{className:"flex items-center justify-center",children:t.jsx("button",{onClick:()=>S(!0),className:"p-12 bg-gray-800/50 hover:bg-gray-800 border-2 border-gray-700 hover:border-gray-600 rounded-lg transition-all",title:"Add Condition",children:t.jsx(hr,{className:"w-16 h-16 text-gray-500"})})}):t.jsxs("div",{className:"space-y-2",children:[T.specifications.map((H,X)=>t.jsxs("div",{className:"p-3 bg-gray-800 rounded border border-gray-700 flex items-center justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[t.jsx("span",{className:"text-white font-medium",children:H.name}),H.required&&t.jsx("span",{className:"px-2 py-0.5 bg-red-900/30 text-red-400 text-xs rounded",children:"Required"}),H.negate&&t.jsx("span",{className:"px-2 py-0.5 bg-yellow-900/30 text-yellow-400 text-xs rounded",children:"Negated"})]}),t.jsxs("div",{className:"text-sm text-gray-400",children:[H.implementation,H.fields.value&&t.jsx("code",{className:"ml-2 px-2 py-0.5 bg-black text-green-400 rounded text-xs font-mono",children:typeof H.fields.value=="string"?H.fields.value:JSON.stringify(H.fields.value)}),H.fields.min!==void 0&&t.jsxs("span",{className:"ml-2 text-xs",children:["Min: ",H.fields.min,"MB ",H.fields.max!==void 0&&`Max: ${H.fields.max}MB`]})]})]}),t.jsx("button",{onClick:()=>F(X),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-950/30 rounded transition-colors",children:t.jsx(cs,{className:"w-4 h-4"})})]},X)),t.jsxs("button",{onClick:()=>S(!0),className:"w-full p-4 bg-gray-800/30 hover:bg-gray-800/50 border-2 border-dashed border-gray-700 hover:border-gray-600 rounded-lg transition-all flex items-center justify-center",children:[t.jsx(hr,{className:"w-5 h-5 text-gray-500 mr-2"}),t.jsx("span",{className:"text-gray-400",children:"Add Condition"})]})]})]})]}),t.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-800 flex items-center justify-between",children:[t.jsx("button",{onClick:()=>f(!0),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Import"}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("button",{onClick:()=>{m(!1),x(null)},className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:z,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Save"})]})]})]})}),d&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[60] flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-purple-900/50 rounded-lg p-6 max-w-2xl w-full",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-2xl font-bold text-white",children:"Import Custom Format from JSON"}),t.jsx("button",{onClick:()=>{f(!1),c("")},className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsx("p",{className:"text-gray-400 mb-4",children:"Paste JSON from TRaSH Guides, Sonarr/Radarr export, or another Sportarr instance"}),t.jsx("textarea",{value:o,onChange:H=>c(H.target.value),placeholder:'{"name":"Format Name","includeCustomFormatWhenRenaming":false,"specifications":[...]}',className:"w-full h-64 px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white font-mono text-sm focus:outline-none focus:border-purple-600 resize-none"}),t.jsxs("div",{className:"mt-6 flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>{f(!1),c("")},className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:U,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:"Import"})]})]})}),w&&t.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-[60] flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-blue-900/50 rounded-lg p-6 max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-2xl font-bold text-white",children:"Add Condition"}),t.jsx("button",{onClick:()=>S(!1),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsx("div",{className:"p-4 bg-blue-950/30 border border-blue-900/50 rounded-lg mb-6",children:t.jsxs("p",{className:"text-sm text-blue-300",children:["Sportarr supports custom conditions against the release properties below.",t.jsx("br",{}),"Use regex patterns to match specific release characteristics and score them accordingly."]})}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:UI.map(H=>t.jsxs("button",{onClick:()=>R({...E,implementation:H.value,fields:{value:""}}),className:`p-4 rounded-lg border-2 transition-all ${E.implementation===H.value?"border-red-600 bg-red-900/20":"border-gray-700 bg-gray-800 hover:border-gray-600"}`,children:[t.jsx("div",{className:"text-white font-medium text-left",children:H.label}),H.hasPresets&&t.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Custom | Presets"}),!H.hasPresets&&E.implementation===H.value&&t.jsx("div",{className:"text-xs text-blue-400 mt-1",children:"More Info"})]},H.value))}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Condition Name"}),t.jsx("input",{type:"text",value:E.name,onChange:H=>R({...E,name:H.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-600",placeholder:"e.g., 1080p, WEB-DL, etc."})]}),E.implementation==="Size"?t.jsx(t.Fragment,{children:t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Min Size (MB)"}),t.jsx("input",{type:"number",value:E.fields.min||"",onChange:H=>R({...E,fields:{...E.fields,min:parseFloat(H.target.value)||0}}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-600",placeholder:"0"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Max Size (MB)"}),t.jsx("input",{type:"number",value:E.fields.max||"",onChange:H=>R({...E,fields:{...E.fields,max:parseFloat(H.target.value)||0}}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-600",placeholder:"Unlimited"})]})]})}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:E.implementation==="ReleaseTitle"||E.implementation==="ReleaseGroup"?"Regular Expression":"Value"}),t.jsx("input",{type:"text",value:E.fields.value||"",onChange:H=>R({...E,fields:{value:H.target.value}}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white font-mono text-sm focus:outline-none focus:border-blue-600",placeholder:E.implementation==="ReleaseTitle"?"e.g., \\b(1080p|FHD)\\b":E.implementation==="Source"?"e.g., BluRay, WEB-DL, HDTV":E.implementation==="Resolution"?"e.g., 1080p, 720p, 2160p":"Enter value"})]}),E.implementation==="Source"&&qS.length>0&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Presets"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:qS.map(H=>t.jsx("button",{onClick:()=>R({...E,fields:{value:H}}),className:"px-3 py-1 bg-gray-700 hover:bg-gray-600 text-white text-sm rounded transition-colors",children:H},H))})]}),E.implementation==="Resolution"&&KS.length>0&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Presets"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:KS.map(H=>t.jsx("button",{onClick:()=>R({...E,fields:{value:H}}),className:"px-3 py-1 bg-gray-700 hover:bg-gray-600 text-white text-sm rounded transition-colors",children:H},H))})]}),E.implementation==="Language"&&YS.length>0&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Presets"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:YS.map(H=>t.jsx("button",{onClick:()=>R({...E,fields:{value:H}}),className:"px-3 py-1 bg-gray-700 hover:bg-gray-600 text-white text-sm rounded transition-colors",children:H},H))})]})]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:E.negate,onChange:H=>R({...E,negate:H.target.checked}),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-yellow-600 focus:ring-yellow-600"}),t.jsx("span",{className:"text-sm text-gray-300",children:"Negate (must NOT match)"})]}),t.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:E.required,onChange:H=>R({...E,required:H.target.checked}),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm text-gray-300",children:"Required"})]})]})]}),t.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-800 flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>S(!1),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Close"}),t.jsx("button",{onClick:I,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"Add Condition"})]})]})})]})}function GI(){const[a,e]=y.useState(null),[s,r]=y.useState([]),[n,o]=y.useState({}),[c,d]=y.useState(!0),[f,u]=y.useState(!1),[m,g]=y.useState(new Set),[x,b]=y.useState(new Set(["Recommended"])),[v,w]=y.useState(null),[S,T]=y.useState(!1),[k,E]=y.useState(null),[R,K]=y.useState(!1),[z,D]=y.useState(!1),[O,U]=y.useState({enableAutoSync:!1,autoSyncIntervalHours:24,lastAutoSync:null,autoSyncSportRelevantOnly:!0,autoApplyScoresToProfiles:!1,autoApplyScoreSet:"default"}),[I,F]=y.useState(!1),[te,le]=y.useState(!1),[H,X]=y.useState([]),[q,ae]=y.useState(!1),[ce,ee]=y.useState(!1),[W,V]=y.useState(new Set),[G,Z]=y.useState(new Set),[oe,ye]=y.useState(!1),[je,xe]=y.useState(!1),[Ee,Pe]=y.useState(new Set);y.useEffect(()=>{Re()},[]);const Re=async()=>{d(!0);try{const[ve,xt,me,De]=await Promise.all([kt("/api/trash/status"),kt("/api/trash/customformats?sportRelevantOnly=false"),kt("/api/trash/scoresets"),kt("/api/trash/settings")]);if(ve.ok&&e(await ve.json()),xt.ok&&r(await xt.json()),me.ok&&o(await me.json()),De.ok){const ue=await De.json();U(ue)}}catch(ve){console.error("Error loading TRaSH data:",ve),be.error("Failed to load TRaSH Guides data")}finally{d(!1)}},Qe=async()=>{u(!0);try{const xt=await(await ds("/api/trash/sync",{})).json();w(xt),xt.success?(be.success("TRaSH Guides Sync Complete",{description:`Created: ${xt.created}, Updated: ${xt.updated}, Skipped: ${xt.skipped}`}),await Re()):be.error("Sync Failed",{description:xt.error||"Unknown error occurred"})}catch(ve){console.error("Error syncing:",ve),be.error("Sync failed",{description:"Failed to connect to TRaSH Guides"})}finally{u(!1)}},ot=async()=>{if(m.size===0){be.error("No formats selected",{description:"Please select at least one custom format to sync"});return}u(!0);try{const xt=await(await ds("/api/trash/sync/selected",Array.from(m))).json();w(xt),xt.success?(be.success("Selected Formats Synced",{description:`Created: ${xt.created}, Updated: ${xt.updated}`}),g(new Set),await Re()):be.error("Sync Failed",{description:xt.error||"Unknown error occurred"})}catch(ve){console.error("Error syncing:",ve),be.error("Sync failed")}finally{u(!1)}},ne=async()=>{K(!0),T(!0);try{const ve=await kt("/api/trash/preview?sportRelevantOnly=true");ve.ok&&E(await ve.json())}catch(ve){console.error("Error loading preview:",ve),be.error("Failed to load sync preview")}finally{K(!1)}},ke=async()=>{xe(!0);try{const xt=await(await Na("/api/trash/formats")).json();xt.success?(be.success("Synced Formats Deleted",{description:`Removed ${xt.updated} custom formats`}),ye(!1),await Re()):be.error("Delete Failed",{description:xt.error})}catch(ve){console.error("Error deleting:",ve),be.error("Failed to delete synced formats")}finally{xe(!1)}},Be=async()=>{F(!0);try{(await br("/api/trash/settings",O)).ok?(be.success("Settings Saved"),D(!1),await Re()):be.error("Failed to save settings")}catch(ve){console.error("Error saving settings:",ve),be.error("Failed to save settings")}finally{F(!1)}},qe=async()=>{ae(!0),le(!0),V(new Set),Z(new Set);try{const ve=await kt("/api/trash/profiles");ve.ok&&X(await ve.json())}catch(ve){console.error("Error loading profiles:",ve),be.error("Failed to load profile templates")}finally{ae(!1)}},dt=async(ve,xt)=>{ee(!0);try{const De=await(await ds(`/api/trash/profiles/create?trashId=${encodeURIComponent(ve)}`,{})).json();De.success?(be.success("Profile Created",{description:`Created "${xt}" from TRaSH template`}),Z(ue=>new Set(ue).add(ve)),V(ue=>{const Fe=new Set(ue);return Fe.delete(ve),Fe})):be.error("Failed to create profile",{description:De.error})}catch(me){console.error("Error creating profile:",me),be.error("Failed to create profile")}finally{ee(!1)}},He=async()=>{if(W.size===0){be.error("No profiles selected");return}ee(!0);let ve=0,xt=0;for(const me of W){const De=H.find(ue=>ue.trashId===me);if(De)try{const Fe=await(await ds(`/api/trash/profiles/create?trashId=${encodeURIComponent(me)}`,{})).json();Fe.success?(ve++,Z(mt=>new Set(mt).add(me))):(xt++,be.error(`Failed: ${De.name}`,{description:Fe.error}))}catch{xt++}}V(new Set),ee(!1),ve>0&&be.success(`Created ${ve} profile${ve>1?"s":""}`,{description:xt>0?`${xt} failed`:void 0})},Ce=ve=>{V(xt=>{const me=new Set(xt);return me.has(ve)?me.delete(ve):me.add(ve),me})},_e=ve=>{b(xt=>{const me=new Set(xt);return me.has(ve)?me.delete(ve):me.add(ve),me})},ge=ve=>{g(xt=>{const me=new Set(xt);return me.has(ve)?me.delete(ve):me.add(ve),me})},Ze=ve=>{const xt=tt[ve]||[];g(me=>{const De=new Set(me);return xt.forEach(ue=>{ue.isSynced||De.add(ue.trashId)}),De})},Me=ve=>{const xt=tt[ve]||[];g(me=>{const De=new Set(me);return xt.forEach(ue=>De.delete(ue.trashId)),De}),Pe(me=>{const De=new Set(me);return xt.forEach(ue=>De.delete(ue.trashId)),De})},nt=ve=>{Pe(xt=>{const me=new Set(xt);return me.has(ve)?me.delete(ve):me.add(ve),me})},ht=ve=>{const xt=tt[ve]||[];Pe(me=>{const De=new Set(me);return xt.forEach(ue=>{ue.isSynced&&De.add(ue.trashId)}),De})},Oe=async()=>{if(Ee.size===0){be.error("No formats selected for deletion");return}xe(!0);try{const ve=s.filter(De=>De.isSynced&&Ee.has(De.trashId)).map(De=>De.trashId),me=await(await qD("/api/trash/formats/selected",Array.from(Ee))).json();me.success?(be.success("Selected Formats Deleted",{description:`Removed ${me.updated} custom formats`}),Pe(new Set),await Re()):be.error("Delete Failed",{description:me.error})}catch(ve){console.error("Error deleting:",ve),be.error("Failed to delete selected formats")}finally{xe(!1)}},tt={},Ct=s.filter(ve=>ve.isRecommended&&!ve.isSynced);Ct.length>0&&(tt.Recommended=Ct),s.forEach(ve=>{const xt=ve.category||"Other";tt[xt]||(tt[xt]=[]),(!ve.isRecommended||ve.isSynced)&&tt[xt].push(ve)});const we=Object.keys(tt).sort((ve,xt)=>ve==="Recommended"?-1:xt==="Recommended"?1:ve.localeCompare(xt)),bt=ve=>{if(!ve)return"Never";const xt=new Date(ve);return xt.toLocaleDateString()+" "+xt.toLocaleTimeString()};return c?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx(Dt,{className:"w-8 h-8 text-blue-500 animate-spin"})}):t.jsxs("div",{className:"max-w-6xl mx-auto pt-2",children:[t.jsx("div",{className:"mb-8",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"TRaSH Guides Integration"}),t.jsx("p",{className:"text-gray-400",children:"Sync custom formats and scores from TRaSH Guides. Sport-relevant formats only."})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("button",{onClick:()=>D(!0),className:"p-2.5 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",title:"Auto-Sync Settings",children:t.jsx(ru,{className:"w-5 h-5"})}),t.jsxs("a",{href:"https://trash-guides.info/",target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 text-blue-400 hover:text-blue-300 text-sm flex items-center gap-2 bg-blue-900/20 hover:bg-blue-900/30 rounded-lg transition-colors",children:[t.jsx(Or,{className:"w-4 h-4"}),"TRaSH Guides"]})]})]})}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h3",{className:"text-lg font-medium text-white",children:"Sync Status"}),O.enableAutoSync&&t.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-400",children:[t.jsx($r,{className:"w-4 h-4"}),"Auto-sync every ",O.autoSyncIntervalHours,"h"]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold text-blue-400",children:(a==null?void 0:a.totalSyncedFormats)||0}),t.jsx("div",{className:"text-sm text-gray-400",children:"Synced Formats"})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:(a==null?void 0:a.customizedFormats)||0}),t.jsx("div",{className:"text-sm text-gray-400",children:"Customized"})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-2xl font-bold text-green-400",children:s.filter(ve=>!ve.isSynced).length}),t.jsx("div",{className:"text-sm text-gray-400",children:"Available to Sync"})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-300",children:bt((a==null?void 0:a.lastSyncDate)||null)}),t.jsx("div",{className:"text-sm text-gray-400",children:"Last Sync"})]})]}),(a==null?void 0:a.categories)&&Object.keys(a.categories).length>0&&t.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700",children:[t.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Synced by Category:"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(a.categories).map(([ve,xt])=>t.jsxs("span",{className:"px-2 py-1 bg-gray-700 rounded text-xs text-gray-300",children:[ve,": ",xt]},ve))})]})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsx("h3",{className:"text-lg font-medium text-white mb-3",children:"Quick Actions"}),t.jsxs("div",{className:"flex flex-wrap gap-3",children:[t.jsxs("button",{onClick:Qe,disabled:f,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 text-white rounded-lg transition-colors",children:[f?t.jsx(Dt,{className:"w-5 h-5 animate-spin"}):t.jsx(qs,{className:"w-5 h-5"}),"Sync All Sport-Relevant Formats"]}),m.size>0&&t.jsxs("button",{onClick:ot,disabled:f,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 text-white rounded-lg transition-colors",children:[f?t.jsx(Dt,{className:"w-5 h-5 animate-spin"}):t.jsx(rs,{className:"w-5 h-5"}),"Sync Selected (",m.size,")"]}),t.jsxs("button",{onClick:ne,disabled:f,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 text-white rounded-lg transition-colors",children:[t.jsx(Cd,{className:"w-5 h-5"}),"Preview Changes"]}),t.jsxs("button",{onClick:qe,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors",children:[t.jsx(hr,{className:"w-5 h-5"}),"Import Profile Template"]}),t.jsxs("button",{onClick:Re,disabled:c,className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:[t.jsx(Dt,{className:`w-5 h-5 ${c?"animate-spin":""}`}),"Refresh"]}),Ee.size>0&&t.jsxs("button",{onClick:Oe,disabled:je,className:"flex items-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-gray-600 text-white rounded-lg transition-colors",children:[je?t.jsx(Dt,{className:"w-5 h-5 animate-spin"}):t.jsx(cs,{className:"w-5 h-5"}),"Delete Selected (",Ee.size,")"]}),((a==null?void 0:a.totalSyncedFormats)||0)>0&&t.jsxs("button",{onClick:()=>ye(!0),className:"flex items-center gap-2 px-4 py-2 bg-red-600/20 hover:bg-red-600/40 text-red-400 rounded-lg transition-colors",children:[t.jsx(cs,{className:"w-5 h-5"}),"Delete All Synced"]})]})]}),v&&t.jsxs("div",{className:`bg-gray-800 rounded-lg p-4 border ${v.success?"border-green-600":"border-red-600"}`,children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[v.success?t.jsx(rs,{className:"w-5 h-5 text-green-500"}):t.jsx(Ss,{className:"w-5 h-5 text-red-500"}),t.jsx("h3",{className:"text-lg font-medium text-white",children:v.success?"Sync Completed":"Sync Failed"})]}),v.success?t.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-green-400 font-bold",children:v.created}),t.jsx("span",{className:"text-gray-400 ml-1",children:"created"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-blue-400 font-bold",children:v.updated}),t.jsx("span",{className:"text-gray-400 ml-1",children:"updated"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-yellow-400 font-bold",children:v.skipped}),t.jsx("span",{className:"text-gray-400 ml-1",children:"skipped"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-red-400 font-bold",children:v.failed}),t.jsx("span",{className:"text-gray-400 ml-1",children:"failed"})]})]}):t.jsx("p",{className:"text-red-400 text-sm",children:v.error}),v.errors.length>0&&t.jsxs("div",{className:"mt-2 text-xs text-red-400",children:[v.errors.slice(0,5).map((ve,xt)=>t.jsx("div",{children:ve},xt)),v.errors.length>5&&t.jsxs("div",{children:["...and ",v.errors.length-5," more errors"]})]})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700",children:[t.jsxs("div",{className:"p-4 border-b border-gray-700",children:[t.jsx("h3",{className:"text-lg font-medium text-white",children:"Available Custom Formats"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Select custom formats to sync. Already synced formats are marked with a checkmark."})]}),t.jsx("div",{className:"divide-y divide-gray-700",children:we.map(ve=>{const xt=tt[ve],me=x.has(ve),De=xt.filter(Fe=>Fe.isSynced).length,ue=xt.filter(Fe=>m.has(Fe.trashId)).length;return t.jsxs("div",{children:[t.jsxs("button",{onClick:()=>_e(ve),className:"w-full flex items-center justify-between p-3 hover:bg-gray-700/50 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[me?t.jsx(As,{className:"w-4 h-4 text-gray-400"}):t.jsx(_c,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{className:`font-medium ${ve==="Recommended"?"text-green-400":"text-white"}`,children:ve}),t.jsxs("span",{className:"text-sm text-gray-500",children:["(",xt.length," formats, ",De," synced)"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[ue>0&&t.jsxs("span",{className:"text-xs bg-blue-600 text-white px-2 py-0.5 rounded",children:[ue," selected"]}),me&&t.jsxs("div",{className:"flex gap-1",onClick:Fe=>Fe.stopPropagation(),children:[t.jsx("button",{onClick:()=>Ze(ve),className:"text-xs text-blue-400 hover:text-blue-300 px-2",title:"Select all non-synced formats for syncing",children:"Select All"}),t.jsx("button",{onClick:()=>Me(ve),className:"text-xs text-gray-400 hover:text-gray-300 px-2",title:"Deselect all formats",children:"Deselect All"}),xt.some(Fe=>Fe.isSynced)&&t.jsx("button",{onClick:()=>ht(ve),className:"text-xs text-red-400 hover:text-red-300 px-2",title:"Select all synced formats for deletion",children:"Select for Delete"})]})]})]}),me&&t.jsx("div",{className:"bg-gray-900/50 px-4 py-2 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:xt.map(Fe=>{const mt=Ee.has(Fe.trashId);return t.jsxs("div",{className:`flex items-center gap-2 p-2 rounded cursor-pointer transition-colors ${Fe.isSynced?mt?"bg-red-900/30 border border-red-600":"bg-green-900/20 border border-green-800/50 hover:border-green-700":m.has(Fe.trashId)?"bg-blue-900/30 border border-blue-700":"bg-gray-800 border border-gray-700 hover:border-gray-600"}`,onClick:()=>{Fe.isSynced?nt(Fe.trashId):ge(Fe.trashId)},children:[Fe.isSynced?t.jsx("input",{type:"checkbox",checked:mt,onChange:()=>nt(Fe.trashId),onClick:Se=>Se.stopPropagation(),className:"w-4 h-4 rounded border-green-600 bg-green-900/50 text-red-600 focus:ring-red-500",title:"Select to delete this synced format"}):t.jsx("input",{type:"checkbox",checked:m.has(Fe.trashId),onChange:()=>ge(Fe.trashId),onClick:Se=>Se.stopPropagation(),className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm text-white truncate",children:Fe.name}),Fe.isSynced&&t.jsx("span",{className:"text-[10px] bg-green-600/50 text-green-300 px-1 rounded",children:"SYNCED"}),Fe.isRecommended&&!Fe.isSynced&&t.jsx("span",{className:"text-[10px] bg-green-600/50 text-green-300 px-1 rounded",children:"REC"})]}),Fe.defaultScore!==null&&Fe.defaultScore!==0&&t.jsxs("span",{className:`text-xs ${Fe.defaultScore>0?"text-green-400":"text-red-400"}`,children:["Score: ",Fe.defaultScore>0?"+":"",Fe.defaultScore]})]})]},Fe.trashId)})})]},ve)})})]}),t.jsx("div",{className:"bg-blue-900/20 border border-blue-800 rounded-lg p-4",children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx(Or,{className:"w-6 h-6 text-blue-400 flex-shrink-0"}),t.jsxs("div",{className:"text-sm text-blue-200",children:[t.jsx("p",{className:"font-medium mb-1",children:"About TRaSH Guides Integration"}),t.jsxs("ul",{className:"list-disc list-inside space-y-1 text-blue-300",children:[t.jsx("li",{children:"All custom formats from TRaSH Guides are available - select the ones you need"}),t.jsx("li",{children:"Synced formats can be customized - they won't be overwritten on the next sync unless you reset them"}),t.jsx("li",{children:'Use "Apply TRaSH Scores" in Quality Profiles to set recommended scores for all synced formats'}),t.jsx("li",{children:"Enable auto-sync in settings to keep your custom formats updated automatically"}),t.jsx("li",{children:"Import profile templates to quickly set up quality profiles with recommended settings"})]})]})]})})]}),S&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg max-w-2xl w-full max-h-[80vh] overflow-hidden flex flex-col",children:[t.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold text-white",children:"Sync Preview"}),t.jsx("button",{onClick:()=>T(!1),className:"text-gray-400 hover:text-white",children:t.jsx(Ss,{className:"w-6 h-6"})})]}),t.jsx("div",{className:"p-4 overflow-y-auto flex-1",children:R?t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx(Dt,{className:"w-8 h-8 text-blue-500 animate-spin"})}):k?t.jsxs("div",{className:"space-y-4",children:[k.toCreate.length>0&&t.jsxs("div",{children:[t.jsxs("h4",{className:"text-green-400 font-medium mb-2",children:["Will Create (",k.toCreate.length,")"]}),t.jsx("div",{className:"space-y-1",children:k.toCreate.map(ve=>t.jsxs("div",{className:"text-sm text-gray-300 flex items-center gap-2",children:[t.jsx("span",{className:"text-green-400",children:"+"}),t.jsx("span",{children:ve.name}),ve.defaultScore!==null&&ve.defaultScore!==0&&t.jsxs("span",{className:`text-xs ${ve.defaultScore>0?"text-green-400":"text-red-400"}`,children:["(",ve.defaultScore>0?"+":"",ve.defaultScore,")"]})]},ve.trashId))})]}),k.toUpdate.length>0&&t.jsxs("div",{children:[t.jsxs("h4",{className:"text-blue-400 font-medium mb-2",children:["Will Update (",k.toUpdate.length,")"]}),t.jsx("div",{className:"space-y-1",children:k.toUpdate.map(ve=>t.jsxs("div",{className:"text-sm",children:[t.jsxs("div",{className:"text-gray-300 flex items-center gap-2",children:[t.jsx("span",{className:"text-blue-400",children:"~"}),t.jsx("span",{children:ve.name})]}),ve.changes&&ve.changes.length>0&&t.jsx("div",{className:"ml-4 text-xs text-gray-500",children:ve.changes.join(", ")})]},ve.trashId))})]}),k.toSkip.length>0&&t.jsxs("div",{children:[t.jsxs("h4",{className:"text-yellow-400 font-medium mb-2",children:["Will Skip (",k.toSkip.length,")"]}),t.jsx("div",{className:"space-y-1",children:k.toSkip.map(ve=>t.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-2",children:[t.jsx("span",{className:"text-yellow-400",children:"-"}),t.jsx("span",{children:ve.name}),ve.reason&&t.jsxs("span",{className:"text-xs",children:["(",ve.reason,")"]})]},ve.trashId))})]}),k.totalChanges===0&&k.toSkip.length===0&&t.jsx("p",{className:"text-gray-400 text-center py-4",children:"No changes to sync"})]}):t.jsx("p",{className:"text-gray-400",children:"Failed to load preview"})}),t.jsxs("div",{className:"p-4 border-t border-gray-700 flex justify-end gap-2",children:[t.jsx("button",{onClick:()=>T(!1),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg",children:"Close"}),k&&k.totalChanges>0&&t.jsx("button",{onClick:()=>{T(!1),Qe()},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg",children:"Sync Now"})]})]})}),z&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between sticky top-0 bg-gray-900",children:[t.jsx("h3",{className:"text-lg font-semibold text-white",children:"Auto-Sync Settings"}),t.jsx("button",{onClick:()=>D(!1),className:"text-gray-400 hover:text-white",children:t.jsx(Ss,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"p-4 space-y-5",children:[t.jsx("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:t.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:O.enableAutoSync,onChange:ve=>U({...O,enableAutoSync:ve.target.checked}),className:"w-5 h-5 mt-0.5 rounded border-gray-600 bg-gray-700 text-blue-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Enable Auto-Sync"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Automatically download and update custom formats from TRaSH Guides on a schedule. This keeps your formats up-to-date with the latest regex patterns and scoring recommendations."})]})]})}),O.enableAutoSync&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:[t.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Sync Interval (hours)"}),t.jsx("input",{type:"number",min:1,max:168,value:O.autoSyncIntervalHours,onChange:ve=>U({...O,autoSyncIntervalHours:parseInt(ve.target.value)||24}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white"}),t.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"How often to check for updates. TRaSH Guides typically updates a few times per week, so 24-48 hours is usually sufficient."})]}),t.jsx("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:t.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:O.autoApplyScoresToProfiles,onChange:ve=>U({...O,autoApplyScoresToProfiles:ve.target.checked}),className:"w-5 h-5 mt-0.5 rounded border-gray-600 bg-gray-700 text-blue-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Auto-Apply Scores to TRaSH Profiles"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"After syncing custom formats, automatically update the scores in quality profiles that were imported from TRaSH Guides."}),t.jsx("p",{className:"text-xs text-green-500/80 mt-2",children:' Only affects profiles created via "Import Profile Template" - your custom profiles are safe.'})]})]})}),O.autoApplyScoresToProfiles&&t.jsxs("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:[t.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Score Set"}),t.jsx("select",{value:O.autoApplyScoreSet,onChange:ve=>U({...O,autoApplyScoreSet:ve.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white",children:Object.entries(n).map(([ve,xt])=>t.jsx("option",{value:ve,children:xt},ve))}),t.jsxs("div",{className:"mt-3 p-3 bg-blue-900/20 border border-blue-800/50 rounded-lg",children:[t.jsx("p",{className:"text-sm text-blue-300 font-medium mb-2",children:"What is a Score Set?"}),t.jsx("p",{className:"text-xs text-blue-200/80",children:"TRaSH Guides provides different scoring presets optimized for different languages and preferences:"}),t.jsxs("ul",{className:"text-xs text-blue-200/70 mt-2 space-y-1 ml-3 list-disc",children:[t.jsxs("li",{children:[t.jsx("strong",{children:"Default"})," - Standard English-focused scoring. Best for most users."]}),t.jsxs("li",{children:[t.jsx("strong",{children:"French (Multi-Audio)"})," - Prioritizes releases with French + original audio tracks."]}),t.jsxs("li",{children:[t.jsx("strong",{children:"French (VOSTFR)"})," - Prioritizes original audio with French subtitles."]}),t.jsxs("li",{children:[t.jsx("strong",{children:"German / German (Multi)"})," - Optimized for German language releases."]})]}),t.jsx("p",{className:"text-xs text-blue-200/60 mt-2",children:"Each set adjusts scores for language-related custom formats to prefer your chosen language configuration."})]})]})]})]}),t.jsxs("div",{className:"p-4 border-t border-gray-700 flex justify-end gap-2",children:[t.jsx("button",{onClick:()=>D(!1),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg",children:"Cancel"}),t.jsx("button",{onClick:Be,disabled:I,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 text-white rounded-lg",children:I?"Saving...":"Save Settings"})]})]})}),te&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg max-w-3xl w-full max-h-[85vh] overflow-hidden flex flex-col",children:[t.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-white",children:"TRaSH Quality Profile Templates"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Select profiles to import. You can create multiple profiles at once."})]}),t.jsx("button",{onClick:()=>le(!1),className:"text-gray-400 hover:text-white",children:t.jsx(Ss,{className:"w-6 h-6"})})]}),t.jsx("div",{className:"p-4 overflow-y-auto flex-1",children:q?t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx(Dt,{className:"w-8 h-8 text-blue-500 animate-spin"})}):H.length>0?t.jsx("div",{className:"space-y-3",children:H.map(ve=>{const xt=G.has(ve.trashId),me=W.has(ve.trashId);return t.jsx("div",{className:`border rounded-lg p-4 transition-colors ${xt?"bg-green-900/20 border-green-700":me?"bg-blue-900/20 border-blue-600":"bg-gray-800 border-gray-700 hover:border-gray-600"}`,children:t.jsxs("div",{className:"flex items-start gap-3",children:[!xt&&t.jsx("input",{type:"checkbox",checked:me,onChange:()=>Ce(ve.trashId),disabled:ce,className:"w-5 h-5 mt-0.5 rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500"}),xt&&t.jsx(rs,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("h4",{className:"text-white font-medium",children:ve.name}),xt&&t.jsx("span",{className:"px-2 py-0.5 bg-green-600/30 text-green-400 text-xs rounded",children:"Created"})]}),ve.description&&t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:ve.description}),t.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 mt-2 text-xs text-gray-500",children:[t.jsxs("span",{children:[ve.qualityCount," qualities"]}),ve.formatScoreCount>0&&t.jsxs("span",{children:[ve.formatScoreCount," format scores"]}),ve.minFormatScore!==null&&ve.minFormatScore!==0&&t.jsxs("span",{children:["Min score: ",ve.minFormatScore]}),ve.cutoff&&t.jsxs("span",{className:"text-blue-400",children:["Cutoff: ",ve.cutoff]})]})]}),!xt&&t.jsx("button",{onClick:()=>dt(ve.trashId,ve.name),disabled:ce,className:"px-3 py-1.5 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 text-white text-sm rounded-lg flex-shrink-0",children:ce?"Creating...":"Create"})]})},ve.trashId)})}):t.jsx("p",{className:"text-gray-400 text-center py-4",children:"No profile templates available"})}),t.jsxs("div",{className:"p-4 border-t border-gray-700 flex items-center justify-between gap-4",children:[t.jsx("p",{className:"text-sm text-gray-500 flex-1",children:"Sync custom formats first for best results."}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>le(!1),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg",children:"Close"}),W.size>0&&t.jsx("button",{onClick:He,disabled:ce,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 text-white rounded-lg",children:ce?"Creating...":`Create Selected (${W.size})`})]})]})]})}),oe&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gray-900 border border-red-600 rounded-lg max-w-md w-full p-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Delete All Synced Formats?"}),t.jsxs("p",{className:"text-gray-400 mb-4",children:["This will remove all ",(a==null?void 0:a.totalSyncedFormats)||0," custom formats that were synced from TRaSH Guides. This action cannot be undone."]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{onClick:()=>ye(!1),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg",children:"Cancel"}),t.jsx("button",{onClick:ke,disabled:je,className:"px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-gray-600 text-white rounded-lg",children:je?"Deleting...":"Delete All"})]})]})})]})}const WS=[{name:"Newznab",implementation:"Newznab",protocol:"usenet",description:"Generic Newznab indexer",fields:["baseUrl","apiKey","categories"]},{name:"Torznab",implementation:"Torznab",protocol:"torrent",description:"Generic Torznab indexer (Jackett/Prowlarr)",fields:["baseUrl","apiKey","categories","minimumSeeders","seedRatio","seedTime"]},{name:"Nyaa",implementation:"Nyaa",protocol:"torrent",description:"Nyaa - Torznab compatible indexer",fields:["baseUrl","categories","minimumSeeders"]},{name:"TorrentLeech",implementation:"TorrentLeech",protocol:"torrent",description:"TorrentLeech - Torznab compatible indexer",fields:["baseUrl","apiKey","categories","minimumSeeders","seedRatio","seedTime"]},{name:"IPTorrents",implementation:"IPTorrents",protocol:"torrent",description:"IPTorrents - Torznab compatible indexer",fields:["baseUrl","apiKey","categories","minimumSeeders","seedRatio","seedTime"]},{name:"FileList",implementation:"FileList",protocol:"torrent",description:"FileList - Torznab compatible indexer",fields:["baseUrl","apiKey","categories","minimumSeeders","seedRatio","seedTime"]}];function HI(){const[a,e]=y.useState(()=>localStorage.getItem("sportarr-showAdvanced-indexers")==="true");y.useEffect(()=>{localStorage.setItem("sportarr-showAdvanced-indexers",a.toString())},[a]);const{data:s=[],isLoading:r}=jk(),n=Ek(),o=Tk(),c=Ak(),d=Ck(),[f,u]=y.useState(new Set),[m,g]=y.useState(!1),x=y.useMemo(()=>s.map(ge=>{const Ze=st=>{var wt,yt;return(yt=(wt=ge.fields)==null?void 0:wt.find(Mt=>Mt.name===st))==null?void 0:yt.value},Me=Ze("baseUrl")||"",nt=Ze("apiPath")||"/api",ht=Ze("apiKey")||"",Oe=Ze("categories")||"",tt=Ze("animeCategories"),Ct=Ze("minimumSeeders")||"1",we=Ze("seedRatio"),bt=Ze("seedTime"),ve=Ze("seasonPackSeedTime"),xt=Ze("earlyReleaseLimit"),me=Ze("additionalParameters"),De=Ze("multiLanguages"),ue=Ze("rejectBlocklistedTorrentHashes"),Fe=Ze("downloadClientId"),mt=Ze("tags"),Se=["Torznab","Torrent","Nyaa","TorrentLeech","IPTorrents","FileList"].some(st=>ge.implementation.toLowerCase().includes(st.toLowerCase()));return{id:ge.id,name:ge.name,implementation:ge.implementation,protocol:Se?"torrent":"usenet",enabled:ge.enable,enableRss:ge.enableRss??!0,enableAutomaticSearch:ge.enableAutomaticSearch??!0,enableInteractiveSearch:ge.enableInteractiveSearch??!0,priority:ge.priority,baseUrl:Me,apiPath:nt,apiKey:ht,categories:Oe?Oe.split(",").map(st=>parseInt(st.trim(),10)):[],animeCategories:tt?tt.split(",").map(st=>parseInt(st.trim(),10)):void 0,minimumSeeders:parseInt(Ct,10),seedRatio:we?parseFloat(we):void 0,seedTime:bt?parseInt(bt,10):void 0,seasonPackSeedTime:ve?parseInt(ve,10):void 0,earlyReleaseLimit:xt?parseInt(xt,10):void 0,additionalParameters:me||void 0,multiLanguages:De?De.split(",").map(st=>st.trim()):void 0,rejectBlocklistedTorrentHashes:ue?ue==="true":!0,downloadClientId:Fe?parseInt(Fe,10):void 0,tags:mt?mt.split(",").map(st=>parseInt(st.trim(),10)):[]}}),[s]),[b,v]=y.useState(!1),[w,S]=y.useState(null),[T,k]=y.useState(null),[E,R]=y.useState(null),[K,z]=y.useState(null),[D,O]=y.useState(0),[U,I]=y.useState(60),[F,te]=y.useState(!0),[le,H]=y.useState(120),[X,q]=y.useState(!1),[ae,ce]=y.useState(!1),ee=y.useRef(null);cl(ae),y.useEffect(()=>{W()},[]);const W=async()=>{try{const ge=await kt("/api/settings");if(ge.ok){const Ze=await ge.json(),Me={retention:Ze.indexerRetention??0,rssSyncInterval:Ze.rssSyncInterval??60,preferIndexerFlags:Ze.preferIndexerFlags??!0,searchCacheDuration:Ze.searchCacheDuration??120};O(Me.retention),I(Me.rssSyncInterval),te(Me.preferIndexerFlags),H(Me.searchCacheDuration),ee.current=Me,ce(!1)}}catch(ge){console.error("Failed to load indexer settings:",ge)}};y.useEffect(()=>{if(!ee.current)return;const Ze=JSON.stringify({retention:D,rssSyncInterval:U,preferIndexerFlags:F,searchCacheDuration:le})!==JSON.stringify(ee.current);ce(Ze)},[D,U,F,le]);const V=async()=>{q(!0);try{const ge=await kt("/api/settings");if(!ge.ok)throw new Error("Failed to fetch current settings");const Me={...await ge.json(),indexerRetention:D,rssSyncInterval:Math.max(10,U),preferIndexerFlags:F,searchCacheDuration:Math.max(10,le)};await br("/api/settings",Me),ee.current={retention:D,rssSyncInterval:U,preferIndexerFlags:F,searchCacheDuration:le},ce(!1)}catch(ge){console.error("Failed to save indexer settings:",ge),be.error("Save Failed",{description:"Failed to save settings. Please try again."})}finally{q(!1)}},[G,Z]=y.useState({enabled:!0,enableRss:!0,enableAutomaticSearch:!0,enableInteractiveSearch:!0,priority:25,apiPath:"/api",categories:[],minimumSeeders:1,seedRatio:1,seedTime:0,rejectBlocklistedTorrentHashes:!0,tags:[]}),oe=ge=>{R(ge),Z({name:ge.name,implementation:ge.implementation,protocol:ge.protocol,enabled:!0,priority:25,baseUrl:"",apiKey:"",categories:[],minimumSeeders:ge.protocol==="torrent"?1:void 0,seedRatio:ge.protocol==="torrent"?1:void 0,seedTime:ge.protocol==="torrent"?0:void 0})},ye=(ge,Ze)=>{Z(Me=>({...Me,[ge]:Ze}))},je=ge=>{var Me;const Ze=[{name:"baseUrl",value:ge.baseUrl||""},{name:"apiPath",value:ge.apiPath||"/api"},{name:"apiKey",value:ge.apiKey||""},{name:"categories",value:((Me=ge.categories)==null?void 0:Me.join(","))||""},{name:"minimumSeeders",value:String(ge.minimumSeeders||1)}];return ge.animeCategories&&ge.animeCategories.length>0&&Ze.push({name:"animeCategories",value:ge.animeCategories.join(",")}),ge.seedRatio!==void 0&&Ze.push({name:"seedRatio",value:String(ge.seedRatio)}),ge.seedTime!==void 0&&Ze.push({name:"seedTime",value:String(ge.seedTime)}),ge.seasonPackSeedTime!==void 0&&Ze.push({name:"seasonPackSeedTime",value:String(ge.seasonPackSeedTime)}),ge.earlyReleaseLimit!==void 0&&Ze.push({name:"earlyReleaseLimit",value:String(ge.earlyReleaseLimit)}),ge.additionalParameters&&Ze.push({name:"additionalParameters",value:ge.additionalParameters}),ge.multiLanguages&&ge.multiLanguages.length>0&&Ze.push({name:"multiLanguages",value:ge.multiLanguages.join(",")}),ge.rejectBlocklistedTorrentHashes!==void 0&&Ze.push({name:"rejectBlocklistedTorrentHashes",value:String(ge.rejectBlocklistedTorrentHashes)}),ge.downloadClientId!==void 0&&Ze.push({name:"downloadClientId",value:String(ge.downloadClientId)}),ge.tags&&ge.tags.length>0&&Ze.push({name:"tags",value:ge.tags.join(",")}),{id:ge.id,name:ge.name||"",implementation:ge.implementation||"Torznab",enable:ge.enabled??!0,enableRss:ge.enableRss??!0,enableAutomaticSearch:ge.enableAutomaticSearch??!0,enableInteractiveSearch:ge.enableInteractiveSearch??!0,priority:ge.priority||25,fields:Ze}},xe=async()=>{try{z(null);const ge=je(G);w?await o.mutateAsync(ge):await n.mutateAsync(ge),v(!1),R(null),S(null),Z({enabled:!0,priority:25,categories:[],minimumSeeders:1,seedRatio:1,seedTime:0})}catch(ge){console.error("Error saving indexer:",ge),z(ge instanceof Error?ge.message:"Failed to save indexer")}},Ee=ge=>{S(ge),Z(ge);const Ze=WS.find(Me=>Me.implementation===ge.implementation);R(Ze||null)},Pe=async ge=>{try{z(null),await c.mutateAsync(ge),k(null)}catch(Ze){console.error("Error deleting indexer:",Ze),z(Ze instanceof Error?Ze.message:"Failed to delete indexer"),k(null)}},Re=ge=>{u(Ze=>{const Me=new Set(Ze);return Me.has(ge)?Me.delete(ge):Me.add(ge),Me})},Qe=()=>{f.size===x.length?u(new Set):u(new Set(x.map(ge=>ge.id)))},ot=async()=>{try{z(null);const ge=Array.from(f);await d.mutateAsync(ge),u(new Set),g(!1),be.success("Indexers Deleted",{description:`Successfully deleted ${ge.length} indexer(s)`})}catch(ge){console.error("Error bulk deleting indexers:",ge),z(ge instanceof Error?ge.message:"Failed to delete indexers"),g(!1)}},[ne,ke]=y.useState(null),[Be,qe]=y.useState(!1),dt=async ge=>{var Ze,Me,nt;try{qe(!0),ke(null);const ht=je(ge),Oe=await at.post("/indexer/test",ht);ke({success:!0,message:((Ze=Oe.data)==null?void 0:Ze.message)||"Connection successful!"}),be.success("Test Successful",{description:`Successfully connected to ${ge.name||"indexer"}`})}catch(ht){console.error("Test failed:",ht);const Oe=((nt=(Me=ht.response)==null?void 0:Me.data)==null?void 0:nt.message)||ht.message||"Connection test failed!";ke({success:!1,message:Oe}),be.error("Test Failed",{description:Oe})}finally{qe(!1)}},He=()=>{v(!1),S(null),R(null),Z({enabled:!0,priority:25,categories:[],minimumSeeders:1,seedRatio:1,seedTime:0})},Ce=()=>{if(!E&&!w)return null;const ge=E,Ze=G.protocol==="torrent",Me=G.protocol==="usenet",nt=ht=>(ge==null?void 0:ge.fields.includes(ht))||!1;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:"Basic Settings"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Name *"}),t.jsx("input",{type:"text",value:G.name||"",onChange:ht=>ye("name",ht.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"My Indexer"})]}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:G.enabled||!1,onChange:ht=>ye("enabled",ht.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Enable this indexer"})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:"Search Capabilities"}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:G.enableRss??!0,onChange:ht=>ye("enableRss",ht.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Enable RSS"})]}),t.jsx("p",{className:"text-xs text-gray-500 ml-7 -mt-3",children:"Periodically query indexer for new releases"}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:G.enableAutomaticSearch??!0,onChange:ht=>ye("enableAutomaticSearch",ht.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Enable Automatic Search"})]}),t.jsx("p",{className:"text-xs text-gray-500 ml-7 -mt-3",children:"Automatic searches via API will use this indexer"}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:G.enableInteractiveSearch??!0,onChange:ht=>ye("enableInteractiveSearch",ht.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Enable Interactive Search"})]}),t.jsx("p",{className:"text-xs text-gray-500 ml-7 -mt-3",children:"Manual searches in the UI will use this indexer"})]}),nt("baseUrl")&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:"Connection"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"URL *"}),t.jsx("input",{type:"text",value:G.baseUrl||"",onChange:ht=>ye("baseUrl",ht.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:Me?"https://indexer.com":"http://localhost:9117/api/v2.0/indexers/torrentleech/"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Me?"Newznab feed URL":"Torznab feed URL (from Jackett/Prowlarr)"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"API Path"}),t.jsx("input",{type:"text",value:G.apiPath||"/api",onChange:ht=>ye("apiPath",ht.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"/api"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"API path for the indexer (usually /api for Newznab/Torznab)"})]})]}),nt("apiKey")&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:"Authentication"}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["API Key ",w?"":"*"]}),t.jsx("input",{type:"password",value:G.apiKey||"",onChange:ht=>ye("apiKey",ht.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:w?"Leave blank to keep existing API key":"Enter your API key"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:w?"Leave blank to keep the existing API key, or enter a new one to update it":`API key from your ${G.implementation} account`})]})]}),nt("categories")&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:"Categories"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Category IDs"}),t.jsx("input",{type:"text",value:(G.categories||[]).join(", "),onChange:ht=>{const Oe=ht.target.value.split(",").map(tt=>parseInt(tt.trim())).filter(tt=>!isNaN(tt));ye("categories",Oe)},className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"5000, 5030, 5040 (combat sports categories)"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Comma-separated category IDs. Leave empty to search all categories."})]})]}),Ze&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:"Torrent Settings"}),nt("minimumSeeders")&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Minimum Seeders"}),t.jsx("input",{type:"number",value:G.minimumSeeders||0,onChange:ht=>ye("minimumSeeders",parseInt(ht.target.value)),min:"0",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum number of seeders required to grab a torrent"})]}),a&&nt("seedRatio")&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Seed Ratio"}),t.jsx("input",{type:"number",step:"0.1",value:G.seedRatio||0,onChange:ht=>ye("seedRatio",parseFloat(ht.target.value)),min:"0",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Seed ratio required before torrent is stopped. 0 = disabled"})]}),a&&nt("seedTime")&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Seed Time (minutes)"}),t.jsx("input",{type:"number",value:G.seedTime||0,onChange:ht=>ye("seedTime",parseInt(ht.target.value)),min:"0",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Seed time required before torrent is stopped. 0 = disabled"})]}),a&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Season-Pack Seed Time (minutes)"}),t.jsx("input",{type:"number",value:G.seasonPackSeedTime||0,onChange:ht=>ye("seasonPackSeedTime",parseInt(ht.target.value)),min:"0",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Seed time for season packs. 0 = use Seed Time setting"})]}),a&&t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:G.rejectBlocklistedTorrentHashes??!0,onChange:ht=>ye("rejectBlocklistedTorrentHashes",ht.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Reject Blocklisted Torrent Hashes"})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:"Priority"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Indexer Priority"}),t.jsx("input",{type:"number",value:G.priority!==void 0?G.priority:25,onChange:ht=>ye("priority",parseInt(ht.target.value)||25),min:"1",max:"50",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Priority when choosing between indexers (1-50, lower is higher priority)"})]})]}),a&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:"Advanced Options"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Early Release Limit"}),t.jsx("input",{type:"number",value:G.earlyReleaseLimit||0,onChange:ht=>ye("earlyReleaseLimit",parseInt(ht.target.value)),min:"0",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"How many days before an event can be grabbed. 0 = disabled"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Additional Parameters"}),t.jsx("input",{type:"text",value:G.additionalParameters||"",onChange:ht=>ye("additionalParameters",ht.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"&extended=1"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Additional Newznab/Torznab parameters"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Multi Languages"}),t.jsx("input",{type:"text",value:(G.multiLanguages||[]).join(", "),onChange:ht=>{const Oe=ht.target.value.split(",").map(tt=>tt.trim()).filter(tt=>tt);ye("multiLanguages",Oe)},className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"en, es, fr"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Comma-separated language codes for multi-language releases"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Download Client"}),t.jsx("input",{type:"number",value:G.downloadClientId||0,onChange:ht=>ye("downloadClientId",parseInt(ht.target.value)),min:"0",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"0 (use default)"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Download client ID to use for this indexer. 0 = use default"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tags"}),t.jsx("input",{type:"text",value:(G.tags||[]).join(", "),onChange:ht=>{const Oe=ht.target.value.split(",").map(tt=>parseInt(tt.trim())).filter(tt=>!isNaN(tt));ye("tags",Oe)},className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"1, 2, 3"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Comma-separated tag IDs for filtering"})]})]})]})},_e=()=>w?G.name&&G.name.trim().length>0:G.name&&G.name.trim().length>0&&G.baseUrl&&G.baseUrl.trim().length>0;return t.jsxs("div",{children:[t.jsx(Rn,{title:"Indexers",subtitle:"Configure Usenet indexers and torrent trackers for searching combat sports events",onSave:V,isSaving:X,hasUnsavedChanges:ae,saveButtonText:"Save Changes",children:t.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer text-sm",children:[t.jsx("input",{type:"checkbox",checked:a,onChange:ge=>e(ge.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600 focus:ring-offset-gray-900"}),t.jsx("span",{className:"text-gray-300",children:"Show Advanced"})]})}),t.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[K&&t.jsxs("div",{className:"mb-6 bg-red-950/30 border border-red-900/50 rounded-lg p-4 flex items-start",children:[t.jsx(Ss,{className:"w-6 h-6 text-red-400 mr-3 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-lg font-semibold text-red-400 mb-1",children:"Error"}),t.jsx("p",{className:"text-sm text-gray-300",children:K})]}),t.jsx("button",{onClick:()=>z(null),className:"text-gray-400 hover:text-white ml-4",children:t.jsx(qt,{className:"w-5 h-5"})})]}),t.jsx("div",{className:"mb-8 bg-blue-950/30 border border-blue-900/50 rounded-lg p-6",children:t.jsxs("div",{className:"flex items-start",children:[t.jsx(Ks,{className:"w-6 h-6 text-blue-400 mr-3 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"About Indexers"}),t.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"Usenet Indexers:"})," Newznab-compatible sites that index Usenet posts"]})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"Torrent Trackers:"})," Sites or applications (Jackett/Prowlarr) that track torrent files"]})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"Priority:"})," Higher priority indexers are searched first (1-50)"]})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:""}),t.jsxs("span",{children:["Use ",t.jsx("strong",{children:"Prowlarr"})," or ",t.jsx("strong",{children:"Jackett"})," to manage multiple indexers through a single Torznab endpoint"]})]})]})]})]})}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Your Indexers"}),x.length>0&&t.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer text-sm",children:[t.jsx("input",{type:"checkbox",checked:f.size===x.length&&x.length>0,onChange:Qe,className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-gray-400",children:"Select All"})]}),f.size>0&&t.jsxs("span",{className:"text-sm text-gray-400",children:["(",f.size," selected)"]})]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[f.size>0&&t.jsxs("button",{onClick:()=>g(!0),className:"flex items-center px-4 py-2 bg-red-900 hover:bg-red-800 text-white rounded-lg transition-colors",children:[t.jsx(cs,{className:"w-4 h-4 mr-2"}),"Delete Selected (",f.size,")"]}),t.jsxs("button",{onClick:()=>v(!0),className:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[t.jsx(hr,{className:"w-4 h-4 mr-2"}),"Add Indexer"]})]})]}),t.jsx("div",{className:"space-y-3",children:x.map(ge=>t.jsx("div",{className:`group bg-black/30 border rounded-lg p-4 transition-all ${f.has(ge.id)?"border-red-600 bg-red-950/20":"border-gray-800 hover:border-red-900/50"}`,children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[t.jsx("div",{className:"mt-1",children:t.jsx("input",{type:"checkbox",checked:f.has(ge.id),onChange:()=>Re(ge.id),className:"w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600 cursor-pointer"})}),t.jsx("div",{className:"mt-1",children:ge.enabled?t.jsx(rs,{className:"w-6 h-6 text-green-500"}):t.jsx(Ss,{className:"w-6 h-6 text-gray-500"})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:ge.name}),t.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${ge.protocol==="usenet"?"bg-blue-900/30 text-blue-400":"bg-green-900/30 text-green-400"}`,children:ge.protocol.toUpperCase()}),t.jsxs("span",{className:"px-2 py-0.5 bg-gray-800 text-gray-400 text-xs rounded",children:["Priority: ",ge.priority]})]}),t.jsxs("div",{className:"space-y-1 text-sm text-gray-400",children:[t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-500",children:"Implementation:"})," ",t.jsx("span",{className:"text-white",children:ge.implementation})]}),ge.baseUrl&&t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-500",children:"URL:"})," ",t.jsx("span",{className:"text-white",children:ge.baseUrl})]}),ge.categories&&ge.categories.length>0&&t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-500",children:"Categories:"})," ",t.jsx("span",{className:"text-white",children:ge.categories.join(", ")})]}),ge.protocol==="torrent"&&t.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[ge.minimumSeeders!==void 0&&t.jsxs("span",{className:"text-gray-500",children:["Min Seeders:"," ",t.jsx("span",{className:"text-white",children:ge.minimumSeeders})]}),ge.seedRatio!==void 0&&t.jsxs("span",{className:"text-gray-500",children:["Seed Ratio: ",t.jsx("span",{className:"text-white",children:ge.seedRatio})]})]})]})]})]}),t.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[t.jsx("button",{onClick:()=>dt(ge),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",title:"Test",children:t.jsx(rs,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>{Ee(ge),v(!0)},className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",title:"Edit",children:t.jsx(an,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>k(ge.id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-950/30 rounded transition-colors",title:"Delete",children:t.jsx(cs,{className:"w-5 h-5"})})]})]})},ge.id))}),r&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-red-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500",children:"Loading indexers..."})]}),!r&&x.length===0&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx(Ks,{className:"w-16 h-16 text-gray-700 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500 mb-2",children:"No indexers configured"}),t.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Add indexers to search for combat sports events or sync from Prowlarr"})]})]}),a&&t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-yellow-900/30 rounded-lg p-6",children:[t.jsxs("h3",{className:"text-xl font-semibold text-white mb-4",children:["Indexer Options",t.jsx("span",{className:"ml-2 px-2 py-0.5 bg-yellow-900/30 text-yellow-400 text-xs rounded",children:"Advanced"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Retention"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"number",value:D,onChange:ge=>O(Number(ge.target.value)),className:"w-32 px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",min:"0"}),t.jsx("span",{className:"text-gray-400",children:"days"})]}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Set to 0 to disable. Releases older than this will not be grabbed"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"RSS Sync Interval"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"number",value:U,onChange:ge=>I(Number(ge.target.value)),className:"w-32 px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",min:"10"}),t.jsx("span",{className:"text-gray-400",children:"minutes"})]}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"How often Sportarr will sync with indexers. Minimum 10 minutes."})]}),t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:F,onChange:ge=>te(ge.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Prefer Indexer Flags"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Prefer releases with special indexer flags (Freeleech, Scene, etc.)"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Search Result Cache Duration"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"number",value:le,onChange:ge=>H(Number(ge.target.value)),className:"w-32 px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",min:"10",max:"600"}),t.jsx("span",{className:"text-gray-400",children:"seconds"})]}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:'How long to cache raw indexer results in memory. Cached results are re-matched against each event, reducing API calls when searching: multi-part events (UFC Prelims/Main Card share cache), same-year events (all NFL 2025 games share cache). Use the "Refresh" button to bypass cache.'})]})]})]}),(b||w)&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 overflow-y-auto",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-4xl w-full my-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-2xl font-bold text-white",children:w?`Edit ${w.name}`:"Add Indexer"}),t.jsx("button",{onClick:He,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),!E&&!w?t.jsxs(t.Fragment,{children:[t.jsx("p",{className:"text-gray-400 mb-6",children:"Select an indexer type to configure"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-96 overflow-y-auto",children:WS.map(ge=>t.jsxs("button",{onClick:()=>oe(ge),className:"flex items-start p-4 bg-black/30 border border-gray-800 hover:border-red-600 rounded-lg transition-all text-left group",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[t.jsx("h4",{className:"text-white font-semibold",children:ge.name}),t.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${ge.protocol==="usenet"?"bg-blue-900/30 text-blue-400":"bg-green-900/30 text-green-400"}`,children:ge.protocol.toUpperCase()})]}),t.jsx("p",{className:"text-sm text-gray-400",children:ge.description})]}),t.jsx(hr,{className:"w-5 h-5 text-gray-400 group-hover:text-red-400 transition-colors"})]},ge.implementation))})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"max-h-[60vh] overflow-y-auto pr-2",children:Ce()}),t.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-800 flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:He,className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>dt(G),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"Test"}),t.jsx("button",{onClick:xe,disabled:!_e(),className:`px-4 py-2 rounded-lg transition-colors ${_e()?"bg-red-600 hover:bg-red-700 text-white":"bg-gray-700 text-gray-500 cursor-not-allowed"}`,children:"Save"})]})]})]})}),T!==null&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-md w-full",children:[t.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Delete Indexer?"}),t.jsx("p",{className:"text-gray-400 mb-6",children:"Are you sure you want to delete this indexer? This action cannot be undone."}),t.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>k(null),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>Pe(T),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Delete"})]})]})}),m&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-md w-full",children:[t.jsxs("h3",{className:"text-2xl font-bold text-white mb-4",children:["Delete ",f.size," Indexer",f.size>1?"s":"","?"]}),t.jsx("p",{className:"text-gray-400 mb-4",children:"Are you sure you want to delete the following indexers? This action cannot be undone."}),t.jsx("div",{className:"bg-black/30 border border-gray-800 rounded-lg p-3 mb-6 max-h-40 overflow-y-auto",children:t.jsx("ul",{className:"space-y-1 text-sm text-gray-300",children:x.filter(ge=>f.has(ge.id)).map(ge=>t.jsxs("li",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"text-red-400",children:""}),t.jsx("span",{children:ge.name}),t.jsxs("span",{className:"text-gray-500 text-xs",children:["(",ge.implementation,")"]})]},ge.id))})}),t.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:ot,disabled:d.isPending,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors disabled:opacity-50",children:d.isPending?"Deleting...":`Delete ${f.size} Indexer${f.size>1?"s":""}`})]})]})})]})]})}const QS=[{value:0,label:"RSS Feed",description:"RSS/Atom feed with event listings"},{value:1,label:"TheSportsDB",description:"Automatic event discovery from TheSportsDB"},{value:2,label:"Calendar/iCal",description:"iCalendar (.ics) feed with event schedules"},{value:3,label:"Custom API",description:"JSON API endpoint returning event data"},{value:4,label:"Custom Script",description:"Custom script or webhook for event discovery"}];function VI({showAdvanced:a=!1}){const[e,s]=y.useState([]),[r,n]=y.useState([]),[o,c]=y.useState([]),[d,f]=y.useState([]),[u,m]=y.useState(!0),[g,x]=y.useState(null),[b,v]=y.useState(!1),[w,S]=y.useState(null),[T,k]=y.useState(null),[E,R]=y.useState({name:"",enabled:!0,listType:0,url:"",qualityProfileId:1,rootFolderPath:"",monitorEvents:!0,searchOnAdd:!1,tags:[],minimumDaysBeforeEvent:0});y.useEffect(()=>{K()},[]);const K=async()=>{try{const[H,X,q,ae]=await Promise.all([kt("/api/importlist"),kt("/api/qualityprofile"),kt("/api/rootfolder"),kt("/api/tag")]);s(H.ok?await H.json():[]),n(X.ok?await X.json():[]),c(q.ok?await q.json():[]),f(ae.ok?await ae.json():[])}catch(H){console.error("Failed to load data:",H)}finally{m(!1)}},z=async()=>{try{const H=g?`/api/importlist/${g.id}`:"/api/importlist";(g?await br(H,E):await ds(H,E)).ok&&(await K(),v(!1),x(null),F())}catch(H){console.error("Error saving import list:",H)}},D=async H=>{try{(await Na(`/api/importlist/${H}`)).ok&&(await K(),S(null))}catch(X){console.error("Error deleting import list:",X)}},O=async H=>{k(H);try{(await ds(`/api/importlist/${H}/sync`,{})).ok&&await K()}catch(X){console.error("Error syncing import list:",X)}finally{k(null)}},U=()=>{x(null),F(),v(!0)},I=H=>{x(H),R({...H}),v(!0)},F=()=>{var H,X;R({name:"",enabled:!0,listType:0,url:"",qualityProfileId:((H=r[0])==null?void 0:H.id)||1,rootFolderPath:((X=o[0])==null?void 0:X.path)||"",monitorEvents:!0,searchOnAdd:!1,tags:[],minimumDaysBeforeEvent:0})},te=H=>{R(X=>({...X,tags:X.tags.includes(H)?X.tags.filter(q=>q!==H):[...X.tags,H]}))},le=H=>{var X;return((X=QS.find(q=>q.value===H))==null?void 0:X.label)||"Unknown"};return u?t.jsx("div",{className:"max-w-6xl mx-auto text-center py-12",children:t.jsx("div",{className:"text-gray-400",children:"Loading import lists..."})}):t.jsxs("div",{className:"max-w-6xl mx-auto",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Import Lists"}),t.jsx("p",{className:"text-gray-400",children:"Automatically discover and add events from external sources"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Import Lists"}),t.jsxs("button",{onClick:U,className:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[t.jsx(hr,{className:"w-4 h-4 mr-2"}),"Add Import List"]})]}),e.length===0?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("p",{className:"text-gray-500 mb-4",children:"No import lists configured"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Add an import list to automatically discover events from external sources"})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-gray-800",children:[t.jsx("th",{className:"text-left py-3 px-4 text-gray-400 font-medium",children:"Name"}),t.jsx("th",{className:"text-left py-3 px-4 text-gray-400 font-medium",children:"Type"}),t.jsx("th",{className:"text-left py-3 px-4 text-gray-400 font-medium",children:"Status"}),t.jsx("th",{className:"text-left py-3 px-4 text-gray-400 font-medium",children:"Last Sync"}),t.jsx("th",{className:"text-right py-3 px-4 text-gray-400 font-medium",children:"Actions"})]})}),t.jsx("tbody",{children:e.map(H=>t.jsxs("tr",{className:"border-b border-gray-800 hover:bg-gray-900/50 transition-colors",children:[t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("span",{className:"text-white font-medium",children:H.name}),!H.enabled&&t.jsx("span",{className:"ml-2 px-2 py-0.5 bg-gray-700 text-gray-400 text-xs rounded",children:"Disabled"})]})}),t.jsx("td",{className:"py-3 px-4 text-gray-300",children:le(H.listType)}),t.jsx("td",{className:"py-3 px-4",children:H.enabled?t.jsx("span",{className:"px-2 py-1 bg-green-900/30 text-green-400 text-xs rounded",children:"Enabled"}):t.jsx("span",{className:"px-2 py-1 bg-gray-700 text-gray-400 text-xs rounded",children:"Disabled"})}),t.jsx("td",{className:"py-3 px-4 text-sm text-gray-400",children:H.lastSync?new Date(H.lastSync).toLocaleDateString():"Never"}),t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[t.jsx("button",{onClick:()=>O(H.id),disabled:T===H.id,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors disabled:opacity-50",title:"Sync Now",children:t.jsx(Dt,{className:`w-5 h-5 ${T===H.id?"animate-spin":""}`})}),t.jsx("button",{onClick:()=>I(H),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",title:"Edit",children:t.jsx(an,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>S(H.id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-950/30 rounded transition-colors",title:"Delete",children:t.jsx(cs,{className:"w-5 h-5"})})]})})]},H.id))})]})})]}),b&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 overflow-y-auto",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-2xl w-full my-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-2xl font-bold text-white",children:g?"Edit Import List":"Add Import List"}),t.jsx("button",{onClick:()=>{v(!1),x(null)},className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"space-y-6 max-h-[70vh] overflow-y-auto pr-2",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Name *"}),t.jsx("input",{type:"text",value:E.name,onChange:H=>R({...E,name:H.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"e.g., Motorsport Schedule, Football Events"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"List Type *"}),t.jsx("select",{value:E.listType,onChange:H=>R({...E,listType:parseInt(H.target.value)}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:QS.map(H=>t.jsxs("option",{value:H.value,children:[H.label," - ",H.description]},H.value))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"URL *"}),t.jsx("input",{type:"text",value:E.url,onChange:H=>R({...E,url:H.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600 font-mono text-sm",placeholder:"https://example.com/events.rss"})]}),a&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"API Key (Optional)"}),t.jsx("input",{type:"password",value:E.apiKey||"",onChange:H=>R({...E,apiKey:H.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600 font-mono text-sm",placeholder:"API key if required"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Quality Profile *"}),t.jsx("select",{value:E.qualityProfileId,onChange:H=>R({...E,qualityProfileId:parseInt(H.target.value)}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:r.map(H=>t.jsx("option",{value:H.id,children:H.name},H.id))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Root Folder *"}),t.jsx("select",{value:E.rootFolderPath,onChange:H=>R({...E,rootFolderPath:H.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:o.map(H=>t.jsx("option",{value:H.path,children:H.path},H.id))})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:E.enabled,onChange:H=>R({...E,enabled:H.target.checked}),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Enable this import list"})]}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:E.monitorEvents,onChange:H=>R({...E,monitorEvents:H.target.checked}),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Monitor discovered events"})]}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:E.searchOnAdd,onChange:H=>R({...E,searchOnAdd:H.target.checked}),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Search for events on add"})]})]}),a&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Minimum Days Before Event"}),t.jsx("input",{type:"number",min:"0",value:E.minimumDaysBeforeEvent,onChange:H=>R({...E,minimumDaysBeforeEvent:parseInt(H.target.value)||0}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Only add events at least this many days in the future (0 = all future events)"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"League/Organization Filter (Optional)"}),t.jsx("input",{type:"text",value:E.organizationFilter||"",onChange:H=>R({...E,organizationFilter:H.target.value}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"e.g., Motorsport, Fighting Sports, Football"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Comma-separated leagues or organizations to filter (empty = all)"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tags (Optional)"}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[d.map(H=>t.jsx("button",{onClick:()=>te(H.id),className:`px-3 py-1 rounded text-sm transition-colors ${E.tags.includes(H.id)?"bg-red-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"}`,children:H.label},H.id)),d.length===0&&t.jsx("p",{className:"text-sm text-gray-500",children:"No tags available"})]})]})]}),t.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-800 flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>{v(!1),x(null)},className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:z,disabled:!E.name||!E.url,className:"px-4 py-2 bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:"Save"})]})]})}),w!==null&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-md w-full",children:[t.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Delete Import List?"}),t.jsx("p",{className:"text-gray-400 mb-6",children:"Are you sure you want to delete this import list? This action cannot be undone."}),t.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>S(null),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>D(w),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Delete"})]})]})})]})}const zI={qBittorrent:0,Transmission:1,Deluge:2,rTorrent:3,uTorrent:4,SABnzbd:5,NZBGet:6,Decypharr:7,DecypharrUsenet:8,NZBdav:9},XS={0:"qBittorrent",1:"Transmission",2:"Deluge",3:"rTorrent",4:"uTorrent",5:"SABnzbd",6:"NZBGet",7:"Decypharr",8:"DecypharrUsenet",9:"NZBdav"},Eg=a=>{const e=a===5||a===6||a===8||a===9?"usenet":"torrent";return console.log(`[DEBUG] getProtocol: type=${a}, protocol=${e}, type===5: ${a===5}, type===6: ${a===6}, type===8: ${a===8}, type===9: ${a===9}`),e},ZS=[{name:"SABnzbd",implementation:"SABnzbd",protocol:"usenet",description:"Open source binary newsreader",defaultPort:8080,fields:["host","port","useSsl","urlBase","apiKey","username","password","category","recentPriority","olderPriority","removeCompletedDownloads","removeFailedDownloads"]},{name:"NZBGet",implementation:"NZBGet",protocol:"usenet",description:"Efficient Usenet downloader",defaultPort:6789,fields:["host","port","useSsl","urlBase","username","password","category","recentPriority","olderPriority","removeCompletedDownloads","removeFailedDownloads"]},{name:"qBittorrent",implementation:"qBittorrent",protocol:"torrent",description:"Free and reliable torrent client",defaultPort:8080,fields:["host","port","useSsl","urlBase","username","password","category","postImportCategory","recentPriority","olderPriority","initialState","sequentialOrder","firstAndLast","removeCompletedDownloads","removeFailedDownloads"]},{name:"Transmission",implementation:"Transmission",protocol:"torrent",description:"Fast and easy torrent client",defaultPort:9091,fields:["host","port","useSsl","urlBase","username","password","category","removeCompletedDownloads","removeFailedDownloads"]},{name:"Deluge",implementation:"Deluge",protocol:"torrent",description:"Lightweight torrent client",defaultPort:8112,fields:["host","port","useSsl","urlBase","password","category","postImportCategory","recentPriority","olderPriority","removeCompletedDownloads","removeFailedDownloads"]},{name:"rTorrent",implementation:"rTorrent",protocol:"torrent",description:"Command-line torrent client",defaultPort:8080,fields:["host","port","useSsl","urlBase","username","password","category","postImportCategory","removeCompletedDownloads","removeFailedDownloads"]},{name:"Vuze",implementation:"Vuze",protocol:"torrent",description:"Feature-rich torrent client",defaultPort:9091,fields:["host","port","useSsl","urlBase","username","password","category","postImportCategory","recentPriority","olderPriority","removeCompletedDownloads","removeFailedDownloads"]},{name:"Decypharr",implementation:"Decypharr",protocol:"torrent",description:"Debrid download client (Real-Debrid, Torbox, etc.)",defaultPort:8282,fields:["host","port","useSsl","urlBase","sportarrUrl","sportarrApiKey","category","sequentialOrder","firstAndLast"]},{name:"DecypharrUsenet",implementation:"DecypharrUsenet",protocol:"usenet",description:"Debrid download client for usenet (experimental - requires Decypharr usenet branch)",defaultPort:8282,fields:["host","port","useSsl","urlBase","sportarrUrl","sportarrApiKey","category","sequentialOrder","firstAndLast"]},{name:"NZBdav",implementation:"NZBdav",protocol:"usenet",description:"Usenet streaming via WebDAV (SABnzbd-compatible API)",defaultPort:3e3,fields:["host","port","useSsl","urlBase","apiKey","category"]}];function qI({showAdvanced:a=!1}){const[e,s]=y.useState([]),[r,n]=y.useState(!1),[o,c]=y.useState(null),[d,f]=y.useState(null),[u,m]=y.useState(null),[g,x]=y.useState(!1),[b,v]=y.useState(null),[w,S]=y.useState([]),[T,k]=y.useState(!1),[E,R]=y.useState(null),[K,z]=y.useState(null),[D,O]=y.useState({host:"",remotePath:"",localPath:""});y.useEffect(()=>{U(),I(),nt()},[]);const U=async()=>{try{x(!0);const we=await at.get("/downloadclient");console.log("[DEBUG] Loaded download clients from API:",we.data),we.data.forEach(bt=>{console.log(`[DEBUG] Client: ${bt.name}, Type: ${bt.type}, Protocol: ${Eg(bt.type)}, UrlBase: ${bt.urlBase}`)}),s(we.data)}catch(we){console.error("Failed to load download clients:",we)}finally{x(!1)}},I=async()=>{try{const we=await kt("/api/settings");if(we.ok){const bt=await we.json(),ve={enableCompletedDownloadHandling:bt.enableCompletedDownloadHandling??!0,removeCompletedDownloadsGlobal:bt.removeCompletedDownloads??!0,checkForFinishedDownloads:bt.checkForFinishedDownloadInterval??1,enableFailedDownloadHandling:bt.enableFailedDownloadHandling??!0,redownloadFailedEvents:bt.redownloadFailedDownloads??!0,removeFailedDownloadsGlobal:bt.removeFailedDownloads??!0,maxDownloadQueueSize:bt.maxDownloadQueueSize??-1,searchSleepDuration:bt.searchSleepDuration??900};le(ve.enableCompletedDownloadHandling),X(ve.removeCompletedDownloadsGlobal),ae(ve.checkForFinishedDownloads),ee(ve.enableFailedDownloadHandling),Z(ve.redownloadFailedEvents),V(ve.removeFailedDownloadsGlobal),ye(ve.maxDownloadQueueSize),xe(ve.searchSleepDuration),ot.current=ve,Qe(!1)}}catch(we){console.error("Failed to load settings:",we)}},F=async()=>{Pe(!0);try{const we=await kt("/api/settings");if(!we.ok)throw new Error("Failed to fetch current settings");const ve={...await we.json(),enableCompletedDownloadHandling:te,removeCompletedDownloads:H,checkForFinishedDownloadInterval:q,enableFailedDownloadHandling:ce,redownloadFailedDownloads:G,removeFailedDownloads:W,maxDownloadQueueSize:oe,searchSleepDuration:je};await br("/api/settings",ve),ot.current={enableCompletedDownloadHandling:te,removeCompletedDownloadsGlobal:H,checkForFinishedDownloads:q,enableFailedDownloadHandling:ce,removeFailedDownloadsGlobal:W,redownloadFailedEvents:G,maxDownloadQueueSize:oe,searchSleepDuration:je},Qe(!1)}catch(we){console.error("Failed to save settings:",we),be.error("Save Failed",{description:"Failed to save settings. Please try again."})}finally{Pe(!1)}},[te,le]=y.useState(!0),[H,X]=y.useState(!0),[q,ae]=y.useState(1),[ce,ee]=y.useState(!0),[W,V]=y.useState(!0),[G,Z]=y.useState(!0),[oe,ye]=y.useState(-1),[je,xe]=y.useState(900),[Ee,Pe]=y.useState(!1),[Re,Qe]=y.useState(!1),ot=y.useRef(null);cl(Re),y.useEffect(()=>{if(!ot.current)return;const bt=JSON.stringify({enableCompletedDownloadHandling:te,removeCompletedDownloadsGlobal:H,checkForFinishedDownloads:q,enableFailedDownloadHandling:ce,removeFailedDownloadsGlobal:W,redownloadFailedEvents:G,maxDownloadQueueSize:oe,searchSleepDuration:je})!==JSON.stringify(ot.current);Qe(bt)},[te,H,q,ce,W,G,oe,je]);const[ne,ke]=y.useState({enabled:!0,priority:1,useSsl:!1,disableSslCertificateValidation:!1,category:"sportarr",type:0,name:"",host:"localhost",port:8080}),Be=we=>{m(we),v(null),ke({name:we.name,type:zI[we.implementation]??0,enabled:!0,priority:1,host:"localhost",port:we.defaultPort,useSsl:!1,disableSslCertificateValidation:!1,username:"",password:"",apiKey:"",category:"sportarr"})},qe=(we,bt)=>{ke(ve=>({...ve,[we]:bt}))},dt=async()=>{if(!(!ne.name||!ne.host))try{x(!0),console.log("[DEBUG] Saving download client with data:",ne),console.log("[DEBUG] UrlBase value being saved:",ne.urlBase),o?await at.put(`/downloadclient/${o.id}`,ne):await at.post("/downloadclient",ne),await U(),n(!1),c(null),m(null),v(null),ke({enabled:!0,priority:1,useSsl:!1,category:"sportarr",type:0,name:"",host:"localhost",port:8080})}catch(we){console.error("Failed to save download client:",we),be.error("Save Failed",{description:"Failed to save download client. Please check the console for details."})}finally{x(!1)}},He=we=>{console.log("[DEBUG] Editing client:",we),console.log("[DEBUG] Client urlBase:",we.urlBase),c(we),ke(we),console.log("[DEBUG] FormData after setFormData:",we),v(null);const bt=XS[we.type],ve=ZS.find(xt=>xt.implementation===bt);m(ve||null),n(!0)},Ce=async we=>{try{x(!0),await at.delete(`/downloadclient/${we}`),await U(),f(null)}catch(bt){console.error("Failed to delete download client:",bt),be.error("Delete Failed",{description:"Failed to delete download client. Please try again."})}finally{x(!1)}},[_e,ge]=y.useState(null),Ze=async(we,bt=!1)=>{var ve,xt;try{x(!0),"id"in we&&we.id&&ge(we.id),v(null);const me=await at.post("/downloadclient/test",we),De={success:me.data.success,message:me.data.message||"Connection successful!"};v(De),bt&&(De.success?be.success("Connection Test Passed",{description:De.message}):be.error("Connection Test Failed",{description:De.message}))}catch(me){console.error("Test failed:",me);const De={success:!1,message:((xt=(ve=me.response)==null?void 0:ve.data)==null?void 0:xt.message)||"Connection test failed!"};v(De),bt&&be.error("Connection Test Failed",{description:De.message})}finally{x(!1),ge(null)}},Me=()=>{n(!1),c(null),m(null),v(null),ke({enabled:!0,priority:1,useSsl:!1,category:"sportarr",type:0,name:"",host:"localhost",port:8080})},nt=async()=>{try{const we=await at.get("/remotepathmapping");S(we.data)}catch(we){console.error("Failed to load path mappings:",we)}},ht=()=>{R(null),O({host:"",remotePath:"",localPath:""}),k(!0)},Oe=we=>{R(we),O({host:we.host,remotePath:we.remotePath,localPath:we.localPath}),k(!0)},tt=async()=>{try{x(!0),E?await at.put(`/remotepathmapping/${E.id}`,D):await at.post("/remotepathmapping",D),await nt(),k(!1),O({host:"",remotePath:"",localPath:""})}catch(we){console.error("Failed to save path mapping:",we),be.error("Save Failed",{description:"Failed to save path mapping. Please try again."})}finally{x(!1)}},Ct=async we=>{try{await at.delete(`/remotepathmapping/${we}`),await nt(),z(null)}catch(bt){console.error("Failed to delete path mapping:",bt),be.error("Delete Failed",{description:"Failed to delete path mapping. Please try again."})}};return t.jsxs("div",{children:[t.jsx(Rn,{title:"Download Clients",subtitle:"Configure download clients for Usenet and torrent downloads",onSave:F,isSaving:Ee,hasUnsavedChanges:Re,saveButtonText:"Save Changes"}),t.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[t.jsx("div",{className:"mb-8 bg-blue-950/30 border border-blue-900/50 rounded-lg p-6",children:t.jsxs("div",{className:"flex items-start",children:[t.jsx(qs,{className:"w-6 h-6 text-blue-400 mr-3 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"About Download Clients"}),t.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"Usenet Clients:"})," SABnzbd, NZBGet"]})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"Torrent Clients:"})," qBittorrent, Transmission, Deluge, rTorrent, uTorrent"]})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"Debrid/Proxy:"})," Decypharr (supports both torrents and usenet)"]})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"Priority:"})," Lower priority clients are used as fallback"]})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:""}),t.jsxs("span",{children:["Use ",t.jsx("strong",{children:"categories"})," to organize downloads and allow proper hardlinking"]})]})]})]})]})}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Your Download Clients"}),t.jsxs("button",{onClick:()=>n(!0),className:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[t.jsx(hr,{className:"w-4 h-4 mr-2"}),"Add Download Client"]})]}),t.jsx("div",{className:"space-y-3",children:e.map(we=>t.jsx("div",{className:"group bg-black/30 border border-gray-800 hover:border-red-900/50 rounded-lg p-4 transition-all",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[t.jsx("div",{className:"mt-1",children:we.enabled?t.jsx(rs,{className:"w-6 h-6 text-green-500"}):t.jsx(Ss,{className:"w-6 h-6 text-gray-500"})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:we.name}),t.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${Eg(we.type)==="usenet"?"bg-blue-900/30 text-blue-400":"bg-green-900/30 text-green-400"}`,children:Eg(we.type).toUpperCase()}),t.jsxs("span",{className:"px-2 py-0.5 bg-gray-800 text-gray-400 text-xs rounded",children:["Priority: ",we.priority]})]}),t.jsxs("div",{className:"space-y-1 text-sm text-gray-400",children:[t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-500",children:"Implementation:"})," ",t.jsx("span",{className:"text-white",children:XS[we.type]})]}),t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-500",children:"Host:"})," ",t.jsxs("span",{className:"text-white",children:[we.host,":",we.port]})]}),we.category&&t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-500",children:"Category:"})," ",t.jsx("span",{className:"text-white",children:we.category})]})]})]})]}),t.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[t.jsx("button",{onClick:()=>Ze(we,!0),disabled:_e===we.id,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Test Connection",children:_e===we.id?t.jsxs("svg",{className:"w-5 h-5 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):t.jsx(rs,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>He(we),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",title:"Edit",children:t.jsx(an,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>f(we.id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-950/30 rounded transition-colors",title:"Delete",children:t.jsx(cs,{className:"w-5 h-5"})})]})]})},we.id))}),e.length===0&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx(qs,{className:"w-16 h-16 text-gray-700 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500 mb-2",children:"No download clients configured"}),t.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Add at least one download client to download combat sports events"})]})]}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Completed Download Handling"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:te,onChange:we=>le(we.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Enable"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Automatically import completed downloads from download clients"})]})]}),te&&t.jsxs(t.Fragment,{children:[t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:H,onChange:we=>X(we.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Remove Completed Downloads"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Remove completed downloads from download client history"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Check For Finished Downloads Interval"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"number",value:q,onChange:we=>ae(Number(we.target.value)),className:"w-32 px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",min:"1"}),t.jsx("span",{className:"text-gray-400",children:"minute(s)"})]}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"How often Sportarr will check download clients for completed downloads"})]})]})]})]}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Failed Download Handling"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:ce,onChange:we=>ee(we.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Enable"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Automatically handle failed downloads"})]})]}),ce&&t.jsxs(t.Fragment,{children:[t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:G,onChange:we=>Z(we.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Redownload"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Automatically search for and attempt to download a different release"})]})]}),t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:W,onChange:we=>V(we.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Remove Failed Downloads"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Remove failed downloads from download client history"})]})]})]})]})]}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Search Queue Management"}),t.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Control automatic searching behavior when your download queue is busy. Prevents overwhelming indexers and download clients."}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Maximum Download Queue Size"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"number",value:oe,onChange:we=>ye(Number(we.target.value)),className:"w-32 px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",min:"-1"}),t.jsx("span",{className:"text-gray-400",children:"items"})]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Pause automatic searches when download queue exceeds this size. Set to -1 to disable (no limit)."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Search Sleep Duration"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"number",value:je,onChange:we=>xe(Number(we.target.value)),className:"w-32 px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",min:"60"}),t.jsx("span",{className:"text-gray-400",children:"seconds"})]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Time between automatic search cycles. Default is 900 seconds (15 minutes)."})]})]})]}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Remote Path Mappings"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Map download client paths to Sportarr paths (required for Docker/remote clients)"})]}),t.jsxs("button",{onClick:ht,className:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors text-sm",children:[t.jsx(hr,{className:"w-4 h-4 mr-2"}),"Add Mapping"]})]}),w.length>0?t.jsx("div",{className:"space-y-3",children:w.map(we=>t.jsx("div",{className:"bg-gray-900/50 border border-gray-800 rounded-lg p-4 hover:border-gray-700 transition-colors",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsx("div",{className:"flex-1 space-y-2",children:t.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Host:"}),t.jsx("p",{className:"text-white mt-1",children:we.host})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Remote Path:"}),t.jsx("p",{className:"text-white mt-1 font-mono text-xs break-all",children:we.remotePath})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Local Path:"}),t.jsx("p",{className:"text-white mt-1 font-mono text-xs break-all",children:we.localPath})]})]})}),t.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[t.jsx("button",{onClick:()=>Oe(we),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",title:"Edit",children:t.jsx(an,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>z(we.id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-950/30 rounded transition-colors",title:"Delete",children:t.jsx(cs,{className:"w-5 h-5"})})]})]})},we.id))}):t.jsxs("div",{className:"text-center py-8 text-gray-500",children:[t.jsx("p",{children:"No remote path mappings configured"}),t.jsx("p",{className:"text-sm mt-2",children:"Only needed if download client is on a different system or in Docker"})]})]}),r&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 overflow-y-auto",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-4xl w-full my-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-2xl font-bold text-white",children:o?`Edit ${o.name}`:"Add Download Client"}),t.jsx("button",{onClick:Me,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),!u&&!o?t.jsxs(t.Fragment,{children:[t.jsx("p",{className:"text-gray-400 mb-6",children:"Select a download client type to configure"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-96 overflow-y-auto",children:ZS.map(we=>t.jsxs("button",{onClick:()=>Be(we),className:"flex items-start p-4 bg-black/30 border border-gray-800 hover:border-red-600 rounded-lg transition-all text-left group",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[t.jsx("h4",{className:"text-white font-semibold",children:we.name}),t.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${we.protocol==="usenet"?"bg-blue-900/30 text-blue-400":"bg-green-900/30 text-green-400"}`,children:we.protocol.toUpperCase()})]}),t.jsx("p",{className:"text-sm text-gray-400",children:we.description})]}),t.jsx(hr,{className:"w-5 h-5 text-gray-400 group-hover:text-red-400 transition-colors"})]},we.implementation))})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"max-h-[60vh] overflow-y-auto pr-2 space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Name *"}),t.jsx("input",{type:"text",value:ne.name||"",onChange:we=>qe("name",we.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"My Download Client"})]}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:ne.enabled||!1,onChange:we=>qe("enabled",we.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Enable this download client"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:"Connection"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Host *"}),t.jsx("input",{type:"text",value:ne.host||"",onChange:we=>qe("host",we.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"localhost"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Port *"}),t.jsx("input",{type:"number",value:ne.port||"",onChange:we=>qe("port",parseInt(we.target.value)),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"8080"})]})]}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:ne.useSsl||!1,onChange:we=>qe("useSsl",we.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Use SSL"})]}),ne.useSsl&&t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:ne.disableSslCertificateValidation||!1,onChange:we=>qe("disableSslCertificateValidation",we.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Disable SSL Certificate Validation"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Allows connections with self-signed certificates. Only enable this for local networks."})]})]}),(u==null?void 0:u.fields.includes("urlBase"))&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"URL Base"}),t.jsx("input",{type:"text",value:ne.urlBase||"",onChange:we=>qe("urlBase",we.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:u.name==="SABnzbd"||u.name==="NZBGet"?"Leave empty for default (root)":u.name==="Transmission"?"/transmission":u.name==="Deluge"?"Leave empty for default (root)":u.name==="rTorrent"?"/rutorrent":u.name==="qBittorrent"?"Leave empty for default (root)":""}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[u.name==="SABnzbd"&&"URL base configured in SABnzbd. Default is root (leave empty). Use /sabnzbd only if configured in SABnzbd settings.",u.name==="NZBGet"&&"URL base for NZBGet web interface. Default is root (leave empty). Use /nzbget only if configured in NZBGet settings.",u.name==="qBittorrent"&&"URL path prefix for qBittorrent Web UI. Default is root (leave empty). Set only if configured in qBittorrent settings.",u.name==="Transmission"&&"RPC URL path for Transmission. Default is /transmission. Leave empty only if you changed it in Transmission settings.",u.name==="Deluge"&&"Base URL for Deluge web interface. Default is root (leave empty). Use /deluge only if configured in Deluge settings.",u.name==="rTorrent"&&"URL base for ruTorrent web interface. Default is /rutorrent. Leave empty only if you changed it in ruTorrent settings.",u.name==="Vuze"&&"URL base for Vuze web interface. Default is root (leave empty)."]})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:"Authentication"}),(u==null?void 0:u.fields.includes("apiKey"))&&t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["API Key ",o?"":"*"]}),t.jsx("input",{type:"password",value:ne.apiKey||"",onChange:we=>qe("apiKey",we.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:o?"Leave blank to keep existing API key":"Enter API key"}),o&&t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank to keep the existing API key, or enter a new one to update it"})]}),(u==null?void 0:u.fields.includes("username"))&&t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Username"}),t.jsx("input",{type:"text",value:ne.username||"",onChange:we=>qe("username",we.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"username"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),t.jsx("input",{type:"password",value:ne.password||"",onChange:we=>qe("password",we.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:o?"Leave blank to keep existing":"password"})]})]}),(u==null?void 0:u.fields.includes("password"))&&!(u!=null&&u.fields.includes("username"))&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),t.jsx("input",{type:"password",value:ne.password||"",onChange:we=>qe("password",we.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:o?"Leave blank to keep existing":"password"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:u.name==="Deluge"&&"Deluge web interface password (configured in Deluge preferences)"})]}),(u==null?void 0:u.fields.includes("sportarrUrl"))&&t.jsx("div",{className:"grid grid-cols-1 gap-4",children:t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Sportarr URL",t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("input",{type:"text",value:ne.username||"",onChange:we=>qe("username",we.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"http://localhost:5000"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Full URL to your Sportarr instance (used by Decypharr for callbacks). Must include http:// or https://"})]})}),(u==null?void 0:u.fields.includes("sportarrApiKey"))&&t.jsx("div",{className:"grid grid-cols-1 gap-4",children:t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Sportarr API Key",t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("input",{type:"password",value:ne.password||"",onChange:we=>qe("password",we.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:o?"Leave blank to keep existing":"Your Sportarr API key"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Found in Sportarr Settings  General  Security  API Key. Required for Decypharr callbacks."})]})})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:"Category"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Category"}),t.jsx("input",{type:"text",value:ne.category||"",onChange:we=>qe("category",we.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"sportarr"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Category for downloads (creates subdirectory in download client)"})]}),(u==null?void 0:u.fields.includes("postImportCategory"))&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Post-Import Category"}),t.jsx("input",{type:"text",value:ne.postImportCategory||"",onChange:we=>qe("postImportCategory",we.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"sportarr-imported"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Category to move downloads to after successful import. Leave empty to keep original category. Useful for automated torrent management (e.g., move imported files to different storage tier)."})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:"Priority"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Client Priority"}),t.jsx("input",{type:"number",value:ne.priority||1,onChange:we=>qe("priority",parseInt(we.target.value)),min:"1",max:"50",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Priority when choosing between download clients (1-50, lower is higher priority)"})]})]}),(u==null?void 0:u.fields.includes("sequentialOrder"))&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:"Download Options"}),t.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"These options control how torrent pieces are downloaded."}),t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:ne.sequentialDownload||!1,onChange:we=>qe("sequentialDownload",we.target.checked),className:"mt-1 w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Sequential Download"}),t.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Download pieces in order (first to last). Useful for streaming while downloading."}),t.jsxs("p",{className:"text-xs text-yellow-500 mt-1",children:[" ",t.jsx("strong",{children:"Decypharr users:"})," Leave this DISABLED. Enabling causes Decypharr to download full files instead of creating symlinks, which fills up /storage/symlinks and breaks functionality."]})]})]}),t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:ne.firstAndLastFirst||!1,onChange:we=>qe("firstAndLastFirst",we.target.checked),className:"mt-1 w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"First and Last Pieces First"}),t.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Prioritize first and last pieces for quick video preview while downloading."})]})]})]})]}),b&&t.jsx("div",{className:`mt-4 p-4 rounded-lg border ${b.success?"bg-green-950/30 border-green-900/50":"bg-red-950/30 border-red-900/50"}`,children:t.jsxs("div",{className:"flex items-center space-x-2",children:[b.success?t.jsx(rs,{className:"w-5 h-5 text-green-400"}):t.jsx(Ss,{className:"w-5 h-5 text-red-400"}),t.jsx("span",{className:b.success?"text-green-300":"text-red-300",children:b.message})]})}),t.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-800 flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:Me,className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",disabled:g,children:"Cancel"}),t.jsx("button",{onClick:()=>Ze(ne),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:g,children:g?"Testing...":"Test"}),t.jsx("button",{onClick:dt,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:g,children:g?"Saving...":"Save"})]})]})]})}),d!==null&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-md w-full",children:[t.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Delete Download Client?"}),t.jsx("p",{className:"text-gray-400 mb-6",children:"Are you sure you want to delete this download client? This action cannot be undone."}),t.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>f(null),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>Ce(d),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Delete"})]})]})}),T&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-2xl w-full",children:[t.jsx("h3",{className:"text-2xl font-bold text-white mb-6",children:E?"Edit Remote Path Mapping":"Add Remote Path Mapping"}),t.jsxs("div",{className:"space-y-4 mb-6",children:[t.jsxs("div",{className:"bg-blue-950/30 border border-blue-900/50 rounded-lg p-4",children:[t.jsxs("p",{className:"text-sm text-blue-300",children:[t.jsx("strong",{children:"When to use:"})," If your download client is on a different machine or in Docker, the paths it reports may not match where Sportarr can access them. This mapping translates the download client's path to the path Sportarr should use."]}),t.jsxs("p",{className:"text-sm text-blue-300 mt-2",children:[t.jsx("strong",{children:"Example:"})," Download client reports ",t.jsx("code",{className:"bg-blue-900/30 px-1 rounded",children:"/downloads/complete/"}),"but Sportarr accesses it at ",t.jsx("code",{className:"bg-blue-900/30 px-1 rounded",children:"\\\\192.168.1.100\\downloads\\complete\\"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-white font-medium mb-2",children:["Host",t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("input",{type:"text",value:D.host,onChange:we=>O({...D,host:we.target.value}),placeholder:"localhost, 192.168.1.100, or download-client-hostname",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Download client host name or IP address (must match the download client's configured host)"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-white font-medium mb-2",children:["Remote Path",t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("input",{type:"text",value:D.remotePath,onChange:we=>O({...D,remotePath:we.target.value}),placeholder:"/downloads/complete/sportarr/ or C:\\Downloads\\Complete\\Sportarr\\",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600 font-mono text-sm"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Path as reported by the download client (use forward slashes for Linux/Docker paths)"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-white font-medium mb-2",children:["Local Path",t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("input",{type:"text",value:D.localPath,onChange:we=>O({...D,localPath:we.target.value}),placeholder:"\\\\192.168.1.100\\downloads\\complete\\sportarr\\ or /mnt/downloads/complete/sportarr/",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600 font-mono text-sm"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Path that Sportarr should use to access the same location"})]})]}),t.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>k(!1),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:tt,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:!D.host||!D.remotePath||!D.localPath,children:"Save"})]})]})}),K!==null&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-md w-full",children:[t.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Delete Path Mapping?"}),t.jsx("p",{className:"text-gray-400 mb-6",children:"Are you sure you want to delete this remote path mapping? This action cannot be undone."}),t.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>z(null),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>Ct(K),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Delete"})]})]})})]})]})}const JS=[{name:"Discord",implementation:"Discord",description:"Send notifications via Discord webhook",icon:"",fields:["webhook","username","onGrab","onDownload","onUpgrade","onHealthIssue","onApplicationUpdate"]},{name:"Telegram",implementation:"Telegram",description:"Send notifications via Telegram bot",icon:"",fields:["token","chatId","onGrab","onDownload","onUpgrade","onHealthIssue","onApplicationUpdate"]},{name:"Email (SMTP)",implementation:"Email",description:"Send notifications via email",icon:"",fields:["server","port","useSsl","username","password","from","to","subject","onGrab","onDownload","onUpgrade","onHealthIssue","onApplicationUpdate"]},{name:"Webhook",implementation:"Webhook",description:"Send JSON POST to custom URL",icon:"",fields:["webhook","onGrab","onDownload","onUpgrade","onRename","onHealthIssue","onApplicationUpdate"]},{name:"Pushover",implementation:"Pushover",description:"Send push notifications via Pushover",icon:"",fields:["userKey","apiToken","devices","priority","sound","retry","expire","onGrab","onDownload","onUpgrade","onHealthIssue","onApplicationUpdate"]},{name:"Slack",implementation:"Slack",description:"Send notifications to Slack channel",icon:"",fields:["webhook","username","channel","onGrab","onDownload","onUpgrade","onHealthIssue","onApplicationUpdate"]}];function KI({showAdvanced:a=!1}){const[e,s]=y.useState([]),[r,n]=y.useState(!0),[o,c]=y.useState(!1),[d,f]=y.useState(null),[u,m]=y.useState(null),[g,x]=y.useState(null);y.useEffect(()=>{b()},[]);const b=async()=>{try{const F=await kt("/api/notification");if(F.ok){const le=(await F.json()).map(H=>({...H,...H.configJson?JSON.parse(H.configJson):{}}));s(le)}}catch(F){console.error("Failed to fetch notifications:",F)}finally{n(!1)}},[v,w]=y.useState({enabled:!0,onGrab:!0,onDownload:!0,onUpgrade:!1,onRename:!1,onHealthIssue:!0,onApplicationUpdate:!1,includeHealthWarnings:!1,useSsl:!0,port:587,priority:0,sound:"pushover",retry:60,expire:3600}),S=F=>{x(F),w({name:F.name,implementation:F.implementation,enabled:!0,onGrab:!0,onDownload:!0,onUpgrade:!1,onRename:!1,onHealthIssue:!0,onApplicationUpdate:!1,includeHealthWarnings:!1,useSsl:F.implementation==="Email",port:F.implementation==="Email"?587:void 0,priority:F.implementation==="Pushover"?0:void 0,sound:F.implementation==="Pushover"?"pushover":void 0,retry:F.implementation==="Pushover"?60:void 0,expire:F.implementation==="Pushover"?3600:void 0})},T=(F,te)=>{w(le=>({...le,[F]:te}))},k=async()=>{if(v.name)try{const{id:F,name:te,implementation:le,enabled:H,...X}=v,ae={name:te||"",implementation:le||"",enabled:H??!0,configJson:JSON.stringify(X)};if(d)if((await br(`/api/notification/${d.id}`,{...ae,id:d.id})).ok)await b();else return;else if((await ds("/api/notification",ae)).ok)await b();else return;c(!1),f(null),x(null),w({enabled:!0,onGrab:!0,onDownload:!0,onUpgrade:!1,onRename:!1,onHealthIssue:!0,onApplicationUpdate:!1,includeHealthWarnings:!1})}catch(F){console.error("Failed to save notification:",F)}},E=F=>{f(F),w(F);const te=JS.find(le=>le.implementation===F.implementation);x(te||null),c(!0)},R=async F=>{try{(await Na(`/api/notification/${F}`)).ok&&(await b(),m(null))}catch(te){console.error("Failed to delete notification:",te)}},[K,z]=y.useState(!1),[D,O]=y.useState(null),U=async F=>{z(!0),O(null);try{const{id:te,name:le,implementation:H,enabled:X,...q}=F,ae={id:te||0,name:le||"",implementation:H||"",enabled:X??!0,configJson:JSON.stringify(q)},ce=te?await ds(`/api/notification/${te}/test`,{}):await ds("/api/notification/test",ae),ee=await ce.json();ce.ok?O({success:!0,message:ee.message||"Notification sent successfully!"}):O({success:!1,message:ee.message||"Failed to send notification"})}catch(te){O({success:!1,message:te.message||"Error testing notification"})}finally{z(!1)}},I=()=>{c(!1),f(null),x(null),O(null),w({enabled:!0,onGrab:!0,onDownload:!0,onUpgrade:!1,onRename:!1,onHealthIssue:!0,onApplicationUpdate:!1,includeHealthWarnings:!1})};return t.jsxs("div",{className:"max-w-6xl mx-auto",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Connect (Notifications)"}),t.jsx("p",{className:"text-gray-400",children:"Configure notifications and connections to other services"})]}),t.jsx("div",{className:"mb-8 bg-blue-950/30 border border-blue-900/50 rounded-lg p-6",children:t.jsxs("div",{className:"flex items-start",children:[t.jsx(fg,{className:"w-6 h-6 text-blue-400 mr-3 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"About Notifications"}),t.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"On Grab:"})," Notification sent when an event is grabbed for download"]})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"On Download:"})," Notification sent when an event finishes downloading"]})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"On Upgrade:"})," Notification sent when a better quality version is downloaded"]})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"On Health Issue:"})," Notification sent for system health warnings/errors"]})]})]})]})]})}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Your Notifications"}),t.jsxs("button",{onClick:()=>c(!0),className:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[t.jsx(hr,{className:"w-4 h-4 mr-2"}),"Add Notification"]})]}),t.jsx("div",{className:"space-y-3",children:e.map(F=>t.jsx("div",{className:"group bg-black/30 border border-gray-800 hover:border-red-900/50 rounded-lg p-4 transition-all",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[t.jsx("div",{className:"mt-1",children:F.enabled?t.jsx(rs,{className:"w-6 h-6 text-green-500"}):t.jsx(qt,{className:"w-6 h-6 text-gray-500"})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:F.name}),t.jsx("span",{className:"px-2 py-0.5 bg-purple-900/30 text-purple-400 text-xs rounded",children:F.implementation})]}),t.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[F.onGrab&&t.jsx("span",{className:"px-2 py-1 bg-blue-900/30 text-blue-400 rounded",children:"On Grab"}),F.onDownload&&t.jsx("span",{className:"px-2 py-1 bg-green-900/30 text-green-400 rounded",children:"On Download"}),F.onUpgrade&&t.jsx("span",{className:"px-2 py-1 bg-yellow-900/30 text-yellow-400 rounded",children:"On Upgrade"}),F.onRename&&t.jsx("span",{className:"px-2 py-1 bg-purple-900/30 text-purple-400 rounded",children:"On Rename"}),F.onHealthIssue&&t.jsx("span",{className:"px-2 py-1 bg-red-900/30 text-red-400 rounded",children:"Health Issues"}),F.onApplicationUpdate&&t.jsx("span",{className:"px-2 py-1 bg-cyan-900/30 text-cyan-400 rounded",children:"App Updates"})]})]})]}),t.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[t.jsx("button",{onClick:()=>U(F),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",title:"Test",children:t.jsx(fg,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>E(F),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",title:"Edit",children:t.jsx(an,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>m(F.id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-950/30 rounded transition-colors",title:"Delete",children:t.jsx(cs,{className:"w-5 h-5"})})]})]})},F.id))}),e.length===0&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx(fg,{className:"w-16 h-16 text-gray-700 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500 mb-2",children:"No notifications configured"}),t.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Add notification connections to get alerts about downloads and system events"})]})]}),o&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 overflow-y-auto",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-4xl w-full my-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-2xl font-bold text-white",children:d?`Edit ${d.name}`:"Add Notification"}),t.jsx("button",{onClick:I,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),!g&&!d?t.jsxs(t.Fragment,{children:[t.jsx("p",{className:"text-gray-400 mb-6",children:"Select a notification service to configure"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-96 overflow-y-auto",children:JS.map(F=>t.jsxs("button",{onClick:()=>S(F),className:"flex items-start p-4 bg-black/30 border border-gray-800 hover:border-red-600 rounded-lg transition-all text-left group",children:[t.jsx("div",{className:"text-3xl mr-4",children:F.icon}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"text-white font-semibold mb-1",children:F.name}),t.jsx("p",{className:"text-sm text-gray-400",children:F.description})]}),t.jsx(hr,{className:"w-5 h-5 text-gray-400 group-hover:text-red-400 transition-colors"})]},F.implementation))})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"max-h-[60vh] overflow-y-auto pr-2 space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Name *"}),t.jsx("input",{type:"text",value:v.name||"",onChange:F=>T("name",F.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"My Notification"})]}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:v.enabled||!1,onChange:F=>T("enabled",F.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Enable this notification"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:"Connection"}),(g==null?void 0:g.fields.includes("webhook"))&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Webhook URL *"}),t.jsx("input",{type:"url",value:v.webhook||"",onChange:F=>T("webhook",F.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"https://discord.com/api/webhooks/..."})]}),(g==null?void 0:g.fields.includes("token"))&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Bot Token *"}),t.jsx("input",{type:"password",value:v.token||"",onChange:F=>T("token",F.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"Your bot token"})]}),(g==null?void 0:g.fields.includes("chatId"))&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Chat ID *"}),t.jsx("input",{type:"text",value:v.chatId||"",onChange:F=>T("chatId",F.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"123456789"})]}),(g==null?void 0:g.fields.includes("apiKey"))&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"API Key *"}),t.jsx("input",{type:"password",value:v.apiKey||"",onChange:F=>T("apiKey",F.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"Your API key"})]}),(g==null?void 0:g.fields.includes("userKey"))&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"User Key *"}),t.jsx("input",{type:"text",value:v.userKey||"",onChange:F=>T("userKey",F.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"Your Pushover User Key (from pushover.net dashboard)"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Found on your Pushover dashboard at pushover.net"})]}),(g==null?void 0:g.fields.includes("apiToken"))&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"API Token *"}),t.jsx("input",{type:"password",value:v.apiToken||"",onChange:F=>T("apiToken",F.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"Your Pushover Application API Token"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Create an application at pushover.net/apps to get an API token"})]}),(g==null?void 0:g.fields.includes("devices"))&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Devices"}),t.jsx("input",{type:"text",value:v.devices||"",onChange:F=>T("devices",F.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"Leave empty for all devices, or comma-separate device names"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Optional: Target specific devices by name (comma-separated)"})]}),(g==null?void 0:g.fields.includes("priority"))&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Priority"}),t.jsxs("select",{value:v.priority??0,onChange:F=>T("priority",parseInt(F.target.value)),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:-2,children:"Lowest (no sound/vibration)"}),t.jsx("option",{value:-1,children:"Low (quiet hours respected)"}),t.jsx("option",{value:0,children:"Normal"}),t.jsx("option",{value:1,children:"High (bypasses quiet hours)"}),t.jsx("option",{value:2,children:"Emergency (requires acknowledgment)"})]})]}),(g==null?void 0:g.fields.includes("sound"))&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Sound"}),t.jsxs("select",{value:v.sound||"pushover",onChange:F=>T("sound",F.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"pushover",children:"Pushover (default)"}),t.jsx("option",{value:"bike",children:"Bike"}),t.jsx("option",{value:"bugle",children:"Bugle"}),t.jsx("option",{value:"cashregister",children:"Cash Register"}),t.jsx("option",{value:"classical",children:"Classical"}),t.jsx("option",{value:"cosmic",children:"Cosmic"}),t.jsx("option",{value:"falling",children:"Falling"}),t.jsx("option",{value:"gamelan",children:"Gamelan"}),t.jsx("option",{value:"incoming",children:"Incoming"}),t.jsx("option",{value:"intermission",children:"Intermission"}),t.jsx("option",{value:"magic",children:"Magic"}),t.jsx("option",{value:"mechanical",children:"Mechanical"}),t.jsx("option",{value:"pianobar",children:"Piano Bar"}),t.jsx("option",{value:"siren",children:"Siren"}),t.jsx("option",{value:"spacealarm",children:"Space Alarm"}),t.jsx("option",{value:"tugboat",children:"Tugboat"}),t.jsx("option",{value:"alien",children:"Alien Alarm (long)"}),t.jsx("option",{value:"climb",children:"Climb (long)"}),t.jsx("option",{value:"persistent",children:"Persistent (long)"}),t.jsx("option",{value:"echo",children:"Pushover Echo (long)"}),t.jsx("option",{value:"updown",children:"Up Down (long)"}),t.jsx("option",{value:"vibrate",children:"Vibrate Only"}),t.jsx("option",{value:"none",children:"None (silent)"})]})]}),(g==null?void 0:g.fields.includes("retry"))&&v.priority===2&&t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Retry (seconds) *"}),t.jsx("input",{type:"number",value:v.retry||60,onChange:F=>T("retry",parseInt(F.target.value)),min:30,className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"60"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"How often to retry (min 30 seconds)"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Expire (seconds) *"}),t.jsx("input",{type:"number",value:v.expire||3600,onChange:F=>T("expire",parseInt(F.target.value)),max:10800,className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"3600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Stop retrying after (max 3 hours)"})]})]}),(g==null?void 0:g.fields.includes("server"))&&t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"SMTP Server *"}),t.jsx("input",{type:"text",value:v.server||"",onChange:F=>T("server",F.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"smtp.gmail.com"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Port *"}),t.jsx("input",{type:"number",value:v.port||"",onChange:F=>T("port",parseInt(F.target.value)),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"587"})]})]}),(g==null?void 0:g.fields.includes("from"))&&t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"From *"}),t.jsx("input",{type:"email",value:v.from||"",onChange:F=>T("from",F.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"sportarr@example.com"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"To *"}),t.jsx("input",{type:"email",value:v.to||"",onChange:F=>T("to",F.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"you@example.com"})]})]}),(g==null?void 0:g.fields.includes("channel"))&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Channel"}),t.jsx("input",{type:"text",value:v.channel||"",onChange:F=>T("channel",F.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"#general"})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:"Notification Triggers"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-3 bg-black/30 rounded-lg hover:bg-black/50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:v.onGrab||!1,onChange:F=>T("onGrab",F.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"On Grab"})]}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-3 bg-black/30 rounded-lg hover:bg-black/50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:v.onDownload||!1,onChange:F=>T("onDownload",F.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"On Download"})]}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-3 bg-black/30 rounded-lg hover:bg-black/50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:v.onUpgrade||!1,onChange:F=>T("onUpgrade",F.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"On Upgrade"})]}),(g==null?void 0:g.fields.includes("onRename"))&&t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-3 bg-black/30 rounded-lg hover:bg-black/50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:v.onRename||!1,onChange:F=>T("onRename",F.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"On Rename"})]}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-3 bg-black/30 rounded-lg hover:bg-black/50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:v.onHealthIssue||!1,onChange:F=>T("onHealthIssue",F.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"On Health Issue"})]}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-3 bg-black/30 rounded-lg hover:bg-black/50 transition-colors",children:[t.jsx("input",{type:"checkbox",checked:v.onApplicationUpdate||!1,onChange:F=>T("onApplicationUpdate",F.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"On App Update"})]})]})]})]}),D&&t.jsx("div",{className:`mt-4 p-3 rounded-lg ${D.success?"bg-green-900/30 border border-green-700 text-green-400":"bg-red-900/30 border border-red-700 text-red-400"}`,children:t.jsxs("div",{className:"flex items-center",children:[D.success?t.jsx(rs,{className:"w-5 h-5 mr-2"}):t.jsx(qt,{className:"w-5 h-5 mr-2"}),t.jsx("span",{children:D.message})]})}),t.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-800 flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:I,className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>U(v),disabled:K,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors flex items-center",children:K?t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Testing..."]}):"Test"}),t.jsx("button",{onClick:k,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Save"})]})]})]})}),u!==null&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-md w-full",children:[t.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Delete Notification?"}),t.jsx("p",{className:"text-gray-400 mb-6",children:"Are you sure you want to delete this notification connection? This action cannot be undone."}),t.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>m(null),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>R(u),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Delete"})]})]})})]})}function YI({showAdvanced:a=!1}){var te,le,H;Ta();const[e,s]=y.useState(!0),[r,n]=y.useState(!1),[o,c]=y.useState(!1),[d,f]=y.useState(!1),u=y.useRef(null);cl(d);const[m,g]=y.useState({bindAddress:"*",port:1867,urlBase:"",instanceName:"Sportarr",launchBrowser:!1,enableSsl:!1,sslPort:1868,sslCertPath:"",sslCertPassword:""}),[x,b]=y.useState({authenticationMethod:"none",authenticationRequired:"disabledforlocaladdresses",username:"",password:"",apiKey:"d290f1ee-6c54-4b01-90e6-d701748f0851",certificateValidation:"enabled"}),[v,w]=y.useState({useProxy:!1,proxyType:"http",proxyHostname:"",proxyPort:8080,proxyUsername:"",proxyPassword:"",proxyBypassFilter:"",proxyBypassLocalAddresses:!0}),[S,T]=y.useState({logLevel:"info"}),[k,E]=y.useState({sendAnonymousUsageData:!1}),[R,K]=y.useState({backupFolder:"",backupInterval:7,backupRetention:28}),[z,D]=y.useState({branch:"main",updateAutomatically:!1,updateMechanism:"docker",updateScriptPath:""});y.useEffect(()=>{O()},[]),y.useEffect(()=>{if(!u.current)return;const q=JSON.stringify({host:m,security:x,proxy:v,logging:S,analytics:k,backup:R,update:z})!==JSON.stringify(u.current);f(q)},[m,x,v,S,k,R,z]);const O=async()=>{try{const X=await kt("/api/settings");if(X.ok){const q=await X.json(),ae={host:q.hostSettings?JSON.parse(q.hostSettings):null,security:q.securitySettings?JSON.parse(q.securitySettings):null,proxy:q.proxySettings?JSON.parse(q.proxySettings):null,logging:q.loggingSettings?JSON.parse(q.loggingSettings):null,analytics:q.analyticsSettings?JSON.parse(q.analyticsSettings):null,backup:q.backupSettings?JSON.parse(q.backupSettings):null,update:q.updateSettings?JSON.parse(q.updateSettings):null};ae.host&&g(ae.host),ae.security&&b(ae.security),ae.proxy&&w(ae.proxy),ae.logging&&T(ae.logging),ae.analytics&&E(ae.analytics),ae.backup&&K(ae.backup),ae.update&&D(ae.update),u.current=ae,f(!1)}}catch(X){console.error("Failed to load settings:",X)}finally{s(!1)}},U=async()=>{var X,q,ae,ce,ee,W;if(x.authenticationMethod==="forms"||x.authenticationMethod==="basic")if(!((q=(X=u.current)==null?void 0:X.security)!=null&&q.username)||((ce=(ae=u.current)==null?void 0:ae.security)==null?void 0:ce.authenticationMethod)==="none"||((W=(ee=u.current)==null?void 0:ee.security)==null?void 0:W.authenticationMethod)==="external"){if(!x.username||x.username.trim().length===0){be.error("Username Required",{description:"Please enter a username before enabling authentication."});return}if(!x.password||x.password.trim().length<6){be.error("Password Required",{description:"Please enter a password (minimum 6 characters) before enabling authentication."});return}}else{if(!x.username||x.username.trim().length===0){be.error("Username Required",{description:"Username cannot be empty."});return}if(x.password&&x.password.trim().length>0&&x.password.trim().length<6){be.error("Password Too Short",{description:"Password must be at least 6 characters."});return}}n(!0);try{const V=await kt("/api/settings");if(!V.ok)throw new Error("Failed to fetch current settings");const Z={...await V.json(),hostSettings:JSON.stringify(m),securitySettings:JSON.stringify(x),proxySettings:JSON.stringify(v),loggingSettings:JSON.stringify(S),analyticsSettings:JSON.stringify(k),backupSettings:JSON.stringify(R),updateSettings:JSON.stringify(z)},oe=await br("/api/settings",Z);if(!oe.ok){try{const ye=await oe.json();be.error("Save Failed",{description:ye.error||"Failed to save settings."})}catch{be.error("Save Failed",{description:"Failed to save settings. Please try again."})}return}u.current={host:m,security:x,proxy:v,logging:S,analytics:k,backup:R,update:z},f(!1),be.success("Settings Saved",{description:"Your settings have been saved successfully."})}catch(V){console.error("Failed to save settings:",V),be.error("Save Failed",{description:"Failed to save settings. Please try again."})}finally{n(!1)}},I=async()=>{try{if(!x.apiKey){console.error("No API key to copy");return}if(navigator.clipboard&&navigator.clipboard.writeText)try{await navigator.clipboard.writeText(x.apiKey),c(!0),setTimeout(()=>c(!1),2e3);return}catch(q){console.warn("Clipboard API failed, trying fallback:",q)}const X=document.createElement("textarea");X.value=x.apiKey,X.style.position="fixed",X.style.left="-999999px",X.style.top="-999999px",document.body.appendChild(X),X.focus(),X.select();try{document.execCommand("copy")?(c(!0),setTimeout(()=>c(!1),2e3)):console.error("Fallback copy command failed")}catch(q){console.error("Fallback copy failed:",q)}finally{document.body.removeChild(X)}}catch(X){console.error("Failed to copy API key:",X)}},F=async()=>{if(confirm("Are you sure you want to regenerate the API key? All connected applications (Prowlarr, download clients, etc.) will need to be updated with the new key."))try{const X=await ds("/api/settings/apikey/regenerate",{});if(X.ok){const q=await X.json();b(ae=>({...ae,apiKey:q.apiKey})),be.success("API Key Regenerated",{description:"Update all connected applications with the new key.",duration:1e4})}else be.error("Regeneration Failed",{description:"Failed to regenerate API key. Please try again."})}catch(X){console.error("Failed to regenerate API key:",X),be.error("Regeneration Failed",{description:X instanceof Error?X.message:"An unexpected error occurred."})}};return e?t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"General"}),t.jsx("p",{className:"text-gray-400",children:"General application settings"})]}),t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-500",children:"Loading settings..."})})]}):t.jsxs("div",{children:[t.jsx(Rn,{title:"General",subtitle:"General application settings",onSave:U,isSaving:r,hasUnsavedChanges:d,saveButtonText:r?"Saving...":"Save Changes"}),t.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx(bx,{className:"w-6 h-6 text-red-400 mr-3"}),t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Host"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Bind Address"}),t.jsx("input",{type:"text",value:m.bindAddress,onChange:X=>g(q=>({...q,bindAddress:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"*"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"* = all interfaces, localhost = local only"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Port Number"}),t.jsx("input",{type:"number",value:m.port,onChange:X=>g(q=>({...q,port:Number(X.target.value)})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Restart required to apply"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"URL Base"}),t.jsx("input",{type:"text",value:m.urlBase,onChange:X=>g(q=>({...q,urlBase:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"/sportarr"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"For reverse proxy support, leave empty if not using a reverse proxy"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Instance Name"}),t.jsx("input",{type:"text",value:m.instanceName,onChange:X=>g(q=>({...q,instanceName:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Instance name in browser tab and notifications"})]}),t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:m.launchBrowser,onChange:X=>g(q=>({...q,launchBrowser:X.target.checked})),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Launch Browser on Startup"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Automatically open web browser when Sportarr starts (useful for desktop installations)"})]})]}),a&&t.jsxs(t.Fragment,{children:[t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:m.enableSsl,onChange:X=>g(q=>({...q,enableSsl:X.target.checked})),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Enable SSL"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Requires restart. Use SSL to access Sportarr (https://)"}),t.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 bg-yellow-900/30 text-yellow-400 text-xs rounded",children:"Advanced"})]})]}),m.enableSsl&&t.jsxs("div",{className:"ml-8 space-y-4 p-4 bg-black/30 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"SSL Port"}),t.jsx("input",{type:"number",value:m.sslPort,onChange:X=>g(q=>({...q,sslPort:Number(X.target.value)})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"SSL Certificate Path"}),t.jsx("input",{type:"text",value:m.sslCertPath,onChange:X=>g(q=>({...q,sslCertPath:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"/path/to/cert.pfx"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"SSL Certificate Password"}),t.jsx("input",{type:"password",value:m.sslCertPassword,onChange:X=>g(q=>({...q,sslCertPassword:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"})]})]})]})]})]}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx(jp,{className:"w-6 h-6 text-red-400 mr-3"}),t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Security"})]}),t.jsxs("div",{className:"space-y-4",children:[x.authenticationMethod==="external"?t.jsx("div",{className:"p-4 bg-green-900/20 border border-green-900/30 rounded-lg",children:t.jsxs("p",{className:"text-green-300 text-sm",children:[t.jsx("strong",{children:"External authentication enabled."})," Authentication is handled by your reverse proxy (Authelia, Authentik, oauth-proxy, etc.). Username and password are not required."]})}):x.authenticationMethod==="none"?t.jsx("div",{className:"p-4 bg-yellow-900/20 border border-yellow-900/30 rounded-lg",children:t.jsxs("p",{className:"text-yellow-300 text-sm",children:[t.jsx("strong",{children:"Authentication disabled."})," Anyone can access Sportarr without credentials. Only use this on trusted networks."]})}):t.jsx("div",{className:"p-4 bg-blue-900/20 border border-blue-900/30 rounded-lg",children:t.jsxs("p",{className:"text-blue-300 text-sm",children:[t.jsx("strong",{children:"Authentication is required."})," Change your username and password below, then save. You'll need to login again with the new credentials."]})}),(x.authenticationMethod==="forms"||x.authenticationMethod==="basic")&&t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Username"}),t.jsx("input",{type:"text",value:x.username,onChange:X=>b(q=>({...q,username:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",autoComplete:"username",placeholder:"Enter new username"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Current username will be replaced when you save"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Password"}),t.jsx("input",{type:"password",value:x.password,onChange:X=>b(q=>({...q,password:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",autoComplete:"new-password",placeholder:"Enter new password (min 6 chars)"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank to keep current password"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"API Key"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"text",value:x.apiKey,readOnly:!0,className:"flex-1 px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none font-mono text-sm"}),t.jsx("button",{onClick:I,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors flex items-center space-x-2",title:"Copy API Key",children:o?t.jsxs(t.Fragment,{children:[t.jsx($a,{className:"w-5 h-5"}),t.jsx("span",{children:"Copied!"})]}):t.jsxs(t.Fragment,{children:[t.jsx(IN,{className:"w-5 h-5"}),t.jsx("span",{children:"Copy"})]})}),t.jsx("button",{onClick:F,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Regenerate"})]}),t.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Used by apps and scripts to access Sportarr API. After regenerating, update all connected applications (Prowlarr, download clients, etc.) with the new key."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Authentication Method"}),t.jsxs("select",{value:x.authenticationMethod,onChange:X=>b(q=>({...q,authenticationMethod:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"forms",children:"Forms (Login Page)"}),t.jsx("option",{value:"basic",children:"Basic (Browser Popup)"}),t.jsx("option",{value:"external",children:"External (Authelia/Authentik/oauth-proxy)"}),t.jsx("option",{value:"none",children:"None (Disabled)"})]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:x.authenticationMethod==="external"?"Trusts reverse proxy for authentication. Use with Authelia, Authentik, oauth-proxy, etc.":x.authenticationMethod==="none"?"Warning: No authentication required. Only use on trusted networks.":"Username and password are required for Forms and Basic authentication."})]}),(x.authenticationMethod==="forms"||x.authenticationMethod==="basic")&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Authentication Required"}),t.jsxs("select",{value:(te=x.authenticationRequired)==null?void 0:te.toLowerCase(),onChange:X=>b(q=>({...q,authenticationRequired:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"enabled",children:"Enabled (Always Required)"}),t.jsx("option",{value:"disabledforlocaladdresses",children:"Disabled for Local Addresses"})]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:((le=x.authenticationRequired)==null?void 0:le.toLowerCase())==="enabled"?"Authentication is required for all connections, including local network.":"Authentication is only required for external connections. Local network (192.168.x.x, 10.x.x.x, localhost) can access without login."})]}),a&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Certificate Validation"}),t.jsxs("select",{value:(H=x.certificateValidation)==null?void 0:H.toLowerCase(),onChange:X=>b(q=>({...q,certificateValidation:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"enabled",children:"Enabled"}),t.jsx("option",{value:"disabledforlocaladdresses",children:"Disabled For Local Addresses"}),t.jsx("option",{value:"disabled",children:"Disabled"})]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Change how strict HTTPS certificate validation is"}),t.jsx("span",{className:"inline-block mt-1 px-2 py-0.5 bg-yellow-900/30 text-yellow-400 text-xs rounded",children:"Advanced"})]})]})]}),a&&t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-yellow-900/30 rounded-lg p-6",children:[t.jsxs("h3",{className:"text-xl font-semibold text-white mb-4",children:["Proxy Settings",t.jsx("span",{className:"ml-2 px-2 py-0.5 bg-yellow-900/30 text-yellow-400 text-xs rounded",children:"Advanced"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:v.useProxy,onChange:X=>w(q=>({...q,useProxy:X.target.checked})),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Use Proxy"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Route requests through a proxy server"})]})]}),v.useProxy&&t.jsxs("div",{className:"ml-8 space-y-4 p-4 bg-black/30 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Proxy Type"}),t.jsxs("select",{value:v.proxyType,onChange:X=>w(q=>({...q,proxyType:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"http",children:"HTTP(S)"}),t.jsx("option",{value:"socks4",children:"SOCKS4"}),t.jsx("option",{value:"socks5",children:"SOCKS5"})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Hostname"}),t.jsx("input",{type:"text",value:v.proxyHostname,onChange:X=>w(q=>({...q,proxyHostname:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"proxy.example.com"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Port"}),t.jsx("input",{type:"number",value:v.proxyPort,onChange:X=>w(q=>({...q,proxyPort:Number(X.target.value)})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Username"}),t.jsx("input",{type:"text",value:v.proxyUsername,onChange:X=>w(q=>({...q,proxyUsername:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"Optional"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Password"}),t.jsx("input",{type:"password",value:v.proxyPassword,onChange:X=>w(q=>({...q,proxyPassword:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"Optional"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Ignored Addresses"}),t.jsx("input",{type:"text",value:v.proxyBypassFilter,onChange:X=>w(q=>({...q,proxyBypassFilter:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"localhost,127.0.0.1"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Comma separated list of addresses that bypass the proxy"})]}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:v.proxyBypassLocalAddresses,onChange:X=>w(q=>({...q,proxyBypassLocalAddresses:X.target.checked})),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm text-gray-300",children:"Bypass Proxy for Local Addresses"})]})]})]})]}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Logging"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Log Level"}),t.jsxs("select",{value:S.logLevel,onChange:X=>T(q=>({...q,logLevel:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"trace",children:"Trace"}),t.jsx("option",{value:"debug",children:"Debug"}),t.jsx("option",{value:"info",children:"Info"}),t.jsx("option",{value:"warn",children:"Warn"}),t.jsx("option",{value:"error",children:"Error"})]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Trace/Debug logs should only be enabled when troubleshooting issues"})]})]}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx(Sp,{className:"w-6 h-6 text-red-400 mr-3"}),t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Analytics"})]}),t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:k.sendAnonymousUsageData,onChange:X=>E(q=>({...q,sendAnonymousUsageData:X.target.checked})),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Send Anonymous Usage Data"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Help improve Sportarr by sending anonymous usage statistics. No personal information is collected."})]})]})]}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx(LR,{className:"w-6 h-6 text-red-400 mr-3"}),t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Backups"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Backup Folder"}),t.jsx("input",{type:"text",value:R.backupFolder,onChange:X=>K(q=>({...q,backupFolder:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"/config/backups"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Folder to store backup files (relative to AppData directory)"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Backup Interval"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"number",value:R.backupInterval,onChange:X=>K(q=>({...q,backupInterval:Number(X.target.value)})),className:"w-32 px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",min:"1"}),t.jsx("span",{className:"text-gray-400",children:"days"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Backup Retention"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"number",value:R.backupRetention,onChange:X=>K(q=>({...q,backupRetention:Number(X.target.value)})),className:"w-32 px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",min:"1"}),t.jsx("span",{className:"text-gray-400",children:"days"})]})]})]})]})]}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx(io,{className:"w-6 h-6 text-red-400 mr-3"}),t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Media Server Agents"})]}),t.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Download metadata agents for your media server. These agents fetch sports metadata (posters, banners, descriptions) from sportarr.net."}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"p-4 bg-black/30 rounded-lg border border-gray-800 flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-white font-medium",children:"Plex"}),t.jsx("span",{className:"text-xs bg-green-600/20 text-green-400 px-2 py-0.5 rounded",children:"Recommended"})]}),t.jsxs("p",{className:"text-gray-400 text-xs mb-2",children:[t.jsx("strong",{className:"text-gray-300",children:"Custom Metadata Provider"})," (Plex 1.43.0+)"]}),t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx("code",{className:"flex-1 text-xs bg-gray-800 text-gray-300 px-2 py-1.5 rounded overflow-x-auto",children:"https://sportarr.net/plex"}),t.jsx("button",{type:"button",onClick:async()=>{try{await navigator.clipboard.writeText("https://sportarr.net/plex"),be.success("Provider URL copied to clipboard")}catch{const X=document.createElement("textarea");X.value="https://sportarr.net/plex",document.body.appendChild(X),X.select(),document.execCommand("copy"),document.body.removeChild(X),be.success("Provider URL copied to clipboard")}},className:"p-1.5 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded transition-colors",title:"Copy URL",children:t.jsx(li,{className:"w-4 h-4"})})]}),t.jsxs("div",{className:"text-gray-400 text-xs mb-3 space-y-1 flex-1",children:[t.jsx("p",{children:t.jsx("strong",{className:"text-gray-300",children:"Setup:"})}),t.jsx("p",{children:"1. Settings  Metadata Agents  + Add Provider"}),t.jsx("p",{children:"2. Paste URL above  + Add Agent  Name it  Save"}),t.jsx("p",{children:"3. Restart Plex"}),t.jsx("p",{children:"4. Create TV Shows library with Sportarr agent"})]}),t.jsxs("details",{className:"text-xs mt-auto",children:[t.jsx("summary",{className:"text-gray-500 cursor-pointer hover:text-gray-400 mb-2",children:"Legacy agent for older Plex versions"}),t.jsx("p",{className:"text-gray-500 mb-2",children:"For Plex versions before 1.43.0, download and install the legacy bundle agent."}),t.jsxs("a",{href:"/api/system/agents/plex/download",download:"Sportarr-Legacy.bundle.zip",className:"inline-flex items-center px-2 py-1 bg-gray-700 hover:bg-gray-600 text-gray-300 text-xs rounded transition-colors w-fit",children:[t.jsx(qs,{className:"w-3 h-3 mr-1"}),"Download Legacy Agent"]})]})]}),t.jsxs("div",{className:"p-4 bg-black/30 rounded-lg border border-gray-800 flex flex-col",children:[t.jsx("div",{className:"flex items-center justify-between mb-2",children:t.jsx("span",{className:"text-white font-medium",children:"Jellyfin"})}),t.jsx("p",{className:"text-gray-400 text-xs mb-3",children:"Install the Sportarr plugin for automatic sports metadata."}),t.jsxs("div",{className:"text-gray-400 text-xs mb-3 space-y-1 flex-1",children:[t.jsx("p",{children:t.jsx("strong",{className:"text-gray-300",children:"Setup:"})}),t.jsx("p",{children:"1. Download and extract the plugin ZIP"}),t.jsx("p",{children:"2. Copy the DLL to your Jellyfin plugins directory"}),t.jsx("p",{children:"3. Restart Jellyfin"}),t.jsx("p",{children:"4. Create a Shows library and enable Sportarr metadata"})]}),t.jsxs("a",{href:"/api/system/agents/jellyfin/download",download:"Sportarr-Jellyfin.zip",className:"inline-flex items-center px-3 py-2 bg-purple-600 hover:bg-purple-700 text-white text-sm rounded-lg transition-colors w-fit mt-auto",children:[t.jsx(qs,{className:"w-4 h-4 mr-2"}),"Download Jellyfin Plugin"]})]}),t.jsxs("div",{className:"p-4 bg-black/30 rounded-lg border border-gray-800 flex flex-col",children:[t.jsx("div",{className:"flex items-center justify-between mb-2",children:t.jsx("span",{className:"text-white font-medium",children:"Emby"})}),t.jsx("p",{className:"text-gray-400 text-xs mb-3",children:"Install the Sportarr plugin for automatic sports metadata."}),t.jsxs("div",{className:"text-gray-400 text-xs mb-3 space-y-1 flex-1",children:[t.jsx("p",{children:t.jsx("strong",{className:"text-gray-300",children:"Setup:"})}),t.jsx("p",{children:"1. Download and extract the plugin ZIP"}),t.jsx("p",{children:"2. Copy the DLL to your Emby plugins directory"}),t.jsx("p",{children:"3. Restart Emby"}),t.jsx("p",{children:"4. Create a Shows library and enable Sportarr metadata"})]}),t.jsxs("a",{href:"/api/system/agents/emby/download",download:"Sportarr-Emby.zip",className:"inline-flex items-center px-3 py-2 bg-green-600 hover:bg-green-700 text-white text-sm rounded-lg transition-colors w-fit mt-auto",children:[t.jsx(qs,{className:"w-4 h-4 mr-2"}),"Download Emby Plugin"]})]})]}),t.jsxs("p",{className:"text-gray-500 text-xs mt-4",children:["Docker users: Agents are also available at ",t.jsx("code",{className:"bg-gray-800 px-1 rounded",children:"/config/agents/"})," in your mounted config volume."]})]}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx(Dt,{className:"w-6 h-6 text-red-400 mr-3"}),t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Updates"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Branch"}),t.jsxs("select",{value:z.branch,onChange:X=>D(q=>({...q,branch:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"main",children:"Main (Stable)"}),t.jsx("option",{value:"develop",children:"Develop (Beta)"})]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Branch to receive updates from"})]}),t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:z.updateAutomatically,onChange:X=>D(q=>({...q,updateAutomatically:X.target.checked})),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Automatic Updates"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Automatically download and install updates"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Mechanism"}),t.jsxs("select",{value:z.updateMechanism,onChange:X=>D(q=>({...q,updateMechanism:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"BuiltIn",children:"Built-in"}),t.jsx("option",{value:"Script",children:"Script"}),t.jsx("option",{value:"Docker",children:"Docker"}),t.jsx("option",{value:"Apt",children:"Apt"}),t.jsx("option",{value:"External",children:"External"})]})]}),z.updateMechanism==="Script"&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Script Path"}),t.jsx("input",{type:"text",value:z.updateScriptPath,onChange:X=>D(q=>({...q,updateScriptPath:X.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"/path/to/update/script.sh"})]})]})]})]})]})}function WI({showAdvanced:a=!1}){const[e,s]=y.useState(!0),[r,n]=y.useState(!1),[o,c]=y.useState(!1),d=y.useRef(null);cl(o);const[f,u]=y.useState([]),[m,g]=y.useState(""),[x,b]=y.useState({firstDayOfWeek:"sunday",calendarWeekColumnHeader:"ddd M/D",shortDateFormat:"MMM D YYYY",longDateFormat:"dddd, MMMM D YYYY",timeFormat:"h:mm A",showRelativeDates:!0,theme:"auto",enableColorImpairedMode:!1,uiLanguage:"en",showUnknownLeagueItems:!1,showEventPath:!1,timeZone:""});y.useEffect(()=>{w(),v()},[]);const v=async()=>{try{const k=await kt("/api/system/timezones");if(k.ok){const E=await k.json();u(E.timezones||[]),g(E.currentTimeZone||"")}}catch(k){console.error("Failed to load timezones:",k)}},w=async()=>{try{const k=await kt("/api/settings");if(k.ok){const E=await k.json();if(E.uiSettings){const R=JSON.parse(E.uiSettings);b(K=>({...K,...R})),d.current={...x,...R},c(!1)}}}catch(k){console.error("Failed to load UI settings:",k)}finally{s(!1)}};y.useEffect(()=>{if(!d.current)return;const k=JSON.stringify(x)!==JSON.stringify(d.current);c(k)},[x]);const S=async()=>{n(!0);try{const k=await kt("/api/settings");if(!k.ok)throw new Error("Failed to fetch current settings");const R={...await k.json(),uiSettings:JSON.stringify(x)};(await br("/api/settings",R)).ok?(d.current=x,c(!1)):console.error("Failed to save UI settings")}catch(k){console.error("Failed to save UI settings:",k)}finally{n(!1)}},T=(k,E)=>{b(R=>({...R,[k]:E}))};return e?t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"UI"}),t.jsx("p",{className:"text-gray-400",children:"User interface preferences and customization"})]}),t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-500",children:"Loading UI settings..."})})]}):t.jsxs("div",{children:[t.jsx(Rn,{title:"UI",subtitle:"User interface preferences and customization",onSave:S,isSaving:r,hasUnsavedChanges:o,saveButtonText:"Save Changes"}),t.jsxs("div",{className:"max-w-4xl mx-auto px-6",children:[t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx(el,{className:"w-6 h-6 text-red-400 mr-3"}),t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Calendar"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"First Day of Week"}),t.jsxs("select",{value:x.firstDayOfWeek,onChange:k=>T("firstDayOfWeek",k.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"sunday",children:"Sunday"}),t.jsx("option",{value:"monday",children:"Monday"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Week Column Header"}),t.jsx("input",{type:"text",value:x.calendarWeekColumnHeader,onChange:k=>T("calendarWeekColumnHeader",k.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Format for calendar week column headers"}),t.jsx("div",{className:"mt-2 p-3 bg-blue-950/30 border border-blue-900/50 rounded-lg",children:t.jsxs("p",{className:"text-sm text-blue-300",children:[t.jsx("strong",{children:"Examples:"})," ddd M/D = Mon 1/1 | MMM D = Jan 1 | ddd D/M = Mon 1/1"]})})]})]})]}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx(Gf,{className:"w-6 h-6 text-red-400 mr-3"}),t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Timezone"})]}),t.jsx("div",{className:"space-y-4",children:t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Timezone"}),t.jsxs("select",{value:x.timeZone,onChange:k=>T("timeZone",k.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsxs("option",{value:"",children:["System Timezone (",m||"detecting...",")"]}),f.map(k=>t.jsx("option",{value:k.id,children:k.displayName},k.id))]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:`Timezone used for displaying event times in the calendar and schedule. Leave as "System Timezone" to use the server's timezone.`}),t.jsx("div",{className:"mt-2 p-3 bg-blue-950/30 border border-blue-900/50 rounded-lg",children:t.jsxs("p",{className:"text-sm text-blue-300",children:[t.jsx("strong",{children:"Note:"})," This setting controls how times are displayed in Sportarr. For Docker users, you can also set the TZ environment variable (e.g., TZ=America/New_York) in your container configuration."]})})]})})]}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx($r,{className:"w-6 h-6 text-red-400 mr-3"}),t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Dates"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Short Date Format"}),t.jsxs("select",{value:x.shortDateFormat,onChange:k=>T("shortDateFormat",k.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"MMM D YYYY",children:"Dec 25 2024"}),t.jsx("option",{value:"DD MMM YYYY",children:"25 Dec 2024"}),t.jsx("option",{value:"MM/DD/YYYY",children:"12/25/2024"}),t.jsx("option",{value:"DD/MM/YYYY",children:"25/12/2024"}),t.jsx("option",{value:"YYYY-MM-DD",children:"2024-12-25"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Long Date Format"}),t.jsxs("select",{value:x.longDateFormat,onChange:k=>T("longDateFormat",k.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"dddd, MMMM D YYYY",children:"Monday, December 25 2024"}),t.jsx("option",{value:"dddd, D MMMM YYYY",children:"Monday, 25 December 2024"}),t.jsx("option",{value:"MMMM D YYYY",children:"December 25 2024"}),t.jsx("option",{value:"D MMMM YYYY",children:"25 December 2024"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Time Format"}),t.jsxs("select",{value:x.timeFormat,onChange:k=>T("timeFormat",k.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"h:mm A",children:"9:00 PM (12-hour)"}),t.jsx("option",{value:"HH:mm",children:"21:00 (24-hour)"})]})]}),t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:x.showRelativeDates,onChange:k=>T("showRelativeDates",k.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Show Relative Dates"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:'Show relative dates (e.g., "Today at 5:30 PM" instead of "Jan 5 2024 at 5:30 PM")'})]})]})]})]}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx(t3,{className:"w-6 h-6 text-red-400 mr-3"}),t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Style"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Theme"}),t.jsxs("select",{value:x.theme,onChange:k=>T("theme",k.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"auto",children:"Auto (Follow System)"}),t.jsx("option",{value:"light",children:"Light"}),t.jsx("option",{value:"dark",children:"Dark"})]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Sportarr will match your system theme in auto mode"})]}),t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:x.enableColorImpairedMode,onChange:k=>T("enableColorImpairedMode",k.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Enable Color-Impaired Mode"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Altered color style to better differentiate status colors for color-impaired users"})]})]})]})]}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Language"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"UI Language"}),t.jsxs("select",{value:x.uiLanguage,onChange:k=>T("uiLanguage",k.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"en",children:"English"}),t.jsx("option",{value:"es",children:"Espaol (Spanish)"}),t.jsx("option",{value:"pt",children:"Portugus (Portuguese)"}),t.jsx("option",{value:"ja",children:" (Japanese)"}),t.jsx("option",{value:"ko",children:" (Korean)"}),t.jsx("option",{value:"th",children:" (Thai)"}),t.jsx("option",{value:"ru",children:" (Russian)"}),t.jsx("option",{value:"de",children:"Deutsch (German)"}),t.jsx("option",{value:"fr",children:"Franais (French)"}),t.jsx("option",{value:"zh",children:" (Chinese)"})]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Language for the Sportarr user interface"})]})]}),a&&t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-yellow-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx(Cd,{className:"w-6 h-6 text-yellow-400 mr-3"}),t.jsxs("h3",{className:"text-xl font-semibold text-white",children:["Display Options",t.jsx("span",{className:"ml-2 px-2 py-0.5 bg-yellow-900/30 text-yellow-400 text-xs rounded",children:"Advanced"})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:x.showUnknownLeagueItems,onChange:k=>T("showUnknownLeagueItems",k.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Show Unknown League Items"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Display items from unrecognized sports leagues"})]})]}),t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:x.showEventPath,onChange:k=>T("showEventPath",k.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("div",{children:[t.jsx("span",{className:"text-white font-medium",children:"Show Event Path"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Show the path to event files in the UI"})]})]})]})]}),a&&t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-blue-900/30 rounded-lg p-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Date/Time Format Tokens"}),t.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Reference for custom date and time format patterns"}),t.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-white font-medium mb-2",children:"Month"}),t.jsxs("div",{className:"space-y-1 text-sm",children:[t.jsxs("p",{className:"text-gray-300",children:[t.jsx("code",{className:"text-green-400",children:"MMMM"})," = December"]}),t.jsxs("p",{className:"text-gray-300",children:[t.jsx("code",{className:"text-green-400",children:"MMM"})," = Dec"]}),t.jsxs("p",{className:"text-gray-300",children:[t.jsx("code",{className:"text-green-400",children:"MM"})," = 12"]}),t.jsxs("p",{className:"text-gray-300",children:[t.jsx("code",{className:"text-green-400",children:"M"})," = 12"]})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-white font-medium mb-2",children:"Day"}),t.jsxs("div",{className:"space-y-1 text-sm",children:[t.jsxs("p",{className:"text-gray-300",children:[t.jsx("code",{className:"text-green-400",children:"dddd"})," = Monday"]}),t.jsxs("p",{className:"text-gray-300",children:[t.jsx("code",{className:"text-green-400",children:"ddd"})," = Mon"]}),t.jsxs("p",{className:"text-gray-300",children:[t.jsx("code",{className:"text-green-400",children:"DD"})," = 25"]}),t.jsxs("p",{className:"text-gray-300",children:[t.jsx("code",{className:"text-green-400",children:"D"})," = 25"]})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-white font-medium mb-2",children:"Year"}),t.jsxs("div",{className:"space-y-1 text-sm",children:[t.jsxs("p",{className:"text-gray-300",children:[t.jsx("code",{className:"text-green-400",children:"YYYY"})," = 2024"]}),t.jsxs("p",{className:"text-gray-300",children:[t.jsx("code",{className:"text-green-400",children:"YY"})," = 24"]})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-white font-medium mb-2",children:"Time"}),t.jsxs("div",{className:"space-y-1 text-sm",children:[t.jsxs("p",{className:"text-gray-300",children:[t.jsx("code",{className:"text-green-400",children:"HH"})," = 21 (24-hour)"]}),t.jsxs("p",{className:"text-gray-300",children:[t.jsx("code",{className:"text-green-400",children:"H"})," = 21 (24-hour)"]}),t.jsxs("p",{className:"text-gray-300",children:[t.jsx("code",{className:"text-green-400",children:"h"})," = 9 (12-hour)"]}),t.jsxs("p",{className:"text-gray-300",children:[t.jsx("code",{className:"text-green-400",children:"mm"})," = 30 (minutes)"]}),t.jsxs("p",{className:"text-gray-300",children:[t.jsx("code",{className:"text-green-400",children:"A"})," = PM"]})]})]})]})]})]})]})}function QI({showAdvanced:a=!1}){var U;const[e,s]=y.useState([]),[r,n]=y.useState(!0),[o,c]=y.useState(!1),[d,f]=y.useState(!1),[u,m]=y.useState(null),[g,x]=y.useState(null),[b,v]=y.useState(""),[w,S]=y.useState("#3b82f6"),T=[{name:"Blue",value:"#3b82f6"},{name:"Red",value:"#ef4444"},{name:"Green",value:"#10b981"},{name:"Yellow",value:"#f59e0b"},{name:"Purple",value:"#8b5cf6"},{name:"Pink",value:"#ec4899"},{name:"Indigo",value:"#6366f1"},{name:"Orange",value:"#f97316"},{name:"Teal",value:"#14b8a6"},{name:"Cyan",value:"#06b6d4"},{name:"Lime",value:"#84cc16"},{name:"Emerald",value:"#059669"}];y.useEffect(()=>{k()},[]);const k=async()=>{try{const I=await kt("/api/tag");if(I.ok){const F=await I.json();s(F)}}catch(I){console.error("Failed to fetch tags:",I)}finally{n(!1)}},E=async()=>{if(b.trim()&&!e.some(I=>I.label.toLowerCase()===b.trim().toLowerCase()))try{const I=await ds("/api/tag",{label:b.trim(),color:w});if(I.ok){const F=await I.json();s(te=>[...te,F]),c(!1),v(""),S("#3b82f6")}}catch(I){console.error("Failed to add tag:",I)}},R=async()=>{if(g&&b.trim()&&!e.some(I=>I.id!==g.id&&I.label.toLowerCase()===b.trim().toLowerCase()))try{const I=await br(`/api/tag/${g.id}`,{id:g.id,label:b.trim(),color:w});if(I.ok){const F=await I.json();s(te=>te.map(le=>le.id===g.id?F:le)),f(!1),x(null),v(""),S("#3b82f6")}}catch(I){console.error("Failed to edit tag:",I)}},K=async I=>{try{(await Na(`/api/tag/${I}`)).ok&&(s(te=>te.filter(le=>le.id!==I)),m(null))}catch(F){console.error("Failed to delete tag:",F)}},z=I=>{x(I),v(I.label),S(I.color),f(!0)},D=()=>{c(!1),v(""),S("#3b82f6")},O=()=>{f(!1),x(null),v(""),S("#3b82f6")};return r?t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Tags"}),t.jsx("p",{className:"text-gray-400",children:"Manage tags for organizing events, profiles, and indexers"})]}),t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-500",children:"Loading tags..."})})]}):t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Tags"}),t.jsx("p",{className:"text-gray-400",children:"Manage tags for organizing events, profiles, and indexers"})]}),t.jsx("div",{className:"mb-6",children:t.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[t.jsx(hr,{className:"w-5 h-5"}),"Add Tag"]})}),t.jsx("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg overflow-hidden",children:e.length===0?t.jsxs("div",{className:"text-center py-12",children:[t.jsx(vx,{className:"w-16 h-16 text-gray-700 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500 mb-2",children:"No tags configured"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Create tags to organize your events and settings"})]}):t.jsx("div",{className:"divide-y divide-gray-800",children:e.map(I=>t.jsxs("div",{className:"p-4 hover:bg-gray-800/50 transition-colors flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:I.color}}),t.jsx("span",{className:"text-white font-medium",children:I.label}),t.jsx("span",{className:"text-sm text-gray-500",style:{color:I.color},children:I.color})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>z(I),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded transition-colors",title:"Edit tag",children:t.jsx(an,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>m(I.id),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-gray-700 rounded transition-colors",title:"Delete tag",children:t.jsx(cs,{className:"w-4 h-4"})})]})]},I.id))})}),a&&e.length>0&&t.jsxs("div",{className:"mt-6 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Tag Usage"}),t.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Tags can be applied to:"}),t.jsxs("ul",{className:"list-disc list-inside text-gray-400 text-sm space-y-1",children:[t.jsx("li",{children:"Events to categorize by promotion, organization, or event type"}),t.jsx("li",{children:"Quality Profiles to apply different quality settings to different tags"}),t.jsx("li",{children:"Custom Formats to restrict formats to specific content"}),t.jsx("li",{children:"Indexers to control which indexers are used for tagged content"}),t.jsx("li",{children:"Download Clients to route downloads to specific clients"}),t.jsx("li",{children:"Notifications to send alerts only for tagged content"})]})]}),o&&t.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg max-w-md w-full p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Add Tag"}),t.jsx("button",{onClick:D,className:"text-gray-400 hover:text-white transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Label *"}),t.jsx("input",{type:"text",value:b,onChange:I=>v(I.target.value),placeholder:"e.g., UFC, Bellator, High Priority",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-red-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Color"}),t.jsx("div",{className:"grid grid-cols-6 gap-2 mb-3",children:T.map(I=>t.jsx("button",{onClick:()=>S(I.value),className:`w-10 h-10 rounded-lg transition-all ${w===I.value?"ring-2 ring-white ring-offset-2 ring-offset-gray-900":"hover:scale-110"}`,style:{backgroundColor:I.value},title:I.name},I.value))}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"color",value:w,onChange:I=>S(I.target.value),className:"w-12 h-10 bg-gray-800 border border-gray-700 rounded cursor-pointer"}),t.jsx("input",{type:"text",value:w,onChange:I=>S(I.target.value),className:"flex-1 px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-500"})]})]}),t.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-800/50 rounded-lg",children:[t.jsx("div",{className:"w-6 h-6 rounded-full flex-shrink-0",style:{backgroundColor:w}}),t.jsx("span",{className:"text-white font-medium",children:b||"Tag Preview"})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:D,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:E,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Add Tag"})]})]})}),d&&g&&t.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg max-w-md w-full p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Edit Tag"}),t.jsx("button",{onClick:O,className:"text-gray-400 hover:text-white transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Label *"}),t.jsx("input",{type:"text",value:b,onChange:I=>v(I.target.value),placeholder:"e.g., UFC, Bellator, High Priority",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-red-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Color"}),t.jsx("div",{className:"grid grid-cols-6 gap-2 mb-3",children:T.map(I=>t.jsx("button",{onClick:()=>S(I.value),className:`w-10 h-10 rounded-lg transition-all ${w===I.value?"ring-2 ring-white ring-offset-2 ring-offset-gray-900":"hover:scale-110"}`,style:{backgroundColor:I.value},title:I.name},I.value))}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"color",value:w,onChange:I=>S(I.target.value),className:"w-12 h-10 bg-gray-800 border border-gray-700 rounded cursor-pointer"}),t.jsx("input",{type:"text",value:w,onChange:I=>S(I.target.value),className:"flex-1 px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-500"})]})]}),t.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-800/50 rounded-lg",children:[t.jsx("div",{className:"w-6 h-6 rounded-full flex-shrink-0",style:{backgroundColor:w}}),t.jsx("span",{className:"text-white font-medium",children:b||"Tag Preview"})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[t.jsx("button",{onClick:O,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:R,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Save Changes"})]})]})}),u!==null&&t.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg max-w-md w-full p-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Delete Tag"}),t.jsxs("p",{className:"text-gray-300 mb-6",children:['Are you sure you want to delete the tag "',t.jsx("span",{className:"font-semibold text-white",children:(U=e.find(I=>I.id===u))==null?void 0:U.label}),'"?']}),t.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"This will remove the tag from all items it's currently assigned to."}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>m(null),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>K(u),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Delete"})]})]})})]})}function XI(){const[a,e]=y.useState(!0),[s,r]=y.useState(!1),[n,o]=y.useState(!1),[c,d]=y.useState(!1),[f,u]=y.useState(null),m=y.useRef(null);cl(n);const[g,x]=y.useState({customMetadataApiUrl:""});y.useEffect(()=>{b()},[]);const b=async()=>{try{const S=await kt("/api/settings");if(S.ok){const T=await S.json();if(T.developmentSettings){const k=JSON.parse(T.developmentSettings);x(E=>({...E,...k})),m.current={...g,...k},o(!1)}}}catch(S){console.error("Failed to load development settings:",S)}finally{e(!1)}};y.useEffect(()=>{if(!m.current)return;const S=JSON.stringify(g)!==JSON.stringify(m.current);o(S)},[g]);const v=async()=>{r(!0);try{const S=await kt("/api/settings");if(!S.ok)throw new Error("Failed to fetch current settings");const k={...await S.json(),developmentSettings:JSON.stringify(g)};(await br("/api/settings",k)).ok?(m.current=g,o(!1)):console.error("Failed to save development settings")}catch(S){console.error("Failed to save development settings:",S)}finally{r(!1)}},w=async()=>{d(!0),u(null);const S=g.customMetadataApiUrl||"https://sportarr.net/api/v2/json";try{const T=`${S.replace(/\/$/,"")}/all/sports`,k=await fetch(T,{method:"GET",headers:{Accept:"application/json"}});if(k.ok){const E=await k.json(),R=E&&(E.sports||E.list||E.data&&E.data.all||E.data&&Array.isArray(E.data));u(R?{success:!0,message:"API connection successful!"}:{success:!1,message:"API responded but returned unexpected data format"})}else u({success:!1,message:`API returned status ${k.status}`})}catch(T){u({success:!1,message:`Connection failed: ${T instanceof Error?T.message:"Unknown error"}`})}finally{d(!1)}};return a?t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Development"}),t.jsx("p",{className:"text-gray-400",children:"Developer and testing options"})]}),t.jsx("div",{className:"text-center py-12",children:t.jsx("p",{className:"text-gray-500",children:"Loading development settings..."})})]}):t.jsxs("div",{children:[t.jsx(Rn,{title:"Development",subtitle:"Developer and testing options (advanced users only)",onSave:v,isSaving:s,hasUnsavedChanges:n,saveButtonText:"Save Changes"}),t.jsxs("div",{className:"max-w-4xl mx-auto px-6",children:[t.jsx("div",{className:"mb-8 bg-gradient-to-br from-yellow-900/30 to-orange-900/20 border border-yellow-600/50 rounded-lg p-6",children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx(Pr,{className:"w-8 h-8 text-yellow-500 flex-shrink-0"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-yellow-400 mb-2",children:"Developer Settings"}),t.jsx("p",{className:"text-yellow-300/80 text-sm",children:"These settings are intended for developers and testers only. Modifying these settings incorrectly may cause Sportarr to malfunction. Only change these if you know what you're doing."})]})]})}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-purple-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx(Jk,{className:"w-6 h-6 text-purple-400 mr-3"}),t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Custom Metadata API"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-white font-medium mb-2",children:"Custom API URL"}),t.jsx("input",{type:"url",value:g.customMetadataApiUrl,onChange:S=>x(T=>({...T,customMetadataApiUrl:S.target.value})),placeholder:"https://sportarr.net/api/v2/json",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-purple-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Override the metadata API URL for testing. Leave empty to use the default sportarr.net API."})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:w,disabled:c,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-purple-600/50 text-white text-sm font-medium rounded-lg transition-colors",children:c?"Testing...":"Test Connection"}),f&&t.jsx("div",{className:`text-sm ${f.success?"text-green-400":"text-red-400"}`,children:f.message})]}),t.jsxs("div",{className:"mt-4 p-4 bg-gray-800/50 border border-gray-700 rounded-lg",children:[t.jsx("h4",{className:"text-white font-medium mb-2",children:"API URL Format"}),t.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"The API URL should point to a TheSportsDB-compatible API. The default is:"}),t.jsx("code",{className:"block text-sm text-purple-400 bg-gray-900 px-3 py-2 rounded",children:"https://sportarr.net/api/v2/json"}),t.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Changes take effect immediately - no restart required."})]})]})]})]})]})}const Tt=Number.isFinite||function(a){return typeof a=="number"&&isFinite(a)},ZI=Number.isSafeInteger||function(a){return typeof a=="number"&&Math.abs(a)<=JI},JI=Number.MAX_SAFE_INTEGER||9007199254740991;let Ft=(function(a){return a.NETWORK_ERROR="networkError",a.MEDIA_ERROR="mediaError",a.KEY_SYSTEM_ERROR="keySystemError",a.MUX_ERROR="muxError",a.OTHER_ERROR="otherError",a})({}),ze=(function(a){return a.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",a.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",a.KEY_SYSTEM_NO_SESSION="keySystemNoSession",a.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",a.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",a.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",a.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",a.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",a.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",a.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",a.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",a.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",a.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",a.MANIFEST_LOAD_ERROR="manifestLoadError",a.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",a.MANIFEST_PARSING_ERROR="manifestParsingError",a.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",a.LEVEL_EMPTY_ERROR="levelEmptyError",a.LEVEL_LOAD_ERROR="levelLoadError",a.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",a.LEVEL_PARSING_ERROR="levelParsingError",a.LEVEL_SWITCH_ERROR="levelSwitchError",a.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",a.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",a.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",a.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",a.FRAG_LOAD_ERROR="fragLoadError",a.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",a.FRAG_DECRYPT_ERROR="fragDecryptError",a.FRAG_PARSING_ERROR="fragParsingError",a.FRAG_GAP="fragGap",a.REMUX_ALLOC_ERROR="remuxAllocError",a.KEY_LOAD_ERROR="keyLoadError",a.KEY_LOAD_TIMEOUT="keyLoadTimeOut",a.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",a.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",a.BUFFER_APPEND_ERROR="bufferAppendError",a.BUFFER_APPENDING_ERROR="bufferAppendingError",a.BUFFER_STALLED_ERROR="bufferStalledError",a.BUFFER_FULL_ERROR="bufferFullError",a.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",a.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",a.ASSET_LIST_LOAD_ERROR="assetListLoadError",a.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",a.ASSET_LIST_PARSING_ERROR="assetListParsingError",a.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",a.INTERNAL_EXCEPTION="internalException",a.INTERNAL_ABORTED="aborted",a.ATTACH_MEDIA_ERROR="attachMediaError",a.UNKNOWN="unknown",a})({}),Q=(function(a){return a.MEDIA_ATTACHING="hlsMediaAttaching",a.MEDIA_ATTACHED="hlsMediaAttached",a.MEDIA_DETACHING="hlsMediaDetaching",a.MEDIA_DETACHED="hlsMediaDetached",a.MEDIA_ENDED="hlsMediaEnded",a.STALL_RESOLVED="hlsStallResolved",a.BUFFER_RESET="hlsBufferReset",a.BUFFER_CODECS="hlsBufferCodecs",a.BUFFER_CREATED="hlsBufferCreated",a.BUFFER_APPENDING="hlsBufferAppending",a.BUFFER_APPENDED="hlsBufferAppended",a.BUFFER_EOS="hlsBufferEos",a.BUFFERED_TO_END="hlsBufferedToEnd",a.BUFFER_FLUSHING="hlsBufferFlushing",a.BUFFER_FLUSHED="hlsBufferFlushed",a.MANIFEST_LOADING="hlsManifestLoading",a.MANIFEST_LOADED="hlsManifestLoaded",a.MANIFEST_PARSED="hlsManifestParsed",a.LEVEL_SWITCHING="hlsLevelSwitching",a.LEVEL_SWITCHED="hlsLevelSwitched",a.LEVEL_LOADING="hlsLevelLoading",a.LEVEL_LOADED="hlsLevelLoaded",a.LEVEL_UPDATED="hlsLevelUpdated",a.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",a.LEVELS_UPDATED="hlsLevelsUpdated",a.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",a.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",a.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",a.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",a.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",a.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",a.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",a.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",a.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",a.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",a.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",a.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",a.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",a.CUES_PARSED="hlsCuesParsed",a.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",a.INIT_PTS_FOUND="hlsInitPtsFound",a.FRAG_LOADING="hlsFragLoading",a.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",a.FRAG_LOADED="hlsFragLoaded",a.FRAG_DECRYPTED="hlsFragDecrypted",a.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",a.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",a.FRAG_PARSING_METADATA="hlsFragParsingMetadata",a.FRAG_PARSED="hlsFragParsed",a.FRAG_BUFFERED="hlsFragBuffered",a.FRAG_CHANGED="hlsFragChanged",a.FPS_DROP="hlsFpsDrop",a.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",a.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",a.ERROR="hlsError",a.DESTROYING="hlsDestroying",a.KEY_LOADING="hlsKeyLoading",a.KEY_LOADED="hlsKeyLoaded",a.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",a.BACK_BUFFER_REACHED="hlsBackBufferReached",a.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",a.ASSET_LIST_LOADING="hlsAssetListLoading",a.ASSET_LIST_LOADED="hlsAssetListLoaded",a.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",a.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",a.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",a.INTERSTITIAL_STARTED="hlsInterstitialStarted",a.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",a.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",a.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",a.INTERSTITIAL_ENDED="hlsInterstitialEnded",a.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",a.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",a.EVENT_CUE_ENTER="hlsEventCueEnter",a})({});var us={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Rt={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class Hl{constructor(e,s=0,r=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=s,this.totalWeight_=r}sample(e,s){const r=Math.pow(this.alpha_,e);this.estimate_=s*(1-r)+r*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class eM{constructor(e,s,r,n=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Hl(e),this.fast_=new Hl(s),this.defaultTTFB_=n,this.ttfb_=new Hl(e)}update(e,s){const{slow_:r,fast_:n,ttfb_:o}=this;r.halfLife!==e&&(this.slow_=new Hl(e,r.getEstimate(),r.getTotalWeight())),n.halfLife!==s&&(this.fast_=new Hl(s,n.getEstimate(),n.getTotalWeight())),o.halfLife!==e&&(this.ttfb_=new Hl(e,o.getEstimate(),o.getTotalWeight()))}sample(e,s){e=Math.max(e,this.minDelayMs_);const r=8*s,n=e/1e3,o=r/n;this.fast_.sample(n,o),this.slow_.sample(n,o)}sampleTTFB(e){const s=e/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(s,2)/2);this.ttfb_.sample(r,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function tM(a,e,s){return(e=rM(e))in a?Object.defineProperty(a,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[e]=s,a}function Us(){return Us=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var r in s)({}).hasOwnProperty.call(s,r)&&(a[r]=s[r])}return a},Us.apply(null,arguments)}function e1(a,e){var s=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(a,n).enumerable})),s.push.apply(s,r)}return s}function Is(a){for(var e=1;e<arguments.length;e++){var s=arguments[e]!=null?arguments[e]:{};e%2?e1(Object(s),!0).forEach(function(r){tM(a,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(s)):e1(Object(s)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(s,r))})}return a}function sM(a,e){if(typeof a!="object"||!a)return a;var s=a[Symbol.toPrimitive];if(s!==void 0){var r=s.call(a,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(a)}function rM(a){var e=sM(a,"string");return typeof e=="symbol"?e:e+""}class qa{constructor(e,s){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const r=`[${e}]:`;this.trace=Hi,this.debug=s.debug.bind(null,r),this.log=s.log.bind(null,r),this.warn=s.warn.bind(null,r),this.info=s.info.bind(null,r),this.error=s.error.bind(null,r)}}const Hi=function(){},aM={trace:Hi,debug:Hi,log:Hi,warn:Hi,info:Hi,error:Hi};function Mp(){return Us({},aM)}function nM(a,e){const s=self.console[a];return s?s.bind(self.console,`${e?"["+e+"] ":""}[${a}] >`):Hi}function t1(a,e,s){return e[a]?e[a].bind(e):nM(a,s)}const Pp=Mp();function iM(a,e,s){const r=Mp();if(typeof console=="object"&&a===!0||typeof a=="object"){const n=["debug","log","info","warn","error"];n.forEach(o=>{r[o]=t1(o,a,s)});try{r.log(`Debug logs enabled for "${e}" in hls.js version 1.6.15`)}catch{return Mp()}n.forEach(o=>{Pp[o]=t1(o,a)})}else Us(Pp,r);return r}const Ms=Pp;function co(a=!0){return typeof self>"u"?void 0:(a||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function oM(a){return typeof self<"u"&&a===self.ManagedMediaSource}function bj(a,e){const s=Object.keys(a),r=Object.keys(e),n=s.length,o=r.length;return!n||!o||n===o&&!s.some(c=>r.indexOf(c)===-1)}function ja(a,e=!1){if(typeof TextDecoder<"u"){const u=new TextDecoder("utf-8").decode(a);if(e){const m=u.indexOf("\0");return m!==-1?u.substring(0,m):u}return u.replace(/\0/g,"")}const s=a.length;let r,n,o,c="",d=0;for(;d<s;){if(r=a[d++],r===0&&e)return c;if(r===0||r===3)continue;switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c+=String.fromCharCode(r);break;case 12:case 13:n=a[d++],c+=String.fromCharCode((r&31)<<6|n&63);break;case 14:n=a[d++],o=a[d++],c+=String.fromCharCode((r&15)<<12|(n&63)<<6|(o&63)<<0);break}}return c}function Ir(a){let e="";for(let s=0;s<a.length;s++){let r=a[s].toString(16);r.length<2&&(r="0"+r),e+=r}return e}function vj(a){return Uint8Array.from(a.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function lM(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Tg={exports:{}},s1;function cM(){return s1||(s1=1,(function(a,e){(function(s){var r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,n=/^(?=([^\/?#]*))\1([^]*)$/,o=/(?:\/|^)\.(?=\/)/g,c=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,d={buildAbsoluteURL:function(f,u,m){if(m=m||{},f=f.trim(),u=u.trim(),!u){if(!m.alwaysNormalize)return f;var g=d.parseURL(f);if(!g)throw new Error("Error trying to parse base URL.");return g.path=d.normalizePath(g.path),d.buildURLFromParts(g)}var x=d.parseURL(u);if(!x)throw new Error("Error trying to parse relative URL.");if(x.scheme)return m.alwaysNormalize?(x.path=d.normalizePath(x.path),d.buildURLFromParts(x)):u;var b=d.parseURL(f);if(!b)throw new Error("Error trying to parse base URL.");if(!b.netLoc&&b.path&&b.path[0]!=="/"){var v=n.exec(b.path);b.netLoc=v[1],b.path=v[2]}b.netLoc&&!b.path&&(b.path="/");var w={scheme:b.scheme,netLoc:x.netLoc,path:null,params:x.params,query:x.query,fragment:x.fragment};if(!x.netLoc&&(w.netLoc=b.netLoc,x.path[0]!=="/"))if(!x.path)w.path=b.path,x.params||(w.params=b.params,x.query||(w.query=b.query));else{var S=b.path,T=S.substring(0,S.lastIndexOf("/")+1)+x.path;w.path=d.normalizePath(T)}return w.path===null&&(w.path=m.alwaysNormalize?d.normalizePath(x.path):x.path),d.buildURLFromParts(w)},parseURL:function(f){var u=r.exec(f);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(f){for(f=f.split("").reverse().join("").replace(o,"");f.length!==(f=f.replace(c,"")).length;);return f.split("").reverse().join("")},buildURLFromParts:function(f){return f.scheme+f.netLoc+f.path+f.params+f.query+f.fragment}};a.exports=d})()})(Tg)),Tg.exports}var Cx=cM();class kx{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Hs={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class wj{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,uM(this,"stats")}setByteRange(e,s){const r=e.split("@",2);let n;r.length===1?n=(s==null?void 0:s.byteRangeEndOffset)||0:n=parseInt(r[1]),this._byteRange=[n,parseInt(r[0])+n]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[Hs.AUDIO]:null,[Hs.VIDEO]:null,[Hs.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new kx),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Cx.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[Hs.AUDIO]=null,e[Hs.VIDEO]=null,e[Hs.AUDIOVIDEO]=null}}function ur(a){return a.sn!=="initSegment"}class Ag extends wj{constructor(e,s){super(s),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange.length){const e=this.byteRange[0],s=this.byteRange[1];if(Tt(e)&&Tt(s))return s-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){var e;const{levelkeys:s}=this;if(!s||s.NONE)return null;if(s.identity)this._decryptdata||(this._decryptdata=s.identity.getDecryptData(this.sn));else if(!((e=this._decryptdata)!=null&&e.keyId)){const r=Object.keys(s);if(r.length===1){const n=this._decryptdata=s[r[0]]||null;n&&(this._decryptdata=n.getDecryptData(this.sn,s))}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=Tt(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){var s;const r=Object.keys(this.levelkeys),n=r.length;if(n>1||n===1&&(s=this.levelkeys[r[0]])!=null&&s.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!Tt(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return ur(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){const s=this.levelkeys;if(s){var r;const n=s[e];n&&!((r=this._decryptdata)!=null&&r.keyId)&&(this._decryptdata=n.getDecryptData(this.sn,s))}}abortRequests(){var e,s;(e=this.loader)==null||e.abort(),(s=this.keyLoader)==null||s.abort()}setElementaryStreamInfo(e,s,r,n,o,c=!1){const{elementaryStreams:d}=this,f=d[e];if(!f){d[e]={startPTS:s,endPTS:r,startDTS:n,endDTS:o,partial:c};return}f.startPTS=Math.min(f.startPTS,s),f.endPTS=Math.max(f.endPTS,r),f.startDTS=Math.min(f.startDTS,n),f.endDTS=Math.max(f.endDTS,o)}}class dM extends wj{constructor(e,s,r,n,o){super(r),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=s,this.index=n;const c=e.enumeratedString("BYTERANGE");c&&this.setByteRange(c,o),o&&(this.fragOffset=o.fragOffset+o.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function Sj(a,e){const s=Object.getPrototypeOf(a);if(s){const r=Object.getOwnPropertyDescriptor(s,e);return r||Sj(s,e)}}function uM(a,e){const s=Sj(a,e);s&&(s.enumerable=!0,Object.defineProperty(a,e,s))}const r1=Math.pow(2,32)-1,hM=[].push,_j={video:1,audio:2,id3:3,text:4};function wr(a){return String.fromCharCode.apply(null,a)}function Nj(a,e){const s=a[e]<<8|a[e+1];return s<0?65536+s:s}function Xt(a,e){const s=jj(a,e);return s<0?4294967296+s:s}function a1(a,e){let s=Xt(a,e);return s*=Math.pow(2,32),s+=Xt(a,e+4),s}function jj(a,e){return a[e]<<24|a[e+1]<<16|a[e+2]<<8|a[e+3]}function fM(a){const e=a.byteLength;for(let s=0;s<e;){const r=Xt(a,s);if(r>8&&a[s+4]===109&&a[s+5]===111&&a[s+6]===111&&a[s+7]===102)return!0;s=r>1?s+r:e}return!1}function ls(a,e){const s=[];if(!e.length)return s;const r=a.byteLength;for(let n=0;n<r;){const o=Xt(a,n),c=wr(a.subarray(n+4,n+8)),d=o>1?n+o:r;if(c===e[0])if(e.length===1)s.push(a.subarray(n+8,d));else{const f=ls(a.subarray(n+8,d),e.slice(1));f.length&&hM.apply(s,f)}n=d}return s}function mM(a){const e=[],s=a[0];let r=8;const n=Xt(a,r);r+=4;let o=0,c=0;s===0?(o=Xt(a,r),c=Xt(a,r+4),r+=8):(o=a1(a,r),c=a1(a,r+8),r+=16),r+=2;let d=a.length+c;const f=Nj(a,r);r+=2;for(let u=0;u<f;u++){let m=r;const g=Xt(a,m);m+=4;const x=g&2147483647;if((g&2147483648)>>>31===1)return Ms.warn("SIDX has hierarchical references (not supported)"),null;const v=Xt(a,m);m+=4,e.push({referenceSize:x,subsegmentDuration:v,info:{duration:v/n,start:d,end:d+x-1}}),d+=x,m+=4,r=m}return{earliestPresentationTime:o,timescale:n,version:s,referencesCount:f,references:e}}function Ej(a){const e=[],s=ls(a,["moov","trak"]);for(let n=0;n<s.length;n++){const o=s[n],c=ls(o,["tkhd"])[0];if(c){let d=c[0];const f=Xt(c,d===0?12:20),u=ls(o,["mdia","mdhd"])[0];if(u){d=u[0];const m=Xt(u,d===0?12:20),g=ls(o,["mdia","hdlr"])[0];if(g){const x=wr(g.subarray(8,12)),b={soun:Hs.AUDIO,vide:Hs.VIDEO}[x],v=ls(o,["mdia","minf","stbl","stsd"])[0],w=gM(v);b?(e[f]={timescale:m,type:b,stsd:w},e[b]=Is({timescale:m,id:f},w)):e[f]={timescale:m,type:x,stsd:w}}}}}return ls(a,["moov","mvex","trex"]).forEach(n=>{const o=Xt(n,4),c=e[o];c&&(c.default={duration:Xt(n,12),flags:Xt(n,20)})}),e}function gM(a){const e=a.subarray(8),s=e.subarray(86),r=wr(e.subarray(4,8));let n=r,o;const c=r==="enca"||r==="encv";if(c){const u=ls(e,[r])[0].subarray(r==="enca"?28:78);ls(u,["sinf"]).forEach(g=>{const x=ls(g,["schm"])[0];if(x){const b=wr(x.subarray(4,8));if(b==="cbcs"||b==="cenc"){const v=ls(g,["frma"])[0];v&&(n=wr(v))}}})}const d=n;switch(n){case"avc1":case"avc2":case"avc3":case"avc4":{const f=ls(s,["avcC"])[0];f&&f.length>3&&(n+="."+Lh(f[1])+Lh(f[2])+Lh(f[3]),o=Rh(d==="avc1"?"dva1":"dvav",s));break}case"mp4a":{const f=ls(e,[r])[0],u=ls(f.subarray(28),["esds"])[0];if(u&&u.length>7){let m=4;if(u[m++]!==3)break;m=Cg(u,m),m+=2;const g=u[m++];if(g&128&&(m+=2),g&64&&(m+=u[m++]),u[m++]!==4)break;m=Cg(u,m);const x=u[m++];if(x===64)n+="."+Lh(x);else break;if(m+=12,u[m++]!==5)break;m=Cg(u,m);const b=u[m++];let v=(b&248)>>3;v===31&&(v+=1+((b&7)<<3)+((u[m]&224)>>5)),n+="."+v}break}case"hvc1":case"hev1":{const f=ls(s,["hvcC"])[0];if(f&&f.length>12){const u=f[1],m=["","A","B","C"][u>>6],g=u&31,x=Xt(f,2),b=(u&32)>>5?"H":"L",v=f[12],w=f.subarray(6,12);n+="."+m+g,n+="."+pM(x).toString(16).toUpperCase(),n+="."+b+v;let S="";for(let T=w.length;T--;){const k=w[T];(k||S)&&(S="."+k.toString(16).toUpperCase()+S)}n+=S}o=Rh(d=="hev1"?"dvhe":"dvh1",s);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{n=Rh(n,s)||n;break}case"vp09":{const f=ls(s,["vpcC"])[0];if(f&&f.length>6){const u=f[4],m=f[5],g=f[6]>>4&15;n+="."+yn(u)+"."+yn(m)+"."+yn(g)}break}case"av01":{const f=ls(s,["av1C"])[0];if(f&&f.length>2){const u=f[1]>>>5,m=f[1]&31,g=f[2]>>>7?"H":"M",x=(f[2]&64)>>6,b=(f[2]&32)>>5,v=u===2&&x?b?12:10:x?10:8,w=(f[2]&16)>>4,S=(f[2]&8)>>3,T=(f[2]&4)>>2,k=f[2]&3;n+="."+u+"."+yn(m)+g+"."+yn(v)+"."+w+"."+S+T+k+"."+yn(1)+"."+yn(1)+"."+yn(1)+"."+0,o=Rh("dav1",s)}break}}return{codec:n,encrypted:c,supplemental:o}}function Rh(a,e){const s=ls(e,["dvvC"]),r=s.length?s[0]:ls(e,["dvcC"])[0];if(r){const n=r[2]>>1&127,o=r[2]<<5&32|r[3]>>3&31;return a+"."+yn(n)+"."+yn(o)}}function pM(a){let e=0;for(let s=0;s<32;s++)e|=(a>>s&1)<<31-s;return e>>>0}function Cg(a,e){const s=e+5;for(;a[e++]&128&&e<s;);return e}function Lh(a){return("0"+a.toString(16).toUpperCase()).slice(-2)}function yn(a){return(a<10?"0":"")+a}function xM(a,e){if(!a||!e)return;const s=e.keyId;s&&e.isCommonEncryption&&Tj(a,(r,n)=>{const o=r.subarray(8,24);o.some(c=>c!==0)||(Ms.log(`[eme] Patching keyId in 'enc${n?"a":"v"}>sinf>>tenc' box: ${Ir(o)} -> ${Ir(s)}`),r.set(s,8))})}function yM(a){const e=[];return Tj(a,s=>e.push(s.subarray(8,24))),e}function Tj(a,e){ls(a,["moov","trak"]).forEach(r=>{const n=ls(r,["mdia","minf","stbl","stsd"])[0];if(!n)return;const o=n.subarray(8);let c=ls(o,["enca"]);const d=c.length>0;d||(c=ls(o,["encv"])),c.forEach(f=>{const u=d?f.subarray(28):f.subarray(78);ls(u,["sinf"]).forEach(g=>{const x=Aj(g);x&&e(x,d)})})})}function Aj(a){const e=ls(a,["schm"])[0];if(e){const s=wr(e.subarray(4,8));if(s==="cbcs"||s==="cenc"){const r=ls(a,["schi","tenc"])[0];if(r)return r}}}function bM(a,e,s){const r={},n=ls(a,["moof","traf"]);for(let o=0;o<n.length;o++){const c=n[o],d=ls(c,["tfhd"])[0],f=Xt(d,4),u=e[f];if(!u)continue;r[f]||(r[f]={start:NaN,duration:0,sampleCount:0,timescale:u.timescale,type:u.type});const m=r[f],g=ls(c,["tfdt"])[0];if(g){const E=g[0];let R=Xt(g,4);E===1&&(R===r1?s.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(R*=r1+1,R+=Xt(g,8))),Tt(R)&&(!Tt(m.start)||R<m.start)&&(m.start=R)}const x=u.default,b=Xt(d,0)|(x==null?void 0:x.flags);let v=(x==null?void 0:x.duration)||0;b&8&&(b&2?v=Xt(d,12):v=Xt(d,8));const w=ls(c,["trun"]);let S=m.start||0,T=0,k=v;for(let E=0;E<w.length;E++){const R=w[E],K=Xt(R,4),z=m.sampleCount;m.sampleCount+=K;const D=R[3]&1,O=R[3]&4,U=R[2]&1,I=R[2]&2,F=R[2]&4,te=R[2]&8;let le=8,H=K;for(D&&(le+=4),O&&K&&(!(R[le+1]&1)&&m.keyFrameIndex===void 0&&(m.keyFrameIndex=z),le+=4,U?(k=Xt(R,le),le+=4):k=v,I&&(le+=4),te&&(le+=4),S+=k,T+=k,H--);H--;)U?(k=Xt(R,le),le+=4):k=v,I&&(le+=4),F&&(R[le+1]&1||m.keyFrameIndex===void 0&&(m.keyFrameIndex=m.sampleCount-(H+1),m.keyFrameStart=S),le+=4),te&&(le+=4),S+=k,T+=k;!T&&v&&(T+=v*K)}m.duration+=T}if(!Object.keys(r).some(o=>r[o].duration)){let o=1/0,c=0;const d=ls(a,["sidx"]);for(let f=0;f<d.length;f++){const u=mM(d[f]);if(u!=null&&u.references){o=Math.min(o,u.earliestPresentationTime/u.timescale);const m=u.references.reduce((g,x)=>g+x.info.duration||0,0);c=Math.max(c,m+u.earliestPresentationTime/u.timescale)}}c&&Tt(c)&&Object.keys(r).forEach(f=>{r[f].duration||(r[f].duration=c*r[f].timescale-r[f].start)})}return r}function vM(a){const e={valid:null,remainder:null},s=ls(a,["moof"]);if(s.length<2)return e.remainder=a,e;const r=s[s.length-1];return e.valid=a.slice(0,r.byteOffset-8),e.remainder=a.slice(r.byteOffset-8),e}function Ha(a,e){const s=new Uint8Array(a.length+e.length);return s.set(a),s.set(e,a.length),s}function n1(a,e){const s=[],r=e.samples,n=e.timescale,o=e.id;let c=!1;return ls(r,["moof"]).map(f=>{const u=f.byteOffset-8;ls(f,["traf"]).map(g=>{const x=ls(g,["tfdt"]).map(b=>{const v=b[0];let w=Xt(b,4);return v===1&&(w*=Math.pow(2,32),w+=Xt(b,8)),w/n})[0];return x!==void 0&&(a=x),ls(g,["tfhd"]).map(b=>{const v=Xt(b,4),w=Xt(b,0)&16777215,S=(w&1)!==0,T=(w&2)!==0,k=(w&8)!==0;let E=0;const R=(w&16)!==0;let K=0;const z=(w&32)!==0;let D=8;v===o&&(S&&(D+=8),T&&(D+=4),k&&(E=Xt(b,D),D+=4),R&&(K=Xt(b,D),D+=4),z&&(D+=4),e.type==="video"&&(c=Jf(e.codec)),ls(g,["trun"]).map(O=>{const U=O[0],I=Xt(O,0)&16777215,F=(I&1)!==0;let te=0;const le=(I&4)!==0,H=(I&256)!==0;let X=0;const q=(I&512)!==0;let ae=0;const ce=(I&1024)!==0,ee=(I&2048)!==0;let W=0;const V=Xt(O,4);let G=8;F&&(te=Xt(O,G),G+=4),le&&(G+=4);let Z=te+u;for(let oe=0;oe<V;oe++){if(H?(X=Xt(O,G),G+=4):X=E,q?(ae=Xt(O,G),G+=4):ae=K,ce&&(G+=4),ee&&(U===0?W=Xt(O,G):W=jj(O,G),G+=4),e.type===Hs.VIDEO){let ye=0;for(;ye<ae;){const je=Xt(r,Z);if(Z+=4,wM(c,r[Z])){const xe=r.subarray(Z,Z+je);Rx(xe,c?2:1,a+W/n,s)}Z+=je,ye+=je+4}}a+=X/n}}))})})}),s}function Jf(a){if(!a)return!1;const e=a.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function wM(a,e){if(a){const s=e>>1&63;return s===39||s===40}else return(e&31)===6}function Rx(a,e,s,r){const n=Cj(a);let o=0;o+=e;let c=0,d=0,f=0;for(;o<n.length;){c=0;do{if(o>=n.length)break;f=n[o++],c+=f}while(f===255);d=0;do{if(o>=n.length)break;f=n[o++],d+=f}while(f===255);const u=n.length-o;let m=o;if(d<u)o+=d;else if(d>u){Ms.error(`Malformed SEI payload. ${d} is too small, only ${u} bytes left to parse.`);break}if(c===4){if(n[m++]===181){const x=Nj(n,m);if(m+=2,x===49){const b=Xt(n,m);if(m+=4,b===1195456820){const v=n[m++];if(v===3){const w=n[m++],S=31&w,T=64&w,k=T?2+S*3:0,E=new Uint8Array(k);if(T){E[0]=w;for(let R=1;R<k;R++)E[R]=n[m++]}r.push({type:v,payloadType:c,pts:s,bytes:E})}}}}}else if(c===5&&d>16){const g=[];for(let v=0;v<16;v++){const w=n[m++].toString(16);g.push(w.length==1?"0"+w:w),(v===3||v===5||v===7||v===9)&&g.push("-")}const x=d-16,b=new Uint8Array(x);for(let v=0;v<x;v++)b[v]=n[m++];r.push({payloadType:c,pts:s,uuid:g.join(""),userData:ja(b),userDataBytes:b})}}}function Cj(a){const e=a.byteLength,s=[];let r=1;for(;r<e-2;)a[r]===0&&a[r+1]===0&&a[r+2]===3?(s.push(r+2),r+=2):r++;if(s.length===0)return a;const n=e-s.length,o=new Uint8Array(n);let c=0;for(r=0;r<n;c++,r++)c===s[0]&&(c++,s.shift()),o[r]=a[c];return o}function SM(a){const e=a[0];let s="",r="",n=0,o=0,c=0,d=0,f=0,u=0;if(e===0){for(;wr(a.subarray(u,u+1))!=="\0";)s+=wr(a.subarray(u,u+1)),u+=1;for(s+=wr(a.subarray(u,u+1)),u+=1;wr(a.subarray(u,u+1))!=="\0";)r+=wr(a.subarray(u,u+1)),u+=1;r+=wr(a.subarray(u,u+1)),u+=1,n=Xt(a,12),o=Xt(a,16),d=Xt(a,20),f=Xt(a,24),u=28}else if(e===1){u+=4,n=Xt(a,u),u+=4;const g=Xt(a,u);u+=4;const x=Xt(a,u);for(u+=4,c=2**32*g+x,ZI(c)||(c=Number.MAX_SAFE_INTEGER,Ms.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),d=Xt(a,u),u+=4,f=Xt(a,u),u+=4;wr(a.subarray(u,u+1))!=="\0";)s+=wr(a.subarray(u,u+1)),u+=1;for(s+=wr(a.subarray(u,u+1)),u+=1;wr(a.subarray(u,u+1))!=="\0";)r+=wr(a.subarray(u,u+1)),u+=1;r+=wr(a.subarray(u,u+1)),u+=1}const m=a.subarray(u,a.byteLength);return{schemeIdUri:s,value:r,timeScale:n,presentationTime:c,presentationTimeDelta:o,eventDuration:d,id:f,payload:m}}function _M(a,...e){const s=e.length;let r=8,n=s;for(;n--;)r+=e[n].byteLength;const o=new Uint8Array(r);for(o[0]=r>>24&255,o[1]=r>>16&255,o[2]=r>>8&255,o[3]=r&255,o.set(a,4),n=0,r=8;n<s;n++)o.set(e[n],r),r+=e[n].byteLength;return o}function NM(a,e,s){if(a.byteLength!==16)throw new RangeError("Invalid system id");let r,n;r=0,n=new Uint8Array;let o;r>0?(o=new Uint8Array(4),e.length>0&&new DataView(o.buffer).setUint32(0,e.length,!1)):o=new Uint8Array;const c=new Uint8Array(4);return s.byteLength>0&&new DataView(c.buffer).setUint32(0,s.byteLength,!1),_M([112,115,115,104],new Uint8Array([r,0,0,0]),a,o,n,c,s)}function jM(a){const e=[];if(a instanceof ArrayBuffer){const s=a.byteLength;let r=0;for(;r+32<s;){const n=new DataView(a,r),o=EM(n);e.push(o),r+=o.size}}return e}function EM(a){const e=a.getUint32(0),s=a.byteOffset,r=a.byteLength;if(r<e)return{offset:s,size:r};if(a.getUint32(4)!==1886614376)return{offset:s,size:e};const o=a.getUint32(8)>>>24;if(o!==0&&o!==1)return{offset:s,size:e};const c=a.buffer,d=Ir(new Uint8Array(c,s+12,16));let f=null,u=null,m=0;if(o===0)m=28;else{const x=a.getUint32(28);if(!x||r<32+x*16)return{offset:s,size:e};f=[];for(let b=0;b<x;b++)f.push(new Uint8Array(c,s+32+b*16,16));m=32+x*16}if(!m)return{offset:s,size:e};const g=a.getUint32(m);return e-32<g?{offset:s,size:e}:(u=new Uint8Array(c,s+m+4,g),{version:o,systemId:d,kids:f,data:u,offset:s,size:e})}const kj=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),gc={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Lx(a,e){const s=gc[e];return!!s&&!!s[a.slice(0,4)]}function Bd(a,e,s=!0){return!a.split(",").some(r=>!Dx(r,e,s))}function Dx(a,e,s=!0){var r;const n=co(s);return(r=n==null?void 0:n.isTypeSupported(Ud(a,e)))!=null?r:!1}function Ud(a,e){return`${e}/mp4;codecs=${a}`}function i1(a){if(a){const e=a.substring(0,4);return gc.video[e]}return 2}function _f(a){const e=kj();return a.split(",").reduce((s,r)=>{const o=e&&Jf(r)?9:gc.video[r];return o?(o*2+s)/(s?3:2):(gc.audio[r]+s)/(s?2:1)},0)}const kg={};function TM(a,e=!0){if(kg[a])return kg[a];const s={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[a];for(let n=0;n<s.length;n++){var r;if(Dx(s[n],"audio",e))return kg[a]=s[n],s[n];if(s[n]==="mp3"&&(r=co(e))!=null&&r.isTypeSupported("audio/mpeg"))return""}return a}const AM=/flac|opus|mp4a\.40\.34/i;function Nf(a,e=!0){return a.replace(AM,s=>TM(s.toLowerCase(),e))}function CM(a,e){const s=[];if(a){const r=a.split(",");for(let n=0;n<r.length;n++)Lx(r[n],"video")||s.push(r[n])}return e&&s.push(e),s.join(",")}function af(a,e){if(a&&(a.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(a)!==-1)&&(o1(a,"audio")||o1(a,"video")))return a;if(e){const s=e.split(",");if(s.length>1){if(a){for(let r=s.length;r--;)if(s[r].substring(0,4)===a.substring(0,4))return s[r]}return s[0]}}return e||a}function o1(a,e){return Lx(a,e)&&Dx(a,e)}function kM(a){const e=a.split(",");for(let s=0;s<e.length;s++){const r=e[s].split(".");r.length>2&&r[0]==="avc1"&&(e[s]=`avc1.${parseInt(r[1]).toString(16)}${("000"+parseInt(r[2]).toString(16)).slice(-4)}`)}return e.join(",")}function RM(a){if(a.startsWith("av01.")){const e=a.split("."),s=["0","111","01","01","01","0"];for(let r=e.length;r>4&&r<10;r++)e[r]=s[r-4];return e.join(".")}return a}function l1(a){const e=co(a)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function Op(a){return a.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const LM={supported:!0,powerEfficient:!0,smooth:!0},DM={supported:!1,smooth:!1,powerEfficient:!1},Rj={supported:!0,configurations:[],decodingInfoResults:[LM]};function Lj(a,e){return{supported:!1,configurations:e,decodingInfoResults:[DM],error:a}}function IM(a,e,s,r,n,o){const c=a.videoCodec,d=a.audioCodec?a.audioGroups:null,f=o==null?void 0:o.audioCodec,u=o==null?void 0:o.channels,m=u?parseInt(u):f?1/0:2;let g=null;if(d!=null&&d.length)try{d.length===1&&d[0]?g=e.groups[d[0]].channels:g=d.reduce((x,b)=>{if(b){const v=e.groups[b];if(!v)throw new Error(`Audio track group ${b} not found`);Object.keys(v.channels).forEach(w=>{x[w]=(x[w]||0)+v.channels[w]})}return x},{2:0})}catch{return!0}return c!==void 0&&(c.split(",").some(x=>Jf(x))||a.width>1920&&a.height>1088||a.height>1920&&a.width>1088||a.frameRate>Math.max(r,30)||a.videoRange!=="SDR"&&a.videoRange!==s||a.bitrate>Math.max(n,8e6))||!!g&&Tt(m)&&Object.keys(g).some(x=>parseInt(x)>m)}function Dj(a,e,s,r={}){const n=a.videoCodec;if(!n&&!a.audioCodec||!s)return Promise.resolve(Rj);const o=[],c=MM(a),d=c.length,f=PM(a,e,d>0),u=f.length;for(let m=d||1*u||1;m--;){const g={type:"media-source"};if(d&&(g.video=c[m%d]),u){g.audio=f[m%u];const x=g.audio.bitrate;g.video&&x&&(g.video.bitrate-=x)}o.push(g)}if(n){const m=navigator.userAgent;if(n.split(",").some(g=>Jf(g))&&kj())return Promise.resolve(Lj(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${m})`),o))}return Promise.all(o.map(m=>{const g=FM(m);return r[g]||(r[g]=s.decodingInfo(m))})).then(m=>({supported:!m.some(g=>!g.supported),configurations:o,decodingInfoResults:m})).catch(m=>({supported:!1,configurations:o,decodingInfoResults:[],error:m}))}function MM(a){var e;const s=(e=a.videoCodec)==null?void 0:e.split(","),r=Ij(a),n=a.width||640,o=a.height||480,c=a.frameRate||30,d=a.videoRange.toLowerCase();return s?s.map(f=>{const u={contentType:Ud(RM(f),"video"),width:n,height:o,bitrate:r,framerate:c};return d!=="sdr"&&(u.transferFunction=d),u}):[]}function PM(a,e,s){var r;const n=(r=a.audioCodec)==null?void 0:r.split(","),o=Ij(a);return n&&a.audioGroups?a.audioGroups.reduce((c,d)=>{var f;const u=d?(f=e.groups[d])==null?void 0:f.tracks:null;return u?u.reduce((m,g)=>{if(g.groupId===d){const x=parseFloat(g.channels||"");n.forEach(b=>{const v={contentType:Ud(b,"audio"),bitrate:s?OM(b,o):o};x&&(v.channels=""+x),m.push(v)})}return m},c):c},[]):[]}function OM(a,e){if(e<=1)return 1;let s=128e3;return a==="ec-3"?s=768e3:a==="ac-3"&&(s=64e4),Math.min(e/2,s)}function Ij(a){return Math.ceil(Math.max(a.bitrate*.9,a.averageBitrate)/1e3)*1e3||1}function FM(a){let e="";const{audio:s,video:r}=a;if(r){const n=Op(r.contentType);e+=`${n}_r${r.height}x${r.width}f${Math.ceil(r.framerate)}${r.transferFunction||"sd"}_${Math.ceil(r.bitrate/1e5)}`}if(s){const n=Op(s.contentType);e+=`${r?"_":""}${n}_c${s.channels}`}return e}const Fp=["NONE","TYPE-0","TYPE-1",null];function BM(a){return Fp.indexOf(a)>-1}const jf=["SDR","PQ","HLG"];function UM(a){return!!a&&jf.indexOf(a)>-1}var nf={No:"",Yes:"YES",v2:"v2"};function c1(a){const{canSkipUntil:e,canSkipDateRanges:s,age:r}=a,n=r<e/2;return e&&n?s?nf.v2:nf.Yes:nf.No}class d1{constructor(e,s,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=s,this.skip=r}addDirectives(e){const s=new self.URL(e);return this.msn!==void 0&&s.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&s.searchParams.set("_HLS_part",this.part.toString()),this.skip&&s.searchParams.set("_HLS_skip",this.skip),s.href}}class $d{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(r=>!!r).map(r=>r.substring(0,4)).join(","),"supplemental"in e){var s;this.supplemental=e.supplemental;const r=(s=e.supplemental)==null?void 0:s.videoCodec;r&&r!==e.videoCodec&&(this.codecSet+=`,${r.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return u1(this._audioGroups,e)}hasSubtitleGroup(e){return u1(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,s){if(s){if(e==="audio"){let r=this._audioGroups;r||(r=this._audioGroups=[]),r.indexOf(s)===-1&&r.push(s)}else if(e==="text"){let r=this._subtitleGroups;r||(r=this._subtitleGroups=[]),r.indexOf(s)===-1&&r.push(s)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function u1(a,e){return!e||!a?!1:a.indexOf(e)!==-1}function $M(){if(typeof matchMedia=="function"){const a=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(a.media!==e.media)return a.matches===!0}return!1}function GM(a,e){let s=!1,r=[];if(a&&(s=a!=="SDR",r=[a]),e){r=e.allowedVideoRanges||jf.slice(0);const n=r.join("")!=="SDR"&&!e.videoCodec;s=e.preferHDR!==void 0?e.preferHDR:n&&$M(),s||(r=["SDR"])}return{preferHDR:s,allowedVideoRanges:r}}const HM=a=>{const e=new WeakSet;return(s,r)=>{if(a&&(r=a(s,r)),typeof r=="object"&&r!==null){if(e.has(r))return;e.add(r)}return r}},zs=(a,e)=>JSON.stringify(a,HM(e));function VM(a,e,s,r,n){const o=Object.keys(a),c=r==null?void 0:r.channels,d=r==null?void 0:r.audioCodec,f=n==null?void 0:n.videoCodec,u=c&&parseInt(c)===2;let m=!1,g=!1,x=1/0,b=1/0,v=1/0,w=1/0,S=0,T=[];const{preferHDR:k,allowedVideoRanges:E}=GM(e,n);for(let O=o.length;O--;){const U=a[o[O]];m||(m=U.channels[2]>0),x=Math.min(x,U.minHeight),b=Math.min(b,U.minFramerate),v=Math.min(v,U.minBitrate),E.filter(F=>U.videoRanges[F]>0).length>0&&(g=!0)}x=Tt(x)?x:0,b=Tt(b)?b:0;const R=Math.max(1080,x),K=Math.max(30,b);v=Tt(v)?v:s,s=Math.max(v,s),g||(e=void 0);const z=o.length>1;return{codecSet:o.reduce((O,U)=>{const I=a[U];if(U===O)return O;if(T=g?E.filter(F=>I.videoRanges[F]>0):[],z){if(I.minBitrate>s)return gn(U,`min bitrate of ${I.minBitrate} > current estimate of ${s}`),O;if(!I.hasDefaultAudio)return gn(U,"no renditions with default or auto-select sound found"),O;if(d&&U.indexOf(d.substring(0,4))%5!==0)return gn(U,`audio codec preference "${d}" not found`),O;if(c&&!u){if(!I.channels[c])return gn(U,`no renditions with ${c} channel sound found (channels options: ${Object.keys(I.channels)})`),O}else if((!d||u)&&m&&I.channels[2]===0)return gn(U,"no renditions with stereo sound found"),O;if(I.minHeight>R)return gn(U,`min resolution of ${I.minHeight} > maximum of ${R}`),O;if(I.minFramerate>K)return gn(U,`min framerate of ${I.minFramerate} > maximum of ${K}`),O;if(!T.some(F=>I.videoRanges[F]>0))return gn(U,`no variants with VIDEO-RANGE of ${zs(T)} found`),O;if(f&&U.indexOf(f.substring(0,4))%5!==0)return gn(U,`video codec preference "${f}" not found`),O;if(I.maxScore<S)return gn(U,`max score of ${I.maxScore} < selected max of ${S}`),O}return O&&(_f(U)>=_f(O)||I.fragmentError>a[O].fragmentError)?O:(w=I.minIndex,S=I.maxScore,U)},void 0),videoRanges:T,preferHDR:k,minFramerate:b,minBitrate:v,minIndex:w}}function gn(a,e){Ms.log(`[abr] start candidates with "${a}" ignored because ${e}`)}function Mj(a){return a.reduce((e,s)=>{let r=e.groups[s.groupId];r||(r=e.groups[s.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),r.tracks.push(s);const n=s.channels||"2";return r.channels[n]=(r.channels[n]||0)+1,r.hasDefault=r.hasDefault||s.default,r.hasAutoSelect=r.hasAutoSelect||s.autoselect,r.hasDefault&&(e.hasDefaultAudio=!0),r.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function zM(a,e,s,r){return a.slice(s,r+1).reduce((n,o,c)=>{if(!o.codecSet)return n;const d=o.audioGroups;let f=n[o.codecSet];f||(n[o.codecSet]=f={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:c,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!d,fragmentError:0}),f.minBitrate=Math.min(f.minBitrate,o.bitrate);const u=Math.min(o.height,o.width);return f.minHeight=Math.min(f.minHeight,u),f.minFramerate=Math.min(f.minFramerate,o.frameRate),f.minIndex=Math.min(f.minIndex,c),f.maxScore=Math.max(f.maxScore,o.score),f.fragmentError+=o.fragmentError,f.videoRanges[o.videoRange]=(f.videoRanges[o.videoRange]||0)+1,d&&d.forEach(m=>{if(!m)return;const g=e.groups[m];g&&(f.hasDefaultAudio=f.hasDefaultAudio||e.hasDefaultAudio?g.hasDefault:g.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(g.channels).forEach(x=>{f.channels[x]=(f.channels[x]||0)+g.channels[x]}))}),n},{})}function h1(a){if(!a)return a;const{lang:e,assocLang:s,characteristics:r,channels:n,audioCodec:o}=a;return{lang:e,assocLang:s,characteristics:r,channels:n,audioCodec:o}}function Nn(a,e,s){if("attrs"in a){const r=e.indexOf(a);if(r!==-1)return r}for(let r=0;r<e.length;r++){const n=e[r];if(sl(a,n,s))return r}return-1}function sl(a,e,s){const{groupId:r,name:n,lang:o,assocLang:c,default:d}=a,f=a.forced;return(r===void 0||e.groupId===r)&&(n===void 0||e.name===n)&&(o===void 0||qM(o,e.lang))&&(o===void 0||e.assocLang===c)&&(d===void 0||e.default===d)&&(f===void 0||e.forced===f)&&(!("characteristics"in a)||KM(a.characteristics||"",e.characteristics))&&(s===void 0||s(a,e))}function qM(a,e="--"){return a.length===e.length?a===e:a.startsWith(e)||e.startsWith(a)}function KM(a,e=""){const s=a.split(","),r=e.split(",");return s.length===r.length&&!s.some(n=>r.indexOf(n)===-1)}function Bo(a,e){const{audioCodec:s,channels:r}=a;return(s===void 0||(e.audioCodec||"").substring(0,4)===s.substring(0,4))&&(r===void 0||r===(e.channels||"2"))}function YM(a,e,s,r,n){const o=e[r],d=e.reduce((x,b,v)=>{const w=b.uri;return(x[w]||(x[w]=[])).push(v),x},{})[o.uri];d.length>1&&(r=Math.max.apply(Math,d));const f=o.videoRange,u=o.frameRate,m=o.codecSet.substring(0,4),g=f1(e,r,x=>{if(x.videoRange!==f||x.frameRate!==u||x.codecSet.substring(0,4)!==m)return!1;const b=x.audioGroups,v=s.filter(w=>!b||b.indexOf(w.groupId)!==-1);return Nn(a,v,n)>-1});return g>-1?g:f1(e,r,x=>{const b=x.audioGroups,v=s.filter(w=>!b||b.indexOf(w.groupId)!==-1);return Nn(a,v,n)>-1})}function f1(a,e,s){for(let r=e;r>-1;r--)if(s(a[r]))return r;for(let r=e+1;r<a.length;r++)if(s(a[r]))return r;return-1}function Ef(a,e){var s;return!!a&&a!==((s=e.loadLevelObj)==null?void 0:s.uri)}class WM extends qa{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=s=>{var r;const{fragCurrent:n,partCurrent:o,hls:c}=this,{autoLevelEnabled:d,media:f}=c;if(!n||!f)return;const u=performance.now(),m=o?o.stats:n.stats,g=o?o.duration:n.duration,x=u-m.loading.start,b=c.minAutoLevel,v=n.level,w=this._nextAutoLevel;if(m.aborted||m.loaded&&m.loaded===m.total||v<=b){this.clearTimer(),this._nextAutoLevel=-1;return}if(!d)return;const S=w>-1&&w!==v,T=!!s||S;if(!T&&(f.paused||!f.playbackRate||!f.readyState))return;const k=c.mainForwardBufferInfo;if(!T&&k===null)return;const E=this.bwEstimator.getEstimateTTFB(),R=Math.abs(f.playbackRate);if(x<=Math.max(E,1e3*(g/(R*2))))return;const K=k?k.len/R:0,z=m.loading.first?m.loading.first-m.loading.start:-1,D=m.loaded&&z>-1,O=this.getBwEstimate(),U=c.levels,I=U[v],F=Math.max(m.loaded,Math.round(g*(n.bitrate||I.averageBitrate)/8));let te=D?x-z:x;te<1&&D&&(te=Math.min(x,m.loaded*8/O));const le=D?m.loaded*1e3/te:0,H=E/1e3,X=le?(F-m.loaded)/le:F*8/O+H;if(X<=K)return;const q=le?le*8:O,ae=((r=(s==null?void 0:s.details)||this.hls.latestLevelDetails)==null?void 0:r.live)===!0,ce=this.hls.config.abrBandWidthUpFactor;let ee=Number.POSITIVE_INFINITY,W;for(W=v-1;W>b;W--){const oe=U[W].maxBitrate,ye=!U[W].details||ae;if(ee=this.getTimeToLoadFrag(H,q,g*oe,ye),ee<Math.min(K,g+H))break}if(ee>=X||ee>g*10)return;D?this.bwEstimator.sample(x-Math.min(E,z),m.loaded):this.bwEstimator.sampleTTFB(x);const V=U[W].maxBitrate;this.getBwEstimate()*ce>V&&this.resetEstimator(V);const G=this.findBestLevel(V,b,W,0,K,1,1);G>-1&&(W=G),this.warn(`Fragment ${n.sn}${o?" part "+o.index:""} of level ${v} is loading too slowly;
      Fragment duration: ${n.duration.toFixed(3)}
      Time to underbuffer: ${K.toFixed(3)} s
      Estimated load time for current fragment: ${X.toFixed(3)} s
      Estimated load time for down switch fragment: ${ee.toFixed(3)} s
      TTFB estimate: ${z|0} ms
      Current BW estimate: ${Tt(O)?O|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${W} @ ${V|0} bps`),c.nextLoadLevel=c.nextAutoLevel=W,this.clearTimer();const Z=()=>{if(this.clearTimer(),this.fragCurrent===n&&this.hls.loadLevel===W&&W>0){const oe=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${W>0?"and switching down":""}
      Fragment duration: ${n.duration.toFixed(3)} s
      Time to underbuffer: ${oe.toFixed(3)} s`),n.abortRequests(),this.fragCurrent=this.partCurrent=null,W>b){let ye=this.findBestLevel(this.hls.levels[b].bitrate,b,W,0,oe,1,1);ye===-1&&(ye=b),this.hls.nextLoadLevel=this.hls.nextAutoLevel=ye,this.resetEstimator(this.hls.levels[ye].bitrate)}}};S||X>ee*2?Z():this.timer=self.setInterval(Z,ee*1e3),c.trigger(Q.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,part:o,stats:m})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new eM(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Q.FRAG_LOADING,this.onFragLoading,this),e.on(Q.FRAG_LOADED,this.onFragLoaded,this),e.on(Q.FRAG_BUFFERED,this.onFragBuffered,this),e.on(Q.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(Q.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Q.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Q.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(Q.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Q.FRAG_LOADING,this.onFragLoading,this),e.off(Q.FRAG_LOADED,this.onFragLoaded,this),e.off(Q.FRAG_BUFFERED,this.onFragBuffered,this),e.off(Q.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(Q.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Q.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Q.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(Q.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,s){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,s){const r=s.frag;if(!this.ignoreFragment(r)){if(!r.bitrateTest){var n;this.fragCurrent=r,this.partCurrent=(n=s.part)!=null?n:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,s){this.clearTimer()}onError(e,s){if(!s.fatal)switch(s.details){case ze.BUFFER_ADD_CODEC_ERROR:case ze.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case ze.FRAG_LOAD_TIMEOUT:{const r=s.frag,{fragCurrent:n,partCurrent:o}=this;if(r&&n&&r.sn===n.sn&&r.level===n.level){const c=performance.now(),d=o?o.stats:r.stats,f=c-d.loading.start,u=d.loading.first?d.loading.first-d.loading.start:-1;if(d.loaded&&u>-1){const g=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(f-Math.min(g,u),d.loaded)}else this.bwEstimator.sampleTTFB(f)}break}}}getTimeToLoadFrag(e,s,r,n){const o=e+r/s,c=n?e+this.lastLevelLoadSec:0;return o+c}onLevelLoaded(e,s){const r=this.hls.config,{loading:n}=s.stats,o=n.end-n.first;Tt(o)&&(this.lastLevelLoadSec=o/1e3),s.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(s.levelInfo)}onFragLoaded(e,{frag:s,part:r}){const n=r?r.stats:s.stats;if(s.type===Rt.MAIN&&this.bwEstimator.sampleTTFB(n.loading.first-n.loading.start),!this.ignoreFragment(s)){if(this.clearTimer(),s.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const o=r?r.duration:s.duration,c=this.hls.levels[s.level],d=(c.loaded?c.loaded.bytes:0)+n.loaded,f=(c.loaded?c.loaded.duration:0)+o;c.loaded={bytes:d,duration:f},c.realBitrate=Math.round(8*d/f)}if(s.bitrateTest){const o={stats:n,frag:s,part:r,id:s.type};this.onFragBuffered(Q.FRAG_BUFFERED,o),s.bitrateTest=!1}else this.lastLoadedFragLevel=s.level}}onFragBuffered(e,s){const{frag:r,part:n}=s,o=n!=null&&n.stats.loaded?n.stats:r.stats;if(o.aborted||this.ignoreFragment(r))return;const c=o.parsing.end-o.loading.start-Math.min(o.loading.first-o.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(c,o.loaded),o.bwEstimate=this.getBwEstimate(),r.bitrateTest?this.bitrateTestDelay=c/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Rt.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:s}=this.hls,r=this.getBwEstimate(),n=this.hls.config.maxStarvationDelay,o=this.findBestLevel(r,s,e,0,n,1,1);if(o>-1)return o;const c=this.hls.firstLevel,d=Math.min(Math.max(c,s),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${c} clamped to ${d}`),d}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,r=this.bwEstimator.canEstimate(),n=this.lastLoadedFragLevel>-1;if(e!==-1&&(!r||!n||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const o=r&&n?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const c=this.hls.levels;if(c.length>Math.max(e,o)&&c[e].loadError<=c[o].loadError)return e}return this._nextAutoLevel=o,this.nextAutoLevelKey=this.getAutoLevelKey(),o}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:s,hls:r}=this;if(r.levels.length<=1)return r.loadLevel;const{maxAutoLevel:n,config:o,minAutoLevel:c}=r,d=s?s.duration:e?e.duration:0,f=this.getBwEstimate(),u=this.getStarvationDelay();let m=o.abrBandWidthFactor,g=o.abrBandWidthUpFactor;if(u){const S=this.findBestLevel(f,c,n,u,0,m,g);if(S>=0)return this.rebufferNotice=-1,S}let x=d?Math.min(d,o.maxStarvationDelay):o.maxStarvationDelay;if(!u){const S=this.bitrateTestDelay;S&&(x=(d?Math.min(d,o.maxLoadingDelay):o.maxLoadingDelay)-S,this.info(`bitrate test took ${Math.round(1e3*S)}ms, set first fragment max fetchDuration to ${Math.round(1e3*x)} ms`),m=g=1)}const b=this.findBestLevel(f,c,n,u,x,m,g);if(this.rebufferNotice!==b&&(this.rebufferNotice=b,this.info(`${u?"rebuffering expected":"buffer is empty"}, optimal quality level ${b}`)),b>-1)return b;const v=r.levels[c],w=r.loadLevelObj;return w&&(v==null?void 0:v.bitrate)<w.bitrate?c:r.loadLevel}getStarvationDelay(){const e=this.hls,s=e.media;if(!s)return 1/0;const r=s&&s.playbackRate!==0?Math.abs(s.playbackRate):1,n=e.mainForwardBufferInfo;return(n?n.len:0)/r}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,s,r,n,o,c,d){var f;const u=n+o,m=this.lastLoadedFragLevel,g=m===-1?this.hls.firstLevel:m,{fragCurrent:x,partCurrent:b}=this,{levels:v,allAudioTracks:w,loadLevel:S,config:T}=this.hls;if(v.length===1)return 0;const k=v[g],E=!!((f=this.hls.latestLevelDetails)!=null&&f.live),R=S===-1||m===-1;let K,z="SDR",D=(k==null?void 0:k.frameRate)||0;const{audioPreference:O,videoPreference:U}=T,I=this.audioTracksByGroup||(this.audioTracksByGroup=Mj(w));let F=-1;if(R){if(this.firstSelection!==-1)return this.firstSelection;const q=this.codecTiers||(this.codecTiers=zM(v,I,s,r)),ae=VM(q,z,e,O,U),{codecSet:ce,videoRanges:ee,minFramerate:W,minBitrate:V,minIndex:G,preferHDR:Z}=ae;F=G,K=ce,z=Z?ee[ee.length-1]:ee[0],D=W,e=Math.max(e,V),this.log(`picked start tier ${zs(ae)}`)}else K=k==null?void 0:k.codecSet,z=k==null?void 0:k.videoRange;const te=b?b.duration:x?x.duration:0,le=this.bwEstimator.getEstimateTTFB()/1e3,H=[];for(let q=r;q>=s;q--){var X;const ae=v[q],ce=q>g;if(!ae)continue;if(T.useMediaCapabilities&&!ae.supportedResult&&!ae.supportedPromise){const ye=navigator.mediaCapabilities;typeof(ye==null?void 0:ye.decodingInfo)=="function"&&IM(ae,I,z,D,e,O)?(ae.supportedPromise=Dj(ae,I,ye,this.supportedCache),ae.supportedPromise.then(je=>{if(!this.hls)return;ae.supportedResult=je;const xe=this.hls.levels,Ee=xe.indexOf(ae);je.error?this.warn(`MediaCapabilities decodingInfo error: "${je.error}" for level ${Ee} ${zs(je)}`):je.supported?je.decodingInfoResults.some(Pe=>Pe.smooth===!1||Pe.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${Ee} not smooth or powerEfficient: ${zs(je)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${Ee} ${zs(je)}`),Ee>-1&&xe.length>1&&(this.log(`Removing unsupported level ${Ee}`),this.hls.removeLevel(Ee),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(je=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${je}`)})):ae.supportedResult=Rj}if((K&&ae.codecSet!==K||z&&ae.videoRange!==z||ce&&D>ae.frameRate||!ce&&D>0&&D<ae.frameRate||(X=ae.supportedResult)!=null&&(X=X.decodingInfoResults)!=null&&X.some(ye=>ye.smooth===!1))&&(!R||q!==F)){H.push(q);continue}const ee=ae.details,W=(b?ee==null?void 0:ee.partTarget:ee==null?void 0:ee.averagetargetduration)||te;let V;ce?V=d*e:V=c*e;const G=te&&n>=te*2&&o===0?ae.averageBitrate:ae.maxBitrate,Z=this.getTimeToLoadFrag(le,V,G*W,ee===void 0);if(V>=G&&(q===m||ae.loadError===0&&ae.fragmentError===0)&&(Z<=le||!Tt(Z)||E&&!this.bitrateTestDelay||Z<u)){const ye=this.forcedAutoLevel;return q!==S&&(ye===-1||ye!==S)&&(H.length&&this.trace(`Skipped level(s) ${H.join(",")} of ${r} max with CODECS and VIDEO-RANGE:"${v[H[0]].codecs}" ${v[H[0]].videoRange}; not compatible with "${K}" ${z}`),this.info(`switch candidate:${g}->${q} adjustedbw(${Math.round(V)})-bitrate=${Math.round(V-G)} ttfb:${le.toFixed(1)} avgDuration:${W.toFixed(1)} maxFetchDuration:${u.toFixed(1)} fetchDuration:${Z.toFixed(1)} firstSelection:${R} codecSet:${ae.codecSet} videoRange:${ae.videoRange} hls.loadLevel:${S}`)),R&&(this.firstSelection=q),q}}return-1}set nextAutoLevel(e){const s=this.deriveNextAutoLevel(e);this._nextAutoLevel!==s&&(this.nextAutoLevelKey="",this._nextAutoLevel=s)}deriveNextAutoLevel(e){const{maxAutoLevel:s,minAutoLevel:r}=this.hls;return Math.min(Math.max(e,r),s)}}const Pj={search:function(a,e){let s=0,r=a.length-1,n=null,o=null;for(;s<=r;){n=(s+r)/2|0,o=a[n];const c=e(o);if(c>0)s=n+1;else if(c<0)r=n-1;else return o}return null}};function QM(a,e,s){if(e===null||!Array.isArray(a)||!a.length||!Tt(e))return null;const r=a[0].programDateTime;if(e<(r||0))return null;const n=a[a.length-1].endProgramDateTime;if(e>=(n||0))return null;for(let o=0;o<a.length;++o){const c=a[o];if(ZM(e,s,c))return c}return null}function ol(a,e,s=0,r=0,n=.005){let o=null;if(a){o=e[1+a.sn-e[0].sn]||null;const d=a.endDTS-s;d>0&&d<15e-7&&(s+=15e-7),o&&a.level!==o.level&&o.end<=a.end&&(o=e[2+a.sn-e[0].sn]||null)}else s===0&&e[0].start===0&&(o=e[0]);if(o&&((!a||a.level===o.level)&&m1(s,r,o)===0||XM(o,a,Math.min(n,r))))return o;const c=Pj.search(e,m1.bind(null,s,r));return c&&(c!==a||!o)?c:o}function XM(a,e,s){if(e&&e.start===0&&e.level<a.level&&(e.endPTS||0)>0){const r=e.tagList.reduce((n,o)=>(o[0]==="INF"&&(n+=parseFloat(o[1])),n),s);return a.start<=r}return!1}function m1(a=0,e=0,s){if(s.start<=a&&s.start+s.duration>a)return 0;const r=Math.min(e,s.duration+(s.deltaPTS?s.deltaPTS:0));return s.start+s.duration-r<=a?1:s.start-r>a&&s.start?-1:0}function ZM(a,e,s){const r=Math.min(e,s.duration+(s.deltaPTS?s.deltaPTS:0))*1e3;return(s.endProgramDateTime||0)-r>a}function Oj(a,e,s){if(a&&a.startCC<=e&&a.endCC>=e){let r=a.fragments;const{fragmentHint:n}=a;n&&(r=r.concat(n));let o;return Pj.search(r,c=>c.cc<e?1:c.cc>e?-1:(o=c,c.end<=s?1:c.start>s?-1:0)),o||null}return null}function Tf(a){switch(a.details){case ze.FRAG_LOAD_TIMEOUT:case ze.KEY_LOAD_TIMEOUT:case ze.LEVEL_LOAD_TIMEOUT:case ze.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Fj(a){return a.details.startsWith("key")}function Bj(a){return Fj(a)&&!!a.frag&&!a.frag.decryptdata}function g1(a,e){const s=Tf(e);return a.default[`${s?"timeout":"error"}Retry`]}function Ix(a,e){const s=a.backoff==="linear"?1:Math.pow(2,e);return Math.min(s*a.retryDelayMs,a.maxRetryDelayMs)}function p1(a){return Is(Is({},a),{errorRetry:null,timeoutRetry:null})}function Af(a,e,s,r){if(!a)return!1;const n=r==null?void 0:r.code,o=e<a.maxNumRetry&&(JM(n)||!!s);return a.shouldRetry?a.shouldRetry(a,e,s,r,o):o}function JM(a){return Bp(a)||!!a&&(a<400||a>499)}function Bp(a){return a===0&&navigator.onLine===!1}var Dr={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},wa={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4};class e6 extends qa{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(Q.ERROR,this.onError,this),e.on(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Q.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(Q.ERROR,this.onError,this),e.off(Q.ERROR,this.onErrorOut,this),e.off(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Q.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===Rt.MAIN?e.level:this.getVariantIndex()}getVariantIndex(){var e;const s=this.hls,r=s.currentLevel;return(e=s.loadLevelObj)!=null&&e.details||r===-1?s.loadLevel:r}variantHasKey(e,s){if(e){var r;if((r=e.details)!=null&&r.hasKey(s))return!0;const n=e.audioGroups;if(n)return this.hls.allAudioTracks.filter(c=>n.indexOf(c.groupId)>=0).some(c=>{var d;return(d=c.details)==null?void 0:d.hasKey(s)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(e,s){var r;if(s.fatal)return;const n=this.hls,o=s.context;switch(s.details){case ze.FRAG_LOAD_ERROR:case ze.FRAG_LOAD_TIMEOUT:case ze.KEY_LOAD_ERROR:case ze.KEY_LOAD_TIMEOUT:s.errorAction=this.getFragRetryOrSwitchAction(s);return;case ze.FRAG_PARSING_ERROR:if((r=s.frag)!=null&&r.gap){s.errorAction=Zl();return}case ze.FRAG_GAP:case ze.FRAG_DECRYPT_ERROR:{s.errorAction=this.getFragRetryOrSwitchAction(s),s.errorAction.action=Dr.SendAlternateToPenaltyBox;return}case ze.LEVEL_EMPTY_ERROR:case ze.LEVEL_PARSING_ERROR:{var c;const f=s.parent===Rt.MAIN?s.level:n.loadLevel;s.details===ze.LEVEL_EMPTY_ERROR&&((c=s.context)!=null&&(c=c.levelDetails)!=null&&c.live)?s.errorAction=this.getPlaylistRetryOrSwitchAction(s,f):(s.levelRetry=!1,s.errorAction=this.getLevelSwitchAction(s,f))}return;case ze.LEVEL_LOAD_ERROR:case ze.LEVEL_LOAD_TIMEOUT:typeof(o==null?void 0:o.level)=="number"&&(s.errorAction=this.getPlaylistRetryOrSwitchAction(s,o.level));return;case ze.AUDIO_TRACK_LOAD_ERROR:case ze.AUDIO_TRACK_LOAD_TIMEOUT:case ze.SUBTITLE_LOAD_ERROR:case ze.SUBTITLE_TRACK_LOAD_TIMEOUT:if(o){const f=n.loadLevelObj;if(f&&(o.type===us.AUDIO_TRACK&&f.hasAudioGroup(o.groupId)||o.type===us.SUBTITLE_TRACK&&f.hasSubtitleGroup(o.groupId))){s.errorAction=this.getPlaylistRetryOrSwitchAction(s,n.loadLevel),s.errorAction.action=Dr.SendAlternateToPenaltyBox,s.errorAction.flags=wa.MoveAllAlternatesMatchingHost;return}}return;case ze.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:s.errorAction={action:Dr.SendAlternateToPenaltyBox,flags:wa.MoveAllAlternatesMatchingHDCP};return;case ze.KEY_SYSTEM_SESSION_UPDATE_FAILED:case ze.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case ze.KEY_SYSTEM_NO_SESSION:s.errorAction={action:Dr.SendAlternateToPenaltyBox,flags:wa.MoveAllAlternatesMatchingKey};return;case ze.BUFFER_ADD_CODEC_ERROR:case ze.REMUX_ALLOC_ERROR:case ze.BUFFER_APPEND_ERROR:if(!s.errorAction){var d;s.errorAction=this.getLevelSwitchAction(s,(d=s.level)!=null?d:n.loadLevel)}return;case ze.INTERNAL_EXCEPTION:case ze.BUFFER_APPENDING_ERROR:case ze.BUFFER_FULL_ERROR:case ze.LEVEL_SWITCH_ERROR:case ze.BUFFER_STALLED_ERROR:case ze.BUFFER_SEEK_OVER_HOLE:case ze.BUFFER_NUDGE_ON_STALL:s.errorAction=Zl();return}s.type===Ft.KEY_SYSTEM_ERROR&&(s.levelRetry=!1,s.errorAction=Zl())}getPlaylistRetryOrSwitchAction(e,s){const r=this.hls,n=g1(r.config.playlistLoadPolicy,e),o=this.playlistError++;if(Af(n,o,Tf(e),e.response))return{action:Dr.RetryRequest,flags:wa.None,retryConfig:n,retryCount:o};const d=this.getLevelSwitchAction(e,s);return n&&(d.retryConfig=n,d.retryCount=o),d}getFragRetryOrSwitchAction(e){const s=this.hls,r=this.getVariantLevelIndex(e.frag),n=s.levels[r],{fragLoadPolicy:o,keyLoadPolicy:c}=s.config,d=g1(Fj(e)?c:o,e),f=s.levels.reduce((m,g)=>m+g.fragmentError,0);if(n&&(e.details!==ze.FRAG_GAP&&n.fragmentError++,!Bj(e)&&Af(d,f,Tf(e),e.response)))return{action:Dr.RetryRequest,flags:wa.None,retryConfig:d,retryCount:f};const u=this.getLevelSwitchAction(e,r);return d&&(u.retryConfig=d,u.retryCount=f),u}getLevelSwitchAction(e,s){const r=this.hls;s==null&&(s=r.loadLevel);const n=this.hls.levels[s];if(n){var o,c;const u=e.details;n.loadError++,u===ze.BUFFER_APPEND_ERROR&&n.fragmentError++;let m=-1;const{levels:g,loadLevel:x,minAutoLevel:b,maxAutoLevel:v}=r;!r.autoLevelEnabled&&!r.config.preserveManualLevelOnError&&(r.loadLevel=-1);const w=(o=e.frag)==null?void 0:o.type,T=(w===Rt.AUDIO&&u===ze.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(u===ze.BUFFER_ADD_CODEC_ERROR||u===ze.BUFFER_APPEND_ERROR))&&g.some(({audioCodec:z})=>n.audioCodec!==z),E=e.sourceBufferName==="video"&&(u===ze.BUFFER_ADD_CODEC_ERROR||u===ze.BUFFER_APPEND_ERROR)&&g.some(({codecSet:z,audioCodec:D})=>n.codecSet!==z&&n.audioCodec===D),{type:R,groupId:K}=(c=e.context)!=null?c:{};for(let z=g.length;z--;){const D=(z+x)%g.length;if(D!==x&&D>=b&&D<=v&&g[D].loadError===0){var d,f;const O=g[D];if(u===ze.FRAG_GAP&&w===Rt.MAIN&&e.frag){const U=g[D].details;if(U){const I=ol(e.frag,U.fragments,e.frag.start);if(I!=null&&I.gap)continue}}else{if(R===us.AUDIO_TRACK&&O.hasAudioGroup(K)||R===us.SUBTITLE_TRACK&&O.hasSubtitleGroup(K))continue;if(w===Rt.AUDIO&&(d=n.audioGroups)!=null&&d.some(U=>O.hasAudioGroup(U))||w===Rt.SUBTITLE&&(f=n.subtitleGroups)!=null&&f.some(U=>O.hasSubtitleGroup(U))||T&&n.audioCodec===O.audioCodec||E&&n.codecSet===O.codecSet||!T&&n.codecSet!==O.codecSet)continue}m=D;break}}if(m>-1&&r.loadLevel!==m)return e.levelRetry=!0,this.playlistError=0,{action:Dr.SendAlternateToPenaltyBox,flags:wa.None,nextAutoLevel:m}}return{action:Dr.SendAlternateToPenaltyBox,flags:wa.MoveAllAlternatesMatchingHost}}onErrorOut(e,s){var r;switch((r=s.errorAction)==null?void 0:r.action){case Dr.DoNothing:break;case Dr.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(s),!s.errorAction.resolved&&s.details!==ze.FRAG_GAP?s.fatal=!0:/MediaSource readyState: ended/.test(s.error.message)&&(this.warn(`MediaSource ended after "${s.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(s.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const s=this.hls,r=e.errorAction;if(!r)return;const{flags:n}=r,o=r.nextAutoLevel;switch(n){case wa.None:this.switchLevel(e,o);break;case wa.MoveAllAlternatesMatchingHDCP:{const f=this.getVariantLevelIndex(e.frag),u=s.levels[f],m=u==null?void 0:u.attrs["HDCP-LEVEL"];if(r.hdcpLevel=m,m==="NONE")this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(m){s.maxHdcpLevel=Fp[Fp.indexOf(m)-1],r.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${s.maxHdcpLevel}" or lower`);break}}case wa.MoveAllAlternatesMatchingKey:{const f=e.decryptdata;if(f){const u=this.hls.levels,m=u.length;for(let x=m;x--;)if(this.variantHasKey(u[x],f)){var c,d;this.log(`Banned key found in level ${x} (${u[x].bitrate}bps) or audio group "${(c=u[x].audioGroups)==null?void 0:c.join(",")}" (${(d=e.frag)==null?void 0:d.type} fragment) ${Ir(f.keyId||[])}`),u[x].fragmentError++,u[x].loadError++,this.log(`Removing level ${x} with key error (${e.error})`),this.hls.removeLevel(x)}const g=e.frag;if(this.hls.levels.length<m)r.resolved=!0;else if(g&&g.type!==Rt.MAIN){const x=g.decryptdata;x&&!f.matches(x)&&(r.resolved=!0)}}break}}r.resolved||this.switchLevel(e,o)}switchLevel(e,s){if(s!==void 0&&e.errorAction&&(this.warn(`switching to level ${s} after ${e.details}`),this.hls.nextAutoLevel=s,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===ze.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const r=Op(e.mimeType),n=this.hls.levels;for(let o=n.length;o--;)n[o][`${e.sourceBufferName}Codec`]===r&&(this.log(`Removing level ${o} for ${e.details} ("${r}" not supported)`),this.hls.removeLevel(o))}}}function Zl(a){const e={action:Dr.DoNothing,flags:wa.None};return a&&(e.resolved=!0),e}var Sr={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class t6{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e&&(e.on(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Q.BUFFER_APPENDED,this.onBufferAppended,this),e.on(Q.FRAG_BUFFERED,this.onFragBuffered,this),e.on(Q.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Q.BUFFER_APPENDED,this.onBufferAppended,this),e.off(Q.FRAG_BUFFERED,this.onFragBuffered,this),e.off(Q.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,s){const r=this.activePartLists[s];if(r)for(let n=r.length;n--;){const o=r[n];if(!o)break;if(o.start<=e&&e<=o.end&&o.loaded)return o}return this.getBufferedFrag(e,s)}getBufferedFrag(e,s){return this.getFragAtPos(e,s,!0)}getFragAtPos(e,s,r){const{fragments:n}=this,o=Object.keys(n);for(let c=o.length;c--;){const d=n[o[c]];if((d==null?void 0:d.body.type)===s&&(!r||d.buffered)){const f=d.body;if(f.start<=e&&e<=f.end)return f}}return null}detectEvictedFragments(e,s,r,n,o){this.timeRanges&&(this.timeRanges[e]=s);const c=(n==null?void 0:n.fragment.sn)||-1;Object.keys(this.fragments).forEach(d=>{const f=this.fragments[d];if(!f||c>=f.body.sn)return;if(!f.buffered&&(!f.loaded||o)){f.body.type===r&&this.removeFragment(f.body);return}const u=f.range[e];if(u){if(u.time.length===0){this.removeFragment(f.body);return}u.time.some(m=>{const g=!this.isTimeBuffered(m.startPTS,m.endPTS,s);return g&&this.removeFragment(f.body),g})}})}detectPartialFragments(e){const s=this.timeRanges;if(!s||e.frag.sn==="initSegment")return;const r=e.frag,n=Vl(r),o=this.fragments[n];if(!o||o.buffered&&r.gap)return;const c=!r.relurl;Object.keys(s).forEach(d=>{const f=r.elementaryStreams[d];if(!f)return;const u=s[d],m=c||f.partial===!0;o.range[d]=this.getBufferedTimes(r,e.part,m,u)}),o.loaded=null,Object.keys(o.range).length?(this.bufferedEnd(o,r),Dh(o)||this.removeParts(r.sn-1,r.type)):this.removeFragment(o.body)}bufferedEnd(e,s){e.buffered=!0,(e.body.endList=s.endList||e.body.endList)&&(this.endListFragments[e.body.type]=e)}removeParts(e,s){const r=this.activePartLists[s];r&&(this.activePartLists[s]=x1(r,n=>n.fragment.sn>=e))}fragBuffered(e,s){const r=Vl(e);let n=this.fragments[r];!n&&s&&(n=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),n&&(n.loaded=null,this.bufferedEnd(n,e))}getBufferedTimes(e,s,r,n){const o={time:[],partial:r},c=e.start,d=e.end,f=e.minEndPTS||d,u=e.maxStartPTS||c;for(let m=0;m<n.length;m++){const g=n.start(m)-this.bufferPadding,x=n.end(m)+this.bufferPadding;if(u>=g&&f<=x){o.time.push({startPTS:Math.max(c,n.start(m)),endPTS:Math.min(d,n.end(m))});break}else if(c<x&&d>g){const b=Math.max(c,n.start(m)),v=Math.min(d,n.end(m));v>b&&(o.partial=!0,o.time.push({startPTS:b,endPTS:v}))}else if(d<=g)break}return o}getPartialFragment(e){let s=null,r,n,o,c=0;const{bufferPadding:d,fragments:f}=this;return Object.keys(f).forEach(u=>{const m=f[u];m&&Dh(m)&&(n=m.body.start-d,o=m.body.end+d,e>=n&&e<=o&&(r=Math.min(e-n,o-e),c<=r&&(s=m.body,c=r)))}),s}isEndListAppended(e){const s=this.endListFragments[e];return s!==void 0&&(s.buffered||Dh(s))}getState(e){const s=Vl(e),r=this.fragments[s];return r?r.buffered?Dh(r)?Sr.PARTIAL:Sr.OK:Sr.APPENDING:Sr.NOT_LOADED}isTimeBuffered(e,s,r){let n,o;for(let c=0;c<r.length;c++){if(n=r.start(c)-this.bufferPadding,o=r.end(c)+this.bufferPadding,e>=n&&s<=o)return!0;if(s<=n)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,s){if(s.frag.sn==="initSegment"||s.frag.bitrateTest)return;const r=s.frag,n=s.part?null:s,o=Vl(r);this.fragments[o]={body:r,appendedPTS:null,loaded:n,buffered:!1,range:Object.create(null)}}onBufferAppended(e,s){const{frag:r,part:n,timeRanges:o,type:c}=s;if(r.sn==="initSegment")return;const d=r.type;if(n){let u=this.activePartLists[d];u||(this.activePartLists[d]=u=[]),u.push(n)}this.timeRanges=o;const f=o[c];this.detectEvictedFragments(c,f,d,n)}onFragBuffered(e,s){this.detectPartialFragments(s)}hasFragment(e){const s=Vl(e);return!!this.fragments[s]}hasFragments(e){const{fragments:s}=this,r=Object.keys(s);if(!e)return r.length>0;for(let n=r.length;n--;){const o=s[r[n]];if((o==null?void 0:o.body.type)===e)return!0}return!1}hasParts(e){var s;return!!((s=this.activePartLists[e])!=null&&s.length)}removeFragmentsInRange(e,s,r,n,o){n&&!this.hasGaps||Object.keys(this.fragments).forEach(c=>{const d=this.fragments[c];if(!d)return;const f=d.body;f.type!==r||n&&!f.gap||f.start<s&&f.end>e&&(d.buffered||o)&&this.removeFragment(f)})}removeFragment(e){const s=Vl(e);e.clearElementaryStreamInfo();const r=this.activePartLists[e.type];if(r){const n=e.sn;this.activePartLists[e.type]=x1(r,o=>o.fragment.sn!==n)}delete this.fragments[s],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const s=(e=this.hls)==null||(e=e.latestLevelDetails)==null?void 0:e.partList;s&&s.forEach(r=>r.clearElementaryStreamInfo())}}function Dh(a){var e,s,r;return a.buffered&&!!(a.body.gap||(e=a.range.video)!=null&&e.partial||(s=a.range.audio)!=null&&s.partial||(r=a.range.audiovideo)!=null&&r.partial)}function Vl(a){return`${a.type}_${a.level}_${a.sn}`}function x1(a,e){return a.filter(s=>{const r=e(s);return r||s.clearElementaryStreamInfo(),r})}var uo={cbc:0,ctr:1};class s6{constructor(e,s,r){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=s,this.aesMode=r}decrypt(e,s){switch(this.aesMode){case uo.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},s,e);case uo.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},s,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function r6(a){const e=a.byteLength,s=e&&new DataView(a.buffer).getUint8(e-1);return s?a.slice(0,e-s):a}class a6{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const s=new DataView(e),r=new Uint32Array(4);for(let n=0;n<4;n++)r[n]=s.getUint32(n*4);return r}initTable(){const e=this.sBox,s=this.invSBox,r=this.subMix,n=r[0],o=r[1],c=r[2],d=r[3],f=this.invSubMix,u=f[0],m=f[1],g=f[2],x=f[3],b=new Uint32Array(256);let v=0,w=0,S=0;for(S=0;S<256;S++)S<128?b[S]=S<<1:b[S]=S<<1^283;for(S=0;S<256;S++){let T=w^w<<1^w<<2^w<<3^w<<4;T=T>>>8^T&255^99,e[v]=T,s[T]=v;const k=b[v],E=b[k],R=b[E];let K=b[T]*257^T*16843008;n[v]=K<<24|K>>>8,o[v]=K<<16|K>>>16,c[v]=K<<8|K>>>24,d[v]=K,K=R*16843009^E*65537^k*257^v*16843008,u[T]=K<<24|K>>>8,m[T]=K<<16|K>>>16,g[T]=K<<8|K>>>24,x[T]=K,v?(v=k^b[b[b[R^k]]],w^=b[b[w]]):v=w=1}}expandKey(e){const s=this.uint8ArrayToUint32Array_(e);let r=!0,n=0;for(;n<s.length&&r;)r=s[n]===this.key[n],n++;if(r)return;this.key=s;const o=this.keySize=s.length;if(o!==4&&o!==6&&o!==8)throw new Error("Invalid aes key size="+o);const c=this.ksRows=(o+6+1)*4;let d,f;const u=this.keySchedule=new Uint32Array(c),m=this.invKeySchedule=new Uint32Array(c),g=this.sBox,x=this.rcon,b=this.invSubMix,v=b[0],w=b[1],S=b[2],T=b[3];let k,E;for(d=0;d<c;d++){if(d<o){k=u[d]=s[d];continue}E=k,d%o===0?(E=E<<8|E>>>24,E=g[E>>>24]<<24|g[E>>>16&255]<<16|g[E>>>8&255]<<8|g[E&255],E^=x[d/o|0]<<24):o>6&&d%o===4&&(E=g[E>>>24]<<24|g[E>>>16&255]<<16|g[E>>>8&255]<<8|g[E&255]),u[d]=k=(u[d-o]^E)>>>0}for(f=0;f<c;f++)d=c-f,f&3?E=u[d]:E=u[d-4],f<4||d<=4?m[f]=E:m[f]=v[g[E>>>24]]^w[g[E>>>16&255]]^S[g[E>>>8&255]]^T[g[E&255]],m[f]=m[f]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,s,r){const n=this.keySize+6,o=this.invKeySchedule,c=this.invSBox,d=this.invSubMix,f=d[0],u=d[1],m=d[2],g=d[3],x=this.uint8ArrayToUint32Array_(r);let b=x[0],v=x[1],w=x[2],S=x[3];const T=new Int32Array(e),k=new Int32Array(T.length);let E,R,K,z,D,O,U,I,F,te,le,H,X,q;const ae=this.networkToHostOrderSwap;for(;s<T.length;){for(F=ae(T[s]),te=ae(T[s+1]),le=ae(T[s+2]),H=ae(T[s+3]),D=F^o[0],O=H^o[1],U=le^o[2],I=te^o[3],X=4,q=1;q<n;q++)E=f[D>>>24]^u[O>>16&255]^m[U>>8&255]^g[I&255]^o[X],R=f[O>>>24]^u[U>>16&255]^m[I>>8&255]^g[D&255]^o[X+1],K=f[U>>>24]^u[I>>16&255]^m[D>>8&255]^g[O&255]^o[X+2],z=f[I>>>24]^u[D>>16&255]^m[O>>8&255]^g[U&255]^o[X+3],D=E,O=R,U=K,I=z,X=X+4;E=c[D>>>24]<<24^c[O>>16&255]<<16^c[U>>8&255]<<8^c[I&255]^o[X],R=c[O>>>24]<<24^c[U>>16&255]<<16^c[I>>8&255]<<8^c[D&255]^o[X+1],K=c[U>>>24]<<24^c[I>>16&255]<<16^c[D>>8&255]<<8^c[O&255]^o[X+2],z=c[I>>>24]<<24^c[D>>16&255]<<16^c[O>>8&255]<<8^c[U&255]^o[X+3],k[s]=ae(E^b),k[s+1]=ae(z^v),k[s+2]=ae(K^w),k[s+3]=ae(R^S),b=F,v=te,w=le,S=H,s=s+4}return k.buffer}}class n6{constructor(e,s,r){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=s,this.aesMode=r}expandKey(){const e=i6(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function i6(a){switch(a){case uo.cbc:return"AES-CBC";case uo.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${a}`)}}const o6=16;class Mx{constructor(e,{removePKCS7Padding:s=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=s,s)try{const r=self.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:s}=this;if(!e||s)return this.reset(),null;const r=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?r6(r):r}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,s,r,n){return this.useSoftware?new Promise((o,c)=>{const d=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(d,s,r,n);const f=this.flush();f?o(f.buffer):c(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),s,r,n)}softwareDecrypt(e,s,r,n){const{currentIV:o,currentResult:c,remainderData:d}=this;if(n!==uo.cbc||s.byteLength!==16)return Ms.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),d&&(e=Ha(d,e),this.remainderData=null);const f=this.getValidChunk(e);if(!f.length)return null;o&&(r=o);let u=this.softwareDecrypter;u||(u=this.softwareDecrypter=new a6),u.expandKey(s);const m=c;return this.currentResult=u.decrypt(f.buffer,0,r),this.currentIV=f.slice(-16).buffer,m||null}webCryptoDecrypt(e,s,r,n){if(this.key!==s||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,s,r,n));this.key=s,this.fastAesKey=new n6(this.subtle,s,n)}return this.fastAesKey.expandKey().then(o=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new s6(this.subtle,new Uint8Array(r),n).decrypt(e.buffer,o)):Promise.reject(new Error("web crypto not initialized"))).catch(o=>(Ms.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${o.name}: ${o.message}`),this.onWebCryptoError(e,s,r,n)))}onWebCryptoError(e,s,r,n){const o=this.enableSoftwareAES;if(o){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,s,r,n);const c=this.flush();if(c)return c.buffer}throw new Error("WebCrypto"+(o?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let s=e;const r=e.length-e.length%o6;return r!==e.length&&(s=e.slice(0,r),this.remainderData=e.slice(r)),s}logOnce(e){this.logEnabled&&(Ms.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const y1=Math.pow(2,17);class l6{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,s){const r=e.url;if(!r)return Promise.reject(new Jn({type:Ft.NETWORK_ERROR,details:ze.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${r?"part list":"url"}`),networkDetails:null}));this.abort();const n=this.config,o=n.fLoader,c=n.loader;return new Promise((d,f)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(v=>v[0]==="GAP")){f(v1(e));return}else e.gap=!1;const u=this.loader=o?new o(n):new c(n),m=b1(e);e.loader=u;const g=p1(n.fragLoadPolicy.default),x={loadPolicy:g,timeout:g.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:y1};e.stats=u.stats;const b={onSuccess:(v,w,S,T)=>{this.resetLoader(e,u);let k=v.data;S.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(k.slice(0,16)),k=k.slice(16)),d({frag:e,part:null,payload:k,networkDetails:T})},onError:(v,w,S,T)=>{this.resetLoader(e,u),f(new Jn({type:Ft.NETWORK_ERROR,details:ze.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Is({url:r,data:void 0},v),error:new Error(`HTTP Error ${v.code} ${v.text}`),networkDetails:S,stats:T}))},onAbort:(v,w,S)=>{this.resetLoader(e,u),f(new Jn({type:Ft.NETWORK_ERROR,details:ze.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:S,stats:v}))},onTimeout:(v,w,S)=>{this.resetLoader(e,u),f(new Jn({type:Ft.NETWORK_ERROR,details:ze.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${x.timeout}ms`),networkDetails:S,stats:v}))}};s&&(b.onProgress=(v,w,S,T)=>s({frag:e,part:null,payload:S,networkDetails:T})),u.load(m,x,b)})}loadPart(e,s,r){this.abort();const n=this.config,o=n.fLoader,c=n.loader;return new Promise((d,f)=>{if(this.loader&&this.loader.destroy(),e.gap||s.gap){f(v1(e,s));return}const u=this.loader=o?new o(n):new c(n),m=b1(e,s);e.loader=u;const g=p1(n.fragLoadPolicy.default),x={loadPolicy:g,timeout:g.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:y1};s.stats=u.stats,u.load(m,x,{onSuccess:(b,v,w,S)=>{this.resetLoader(e,u),this.updateStatsFromPart(e,s);const T={frag:e,part:s,payload:b.data,networkDetails:S};r(T),d(T)},onError:(b,v,w,S)=>{this.resetLoader(e,u),f(new Jn({type:Ft.NETWORK_ERROR,details:ze.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:s,response:Is({url:m.url,data:void 0},b),error:new Error(`HTTP Error ${b.code} ${b.text}`),networkDetails:w,stats:S}))},onAbort:(b,v,w)=>{e.stats.aborted=s.stats.aborted,this.resetLoader(e,u),f(new Jn({type:Ft.NETWORK_ERROR,details:ze.INTERNAL_ABORTED,fatal:!1,frag:e,part:s,error:new Error("Aborted"),networkDetails:w,stats:b}))},onTimeout:(b,v,w)=>{this.resetLoader(e,u),f(new Jn({type:Ft.NETWORK_ERROR,details:ze.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:s,error:new Error(`Timeout after ${x.timeout}ms`),networkDetails:w,stats:b}))}})})}updateStatsFromPart(e,s){const r=e.stats,n=s.stats,o=n.total;if(r.loaded+=n.loaded,o){const f=Math.round(e.duration/s.duration),u=Math.min(Math.round(r.loaded/o),f),g=(f-u)*Math.round(r.loaded/u);r.total=r.loaded+g}else r.total=Math.max(r.loaded,r.total);const c=r.loading,d=n.loading;c.start?c.first+=d.first-d.start:(c.start=d.start,c.first=d.first),c.end=d.end}resetLoader(e,s){e.loader=null,this.loader===s&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),s.destroy()}}function b1(a,e=null){const s=e||a,r={frag:a,part:e,responseType:"arraybuffer",url:s.url,headers:{},rangeStart:0,rangeEnd:0},n=s.byteRangeStartOffset,o=s.byteRangeEndOffset;if(Tt(n)&&Tt(o)){var c;let d=n,f=o;if(a.sn==="initSegment"&&c6((c=a.decryptdata)==null?void 0:c.method)){const u=o-n;u%16&&(f=o+(16-u%16)),n!==0&&(r.resetIV=!0,d=n-16)}r.rangeStart=d,r.rangeEnd=f}return r}function v1(a,e){const s=new Error(`GAP ${a.gap?"tag":"attribute"} found`),r={type:Ft.MEDIA_ERROR,details:ze.FRAG_GAP,fatal:!1,frag:a,error:s,networkDetails:null};return e&&(r.part=e),(e||a).stats.aborted=!0,new Jn(r)}function c6(a){return a==="AES-128"||a==="AES-256"}class Jn extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class Uj extends qa{constructor(e,s){super(e,s),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class Px{constructor(e,s,r,n=0,o=-1,c=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Ih(),this.buffering={audio:Ih(),video:Ih(),audiovideo:Ih()},this.level=e,this.sn=s,this.id=r,this.size=n,this.part=o,this.partial=c}}function Ih(){return{start:0,executeStart:0,executeEnd:0,end:0}}const w1={length:0,start:()=>0,end:()=>0};class Zt{static isBuffered(e,s){if(e){const r=Zt.getBuffered(e);for(let n=r.length;n--;)if(s>=r.start(n)&&s<=r.end(n))return!0}return!1}static bufferedRanges(e){if(e){const s=Zt.getBuffered(e);return Zt.timeRangesToArray(s)}return[]}static timeRangesToArray(e){const s=[];for(let r=0;r<e.length;r++)s.push({start:e.start(r),end:e.end(r)});return s}static bufferInfo(e,s,r){if(e){const n=Zt.bufferedRanges(e);if(n.length)return Zt.bufferedInfo(n,s,r)}return{len:0,start:s,end:s,bufferedIndex:-1}}static bufferedInfo(e,s,r){s=Math.max(0,s),e.length>1&&e.sort((m,g)=>m.start-g.start||g.end-m.end);let n=-1,o=[];if(r)for(let m=0;m<e.length;m++){s>=e[m].start&&s<=e[m].end&&(n=m);const g=o.length;if(g){const x=o[g-1].end;e[m].start-x<r?e[m].end>x&&(o[g-1].end=e[m].end):o.push(e[m])}else o.push(e[m])}else o=e;let c=0,d,f=s,u=s;for(let m=0;m<o.length;m++){const g=o[m].start,x=o[m].end;if(n===-1&&s>=g&&s<=x&&(n=m),s+r>=g&&s<x)f=g,u=x,c=u-s;else if(s+r<g){d=g;break}}return{len:c,start:f||0,end:u||0,nextStart:d,buffered:e,bufferedIndex:n}}static getBuffered(e){try{return e.buffered||w1}catch(s){return Ms.log("failed to get media.buffered",s),w1}}}const $j=/\{\$([a-zA-Z0-9-_]+)\}/g;function S1(a){return $j.test(a)}function Up(a,e){if(a.variableList!==null||a.hasVariableRefs){const s=a.variableList;return e.replace($j,r=>{const n=r.substring(2,r.length-1),o=s==null?void 0:s[n];return o===void 0?(a.playlistParsingError||(a.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${n}"`)),r):o})}return e}function _1(a,e,s){let r=a.variableList;r||(a.variableList=r={});let n,o;if("QUERYPARAM"in e){n=e.QUERYPARAM;try{const c=new self.URL(s).searchParams;if(c.has(n))o=c.get(n);else throw new Error(`"${n}" does not match any query parameter in URI: "${s}"`)}catch(c){a.playlistParsingError||(a.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${c.message}`))}}else n=e.NAME,o=e.VALUE;n in r?a.playlistParsingError||(a.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${n}"`)):r[n]=o||""}function d6(a,e,s){const r=e.IMPORT;if(s&&r in s){let n=a.variableList;n||(a.variableList=n={}),n[r]=s[r]}else a.playlistParsingError||(a.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${r}"`))}const u6=/^(\d+)x(\d+)$/,N1=/(.+?)=(".*?"|.*?)(?:,|$)/g;class tr{constructor(e,s){typeof e=="string"&&(e=tr.parseAttrList(e,s)),Us(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const s=parseInt(this[e],10);return s>Number.MAX_SAFE_INTEGER?1/0:s}hexadecimalInteger(e){if(this[e]){let s=(this[e]||"0x").slice(2);s=(s.length&1?"0":"")+s;const r=new Uint8Array(s.length/2);for(let n=0;n<s.length/2;n++)r[n]=parseInt(s.slice(n*2,n*2+2),16);return r}return null}hexadecimalIntegerAsNumber(e){const s=parseInt(this[e],16);return s>Number.MAX_SAFE_INTEGER?1/0:s}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,s){const r=this[e];return r?parseFloat(r):s}enumeratedString(e){return this[e]}enumeratedStringList(e,s){const r=this[e];return(r?r.split(/[ ,]+/):[]).reduce((n,o)=>(n[o.toLowerCase()]=!0,n),s)}bool(e){return this[e]==="YES"}decimalResolution(e){const s=u6.exec(this[e]);if(s!==null)return{width:parseInt(s[1],10),height:parseInt(s[2],10)}}static parseAttrList(e,s){let r;const n={};for(N1.lastIndex=0;(r=N1.exec(e))!==null;){const c=r[1].trim();let d=r[2];const f=d.indexOf('"')===0&&d.lastIndexOf('"')===d.length-1;let u=!1;if(f)d=d.slice(1,-1);else switch(c){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":u=!0}if(s&&(f||u))d=Up(s,d);else if(!u&&!f)switch(c){case"CLOSED-CAPTIONS":if(d==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":Ms.warn(`${e}: attribute ${c} is missing quotes`)}n[c]=d}return n}}const h6="com.apple.hls.interstitial";function f6(a){return a!=="ID"&&a!=="CLASS"&&a!=="CUE"&&a!=="START-DATE"&&a!=="DURATION"&&a!=="END-DATE"&&a!=="END-ON-NEXT"}function m6(a){return a==="SCTE35-OUT"||a==="SCTE35-IN"||a==="SCTE35-CMD"}class Gj{constructor(e,s,r=0){var n;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(s==null?void 0:s.tagAnchor)||null,this.tagOrder=(n=s==null?void 0:s.tagOrder)!=null?n:r,s){const o=s.attr;for(const c in o)if(Object.prototype.hasOwnProperty.call(e,c)&&e[c]!==o[c]){Ms.warn(`DATERANGE tag attribute: "${c}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=c;break}e=Us(new tr({}),o,e)}if(this.attr=e,s?(this._startDate=s._startDate,this._cue=s._cue,this._endDate=s._endDate,this._dateAtEnd=s._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const o=(s==null?void 0:s.endDate)||new Date(this.attr["END-DATE"]);Tt(o.getTime())&&(this._endDate=o)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(Ms.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const s=this.duration;return s!==null?this._dateAtEnd=new Date(this._startDate.getTime()+s*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(Tt(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===h6}get isValid(){return!!this.id&&!this._badValueForSameId&&Tt(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const g6=10;class p6{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const s=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!s||!this.live,this.advanced=this.endSN>e.endSN||s>0||s===0&&r>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}hasKey(e){return this.encryptedFragments.some(s=>{let r=s.decryptdata;return r||(s.setKeyFormat(e.keyFormat),r=s.decryptdata),!!r&&e.matches(r)})}get hasProgramDateTime(){return this.fragments.length?Tt(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||g6}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const s=this.lastPartIndex;if(s!==-1){for(let r=e.length;r--;)if(e[r].index>s)return e[r].index;return s}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function Cf(a,e){return a.length===e.length?!a.some((s,r)=>s!==e[r]):!1}function j1(a,e){return!a&&!e?!0:!a||!e?!1:Cf(a,e)}function Jl(a){return a==="AES-128"||a==="AES-256"||a==="AES-256-CTR"}function Ox(a){switch(a){case"AES-128":case"AES-256":return uo.cbc;case"AES-256-CTR":return uo.ctr;default:throw new Error(`invalid full segment method ${a}`)}}function Fx(a){return Uint8Array.from(atob(a),e=>e.charCodeAt(0))}function $p(a){return Uint8Array.from(unescape(encodeURIComponent(a)),e=>e.charCodeAt(0))}function x6(a){const e=$p(a).subarray(0,16),s=new Uint8Array(16);return s.set(e,16-e.length),s}function Hj(a){const e=function(r,n,o){const c=r[n];r[n]=r[o],r[o]=c};e(a,0,3),e(a,1,2),e(a,4,5),e(a,6,7)}function Vj(a){const e=a.split(":");let s=null;if(e[0]==="data"&&e.length===2){const r=e[1].split(";"),n=r[r.length-1].split(",");if(n.length===2){const o=n[0]==="base64",c=n[1];o?(r.splice(-1,1),s=Fx(c)):s=x6(c)}}return s}const kf=typeof self<"u"?self:void 0;var sr={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Mr={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function of(a){switch(a){case Mr.FAIRPLAY:return sr.FAIRPLAY;case Mr.PLAYREADY:return sr.PLAYREADY;case Mr.WIDEVINE:return sr.WIDEVINE;case Mr.CLEARKEY:return sr.CLEARKEY}}function Rg(a){switch(a){case sr.FAIRPLAY:return Mr.FAIRPLAY;case sr.PLAYREADY:return Mr.PLAYREADY;case sr.WIDEVINE:return Mr.WIDEVINE;case sr.CLEARKEY:return Mr.CLEARKEY}}function Ad(a){const{drmSystems:e,widevineLicenseUrl:s}=a,r=e?[sr.FAIRPLAY,sr.WIDEVINE,sr.PLAYREADY,sr.CLEARKEY].filter(n=>!!e[n]):[];return!r[sr.WIDEVINE]&&s&&r.push(sr.WIDEVINE),r}const zj=(function(a){return kf!=null&&(a=kf.navigator)!=null&&a.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null})();function y6(a,e,s,r){let n;switch(a){case sr.FAIRPLAY:n=["cenc","sinf"];break;case sr.WIDEVINE:case sr.PLAYREADY:n=["cenc"];break;case sr.CLEARKEY:n=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${a}`)}return b6(n,e,s,r)}function b6(a,e,s,r){return[{initDataTypes:a,persistentState:r.persistentState||"optional",distinctiveIdentifier:r.distinctiveIdentifier||"optional",sessionTypes:r.sessionTypes||[r.sessionType||"temporary"],audioCapabilities:e.map(o=>({contentType:`audio/mp4; codecs=${o}`,robustness:r.audioRobustness||"",encryptionScheme:r.audioEncryptionScheme||null})),videoCapabilities:s.map(o=>({contentType:`video/mp4; codecs=${o}`,robustness:r.videoRobustness||"",encryptionScheme:r.videoEncryptionScheme||null}))}]}function v6(a){var e;return!!a&&(a.sessionType==="persistent-license"||!!((e=a.sessionTypes)!=null&&e.some(s=>s==="persistent-license")))}function qj(a){const e=new Uint16Array(a.buffer,a.byteOffset,a.byteLength/2),s=String.fromCharCode.apply(null,Array.from(e)),r=s.substring(s.indexOf("<"),s.length),c=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("KID")[0];if(c){const d=c.childNodes[0]?c.childNodes[0].nodeValue:c.getAttribute("VALUE");if(d){const f=Fx(d).subarray(0,16);return Hj(f),f}}return null}let zl={};class lo{static clearKeyUriToKeyIdMap(){zl={}}static setKeyIdForUri(e,s){zl[e]=s}static addKeyIdForUri(e){const s=Object.keys(zl).length%Number.MAX_SAFE_INTEGER,r=new Uint8Array(16);return new DataView(r.buffer,12,4).setUint32(0,s),zl[e]=r,r}constructor(e,s,r,n=[1],o=null,c){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=s,this.keyFormat=r,this.keyFormatVersions=n,this.iv=o,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!Jl(e),c!=null&&c.startsWith("0x")&&(this.keyId=new Uint8Array(vj(c)))}matches(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&Cf(e.keyFormatVersions,this.keyFormatVersions)&&j1(e.iv,this.iv)&&j1(e.keyId,this.keyId)}isSupported(){if(this.method){if(Jl(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Mr.FAIRPLAY:case Mr.WIDEVINE:case Mr.PLAYREADY:case Mr.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e,s){if(!this.encrypted||!this.uri)return null;if(Jl(this.method)){let o=this.iv;return o||(typeof e!="number"&&(Ms.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0),o=S6(e)),new lo(this.method,this.uri,"identity",this.keyFormatVersions,o)}if(this.keyId){const o=zl[this.uri];if(o&&!Cf(this.keyId,o)&&lo.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}const r=Vj(this.uri);if(r)switch(this.keyFormat){case Mr.WIDEVINE:if(this.pssh=r,!this.keyId){const o=jM(r.buffer);if(o.length){var n;const c=o[0];this.keyId=(n=c.kids)!=null&&n.length?c.kids[0]:null}}this.keyId||(this.keyId=E1(s));break;case Mr.PLAYREADY:{const o=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=NM(o,null,r),this.keyId=qj(r);break}default:{let o=r.subarray(0,16);if(o.length!==16){const c=new Uint8Array(16);c.set(o,16-o.length),o=c}this.keyId=o;break}}if(!this.keyId||this.keyId.byteLength!==16){let o;o=w6(s),o||(o=E1(s),o||(o=zl[this.uri])),o&&(this.keyId=o,lo.setKeyIdForUri(this.uri,o))}return this}}function w6(a){const e=a==null?void 0:a[Mr.WIDEVINE];return e?e.keyId:null}function E1(a){const e=a==null?void 0:a[Mr.PLAYREADY];if(e){const s=Vj(e.uri);if(s)return qj(s)}return null}function S6(a){const e=new Uint8Array(16);for(let s=12;s<16;s++)e[s]=a>>8*(15-s)&255;return e}const T1=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,A1=/#EXT-X-MEDIA:(.*)/g,_6=/^#EXT(?:INF|-X-TARGETDURATION):/m,Lg=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),N6=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class jn{static findGroup(e,s){for(let r=0;r<e.length;r++){const n=e[r];if(n.id===s)return n}}static resolve(e,s){return Cx.buildAbsoluteURL(s,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return _6.test(e)}static parseMasterPlaylist(e,s){const r=S1(e),n={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:r},o=[];if(T1.lastIndex=0,!e.startsWith("#EXTM3U"))return n.playlistParsingError=new Error("no EXTM3U delimiter"),n;let c;for(;(c=T1.exec(e))!=null;)if(c[1]){var d;const u=new tr(c[1],n),m=Up(n,c[2]),g={attrs:u,bitrate:u.decimalInteger("BANDWIDTH")||u.decimalInteger("AVERAGE-BANDWIDTH"),name:u.NAME,url:jn.resolve(m,s)},x=u.decimalResolution("RESOLUTION");x&&(g.width=x.width,g.height=x.height),R1(u.CODECS,g);const b=u["SUPPLEMENTAL-CODECS"];b&&(g.supplemental={},R1(b,g.supplemental)),(d=g.unknownCodecs)!=null&&d.length||o.push(g),n.levels.push(g)}else if(c[3]){const u=c[3],m=c[4];switch(u){case"SESSION-DATA":{const g=new tr(m,n),x=g["DATA-ID"];x&&(n.sessionData===null&&(n.sessionData={}),n.sessionData[x]=g);break}case"SESSION-KEY":{const g=C1(m,s,n);g.encrypted&&g.isSupported()?(n.sessionKeys===null&&(n.sessionKeys=[]),n.sessionKeys.push(g)):Ms.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${m}"`);break}case"DEFINE":{{const g=new tr(m,n);_1(n,g,s)}break}case"CONTENT-STEERING":{const g=new tr(m,n);n.contentSteering={uri:jn.resolve(g["SERVER-URI"],s),pathwayId:g["PATHWAY-ID"]||"."};break}case"START":{n.startTimeOffset=k1(m);break}}}const f=o.length>0&&o.length<n.levels.length;return n.levels=f?o:n.levels,n.levels.length===0&&(n.playlistParsingError=new Error("no levels found in manifest")),n}static parseMasterPlaylistMedia(e,s,r){let n;const o={},c=r.levels,d={AUDIO:c.map(u=>({id:u.attrs.AUDIO,audioCodec:u.audioCodec})),SUBTITLES:c.map(u=>({id:u.attrs.SUBTITLES,textCodec:u.textCodec})),"CLOSED-CAPTIONS":[]};let f=0;for(A1.lastIndex=0;(n=A1.exec(e))!==null;){const u=new tr(n[1],r),m=u.TYPE;if(m){const g=d[m],x=o[m]||[];o[m]=x;const b=u.LANGUAGE,v=u["ASSOC-LANGUAGE"],w=u.CHANNELS,S=u.CHARACTERISTICS,T=u["INSTREAM-ID"],k={attrs:u,bitrate:0,id:f++,groupId:u["GROUP-ID"]||"",name:u.NAME||b||"",type:m,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:b,url:u.URI?jn.resolve(u.URI,s):""};if(v&&(k.assocLang=v),w&&(k.channels=w),S&&(k.characteristics=S),T&&(k.instreamId=T),g!=null&&g.length){const E=jn.findGroup(g,k.groupId)||g[0];L1(k,E,"audioCodec"),L1(k,E,"textCodec")}x.push(k)}}return o}static parseLevelPlaylist(e,s,r,n,o,c){var d;const f={url:s},u=new p6(s),m=u.fragments,g=[];let x=null,b=0,v=0,w=0,S=0,T=0,k=null,E=new Ag(n,f),R,K,z,D=-1,O=!1,U=null,I;if(Lg.lastIndex=0,u.m3u8=e,u.hasVariableRefs=S1(e),((d=Lg.exec(e))==null?void 0:d[0])!=="#EXTM3U")return u.playlistParsingError=new Error("Missing format identifier #EXTM3U"),u;for(;(R=Lg.exec(e))!==null;){O&&(O=!1,E=new Ag(n,f),E.playlistOffset=w,E.setStart(w),E.sn=b,E.cc=S,T&&(E.bitrate=T),E.level=r,x&&(E.initSegment=x,x.rawProgramDateTime&&(E.rawProgramDateTime=x.rawProgramDateTime,x.rawProgramDateTime=null),U&&(E.setByteRange(U),U=null)));const H=R[1];if(H){E.duration=parseFloat(H);const X=(" "+R[2]).slice(1);E.title=X||null,E.tagList.push(X?["INF",H,X]:["INF",H])}else if(R[3]){if(Tt(E.duration)){E.playlistOffset=w,E.setStart(w),z&&I1(E,z,u),E.sn=b,E.level=r,E.cc=S,m.push(E);const X=(" "+R[3]).slice(1);E.relurl=Up(u,X),Gp(E,k,g),k=E,w+=E.duration,b++,v=0,O=!0}}else{if(R=R[0].match(N6),!R){Ms.warn("No matches on slow regex match for level playlist!");continue}for(K=1;K<R.length&&R[K]===void 0;K++);const X=(" "+R[K]).slice(1),q=(" "+R[K+1]).slice(1),ae=R[K+2]?(" "+R[K+2]).slice(1):null;switch(X){case"BYTERANGE":k?E.setByteRange(q,k):E.setByteRange(q);break;case"PROGRAM-DATE-TIME":E.rawProgramDateTime=q,E.tagList.push(["PROGRAM-DATE-TIME",q]),D===-1&&(D=m.length);break;case"PLAYLIST-TYPE":u.type&&Wn(u,X,R),u.type=q.toUpperCase();break;case"MEDIA-SEQUENCE":u.startSN!==0?Wn(u,X,R):m.length>0&&M1(u,X,R),b=u.startSN=parseInt(q);break;case"SKIP":{u.skippedSegments&&Wn(u,X,R);const ce=new tr(q,u),ee=ce.decimalInteger("SKIPPED-SEGMENTS");if(Tt(ee)){u.skippedSegments+=ee;for(let V=ee;V--;)m.push(null);b+=ee}const W=ce.enumeratedString("RECENTLY-REMOVED-DATERANGES");W&&(u.recentlyRemovedDateranges=(u.recentlyRemovedDateranges||[]).concat(W.split("	")));break}case"TARGETDURATION":u.targetduration!==0&&Wn(u,X,R),u.targetduration=Math.max(parseInt(q),1);break;case"VERSION":u.version!==null&&Wn(u,X,R),u.version=parseInt(q);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":u.live||Wn(u,X,R),u.live=!1;break;case"#":(q||ae)&&E.tagList.push(ae?[q,ae]:[q]);break;case"DISCONTINUITY":S++,E.tagList.push(["DIS"]);break;case"GAP":E.gap=!0,E.tagList.push([X]);break;case"BITRATE":E.tagList.push([X,q]),T=parseInt(q)*1e3,Tt(T)?E.bitrate=T:T=0;break;case"DATERANGE":{const ce=new tr(q,u),ee=new Gj(ce,u.dateRanges[ce.ID],u.dateRangeTagCount);u.dateRangeTagCount++,ee.isValid||u.skippedSegments?u.dateRanges[ee.id]=ee:Ms.warn(`Ignoring invalid DATERANGE tag: "${q}"`),E.tagList.push(["EXT-X-DATERANGE",q]);break}case"DEFINE":{{const ce=new tr(q,u);"IMPORT"in ce?d6(u,ce,c):_1(u,ce,s)}break}case"DISCONTINUITY-SEQUENCE":u.startCC!==0?Wn(u,X,R):m.length>0&&M1(u,X,R),u.startCC=S=parseInt(q);break;case"KEY":{const ce=C1(q,s,u);if(ce.isSupported()){if(ce.method==="NONE"){z=void 0;break}z||(z={});const ee=z[ce.keyFormat];ee!=null&&ee.matches(ce)||(ee&&(z=Us({},z)),z[ce.keyFormat]=ce)}else Ms.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${q}"`);break}case"START":u.startTimeOffset=k1(q);break;case"MAP":{const ce=new tr(q,u);if(E.duration){const ee=new Ag(n,f);D1(ee,ce,r,z),x=ee,E.initSegment=x,x.rawProgramDateTime&&!E.rawProgramDateTime&&(E.rawProgramDateTime=x.rawProgramDateTime)}else{const ee=E.byteRangeEndOffset;if(ee){const W=E.byteRangeStartOffset;U=`${ee-W}@${W}`}else U=null;D1(E,ce,r,z),x=E,O=!0}x.cc=S;break}case"SERVER-CONTROL":{I&&Wn(u,X,R),I=new tr(q),u.canBlockReload=I.bool("CAN-BLOCK-RELOAD"),u.canSkipUntil=I.optionalFloat("CAN-SKIP-UNTIL",0),u.canSkipDateRanges=u.canSkipUntil>0&&I.bool("CAN-SKIP-DATERANGES"),u.partHoldBack=I.optionalFloat("PART-HOLD-BACK",0),u.holdBack=I.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{u.partTarget&&Wn(u,X,R);const ce=new tr(q);u.partTarget=ce.decimalFloatingPoint("PART-TARGET");break}case"PART":{let ce=u.partList;ce||(ce=u.partList=[]);const ee=v>0?ce[ce.length-1]:void 0,W=v++,V=new tr(q,u),G=new dM(V,E,f,W,ee);ce.push(G),E.duration+=G.duration;break}case"PRELOAD-HINT":{const ce=new tr(q,u);u.preloadHint=ce;break}case"RENDITION-REPORT":{const ce=new tr(q,u);u.renditionReports=u.renditionReports||[],u.renditionReports.push(ce);break}default:Ms.warn(`line parsed but not handled: ${R}`);break}}}k&&!k.relurl?(m.pop(),w-=k.duration,u.partList&&(u.fragmentHint=k)):u.partList&&(Gp(E,k,g),E.cc=S,u.fragmentHint=E,z&&I1(E,z,u)),u.targetduration||(u.playlistParsingError=new Error("Missing Target Duration"));const F=m.length,te=m[0],le=m[F-1];if(w+=u.skippedSegments*u.targetduration,w>0&&F&&le){u.averagetargetduration=w/F;const H=le.sn;u.endSN=H!=="initSegment"?H:0,u.live||(le.endList=!0),D>0&&(E6(m,D),te&&g.unshift(te))}return u.fragmentHint&&(w+=u.fragmentHint.duration),u.totalduration=w,g.length&&u.dateRangeTagCount&&te&&Kj(g,u),u.endCC=S,u}}function Kj(a,e){let s=a.length;if(!s)if(e.hasProgramDateTime){const d=e.fragments[e.fragments.length-1];a.push(d),s++}else return;const r=a[s-1],n=e.live?1/0:e.totalduration,o=Object.keys(e.dateRanges);for(let d=o.length;d--;){const f=e.dateRanges[o[d]],u=f.startDate.getTime();f.tagAnchor=r.ref;for(let m=s;m--;){var c;if(((c=a[m])==null?void 0:c.sn)<e.startSN)break;const g=j6(e,u,a,m,n);if(g!==-1){f.tagAnchor=e.fragments[g].ref;break}}}}function j6(a,e,s,r,n){const o=s[r];if(o){const d=o.programDateTime;if(e>=d||r===0){var c;const f=(((c=s[r+1])==null?void 0:c.start)||n)-o.start;if(e<=d+f*1e3){const u=s[r].sn-a.startSN;if(u<0)return-1;const m=a.fragments;if(m.length>s.length){const x=(s[r+1]||m[m.length-1]).sn-a.startSN;for(let b=x;b>u;b--){const v=m[b].programDateTime;if(e>=v&&e<v+m[b].duration*1e3)return b}}return u}}}return-1}function C1(a,e,s){var r,n;const o=new tr(a,s),c=(r=o.METHOD)!=null?r:"",d=o.URI,f=o.hexadecimalInteger("IV"),u=o.KEYFORMATVERSIONS,m=(n=o.KEYFORMAT)!=null?n:"identity";d&&o.IV&&!f&&Ms.error(`Invalid IV: ${o.IV}`);const g=d?jn.resolve(d,e):"",x=(u||"1").split("/").map(Number).filter(Number.isFinite);return new lo(c,g,m,x,f,o.KEYID)}function k1(a){const s=new tr(a).decimalFloatingPoint("TIME-OFFSET");return Tt(s)?s:null}function R1(a,e){let s=(a||"").split(/[ ,]+/).filter(r=>r);["video","audio","text"].forEach(r=>{const n=s.filter(o=>Lx(o,r));n.length&&(e[`${r}Codec`]=n.map(o=>o.split("/")[0]).join(","),s=s.filter(o=>n.indexOf(o)===-1))}),e.unknownCodecs=s}function L1(a,e,s){const r=e[s];r&&(a[s]=r)}function E6(a,e){let s=a[e];for(let r=e;r--;){const n=a[r];if(!n)return;n.programDateTime=s.programDateTime-n.duration*1e3,s=n}}function Gp(a,e,s){a.rawProgramDateTime?s.push(a):e!=null&&e.programDateTime&&(a.programDateTime=e.endProgramDateTime)}function D1(a,e,s,r){a.relurl=e.URI,e.BYTERANGE&&a.setByteRange(e.BYTERANGE),a.level=s,a.sn="initSegment",r&&(a.levelkeys=r),a.initSegment=null}function I1(a,e,s){a.levelkeys=e;const{encryptedFragments:r}=s;(!r.length||r[r.length-1].levelkeys!==e)&&Object.keys(e).some(n=>e[n].isCommonEncryption)&&r.push(a)}function Wn(a,e,s){a.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${s[0]})`)}function M1(a,e,s){a.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${s[0]})`)}function Dg(a,e){const s=e.startPTS;if(Tt(s)){let r=0,n;e.sn>a.sn?(r=s-a.start,n=a):(r=a.start-s,n=e),n.duration!==r&&n.setDuration(r)}else e.sn>a.sn?a.cc===e.cc&&a.minEndPTS?e.setStart(a.start+(a.minEndPTS-a.start)):e.setStart(a.start+a.duration):e.setStart(Math.max(a.start-e.duration,0))}function Yj(a,e,s,r,n,o,c){r-s<=0&&(c.warn("Fragment should have a positive duration",e),r=s+e.duration,o=n+e.duration);let f=s,u=r;const m=e.startPTS,g=e.endPTS;if(Tt(m)){const T=Math.abs(m-s);a&&T>a.totalduration?c.warn(`media timestamps and playlist times differ by ${T}s for level ${e.level} ${a.url}`):Tt(e.deltaPTS)?e.deltaPTS=Math.max(T,e.deltaPTS):e.deltaPTS=T,f=Math.max(s,m),s=Math.min(s,m),n=e.startDTS!==void 0?Math.min(n,e.startDTS):n,u=Math.min(r,g),r=Math.max(r,g),o=e.endDTS!==void 0?Math.max(o,e.endDTS):o}const x=s-e.start;e.start!==0&&e.setStart(s),e.setDuration(r-e.start),e.startPTS=s,e.maxStartPTS=f,e.startDTS=n,e.endPTS=r,e.minEndPTS=u,e.endDTS=o;const b=e.sn;if(!a||b<a.startSN||b>a.endSN)return 0;let v;const w=b-a.startSN,S=a.fragments;for(S[w]=e,v=w;v>0;v--)Dg(S[v],S[v-1]);for(v=w;v<S.length-1;v++)Dg(S[v],S[v+1]);return a.fragmentHint&&Dg(S[S.length-1],a.fragmentHint),a.PTSKnown=a.alignedSliding=!0,x}function T6(a,e,s){if(a===e)return;let r=null;const n=a.fragments;for(let m=n.length-1;m>=0;m--){const g=n[m].initSegment;if(g){r=g;break}}a.fragmentHint&&delete a.fragmentHint.endPTS;let o;k6(a,e,(m,g,x,b)=>{if((!e.startCC||e.skippedSegments)&&g.cc!==m.cc){const v=m.cc-g.cc;for(let w=x;w<b.length;w++)b[w].cc+=v;e.endCC=b[b.length-1].cc}Tt(m.startPTS)&&Tt(m.endPTS)&&(g.setStart(g.startPTS=m.startPTS),g.startDTS=m.startDTS,g.maxStartPTS=m.maxStartPTS,g.endPTS=m.endPTS,g.endDTS=m.endDTS,g.minEndPTS=m.minEndPTS,g.setDuration(m.endPTS-m.startPTS),g.duration&&(o=g),e.PTSKnown=e.alignedSliding=!0),m.hasStreams&&(g.elementaryStreams=m.elementaryStreams),g.loader=m.loader,m.hasStats&&(g.stats=m.stats),m.initSegment&&(g.initSegment=m.initSegment,r=m.initSegment)});const c=e.fragments,d=e.fragmentHint?c.concat(e.fragmentHint):c;if(r&&d.forEach(m=>{var g;m&&(!m.initSegment||m.initSegment.relurl===((g=r)==null?void 0:g.relurl))&&(m.initSegment=r)}),e.skippedSegments){if(e.deltaUpdateFailed=c.some(m=>!m),e.deltaUpdateFailed){s.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let m=e.skippedSegments;m--;)c.shift();e.startSN=c[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=A6(a.dateRanges,e,s));const m=a.fragments.filter(g=>g.rawProgramDateTime);if(a.hasProgramDateTime&&!e.hasProgramDateTime)for(let g=1;g<d.length;g++)d[g].programDateTime===null&&Gp(d[g],d[g-1],m);Kj(m,e)}e.endCC=c[c.length-1].cc}if(!e.startCC){var f;const m=Xj(a,e.startSN-1);e.startCC=(f=m==null?void 0:m.cc)!=null?f:c[0].cc}C6(a.partList,e.partList,(m,g)=>{g.elementaryStreams=m.elementaryStreams,g.stats=m.stats}),o?Yj(e,o,o.startPTS,o.endPTS,o.startDTS,o.endDTS,s):Wj(a,e),c.length&&(e.totalduration=e.edge-c[0].start),e.driftStartTime=a.driftStartTime,e.driftStart=a.driftStart;const u=e.advancedDateTime;if(e.advanced&&u){const m=e.edge;e.driftStart||(e.driftStartTime=u,e.driftStart=m),e.driftEndTime=u,e.driftEnd=m}else e.driftEndTime=a.driftEndTime,e.driftEnd=a.driftEnd,e.advancedDateTime=a.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=a.requestScheduled)}function A6(a,e,s){const{dateRanges:r,recentlyRemovedDateranges:n}=e,o=Us({},a);n&&n.forEach(f=>{delete o[f]});const d=Object.keys(o).length;return d?(Object.keys(r).forEach(f=>{const u=o[f],m=new Gj(r[f].attr,u);m.isValid?(o[f]=m,u||(m.tagOrder+=d)):s.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${zs(r[f].attr)}"`)}),o):r}function C6(a,e,s){if(a&&e){let r=0;for(let n=0,o=a.length;n<=o;n++){const c=a[n],d=e[n+r];c&&d&&c.index===d.index&&c.fragment.sn===d.fragment.sn?s(c,d):r--}}}function k6(a,e,s){const r=e.skippedSegments,n=Math.max(a.startSN,e.startSN)-e.startSN,o=(a.fragmentHint?1:0)+(r?e.endSN:Math.min(a.endSN,e.endSN))-e.startSN,c=e.startSN-a.startSN,d=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,f=a.fragmentHint?a.fragments.concat(a.fragmentHint):a.fragments;for(let u=n;u<=o;u++){const m=f[c+u];let g=d[u];if(r&&!g&&m&&(g=e.fragments[u]=m),m&&g){s(m,g,u,d);const x=m.relurl,b=g.relurl;if(x&&R6(x,b)){e.playlistParsingError=P1(`media sequence mismatch ${g.sn}:`,a,e,m,g);return}else if(m.cc!==g.cc){e.playlistParsingError=P1(`discontinuity sequence mismatch (${m.cc}!=${g.cc})`,a,e,m,g);return}}}}function P1(a,e,s,r,n){return new Error(`${a} ${n.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${s.startSN}
${s.m3u8}`)}function Wj(a,e,s=!0){const r=e.startSN+e.skippedSegments-a.startSN,n=a.fragments,o=r>=0;let c=0;if(o&&r<n.length)c=n[r].start;else if(o&&e.startSN===a.endSN+1)c=a.fragmentEnd;else if(o&&s)c=a.fragmentStart+r*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)c=a.fragmentStart;else return;Hp(e,c)}function Hp(a,e){if(e){const s=a.fragments;for(let r=a.skippedSegments;r<s.length;r++)s[r].addStart(e);a.fragmentHint&&a.fragmentHint.addStart(e)}}function Qj(a,e=1/0){let s=1e3*a.targetduration;if(a.updated){const r=a.fragments;if(r.length&&s*4>e){const o=r[r.length-1].duration*1e3;o<s&&(s=o)}}else s/=2;return Math.round(s)}function Xj(a,e,s){if(!a)return null;let r=a.fragments[e-a.startSN];return r||(r=a.fragmentHint,r&&r.sn===e)?r:e<a.startSN&&s&&s.sn===e?s:null}function O1(a,e,s){return a?Zj(a.partList,e,s):null}function Zj(a,e,s){if(a)for(let r=a.length;r--;){const n=a[r];if(n.index===s&&n.fragment.sn===e)return n}return null}function Jj(a){a.forEach((e,s)=>{var r;(r=e.details)==null||r.fragments.forEach(n=>{n.level=s,n.initSegment&&(n.initSegment.level=s)})})}function R6(a,e){return a!==e&&e?F1(a)!==F1(e):!1}function F1(a){return a.replace(/\?[^?]*$/,"")}function Dd(a,e){for(let r=0,n=a.length;r<n;r++){var s;if(((s=a[r])==null?void 0:s.cc)===e)return a[r]}return null}function L6(a,e){return!!(a&&e.startCC<a.endCC&&e.endCC>a.startCC)}function B1(a,e){const s=a.start+e;a.startPTS=s,a.setStart(s),a.endPTS=s+a.duration}function e2(a,e){const s=e.fragments;for(let r=0,n=s.length;r<n;r++)B1(s[r],a);e.fragmentHint&&B1(e.fragmentHint,a),e.alignedSliding=!0}function D6(a,e){a&&(t2(e,a),e.alignedSliding||Rf(e,a),!e.alignedSliding&&!e.skippedSegments&&Wj(a,e,!1))}function t2(a,e){if(!L6(e,a))return;const s=Math.min(e.endCC,a.endCC),r=Dd(e.fragments,s),n=Dd(a.fragments,s);if(!r||!n)return;Ms.log(`Aligning playlist at start of dicontinuity sequence ${s}`);const o=r.start-n.start;e2(o,a)}function Rf(a,e){if(!a.hasProgramDateTime||!e.hasProgramDateTime)return;const s=a.fragments,r=e.fragments;if(!s.length||!r.length)return;let n,o;const c=Math.min(e.endCC,a.endCC);e.startCC<c&&a.startCC<c&&(n=Dd(r,c),o=Dd(s,c)),(!n||!o)&&(n=r[Math.floor(r.length/2)],o=Dd(s,n.cc)||s[Math.floor(s.length/2)]);const d=n.programDateTime,f=o.programDateTime;if(!d||!f)return;const u=(f-d)/1e3-(o.start-n.start);e2(u,a)}function qr(a,e,s){na(a,e,s),a.addEventListener(e,s)}function na(a,e,s){a.removeEventListener(e,s)}const I6={toString:function(a){let e="";const s=a.length;for(let r=0;r<s;r++)e+=`[${a.start(r).toFixed(3)}-${a.end(r).toFixed(3)}]`;return e}},ut={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Bx extends Uj{constructor(e,s,r,n,o){super(n,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=ut.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:c,fragCurrent:d,media:f,mediaBuffer:u,state:m}=this,g=f?f.currentTime:0,x=Zt.bufferInfo(u||f,g,c.maxBufferHole),b=!x.len;if(this.log(`Media seeking to ${Tt(g)?g.toFixed(3):g}, state: ${m}, ${b?"out of":"in"} buffer`),this.state===ut.ENDED)this.resetLoadingState();else if(d){const v=c.maxFragLookUpTolerance,w=d.start-v,S=d.start+d.duration+v;if(b||S<x.start||w>x.end){const T=g>S;(g<w||T)&&(T&&d.loader&&(this.log(`Cancelling fragment load for seek (sn: ${d.sn})`),d.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(f){this.fragmentTracker.removeFragmentsInRange(g,1/0,this.playlistType,!0);const v=this.lastCurrentTime;if(g>v&&(this.lastCurrentTime=g),!this.loadingParts){const w=Math.max(x.end,g),S=this.shouldLoadParts(this.getLevelDetails(),w);S&&(this.log(`LL-Part loading ON after seeking to ${g.toFixed(2)} with buffer @${w.toFixed(2)}`),this.loadingParts=S)}}this.hls.hasEnoughToStart||(this.log(`Setting ${b?"startPosition":"nextLoadPosition"} to ${g} for seek without enough to start`),this.nextLoadPosition=g,b&&(this.startPosition=g)),b&&this.state===ut.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=o,this.hls=e,this.fragmentLoader=new l6(e.config),this.keyLoader=r,this.fragmentTracker=s,this.config=e.config,this.decrypter=new Mx(e.config)}registerListeners(){const{hls:e}=this;e.on(Q.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Q.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Q.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Q.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(Q.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Q.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Q.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Q.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===ut.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=ut.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:s}=this;return s===-1&&e?e:s}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,s){if(s.live||!this.media)return!1;const r=e.end||0,n=this.config.timelineOffset||0;if(r<=n)return!1;const o=e.buffered;this.config.maxBufferHole&&o&&o.length>1&&(e=Zt.bufferedInfo(o,e.start,0));const c=e.nextStart;if(c&&c>n&&c<s.edge||this.media.currentTime<e.start)return!1;const f=s.partList;if(f!=null&&f.length){const m=f[f.length-1];return Zt.isBuffered(this.media,m.start+m.duration/2)}const u=s.fragments[s.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(u)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const e=this.config.timelineOffset;if(e){var s;return((s=this.getLevelDetails())==null?void 0:s.appliedTimelineOffset)||e}return 0}onMediaAttached(e,s){const r=this.media=this.mediaBuffer=s.media;qr(r,"seeking",this.onMediaSeeking),qr(r,"ended",this.onMediaEnded);const n=this.config;this.levels&&n.autoStartLoad&&this.state===ut.STOPPED&&this.startLoad(n.startPosition)}onMediaDetaching(e,s){const r=!!s.transferMedia,n=this.media;if(n!==null){if(n.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),na(n,"seeking",this.onMediaSeeking),na(n,"ended",this.onMediaEnded),this.keyLoader&&!r&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,r){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,s){}onManifestLoaded(e,s){this.startTimeOffset=s.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=ut.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,s,r){this.startFragRequested=!0,this._loadFragForPlayback(e,s,r)}_loadFragForPlayback(e,s,r){const n=o=>{const c=o.frag;if(this.fragContextChanged(c)){this.warn(`${c.type} sn: ${c.sn}${o.part?" part: "+o.part.index:""} of ${this.fragInfo(c,!1,o.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(c);return}c.stats.chunkCount++,this._handleFragmentLoadProgress(o)};this._doFragLoad(e,s,r,n).then(o=>{if(!o)return;const c=this.state,d=o.frag;if(this.fragContextChanged(d)){(c===ut.FRAG_LOADING||!this.fragCurrent&&c===ut.PARSING)&&(this.fragmentTracker.removeFragment(d),this.state=ut.IDLE);return}"payload"in o&&(this.log(`Loaded ${d.type} sn: ${d.sn} of ${this.playlistLabel()} ${d.level}`),this.hls.trigger(Q.FRAG_LOADED,o)),this._handleFragmentLoadComplete(o)}).catch(o=>{this.state===ut.STOPPED||this.state===ut.ERROR||(this.warn(`Frag error: ${(o==null?void 0:o.message)||o}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var s;const{fragmentTracker:r}=this;if(r.getState(e)===Sr.APPENDING){const o=e.type,c=this.getFwdBufferInfo(this.mediaBuffer,o),d=Math.max(e.duration,c?c.len:this.config.maxBufferLength),f=this.backtrackFragment;((f?e.sn-f.sn:0)===1||this.reduceMaxBufferLength(d,e.duration))&&r.removeFragment(e)}else((s=this.mediaBuffer)==null?void 0:s.buffered.length)===0?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===Sr.PARTIAL&&r.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const s=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:s,part:null,stats:s.stats,id:s.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const s=e.details;return(s==null?void 0:s.live)&&s.type!=="EVENT"&&(this.levelLastLoaded!==e||s.expired)}flushMainBuffer(e,s,r=null){if(!(e-s))return;const n={startOffset:e,endOffset:s,type:r};this.hls.trigger(Q.BUFFER_FLUSHING,n)}_loadInitSegment(e,s){this._doFragLoad(e,s).then(r=>{const n=r==null?void 0:r.frag;if(!n||this.fragContextChanged(n)||!this.levels)throw new Error("init load aborted");return r}).then(r=>{const{hls:n}=this,{frag:o,payload:c}=r,d=o.decryptdata;if(c&&c.byteLength>0&&d!=null&&d.key&&d.iv&&Jl(d.method)){const f=self.performance.now();return this.decrypter.decrypt(new Uint8Array(c),d.key.buffer,d.iv.buffer,Ox(d.method)).catch(u=>{throw n.trigger(Q.ERROR,{type:Ft.MEDIA_ERROR,details:ze.FRAG_DECRYPT_ERROR,fatal:!1,error:u,reason:u.message,frag:o}),u}).then(u=>{const m=self.performance.now();return n.trigger(Q.FRAG_DECRYPTED,{frag:o,payload:u,stats:{tstart:f,tdecrypt:m}}),r.payload=u,this.completeInitSegmentLoad(r)})}return this.completeInitSegmentLoad(r)}).catch(r=>{this.state===ut.STOPPED||this.state===ut.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:s}=this;if(!s)throw new Error("init load aborted, missing levels");const r=e.frag.stats;this.state!==ut.STOPPED&&(this.state=ut.IDLE),e.frag.data=new Uint8Array(e.payload),r.parsing.start=r.buffering.start=self.performance.now(),r.parsing.end=r.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(e,s){var r,n;const o=e.tracks;if(o&&!s.encrypted&&((r=o.audio)!=null&&r.encrypted||(n=o.video)!=null&&n.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const c=this.media,d=new Error(`Encrypted track with no key in ${this.fragInfo(s)} (media ${c?"attached mediaKeys: "+c.mediaKeys:"detached"})`);return this.warn(d.message),!c||c.mediaKeys?!1:(this.hls.trigger(Q.ERROR,{type:Ft.KEY_SYSTEM_ERROR,details:ze.KEY_SYSTEM_NO_KEYS,fatal:!1,error:d,frag:s}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(e){const{fragCurrent:s}=this;return!e||!s||e.sn!==s.sn||e.level!==s.level}fragBufferedComplete(e,s){const r=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${s?" part: "+s.index:""} of ${this.fragInfo(e,!1,s)} > buffer:${r?I6.toString(Zt.getBuffered(r)):"(detached)"})`),ur(e)){var n;if(e.type!==Rt.SUBTITLE){const c=e.elementaryStreams;if(!Object.keys(c).some(d=>!!c[d])){this.state=ut.IDLE;return}}const o=(n=this.levels)==null?void 0:n[e.level];o!=null&&o.fragmentError&&(this.log(`Resetting level fragment error count of ${o.fragmentError} on frag buffered`),o.fragmentError=0)}this.state=ut.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:s}=this;if(!s)return;const{frag:r,part:n,partsLoaded:o}=e,c=!o||o.length===0||o.some(f=>!f),d=new Px(r.level,r.sn,r.stats.chunkCount+1,0,n?n.index:-1,!c);s.flush(d)}_handleFragmentLoadProgress(e){}_doFragLoad(e,s,r=null,n){var o;this.fragCurrent=e;const c=s.details;if(!this.levels||!c)throw new Error(`frag load aborted, missing level${c?"":" detail"}s`);let d=null;if(e.encrypted&&!((o=e.decryptdata)!=null&&o.key)){if(this.log(`Loading key for ${e.sn} of [${c.startSN}-${c.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=ut.KEY_LOADING,this.fragCurrent=e,d=this.keyLoader.load(e).then(x=>{if(!this.fragContextChanged(x.frag))return this.hls.trigger(Q.KEY_LOADED,x),this.state===ut.KEY_LOADING&&(this.state=ut.IDLE),x}),this.hls.trigger(Q.KEY_LOADING,{frag:e}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else e.encrypted||(d=this.keyLoader.loadClear(e,c.encryptedFragments,this.startFragRequested),d&&this.log("[eme] blocking frag load until media-keys acquired"));const f=this.fragPrevious;if(ur(e)&&(!f||e.sn!==f.sn)){const x=this.shouldLoadParts(s.details,e.end);x!==this.loadingParts&&(this.log(`LL-Part loading ${x?"ON":"OFF"} loading sn ${f==null?void 0:f.sn}->${e.sn}`),this.loadingParts=x)}if(r=Math.max(e.start,r||0),this.loadingParts&&ur(e)){const x=c.partList;if(x&&n){r>c.fragmentEnd&&c.fragmentHint&&(e=c.fragmentHint);const b=this.getNextPart(x,e,r);if(b>-1){const v=x[b];e=this.fragCurrent=v.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${v.index} (${b}/${x.length-1}) of ${this.fragInfo(e,!1,v)}) cc: ${e.cc} [${c.startSN}-${c.endSN}], target: ${parseFloat(r.toFixed(3))}`),this.nextLoadPosition=v.start+v.duration,this.state=ut.FRAG_LOADING;let w;return d?w=d.then(S=>!S||this.fragContextChanged(S.frag)?null:this.doFragPartsLoad(e,v,s,n)).catch(S=>this.handleFragLoadError(S)):w=this.doFragPartsLoad(e,v,s,n).catch(S=>this.handleFragLoadError(S)),this.hls.trigger(Q.FRAG_LOADING,{frag:e,part:v,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):w}else if(!e.url||this.loadedEndOfParts(x,r))return Promise.resolve(null)}}if(ur(e)&&this.loadingParts){var u;this.log(`LL-Part loading OFF after next part miss @${r.toFixed(2)} Check buffer at sn: ${e.sn} loaded parts: ${(u=c.partList)==null?void 0:u.filter(x=>x.loaded).map(x=>`[${x.start}-${x.end}]`)}`),this.loadingParts=!1}else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${"["+c.startSN+"-"+c.endSN+"]"}, target: ${parseFloat(r.toFixed(3))}`),Tt(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=ut.FRAG_LOADING;const m=this.config.progressive&&e.type!==Rt.SUBTITLE;let g;return m&&d?g=d.then(x=>!x||this.fragContextChanged(x.frag)?null:this.fragmentLoader.load(e,n)).catch(x=>this.handleFragLoadError(x)):g=Promise.all([this.fragmentLoader.load(e,m?n:void 0),d]).then(([x])=>(!m&&n&&n(x),x)).catch(x=>this.handleFragLoadError(x)),this.hls.trigger(Q.FRAG_LOADING,{frag:e,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):g}doFragPartsLoad(e,s,r,n){return new Promise((o,c)=>{var d;const f=[],u=(d=r.details)==null?void 0:d.partList,m=g=>{this.fragmentLoader.loadPart(e,g,n).then(x=>{f[g.index]=x;const b=x.part;this.hls.trigger(Q.FRAG_LOADED,x);const v=O1(r.details,e.sn,g.index+1)||Zj(u,e.sn,g.index+1);if(v)m(v);else return o({frag:e,part:b,partsLoaded:f})}).catch(c)};m(s)})}handleFragLoadError(e){if("data"in e){const s=e.data;s.frag&&s.details===ze.INTERNAL_ABORTED?this.handleFragLoadAborted(s.frag,s.part):s.frag&&s.type===Ft.KEY_SYSTEM_ERROR?(s.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(s.frag)):this.hls.trigger(Q.ERROR,s)}else this.hls.trigger(Q.ERROR,{type:Ft.OTHER_ERROR,details:ze.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const s=this.getCurrentContext(e);if(!s||this.state!==ut.PARSING){!this.fragCurrent&&this.state!==ut.STOPPED&&this.state!==ut.ERROR&&(this.state=ut.IDLE);return}const{frag:r,part:n,level:o}=s,c=self.performance.now();r.stats.parsing.end=c,n&&(n.stats.parsing.end=c);const d=this.getLevelDetails(),u=d&&r.sn>d.endSN||this.shouldLoadParts(d,r.end);u!==this.loadingParts&&(this.log(`LL-Part loading ${u?"ON":"OFF"} after parsing segment ending @${r.end.toFixed(2)}`),this.loadingParts=u),this.updateLevelTiming(r,n,o,e.partial)}shouldLoadParts(e,s){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var r;const o=e.partList[0];if(o.fragment.type===Rt.SUBTITLE)return!1;const c=o.end+(((r=e.fragmentHint)==null?void 0:r.duration)||0);if(s>=c){var n;if((this.hls.hasEnoughToStart?((n=this.media)==null?void 0:n.currentTime)||this.lastCurrentTime:this.getLoadPosition())>o.start-o.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:s,fragCurrent:r}=this,{level:n,sn:o,part:c}=e;if(!(s!=null&&s[n]))return this.warn(`Levels object was unset while buffering fragment ${o} of ${this.playlistLabel()} ${n}. The current chunk will not be buffered.`),null;const d=s[n],f=d.details,u=c>-1?O1(f,o,c):null,m=u?u.fragment:Xj(f,o,r);return m?(r&&r!==m&&(m.stats=r.stats),{frag:m,part:u,level:d}):null}bufferFragmentData(e,s,r,n,o){if(this.state!==ut.PARSING)return;const{data1:c,data2:d}=e;let f=c;if(d&&(f=Ha(c,d)),!f.length)return;const u=this.initPTS[s.cc],m=u?-u.baseTime/u.timescale:void 0,g={type:e.type,frag:s,part:r,chunkMeta:n,offset:m,parent:s.type,data:f};if(this.hls.trigger(Q.BUFFER_APPENDING,g),e.dropped&&e.independent&&!r){if(o)return;this.flushBufferGap(s)}}flushBufferGap(e){const s=this.media;if(!s)return;if(!Zt.isBuffered(s,s.currentTime)){this.flushMainBuffer(0,e.start);return}const r=s.currentTime,n=Zt.bufferInfo(s,r,0),o=e.duration,c=Math.min(this.config.maxFragLookUpTolerance*2,o*.25),d=Math.max(Math.min(e.start-c,n.end-c),r+c);e.start-d>c&&this.flushMainBuffer(d,e.start)}getFwdBufferInfo(e,s){var r;const n=this.getLoadPosition();if(!Tt(n))return null;const c=this.lastCurrentTime>n||(r=this.media)!=null&&r.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,n,s,c)}getFwdBufferInfoAtPos(e,s,r,n){const o=Zt.bufferInfo(e,s,n);if(o.len===0&&o.nextStart!==void 0){const c=this.fragmentTracker.getBufferedFrag(s,r);if(c&&(o.nextStart<=c.end||c.gap)){const d=Math.max(Math.min(o.nextStart,c.end)-s,n);return Zt.bufferInfo(e,s,d)}}return o}getMaxBufferLength(e){const{config:s}=this;let r;return e?r=Math.max(8*s.maxBufferSize/e,s.maxBufferLength):r=s.maxBufferLength,Math.min(r,s.maxMaxBufferLength)}reduceMaxBufferLength(e,s){const r=this.config,n=Math.max(Math.min(e-s,r.maxBufferLength),s),o=Math.max(e-s*3,r.maxMaxBufferLength/2,n);return o>=n?(r.maxMaxBufferLength=o,this.warn(`Reduce max buffer length to ${o}s`),!0):!1}getAppendedFrag(e,s=Rt.MAIN){const r=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,s):null;return r&&"fragment"in r?r.fragment:r}getNextFragment(e,s){const r=s.fragments,n=r.length;if(!n)return null;const{config:o}=this,c=r[0].start,d=o.lowLatencyMode&&!!s.partList;let f=null;if(s.live){const g=o.initialLiveManifestSize;if(n<g)return this.warn(`Not enough fragments to start playback (have: ${n}, need: ${g})`),null;if(!s.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<c){var u;d&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),f=this.getInitialLiveFragment(s);const x=this.hls.startPosition,b=this.hls.liveSyncPosition,v=f?(x!==-1&&x>=c?x:b)||f.start:e;this.log(`Setting startPosition to ${v} to match start frag at live edge. mainStart: ${x} liveSyncPosition: ${b} frag.start: ${(u=f)==null?void 0:u.start}`),this.startPosition=this.nextLoadPosition=v}}else e<=c&&(f=r[0]);if(!f){const g=this.loadingParts?s.partEnd:s.fragmentEnd;f=this.getFragmentAtPosition(e,g,s)}let m=this.filterReplacedPrimary(f,s);if(!m&&f){const g=f.sn-s.startSN;m=this.filterReplacedPrimary(r[g+1]||null,s)}return this.mapToInitFragWhenRequired(m)}isLoopLoading(e,s){const r=this.fragmentTracker.getState(e);return(r===Sr.OK||r===Sr.PARTIAL&&!!e.gap)&&this.nextLoadPosition>s}getNextFragmentLoopLoading(e,s,r,n,o){let c=null;if(e.gap&&(c=this.getNextFragment(this.nextLoadPosition,s),c&&!c.gap&&r.nextStart)){const d=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,n,0);if(d!==null&&r.len+d.len>=o){const f=c.sn;return this.loopSn!==f&&(this.log(`buffer full after gaps in "${n}" playlist starting at sn: ${f}`),this.loopSn=f),null}}return this.loopSn=void 0,c}get primaryPrefetch(){if(U1(this.config)){var e;if((e=this.hls.interstitialsManager)==null||(e=e.playingItem)==null?void 0:e.event)return!0}return!1}filterReplacedPrimary(e,s){if(!e)return e;if(U1(this.config)&&e.type!==Rt.SUBTITLE){const r=this.hls.interstitialsManager,n=r==null?void 0:r.bufferingItem;if(n){const c=n.event;if(c){if(c.appendInPlace||Math.abs(e.start-n.start)>1||n.start===0)return null}else if(e.end<=n.start&&(s==null?void 0:s.live)===!1||e.start>n.end&&n.nextEvent&&(n.nextEvent.appendInPlace||e.start-n.end>1))return null}const o=r==null?void 0:r.playerQueue;if(o)for(let c=o.length;c--;){const d=o[c].interstitial;if(d.appendInPlace&&e.start>=d.startTime&&e.end<=d.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!e.initSegment.data&&!this.bitrateTest?e.initSegment:e}getNextPart(e,s,r){let n=-1,o=!1,c=!0;for(let d=0,f=e.length;d<f;d++){const u=e[d];if(c=c&&!u.independent,n>-1&&r<u.start)break;const m=u.loaded;m?n=-1:(o||(u.independent||c)&&u.fragment===s)&&(u.fragment!==s&&this.warn(`Need buffer at ${r} but next unloaded part starts at ${u.start}`),n=d),o=m}return n}loadedEndOfParts(e,s){let r;for(let n=e.length;n--;){if(r=e[n],!r.loaded)return!1;if(s>r.start)return!0}return!1}getInitialLiveFragment(e){const s=e.fragments,r=this.fragPrevious;let n=null;if(r){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${r.programDateTime}`),n=QM(s,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!n){const o=r.sn+1;if(o>=e.startSN&&o<=e.endSN){const c=s[o-e.startSN];r.cc===c.cc&&(n=c,this.log(`Live playlist, switching playlist, load frag with next SN: ${n.sn}`))}n||(n=Oj(e,r.cc,r.end),n&&this.log(`Live playlist, switching playlist, load frag with same CC: ${n.sn}`))}}else{const o=this.hls.liveSyncPosition;o!==null&&(n=this.getFragmentAtPosition(o,this.bitrateTest?e.fragmentEnd:e.edge,e))}return n}getFragmentAtPosition(e,s,r){const{config:n}=this;let{fragPrevious:o}=this,{fragments:c,endSN:d}=r;const{fragmentHint:f}=r,{maxFragLookUpTolerance:u}=n,m=r.partList,g=!!(this.loadingParts&&m!=null&&m.length&&f);g&&!this.bitrateTest&&m[m.length-1].fragment.sn===f.sn&&(c=c.concat(f),d=f.sn);let x;if(e<s){var b;const w=e<this.lastCurrentTime||e>s-u||(b=this.media)!=null&&b.paused||!this.startFragRequested?0:u;x=ol(o,c,e,w)}else x=c[c.length-1];if(x){const v=x.sn-r.startSN,w=this.fragmentTracker.getState(x);if((w===Sr.OK||w===Sr.PARTIAL&&x.gap)&&(o=x),o&&x.sn===o.sn&&(!g||m[0].fragment.sn>x.sn||!r.live)&&x.level===o.level){const T=c[v+1];x.sn<d&&this.fragmentTracker.getState(T)!==Sr.OK?x=T:x=null}}return x}alignPlaylists(e,s,r){const n=e.fragments.length;if(!n)return this.warn("No fragments in live playlist"),0;const o=e.fragmentStart,c=!s,d=e.alignedSliding&&Tt(o);if(c||!d&&!o){D6(r,e);const f=e.fragmentStart;return this.log(`Live playlist sliding: ${f.toFixed(2)} start-sn: ${s?s.startSN:"na"}->${e.startSN} fragments: ${n}`),f}return o}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,s){let r=this.startPosition;r<s&&(r=-1);const n=this.timelineOffset;if(r===-1){const o=this.startTimeOffset!==null,c=o?this.startTimeOffset:e.startTimeOffset;c!==null&&Tt(c)?(r=s+c,c<0&&(r+=e.edge),r=Math.min(Math.max(s,r),s+e.totalduration),this.log(`Setting startPosition to ${r} for start time offset ${c} found in ${o?"multivariant":"media"} playlist`),this.startPosition=r):e.live?(r=this.hls.liveSyncPosition||s,this.log(`Setting startPosition to -1 to start at live edge ${r}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=r=0),this.lastCurrentTime=r+n}this.nextLoadPosition=r+n}getLoadPosition(){var e;const{media:s}=this;let r=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&s?r=s.currentTime:this.nextLoadPosition>=0&&(r=this.nextLoadPosition),r}handleFragLoadAborted(e,s){this.transmuxer&&e.type===this.playlistType&&ur(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${s?" part "+s.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==ut.FRAG_LOADING_WAITING_RETRY)&&(this.state=ut.IDLE)}onFragmentOrKeyLoadError(e,s){var r;if(s.chunkMeta&&!s.frag){const T=this.getCurrentContext(s.chunkMeta);T&&(s.frag=T.frag)}const n=s.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){var o;this.warn(`Frag load error must match current frag to retry ${n.url} > ${(o=this.fragCurrent)==null?void 0:o.url}`);return}const c=s.details===ze.FRAG_GAP;c&&this.fragmentTracker.fragBuffered(n,!0);const d=s.errorAction;if(!d){this.state=ut.ERROR;return}const{action:f,flags:u,retryCount:m=0,retryConfig:g}=d,x=!!g,b=x&&f===Dr.RetryRequest,v=x&&!d.resolved&&u===wa.MoveAllAlternatesMatchingHost,w=(r=this.hls.latestLevelDetails)==null?void 0:r.live;if(!b&&v&&ur(n)&&!n.endList&&w&&!Bj(s))this.resetFragmentErrors(e),this.treatAsGap(n),d.resolved=!0;else if((b||v)&&m<g.maxNumRetry){var S;const T=Bp((S=s.response)==null?void 0:S.code),k=Ix(g,m);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+k,this.state=ut.FRAG_LOADING_WAITING_RETRY,d.resolved=!0,T){this.log("Waiting for connection (offline)"),this.retryDate=1/0,s.reason="offline";return}this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${s.details}, retrying loading ${m+1}/${g.maxNumRetry} in ${k}ms`)}else if(g)if(this.resetFragmentErrors(e),m<g.maxNumRetry)!c&&f!==Dr.RemoveAlternatePermanently&&(d.resolved=!0);else{this.warn(`${s.details} reached or exceeded max retry (${m})`);return}else f===Dr.SendAlternateToPenaltyBox?this.state=ut.WAITING_LEVEL:this.state=ut.ERROR;this.tickImmediate()}checkRetryDate(){const e=self.performance.now(),s=this.retryDate,r=s===1/0;(!s||e>=s||r&&!Bp(0))&&(r&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=ut.IDLE)}reduceLengthAndFlushBuffer(e){if(this.state===ut.PARSING||this.state===ut.PARSED){const s=e.frag,r=e.parent,n=this.getFwdBufferInfo(this.mediaBuffer,r),o=n&&n.len>.5;o&&this.reduceMaxBufferLength(n.len,(s==null?void 0:s.duration)||10);const c=!o;return c&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${r} buffer`),s&&(this.fragmentTracker.removeFragment(s),this.nextLoadPosition=s.start),this.resetLoadingState(),c}return!1}resetFragmentErrors(e){e===Rt.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==ut.STOPPED&&(this.state=ut.IDLE)}afterBufferFlushed(e,s,r){if(!e)return;const n=Zt.getBuffered(e);this.fragmentTracker.detectEvictedFragments(s,n,r),this.state===ut.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==ut.STOPPED&&(this.state=ut.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const e=this.levelLastLoaded,s=e?e.details:null;s!=null&&s.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(s,s.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.log(`Loading context changed while buffering sn ${e.sn} of ${this.playlistLabel()} ${e.level===-1?"<removed>":e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,s,r,n){const o=r.details;if(!o){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((f,u)=>{const m=e.elementaryStreams[u];if(m){const g=m.endPTS-m.startPTS;if(g<=0)return this.warn(`Could not parse fragment ${e.sn} ${u} duration reliably (${g})`),f||!1;const x=n?0:Yj(o,e,m.startPTS,m.endPTS,m.startDTS,m.endDTS,this);return this.hls.trigger(Q.LEVEL_PTS_UPDATED,{details:o,level:r,drift:x,type:u,frag:e,start:m.startPTS,end:m.endPTS}),!0}return f},!1)){var d;const f=((d=this.transmuxer)==null?void 0:d.error)===null;if((r.fragmentError===0||f&&(r.fragmentError<2||e.endList))&&this.treatAsGap(e,r),f){const u=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(u.message),this.hls.trigger(Q.ERROR,{type:Ft.MEDIA_ERROR,details:ze.FRAG_PARSING_ERROR,fatal:!1,error:u,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${r.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=ut.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${s?" part: "+s.index:""} of ${this.fragInfo(e,!1,s)})`),this.hls.trigger(Q.FRAG_PARSED,{frag:e,part:s})}playlistLabel(){return this.playlistType===Rt.MAIN?"level":"track"}fragInfo(e,s=!0,r){var n,o;return`${this.playlistLabel()} ${e.level} (${r?"part":"frag"}:[${((n=s&&!r?e.startPTS:(r||e).start)!=null?n:NaN).toFixed(3)}-${((o=s&&!r?e.endPTS:(r||e).end)!=null?o:NaN).toFixed(3)}]${r&&e.type==="main"?"INDEPENDENT="+(r.independent?"YES":"NO"):""}`}treatAsGap(e,s){s&&s.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(e){const s=this._state;s!==e&&(this._state=e,this.log(`${s}->${e}`))}get state(){return this._state}}function U1(a){return!!a.interstitialsController&&a.enableInterstitialPlayback!==!1}class s2{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:s}=this;let r;if(e.length)e.length===1?r=e[0]:r=M6(e,s);else return new Uint8Array(0);return this.reset(),r}reset(){this.chunks.length=0,this.dataLength=0}}function M6(a,e){const s=new Uint8Array(e);let r=0;for(let n=0;n<a.length;n++){const o=a[n];s.set(o,r),r+=o.length}return s}var Ig={exports:{}},$1;function P6(){return $1||($1=1,(function(a){var e=Object.prototype.hasOwnProperty,s="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(s=!1));function n(f,u,m){this.fn=f,this.context=u,this.once=m||!1}function o(f,u,m,g,x){if(typeof m!="function")throw new TypeError("The listener must be a function");var b=new n(m,g||f,x),v=s?s+u:u;return f._events[v]?f._events[v].fn?f._events[v]=[f._events[v],b]:f._events[v].push(b):(f._events[v]=b,f._eventsCount++),f}function c(f,u){--f._eventsCount===0?f._events=new r:delete f._events[u]}function d(){this._events=new r,this._eventsCount=0}d.prototype.eventNames=function(){var u=[],m,g;if(this._eventsCount===0)return u;for(g in m=this._events)e.call(m,g)&&u.push(s?g.slice(1):g);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(m)):u},d.prototype.listeners=function(u){var m=s?s+u:u,g=this._events[m];if(!g)return[];if(g.fn)return[g.fn];for(var x=0,b=g.length,v=new Array(b);x<b;x++)v[x]=g[x].fn;return v},d.prototype.listenerCount=function(u){var m=s?s+u:u,g=this._events[m];return g?g.fn?1:g.length:0},d.prototype.emit=function(u,m,g,x,b,v){var w=s?s+u:u;if(!this._events[w])return!1;var S=this._events[w],T=arguments.length,k,E;if(S.fn){switch(S.once&&this.removeListener(u,S.fn,void 0,!0),T){case 1:return S.fn.call(S.context),!0;case 2:return S.fn.call(S.context,m),!0;case 3:return S.fn.call(S.context,m,g),!0;case 4:return S.fn.call(S.context,m,g,x),!0;case 5:return S.fn.call(S.context,m,g,x,b),!0;case 6:return S.fn.call(S.context,m,g,x,b,v),!0}for(E=1,k=new Array(T-1);E<T;E++)k[E-1]=arguments[E];S.fn.apply(S.context,k)}else{var R=S.length,K;for(E=0;E<R;E++)switch(S[E].once&&this.removeListener(u,S[E].fn,void 0,!0),T){case 1:S[E].fn.call(S[E].context);break;case 2:S[E].fn.call(S[E].context,m);break;case 3:S[E].fn.call(S[E].context,m,g);break;case 4:S[E].fn.call(S[E].context,m,g,x);break;default:if(!k)for(K=1,k=new Array(T-1);K<T;K++)k[K-1]=arguments[K];S[E].fn.apply(S[E].context,k)}}return!0},d.prototype.on=function(u,m,g){return o(this,u,m,g,!1)},d.prototype.once=function(u,m,g){return o(this,u,m,g,!0)},d.prototype.removeListener=function(u,m,g,x){var b=s?s+u:u;if(!this._events[b])return this;if(!m)return c(this,b),this;var v=this._events[b];if(v.fn)v.fn===m&&(!x||v.once)&&(!g||v.context===g)&&c(this,b);else{for(var w=0,S=[],T=v.length;w<T;w++)(v[w].fn!==m||x&&!v[w].once||g&&v[w].context!==g)&&S.push(v[w]);S.length?this._events[b]=S.length===1?S[0]:S:c(this,b)}return this},d.prototype.removeAllListeners=function(u){var m;return u?(m=s?s+u:u,this._events[m]&&c(this,m)):(this._events=new r,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=s,d.EventEmitter=d,a.exports=d})(Ig)),Ig.exports}var O6=P6(),Ux=lM(O6);const Gd="1.6.15",pc={};function F6(){return typeof __HLS_WORKER_BUNDLE__=="function"}function B6(){const a=pc[Gd];if(a)return a.clientCount++,a;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),s=self.URL.createObjectURL(e),n={worker:new self.Worker(s),objectURL:s,clientCount:1};return pc[Gd]=n,n}function U6(a){const e=pc[a];if(e)return e.clientCount++,e;const s=new self.URL(a,self.location.href).href,n={worker:new self.Worker(s),scriptURL:s,clientCount:1};return pc[a]=n,n}function $6(a){const e=pc[a||Gd];if(e&&e.clientCount--===1){const{worker:r,objectURL:n}=e;delete pc[a||Gd],n&&self.URL.revokeObjectURL(n),r.terminate()}}function r2(a,e){return e+10<=a.length&&a[e]===51&&a[e+1]===68&&a[e+2]===73&&a[e+3]<255&&a[e+4]<255&&a[e+6]<128&&a[e+7]<128&&a[e+8]<128&&a[e+9]<128}function $x(a,e){return e+10<=a.length&&a[e]===73&&a[e+1]===68&&a[e+2]===51&&a[e+3]<255&&a[e+4]<255&&a[e+6]<128&&a[e+7]<128&&a[e+8]<128&&a[e+9]<128}function em(a,e){let s=0;return s=(a[e]&127)<<21,s|=(a[e+1]&127)<<14,s|=(a[e+2]&127)<<7,s|=a[e+3]&127,s}function Hd(a,e){const s=e;let r=0;for(;$x(a,e);){r+=10;const n=em(a,e+6);r+=n,r2(a,e+10)&&(r+=10),e+=r}if(r>0)return a.subarray(s,s+r)}function G6(a,e,s,r){const n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],o=e[s+2],c=o>>2&15;if(c>12){const b=new Error(`invalid ADTS sampling index:${c}`);a.emit(Q.ERROR,Q.ERROR,{type:Ft.MEDIA_ERROR,details:ze.FRAG_PARSING_ERROR,fatal:!0,error:b,reason:b.message});return}const d=(o>>6&3)+1,f=e[s+3]>>6&3|(o&1)<<2,u="mp4a.40."+d,m=n[c];let g=c;(d===5||d===29)&&(g-=3);const x=[d<<3|(g&14)>>1,(g&1)<<7|f<<3];return Ms.log(`manifest codec:${r}, parsed codec:${u}, channels:${f}, rate:${m} (ADTS object type:${d} sampling index:${c})`),{config:x,samplerate:m,channelCount:f,codec:u,parsedCodec:u,manifestCodec:r}}function a2(a,e){return a[e]===255&&(a[e+1]&246)===240}function n2(a,e){return a[e+1]&1?7:9}function Gx(a,e){return(a[e+3]&3)<<11|a[e+4]<<3|(a[e+5]&224)>>>5}function H6(a,e){return e+5<a.length}function Lf(a,e){return e+1<a.length&&a2(a,e)}function V6(a,e){return H6(a,e)&&a2(a,e)&&Gx(a,e)<=a.length-e}function z6(a,e){if(Lf(a,e)){const s=n2(a,e);if(e+s>=a.length)return!1;const r=Gx(a,e);if(r<=s)return!1;const n=e+r;return n===a.length||Lf(a,n)}return!1}function i2(a,e,s,r,n){if(!a.samplerate){const o=G6(e,s,r,n);if(!o)return;Us(a,o)}}function o2(a){return 1024*9e4/a}function q6(a,e){const s=n2(a,e);if(e+s<=a.length){const r=Gx(a,e)-s;if(r>0)return{headerLength:s,frameLength:r}}}function l2(a,e,s,r,n){const o=o2(a.samplerate),c=r+n*o,d=q6(e,s);let f;if(d){const{frameLength:g,headerLength:x}=d,b=x+g,v=Math.max(0,s+b-e.length);v?(f=new Uint8Array(b-x),f.set(e.subarray(s+x,e.length),0)):f=e.subarray(s+x,s+b);const w={unit:f,pts:c};return v||a.samples.push(w),{sample:w,length:b,missing:v}}const u=e.length-s;return f=new Uint8Array(u),f.set(e.subarray(s,e.length),0),{sample:{unit:f,pts:c},length:u,missing:-1}}function K6(a,e){return $x(a,e)&&em(a,e+6)+10<=a.length-e}function Y6(a){return a instanceof ArrayBuffer?a:a.byteOffset==0&&a.byteLength==a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer}function Mg(a,e=0,s=1/0){return W6(a,e,s,Uint8Array)}function W6(a,e,s,r){const n=Q6(a);let o=1;"BYTES_PER_ELEMENT"in r&&(o=r.BYTES_PER_ELEMENT);const c=X6(a)?a.byteOffset:0,d=(c+a.byteLength)/o,f=(c+e)/o,u=Math.floor(Math.max(0,Math.min(f,d))),m=Math.floor(Math.min(u+Math.max(s,0),d));return new r(n,u,m-u)}function Q6(a){return a instanceof ArrayBuffer?a:a.buffer}function X6(a){return a&&a.buffer instanceof ArrayBuffer&&a.byteLength!==void 0&&a.byteOffset!==void 0}function Z6(a){const e={key:a.type,description:"",data:"",mimeType:null,pictureType:null},s=3;if(a.size<2)return;if(a.data[0]!==s){console.log("Ignore frame with unrecognized character encoding");return}const r=a.data.subarray(1).indexOf(0);if(r===-1)return;const n=ja(Mg(a.data,1,r)),o=a.data[2+r],c=a.data.subarray(3+r).indexOf(0);if(c===-1)return;const d=ja(Mg(a.data,3+r,c));let f;return n==="-->"?f=ja(Mg(a.data,4+r+c)):f=Y6(a.data.subarray(4+r+c)),e.mimeType=n,e.pictureType=o,e.description=d,e.data=f,e}function J6(a){if(a.size<2)return;const e=ja(a.data,!0),s=new Uint8Array(a.data.subarray(e.length+1));return{key:a.type,info:e,data:s.buffer}}function eP(a){if(a.size<2)return;if(a.type==="TXXX"){let s=1;const r=ja(a.data.subarray(s),!0);s+=r.length+1;const n=ja(a.data.subarray(s));return{key:a.type,info:r,data:n}}const e=ja(a.data.subarray(1));return{key:a.type,info:"",data:e}}function tP(a){if(a.type==="WXXX"){if(a.size<2)return;let s=1;const r=ja(a.data.subarray(s),!0);s+=r.length+1;const n=ja(a.data.subarray(s));return{key:a.type,info:r,data:n}}const e=ja(a.data);return{key:a.type,info:"",data:e}}function sP(a){return a.type==="PRIV"?J6(a):a.type[0]==="W"?tP(a):a.type==="APIC"?Z6(a):eP(a)}function rP(a){const e=String.fromCharCode(a[0],a[1],a[2],a[3]),s=em(a,4),r=10;return{type:e,size:s,data:a.subarray(r,r+s)}}const Mh=10,aP=10;function c2(a){let e=0;const s=[];for(;$x(a,e);){const r=em(a,e+6);a[e+5]>>6&1&&(e+=Mh),e+=Mh;const n=e+r;for(;e+aP<n;){const o=rP(a.subarray(e)),c=sP(o);c&&s.push(c),e+=o.size+Mh}r2(a,e)&&(e+=Mh)}return s}function d2(a){return a&&a.key==="PRIV"&&a.info==="com.apple.streaming.transportStreamTimestamp"}function nP(a){if(a.data.byteLength===8){const e=new Uint8Array(a.data),s=e[3]&1;let r=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return r/=45,s&&(r+=4772185884e-2),Math.round(r)}}function Hx(a){const e=c2(a);for(let s=0;s<e.length;s++){const r=e[s];if(d2(r))return nP(r)}}let _a=(function(a){return a.audioId3="org.id3",a.dateRange="com.apple.quicktime.HLS",a.emsg="https://aomedia.org/emsg/ID3",a.misbklv="urn:misb:KLV:bin:1910.1",a})({});function Sn(a="",e=9e4){return{type:a,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Vx{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,s,r,n){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,s){return!1}appendFrame(e,s,r){}demux(e,s){this.cachedData&&(e=Ha(this.cachedData,e),this.cachedData=null);let r=Hd(e,0),n=r?r.length:0,o;const c=this._audioTrack,d=this._id3Track,f=r?Hx(r):void 0,u=e.length;for((this.basePTS===null||this.frameIndex===0&&Tt(f))&&(this.basePTS=iP(f,s,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),r&&r.length>0&&d.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:_a.audioId3,duration:Number.POSITIVE_INFINITY});n<u;){if(this.canParse(e,n)){const m=this.appendFrame(c,e,n);m?(this.frameIndex++,this.lastPTS=m.sample.pts,n+=m.length,o=n):n=u}else K6(e,n)?(r=Hd(e,n),d.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:_a.audioId3,duration:Number.POSITIVE_INFINITY}),n+=r.length,o=n):n++;if(n===u&&o!==u){const m=e.slice(o);this.cachedData?this.cachedData=Ha(this.cachedData,m):this.cachedData=m}}return{audioTrack:c,videoTrack:Sn(),id3Track:d,textTrack:Sn()}}demuxSampleAes(e,s,r){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const s=this.cachedData;return s&&(this.cachedData=null,this.demux(s,0)),{audioTrack:this._audioTrack,videoTrack:Sn(),id3Track:this._id3Track,textTrack:Sn()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const iP=(a,e,s)=>{if(Tt(a))return a*90;const r=s?s.baseTime*9e4/s.timescale:0;return e*9e4+r};let Ph=null;const oP=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],lP=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],cP=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],dP=[0,1,1,4];function u2(a,e,s,r,n){if(s+24>e.length)return;const o=h2(e,s);if(o&&s+o.frameLength<=e.length){const c=o.samplesPerFrame*9e4/o.sampleRate,d=r+n*c,f={unit:e.subarray(s,s+o.frameLength),pts:d,dts:d};return a.config=[],a.channelCount=o.channelCount,a.samplerate=o.sampleRate,a.samples.push(f),{sample:f,length:o.frameLength,missing:0}}}function h2(a,e){const s=a[e+1]>>3&3,r=a[e+1]>>1&3,n=a[e+2]>>4&15,o=a[e+2]>>2&3;if(s!==1&&n!==0&&n!==15&&o!==3){const c=a[e+2]>>1&1,d=a[e+3]>>6,f=s===3?3-r:r===3?3:4,u=oP[f*14+n-1]*1e3,g=lP[(s===3?0:s===2?1:2)*3+o],x=d===3?1:2,b=cP[s][r],v=dP[r],w=b*8*v,S=Math.floor(b*u/g+c)*v;if(Ph===null){const E=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Ph=E?parseInt(E[1]):0}return!!Ph&&Ph<=87&&r===2&&u>=224e3&&d===0&&(a[e+3]=a[e+3]|128),{sampleRate:g,channelCount:x,frameLength:S,samplesPerFrame:w}}}function zx(a,e){return a[e]===255&&(a[e+1]&224)===224&&(a[e+1]&6)!==0}function f2(a,e){return e+1<a.length&&zx(a,e)}function uP(a,e){return zx(a,e)&&4<=a.length-e}function m2(a,e){if(e+1<a.length&&zx(a,e)){const r=h2(a,e);let n=4;r!=null&&r.frameLength&&(n=r.frameLength);const o=e+n;return o===a.length||f2(a,o)}return!1}class hP extends Vx{constructor(e,s){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=s}resetInitSegment(e,s,r,n){super.resetInitSegment(e,s,r,n),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:s,duration:n,inputTimeScale:9e4,dropped:0}}static probe(e,s){if(!e)return!1;const r=Hd(e,0);let n=(r==null?void 0:r.length)||0;if(m2(e,n))return!1;for(let o=e.length;n<o;n++)if(z6(e,n))return s.log("ADTS sync word found !"),!0;return!1}canParse(e,s){return V6(e,s)}appendFrame(e,s,r){i2(e,this.observer,s,r,e.manifestCodec);const n=l2(e,s,r,this.basePTS,this.frameIndex);if(n&&n.missing===0)return n}}const g2=(a,e)=>{let s=0,r=5;e+=r;const n=new Uint32Array(1),o=new Uint32Array(1),c=new Uint8Array(1);for(;r>0;){c[0]=a[e];const d=Math.min(r,8),f=8-d;o[0]=4278190080>>>24+f<<f,n[0]=(c[0]&o[0])>>f,s=s?s<<d|n[0]:n[0],e+=1,r-=d}return s};class fP extends Vx{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,s,r,n){super.resetInitSegment(e,s,r,n),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:s,duration:n,inputTimeScale:9e4,dropped:0}}canParse(e,s){return s+64<e.length}appendFrame(e,s,r){const n=p2(e,s,r,this.basePTS,this.frameIndex);if(n!==-1)return{sample:e.samples[e.samples.length-1],length:n,missing:0}}static probe(e){if(!e)return!1;const s=Hd(e,0);if(!s)return!1;const r=s.length;return e[r]===11&&e[r+1]===119&&Hx(s)!==void 0&&g2(e,r)<16}}function p2(a,e,s,r,n){if(s+8>e.length||e[s]!==11||e[s+1]!==119)return-1;const o=e[s+4]>>6;if(o>=3)return-1;const d=[48e3,44100,32e3][o],f=e[s+4]&63,m=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][f*3+o]*2;if(s+m>e.length)return-1;const g=e[s+6]>>5;let x=0;g===2?x+=2:(g&1&&g!==1&&(x+=2),g&4&&(x+=2));const b=(e[s+6]<<8|e[s+7])>>12-x&1,w=[2,1,2,3,3,4,4,5][g]+b,S=e[s+5]>>3,T=e[s+5]&7,k=new Uint8Array([o<<6|S<<1|T>>2,(T&3)<<6|g<<3|b<<2|f>>4,f<<4&224]),E=1536/d*9e4,R=r+n*E,K=e.subarray(s,s+m);return a.config=k,a.channelCount=w,a.samplerate=d,a.samples.push({unit:K,pts:R}),m}class mP extends Vx{resetInitSegment(e,s,r,n){super.resetInitSegment(e,s,r,n),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:s,duration:n,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const s=Hd(e,0);let r=(s==null?void 0:s.length)||0;if(s&&e[r]===11&&e[r+1]===119&&Hx(s)!==void 0&&g2(e,r)<=16)return!1;for(let n=e.length;r<n;r++)if(m2(e,r))return Ms.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,s){return uP(e,s)}appendFrame(e,s,r){if(this.basePTS!==null)return u2(e,s,r,this.basePTS,this.frameIndex)}}const gP=/\/emsg[-/]ID3/i;class pP{constructor(e,s){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=s}resetTimeStamp(){}resetInitSegment(e,s,r,n){const o=this.videoTrack=Sn("video",1),c=this.audioTrack=Sn("audio",1),d=this.txtTrack=Sn("text",1);if(this.id3Track=Sn("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const f=Ej(e);if(f.video){const{id:u,timescale:m,codec:g,supplemental:x}=f.video;o.id=u,o.timescale=d.timescale=m,o.codec=g,o.supplemental=x}if(f.audio){const{id:u,timescale:m,codec:g}=f.audio;c.id=u,c.timescale=m,c.codec=g}d.id=_j.text,o.sampleDuration=0,o.duration=c.duration=n}resetContiguity(){this.remainderData=null}static probe(e){return fM(e)}demux(e,s){this.timeOffset=s;let r=e;const n=this.videoTrack,o=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=Ha(this.remainderData,e));const d=vM(r);this.remainderData=d.remainder,n.samples=d.valid||new Uint8Array}else n.samples=r;const c=this.extractID3Track(n,s);return o.samples=n1(s,n),{videoTrack:n,audioTrack:this.audioTrack,id3Track:c,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,s=this.videoTrack,r=this.txtTrack;s.samples=this.remainderData||new Uint8Array,this.remainderData=null;const n=this.extractID3Track(s,this.timeOffset);return r.samples=n1(e,s),{videoTrack:s,audioTrack:Sn(),id3Track:n,textTrack:Sn()}}extractID3Track(e,s){const r=this.id3Track;if(e.samples.length){const n=ls(e.samples,["emsg"]);n&&n.forEach(o=>{const c=SM(o);if(gP.test(c.schemeIdUri)){const d=G1(c,s);let f=c.eventDuration===4294967295?Number.POSITIVE_INFINITY:c.eventDuration/c.timeScale;f<=.001&&(f=Number.POSITIVE_INFINITY);const u=c.payload;r.samples.push({data:u,len:u.byteLength,dts:d,pts:d,type:_a.emsg,duration:f})}else if(this.config.enableEmsgKLVMetadata&&c.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const d=G1(c,s);r.samples.push({data:c.payload,len:c.payload.byteLength,dts:d,pts:d,type:_a.misbklv,duration:Number.POSITIVE_INFINITY})}})}return r}demuxSampleAes(e,s,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function G1(a,e){return Tt(a.presentationTime)?a.presentationTime/a.timeScale:e+a.presentationTimeDelta/a.timeScale}class xP{constructor(e,s,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new Mx(s,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,uo.cbc)}decryptAacSample(e,s,r){const n=e[s].unit;if(n.length<=16)return;const o=n.subarray(16,n.length-n.length%16),c=o.buffer.slice(o.byteOffset,o.byteOffset+o.length);this.decryptBuffer(c).then(d=>{const f=new Uint8Array(d);n.set(f,16),this.decrypter.isSync()||this.decryptAacSamples(e,s+1,r)}).catch(r)}decryptAacSamples(e,s,r){for(;;s++){if(s>=e.length){r();return}if(!(e[s].unit.length<32)&&(this.decryptAacSample(e,s,r),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const s=Math.floor((e.length-48)/160)*16+16,r=new Int8Array(s);let n=0;for(let o=32;o<e.length-16;o+=160,n+=16)r.set(e.subarray(o,o+16),n);return r}getAvcDecryptedUnit(e,s){const r=new Uint8Array(s);let n=0;for(let o=32;o<e.length-16;o+=160,n+=16)e.set(r.subarray(n,n+16),o);return e}decryptAvcSample(e,s,r,n,o){const c=Cj(o.data),d=this.getAvcEncryptedData(c);this.decryptBuffer(d.buffer).then(f=>{o.data=this.getAvcDecryptedUnit(c,f),this.decrypter.isSync()||this.decryptAvcSamples(e,s,r+1,n)}).catch(n)}decryptAvcSamples(e,s,r,n){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;s++,r=0){if(s>=e.length){n();return}const o=e[s].units;for(;!(r>=o.length);r++){const c=o[r];if(!(c.data.length<=48||c.type!==1&&c.type!==5)&&(this.decryptAvcSample(e,s,r,n,c),!this.decrypter.isSync()))return}}}}class x2{constructor(){this.VideoSample=null}createVideoSample(e,s,r){return{key:e,frame:!1,pts:s,dts:r,units:[],length:0}}getLastNalUnit(e){var s;let r=this.VideoSample,n;if((!r||r.units.length===0)&&(r=e[e.length-1]),(s=r)!=null&&s.units){const o=r.units;n=o[o.length-1]}return n}pushAccessUnit(e,s){if(e.units.length&&e.frame){if(e.pts===void 0){const r=s.samples,n=r.length;if(n){const o=r[n-1];e.pts=o.pts,e.dts=o.dts}else{s.dropped++;return}}s.samples.push(e)}}parseNALu(e,s,r){const n=s.byteLength;let o=e.naluState||0;const c=o,d=[];let f=0,u,m,g,x=-1,b=0;for(o===-1&&(x=0,b=this.getNALuType(s,0),o=0,f=1);f<n;){if(u=s[f++],!o){o=u?0:1;continue}if(o===1){o=u?0:2;continue}if(!u)o=3;else if(u===1){if(m=f-o-1,x>=0){const v={data:s.subarray(x,m),type:b};d.push(v)}else{const v=this.getLastNalUnit(e.samples);v&&(c&&f<=4-c&&v.state&&(v.data=v.data.subarray(0,v.data.byteLength-c)),m>0&&(v.data=Ha(v.data,s.subarray(0,m)),v.state=0))}f<n?(g=this.getNALuType(s,f),x=f,b=g,o=0):o=-1}else o=0}if(x>=0&&o>=0){const v={data:s.subarray(x,n),type:b,state:o};d.push(v)}if(d.length===0){const v=this.getLastNalUnit(e.samples);v&&(v.data=Ha(v.data,s))}return e.naluState=o,d}}class Id{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,s=this.bytesAvailable,r=e.byteLength-s,n=new Uint8Array(4),o=Math.min(4,s);if(o===0)throw new Error("no bytes available");n.set(e.subarray(r,r+o)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=o*8,this.bytesAvailable-=o}skipBits(e){let s;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,s=e>>3,e-=s<<3,this.bytesAvailable-=s,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let s=Math.min(this.bitsAvailable,e);const r=this.word>>>32-s;if(e>32&&Ms.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=s,this.bitsAvailable>0)this.word<<=s;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return s=e-s,s>0&&this.bitsAvailable?r<<s|this.readBits(s):r}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class yP extends x2{parsePES(e,s,r,n){const o=this.parseNALu(e,r.data,n);let c=this.VideoSample,d,f=!1;r.data=null,c&&o.length&&!e.audFound&&(this.pushAccessUnit(c,e),c=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),o.forEach(u=>{var m,g;switch(u.type){case 1:{let w=!1;d=!0;const S=u.data;if(f&&S.length>4){const T=this.readSliceType(S);(T===2||T===4||T===7||T===9)&&(w=!0)}if(w){var x;(x=c)!=null&&x.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null)}c||(c=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),c.frame=!0,c.key=w;break}case 5:d=!0,(m=c)!=null&&m.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null),c||(c=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),c.key=!0,c.frame=!0;break;case 6:{d=!0,Rx(u.data,1,r.pts,s.samples);break}case 7:{var b,v;d=!0,f=!0;const w=u.data,S=this.readSPS(w);if(!e.sps||e.width!==S.width||e.height!==S.height||((b=e.pixelRatio)==null?void 0:b[0])!==S.pixelRatio[0]||((v=e.pixelRatio)==null?void 0:v[1])!==S.pixelRatio[1]){e.width=S.width,e.height=S.height,e.pixelRatio=S.pixelRatio,e.sps=[w];const T=w.subarray(1,4);let k="avc1.";for(let E=0;E<3;E++){let R=T[E].toString(16);R.length<2&&(R="0"+R),k+=R}e.codec=k}break}case 8:d=!0,e.pps=[u.data];break;case 9:d=!0,e.audFound=!0,(g=c)!=null&&g.frame&&(this.pushAccessUnit(c,e),c=null),c||(c=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;case 12:d=!0;break;default:d=!1;break}c&&d&&c.units.push(u)}),n&&c&&(this.pushAccessUnit(c,e),this.VideoSample=null)}getNALuType(e,s){return e[s]&31}readSliceType(e){const s=new Id(e);return s.readUByte(),s.readUEG(),s.readUEG()}skipScalingList(e,s){let r=8,n=8,o;for(let c=0;c<e;c++)n!==0&&(o=s.readEG(),n=(r+o+256)%256),r=n===0?r:n}readSPS(e){const s=new Id(e);let r=0,n=0,o=0,c=0,d,f,u;const m=s.readUByte.bind(s),g=s.readBits.bind(s),x=s.readUEG.bind(s),b=s.readBoolean.bind(s),v=s.skipBits.bind(s),w=s.skipEG.bind(s),S=s.skipUEG.bind(s),T=this.skipScalingList.bind(this);m();const k=m();if(g(5),v(3),m(),S(),k===100||k===110||k===122||k===244||k===44||k===83||k===86||k===118||k===128){const O=x();if(O===3&&v(1),S(),S(),v(1),b())for(f=O!==3?8:12,u=0;u<f;u++)b()&&(u<6?T(16,s):T(64,s))}S();const E=x();if(E===0)x();else if(E===1)for(v(1),w(),w(),d=x(),u=0;u<d;u++)w();S(),v(1);const R=x(),K=x(),z=g(1);z===0&&v(1),v(1),b()&&(r=x(),n=x(),o=x(),c=x());let D=[1,1];if(b()&&b())switch(m()){case 1:D=[1,1];break;case 2:D=[12,11];break;case 3:D=[10,11];break;case 4:D=[16,11];break;case 5:D=[40,33];break;case 6:D=[24,11];break;case 7:D=[20,11];break;case 8:D=[32,11];break;case 9:D=[80,33];break;case 10:D=[18,11];break;case 11:D=[15,11];break;case 12:D=[64,33];break;case 13:D=[160,99];break;case 14:D=[4,3];break;case 15:D=[3,2];break;case 16:D=[2,1];break;case 255:{D=[m()<<8|m(),m()<<8|m()];break}}return{width:Math.ceil((R+1)*16-r*2-n*2),height:(2-z)*(K+1)*16-(z?2:4)*(o+c),pixelRatio:D}}}class bP extends x2{constructor(...e){super(...e),this.initVPS=null}parsePES(e,s,r,n){const o=this.parseNALu(e,r.data,n);let c=this.VideoSample,d,f=!1;r.data=null,c&&o.length&&!e.audFound&&(this.pushAccessUnit(c,e),c=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),o.forEach(u=>{var m,g;switch(u.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:c||(c=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),c.frame=!0,d=!0;break;case 16:case 17:case 18:case 21:if(d=!0,f){var x;(x=c)!=null&&x.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null)}c||(c=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),c.key=!0,c.frame=!0;break;case 19:case 20:d=!0,(m=c)!=null&&m.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null),c||(c=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),c.key=!0,c.frame=!0;break;case 39:d=!0,Rx(u.data,2,r.pts,s.samples);break;case 32:d=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=Us(e.params,this.readVPS(u.data)),this.initVPS=u.data),e.vps=[u.data];break;case 33:if(d=!0,f=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],u.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const b=this.readSPS(u.data);e.width=b.width,e.height=b.height,e.pixelRatio=b.pixelRatio,e.codec=b.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const v in b.params)e.params[v]=b.params[v]}this.pushParameterSet(e.sps,u.data,e.vps),c||(c=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),c.key=!0;break;case 34:if(d=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const b=this.readPPS(u.data);for(const v in b)e.params[v]=b[v]}this.pushParameterSet(e.pps,u.data,e.vps)}break;case 35:d=!0,e.audFound=!0,(g=c)!=null&&g.frame&&(this.pushAccessUnit(c,e),c=null),c||(c=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;default:d=!1;break}c&&d&&c.units.push(u)}),n&&c&&(this.pushAccessUnit(c,e),this.VideoSample=null)}pushParameterSet(e,s,r){(r&&r[0]===this.initVPS||!r&&!e.length)&&e.push(s)}getNALuType(e,s){return(e[s]&126)>>>1}ebsp2rbsp(e){const s=new Uint8Array(e.byteLength);let r=0;for(let n=0;n<e.byteLength;n++)n>=2&&e[n]===3&&e[n-1]===0&&e[n-2]===0||(s[r]=e[n],r++);return new Uint8Array(s.buffer,0,r)}pushAccessUnit(e,s){super.pushAccessUnit(e,s),this.initVPS&&(this.initVPS=null)}readVPS(e){const s=new Id(e);s.readUByte(),s.readUByte(),s.readBits(4),s.skipBits(2),s.readBits(6);const r=s.readBits(3),n=s.readBoolean();return{numTemporalLayers:r+1,temporalIdNested:n}}readSPS(e){const s=new Id(this.ebsp2rbsp(e));s.readUByte(),s.readUByte(),s.readBits(4);const r=s.readBits(3);s.readBoolean();const n=s.readBits(2),o=s.readBoolean(),c=s.readBits(5),d=s.readUByte(),f=s.readUByte(),u=s.readUByte(),m=s.readUByte(),g=s.readUByte(),x=s.readUByte(),b=s.readUByte(),v=s.readUByte(),w=s.readUByte(),S=s.readUByte(),T=s.readUByte(),k=[],E=[];for(let qe=0;qe<r;qe++)k.push(s.readBoolean()),E.push(s.readBoolean());if(r>0)for(let qe=r;qe<8;qe++)s.readBits(2);for(let qe=0;qe<r;qe++)k[qe]&&(s.readUByte(),s.readUByte(),s.readUByte(),s.readUByte(),s.readUByte(),s.readUByte(),s.readUByte(),s.readUByte(),s.readUByte(),s.readUByte(),s.readUByte()),E[qe]&&s.readUByte();s.readUEG();const R=s.readUEG();R==3&&s.skipBits(1);const K=s.readUEG(),z=s.readUEG(),D=s.readBoolean();let O=0,U=0,I=0,F=0;D&&(O+=s.readUEG(),U+=s.readUEG(),I+=s.readUEG(),F+=s.readUEG());const te=s.readUEG(),le=s.readUEG(),H=s.readUEG(),X=s.readBoolean();for(let qe=X?0:r;qe<=r;qe++)s.skipUEG(),s.skipUEG(),s.skipUEG();if(s.skipUEG(),s.skipUEG(),s.skipUEG(),s.skipUEG(),s.skipUEG(),s.skipUEG(),s.readBoolean()&&s.readBoolean())for(let dt=0;dt<4;dt++)for(let He=0;He<(dt===3?2:6);He++)if(!s.readBoolean())s.readUEG();else{const _e=Math.min(64,1<<4+(dt<<1));dt>1&&s.readEG();for(let ge=0;ge<_e;ge++)s.readEG()}s.readBoolean(),s.readBoolean(),s.readBoolean()&&(s.readUByte(),s.skipUEG(),s.skipUEG(),s.readBoolean());const ce=s.readUEG();let ee=0;for(let qe=0;qe<ce;qe++){let dt=!1;if(qe!==0&&(dt=s.readBoolean()),dt){qe===ce&&s.readUEG(),s.readBoolean(),s.readUEG();let He=0;for(let Ce=0;Ce<=ee;Ce++){const _e=s.readBoolean();let ge=!1;_e||(ge=s.readBoolean()),(_e||ge)&&He++}ee=He}else{const He=s.readUEG(),Ce=s.readUEG();ee=He+Ce;for(let _e=0;_e<He;_e++)s.readUEG(),s.readBoolean();for(let _e=0;_e<Ce;_e++)s.readUEG(),s.readBoolean()}}if(s.readBoolean()){const qe=s.readUEG();for(let dt=0;dt<qe;dt++){for(let He=0;He<H+4;He++)s.readBits(1);s.readBits(1)}}let V=0,G=1,Z=1,oe=!0,ye=1,je=0;s.readBoolean(),s.readBoolean();let xe=!1;if(s.readBoolean()){if(s.readBoolean()){const Ze=s.readUByte(),Me=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],nt=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];Ze>0&&Ze<16?(G=Me[Ze-1],Z=nt[Ze-1]):Ze===255&&(G=s.readBits(16),Z=s.readBits(16))}if(s.readBoolean()&&s.readBoolean(),s.readBoolean()&&(s.readBits(3),s.readBoolean(),s.readBoolean()&&(s.readUByte(),s.readUByte(),s.readUByte())),s.readBoolean()&&(s.readUEG(),s.readUEG()),s.readBoolean(),s.readBoolean(),s.readBoolean(),xe=s.readBoolean(),xe&&(s.skipUEG(),s.skipUEG(),s.skipUEG(),s.skipUEG()),s.readBoolean()&&(ye=s.readBits(32),je=s.readBits(32),s.readBoolean()&&s.readUEG(),s.readBoolean())){const nt=s.readBoolean(),ht=s.readBoolean();let Oe=!1;(nt||ht)&&(Oe=s.readBoolean(),Oe&&(s.readUByte(),s.readBits(5),s.readBoolean(),s.readBits(5)),s.readBits(4),s.readBits(4),Oe&&s.readBits(4),s.readBits(5),s.readBits(5),s.readBits(5));for(let tt=0;tt<=r;tt++){oe=s.readBoolean();const Ct=oe||s.readBoolean();let we=!1;Ct?s.readEG():we=s.readBoolean();const bt=we?1:s.readUEG()+1;if(nt)for(let ve=0;ve<bt;ve++)s.readUEG(),s.readUEG(),Oe&&(s.readUEG(),s.readUEG()),s.skipBits(1);if(ht)for(let ve=0;ve<bt;ve++)s.readUEG(),s.readUEG(),Oe&&(s.readUEG(),s.readUEG()),s.skipBits(1)}}s.readBoolean()&&(s.readBoolean(),s.readBoolean(),s.readBoolean(),V=s.readUEG())}let Pe=K,Re=z;if(D){let qe=1,dt=1;R===1?qe=dt=2:R==2&&(qe=2),Pe=K-qe*U-qe*O,Re=z-dt*F-dt*I}const Qe=n?["A","B","C"][n]:"",ot=d<<24|f<<16|u<<8|m;let ne=0;for(let qe=0;qe<32;qe++)ne=(ne|(ot>>qe&1)<<31-qe)>>>0;let ke=ne.toString(16);return c===1&&ke==="2"&&(ke="6"),{codecString:`hvc1.${Qe}${c}.${ke}.${o?"H":"L"}${T}.B0`,params:{general_tier_flag:o,general_profile_idc:c,general_profile_space:n,general_profile_compatibility_flags:[d,f,u,m],general_constraint_indicator_flags:[g,x,b,v,w,S],general_level_idc:T,bit_depth:te+8,bit_depth_luma_minus8:te,bit_depth_chroma_minus8:le,min_spatial_segmentation_idc:V,chroma_format_idc:R,frame_rate:{fixed:oe,fps:je/ye}},width:Pe,height:Re,pixelRatio:[G,Z]}}readPPS(e){const s=new Id(this.ebsp2rbsp(e));s.readUByte(),s.readUByte(),s.skipUEG(),s.skipUEG(),s.skipBits(2),s.skipBits(3),s.skipBits(2),s.skipUEG(),s.skipUEG(),s.skipEG(),s.skipBits(2),s.readBoolean()&&s.skipUEG(),s.skipEG(),s.skipEG(),s.skipBits(4);const n=s.readBoolean(),o=s.readBoolean();let c=1;return o&&n?c=0:o?c=3:n&&(c=2),{parallelismType:c}}matchSPS(e,s){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,s).substr(3)}}const Er=188;class Vi{constructor(e,s,r,n){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=s,this.typeSupported=r,this.logger=n,this.videoParser=null}static probe(e,s){const r=Vi.syncOffset(e);return r>0&&s.warn(`MPEG2-TS detected but first sync word found @ offset ${r}`),r!==-1}static syncOffset(e){const s=e.length;let r=Math.min(Er*5,s-Er)+1,n=0;for(;n<r;){let o=!1,c=-1,d=0;for(let f=n;f<s;f+=Er)if(e[f]===71&&(s-f===Er||e[f+Er]===71)){if(d++,c===-1&&(c=f,c!==0&&(r=Math.min(c+Er*99,e.length-Er)+1)),o||(o=Vp(e,f)===0),o&&d>1&&(c===0&&d>2||f+Er>r))return c}else{if(d)return-1;break}n++}return-1}static createTrack(e,s){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:_j[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?s:void 0}}resetInitSegment(e,s,r,n){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Vi.createTrack("video"),this._videoTrack.duration=n,this._audioTrack=Vi.createTrack("audio",n),this._id3Track=Vi.createTrack("id3"),this._txtTrack=Vi.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=s,this.videoCodec=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:s,_id3Track:r}=this;e&&(e.pesData=null),s&&(s.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,s,r=!1,n=!1){r||(this.sampleAes=null);let o;const c=this._videoTrack,d=this._audioTrack,f=this._id3Track,u=this._txtTrack;let m=c.pid,g=c.pesData,x=d.pid,b=f.pid,v=d.pesData,w=f.pesData,S=null,T=this.pmtParsed,k=this._pmtId,E=e.length;if(this.remainderData&&(e=Ha(this.remainderData,e),E=e.length,this.remainderData=null),E<Er&&!n)return this.remainderData=e,{audioTrack:d,videoTrack:c,id3Track:f,textTrack:u};const R=Math.max(0,Vi.syncOffset(e));E-=(E-R)%Er,E<e.byteLength&&!n&&(this.remainderData=new Uint8Array(e.buffer,E,e.buffer.byteLength-E));let K=0;for(let D=R;D<E;D+=Er)if(e[D]===71){const O=!!(e[D+1]&64),U=Vp(e,D),I=(e[D+3]&48)>>4;let F;if(I>1){if(F=D+5+e[D+4],F===D+Er)continue}else F=D+4;switch(U){case m:O&&(g&&(o=ql(g,this.logger))&&(this.readyVideoParser(c.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(c,u,o,!1)),g={data:[],size:0}),g&&(g.data.push(e.subarray(F,D+Er)),g.size+=D+Er-F);break;case x:if(O){if(v&&(o=ql(v,this.logger)))switch(d.segmentCodec){case"aac":this.parseAACPES(d,o);break;case"mp3":this.parseMPEGPES(d,o);break;case"ac3":this.parseAC3PES(d,o);break}v={data:[],size:0}}v&&(v.data.push(e.subarray(F,D+Er)),v.size+=D+Er-F);break;case b:O&&(w&&(o=ql(w,this.logger))&&this.parseID3PES(f,o),w={data:[],size:0}),w&&(w.data.push(e.subarray(F,D+Er)),w.size+=D+Er-F);break;case 0:O&&(F+=e[F]+1),k=this._pmtId=vP(e,F);break;case k:{O&&(F+=e[F]+1);const te=wP(e,F,this.typeSupported,r,this.observer,this.logger);m=te.videoPid,m>0&&(c.pid=m,c.segmentCodec=te.segmentVideoCodec),x=te.audioPid,x>0&&(d.pid=x,d.segmentCodec=te.segmentAudioCodec),b=te.id3Pid,b>0&&(f.pid=b),S!==null&&!T&&(this.logger.warn(`MPEG-TS PMT found at ${D} after unknown PID '${S}'. Backtracking to sync byte @${R} to parse all TS packets.`),S=null,D=R-188),T=this.pmtParsed=!0;break}case 17:case 8191:break;default:S=U;break}}else K++;K>0&&zp(this.observer,new Error(`Found ${K} TS packet/s that do not start with 0x47`),void 0,this.logger),c.pesData=g,d.pesData=v,f.pesData=w;const z={audioTrack:d,videoTrack:c,id3Track:f,textTrack:u};return n&&this.extractRemainingSamples(z),z}flush(){const{remainderData:e}=this;this.remainderData=null;let s;return e?s=this.demux(e,-1,!1,!0):s={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(s),this.sampleAes?this.decrypt(s,this.sampleAes):s}extractRemainingSamples(e){const{audioTrack:s,videoTrack:r,id3Track:n,textTrack:o}=e,c=r.pesData,d=s.pesData,f=n.pesData;let u;if(c&&(u=ql(c,this.logger))?(this.readyVideoParser(r.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(r,o,u,!0),r.pesData=null)):r.pesData=c,d&&(u=ql(d,this.logger))){switch(s.segmentCodec){case"aac":this.parseAACPES(s,u);break;case"mp3":this.parseMPEGPES(s,u);break;case"ac3":this.parseAC3PES(s,u);break}s.pesData=null}else d!=null&&d.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),s.pesData=d;f&&(u=ql(f,this.logger))?(this.parseID3PES(n,u),n.pesData=null):n.pesData=f}demuxSampleAes(e,s,r){const n=this.demux(e,r,!0,!this.config.progressive),o=this.sampleAes=new xP(this.observer,this.config,s);return this.decrypt(n,o)}readyVideoParser(e){this.videoParser===null&&(e==="avc"?this.videoParser=new yP:e==="hevc"&&(this.videoParser=new bP))}decrypt(e,s){return new Promise(r=>{const{audioTrack:n,videoTrack:o}=e;n.samples&&n.segmentCodec==="aac"?s.decryptAacSamples(n.samples,0,()=>{o.samples?s.decryptAvcSamples(o.samples,0,0,()=>{r(e)}):r(e)}):o.samples&&s.decryptAvcSamples(o.samples,0,0,()=>{r(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,s){let r=0;const n=this.aacOverFlow;let o=s.data;if(n){this.aacOverFlow=null;const g=n.missing,x=n.sample.unit.byteLength;if(g===-1)o=Ha(n.sample.unit,o);else{const b=x-g;n.sample.unit.set(o.subarray(0,g),b),e.samples.push(n.sample),r=n.missing}}let c,d;for(c=r,d=o.length;c<d-1&&!Lf(o,c);c++);if(c!==r){let g;const x=c<d-1;if(x?g=`AAC PES did not start with ADTS header,offset:${c}`:g="No ADTS header found in AAC PES",zp(this.observer,new Error(g),x,this.logger),!x)return}i2(e,this.observer,o,c,this.audioCodec);let f;if(s.pts!==void 0)f=s.pts;else if(n){const g=o2(e.samplerate);f=n.sample.pts+g}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let u=0,m;for(;c<d;)if(m=l2(e,o,c,f,u),c+=m.length,m.missing){this.aacOverFlow=m;break}else for(u++;c<d-1&&!Lf(o,c);c++);}parseMPEGPES(e,s){const r=s.data,n=r.length;let o=0,c=0;const d=s.pts;if(d===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;c<n;)if(f2(r,c)){const f=u2(e,r,c,d,o);if(f)c+=f.length,o++;else break}else c++}parseAC3PES(e,s){{const r=s.data,n=s.pts;if(n===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const o=r.length;let c=0,d=0,f;for(;d<o&&(f=p2(e,r,d,n,c++))>0;)d+=f}}parseID3PES(e,s){if(s.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const r=Us({},s,{type:this._videoTrack?_a.emsg:_a.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}}function Vp(a,e){return((a[e+1]&31)<<8)+a[e+2]}function vP(a,e){return(a[e+10]&31)<<8|a[e+11]}function wP(a,e,s,r,n,o){const c={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},d=(a[e+1]&15)<<8|a[e+2],f=e+3+d-4,u=(a[e+10]&15)<<8|a[e+11];for(e+=12+u;e<f;){const m=Vp(a,e),g=(a[e+3]&15)<<8|a[e+4];switch(a[e]){case 207:if(!r){Pg("ADTS AAC",o);break}case 15:c.audioPid===-1&&(c.audioPid=m);break;case 21:c.id3Pid===-1&&(c.id3Pid=m);break;case 219:if(!r){Pg("H.264",o);break}case 27:c.videoPid===-1&&(c.videoPid=m);break;case 3:case 4:!s.mpeg&&!s.mp3?o.log("MPEG audio found, not supported in this browser"):c.audioPid===-1&&(c.audioPid=m,c.segmentAudioCodec="mp3");break;case 193:if(!r){Pg("AC-3",o);break}case 129:s.ac3?c.audioPid===-1&&(c.audioPid=m,c.segmentAudioCodec="ac3"):o.log("AC-3 audio found, not supported in this browser");break;case 6:if(c.audioPid===-1&&g>0){let x=e+5,b=g;for(;b>2;){switch(a[x]){case 106:s.ac3!==!0?o.log("AC-3 audio found, not supported in this browser for now"):(c.audioPid=m,c.segmentAudioCodec="ac3");break}const w=a[x+1]+2;x+=w,b-=w}}break;case 194:case 135:return zp(n,new Error("Unsupported EC-3 in M2TS found"),void 0,o),c;case 36:c.videoPid===-1&&(c.videoPid=m,c.segmentVideoCodec="hevc",o.log("HEVC in M2TS found"));break}e+=g+5}return c}function zp(a,e,s,r){r.warn(`parsing error: ${e.message}`),a.emit(Q.ERROR,Q.ERROR,{type:Ft.MEDIA_ERROR,details:ze.FRAG_PARSING_ERROR,fatal:!1,levelRetry:s,error:e,reason:e.message})}function Pg(a,e){e.log(`${a} with AES-128-CBC encryption found in unencrypted stream`)}function ql(a,e){let s=0,r,n,o,c,d;const f=a.data;if(!a||a.size===0)return null;for(;f[0].length<19&&f.length>1;)f[0]=Ha(f[0],f[1]),f.splice(1,1);if(r=f[0],(r[0]<<16)+(r[1]<<8)+r[2]===1){if(n=(r[4]<<8)+r[5],n&&n>a.size-6)return null;const m=r[7];m&192&&(c=(r[9]&14)*536870912+(r[10]&255)*4194304+(r[11]&254)*16384+(r[12]&255)*128+(r[13]&254)/2,m&64?(d=(r[14]&14)*536870912+(r[15]&255)*4194304+(r[16]&254)*16384+(r[17]&255)*128+(r[18]&254)/2,c-d>60*9e4&&(e.warn(`${Math.round((c-d)/9e4)}s delta between PTS and DTS, align them`),c=d)):d=c),o=r[8];let g=o+9;if(a.size<=g)return null;a.size-=g;const x=new Uint8Array(a.size);for(let b=0,v=f.length;b<v;b++){r=f[b];let w=r.byteLength;if(g)if(g>w){g-=w;continue}else r=r.subarray(g),w-=g,g=0;x.set(r,s),s+=w}return n&&(n-=o+3),{data:x,pts:c,dts:d,len:n}}return null}class SP{static getSilentFrame(e,s){switch(e){case"mp4a.40.2":if(s===1)return new Uint8Array([0,200,0,128,35,128]);if(s===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(s===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(s===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(s===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(s===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(s===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(s===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(s===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Ui=Math.pow(2,32)-1;class Ve{static init(){Ve.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in Ve.types)Ve.types.hasOwnProperty(e)&&(Ve.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const s=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Ve.HDLR_TYPES={video:s,audio:r};const n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);Ve.STTS=Ve.STSC=Ve.STCO=o,Ve.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Ve.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Ve.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Ve.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const c=new Uint8Array([105,115,111,109]),d=new Uint8Array([97,118,99,49]),f=new Uint8Array([0,0,0,1]);Ve.FTYP=Ve.box(Ve.types.ftyp,c,f,c,d),Ve.DINF=Ve.box(Ve.types.dinf,Ve.box(Ve.types.dref,n))}static box(e,...s){let r=8,n=s.length;const o=n;for(;n--;)r+=s[n].byteLength;const c=new Uint8Array(r);for(c[0]=r>>24&255,c[1]=r>>16&255,c[2]=r>>8&255,c[3]=r&255,c.set(e,4),n=0,r=8;n<o;n++)c.set(s[n],r),r+=s[n].byteLength;return c}static hdlr(e){return Ve.box(Ve.types.hdlr,Ve.HDLR_TYPES[e])}static mdat(e){return Ve.box(Ve.types.mdat,e)}static mdhd(e,s){s*=e;const r=Math.floor(s/(Ui+1)),n=Math.floor(s%(Ui+1));return Ve.box(Ve.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,n>>24,n>>16&255,n>>8&255,n&255,85,196,0,0]))}static mdia(e){return Ve.box(Ve.types.mdia,Ve.mdhd(e.timescale||0,e.duration||0),Ve.hdlr(e.type),Ve.minf(e))}static mfhd(e){return Ve.box(Ve.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?Ve.box(Ve.types.minf,Ve.box(Ve.types.smhd,Ve.SMHD),Ve.DINF,Ve.stbl(e)):Ve.box(Ve.types.minf,Ve.box(Ve.types.vmhd,Ve.VMHD),Ve.DINF,Ve.stbl(e))}static moof(e,s,r){return Ve.box(Ve.types.moof,Ve.mfhd(e),Ve.traf(r,s))}static moov(e){let s=e.length;const r=[];for(;s--;)r[s]=Ve.trak(e[s]);return Ve.box.apply(null,[Ve.types.moov,Ve.mvhd(e[0].timescale||0,e[0].duration||0)].concat(r).concat(Ve.mvex(e)))}static mvex(e){let s=e.length;const r=[];for(;s--;)r[s]=Ve.trex(e[s]);return Ve.box.apply(null,[Ve.types.mvex,...r])}static mvhd(e,s){s*=e;const r=Math.floor(s/(Ui+1)),n=Math.floor(s%(Ui+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,n>>24,n>>16&255,n>>8&255,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Ve.box(Ve.types.mvhd,o)}static sdtp(e){const s=e.samples||[],r=new Uint8Array(4+s.length);let n,o;for(n=0;n<s.length;n++)o=s[n].flags,r[n+4]=o.dependsOn<<4|o.isDependedOn<<2|o.hasRedundancy;return Ve.box(Ve.types.sdtp,r)}static stbl(e){return Ve.box(Ve.types.stbl,Ve.stsd(e),Ve.box(Ve.types.stts,Ve.STTS),Ve.box(Ve.types.stsc,Ve.STSC),Ve.box(Ve.types.stsz,Ve.STSZ),Ve.box(Ve.types.stco,Ve.STCO))}static avc1(e){let s=[],r=[],n,o,c;for(n=0;n<e.sps.length;n++)o=e.sps[n],c=o.byteLength,s.push(c>>>8&255),s.push(c&255),s=s.concat(Array.prototype.slice.call(o));for(n=0;n<e.pps.length;n++)o=e.pps[n],c=o.byteLength,r.push(c>>>8&255),r.push(c&255),r=r.concat(Array.prototype.slice.call(o));const d=Ve.box(Ve.types.avcC,new Uint8Array([1,s[3],s[4],s[5],255,224|e.sps.length].concat(s).concat([e.pps.length]).concat(r))),f=e.width,u=e.height,m=e.pixelRatio[0],g=e.pixelRatio[1];return Ve.box(Ve.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,f>>8&255,f&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),d,Ve.box(Ve.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Ve.box(Ve.types.pasp,new Uint8Array([m>>24,m>>16&255,m>>8&255,m&255,g>>24,g>>16&255,g>>8&255,g&255])))}static esds(e){const s=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...s,6,1,2])}static audioStsd(e){const s=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,s>>8&255,s&255,0,0])}static mp4a(e){return Ve.box(Ve.types.mp4a,Ve.audioStsd(e),Ve.box(Ve.types.esds,Ve.esds(e)))}static mp3(e){return Ve.box(Ve.types[".mp3"],Ve.audioStsd(e))}static ac3(e){return Ve.box(Ve.types["ac-3"],Ve.audioStsd(e),Ve.box(Ve.types.dac3,e.config))}static stsd(e){const{segmentCodec:s}=e;if(e.type==="audio"){if(s==="aac")return Ve.box(Ve.types.stsd,Ve.STSD,Ve.mp4a(e));if(s==="ac3"&&e.config)return Ve.box(Ve.types.stsd,Ve.STSD,Ve.ac3(e));if(s==="mp3"&&e.codec==="mp3")return Ve.box(Ve.types.stsd,Ve.STSD,Ve.mp3(e))}else if(e.pps&&e.sps){if(s==="avc")return Ve.box(Ve.types.stsd,Ve.STSD,Ve.avc1(e));if(s==="hevc"&&e.vps)return Ve.box(Ve.types.stsd,Ve.STSD,Ve.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${s}/${e.codec})`)}static tkhd(e){const s=e.id,r=(e.duration||0)*(e.timescale||0),n=e.width||0,o=e.height||0,c=Math.floor(r/(Ui+1)),d=Math.floor(r%(Ui+1));return Ve.box(Ve.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,s>>24&255,s>>16&255,s>>8&255,s&255,0,0,0,0,c>>24,c>>16&255,c>>8&255,c&255,d>>24,d>>16&255,d>>8&255,d&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,n&255,0,0,o>>8&255,o&255,0,0]))}static traf(e,s){const r=Ve.sdtp(e),n=e.id,o=Math.floor(s/(Ui+1)),c=Math.floor(s%(Ui+1));return Ve.box(Ve.types.traf,Ve.box(Ve.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255])),Ve.box(Ve.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,c>>24,c>>16&255,c>>8&255,c&255])),Ve.trun(e,r.length+16+20+8+16+8+8),r)}static trak(e){return e.duration=e.duration||4294967295,Ve.box(Ve.types.trak,Ve.tkhd(e),Ve.mdia(e))}static trex(e){const s=e.id;return Ve.box(Ve.types.trex,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,s){const r=e.samples||[],n=r.length,o=12+16*n,c=new Uint8Array(o);let d,f,u,m,g,x;for(s+=8+o,c.set([e.type==="video"?1:0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,n&255,s>>>24&255,s>>>16&255,s>>>8&255,s&255],0),d=0;d<n;d++)f=r[d],u=f.duration,m=f.size,g=f.flags,x=f.cts,c.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,m>>>24&255,m>>>16&255,m>>>8&255,m&255,g.isLeading<<2|g.dependsOn,g.isDependedOn<<6|g.hasRedundancy<<4|g.paddingValue<<1|g.isNonSync,g.degradPrio&61440,g.degradPrio&15,x>>>24&255,x>>>16&255,x>>>8&255,x&255],12+16*d);return Ve.box(Ve.types.trun,c)}static initSegment(e){Ve.types||Ve.init();const s=Ve.moov(e);return Ha(Ve.FTYP,s)}static hvc1(e){const s=e.params,r=[e.vps,e.sps,e.pps],n=4,o=new Uint8Array([1,s.general_profile_space<<6|(s.general_tier_flag?32:0)|s.general_profile_idc,s.general_profile_compatibility_flags[0],s.general_profile_compatibility_flags[1],s.general_profile_compatibility_flags[2],s.general_profile_compatibility_flags[3],s.general_constraint_indicator_flags[0],s.general_constraint_indicator_flags[1],s.general_constraint_indicator_flags[2],s.general_constraint_indicator_flags[3],s.general_constraint_indicator_flags[4],s.general_constraint_indicator_flags[5],s.general_level_idc,240|s.min_spatial_segmentation_idc>>8,255&s.min_spatial_segmentation_idc,252|s.parallelismType,252|s.chroma_format_idc,248|s.bit_depth_luma_minus8,248|s.bit_depth_chroma_minus8,0,parseInt(s.frame_rate.fps),n-1|s.temporal_id_nested<<2|s.num_temporal_layers<<3|(s.frame_rate.fixed?64:0),r.length]);let c=o.length;for(let v=0;v<r.length;v+=1){c+=3;for(let w=0;w<r[v].length;w+=1)c+=2+r[v][w].length}const d=new Uint8Array(c);d.set(o,0),c=o.length;const f=r.length-1;for(let v=0;v<r.length;v+=1){d.set(new Uint8Array([32+v|(v===f?128:0),0,r[v].length]),c),c+=3;for(let w=0;w<r[v].length;w+=1)d.set(new Uint8Array([r[v][w].length>>8,r[v][w].length&255]),c),c+=2,d.set(r[v][w],c),c+=r[v][w].length}const u=Ve.box(Ve.types.hvcC,d),m=e.width,g=e.height,x=e.pixelRatio[0],b=e.pixelRatio[1];return Ve.box(Ve.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,m>>8&255,m&255,g>>8&255,g&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,Ve.box(Ve.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Ve.box(Ve.types.pasp,new Uint8Array([x>>24,x>>16&255,x>>8&255,x&255,b>>24,b>>16&255,b>>8&255,b&255])))}}Ve.types=void 0;Ve.HDLR_TYPES=void 0;Ve.STTS=void 0;Ve.STSC=void 0;Ve.STCO=void 0;Ve.STSZ=void 0;Ve.VMHD=void 0;Ve.SMHD=void 0;Ve.STSD=void 0;Ve.FTYP=void 0;Ve.DINF=void 0;const y2=9e4;function qx(a,e,s=1,r=!1){const n=a*e*s;return r?Math.round(n):n}function _P(a,e,s=1,r=!1){return qx(a,e,1/s,r)}function vd(a,e=!1){return qx(a,1e3,1/y2,e)}function NP(a,e=1){return qx(a,y2,1/e)}function H1(a){const{baseTime:e,timescale:s,trackId:r}=a;return`${e/s} (${e}/${s}) trackId: ${r}`}const jP=10*1e3,EP=1024,TP=1152,AP=1536;let Kl=null,Og=null;function V1(a,e,s,r){return{duration:e,size:s,cts:r,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:a?2:1,isNonSync:a?0:1}}}class lf extends qa{constructor(e,s,r,n){if(super("mp4-remuxer",n),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=s,this.typeSupported=r,this.ISGenerated=!1,Kl===null){const c=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Kl=c?parseInt(c[1]):0}if(Og===null){const o=navigator.userAgent.match(/Safari\/(\d+)/i);Og=o?parseInt(o[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){const s=this._initPTS;(!s||!e||e.trackId!==s.trackId||e.baseTime!==s.baseTime||e.timescale!==s.timescale)&&this.log(`Reset initPTS: ${s&&H1(s)} > ${e&&H1(e)}`),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let s=!1;const r=e[0].pts,n=e.reduce((o,c)=>{let d=c.pts,f=d-o;return f<-4294967296&&(s=!0,d=Sa(d,r),f=d-o),f>0?o:d},r);return s&&this.debug("PTS rollover detected"),n}remux(e,s,r,n,o,c,d,f){let u,m,g,x,b,v,w=o,S=o;const T=e.pid>-1,k=s.pid>-1,E=s.samples.length,R=e.samples.length>0,K=d&&E>0||E>1;if((!T||R)&&(!k||K)||this.ISGenerated||d){if(this.ISGenerated){var D,O,U,I;const H=this.videoTrackConfig;(H&&(s.width!==H.width||s.height!==H.height||((D=s.pixelRatio)==null?void 0:D[0])!==((O=H.pixelRatio)==null?void 0:O[0])||((U=s.pixelRatio)==null?void 0:U[1])!==((I=H.pixelRatio)==null?void 0:I[1]))||!H&&K||this.nextAudioTs===null&&R)&&this.resetInitSegment()}this.ISGenerated||(g=this.generateIS(e,s,o,c));const F=this.isVideoContiguous;let te=-1,le;if(K&&(te=CP(s.samples),!F&&this.config.forceKeyFrameOnDiscontinuity))if(v=!0,te>0){this.warn(`Dropped ${te} out of ${E} video samples due to a missing keyframe`);const H=this.getVideoStartPts(s.samples);s.samples=s.samples.slice(te),s.dropped+=te,S+=(s.samples[0].pts-H)/s.inputTimeScale,le=S}else te===-1&&(this.warn(`No keyframe found out of ${E} video samples`),v=!1);if(this.ISGenerated){if(R&&K){const H=this.getVideoStartPts(s.samples),q=(Sa(e.samples[0].pts,H)-H)/s.inputTimeScale;w+=Math.max(0,q),S+=Math.max(0,-q)}if(R){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),g=this.generateIS(e,s,o,c)),m=this.remuxAudio(e,w,this.isAudioContiguous,c,k||K||f===Rt.AUDIO?S:void 0),K){const H=m?m.endPTS-m.startPTS:0;s.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),g=this.generateIS(e,s,o,c)),u=this.remuxVideo(s,S,F,H)}}else K&&(u=this.remuxVideo(s,S,F,0));u&&(u.firstKeyFrame=te,u.independent=te!==-1,u.firstKeyFramePTS=le)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(b=b2(r,o,this._initPTS,this._initDTS)),n.samples.length&&(x=v2(n,o,this._initPTS))),{audio:m,video:u,initSegment:g,independent:v,text:x,id3:b}}computeInitPts(e,s,r,n){const o=Math.round(r*s);let c=Sa(e,o);if(c<o+s)for(this.log(`Adjusting PTS for rollover in timeline near ${(o-c)/s} ${n}`);c<o+s;)c+=8589934592;return c-o}generateIS(e,s,r,n){const o=e.samples,c=s.samples,d=this.typeSupported,f={},u=this._initPTS;let m=!u||n,g="audio/mp4",x,b,v,w=-1;if(m&&(x=b=1/0),e.config&&o.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":d.mpeg?(g="audio/mpeg",e.codec=""):d.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}f.audio={id:"audio",container:g,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&d.mpeg?new Uint8Array(0):Ve.initSegment([e]),metadata:{channelCount:e.channelCount}},m&&(w=e.id,v=e.inputTimeScale,!u||v!==u.timescale?x=b=this.computeInitPts(o[0].pts,v,r,"audio"):m=!1)}if(s.sps&&s.pps&&c.length){if(s.timescale=s.inputTimeScale,f.video={id:"main",container:"video/mp4",codec:s.codec,initSegment:Ve.initSegment([s]),metadata:{width:s.width,height:s.height}},m)if(w=s.id,v=s.inputTimeScale,!u||v!==u.timescale){const S=this.getVideoStartPts(c),T=Sa(c[0].dts,S),k=this.computeInitPts(T,v,r,"video"),E=this.computeInitPts(S,v,r,"video");b=Math.min(b,k),x=Math.min(x,E)}else m=!1;this.videoTrackConfig={width:s.width,height:s.height,pixelRatio:s.pixelRatio}}if(Object.keys(f).length)return this.ISGenerated=!0,m?(u&&this.warn(`Timestamps at playlist time: ${n?"":"~"}${r} ${x/v} != initPTS: ${u.baseTime/u.timescale} (${u.baseTime}/${u.timescale}) trackId: ${u.trackId}`),this.log(`Found initPTS at playlist time: ${r} offset: ${x/v} (${x}/${v}) trackId: ${w}`),this._initPTS={baseTime:x,timescale:v,trackId:w},this._initDTS={baseTime:b,timescale:v,trackId:w}):x=v=void 0,{tracks:f,initPTS:x,timescale:v,trackId:w}}remuxVideo(e,s,r,n){const o=e.inputTimeScale,c=e.samples,d=[],f=c.length,u=this._initPTS,m=u.baseTime*o/u.timescale;let g=this.nextVideoTs,x=8,b=this.videoSampleDuration,v,w,S=Number.POSITIVE_INFINITY,T=Number.NEGATIVE_INFINITY,k=!1;if(!r||g===null){const V=m+s*o,G=c[0].pts-Sa(c[0].dts,c[0].pts);Kl&&g!==null&&Math.abs(V-G-(g+m))<15e3?r=!0:g=V-G-m}const E=g+m;for(let V=0;V<f;V++){const G=c[V];G.pts=Sa(G.pts,E),G.dts=Sa(G.dts,E),G.dts<c[V>0?V-1:V].dts&&(k=!0)}k&&c.sort(function(V,G){const Z=V.dts-G.dts,oe=V.pts-G.pts;return Z||oe}),v=c[0].dts,w=c[c.length-1].dts;const R=w-v,K=R?Math.round(R/(f-1)):b||e.inputTimeScale/30;if(r){const V=v-E,G=V>K,Z=V<-1;if((G||Z)&&(G?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${vd(V,!0)} ms (${V}dts) hole between fragments detected at ${s.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${vd(-V,!0)} ms (${V}dts) overlapping between fragments detected at ${s.toFixed(3)}`),!Z||E>=c[0].pts||Kl)){v=E;const oe=c[0].pts-V;if(G)c[0].dts=v,c[0].pts=oe;else{let ye=!0;for(let je=0;je<c.length&&!(c[je].dts>oe&&ye);je++){const xe=c[je].pts;if(c[je].dts-=V,c[je].pts-=V,je<c.length-1){const Ee=c[je+1].pts,Pe=c[je].pts,Re=Ee<=Pe,Qe=Ee<=xe;ye=Re==Qe}}}this.log(`Video: Initial PTS/DTS adjusted: ${vd(oe,!0)}/${vd(v,!0)}, delta: ${vd(V,!0)} ms`)}}v=Math.max(0,v);let z=0,D=0,O=v;for(let V=0;V<f;V++){const G=c[V],Z=G.units,oe=Z.length;let ye=0;for(let je=0;je<oe;je++)ye+=Z[je].data.length;D+=ye,z+=oe,G.length=ye,G.dts<O?(G.dts=O,O+=K/4|0||1):O=G.dts,S=Math.min(G.pts,S),T=Math.max(G.pts,T)}w=c[f-1].dts;const U=D+4*z+8;let I;try{I=new Uint8Array(U)}catch(V){this.observer.emit(Q.ERROR,Q.ERROR,{type:Ft.MUX_ERROR,details:ze.REMUX_ALLOC_ERROR,fatal:!1,error:V,bytes:U,reason:`fail allocating video mdat ${U}`});return}const F=new DataView(I.buffer);F.setUint32(0,U),I.set(Ve.types.mdat,4);let te=!1,le=Number.POSITIVE_INFINITY,H=Number.POSITIVE_INFINITY,X=Number.NEGATIVE_INFINITY,q=Number.NEGATIVE_INFINITY;for(let V=0;V<f;V++){const G=c[V],Z=G.units;let oe=0;for(let xe=0,Ee=Z.length;xe<Ee;xe++){const Pe=Z[xe],Re=Pe.data,Qe=Pe.data.byteLength;F.setUint32(x,Qe),x+=4,I.set(Re,x),x+=Qe,oe+=4+Qe}let ye;if(V<f-1)b=c[V+1].dts-G.dts,ye=c[V+1].pts-G.pts;else{const xe=this.config,Ee=V>0?G.dts-c[V-1].dts:K;if(ye=V>0?G.pts-c[V-1].pts:K,xe.stretchShortVideoTrack&&this.nextAudioTs!==null){const Pe=Math.floor(xe.maxBufferHole*o),Re=(n?S+n*o:this.nextAudioTs+m)-G.pts;Re>Pe?(b=Re-Ee,b<0?b=Ee:te=!0,this.log(`It is approximately ${Re/90} ms to the next segment; using duration ${b/90} ms for the last video frame.`)):b=Ee}else b=Ee}const je=Math.round(G.pts-G.dts);le=Math.min(le,b),X=Math.max(X,b),H=Math.min(H,ye),q=Math.max(q,ye),d.push(V1(G.key,b,oe,je))}if(d.length){if(Kl){if(Kl<70){const V=d[0].flags;V.dependsOn=2,V.isNonSync=0}}else if(Og&&q-H<X-le&&K/X<.025&&d[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let V=v;for(let G=0,Z=d.length;G<Z;G++){const oe=V+d[G].duration,ye=V+d[G].cts;if(G<Z-1){const je=oe+d[G+1].cts;d[G].duration=je-ye}else d[G].duration=G?d[G-1].duration:K;d[G].cts=0,V=oe}}}b=te||!b?K:b;const ae=w+b;this.nextVideoTs=g=ae-m,this.videoSampleDuration=b,this.isVideoContiguous=!0;const W={data1:Ve.moof(e.sequenceNumber++,v,Us(e,{samples:d})),data2:I,startPTS:(S-m)/o,endPTS:(T+b-m)/o,startDTS:(v-m)/o,endDTS:g/o,type:"video",hasAudio:!1,hasVideo:!0,nb:d.length,dropped:e.dropped};return e.samples=[],e.dropped=0,W}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return TP;case"ac3":return AP;default:return EP}}remuxAudio(e,s,r,n,o){const c=e.inputTimeScale,d=e.samplerate?e.samplerate:c,f=c/d,u=this.getSamplesPerFrame(e),m=u*f,g=this._initPTS,x=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,b=[],v=o!==void 0;let w=e.samples,S=x?0:8,T=this.nextAudioTs||-1;const k=g.baseTime*c/g.timescale,E=k+s*c;if(this.isAudioContiguous=r=r||w.length&&T>0&&(n&&Math.abs(E-(T+k))<9e3||Math.abs(Sa(w[0].pts,E)-(T+k))<20*m),w.forEach(function(q){q.pts=Sa(q.pts,E)}),!r||T<0){const q=w.length;if(w=w.filter(ae=>ae.pts>=0),q!==w.length&&this.warn(`Removed ${w.length-q} of ${q} samples (initPTS ${k} / ${c})`),!w.length)return;o===0?T=0:n&&!v?T=Math.max(0,E-k):T=w[0].pts-k}if(e.segmentCodec==="aac"){const q=this.config.maxAudioFramesDrift;for(let ae=0,ce=T+k;ae<w.length;ae++){const ee=w[ae],W=ee.pts,V=W-ce,G=Math.abs(1e3*V/c);if(V<=-q*m&&v)ae===0&&(this.warn(`Audio frame @ ${(W/c).toFixed(3)}s overlaps marker by ${Math.round(1e3*V/c)} ms.`),this.nextAudioTs=T=W-k,ce=W);else if(V>=q*m&&G<jP&&v){let Z=Math.round(V/m);for(ce=W-Z*m;ce<0&&Z&&m;)Z--,ce+=m;ae===0&&(this.nextAudioTs=T=ce-k),this.warn(`Injecting ${Z} audio frames @ ${((ce-k)/c).toFixed(3)}s due to ${Math.round(1e3*V/c)} ms gap.`);for(let oe=0;oe<Z;oe++){let ye=SP.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);ye||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),ye=ee.unit.subarray()),w.splice(ae,0,{unit:ye,pts:ce}),ce+=m,ae++}}ee.pts=ce,ce+=m}}let R=null,K=null,z,D=0,O=w.length;for(;O--;)D+=w[O].unit.byteLength;for(let q=0,ae=w.length;q<ae;q++){const ce=w[q],ee=ce.unit;let W=ce.pts;if(K!==null){const G=b[q-1];G.duration=Math.round((W-K)/f)}else if(r&&e.segmentCodec==="aac"&&(W=T+k),R=W,D>0){D+=S;try{z=new Uint8Array(D)}catch(G){this.observer.emit(Q.ERROR,Q.ERROR,{type:Ft.MUX_ERROR,details:ze.REMUX_ALLOC_ERROR,fatal:!1,error:G,bytes:D,reason:`fail allocating audio mdat ${D}`});return}x||(new DataView(z.buffer).setUint32(0,D),z.set(Ve.types.mdat,4))}else return;z.set(ee,S);const V=ee.byteLength;S+=V,b.push(V1(!0,u,V,0)),K=W}const U=b.length;if(!U)return;const I=b[b.length-1];T=K-k,this.nextAudioTs=T+f*I.duration;const F=x?new Uint8Array(0):Ve.moof(e.sequenceNumber++,R/f,Us({},e,{samples:b}));e.samples=[];const te=(R-k)/c,le=this.nextAudioTs/c,X={data1:F,data2:z,startPTS:te,endPTS:le,startDTS:te,endDTS:le,type:"audio",hasAudio:!0,hasVideo:!1,nb:U};return this.isAudioContiguous=!0,X}}function Sa(a,e){let s;if(e===null)return a;for(e<a?s=-8589934592:s=8589934592;Math.abs(a-e)>4294967296;)a+=s;return a}function CP(a){for(let e=0;e<a.length;e++)if(a[e].key)return e;return-1}function b2(a,e,s,r){const n=a.samples.length;if(!n)return;const o=a.inputTimeScale;for(let d=0;d<n;d++){const f=a.samples[d];f.pts=Sa(f.pts-s.baseTime*o/s.timescale,e*o)/o,f.dts=Sa(f.dts-r.baseTime*o/r.timescale,e*o)/o}const c=a.samples;return a.samples=[],{samples:c}}function v2(a,e,s){const r=a.samples.length;if(!r)return;const n=a.inputTimeScale;for(let c=0;c<r;c++){const d=a.samples[c];d.pts=Sa(d.pts-s.baseTime*n/s.timescale,e*n)/n}a.samples.sort((c,d)=>c.pts-d.pts);const o=a.samples;return a.samples=[],{samples:o}}class kP extends qa{constructor(e,s,r,n){super("passthrough-remuxer",n),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const s=this.initPTS;s&&e&&s.baseTime===e.baseTime&&s.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,s,r,n){this.audioCodec=s,this.videoCodec=r,this.generateInitSegment(e,n),this.emitInitSegment=!0}generateInitSegment(e,s){let{audioCodec:r,videoCodec:n}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:o,video:c}=this.initData=Ej(e);if(s)xM(e,s);else{const f=o||c;f!=null&&f.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${f.codec}")!`)}o&&(r=z1(o,Hs.AUDIO,this)),c&&(n=z1(c,Hs.VIDEO,this));const d={};o&&c?d.audiovideo={container:"video/mp4",codec:r+","+n,supplemental:c.supplemental,encrypted:c.encrypted,initSegment:e,id:"main"}:o?d.audio={container:"audio/mp4",codec:r,encrypted:o.encrypted,initSegment:e,id:"audio"}:c?d.video={container:"video/mp4",codec:n,supplemental:c.supplemental,encrypted:c.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=d}remux(e,s,r,n,o,c){var d,f;let{initPTS:u,lastEndTime:m}=this;const g={audio:void 0,video:void 0,text:n,id3:r,initSegment:void 0};Tt(m)||(m=this.lastEndTime=o||0);const x=s.samples;if(!x.length)return g;const b={initPTS:void 0,timescale:void 0,trackId:void 0};let v=this.initData;if((d=v)!=null&&d.length||(this.generateInitSegment(x),v=this.initData),!((f=v)!=null&&f.length))return this.warn("Failed to generate initSegment."),g;this.emitInitSegment&&(b.tracks=this.initTracks,this.emitInitSegment=!1);const w=bM(x,v,this),S=v.audio?w[v.audio.id]:null,T=v.video?w[v.video.id]:null,k=Oh(T,1/0),E=Oh(S,1/0),R=Oh(T,0,!0),K=Oh(S,0,!0);let z=o,D=0;const O=S&&(!T||!u&&E<k||u&&u.trackId===v.audio.id),U=O?S:T;if(U){const ce=U.timescale,ee=U.start-o*ce,W=O?v.audio.id:v.video.id;z=U.start/ce,D=O?K-E:R-k,(c||!u)&&(RP(u,z,o,D)||ce!==u.timescale)&&(u&&this.warn(`Timestamps at playlist time: ${c?"":"~"}${o} ${ee/ce} != initPTS: ${u.baseTime/u.timescale} (${u.baseTime}/${u.timescale}) trackId: ${u.trackId}`),this.log(`Found initPTS at playlist time: ${o} offset: ${z-o} (${ee}/${ce}) trackId: ${W}`),u=null,b.initPTS=ee,b.timescale=ce,b.trackId=W)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${o}`);u?(b.initPTS=u.baseTime,b.timescale=u.timescale,b.trackId=u.trackId):((!b.timescale||b.trackId===void 0||b.initPTS===void 0)&&(this.warn("Could not set initPTS"),b.initPTS=z,b.timescale=1,b.trackId=-1),this.initPTS=u={baseTime:b.initPTS,timescale:b.timescale,trackId:b.trackId});const I=z-u.baseTime/u.timescale,F=I+D;D>0?this.lastEndTime=F:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const te=!!v.audio,le=!!v.video;let H="";te&&(H+="audio"),le&&(H+="video");const X=(v.audio?v.audio.encrypted:!1)||(v.video?v.video.encrypted:!1),q={data1:x,startPTS:I,startDTS:I,endPTS:F,endDTS:F,type:H,hasAudio:te,hasVideo:le,nb:1,dropped:0,encrypted:X};g.audio=te&&!le?q:void 0,g.video=le?q:void 0;const ae=T==null?void 0:T.sampleCount;if(ae){const ce=T.keyFrameIndex,ee=ce!==-1;q.nb=ae,q.dropped=ce===0||this.isVideoContiguous?0:ee?ce:ae,q.independent=ee,q.firstKeyFrame=ce,ee&&T.keyFrameStart&&(q.firstKeyFramePTS=(T.keyFrameStart-u.baseTime)/u.timescale),this.isVideoContiguous||(g.independent=ee),this.isVideoContiguous||(this.isVideoContiguous=ee),q.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${ce}/${ae} dropped: ${q.dropped} start: ${q.firstKeyFramePTS||"NA"}`)}return g.initSegment=b,g.id3=b2(r,o,u,u),n.samples.length&&(g.text=v2(n,o,u)),g}}function Oh(a,e,s=!1){return(a==null?void 0:a.start)!==void 0?(a.start+(s?a.duration:0))/a.timescale:e}function RP(a,e,s,r){if(a===null)return!0;const n=Math.max(r,1),o=e-a.baseTime/a.timescale;return Math.abs(o-s)>n}function z1(a,e,s){const r=a.codec;return r&&r.length>4?r:e===Hs.AUDIO?r==="ec-3"||r==="ac-3"||r==="alac"?r:r==="fLaC"||r==="Opus"?Nf(r,!1):(s.warn(`Unhandled audio codec "${r}" in mp4 MAP`),r||"mp4a"):(s.warn(`Unhandled video codec "${r}" in mp4 MAP`),r||"avc1")}let ei;try{ei=self.performance.now.bind(self.performance)}catch{ei=Date.now}const cf=[{demux:pP,remux:kP},{demux:Vi,remux:lf},{demux:hP,remux:lf},{demux:mP,remux:lf}];cf.splice(2,0,{demux:fP,remux:lf});class q1{constructor(e,s,r,n,o,c){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=s,this.config=r,this.id=o,this.logger=c}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,s,r,n){const o=r.transmuxing;o.executeStart=ei();let c=new Uint8Array(e);const{currentTransmuxState:d,transmuxConfig:f}=this;n&&(this.currentTransmuxState=n);const{contiguous:u,discontinuity:m,trackSwitch:g,accurateTimeOffset:x,timeOffset:b,initSegmentChange:v}=n||d,{audioCodec:w,videoCodec:S,defaultInitPts:T,duration:k,initSegmentData:E}=f,R=LP(c,s);if(R&&Jl(R.method)){const O=this.getDecrypter(),U=Ox(R.method);if(O.isSync()){let I=O.softwareDecrypt(c,R.key.buffer,R.iv.buffer,U);if(r.part>-1){const te=O.flush();I=te&&te.buffer}if(!I)return o.executeEnd=ei(),Fg(r);c=new Uint8Array(I)}else return this.asyncResult=!0,this.decryptionPromise=O.webCryptoDecrypt(c,R.key.buffer,R.iv.buffer,U).then(I=>{const F=this.push(I,null,r);return this.decryptionPromise=null,F}),this.decryptionPromise}const K=this.needsProbing(m,g);if(K){const O=this.configureTransmuxer(c);if(O)return this.logger.warn(`[transmuxer] ${O.message}`),this.observer.emit(Q.ERROR,Q.ERROR,{type:Ft.MEDIA_ERROR,details:ze.FRAG_PARSING_ERROR,fatal:!1,error:O,reason:O.message}),o.executeEnd=ei(),Fg(r)}(m||g||v||K)&&this.resetInitSegment(E,w,S,k,s),(m||v||K)&&this.resetInitialTimestamp(T),u||this.resetContiguity();const z=this.transmux(c,R,b,x,r);this.asyncResult=Vd(z);const D=this.currentTransmuxState;return D.contiguous=!0,D.discontinuity=!1,D.trackSwitch=!1,o.executeEnd=ei(),z}flush(e){const s=e.transmuxing;s.executeStart=ei();const{decrypter:r,currentTransmuxState:n,decryptionPromise:o}=this;if(o)return this.asyncResult=!0,o.then(()=>this.flush(e));const c=[],{timeOffset:d}=n;if(r){const g=r.flush();g&&c.push(this.push(g.buffer,null,e))}const{demuxer:f,remuxer:u}=this;if(!f||!u){s.executeEnd=ei();const g=[Fg(e)];return this.asyncResult?Promise.resolve(g):g}const m=f.flush(d);return Vd(m)?(this.asyncResult=!0,m.then(g=>(this.flushRemux(c,g,e),c))):(this.flushRemux(c,m,e),this.asyncResult?Promise.resolve(c):c)}flushRemux(e,s,r){const{audioTrack:n,videoTrack:o,id3Track:c,textTrack:d}=s,{accurateTimeOffset:f,timeOffset:u}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${r.sn}${r.part>-1?" part: "+r.part:""} of ${this.id===Rt.MAIN?"level":"track"} ${r.level}`);const m=this.remuxer.remux(n,o,c,d,u,f,!0,this.id);e.push({remuxResult:m,chunkMeta:r}),r.transmuxing.executeEnd=ei()}resetInitialTimestamp(e){const{demuxer:s,remuxer:r}=this;!s||!r||(s.resetTimeStamp(e),r.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:s}=this;!e||!s||(e.resetContiguity(),s.resetNextTimestamp())}resetInitSegment(e,s,r,n,o){const{demuxer:c,remuxer:d}=this;!c||!d||(c.resetInitSegment(e,s,r,n),d.resetInitSegment(e,s,r,o))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,s,r,n,o){let c;return s&&s.method==="SAMPLE-AES"?c=this.transmuxSampleAes(e,s,r,n,o):c=this.transmuxUnencrypted(e,r,n,o),c}transmuxUnencrypted(e,s,r,n){const{audioTrack:o,videoTrack:c,id3Track:d,textTrack:f}=this.demuxer.demux(e,s,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(o,c,d,f,s,r,!1,this.id),chunkMeta:n}}transmuxSampleAes(e,s,r,n,o){return this.demuxer.demuxSampleAes(e,s,r).then(c=>({remuxResult:this.remuxer.remux(c.audioTrack,c.videoTrack,c.id3Track,c.textTrack,r,n,!1,this.id),chunkMeta:o}))}configureTransmuxer(e){const{config:s,observer:r,typeSupported:n}=this;let o;for(let g=0,x=cf.length;g<x;g++){var c;if((c=cf[g].demux)!=null&&c.probe(e,this.logger)){o=cf[g];break}}if(!o)return new Error("Failed to find demuxer by probing fragment data");const d=this.demuxer,f=this.remuxer,u=o.remux,m=o.demux;(!f||!(f instanceof u))&&(this.remuxer=new u(r,s,n,this.logger)),(!d||!(d instanceof m))&&(this.demuxer=new m(r,s,n,this.logger),this.probe=m.probe)}needsProbing(e,s){return!this.demuxer||!this.remuxer||e||s}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Mx(this.config)),e}}function LP(a,e){let s=null;return a.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(s=e),s}const Fg=a=>({remuxResult:{},chunkMeta:a});function Vd(a){return"then"in a&&a.then instanceof Function}class DP{constructor(e,s,r,n,o){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=s,this.initSegmentData=r,this.duration=n,this.defaultInitPts=o||null}}class IP{constructor(e,s,r,n,o,c){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=s,this.accurateTimeOffset=r,this.trackSwitch=n,this.timeOffset=o,this.initSegmentChange=c}}let K1=0;class w2{constructor(e,s,r,n){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=K1++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=f=>{const u=f.data,m=this.hls;if(!(!m||!(u!=null&&u.event)||u.instanceNo!==this.instanceNo))switch(u.event){case"init":{var g;const x=(g=this.workerContext)==null?void 0:g.objectURL;x&&self.URL.revokeObjectURL(x);break}case"transmuxComplete":{this.handleTransmuxComplete(u.data);break}case"flush":{this.onFlush(u.data);break}case"workerLog":{m.logger[u.data.logType]&&m.logger[u.data.logType](u.data.message);break}default:{u.data=u.data||{},u.data.frag=this.frag,u.data.part=this.part,u.data.id=this.id,m.trigger(u.event,u.data);break}}},this.onWorkerError=f=>{if(!this.hls)return;const u=new Error(`${f.message}  (${f.filename}:${f.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(Q.ERROR,{type:Ft.OTHER_ERROR,details:ze.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:u})};const o=e.config;this.hls=e,this.id=s,this.useWorker=!!o.enableWorker,this.onTransmuxComplete=r,this.onFlush=n;const c=(f,u)=>{u=u||{},u.frag=this.frag||void 0,f===Q.ERROR&&(u=u,u.parent=this.id,u.part=this.part,this.error=u.error),this.hls.trigger(f,u)};this.observer=new Ux,this.observer.on(Q.FRAG_DECRYPTED,c),this.observer.on(Q.ERROR,c);const d=l1(o.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const f=this.hls.logger;if(o.workerPath||F6()){try{o.workerPath?(f.log(`loading Web Worker ${o.workerPath} for "${s}"`),this.workerContext=U6(o.workerPath)):(f.log(`injecting Web Worker for "${s}"`),this.workerContext=B6());const{worker:m}=this.workerContext;m.addEventListener("message",this.onWorkerMessage),m.addEventListener("error",this.onWorkerError),m.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:d,id:s,config:zs(o)})}catch(m){f.warn(`Error setting up "${s}" Web Worker, fallback to inline`,m),this.terminateWorker(),this.error=null,this.transmuxer=new q1(this.observer,d,o,"",s,e.logger)}return}}this.transmuxer=new q1(this.observer,d,o,"",s,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=K1++;const s=this.hls.config,r=l1(s.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:r,id:this.id,config:zs(s)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),$6(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const s=this.transmuxer;s&&(s.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,s,r,n,o,c,d,f,u,m){var g,x;u.transmuxing.start=self.performance.now();const{instanceNo:b,transmuxer:v}=this,w=c?c.start:o.start,S=o.decryptdata,T=this.frag,k=!(T&&o.cc===T.cc),E=!(T&&u.level===T.level),R=T?u.sn-T.sn:-1,K=this.part?u.part-this.part.index:-1,z=R===0&&u.id>1&&u.id===(T==null?void 0:T.stats.chunkCount),D=!E&&(R===1||R===0&&(K===1||z&&K<=0)),O=self.performance.now();(E||R||o.stats.parsing.start===0)&&(o.stats.parsing.start=O),c&&(K||!D)&&(c.stats.parsing.start=O);const U=!(T&&((g=o.initSegment)==null?void 0:g.url)===((x=T.initSegment)==null?void 0:x.url)),I=new IP(k,D,f,E,w,U);if(!D||k||U){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${o.type} sn: ${u.sn}${u.part>-1?" part: "+u.part:""} ${this.id===Rt.MAIN?"level":"track"}: ${u.level} id: ${u.id}
        discontinuity: ${k}
        trackSwitch: ${E}
        contiguous: ${D}
        accurateTimeOffset: ${f}
        timeOffset: ${w}
        initSegmentChange: ${U}`);const F=new DP(r,n,s,d,m);this.configureTransmuxer(F)}if(this.frag=o,this.part=c,this.workerContext)this.workerContext.worker.postMessage({instanceNo:b,cmd:"demux",data:e,decryptdata:S,chunkMeta:u,state:I},e instanceof ArrayBuffer?[e]:[]);else if(v){const F=v.push(e,S,u,I);Vd(F)?F.then(te=>{this.handleTransmuxComplete(te)}).catch(te=>{this.transmuxerError(te,u,"transmuxer-interface push error")}):this.handleTransmuxComplete(F)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:s,transmuxer:r}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:s,cmd:"flush",chunkMeta:e});else if(r){const n=r.flush(e);Vd(n)?n.then(o=>{this.handleFlushResult(o,e)}).catch(o=>{this.transmuxerError(o,e,"transmuxer-interface flush error")}):this.handleFlushResult(n,e)}}transmuxerError(e,s,r){this.hls&&(this.error=e,this.hls.trigger(Q.ERROR,{type:Ft.MEDIA_ERROR,details:ze.FRAG_PARSING_ERROR,chunkMeta:s,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:r}))}handleFlushResult(e,s){e.forEach(r=>{this.handleTransmuxComplete(r)}),this.onFlush(s)}configureTransmuxer(e){const{instanceNo:s,transmuxer:r}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:s,cmd:"configure",config:e}):r&&r.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const Y1=100;class MP extends Bx{constructor(e,s,r){super(e,s,r,"audio-stream-controller",Rt.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(Q.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Q.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(Q.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(Q.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(Q.BUFFER_RESET,this.onBufferReset,this),e.on(Q.BUFFER_CREATED,this.onBufferCreated,this),e.on(Q.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Q.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(Q.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(Q.FRAG_LOADING,this.onFragLoading,this),e.on(Q.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(Q.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Q.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(Q.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(Q.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(Q.BUFFER_RESET,this.onBufferReset,this),e.off(Q.BUFFER_CREATED,this.onBufferCreated,this),e.off(Q.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Q.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(Q.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(Q.FRAG_LOADING,this.onFragLoading,this),e.off(Q.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:s,id:r,initPTS:n,timescale:o,trackId:c}){if(r===Rt.MAIN){const d=s.cc,f=this.fragCurrent;if(this.initPTS[d]={baseTime:n,timescale:o,trackId:c},this.log(`InitPTS for cc: ${d} found from main: ${n/o} (${n}/${o}) trackId: ${c}`),this.mainAnchor=s,this.state===ut.WAITING_INIT_PTS){const u=this.waitingData;(!u&&!this.loadingParts||u&&u.frag.cc!==d)&&this.syncWithAnchor(s,u==null?void 0:u.frag)}else!this.hls.hasEnoughToStart&&f&&f.cc!==d?(f.abortRequests(),this.syncWithAnchor(s,f)):this.state===ut.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,s){var r;const n=((r=this.mainFragLoading)==null?void 0:r.frag)||null;if(s&&(n==null?void 0:n.cc)===s.cc)return;const o=(n||e).cc,c=this.getLevelDetails(),d=this.getLoadPosition(),f=Oj(c,o,d);f&&(this.log(`Syncing with main frag at ${f.start} cc ${f.cc}`),this.startFragRequested=!1,this.nextLoadPosition=f.start,this.resetLoadingState(),this.state===ut.IDLE&&this.doTickIdle())}startLoad(e,s){if(!this.levels){this.startPosition=e,this.state=ut.STOPPED;return}const r=this.lastCurrentTime;this.stopLoad(),this.setInterval(Y1),r>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r,this.state=ut.IDLE):this.state=ut.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=s?-1:e,this.tick()}doTick(){switch(this.state){case ut.IDLE:this.doTickIdle();break;case ut.WAITING_TRACK:{const{levels:e,trackId:s}=this,r=e==null?void 0:e[s],n=r==null?void 0:r.details;if(n&&!this.waitForLive(r)){if(this.waitForCdnTuneIn(n))break;this.state=ut.WAITING_INIT_PTS}break}case ut.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case ut.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:s,part:r,cache:n,complete:o}=e,c=this.mainAnchor;if(this.initPTS[s.cc]!==void 0){this.waitingData=null,this.state=ut.FRAG_LOADING;const d=n.flush().buffer,f={frag:s,part:r,payload:d,networkDetails:null};this._handleFragmentLoadProgress(f),o&&super._handleFragmentLoadComplete(f)}else c&&c.cc!==e.frag.cc&&this.syncWithAnchor(c,e.frag)}else this.state=ut.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:s,levels:r,media:n,trackId:o}=this,c=s.config;if(!this.buffering||!n&&!this.primaryPrefetch&&(this.startFragRequested||!c.startFragPrefetch)||!(r!=null&&r[o]))return;const d=r[o],f=d.details;if(!f||this.waitForLive(d)||this.waitForCdnTuneIn(f)){this.state=ut.WAITING_TRACK,this.startFragRequested=!1;return}const u=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&u&&(this.bufferFlushed=!1,this.afterBufferFlushed(u,Hs.AUDIO,Rt.AUDIO));const m=this.getFwdBufferInfo(u,Rt.AUDIO);if(m===null)return;if(!this.switchingTrack&&this._streamEnded(m,f)){s.trigger(Q.BUFFER_EOS,{type:"audio"}),this.state=ut.ENDED;return}const g=m.len,x=s.maxBufferLength,b=f.fragments,v=b[0].start,w=this.getLoadPosition(),S=this.flushing?w:m.end;if(this.switchingTrack&&n){const E=w;f.PTSKnown&&E<v&&(m.end>v||m.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=v+.05)}if(g>=x&&!this.switchingTrack&&S<b[b.length-1].start)return;let T=this.getNextFragment(S,f);if(T&&this.isLoopLoading(T,S)&&(T=this.getNextFragmentLoopLoading(T,f,m,Rt.MAIN,x)),!T){this.bufferFlushed=!0;return}let k=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&k&&ur(T)&&!T.endList&&(!f.live||!this.loadingParts&&S<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(k)===Sr.OK&&(this.mainFragLoading=k=null),k&&ur(k))){if(T.start>k.end){const R=this.fragmentTracker.getFragAtPos(S,Rt.MAIN);R&&R.end>k.end&&(k=R,this.mainFragLoading={frag:R,targetBufferTime:null})}if(T.start>k.end)return}this.loadFragment(T,d,S)}onMediaDetaching(e,s){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,s)}onAudioTracksUpdated(e,{audioTracks:s}){this.resetTransmuxer(),this.levels=s.map(r=>new $d(r))}onAudioTrackSwitching(e,s){const r=!!s.url;this.trackId=s.id;const{fragCurrent:n}=this;n&&(n.abortRequests(),this.removeUnbufferedFrags(n.start)),this.resetLoadingState(),r?(this.switchingTrack=s,this.flushAudioIfNeeded(s),this.state!==ut.STOPPED&&(this.setInterval(Y1),this.state=ut.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=s,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,s){this.mainDetails=s.details;const r=this.cachedTrackLoadedData;r&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(Q.AUDIO_TRACK_LOADED,r))}onAudioTrackLoaded(e,s){var r;const{levels:n}=this,{details:o,id:c,groupId:d,track:f}=s;if(!n){this.warn(`Audio tracks reset while loading track ${c} "${f.name}" of "${d}"`);return}const u=this.mainDetails;if(!u||o.endCC>u.endCC||u.expired){this.cachedTrackLoadedData=s,this.state!==ut.STOPPED&&(this.state=ut.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${c} "${f.name}" of "${d}" loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`);const m=n[c];let g=0;if(o.live||(r=m.details)!=null&&r.live){if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;if(m.details){var x;g=this.alignPlaylists(o,m.details,(x=this.levelLastLoaded)==null?void 0:x.details)}o.alignedSliding||(t2(o,u),o.alignedSliding||Rf(o,u),g=o.fragmentStart)}m.details=o,this.levelLastLoaded=m,this.startFragRequested||this.setStartPosition(u,g),this.hls.trigger(Q.AUDIO_TRACK_UPDATED,{details:o,id:c,groupId:s.groupId}),this.state===ut.WAITING_TRACK&&!this.waitForCdnTuneIn(o)&&(this.state=ut.IDLE),this.tick()}_handleFragmentLoadProgress(e){var s;const r=e.frag,{part:n,payload:o}=e,{config:c,trackId:d,levels:f}=this;if(!f){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const u=f[d];if(!u){this.warn("Audio track is undefined on fragment load progress");return}const m=u.details;if(!m){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(r.start);return}const g=c.defaultAudioCodec||u.audioCodec||"mp4a.40.2";let x=this.transmuxer;x||(x=this.transmuxer=new w2(this.hls,Rt.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const b=this.initPTS[r.cc],v=(s=r.initSegment)==null?void 0:s.data;if(b!==void 0){const S=n?n.index:-1,T=S!==-1,k=new Px(r.level,r.sn,r.stats.chunkCount,o.byteLength,S,T);x.push(o,v,g,"",r,n,m.totalduration,!1,k,b)}else{this.log(`Unknown video PTS for cc ${r.cc}, waiting for video PTS before demuxing audio frag ${r.sn} of [${m.startSN} ,${m.endSN}],track ${d}`);const{cache:w}=this.waitingData=this.waitingData||{frag:r,part:n,cache:new s2,complete:!1};w.push(new Uint8Array(o)),this.state!==ut.STOPPED&&(this.state=ut.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,s){this.bufferFlushed=this.flushing=!1;const r=s.tracks.audio;r&&(this.mediaBuffer=r.buffer||null)}onFragLoading(e,s){!this.audioOnly&&s.frag.type===Rt.MAIN&&ur(s.frag)&&(this.mainFragLoading=s,this.state===ut.IDLE&&this.tick())}onFragBuffered(e,s){const{frag:r,part:n}=s;if(r.type!==Rt.AUDIO){!this.audioOnly&&r.type===Rt.MAIN&&!r.elementaryStreams.video&&!r.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${n?" p: "+n.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(ur(r)){this.fragPrevious=r;const o=this.switchingTrack;o&&(this.bufferedTrack=o,this.switchingTrack=null,this.hls.trigger(Q.AUDIO_TRACK_SWITCHED,Is({},o)))}this.fragBufferedComplete(r,n),this.media&&this.tick()}onError(e,s){var r;if(s.fatal){this.state=ut.ERROR;return}switch(s.details){case ze.FRAG_GAP:case ze.FRAG_PARSING_ERROR:case ze.FRAG_DECRYPT_ERROR:case ze.FRAG_LOAD_ERROR:case ze.FRAG_LOAD_TIMEOUT:case ze.KEY_LOAD_ERROR:case ze.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Rt.AUDIO,s);break;case ze.AUDIO_TRACK_LOAD_ERROR:case ze.AUDIO_TRACK_LOAD_TIMEOUT:case ze.LEVEL_PARSING_ERROR:!s.levelRetry&&this.state===ut.WAITING_TRACK&&((r=s.context)==null?void 0:r.type)===us.AUDIO_TRACK&&(this.state=ut.IDLE);break;case ze.BUFFER_ADD_CODEC_ERROR:case ze.BUFFER_APPEND_ERROR:if(s.parent!=="audio")return;this.reduceLengthAndFlushBuffer(s)||this.resetLoadingState();break;case ze.BUFFER_FULL_ERROR:if(s.parent!=="audio")return;this.reduceLengthAndFlushBuffer(s)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case ze.INTERNAL_EXCEPTION:this.recoverWorkerError(s);break}}onBufferFlushing(e,{type:s}){s!==Hs.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:s}){if(s!==Hs.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===ut.ENDED&&(this.state=ut.IDLE);const r=this.mediaBuffer||this.media;r&&(this.afterBufferFlushed(r,s,Rt.AUDIO),this.tick())}}_handleTransmuxComplete(e){var s;const r="audio",{hls:n}=this,{remuxResult:o,chunkMeta:c}=e,d=this.getCurrentContext(c);if(!d){this.resetWhenMissingContext(c);return}const{frag:f,part:u,level:m}=d,{details:g}=m,{audio:x,text:b,id3:v,initSegment:w}=o;if(this.fragContextChanged(f)||!g){this.fragmentTracker.removeFragment(f);return}if(this.state=ut.PARSING,this.switchingTrack&&x&&this.completeAudioSwitch(this.switchingTrack),w!=null&&w.tracks){const S=f.initSegment||f;if(this.unhandledEncryptionError(w,f))return;this._bufferInitSegment(m,w.tracks,S,c),n.trigger(Q.FRAG_PARSING_INIT_SEGMENT,{frag:S,id:r,tracks:w.tracks})}if(x){const{startPTS:S,endPTS:T,startDTS:k,endDTS:E}=x;u&&(u.elementaryStreams[Hs.AUDIO]={startPTS:S,endPTS:T,startDTS:k,endDTS:E}),f.setElementaryStreamInfo(Hs.AUDIO,S,T,k,E),this.bufferFragmentData(x,f,u,c)}if(v!=null&&(s=v.samples)!=null&&s.length){const S=Us({id:r,frag:f,details:g},v);n.trigger(Q.FRAG_PARSING_METADATA,S)}if(b){const S=Us({id:r,frag:f,details:g},b);n.trigger(Q.FRAG_PARSING_USERDATA,S)}}_bufferInitSegment(e,s,r,n){if(this.state!==ut.PARSING||(s.video&&delete s.video,s.audiovideo&&delete s.audiovideo,!s.audio))return;const o=s.audio;o.id=Rt.AUDIO;const c=e.audioCodec;this.log(`Init audio buffer, container:${o.container}, codecs[level/parsed]=[${c}/${o.codec}]`),c&&c.split(",").length===1&&(o.levelCodec=c),this.hls.trigger(Q.BUFFER_CODECS,s);const d=o.initSegment;if(d!=null&&d.byteLength){const f={type:"audio",frag:r,part:null,chunkMeta:n,parent:r.type,data:d};this.hls.trigger(Q.BUFFER_APPENDING,f)}this.tickImmediate()}loadFragment(e,s,r){const n=this.fragmentTracker.getState(e);if(this.switchingTrack||n===Sr.NOT_LOADED||n===Sr.PARTIAL){var o;if(!ur(e))this._loadInitSegment(e,s);else if((o=s.details)!=null&&o.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=ut.WAITING_INIT_PTS;const c=this.mainDetails;c&&c.fragmentStart!==s.details.fragmentStart&&Rf(s.details,c)}else super.loadFragment(e,s,r)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:s,lang:r,assocLang:n,characteristics:o,audioCodec:c,channels:d}=this.bufferedTrack;sl({name:s,lang:r,assocLang:n,characteristics:o,audioCodec:c,channels:d},e,Bo)||(Ef(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:s}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,s.trigger(Q.AUDIO_TRACK_SWITCHED,Is({},e))}}class Kx extends qa{constructor(e,s){super(s,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,s,r){const n=s==null?void 0:s.renditionReports;if(n){let o=-1;for(let c=0;c<n.length;c++){const d=n[c];let f;try{f=new self.URL(d.URI,s.url).href}catch(u){this.warn(`Could not construct new URL for Rendition Report: ${u}`),f=d.URI||""}if(f===e){o=c;break}else f===e.substring(0,f.length)&&(o=c)}if(o!==-1){const c=n[o],d=parseInt(c["LAST-MSN"])||s.lastPartSn;let f=parseInt(c["LAST-PART"])||s.lastPartIndex;if(this.hls.config.lowLatencyMode){const m=Math.min(s.age-s.partTarget,s.targetduration);f>=0&&m>s.partTarget&&(f+=1)}const u=r&&c1(r);return new d1(d,f>=0?f:void 0,u)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,s){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,s){if(s)try{return s.addDirectives(e)}catch(r){this.warn(`Could not construct new URL with HLS Delivery Directives: ${r}`)}return e}playlistLoaded(e,s,r){const{details:n,stats:o}=s,c=self.performance.now(),d=o.loading.first?Math.max(0,c-o.loading.first):0;n.advancedDateTime=Date.now()-d;const f=this.hls.config.timelineOffset;if(f!==n.appliedTimelineOffset){const m=Math.max(f||0,0);n.appliedTimelineOffset=m,n.fragments.forEach(g=>{g.setStart(g.playlistOffset+m)})}if(n.live||r!=null&&r.live){const m="levelInfo"in s?s.levelInfo:s.track;if(n.reloaded(r),r&&n.fragments.length>0){T6(r,n,this);const k=n.playlistParsingError;if(k){this.warn(k);const E=this.hls;if(!E.config.ignorePlaylistParsingErrors){var u;const{networkDetails:R}=s;E.trigger(Q.ERROR,{type:Ft.NETWORK_ERROR,details:ze.LEVEL_PARSING_ERROR,fatal:!1,url:n.url,error:k,reason:k.message,level:s.level||void 0,parent:(u=n.fragments[0])==null?void 0:u.type,networkDetails:R,stats:o});return}n.playlistParsingError=null}}n.requestScheduled===-1&&(n.requestScheduled=o.loading.start);const g=this.hls.mainForwardBufferInfo,x=g?g.end-g.len:0,b=(n.edge-x)*1e3,v=Qj(n,b);if(n.requestScheduled+v<c?n.requestScheduled=c:n.requestScheduled+=v,this.log(`live playlist ${e} ${n.advanced?"REFRESHED "+n.lastPartSn+"-"+n.lastPartIndex:n.updated?"UPDATED":"MISSED"}`),!this.canLoad||!n.live)return;let w,S,T;if(n.canBlockReload&&n.endSN&&n.advanced){const k=this.hls.config.lowLatencyMode,E=n.lastPartSn,R=n.endSN,K=n.lastPartIndex,z=K!==-1,D=E===R;z?D?(S=R+1,T=k?0:K):(S=E,T=k?K+1:n.maxPartIndex):S=R+1;const O=n.age,U=O+n.ageHeader;let I=Math.min(U-n.partTarget,n.targetduration*1.5);if(I>0){if(U>n.targetduration*3)this.log(`Playlist last advanced ${O.toFixed(2)}s ago. Omitting segment and part directives.`),S=void 0,T=void 0;else if(r!=null&&r.tuneInGoal&&U-n.partTarget>r.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${r.tuneInGoal} to: ${I} with playlist age: ${n.age}`),I=0;else{const F=Math.floor(I/n.targetduration);if(S+=F,T!==void 0){const te=Math.round(I%n.targetduration/n.partTarget);T+=te}this.log(`CDN Tune-in age: ${n.ageHeader}s last advanced ${O.toFixed(2)}s goal: ${I} skip sn ${F} to part ${T}`)}n.tuneInGoal=I}if(w=this.getDeliveryDirectives(n,s.deliveryDirectives,S,T),k||!D){n.requestScheduled=c,this.loadingPlaylist(m,w);return}}else(n.canBlockReload||n.canSkipUntil)&&(w=this.getDeliveryDirectives(n,s.deliveryDirectives,S,T));w&&S!==void 0&&n.canBlockReload&&(n.requestScheduled=o.loading.first+Math.max(v-d*2,v/2)),this.scheduleLoading(m,w,n)}else this.clearTimer()}scheduleLoading(e,s,r){const n=r||e.details;if(!n){this.loadingPlaylist(e,s);return}const o=self.performance.now(),c=n.requestScheduled;if(o>=c){this.loadingPlaylist(e,s);return}const d=c-o;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(d)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,s),d)}getDeliveryDirectives(e,s,r,n){let o=c1(e);return s!=null&&s.skip&&e.deltaUpdateFailed&&(r=s.msn,n=s.part,o=nf.No),new d1(r,n,o)}checkRetry(e){const s=e.details,r=Tf(e),n=e.errorAction,{action:o,retryCount:c=0,retryConfig:d}=n||{},f=!!n&&!!d&&(o===Dr.RetryRequest||!n.resolved&&o===Dr.SendAlternateToPenaltyBox);if(f){var u;if(c>=d.maxNumRetry)return!1;if(r&&(u=e.context)!=null&&u.deliveryDirectives)this.warn(`Retrying playlist loading ${c+1}/${d.maxNumRetry} after "${s}" without delivery-directives`),this.loadPlaylist();else{const m=Ix(d,c);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),m),this.warn(`Retrying playlist loading ${c+1}/${d.maxNumRetry} after "${s}" in ${m}ms`)}e.levelRetry=!0,n.resolved=!0}return f}}function S2(a,e){if(a.length!==e.length)return!1;for(let s=0;s<a.length;s++)if(!zd(a[s].attrs,e[s].attrs))return!1;return!0}function zd(a,e,s){const r=a["STABLE-RENDITION-ID"];return r&&!s?r===e["STABLE-RENDITION-ID"]:!(s||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(n=>a[n]!==e[n])}function qp(a,e){return e.label.toLowerCase()===a.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(a.lang||"").toLowerCase())}class PP extends Kx{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Q.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Q.LEVEL_LOADING,this.onLevelLoading,this),e.on(Q.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(Q.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(Q.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Q.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Q.LEVEL_LOADING,this.onLevelLoading,this),e.off(Q.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(Q.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(Q.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,s){this.tracks=s.audioTracks||[]}onAudioTrackLoaded(e,s){const{id:r,groupId:n,details:o}=s,c=this.tracksInGroup[r];if(!c||c.groupId!==n){this.warn(`Audio track with id:${r} and group:${n} not found in active group ${c==null?void 0:c.groupId}`);return}const d=c.details;c.details=s.details,this.log(`Audio track ${r} "${c.name}" lang:${c.lang} group:${n} loaded [${o.startSN}-${o.endSN}]`),r===this.trackId&&this.playlistLoaded(r,s,d)}onLevelLoading(e,s){this.switchLevel(s.level)}onLevelSwitching(e,s){this.switchLevel(s.level)}switchLevel(e){const s=this.hls.levels[e];if(!s)return;const r=s.audioGroups||null,n=this.groupIds;let o=this.currentTrack;if(!r||(n==null?void 0:n.length)!==(r==null?void 0:r.length)||r!=null&&r.some(d=>(n==null?void 0:n.indexOf(d))===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const d=this.tracks.filter(x=>!r||r.indexOf(x.groupId)!==-1);if(d.length)this.selectDefaultTrack&&!d.some(x=>x.default)&&(this.selectDefaultTrack=!1),d.forEach((x,b)=>{x.id=b});else if(!o&&!this.tracksInGroup.length)return;this.tracksInGroup=d;const f=this.hls.config.audioPreference;if(!o&&f){const x=Nn(f,d,Bo);if(x>-1)o=d[x];else{const b=Nn(f,this.tracks);o=this.tracks[b]}}let u=this.findTrackId(o);u===-1&&o&&(u=this.findTrackId(null));const m={audioTracks:d};this.log(`Updating audio tracks, ${d.length} track(s) found in group(s): ${r==null?void 0:r.join(",")}`),this.hls.trigger(Q.AUDIO_TRACKS_UPDATED,m);const g=this.trackId;if(u!==-1&&g===-1)this.setAudioTrack(u);else if(d.length&&g===-1){var c;const x=new Error(`No audio track selected for current audio group-ID(s): ${(c=this.groupIds)==null?void 0:c.join(",")} track count: ${d.length}`);this.warn(x.message),this.hls.trigger(Q.ERROR,{type:Ft.MEDIA_ERROR,details:ze.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:x})}}}onError(e,s){s.fatal||!s.context||s.context.type===us.AUDIO_TRACK&&s.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(s.context.groupId)!==-1)&&this.checkRetry(s)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const s=this.hls;if(s.config.audioPreference=e,e){const r=this.allAudioTracks;if(this.selectDefaultTrack=!1,r.length){const n=this.currentTrack;if(n&&sl(e,n,Bo))return n;const o=Nn(e,this.tracksInGroup,Bo);if(o>-1){const c=this.tracksInGroup[o];return this.setAudioTrack(o),c}else if(n){let c=s.loadLevel;c===-1&&(c=s.firstAutoLevel);const d=YM(e,s.levels,r,c,Bo);if(d===-1)return null;s.nextLoadLevel=d}if(e.channels||e.audioCodec){const c=Nn(e,r);if(c>-1)return r[c]}}}return null}setAudioTrack(e){const s=this.tracksInGroup;if(e<0||e>=s.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,n=s[e],o=n.details&&!n.details.live;if(e===this.trackId&&n===r&&o||(this.log(`Switching to audio-track ${e} "${n.name}" lang:${n.lang} group:${n.groupId} channels:${n.channels}`),this.trackId=e,this.currentTrack=n,this.hls.trigger(Q.AUDIO_TRACK_SWITCHING,Is({},n)),o))return;const c=this.switchParams(n.url,r==null?void 0:r.details,n.details);this.loadPlaylist(c)}findTrackId(e){const s=this.tracksInGroup;for(let r=0;r<s.length;r++){const n=s[r];if(!(this.selectDefaultTrack&&!n.default)&&(!e||sl(e,n,Bo)))return r}if(e){const{name:r,lang:n,assocLang:o,characteristics:c,audioCodec:d,channels:f}=e;for(let u=0;u<s.length;u++){const m=s[u];if(sl({name:r,lang:n,assocLang:o,characteristics:c,audioCodec:d,channels:f},m,Bo))return u}for(let u=0;u<s.length;u++){const m=s[u];if(zd(e.attrs,m.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return u}for(let u=0;u<s.length;u++){const m=s[u];if(zd(e.attrs,m.attrs,["LANGUAGE"]))return u}}return-1}loadPlaylist(e){super.loadPlaylist();const s=this.currentTrack;this.shouldLoadPlaylist(s)&&Ef(s.url,this.hls)&&this.scheduleLoading(s,e)}loadingPlaylist(e,s){super.loadingPlaylist(e,s);const r=e.id,n=e.groupId,o=this.getUrlWithDirectives(e.url,s),c=e.details,d=c==null?void 0:c.age;this.log(`Loading audio-track ${r} "${e.name}" lang:${e.lang} group:${n}${(s==null?void 0:s.msn)!==void 0?" at sn "+s.msn+" part "+s.part:""}${d&&c.live?" age "+d.toFixed(1)+(c.type&&" "+c.type||""):""} ${o}`),this.hls.trigger(Q.AUDIO_TRACK_LOADING,{url:o,id:r,groupId:n,deliveryDirectives:s||null,track:e})}}class OP{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,s,r){if(this.queues===null||this.tracks===null)return;const n=this.queues[s];n.push(e),n.length===1&&!r&&this.executeNext(s)}appendBlocker(e){return new Promise(s=>{const r={label:"async-blocker",execute:s,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(r,e)})}prependBlocker(e){return new Promise(s=>{if(this.queues){const r={label:"async-blocker-prepend",execute:s,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(r)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var s;const r=(s=e[0])==null?void 0:s.label;(r==="async-blocker"||r==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const s=this.queues[e];if(s.length){const n=s[0];try{n.execute()}catch(o){var r;if(n.onError(o),this.queues===null||this.tracks===null)return;const c=(r=this.tracks[e])==null?void 0:r.buffer;c!=null&&c.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var s;return((s=this.queues)==null?void 0:s[e][0])||null}toString(){const{queues:e,tracks:s}=this;return e===null||s===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var s,r;return(s=this.queues)!=null&&s[e]||(r=this.tracks)!=null&&r[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var s;const r=(s=this.tracks)==null?void 0:s[e],n=r==null?void 0:r.buffer;return n?`SourceBuffer${n.updating?" updating":""}${r.ended?" ended":""}${r.ending?" ending":""}`:"none"}listOps(e){var s;return((s=this.queues)==null?void 0:s[e].map(r=>r.label).join(", "))||""}}const W1=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,_2="HlsJsTrackRemovedError";class FP extends Error{constructor(e){super(e),this.name=_2}}class BP extends qa{constructor(e,s){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=r=>{var n;this.hls&&((n=this.mediaSource)==null?void 0:n.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=r=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=r=>{const{media:n,mediaSource:o}=this;r&&this.log("Media source opened"),!(!n||!o)&&(o.removeEventListener("sourceopen",this._onMediaSourceOpen),n.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(Q.MEDIA_ATTACHED,{media:n,mediaSource:o}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:r,_objectUrl:n}=this;r!==n&&this.error(`Media element src was set while attaching MediaSource (${n} > ${r})`)},this.hls=e,this.fragmentTracker=s,this.appendSource=oM(co(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(Q.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Q.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Q.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Q.BUFFER_RESET,this.onBufferReset,this),e.on(Q.BUFFER_APPENDING,this.onBufferAppending,this),e.on(Q.BUFFER_CODECS,this.onBufferCodecs,this),e.on(Q.BUFFER_EOS,this.onBufferEos,this),e.on(Q.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Q.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(Q.FRAG_PARSED,this.onFragParsed,this),e.on(Q.FRAG_CHANGED,this.onFragChanged,this),e.on(Q.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(Q.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Q.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Q.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Q.BUFFER_RESET,this.onBufferReset,this),e.off(Q.BUFFER_APPENDING,this.onBufferAppending,this),e.off(Q.BUFFER_CODECS,this.onBufferCodecs,this),e.off(Q.BUFFER_EOS,this.onBufferEos,this),e.off(Q.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Q.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(Q.FRAG_PARSED,this.onFragParsed,this),e.off(Q.FRAG_CHANGED,this.onFragChanged,this),e.off(Q.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:s}=this;if(!e)return null;const r={};if(this.operationQueue){const o=this.isUpdating();o||this.operationQueue.removeBlockers();const c=this.isQueued();(o||c)&&this.warn(`Transfering MediaSource with${c?" operations in queue":""}${o?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const n=this.transferData;return!this.sourceBufferCount&&n&&n.mediaSource===s?Us(r,n.tracks):this.sourceBuffers.forEach(o=>{const[c]=o;c&&(r[c]=Us({},this.tracks[c]),this.removeBuffer(c)),o[0]=o[1]=null}),{media:e,mediaSource:s,tracks:r}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,s){var r;let n=2;(s.audio&&!s.video||!s.altAudio)&&(n=1),this.bufferCodecEventsTotal=n,this.log(`${n} bufferCodec event(s) expected.`),(r=this.transferData)!=null&&r.mediaSource&&this.sourceBufferCount&&n&&this.bufferCreated()}onMediaAttaching(e,s){const r=this.media=s.media;this.transferData=this.overrides=void 0;const n=co(this.appendSource);if(n){const o=!!s.mediaSource;(o||s.overrides)&&(this.transferData=s,this.overrides=s.overrides);const c=this.mediaSource=s.mediaSource||new n;if(this.assignMediaSource(c),o)this._objectUrl=r.src,this.attachTransferred();else{const d=this._objectUrl=self.URL.createObjectURL(c);if(this.appendSource)try{r.removeAttribute("src");const f=self.ManagedMediaSource;r.disableRemotePlayback=r.disableRemotePlayback||f&&c instanceof f,Q1(r),UP(r,d),r.load()}catch{r.src=d}else r.src=d}r.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var s,r;this.log(`${((s=this.transferData)==null?void 0:s.mediaSource)===e?"transferred":"created"} media source: ${(r=e.constructor)==null?void 0:r.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,s=this.transferData;if(!s||!e)return;const r=this.tracks,n=s.tracks,o=n?Object.keys(n):null,c=o?o.length:0,d=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(n&&o&&c){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${zs(r,(f,u)=>f==="initSegment"?void 0:u)};
transfer tracks: ${zs(n,(f,u)=>f==="initSegment"?void 0:u)}}`),!bj(n,r)){s.mediaSource=null,s.tracks=void 0;const f=e.currentTime,u=this.details,m=Math.max(f,(u==null?void 0:u.fragments[0].start)||0);if(m-f>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${f} -> ${m}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(n)}"->"${Object.keys(r)}") start time: ${m} currentTime: ${f}`),this.onMediaDetaching(Q.MEDIA_DETACHING,{}),this.onMediaAttaching(Q.MEDIA_ATTACHING,s),e.currentTime=m;return}this.transferData=void 0,o.forEach(f=>{const u=f,m=n[u];if(m){const g=m.buffer;if(g){const x=this.fragmentTracker,b=m.id;if(x.hasFragments(b)||x.hasParts(b)){const S=Zt.getBuffered(g);x.detectEvictedFragments(u,S,b,null,!0)}const v=Bg(u),w=[u,g];this.sourceBuffers[v]=w,g.updating&&this.operationQueue&&this.operationQueue.prependBlocker(u),this.trackSourceBuffer(u,m)}}}),d(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),d()}get mediaSourceOpenOrEnded(){var e;const s=(e=this.mediaSource)==null?void 0:e.readyState;return s==="open"||s==="ended"}onMediaDetaching(e,s){const r=!!s.transferMedia;this.transferData=this.overrides=void 0;const{media:n,mediaSource:o,_objectUrl:c}=this;if(o){if(this.log(`media source ${r?"transferring":"detaching"}`),r)this.sourceBuffers.forEach(([d])=>{d&&this.removeBuffer(d)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const d=o.readyState==="open";try{const f=o.sourceBuffers;for(let u=f.length;u--;)d&&f[u].abort(),o.removeSourceBuffer(f[u]);d&&o.endOfStream()}catch(f){this.warn(`onMediaDetaching: ${f.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}o.removeEventListener("sourceopen",this._onMediaSourceOpen),o.removeEventListener("sourceended",this._onMediaSourceEnded),o.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(o.removeEventListener("startstreaming",this._onStartStreaming),o.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}n&&(n.removeEventListener("emptied",this._onMediaEmptied),r||(c&&self.URL.revokeObjectURL(c),this.mediaSrc===c?(n.removeAttribute("src"),this.appendSource&&Q1(n),n.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(Q.MEDIA_DETACHED,s)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var s;const r=(s=this.tracks[e])==null?void 0:s.buffer;if(this.removeBuffer(e),r)try{var n;(n=this.mediaSource)!=null&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(r)}catch(o){this.warn(`onBufferReset ${e}`,o)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[Bg(e)]=[null,null];const s=this.tracks[e];s&&(s.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new OP(this.tracks)}onBufferCodecs(e,s){var r;const n=this.tracks,o=Object.keys(s);this.log(`BUFFER_CODECS: "${o}" (current SB count ${this.sourceBufferCount})`);const c="audiovideo"in s&&(n.audio||n.video)||n.audiovideo&&("audio"in s||"video"in s),d=!c&&this.sourceBufferCount&&this.media&&o.some(f=>!n[f]);if(c||d){this.warn(`Unsupported transition between "${Object.keys(n)}" and "${o}" SourceBuffers`);return}o.forEach(f=>{var u,m;const g=s[f],{id:x,codec:b,levelCodec:v,container:w,metadata:S,supplemental:T}=g;let k=n[f];const E=(u=this.transferData)==null||(u=u.tracks)==null?void 0:u[f],R=E!=null&&E.buffer?E:k,K=(R==null?void 0:R.pendingCodec)||(R==null?void 0:R.codec),z=R==null?void 0:R.levelCodec;k||(k=n[f]={buffer:void 0,listeners:[],codec:b,supplemental:T,container:w,levelCodec:v,metadata:S,id:x});const D=af(K,z),O=D==null?void 0:D.replace(W1,"$1");let U=af(b,v);const I=(m=U)==null?void 0:m.replace(W1,"$1");U&&D&&O!==I&&(f.slice(0,5)==="audio"&&(U=Nf(U,this.appendSource)),this.log(`switching codec ${K} to ${U}`),U!==(k.pendingCodec||k.codec)&&(k.pendingCodec=U),k.container=w,this.appendChangeType(f,w,U))}),(this.tracksReady||this.sourceBufferCount)&&(s.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!s.video&&((r=s.audio)==null?void 0:r.id)==="main"&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,s)=>{const r=this.tracks[s];return e[s]={id:r.id,container:r.container,codec:r.codec,levelCodec:r.levelCodec},e},{})}appendChangeType(e,s,r){const n=`${s};codecs=${r}`,o={label:`change-type=${n}`,execute:()=>{const c=this.tracks[e];if(c){const d=c.buffer;d!=null&&d.changeType&&(this.log(`changing ${e} sourceBuffer type to ${n}`),d.changeType(n),c.codec=r,c.container=s)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:c=>{this.warn(`Failed to change ${e} SourceBuffer type`,c)}};this.append(o,e,this.isPending(this.tracks[e]))}blockAudio(e){var s;const r=e.start,n=r+e.duration*.05;if(((s=this.fragmentTracker.getAppendedFrag(r,Rt.MAIN))==null?void 0:s.gap)===!0)return;const c={label:"block-audio",execute:()=>{var d;const f=this.tracks.video;(this.lastVideoAppendEnd>n||f!=null&&f.buffer&&Zt.isBuffered(f.buffer,n)||((d=this.fragmentTracker.getAppendedFrag(n,Rt.MAIN))==null?void 0:d.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:d=>{this.warn("Error executing block-audio operation",d)}};this.blockedAudioAppend={op:c,frag:e},this.append(c,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:s}=this;e&&s&&(this.blockedAudioAppend=null,s.unblockAudio(e.op))}onBufferAppending(e,s){const{tracks:r}=this,{data:n,type:o,parent:c,frag:d,part:f,chunkMeta:u,offset:m}=s,g=u.buffering[o],{sn:x,cc:b}=d,v=self.performance.now();g.start=v;const w=d.stats.buffering,S=f?f.stats.buffering:null;w.start===0&&(w.start=v),S&&S.start===0&&(S.start=v);const T=r.audio;let k=!1;o==="audio"&&(T==null?void 0:T.container)==="audio/mpeg"&&(k=!this.lastMpegAudioChunk||u.id===1||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);const E=r.video,R=E==null?void 0:E.buffer;if(R&&x!=="initSegment"){const D=f||d,O=this.blockedAudioAppend;if(o==="audio"&&c!=="main"&&!this.blockedAudioAppend&&!(E.ending||E.ended)){const I=D.start+D.duration*.05,F=R.buffered,te=this.currentOp("video");!F.length&&!te?this.blockAudio(D):!te&&!Zt.isBuffered(R,I)&&this.lastVideoAppendEnd<I&&this.blockAudio(D)}else if(o==="video"){const U=D.end;if(O){const I=O.frag.start;(U>I||U<this.lastVideoAppendEnd||Zt.isBuffered(R,I))&&this.unblockAudio()}this.lastVideoAppendEnd=U}}const K=(f||d).start,z={label:`append-${o}`,execute:()=>{var D;g.executeStart=self.performance.now();const O=(D=this.tracks[o])==null?void 0:D.buffer;O&&(k?this.updateTimestampOffset(O,K,.1,o,x,b):m!==void 0&&Tt(m)&&this.updateTimestampOffset(O,m,1e-6,o,x,b)),this.appendExecutor(n,o)},onStart:()=>{},onComplete:()=>{const D=self.performance.now();g.executeEnd=g.end=D,w.first===0&&(w.first=D),S&&S.first===0&&(S.first=D);const O={};this.sourceBuffers.forEach(([U,I])=>{U&&(O[U]=Zt.getBuffered(I))}),this.appendErrors[o]=0,o==="audio"||o==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(Q.BUFFER_APPENDED,{type:o,frag:d,part:f,chunkMeta:u,parent:d.type,timeRanges:O})},onError:D=>{var O;const U={type:Ft.MEDIA_ERROR,parent:d.type,details:ze.BUFFER_APPEND_ERROR,sourceBufferName:o,frag:d,part:f,chunkMeta:u,error:D,err:D,fatal:!1},I=(O=this.media)==null?void 0:O.error;if(D.code===DOMException.QUOTA_EXCEEDED_ERR||D.name=="QuotaExceededError"||"quota"in D)U.details=ze.BUFFER_FULL_ERROR;else if(D.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!I)U.errorAction=Zl(!0);else if(D.name===_2&&this.sourceBufferCount===0)U.errorAction=Zl(!0);else{const F=++this.appendErrors[o];this.warn(`Failed ${F}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${o}" sourceBuffer (${I||"no media error"})`),(F>=this.hls.config.appendErrorMaxRetry||I)&&(U.fatal=!0)}this.hls.trigger(Q.ERROR,U)}};this.log(`queuing "${o}" append sn: ${x}${f?" p: "+f.index:""} of ${d.type===Rt.MAIN?"level":"track"} ${d.level} cc: ${b}`),this.append(z,o,this.isPending(this.tracks[o]))}getFlushOp(e,s,r){return this.log(`queuing "${e}" remove ${s}-${r}`),{label:"remove",execute:()=>{this.removeExecutor(e,s,r)},onStart:()=>{},onComplete:()=>{this.hls.trigger(Q.BUFFER_FLUSHED,{type:e})},onError:n=>{this.warn(`Failed to remove ${s}-${r} from "${e}" SourceBuffer`,n)}}}onBufferFlushing(e,s){const{type:r,startOffset:n,endOffset:o}=s;r?this.append(this.getFlushOp(r,n,o),r):this.sourceBuffers.forEach(([c])=>{c&&this.append(this.getFlushOp(c,n,o),c)})}onFragParsed(e,s){const{frag:r,part:n}=s,o=[],c=n?n.elementaryStreams:r.elementaryStreams;c[Hs.AUDIOVIDEO]?o.push("audiovideo"):(c[Hs.AUDIO]&&o.push("audio"),c[Hs.VIDEO]&&o.push("video"));const d=()=>{const f=self.performance.now();r.stats.buffering.end=f,n&&(n.stats.buffering.end=f);const u=n?n.stats:r.stats;this.hls.trigger(Q.FRAG_BUFFERED,{frag:r,part:n,stats:u,id:r.type})};o.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${r.type} level: ${r.level} sn: ${r.sn}`),this.blockBuffers(d,o).catch(f=>{this.warn(`Fragment buffered callback ${f}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,s){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{if(e){const s=this.tracks[e];if(s)return!s.ended||s.ending}return!1})}onBufferEos(e,s){var r;this.sourceBuffers.forEach(([c])=>{if(c){const d=this.tracks[c];(!s.type||s.type===c)&&(d.ending=!0,d.ended||(d.ended=!0,this.log(`${c} buffer reached EOS`)))}});const n=((r=this.overrides)==null?void 0:r.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([c])=>{var d;return c&&!((d=this.tracks[c])!=null&&d.ended)})?n?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:c}=this;if(!c||c.readyState!=="open"){c&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${c.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),c.endOfStream(),this.hls.trigger(Q.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(Q.BUFFERED_TO_END,void 0)):s.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const s=this.tracks[e];s&&(s.ending=!1)}})}onLevelUpdated(e,{details:s}){s.fragments.length&&(this.details=s,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,s){if(s.details===ze.BUFFER_APPEND_ERROR&&s.frag){var r;const n=(r=s.errorAction)==null?void 0:r.nextAutoLevel;Tt(n)&&n!==s.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:s,media:r}=this;if(!r||s===null||!this.sourceBufferCount)return;const n=e.config,o=r.currentTime,c=s.levelTargetDuration,d=s.live&&n.liveBackBufferLength!==null?n.liveBackBufferLength:n.backBufferLength;if(Tt(d)&&d>=0){const u=Math.max(d,c),m=Math.floor(o/c)*c-u;this.flushBackBuffer(o,c,m)}const f=n.frontBufferFlushThreshold;if(Tt(f)&&f>0){const u=Math.max(n.maxBufferLength,f),m=Math.max(u,c),g=Math.floor(o/c)*c+m;this.flushFrontBuffer(o,c,g)}}flushBackBuffer(e,s,r){this.sourceBuffers.forEach(([n,o])=>{if(o){const d=Zt.getBuffered(o);if(d.length>0&&r>d.start(0)){var c;this.hls.trigger(Q.BACK_BUFFER_REACHED,{bufferEnd:r});const f=this.tracks[n];if((c=this.details)!=null&&c.live)this.hls.trigger(Q.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r});else if(f!=null&&f.ended){this.log(`Cannot flush ${n} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(Q.BUFFER_FLUSHING,{startOffset:0,endOffset:r,type:n})}}})}flushFrontBuffer(e,s,r){this.sourceBuffers.forEach(([n,o])=>{if(o){const c=Zt.getBuffered(o),d=c.length;if(d<2)return;const f=c.start(d-1),u=c.end(d-1);if(r>f||e>=f&&e<=u)return;this.hls.trigger(Q.BUFFER_FLUSHING,{startOffset:f,endOffset:1/0,type:n})}})}getDurationAndRange(){var e;const{details:s,mediaSource:r}=this;if(!s||!this.media||(r==null?void 0:r.readyState)!=="open")return null;const n=s.edge;if(s.live&&this.hls.config.liveDurationInfinity){if(s.fragments.length&&r.setLiveSeekableRange){const u=Math.max(0,s.fragmentStart),m=Math.max(u,n);return{duration:1/0,start:u,end:m}}return{duration:1/0}}const o=(e=this.overrides)==null?void 0:e.duration;if(o)return Tt(o)?{duration:o}:null;const c=this.media.duration,d=Tt(r.duration)?r.duration:0;return n>d&&n>c||!Tt(c)?{duration:n}:null}updateMediaSource({duration:e,start:s,end:r}){const n=this.mediaSource;!this.media||!n||n.readyState!=="open"||(n.duration!==e&&(Tt(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),n.duration=e),s!==void 0&&r!==void 0&&(this.log(`MediaSource duration is set to ${n.duration}. Setting seekable range to ${s}-${r}.`),n.setLiveSeekableRange(s,r)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:s,tracks:r}=this;if(this.log(`checkPendingTracks (pending: ${s} codec events expected: ${e}) ${zs(r)}`),this.tracksReady){var n;const o=(n=this.transferData)==null?void 0:n.tracks;o&&Object.keys(o).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([s,r])=>{if(s){const n=this.tracks[s];e[s]={buffer:r,container:n.container,codec:n.codec,supplemental:n.supplemental,levelCodec:n.levelCodec,id:n.id,metadata:n.metadata}}}),this.hls.trigger(Q.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([s])=>{this.executeNext(s)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(Q.ERROR,{type:Ft.MEDIA_ERROR,details:ze.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:s,mediaSource:r}=this;if(!r)throw new Error("createSourceBuffers called when mediaSource was null");for(const o in e){const c=o,d=e[c];if(this.isPending(d)){const f=this.getTrackCodec(d,c),u=`${d.container};codecs=${f}`;d.codec=f,this.log(`creating sourceBuffer(${u})${this.currentOp(c)?" Queued":""} ${zs(d)}`);try{const m=r.addSourceBuffer(u),g=Bg(c),x=[c,m];s[g]=x,d.buffer=m}catch(m){var n;this.error(`error while trying to add sourceBuffer: ${m.message}`),this.shiftAndExecuteNext(c),(n=this.operationQueue)==null||n.removeBlockers(),delete this.tracks[c],this.hls.trigger(Q.ERROR,{type:Ft.MEDIA_ERROR,details:ze.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:m,sourceBufferName:c,mimeType:u,parent:d.id});return}this.trackSourceBuffer(c,d)}}this.bufferCreated()}getTrackCodec(e,s){const r=e.supplemental;let n=e.codec;r&&(s==="video"||s==="audiovideo")&&Bd(r,"video")&&(n=CM(n,r));const o=af(n,e.levelCodec);return o?s.slice(0,5)==="audio"?Nf(o,this.appendSource):o:""}trackSourceBuffer(e,s){const r=s.buffer;if(!r)return;const n=this.getTrackCodec(s,e);this.tracks[e]={buffer:r,codec:n,container:s.container,levelCodec:s.levelCodec,supplemental:s.supplemental,metadata:s.metadata,id:s.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(o,c)=>{const d=c.removedRanges;d!=null&&d.length&&this.hls.trigger(Q.BUFFER_FLUSHED,{type:o})})}get mediaSrc(){var e,s;const r=((e=this.media)==null||(s=e.querySelector)==null?void 0:s.call(e,"source"))||this.media;return r==null?void 0:r.src}onSBUpdateStart(e){const s=this.currentOp(e);s&&s.onStart()}onSBUpdateEnd(e){var s;if(((s=this.mediaSource)==null?void 0:s.readyState)==="closed"){this.resetBuffer(e);return}const r=this.currentOp(e);r&&(r.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,s){var r;const n=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(r=this.mediaSource)==null?void 0:r.readyState}`);this.error(`${n}`,s),this.hls.trigger(Q.ERROR,{type:Ft.MEDIA_ERROR,details:ze.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:n,fatal:!1});const o=this.currentOp(e);o&&o.onError(n)}updateTimestampOffset(e,s,r,n,o,c){const d=s-e.timestampOffset;Math.abs(d)>=r&&(this.log(`Updating ${n} SourceBuffer timestampOffset to ${s} (sn: ${o} cc: ${c})`),e.timestampOffset=s)}removeExecutor(e,s,r){const{media:n,mediaSource:o}=this,c=this.tracks[e],d=c==null?void 0:c.buffer;if(!n||!o||!d){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const f=Tt(n.duration)?n.duration:1/0,u=Tt(o.duration)?o.duration:1/0,m=Math.max(0,s),g=Math.min(r,f,u);g>m&&(!c.ending||c.ended)?(c.ended=!1,this.log(`Removing [${m},${g}] from the ${e} SourceBuffer`),d.remove(m,g)):this.shiftAndExecuteNext(e)}appendExecutor(e,s){const r=this.tracks[s],n=r==null?void 0:r.buffer;if(!n)throw new FP(`Attempting to append to the ${s} SourceBuffer, but it does not exist`);r.ending=!1,r.ended=!1,n.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(s=>{this.warn(`SourceBuffer blocked callback ${s}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(s){this.warn(`Callback run without blocking ${this.operationQueue} ${s}`)}}isUpdating(){return this.sourceBuffers.some(([e,s])=>e&&s.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,s=this.sourceBufferTypes){if(!s.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:r}=this,n=s.map(c=>this.appendBlocker(c));return s.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(n).then(c=>{r===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(s=>{var r;const n=(r=this.tracks[s])==null?void 0:r.buffer;!n||n.updating||this.shiftAndExecuteNext(s)})}append(e,s,r){this.operationQueue&&this.operationQueue.append(e,s,r)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,s)=>e+(this.isPending(this.tracks[s])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[s])=>e+(s?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,s,r){const n=this.tracks[e];if(!n)return;const o=n.buffer;if(!o)return;const c=r.bind(this,e);n.listeners.push({event:s,listener:c}),o.addEventListener(s,c)}removeBufferListeners(e){const s=this.tracks[e];if(!s)return;const r=s.buffer;r&&(s.listeners.forEach(n=>{r.removeEventListener(n.event,n.listener)}),s.listeners.length=0)}}function Q1(a){const e=a.querySelectorAll("source");[].slice.call(e).forEach(s=>{a.removeChild(s)})}function UP(a,e){const s=self.document.createElement("source");s.type="video/mp4",s.src=e,a.appendChild(s)}function Bg(a){return a==="audio"?1:0}class Yx{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(Q.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(Q.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Q.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Q.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Q.BUFFER_CODECS,this.onBufferCodecs,this),e.on(Q.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(Q.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(Q.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Q.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Q.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Q.BUFFER_CODECS,this.onBufferCodecs,this),e.off(Q.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,s){const r=this.hls.levels[s.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})}onMediaAttaching(e,s){this.media=s.media instanceof HTMLVideoElement?s.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,s){const r=this.hls;this.restrictedLevels=[],this.firstLevel=s.firstLevel,r.config.capLevelToPlayerSize&&s.video&&this.startCapping()}onLevelsUpdated(e,s){this.timer&&Tt(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,s){this.hls.config.capLevelToPlayerSize&&s.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const s=this.hls,r=this.getMaxLevel(e.length-1);r!==this.autoLevelCapping&&s.logger.log(`Setting autoLevelCapping to ${r}: ${e[r].height}p@${e[r].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),s.autoLevelCapping=r,s.autoLevelEnabled&&s.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=s.autoLevelCapping}}}getMaxLevel(e){const s=this.hls.levels;if(!s.length)return-1;const r=s.filter((n,o)=>this.isLevelAllowed(n)&&o<=e);return this.clientRect=null,Yx.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,s={width:0,height:0};if(e){const r=e.getBoundingClientRect();s.width=r.width,s.height=r.height,!s.width&&!s.height&&(s.width=r.right-r.left||e.width||0,s.height=r.bottom-r.top||e.height||0)}return this.clientRect=s,s}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(r=>e.bitrate===r.bitrate&&e.width===r.width&&e.height===r.height)}static getMaxLevelByMediaSize(e,s,r){if(!(e!=null&&e.length))return-1;const n=(d,f)=>f?d.width!==f.width||d.height!==f.height:!0;let o=e.length-1;const c=Math.max(s,r);for(let d=0;d<e.length;d+=1){const f=e[d];if((f.width>=c||f.height>=c)&&n(f,e[d+1])){o=d;break}}return o}}const $P={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},ta=$P,GP={HLS:"h"},HP=GP;class An{constructor(e,s){Array.isArray(e)&&(e=e.map(r=>r instanceof An?r:new An(r))),this.value=e,this.params=s}}const VP="Dict";function zP(a){return Array.isArray(a)?JSON.stringify(a):a instanceof Map?"Map{}":a instanceof Set?"Set{}":typeof a=="object"?JSON.stringify(a):String(a)}function qP(a,e,s,r){return new Error(`failed to ${a} "${zP(e)}" as ${s}`,{cause:r})}function Cn(a,e,s){return qP("serialize",a,e,s)}class N2{constructor(e){this.description=e}}const X1="Bare Item",KP="Boolean";function YP(a){if(typeof a!="boolean")throw Cn(a,KP);return a?"?1":"?0"}function WP(a){return btoa(String.fromCharCode(...a))}const QP="Byte Sequence";function XP(a){if(ArrayBuffer.isView(a)===!1)throw Cn(a,QP);return`:${WP(a)}:`}const ZP="Integer";function JP(a){return a<-999999999999999||999999999999999<a}function j2(a){if(JP(a))throw Cn(a,ZP);return a.toString()}function eO(a){return`@${j2(a.getTime()/1e3)}`}function E2(a,e){if(a<0)return-E2(-a,e);const s=Math.pow(10,e);if(Math.abs(a*s%1-.5)<Number.EPSILON){const n=Math.floor(a*s);return(n%2===0?n:n+1)/s}else return Math.round(a*s)/s}const tO="Decimal";function sO(a){const e=E2(a,3);if(Math.floor(Math.abs(e)).toString().length>12)throw Cn(a,tO);const s=e.toString();return s.includes(".")?s:`${s}.0`}const rO="String",aO=/[\x00-\x1f\x7f]+/;function nO(a){if(aO.test(a))throw Cn(a,rO);return`"${a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function iO(a){return a.description||a.toString().slice(7,-1)}const oO="Token";function Z1(a){const e=iO(a);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw Cn(e,oO);return e}function Kp(a){switch(typeof a){case"number":if(!Tt(a))throw Cn(a,X1);return Number.isInteger(a)?j2(a):sO(a);case"string":return nO(a);case"symbol":return Z1(a);case"boolean":return YP(a);case"object":if(a instanceof Date)return eO(a);if(a instanceof Uint8Array)return XP(a);if(a instanceof N2)return Z1(a);default:throw Cn(a,X1)}}const lO="Key";function Yp(a){if(/^[a-z*][a-z0-9\-_.*]*$/.test(a)===!1)throw Cn(a,lO);return a}function Wx(a){return a==null?"":Object.entries(a).map(([e,s])=>s===!0?`;${Yp(e)}`:`;${Yp(e)}=${Kp(s)}`).join("")}function T2(a){return a instanceof An?`${Kp(a.value)}${Wx(a.params)}`:Kp(a)}function cO(a){return`(${a.value.map(T2).join(" ")})${Wx(a.params)}`}function dO(a,e={whitespace:!0}){if(typeof a!="object"||a==null)throw Cn(a,VP);const s=a instanceof Map?a.entries():Object.entries(a),r=e!=null&&e.whitespace?" ":"";return Array.from(s).map(([n,o])=>{o instanceof An||(o=new An(o));let c=Yp(n);return o.value===!0?c+=Wx(o.params):(c+="=",Array.isArray(o.value)?c+=cO(o):c+=T2(o)),c}).join(`,${r}`)}function A2(a,e){return dO(a,e)}const pn="CMCD-Object",ir="CMCD-Request",Do="CMCD-Session",$i="CMCD-Status",uO={br:pn,ab:pn,d:pn,ot:pn,tb:pn,tpb:pn,lb:pn,tab:pn,lab:pn,url:pn,pb:ir,bl:ir,tbl:ir,dl:ir,ltc:ir,mtp:ir,nor:ir,nrr:ir,rc:ir,sn:ir,sta:ir,su:ir,ttfb:ir,ttfbb:ir,ttlb:ir,cmsdd:ir,cmsds:ir,smrt:ir,df:ir,cs:ir,ts:ir,cid:Do,pr:Do,sf:Do,sid:Do,st:Do,v:Do,msd:Do,bs:$i,bsd:$i,cdn:$i,rtp:$i,bg:$i,pt:$i,ec:$i,e:$i},hO={REQUEST:ir};function fO(a){return Object.keys(a).reduce((e,s)=>{var r;return(r=a[s])===null||r===void 0||r.forEach(n=>e[n]=s),e},{})}function mO(a,e){const s={};if(!a)return s;const r=Object.keys(a),n=e?fO(e):{};return r.reduce((o,c)=>{var d;const f=uO[c]||n[c]||hO.REQUEST,u=(d=o[f])!==null&&d!==void 0?d:o[f]={};return u[c]=a[c],o},s)}function gO(a){return["ot","sf","st","e","sta"].includes(a)}function pO(a){return typeof a=="number"?Tt(a):a!=null&&a!==""&&a!==!1}const C2="event";function xO(a,e){const s=new URL(a),r=new URL(e);if(s.origin!==r.origin)return a;const n=s.pathname.split("/").slice(1),o=r.pathname.split("/").slice(1,-1);for(;n[0]===o[0];)n.shift(),o.shift();for(;o.length;)o.shift(),n.unshift("..");return n.join("/")+s.search+s.hash}const df=a=>Math.round(a),Wp=(a,e)=>Array.isArray(a)?a.map(s=>Wp(s,e)):a instanceof An&&typeof a.value=="string"?new An(Wp(a.value,e),a.params):(e.baseUrl&&(a=xO(a,e.baseUrl)),e.version===1?encodeURIComponent(a):a),Fh=a=>df(a/100)*100,yO=(a,e)=>{let s=a;return e.version>=2&&(a instanceof An&&typeof a.value=="string"?s=new An([a]):typeof a=="string"&&(s=[a])),Wp(s,e)},bO={br:df,d:df,bl:Fh,dl:Fh,mtp:Fh,nor:yO,rtp:Fh,tb:df},k2="request",R2="response",Qx=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],vO=["e"],wO=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function tm(a){return wO.test(a)}function SO(a){return Qx.includes(a)||vO.includes(a)||tm(a)}const L2=["d","dl","nor","ot","rtp","su"];function _O(a){return Qx.includes(a)||L2.includes(a)||tm(a)}const NO=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function jO(a){return Qx.includes(a)||L2.includes(a)||NO.includes(a)||tm(a)}const EO=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function TO(a){return EO.includes(a)||tm(a)}const AO={[R2]:jO,[C2]:SO,[k2]:_O};function D2(a,e={}){const s={};if(a==null||typeof a!="object")return s;const r=e.version||a.v||1,n=e.reportingMode||k2,o=r===1?TO:AO[n];let c=Object.keys(a).filter(o);const d=e.filter;typeof d=="function"&&(c=c.filter(d));const f=n===R2||n===C2;f&&!c.includes("ts")&&c.push("ts"),r>1&&!c.includes("v")&&c.push("v");const u=Us({},bO,e.formatters),m={version:r,reportingMode:n,baseUrl:e.baseUrl};return c.sort().forEach(g=>{let x=a[g];const b=u[g];if(typeof b=="function"&&(x=b(x,m)),g==="v"){if(r===1)return;x=r}g=="pr"&&x===1||(f&&g==="ts"&&!Tt(x)&&(x=Date.now()),pO(x)&&(gO(g)&&typeof x=="string"&&(x=new N2(x)),s[g]=x))}),s}function CO(a,e={}){const s={};if(!a)return s;const r=D2(a,e),n=mO(r,e==null?void 0:e.customHeaderMap);return Object.entries(n).reduce((o,[c,d])=>{const f=A2(d,{whitespace:!1});return f&&(o[c]=f),o},s)}function kO(a,e,s){return Us(a,CO(e,s))}const RO="CMCD";function LO(a,e={}){return a?A2(D2(a,e),{whitespace:!1}):""}function DO(a,e={}){if(!a)return"";const s=LO(a,e);return encodeURIComponent(s)}function IO(a,e={}){if(!a)return"";const s=DO(a,e);return`${RO}=${s}`}const J1=/CMCD=[^&#]+/;function MO(a,e,s){const r=IO(e,s);if(!r)return a;if(J1.test(a))return a.replace(J1,r);const n=a.includes("?")?"&":"?";return`${a}${n}${r}`}class PO{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=n=>{try{this.apply(n,{ot:ta.MANIFEST,su:!this.initialized})}catch(o){this.hls.logger.warn("Could not generate manifest CMCD data.",o)}},this.applyFragmentData=n=>{try{const{frag:o,part:c}=n,d=this.hls.levels[o.level],f=this.getObjectType(o),u={d:(c||o).duration*1e3,ot:f};(f===ta.VIDEO||f===ta.AUDIO||f==ta.MUXED)&&(u.br=d.bitrate/1e3,u.tb=this.getTopBandwidth(f)/1e3,u.bl=this.getBufferLength(f));const m=c?this.getNextPart(c):this.getNextFrag(o);m!=null&&m.url&&m.url!==o.url&&(u.nor=m.url),this.apply(n,u)}catch(o){this.hls.logger.warn("Could not generate segment CMCD data.",o)}},this.hls=e;const s=this.config=e.config,{cmcd:r}=s;r!=null&&(s.pLoader=this.createPlaylistLoader(),s.fLoader=this.createFragmentLoader(),this.sid=r.sessionId||e.sessionId,this.cid=r.contentId,this.useHeaders=r.useHeaders===!0,this.includeKeys=r.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(Q.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Q.MEDIA_DETACHED,this.onMediaDetached,this),e.on(Q.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(Q.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Q.MEDIA_DETACHED,this.onMediaDetached,this),e.off(Q.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,s){this.media=s.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,s){var r,n;this.audioBuffer=(r=s.tracks.audio)==null?void 0:r.buffer,this.videoBuffer=(n=s.tracks.video)==null?void 0:n.buffer}createData(){var e;return{v:1,sf:HP.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,s={}){Us(s,this.createData());const r=s.ot===ta.INIT||s.ot===ta.VIDEO||s.ot===ta.MUXED;this.starved&&r&&(s.bs=!0,s.su=!0,this.starved=!1),s.su==null&&(s.su=this.buffering);const{includeKeys:n}=this;n&&(s=Object.keys(s).reduce((c,d)=>(n.includes(d)&&(c[d]=s[d]),c),{}));const o={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),kO(e.headers,s,o)):e.url=MO(e.url,s,o)}getNextFrag(e){var s;const r=(s=this.hls.levels[e.level])==null?void 0:s.details;if(r){const n=e.sn-r.startSN;return r.fragments[n+1]}}getNextPart(e){var s;const{index:r,fragment:n}=e,o=(s=this.hls.levels[n.level])==null||(s=s.details)==null?void 0:s.partList;if(o){const{sn:c}=n;for(let d=o.length-1;d>=0;d--){const f=o[d];if(f.index===r&&f.fragment.sn===c)return o[d+1]}}}getObjectType(e){const{type:s}=e;if(s==="subtitle")return ta.TIMED_TEXT;if(e.sn==="initSegment")return ta.INIT;if(s==="audio")return ta.AUDIO;if(s==="main")return this.hls.audioTracks.length?ta.VIDEO:ta.MUXED}getTopBandwidth(e){let s=0,r;const n=this.hls;if(e===ta.AUDIO)r=n.audioTracks;else{const o=n.maxAutoLevel,c=o>-1?o+1:n.levels.length;r=n.levels.slice(0,c)}return r.forEach(o=>{o.bitrate>s&&(s=o.bitrate)}),s>0?s:NaN}getBufferLength(e){const s=this.media,r=e===ta.AUDIO?this.audioBuffer:this.videoBuffer;return!r||!s?NaN:Zt.bufferInfo(r,s.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,s=this.applyPlaylistData,r=e||this.config.loader;return class{constructor(o){this.loader=void 0,this.loader=new r(o)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(o,c,d){s(o),this.loader.load(o,c,d)}}}createFragmentLoader(){const{fLoader:e}=this.config,s=this.applyFragmentData,r=e||this.config.loader;return class{constructor(o){this.loader=void 0,this.loader=new r(o)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(o,c,d){s(o),this.loader.load(o,c,d)}}}}const OO=3e5;class FO extends qa{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Q.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Q.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Q.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Q.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Q.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Q.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,s)=>(e.indexOf(s.pathwayId)===-1&&e.push(s.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const s=this.levels;s&&(this.levels=s.filter(r=>r!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,s){const{contentSteering:r}=s;r!==null&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())}onManifestParsed(e,s){this.audioTracks=s.audioTracks,this.subtitleTracks=s.subtitleTracks}onError(e,s){const{errorAction:r}=s;if((r==null?void 0:r.action)===Dr.SendAlternateToPenaltyBox&&r.flags===wa.MoveAllAlternatesMatchingHost){const n=this.levels;let o=this._pathwayPriority,c=this.pathwayId;if(s.context){const{groupId:d,pathwayId:f,type:u}=s.context;d&&n?c=this.getPathwayForGroupId(d,u,c):f&&(c=f)}c in this.penalizedPathways||(this.penalizedPathways[c]=performance.now()),!o&&n&&(o=this.pathways()),o&&o.length>1&&(this.updatePathwayPriority(o),r.resolved=this.pathwayId!==c),s.details===ze.BUFFER_APPEND_ERROR&&!s.fatal?r.resolved=!0:r.resolved||this.warn(`Could not resolve ${s.details} ("${s.error.message}") with content-steering for Pathway: ${c} levels: ${n&&n.length} priorities: ${zs(o)} penalized: ${zs(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let s=this.getLevelsForPathway(this.pathwayId);if(s.length===0){const r=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${r}"`),s=this.getLevelsForPathway(r),this.pathwayId=r}return s.length!==e.length&&this.log(`Found ${s.length}/${e.length} levels in Pathway "${this.pathwayId}"`),s}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(s=>e===s.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let s;const r=this.penalizedPathways,n=performance.now();Object.keys(r).forEach(o=>{n-r[o]>OO&&delete r[o]});for(let o=0;o<e.length;o++){const c=e[o];if(c in r)continue;if(c===this.pathwayId)return;const d=this.hls.nextLoadLevel,f=this.hls.levels[d];if(s=this.getLevelsForPathway(c),s.length>0){this.log(`Setting Pathway to "${c}"`),this.pathwayId=c,Jj(s),this.hls.trigger(Q.LEVELS_UPDATED,{levels:s});const u=this.hls.levels[d];f&&u&&this.levels&&(u.attrs["STABLE-VARIANT-ID"]!==f.attrs["STABLE-VARIANT-ID"]&&u.bitrate!==f.bitrate&&this.log(`Unstable Pathways change from bitrate ${f.bitrate} to ${u.bitrate}`),this.hls.nextLoadLevel=d);break}}}getPathwayForGroupId(e,s,r){const n=this.getLevelsForPathway(r).concat(this.levels||[]);for(let o=0;o<n.length;o++)if(s===us.AUDIO_TRACK&&n[o].hasAudioGroup(e)||s===us.SUBTITLE_TRACK&&n[o].hasSubtitleGroup(e))return n[o].pathwayId;return r}clonePathways(e){const s=this.levels;if(!s)return;const r={},n={};e.forEach(o=>{const{ID:c,"BASE-ID":d,"URI-REPLACEMENT":f}=o;if(s.some(m=>m.pathwayId===c))return;const u=this.getLevelsForPathway(d).map(m=>{const g=new tr(m.attrs);g["PATHWAY-ID"]=c;const x=g.AUDIO&&`${g.AUDIO}_clone_${c}`,b=g.SUBTITLES&&`${g.SUBTITLES}_clone_${c}`;x&&(r[g.AUDIO]=x,g.AUDIO=x),b&&(n[g.SUBTITLES]=b,g.SUBTITLES=b);const v=I2(m.uri,g["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",f),w=new $d({attrs:g,audioCodec:m.audioCodec,bitrate:m.bitrate,height:m.height,name:m.name,url:v,videoCodec:m.videoCodec,width:m.width});if(m.audioGroups)for(let S=1;S<m.audioGroups.length;S++)w.addGroupId("audio",`${m.audioGroups[S]}_clone_${c}`);if(m.subtitleGroups)for(let S=1;S<m.subtitleGroups.length;S++)w.addGroupId("text",`${m.subtitleGroups[S]}_clone_${c}`);return w});s.push(...u),e_(this.audioTracks,r,f,c),e_(this.subtitleTracks,n,f,c)})}loadSteeringManifest(e){const s=this.hls.config,r=s.loader;this.loader&&this.loader.destroy(),this.loader=new r(s);let n;try{n=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(n.protocol!=="data:"){const m=(this.hls.bandwidthEstimate||s.abrEwmaDefaultEstimate)|0;n.searchParams.set("_HLS_pathway",this.pathwayId),n.searchParams.set("_HLS_throughput",""+m)}const o={responseType:"json",url:n.href},c=s.steeringManifestLoadPolicy.default,d=c.errorRetry||c.timeoutRetry||{},f={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:d.maxNumRetry||0,retryDelay:d.retryDelayMs||0,maxRetryDelay:d.maxRetryDelayMs||0},u={onSuccess:(m,g,x,b)=>{this.log(`Loaded steering manifest: "${n}"`);const v=m.data;if((v==null?void 0:v.VERSION)!==1){this.log(`Steering VERSION ${v.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=v.TTL;const{"RELOAD-URI":w,"PATHWAY-CLONES":S,"PATHWAY-PRIORITY":T}=v;if(w)try{this.uri=new self.URL(w,n).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${w}`);return}this.scheduleRefresh(this.uri||x.url),S&&this.clonePathways(S);const k={steeringManifest:v,url:n.toString()};this.hls.trigger(Q.STEERING_MANIFEST_LOADED,k),T&&this.updatePathwayPriority(T)},onError:(m,g,x,b)=>{if(this.log(`Error loading steering manifest: ${m.code} ${m.text} (${g.url})`),this.stopLoad(),m.code===410){this.enabled=!1,this.log(`Steering manifest ${g.url} no longer available`);return}let v=this.timeToLoad*1e3;if(m.code===429){const w=this.loader;if(typeof(w==null?void 0:w.getResponseHeader)=="function"){const S=w.getResponseHeader("Retry-After");S&&(v=parseFloat(S)*1e3)}this.log(`Steering manifest ${g.url} rate limited`);return}this.scheduleRefresh(this.uri||g.url,v)},onTimeout:(m,g,x)=>{this.log(`Timeout loading steering manifest (${g.url})`),this.scheduleRefresh(this.uri||g.url)}};this.log(`Requesting steering manifest: ${n}`),this.loader.load(o,f,u)}scheduleRefresh(e,s=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var r;const n=(r=this.hls)==null?void 0:r.media;if(n&&!n.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},s)}}function e_(a,e,s,r){a&&Object.keys(e).forEach(n=>{const o=a.filter(c=>c.groupId===n).map(c=>{const d=Us({},c);return d.details=void 0,d.attrs=new tr(d.attrs),d.url=d.attrs.URI=I2(c.url,c.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",s),d.groupId=d.attrs["GROUP-ID"]=e[n],d.attrs["PATHWAY-ID"]=r,d});a.push(...o)})}function I2(a,e,s,r){const{HOST:n,PARAMS:o,[s]:c}=r;let d;e&&(d=c==null?void 0:c[e],d&&(a=d));const f=new self.URL(a);return n&&!d&&(f.host=n),o&&Object.keys(o).sort().forEach(u=>{u&&f.searchParams.set(u,o[u])}),f.href}class ec extends qa{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.mediaResolved=void 0,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=ec.CDMCleanupPromise?[ec.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=s=>{const{initDataType:r,initData:n}=s,o=`"${s.type}" event: init data type: "${r}"`;if(this.debug(o),n!==null){if(!this.keyFormatPromise){let c=Object.keys(this.keySystemAccessPromises);c.length||(c=Ad(this.config));const d=c.map(Rg).filter(f=>!!f);this.keyFormatPromise=this.getKeyFormatPromise(d)}this.keyFormatPromise.then(c=>{const d=of(c);if(r!=="sinf"||d!==sr.FAIRPLAY){this.log(`Ignoring "${s.type}" event with init data type: "${r}" for selected key-system ${d}`);return}let f;try{const b=wr(new Uint8Array(n)),v=Fx(JSON.parse(b).sinf),w=Aj(v);if(!w)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");f=new Uint8Array(w.subarray(8,24))}catch(b){this.warn(`${o} Failed to parse sinf: ${b}`);return}const u=Ir(f),{keyIdToKeySessionPromise:m,mediaKeySessions:g}=this;let x=m[u];for(let b=0;b<g.length;b++){const v=g[b],w=v.decryptdata;if(!w.keyId)continue;const S=Ir(w.keyId);if(Cf(f,w.keyId)||w.uri.replace(/-/g,"").indexOf(u)!==-1){if(x=m[S],!x)continue;if(w.pssh)break;delete m[S],w.pssh=new Uint8Array(n),w.keyId=f,x=m[u]=x.then(()=>this.generateRequestWithPreferredKeySession(v,r,n,"encrypted-event-key-match")),x.catch(T=>this.handleError(T));break}}x||this.handleError(new Error(`Key ID ${u} not encountered in playlist. Key-system sessions ${g.length}.`))}).catch(c=>this.handleError(c))}},this.onWaitingForKey=s=>{this.log(`"${s.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(Q.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(Q.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(Q.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(Q.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(Q.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(Q.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(Q.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(Q.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(Q.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(Q.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:s,widevineLicenseUrl:r}=this.config,n=s==null?void 0:s[e];if(n)return n.licenseUrl;if(e===sr.WIDEVINE&&r)return r}getLicenseServerUrlOrThrow(e){const s=this.getLicenseServerUrl(e);if(s===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return s}getServerCertificateUrl(e){const{drmSystems:s}=this.config,r=s==null?void 0:s[e];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const s=this.hls.levels,r=(c,d,f)=>!!c&&f.indexOf(c)===d,n=s.map(c=>c.audioCodec).filter(r),o=s.map(c=>c.videoCodec).filter(r);return n.length+o.length===0&&o.push("avc1.42e01e"),new Promise((c,d)=>{const f=u=>{const m=u.shift();this.getMediaKeysPromise(m,n,o).then(g=>c({keySystem:m,mediaKeys:g})).catch(g=>{u.length?f(u):g instanceof va?d(g):d(new va({type:Ft.KEY_SYSTEM_ERROR,details:ze.KEY_SYSTEM_NO_ACCESS,error:g,fatal:!0},g.message))})};f(e)})}requestMediaKeySystemAccess(e,s){const{requestMediaKeySystemAccessFunc:r}=this.config;if(typeof r!="function"){let n=`Configured requestMediaKeySystemAccess is not a function ${r}`;return zj===null&&self.location.protocol==="http:"&&(n=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(n))}return r(e,s)}getMediaKeysPromise(e,s,r){var n;const o=y6(e,s,r,this.config.drmSystemOptions||{});let c=this.keySystemAccessPromises[e],d=(n=c)==null?void 0:n.keySystemAccess;if(!d){this.log(`Requesting encrypted media "${e}" key-system access with config: ${zs(o)}`),d=this.requestMediaKeySystemAccess(e,o);const f=c=this.keySystemAccessPromises[e]={keySystemAccess:d};return d.catch(u=>{this.log(`Failed to obtain access to key-system "${e}": ${u}`)}),d.then(u=>{this.log(`Access for key-system "${u.keySystem}" obtained`);const m=this.fetchServerCertificate(e);this.log(`Create media-keys for "${e}"`);const g=f.mediaKeys=u.createMediaKeys().then(x=>(this.log(`Media-keys created for "${e}"`),f.hasMediaKeys=!0,m.then(b=>b?this.setMediaKeysServerCertificate(x,e,b):x)));return g.catch(x=>{this.error(`Failed to create media-keys for "${e}"}: ${x}`)}),g})}return d.then(()=>c.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:s,mediaKeys:r}){this.log(`Creating key-system session "${s}" keyId: ${Ir(e.keyId||[])} keyUri: ${e.uri}`);const n=r.createSession(),o={decryptdata:e,keySystem:s,mediaKeys:r,mediaKeysSession:n,keyStatus:"status-pending"};return this.mediaKeySessions.push(o),o}renewKeySession(e){const s=e.decryptdata;if(s.pssh){const r=this.createMediaKeySessionContext(e),n=Bh(s),o="cenc";this.keyIdToKeySessionPromise[n]=this.generateRequestWithPreferredKeySession(r,o,s.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}updateKeySession(e,s){const r=e.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyId ${Ir(e.decryptdata.keyId||[])}
      } (data length: ${s.byteLength})`),r.update(s)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>Rg(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:s,mediaKeys:r})=>this.attemptSetMediaKeys(s,r))}selectKeySystem(e){return new Promise((s,r)=>{this.getKeySystemSelectionPromise(e).then(({keySystem:n})=>{const o=Rg(n);o?s(o):r(new Error(`Unable to find format for key-system "${n}"`))}).catch(r)})}selectKeySystemFormat(e){const s=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${s.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(s)),this.keyFormatPromise}getKeyFormatPromise(e){const s=Ad(this.config),r=e.map(of).filter(n=>!!n&&s.indexOf(n)!==-1);return this.selectKeySystem(r)}getKeyStatus(e){const{mediaKeySessions:s}=this;for(let r=0;r<s.length;r++){const n=BO(e,s[r]);if(n)return n}}loadKey(e){const s=e.keyInfo.decryptdata,r=Bh(s),n=this.bannedKeyIds[r];if(n||this.getKeyStatus(s)==="internal-error"){const d=t_(n||"internal-error",s);return this.handleError(d,e.frag),Promise.reject(d)}const o=`(keyId: ${r} format: "${s.keyFormat}" method: ${s.method} uri: ${s.uri})`;this.log(`Starting session for key ${o}`);const c=this.keyIdToKeySessionPromise[r];if(!c){const d=this.getKeySystemForKeyPromise(s).then(({keySystem:f,mediaKeys:u})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${o}`),this.attemptSetMediaKeys(f,u).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:f,mediaKeys:u,decryptdata:s}))))).then(f=>{const u="cenc",m=s.pssh?s.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(f,u,m,"playlist-key")});return d.catch(f=>this.handleError(f,e.frag)),this.keyIdToKeySessionPromise[r]=d,d}return c.catch(d=>{if(d instanceof va){const f=Is({},d.data);this.getKeyStatus(s)==="internal-error"&&(f.decryptdata=s);const u=new va(f,d.message);this.handleError(u,e.frag)}}),c}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e,s){if(this.hls)if(e instanceof va){s&&(e.data.frag=s);const r=e.data.decryptdata;this.error(`${e.message}${r?` (${Ir(r.keyId||[])})`:""}`),this.hls.trigger(Q.ERROR,e.data)}else this.error(e.message),this.hls.trigger(Q.ERROR,{type:Ft.KEY_SYSTEM_ERROR,details:ze.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0})}getKeySystemForKeyPromise(e){const s=Bh(e),r=this.keyIdToKeySessionPromise[s];if(!r){const n=of(e.keyFormat),o=n?[n]:Ad(this.config);return this.attemptKeySystemAccess(o)}return r}getKeySystemSelectionPromise(e){if(e.length||(e=Ad(this.config)),e.length===0)throw new va({type:Ft.KEY_SYSTEM_ERROR,details:ze.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${zs({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,s){if(this.mediaResolved=void 0,this.mediaKeys===s)return Promise.resolve();const r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const n=Promise.all(r).then(()=>this.media?this.media.setMediaKeys(s):new Promise((o,c)=>{this.mediaResolved=()=>{if(this.mediaResolved=void 0,!this.media)return c(new Error("Attempted to set mediaKeys without media element attached"));this.mediaKeys=s,this.media.setMediaKeys(s).then(o).catch(c)}}));return this.mediaKeys=s,this.setMediaKeysQueue.push(n),n.then(()=>{this.log(`Media-keys set for "${e}"`),r.push(n),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(o=>r.indexOf(o)===-1)})}generateRequestWithPreferredKeySession(e,s,r,n){var o;const c=(o=this.config.drmSystems)==null||(o=o[e.keySystem])==null?void 0:o.generateRequest;if(c)try{const v=c.call(this.hls,s,r,e);if(!v)throw new Error("Invalid response from configured generateRequest filter");s=v.initDataType,r=v.initData?v.initData:null,e.decryptdata.pssh=r?new Uint8Array(r):null}catch(v){if(this.warn(v.message),this.hls&&this.hls.config.debug)throw v}if(r===null)return this.log(`Skipping key-session request for "${n}" (no initData)`),Promise.resolve(e);const d=Bh(e.decryptdata),f=e.decryptdata.uri;this.log(`Generating key-session request for "${n}" keyId: ${d} URI: ${f} (init data type: ${s} length: ${r.byteLength})`);const u=new Ux,m=e._onmessage=v=>{const w=e.mediaKeysSession;if(!w){u.emit("error",new Error("invalid state"));return}const{messageType:S,message:T}=v;this.log(`"${S}" message event for session "${w.sessionId}" message size: ${T.byteLength}`),S==="license-request"||S==="license-renewal"?this.renewLicense(e,T).catch(k=>{u.eventNames().length?u.emit("error",k):this.handleError(k)}):S==="license-release"?e.keySystem===sr.FAIRPLAY&&this.updateKeySession(e,$p("acknowledged")).then(()=>this.removeSession(e)).catch(k=>this.handleError(k)):this.warn(`unhandled media key message type "${S}"`)},g=(v,w)=>{w.keyStatus=v;let S;v.startsWith("usable")?u.emit("resolved"):v==="internal-error"||v==="output-restricted"||v==="output-downscaled"?S=t_(v,w.decryptdata):v==="expired"?S=new Error(`key expired (keyId: ${d})`):v==="released"?S=new Error("key released"):v==="status-pending"||this.warn(`unhandled key status change "${v}" (keyId: ${d})`),S&&(u.eventNames().length?u.emit("error",S):this.handleError(S))},x=e._onkeystatuseschange=v=>{if(!e.mediaKeysSession){u.emit("error",new Error("invalid state"));return}const S=this.getKeyStatuses(e);if(!Object.keys(S).some(R=>S[R]!=="status-pending"))return;if(S[d]==="expired"){this.log(`Expired key ${zs(S)} in key-session "${e.mediaKeysSession.sessionId}"`),this.renewKeySession(e);return}let k=S[d];if(k)g(k,e);else{var E;e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(E=e.keyStatusTimeouts)[d]||(E[d]=self.setTimeout(()=>{if(!e.mediaKeysSession||!this.mediaKeys)return;const K=this.getKeyStatus(e.decryptdata);if(K&&K!=="status-pending")return this.log(`No status for keyId ${d} in key-session "${e.mediaKeysSession.sessionId}". Using session key-status ${K} from other session.`),g(K,e);this.log(`key status for ${d} in key-session "${e.mediaKeysSession.sessionId}" timed out after 1000ms`),k="internal-error",g(k,e)},1e3)),this.log(`No status for keyId ${d} (${zs(S)}).`)}};qr(e.mediaKeysSession,"message",m),qr(e.mediaKeysSession,"keystatuseschange",x);const b=new Promise((v,w)=>{u.on("error",w),u.on("resolved",v)});return e.mediaKeysSession.generateRequest(s,r).then(()=>{this.log(`Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${d} URI: ${f}`)}).catch(v=>{throw new va({type:Ft.KEY_SYSTEM_ERROR,details:ze.KEY_SYSTEM_NO_SESSION,error:v,decryptdata:e.decryptdata,fatal:!1},`Error generating key-session request: ${v}`)}).then(()=>b).catch(v=>(u.removeAllListeners(),this.removeSession(e).then(()=>{throw v}))).then(()=>(u.removeAllListeners(),e))}getKeyStatuses(e){const s={};return e.mediaKeysSession.keyStatuses.forEach((r,n)=>{if(typeof n=="string"&&typeof r=="object"){const d=n;n=r,r=d}const o="buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n);if(e.keySystem===sr.PLAYREADY&&o.length===16){const d=Ir(o);s[d]=r,Hj(o)}const c=Ir(o);r==="internal-error"&&(this.bannedKeyIds[c]=r),this.log(`key status change "${r}" for keyStatuses keyId: ${c} key-session "${e.mediaKeysSession.sessionId}"`),s[c]=r}),s}fetchServerCertificate(e){const s=this.config,r=s.loader,n=new r(s),o=this.getServerCertificateUrl(e);return o?(this.log(`Fetching server certificate for "${e}"`),new Promise((c,d)=>{const f={responseType:"arraybuffer",url:o},u=s.certLoadPolicy.default,m={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},g={onSuccess:(x,b,v,w)=>{c(x.data)},onError:(x,b,v,w)=>{d(new va({type:Ft.KEY_SYSTEM_ERROR,details:ze.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:v,response:Is({url:f.url,data:void 0},x)},`"${e}" certificate request failed (${o}). Status: ${x.code} (${x.text})`))},onTimeout:(x,b,v)=>{d(new va({type:Ft.KEY_SYSTEM_ERROR,details:ze.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:v,response:{url:f.url,data:void 0}},`"${e}" certificate request timed out (${o})`))},onAbort:(x,b,v)=>{d(new Error("aborted"))}};n.load(f,m,g)})):Promise.resolve()}setMediaKeysServerCertificate(e,s,r){return new Promise((n,o)=>{e.setServerCertificate(r).then(c=>{this.log(`setServerCertificate ${c?"success":"not supported by CDM"} (${r.byteLength}) on "${s}"`),n(e)}).catch(c=>{o(new va({type:Ft.KEY_SYSTEM_ERROR,details:ze.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:c,fatal:!0},c.message))})})}renewLicense(e,s){return this.requestLicense(e,new Uint8Array(s)).then(r=>this.updateKeySession(e,new Uint8Array(r)).catch(n=>{throw new va({type:Ft.KEY_SYSTEM_ERROR,details:ze.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:n,fatal:!1},n.message)}))}unpackPlayReadyKeyMessage(e,s){const r=String.fromCharCode.apply(null,new Uint16Array(s.buffer));if(!r.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),s;const n=new DOMParser().parseFromString(r,"application/xml"),o=n.querySelectorAll("HttpHeader");if(o.length>0){let m;for(let g=0,x=o.length;g<x;g++){var c,d;m=o[g];const b=(c=m.querySelector("name"))==null?void 0:c.textContent,v=(d=m.querySelector("value"))==null?void 0:d.textContent;b&&v&&e.setRequestHeader(b,v)}}const f=n.querySelector("Challenge"),u=f==null?void 0:f.textContent;if(!u)throw new Error("Cannot find <Challenge> in key message");return $p(atob(u))}setupLicenseXHR(e,s,r,n){const o=this.config.licenseXhrSetup;return o?Promise.resolve().then(()=>{if(!r.decryptdata)throw new Error("Key removed");return o.call(this.hls,e,s,r,n)}).catch(c=>{if(!r.decryptdata)throw c;return e.open("POST",s,!0),o.call(this.hls,e,s,r,n)}).then(c=>(e.readyState||e.open("POST",s,!0),{xhr:e,licenseChallenge:c||n})):(e.open("POST",s,!0),Promise.resolve({xhr:e,licenseChallenge:n}))}requestLicense(e,s){const r=this.config.keyLoadPolicy.default;return new Promise((n,o)=>{const c=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${c}`);const d=new XMLHttpRequest;d.responseType="arraybuffer",d.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return o(new Error("invalid state"));if(d.readyState===4)if(d.status===200){this._requestLicenseFailureCount=0;let f=d.response;this.log(`License received ${f instanceof ArrayBuffer?f.byteLength:f}`);const u=this.config.licenseResponseCallback;if(u)try{f=u.call(this.hls,d,c,e)}catch(m){this.error(m)}n(f)}else{const f=r.errorRetry,u=f?f.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||d.status>=400&&d.status<500)o(new va({type:Ft.KEY_SYSTEM_ERROR,details:ze.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:d,response:{url:c,data:void 0,code:d.status,text:d.statusText}},`License Request XHR failed (${c}). Status: ${d.status} (${d.statusText})`));else{const m=u-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${m} attempts left`),this.requestLicense(e,s).then(n,o)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=d,this.setupLicenseXHR(d,c,e,s).then(({xhr:f,licenseChallenge:u})=>{e.keySystem==sr.PLAYREADY&&(u=this.unpackPlayReadyKeyMessage(f,u)),f.send(u)}).catch(o)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,s){if(!this.config.emeEnabled)return;const r=s.media;this.media=r,qr(r,"encrypted",this.onMediaEncrypted),qr(r,"waitingforkey",this.onWaitingForKey);const n=this.mediaResolved;n?n():this.mediaKeys=r.mediaKeys}onMediaDetached(){const e=this.media;e&&(na(e,"encrypted",this.onMediaEncrypted),na(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={};const s=this.mediaResolved;if(s&&s(),!this.mediaKeys&&!this.mediaKeySessions.length)return;const r=this.media,n=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,lo.clearKeyUriToKeyIdMap();const o=n.length;ec.CDMCleanupPromise=Promise.all(n.map(c=>this.removeSession(c)).concat((r==null||(e=r.setMediaKeys(null))==null?void 0:e.catch(c=>{this.log(`Could not clear media keys: ${c}`),this.hls&&this.hls.trigger(Q.ERROR,{type:Ft.OTHER_ERROR,details:ze.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${c}`)})}))||Promise.resolve())).catch(c=>{this.log(`Could not close sessions and clear media keys: ${c}`),this.hls&&this.hls.trigger(Q.ERROR,{type:Ft.OTHER_ERROR,details:ze.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${c}`)})}).then(()=>{o&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this._clear()}onManifestLoaded(e,{sessionKeys:s}){if(!(!s||!this.config.emeEnabled)&&!this.keyFormatPromise){const r=s.reduce((n,o)=>(n.indexOf(o.keyFormat)===-1&&n.push(o.keyFormat),n),[]);this.log(`Selecting key-system from session-keys ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)}}removeSession(e){const{mediaKeysSession:s,licenseXhr:r,decryptdata:n}=e;if(s){this.log(`Remove licenses and keys and close session "${s.sessionId}" keyId: ${Ir((n==null?void 0:n.keyId)||[])}`),e._onmessage&&(s.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(s.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const o=this.mediaKeySessions.indexOf(e);o>-1&&this.mediaKeySessions.splice(o,1);const{keyStatusTimeouts:c}=e;c&&Object.keys(c).forEach(u=>self.clearTimeout(c[u]));const{drmSystemOptions:d}=this.config;return(v6(d)?new Promise((u,m)=>{self.setTimeout(()=>m(new Error("MediaKeySession.remove() timeout")),8e3),s.remove().then(u).catch(m)}):Promise.resolve()).catch(u=>{this.log(`Could not remove session: ${u}`),this.hls&&this.hls.trigger(Q.ERROR,{type:Ft.OTHER_ERROR,details:ze.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${u}`)})}).then(()=>s.close()).catch(u=>{this.log(`Could not close session: ${u}`),this.hls&&this.hls.trigger(Q.ERROR,{type:Ft.OTHER_ERROR,details:ze.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${u}`)})})}return Promise.resolve()}}ec.CDMCleanupPromise=void 0;function Bh(a){if(!a)throw new Error("Could not read keyId of undefined decryptdata");if(a.keyId===null)throw new Error("keyId is null");return Ir(a.keyId)}function BO(a,e){if(a.keyId&&e.mediaKeysSession.keyStatuses.has(a.keyId))return e.mediaKeysSession.keyStatuses.get(a.keyId);if(a.matches(e.decryptdata))return e.keyStatus}class va extends Error{constructor(e,s){super(s),this.data=void 0,e.error||(e.error=new Error(s)),this.data=e,e.err=e.error}}function t_(a,e){const s=a==="output-restricted",r=s?ze.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:ze.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new va({type:Ft.KEY_SYSTEM_ERROR,details:r,fatal:!1,decryptdata:e},s?"HDCP level output restricted":`key status changed to "${a}"`)}class UO{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(Q.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(Q.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(Q.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(Q.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,s){const r=this.hls.config;if(r.capLevelOnFPSDrop){const n=s.media instanceof self.HTMLVideoElement?s.media:null;this.media=n,n&&typeof n.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,s,r){const n=performance.now();if(s){if(this.lastTime){const o=n-this.lastTime,c=r-this.lastDroppedFrames,d=s-this.lastDecodedFrames,f=1e3*c/o,u=this.hls;if(u.trigger(Q.FPS_DROP,{currentDropped:c,currentDecoded:d,totalDroppedFrames:r}),f>0&&c>u.config.fpsDroppedMonitoringThreshold*d){let m=u.currentLevel;u.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+m),m>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=m)&&(m=m-1,u.trigger(Q.FPS_DROP_LEVEL_CAPPING,{level:m,droppedLevel:u.currentLevel}),u.autoLevelCapping=m,this.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=s}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const s=e.getVideoPlaybackQuality();this.checkFPS(e,s.totalVideoFrames,s.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function M2(a,e){let s;try{s=new Event("addtrack")}catch{s=document.createEvent("Event"),s.initEvent("addtrack",!1,!1)}s.track=a,e.dispatchEvent(s)}function P2(a,e){const s=a.mode;if(s==="disabled"&&(a.mode="hidden"),a.cues&&!a.cues.getCueById(e.id))try{if(a.addCue(e),!a.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(r){Ms.debug(`[texttrack-utils]: ${r}`);try{const n=new self.TextTrackCue(e.startTime,e.endTime,e.text);n.id=e.id,a.addCue(n)}catch(n){Ms.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${n}`)}}s==="disabled"&&(a.mode=s)}function Xl(a,e){const s=a.mode;if(s==="disabled"&&(a.mode="hidden"),a.cues)for(let r=a.cues.length;r--;)e&&a.cues[r].removeEventListener("enter",e),a.removeCue(a.cues[r]);s==="disabled"&&(a.mode=s)}function Qp(a,e,s,r){const n=a.mode;if(n==="disabled"&&(a.mode="hidden"),a.cues&&a.cues.length>0){const o=GO(a.cues,e,s);for(let c=0;c<o.length;c++)(!r||r(o[c]))&&a.removeCue(o[c])}n==="disabled"&&(a.mode=n)}function $O(a,e){if(e<=a[0].startTime)return 0;const s=a.length-1;if(e>a[s].endTime)return-1;let r=0,n=s,o;for(;r<=n;)if(o=Math.floor((n+r)/2),e<a[o].startTime)n=o-1;else if(e>a[o].startTime&&r<s)r=o+1;else return o;return a[r].startTime-e<e-a[n].startTime?r:n}function GO(a,e,s){const r=[],n=$O(a,e);if(n>-1)for(let o=n,c=a.length;o<c;o++){const d=a[o];if(d.startTime>=e&&d.endTime<=s)r.push(d);else if(d.startTime>s)return r}return r}function uf(a){const e=[];for(let s=0;s<a.length;s++){const r=a[s];(r.kind==="subtitles"||r.kind==="captions")&&r.label&&e.push(a[s])}return e}class HO extends Kx{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let s=null;const r=uf(this.media.textTracks);for(let o=0;o<r.length;o++)if(r[o].mode==="hidden")s=r[o];else if(r[o].mode==="showing"){s=r[o];break}const n=this.findTrackForTextTrack(s);this.subtitleTrack!==n&&this.setSubtitleTrack(n)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(Q.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Q.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Q.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Q.LEVEL_LOADING,this.onLevelLoading,this),e.on(Q.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(Q.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(Q.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(Q.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Q.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Q.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Q.LEVEL_LOADING,this.onLevelLoading,this),e.off(Q.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(Q.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(Q.ERROR,this.onError,this)}onMediaAttached(e,s){this.media=s.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,s){const r=this.media;if(!r)return;const n=!!s.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||r.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,n)return;uf(r.textTracks).forEach(c=>{Xl(c)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,s){this.tracks=s.subtitleTracks}onSubtitleTrackLoaded(e,s){const{id:r,groupId:n,details:o}=s,c=this.tracksInGroup[r];if(!c||c.groupId!==n){this.warn(`Subtitle track with id:${r} and group:${n} not found in active group ${c==null?void 0:c.groupId}`);return}const d=c.details;c.details=s.details,this.log(`Subtitle track ${r} "${c.name}" lang:${c.lang} group:${n} loaded [${o.startSN}-${o.endSN}]`),r===this.trackId&&this.playlistLoaded(r,s,d)}onLevelLoading(e,s){this.switchLevel(s.level)}onLevelSwitching(e,s){this.switchLevel(s.level)}switchLevel(e){const s=this.hls.levels[e];if(!s)return;const r=s.subtitleGroups||null,n=this.groupIds;let o=this.currentTrack;if(!r||(n==null?void 0:n.length)!==(r==null?void 0:r.length)||r!=null&&r.some(c=>(n==null?void 0:n.indexOf(c))===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const c=this.tracks.filter(m=>!r||r.indexOf(m.groupId)!==-1);if(c.length)this.selectDefaultTrack&&!c.some(m=>m.default)&&(this.selectDefaultTrack=!1),c.forEach((m,g)=>{m.id=g});else if(!o&&!this.tracksInGroup.length)return;this.tracksInGroup=c;const d=this.hls.config.subtitlePreference;if(!o&&d){this.selectDefaultTrack=!1;const m=Nn(d,c);if(m>-1)o=c[m];else{const g=Nn(d,this.tracks);o=this.tracks[g]}}let f=this.findTrackId(o);f===-1&&o&&(f=this.findTrackId(null));const u={subtitleTracks:c};this.log(`Updating subtitle tracks, ${c.length} track(s) found in "${r==null?void 0:r.join(",")}" group-id`),this.hls.trigger(Q.SUBTITLE_TRACKS_UPDATED,u),f!==-1&&this.trackId===-1&&this.setSubtitleTrack(f)}}findTrackId(e){const s=this.tracksInGroup,r=this.selectDefaultTrack;for(let n=0;n<s.length;n++){const o=s[n];if(!(r&&!o.default||!r&&!e)&&(!e||sl(o,e)))return n}if(e){for(let n=0;n<s.length;n++){const o=s[n];if(zd(e.attrs,o.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return n}for(let n=0;n<s.length;n++){const o=s[n];if(zd(e.attrs,o.attrs,["LANGUAGE"]))return n}}return-1}findTrackForTextTrack(e){if(e){const s=this.tracksInGroup;for(let r=0;r<s.length;r++){const n=s[r];if(qp(n,e))return r}}return-1}onError(e,s){s.fatal||!s.context||s.context.type===us.SUBTITLE_TRACK&&s.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(s.context.groupId)!==-1)&&this.checkRetry(s)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const s=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,s.length){const r=this.currentTrack;if(r&&sl(e,r))return r;const n=Nn(e,this.tracksInGroup);if(n>-1){const o=this.tracksInGroup[n];return this.setSubtitleTrack(n),o}else{if(r)return null;{const o=Nn(e,s);if(o>-1)return s[o]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,s){super.loadingPlaylist(e,s);const r=e.id,n=e.groupId,o=this.getUrlWithDirectives(e.url,s),c=e.details,d=c==null?void 0:c.age;this.log(`Loading subtitle ${r} "${e.name}" lang:${e.lang} group:${n}${(s==null?void 0:s.msn)!==void 0?" at sn "+s.msn+" part "+s.part:""}${d&&c.live?" age "+d.toFixed(1)+(c.type&&" "+c.type||""):""} ${o}`),this.hls.trigger(Q.SUBTITLE_TRACK_LOADING,{url:o,id:r,groupId:n,deliveryDirectives:s||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const s=uf(e.textTracks),r=this.currentTrack;let n;if(r&&(n=s.filter(o=>qp(r,o))[0],n||this.warn(`Unable to find subtitle TextTrack with name "${r.name}" and language "${r.lang}"`)),[].slice.call(s).forEach(o=>{o.mode!=="disabled"&&o!==n&&(o.mode="disabled")}),n){const o=this.subtitleDisplay?"showing":"hidden";n.mode!==o&&(n.mode=o)}}setSubtitleTrack(e){const s=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=s.length||!Tt(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,n=s[e]||null;if(this.trackId=e,this.currentTrack=n,this.toggleTrackModes(),!n){this.hls.trigger(Q.SUBTITLE_TRACK_SWITCH,{id:e});return}const o=!!n.details&&!n.details.live;if(e===this.trackId&&n===r&&o)return;this.log(`Switching to subtitle-track ${e}`+(n?` "${n.name}" lang:${n.lang} group:${n.groupId}`:""));const{id:c,groupId:d="",name:f,type:u,url:m}=n;this.hls.trigger(Q.SUBTITLE_TRACK_SWITCH,{id:c,groupId:d,name:f,type:u,url:m});const g=this.switchParams(n.url,r==null?void 0:r.details,n.details);this.loadPlaylist(g)}}function VO(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),s=e.toString();return URL.revokeObjectURL(e),s.slice(s.lastIndexOf("/")+1)}catch{let s=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const o=(s+Math.random()*16)%16|0;return s=Math.floor(s/16),(n=="x"?o:o&3|8).toString(16)})}}}function Md(a){let e=5381,s=a.length;for(;s;)e=e*33^a.charCodeAt(--s);return(e>>>0).toString()}const tc=.025;let Df=(function(a){return a[a.Point=0]="Point",a[a.Range=1]="Range",a})({});function zO(a,e,s){return`${a.identifier}-${s+1}-${Md(e)}`}class qO{constructor(e,s){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=s,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var s;if(e>0&&e>=this.assetList.length)return!0;const r=this.playoutLimit;return e<=0||isNaN(r)?!1:r===0?!0:(((s=this.assetList[e])==null?void 0:s.startOffset)||0)>r}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const s=this.dateRange.tagAnchor;if(s)return Ug(e,s)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const s=this.dateRange.startTime,r=Ug(s,e);return s-r<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,s=Tt(e)?e:this.duration;return this.cumulativeDuration+s}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const s=this.resumeAnchor;if(s)return Ug(e,s)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<tc))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let s;return this._duration!==null?s=this._duration:this.dateRange.duration?s=this.dateRange.duration:s=this.dateRange.plannedDuration||0,!isNaN(e)&&e<s&&(s=e),s}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?Df.Range:Df.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return KO(this)}}function Ug(a,e){return a-e.start<e.duration/2&&!(Math.abs(a-(e.start+e.duration))<tc)?e.start:e.start+e.duration}function O2(a,e,s){const r=new self.URL(a,s);return r.protocol!=="data:"&&r.searchParams.set("_HLS_primary_id",e),r}function $g(a,e){for(;(s=a.assetList[++e])!=null&&s.error;)var s;return e}function KO(a){return`["${a.identifier}" ${a.cue.pre?"<pre>":a.cue.post?"<post>":""}${a.timelineStart.toFixed(2)}-${a.resumeTime.toFixed(2)}]`}function Wl(a){const e=a.timelineStart,s=a.duration||0;return`["${a.identifier}" ${e.toFixed(2)}-${(e+s).toFixed(2)}]`}class YO{constructor(e,s,r,n){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(Q.PLAYOUT_LIMIT_REACHED,{})};const o=this.hls=new e(s);this.interstitial=r,this.assetItem=n;const c=()=>{this.hasDetails=!0};o.once(Q.LEVEL_LOADED,c),o.once(Q.AUDIO_TRACK_LOADED,c),o.once(Q.SUBTITLE_TRACK_LOADED,c),o.on(Q.MEDIA_ATTACHING,(d,{media:f})=>{this.removeMediaListeners(),this.mediaAttached=f,this.interstitial.playoutLimit&&(f.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&o.on(Q.BUFFER_APPENDED,()=>{const m=this.bufferedEnd;this.reachedPlayout(m)&&(this._bufferedEosTime=m,o.trigger(Q.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{let s=this.assetItem.uri;try{s=O2(s,e.config.primarySessionId||"").href}catch{}e.loadSource(s)}}bufferedInPlaceToEnd(e){var s;if(!this.appendInPlace)return!1;if((s=this.hls)!=null&&s.bufferedToEnd)return!0;if(!e)return!1;const r=Math.min(this._bufferedEosTime||1/0,this.duration),n=this.timelineOffset,o=Zt.bufferInfo(e,n,0);return this.getAssetTime(o.end)>=r-.02}reachedPlayout(e){const r=this.interstitial.playoutLimit;return this.startOffset+e>=r}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const s=Zt.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(s.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;if(!e)return 0;const s=this.interstitial.playoutLimit;if(s){const r=s-this.startOffset;if(r>0&&r<e)return r}return e}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const s=this.timelineOffset;if(e!==s){const r=e-s;if(Math.abs(r)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const s=this.timelineOffset,r=this.duration;return Math.min(Math.max(0,e-s),r)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){var s;this.loadSource(),(s=this.hls)==null||s.attachMedia(e)}detachMedia(){var e;this.removeMediaListeners(),this.mediaAttached=null,(e=this.hls)==null||e.detachMedia()}resumeBuffering(){var e;(e=this.hls)==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.hls)==null||e.pauseBuffering()}transferMedia(){var e;return this.bufferSnapShot(),((e=this.hls)==null?void 0:e.transferMedia())||null}resetDetails(){const e=this.hls;if(e&&this.hasDetails){e.stopLoad();const s=r=>delete r.details;e.levels.forEach(s),e.allAudioTracks.forEach(s),e.allSubtitleTracks.forEach(s),this.hasDetails=!1}}on(e,s,r){var n;(n=this.hls)==null||n.on(e,s)}once(e,s,r){var n;(n=this.hls)==null||n.once(e,s)}off(e,s,r){var n;(n=this.hls)==null||n.off(e,s)}toString(){var e;return`HlsAssetPlayer: ${Wl(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const s_=.033;class WO extends qa{constructor(e,s){super("interstitials-sched",s),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,s){return this.events?this.events.reduce((r,n)=>e<=n.startOffset&&s>n.startOffset?(delete n.error,r+1):r,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,s){if(e.event)return this.findEventIndex(e.event.identifier);let r=-1;e.nextEvent?r=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(r=this.findEventIndex(e.previousEvent.identifier)+1);const n=this.items;if(n)for(n[r]||(s===void 0&&(s=e.start),r=this.findItemIndexAtTime(s));r>=0&&(o=n[r])!=null&&o.event;){var o;r--}return r}findItemIndexAtTime(e,s){const r=this.items;if(r)for(let n=0;n<r.length;n++){let o=r[n];if(s&&s!=="primary"&&(o=o[s]),e===o.start||e>o.start&&e<o.end)return n}return-1}findJumpRestrictedIndex(e,s){const r=this.items;if(r)for(let n=e;n<=s&&r[n];n++){const o=r[n].event;if(o!=null&&o.restrictions.jump&&!o.appendInPlace)return n}return-1}findEventIndex(e){const s=this.items;if(s)for(let n=s.length;n--;){var r;if(((r=s[n].event)==null?void 0:r.identifier)===e)return n}return-1}findAssetIndex(e,s){const r=e.assetList,n=r.length;if(n>1)for(let o=0;o<n;o++){const c=r[o];if(!c.error){const d=c.timelineStart;if(s===d||s>d&&(s<d+(c.duration||0)||o===n-1))return o}}return 0}get assetIdAtEnd(){var e;const s=(e=this.items)==null||(e=e[this.length-1])==null?void 0:e.event;if(s){const r=s.assetList,n=r[r.length-1];if(n)return n.identifier}return null}parseInterstitialDateRanges(e,s){const r=e.main.details,{dateRanges:n}=r,o=this.events,c=this.parseDateRanges(n,{url:r.url},s),d=Object.keys(n),f=o?o.filter(u=>!d.includes(u.identifier)):[];c.length&&c.sort((u,m)=>{const g=u.cue.pre,x=u.cue.post,b=m.cue.pre,v=m.cue.post;if(g&&!b)return-1;if(b&&!g||x&&!v)return 1;if(v&&!x)return-1;if(!g&&!b&&!x&&!v){const w=u.startTime,S=m.startTime;if(w!==S)return w-S}return u.dateRange.tagOrder-m.dateRange.tagOrder}),this.events=c,f.forEach(u=>{this.removeEvent(u)}),this.updateSchedule(e,f)}updateSchedule(e,s=[],r=!1){const n=this.events||[];if(n.length||s.length||this.length<2){const o=this.items,c=this.parseSchedule(n,e);(r||s.length||(o==null?void 0:o.length)!==c.length||c.some((f,u)=>Math.abs(f.playout.start-o[u].playout.start)>.005||Math.abs(f.playout.end-o[u].playout.end)>.005))&&(this.items=c,this.onScheduleUpdate(s,o))}}parseDateRanges(e,s,r){const n=[],o=Object.keys(e);for(let c=0;c<o.length;c++){const d=o[c],f=e[d];if(f.isInterstitial){let u=this.eventMap[d];u?u.setDateRange(f):(u=new qO(f,s),this.eventMap[d]=u,r===!1&&(u.appendInPlace=r)),n.push(u)}}return n}parseSchedule(e,s){const r=[],n=s.main.details,o=n.live?1/0:n.edge;let c=0;if(e=e.filter(f=>!f.error&&!(f.cue.once&&f.hasPlayed)),e.length){this.resolveOffsets(e,s);let f=0,u=0;if(e.forEach((m,g)=>{const x=m.cue.pre,b=m.cue.post,v=e[g-1]||null,w=m.appendInPlace,S=b?o:m.startOffset,T=m.duration,k=m.timelineOccupancy===Df.Range?T:0,E=m.resumptionOffset,R=(v==null?void 0:v.startTime)===S,K=S+m.cumulativeDuration;let z=w?K+T:S+E;if(x||!b&&S<=0){const O=u;u+=k,m.timelineStart=K;const U=c;c+=T,r.push({event:m,start:K,end:z,playout:{start:U,end:c},integrated:{start:O,end:u}})}else if(S<=o){if(!R){const I=S-f;if(I>s_){const F=f,te=u;u+=I;const le=c;c+=I;const H={previousEvent:e[g-1]||null,nextEvent:m,start:F,end:F+I,playout:{start:le,end:c},integrated:{start:te,end:u}};r.push(H)}else I>0&&v&&(v.cumulativeDuration+=I,r[r.length-1].end=S)}b&&(z=K),m.timelineStart=K;const O=u;u+=k;const U=c;c+=T,r.push({event:m,start:K,end:z,playout:{start:U,end:c},integrated:{start:O,end:u}})}else return;const D=m.resumeTime;b||D>o?f=o:f=D}),f<o){var d;const m=f,g=u,x=o-f;u+=x;const b=c;c+=x,r.push({previousEvent:((d=r[r.length-1])==null?void 0:d.event)||null,nextEvent:null,start:f,end:m+x,playout:{start:b,end:c},integrated:{start:g,end:u}})}this.setDurations(o,c,u)}else r.push({previousEvent:null,nextEvent:null,start:0,end:o,playout:{start:0,end:o},integrated:{start:0,end:o}}),this.setDurations(o,o,o);return r}setDurations(e,s,r){this.durations={primary:e,playout:s,integrated:r}}resolveOffsets(e,s){const r=s.main.details,n=r.live?1/0:r.edge;let o=0,c=-1;e.forEach((d,f)=>{const u=d.cue.pre,m=d.cue.post,g=u?0:m?n:d.startTime;this.updateAssetDurations(d),c===g?d.cumulativeDuration=o:(o=0,c=g),!m&&d.snapOptions.in&&(d.resumeAnchor=ol(null,r.fragments,d.startOffset+d.resumptionOffset,0,0)||void 0),d.appendInPlace&&!d.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(d,s)||(d.appendInPlace=!1)),!d.appendInPlace&&f+1<e.length&&e[f+1].startTime-e[f].resumeTime<s_&&(e[f+1].appendInPlace=!1,e[f+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${d}`));const b=Tt(d.resumeOffset)?d.resumeOffset:d.duration;o+=b})}primaryCanResumeInPlaceAt(e,s){const r=e.resumeTime,n=e.startTime+e.resumptionOffset;return Math.abs(r-n)>tc?(this.log(`"${e.identifier}" resumption ${r} not aligned with estimated timeline end ${n}`),!1):!Object.keys(s).some(c=>{const d=s[c].details,f=d.edge;if(r>=f)return this.log(`"${e.identifier}" resumption ${r} past ${c} playlist end ${f}`),!1;const u=ol(null,d.fragments,r);if(!u)return this.log(`"${e.identifier}" resumption ${r} does not align with any fragments in ${c} playlist (${d.fragStart}-${d.fragmentEnd})`),!0;const m=c==="audio"?.175:0;return Math.abs(u.start-r)<tc+m||Math.abs(u.end-r)<tc+m?!1:(this.log(`"${e.identifier}" resumption ${r} not aligned with ${c} fragment bounds (${u.start}-${u.end} sn: ${u.sn} cc: ${u.cc})`),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;const s=e.timelineStart;let r=0,n=!1,o=!1;for(let c=0;c<e.assetList.length;c++){const d=e.assetList[c],f=s+r;d.startOffset=r,d.timelineStart=f,n||(n=d.duration===null),o||(o=!!d.error);const u=d.error?0:d.duration||0;r+=u}n&&!o?e.duration=Math.max(r,e.duration):e.duration=r}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function Ja(a){return`[${a.event?'"'+a.event.identifier+'"':"primary"}: ${a.start.toFixed(2)}-${a.end.toFixed(2)}]`}class QO{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,s){const r=e.assetListUrl;let n;try{n=O2(r,this.hls.sessionId,e.baseUrl)}catch(x){const b=this.assignAssetListError(e,ze.ASSET_LIST_LOAD_ERROR,x,r);this.hls.trigger(Q.ERROR,b);return}s&&n.protocol!=="data:"&&n.searchParams.set("_HLS_start_offset",""+s);const o=this.hls.config,c=o.loader,d=new c(o),f={responseType:"json",url:n.href},u=o.interstitialAssetListLoadPolicy.default,m={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},g={onSuccess:(x,b,v,w)=>{const S=x.data,T=S==null?void 0:S.ASSETS;if(!Array.isArray(T)){const k=this.assignAssetListError(e,ze.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),v.url,b,w);this.hls.trigger(Q.ERROR,k);return}e.assetListResponse=S,this.hls.trigger(Q.ASSET_LIST_LOADED,{event:e,assetListResponse:S,networkDetails:w})},onError:(x,b,v,w)=>{const S=this.assignAssetListError(e,ze.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${x.code} ${x.text} (${b.url})`),b.url,w,v);this.hls.trigger(Q.ERROR,S)},onTimeout:(x,b,v)=>{const w=this.assignAssetListError(e,ze.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${b.url})`),b.url,x,v);this.hls.trigger(Q.ERROR,w)}};return d.load(f,m,g),this.hls.trigger(Q.ASSET_LIST_LOADING,{event:e}),d}assignAssetListError(e,s,r,n,o,c){return e.error=r,{type:Ft.NETWORK_ERROR,details:s,fatal:!1,interstitial:e,url:n,error:r,networkDetails:c,stats:o}}}function r_(a){var e;a==null||(e=a.play())==null||e.catch(()=>{})}function Uh(a,e){return`[${a}] Advancing timeline position to ${e}`}class XO extends qa{constructor(e,s){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled||!this.schedule)return;const n=r-this.timelinePos;if(Math.abs(n)<1/7056e5)return;const c=n<=-.01;this.timelinePos=r,this.bufferedPos=r;const d=this.playingItem;if(!d){this.checkBuffer();return}if(c&&this.schedule.resetErrorsInRange(r,r-n)&&this.updateSchedule(!0),this.checkBuffer(),c&&r<d.start||r>=d.end){var f;const b=this.findItemIndex(d);let v=this.schedule.findItemIndexAtTime(r);if(v===-1&&(v=b+(c?-1:1),this.log(`seeked ${c?"back ":""}to position not covered by schedule ${r} (resolving from ${b} to ${v})`)),!this.isInterstitial(d)&&(f=this.media)!=null&&f.paused&&(this.shouldPlay=!1),!c&&v>b){const w=this.schedule.findJumpRestrictedIndex(b+1,v);if(w>b){this.setSchedulePosition(w);return}}this.setSchedulePosition(v);return}const u=this.playingAsset;if(!u){if(this.playingLastItem&&this.isInterstitial(d)){const b=d.event.assetList[0];b&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(r,b))}return}const m=u.timelineStart,g=u.duration||0;if(c&&r<m||r>=m+g){var x;(x=d.event)!=null&&x.appendInPlace&&(this.clearAssetPlayers(d.event,d),this.flushFrontBuffer(r)),this.setScheduleToAssetAtTime(r,u)}},this.onTimeupdate=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled)return;if(r>this.timelinePos)this.timelinePos=r,r>this.bufferedPos&&this.checkBuffer();else return;const n=this.playingItem;if(!n||this.playingLastItem)return;if(r>=n.end){this.timelinePos=n.end;const d=this.findItemIndex(n);this.setSchedulePosition(d+1)}const o=this.playingAsset;if(!o)return;const c=o.timelineStart+(o.duration||0);r>=c&&this.setScheduleToAssetAtTime(r,o)},this.onScheduleUpdate=(r,n)=>{const o=this.schedule;if(!o)return;const c=this.playingItem,d=o.events||[],f=o.items||[],u=o.durations,m=r.map(w=>w.identifier),g=!!(d.length||m.length);(g||n)&&this.log(`INTERSTITIALS_UPDATED (${d.length}): ${d}
Schedule: ${f.map(w=>Ja(w))} pos: ${this.timelinePos}`),m.length&&this.log(`Removed events ${m}`);let x=null,b=null;c&&(x=this.updateItem(c,this.timelinePos),this.itemsMatch(c,x)?this.playingItem=x:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const v=this.bufferingItem;if(v&&(b=this.updateItem(v,this.bufferedPos),this.itemsMatch(v,b)?this.bufferingItem=b:v.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(v.event,null))),r.forEach(w=>{w.assetList.forEach(S=>{this.clearAssetPlayer(S.identifier,null)})}),this.playerQueue.forEach(w=>{if(w.interstitial.appendInPlace){const S=w.assetItem.timelineStart,T=w.timelineOffset-S;if(T)try{w.timelineOffset=S}catch(k){Math.abs(T)>tc&&this.warn(`${k} ("${w.assetId}" ${w.timelineOffset}->${S})`)}}}),g||n){if(this.hls.trigger(Q.INTERSTITIALS_UPDATED,{events:d.slice(0),schedule:f.slice(0),durations:u,removedIds:m}),this.isInterstitial(c)&&m.includes(c.event.identifier)){this.warn(`Interstitial "${c.event.identifier}" removed while playing`),this.primaryFallback(c.event);return}c&&this.trimInPlace(x,c),v&&b!==x&&this.trimInPlace(b,v),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=s,this.assetListLoader=new QO(e),this.schedule=new WO(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e&&(e.on(Q.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Q.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Q.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Q.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(Q.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(Q.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(Q.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(Q.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(Q.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(Q.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(Q.BUFFER_APPENDED,this.onBufferAppended,this),e.on(Q.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(Q.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(Q.MEDIA_ENDED,this.onMediaEnded,this),e.on(Q.ERROR,this.onError,this),e.on(Q.DESTROYING,this.onDestroying,this))}unregisterListeners(){const e=this.hls;e&&(e.off(Q.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Q.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Q.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Q.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(Q.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(Q.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(Q.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(Q.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(Q.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(Q.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(Q.BUFFER_CODECS,this.onBufferCodecs,this),e.off(Q.BUFFER_APPENDED,this.onBufferAppended,this),e.off(Q.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(Q.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(Q.MEDIA_ENDED,this.onMediaEnded,this),e.off(Q.ERROR,this.onError,this),e.off(Q.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){na(e,"play",this.onPlay),na(e,"pause",this.onPause),na(e,"seeking",this.onSeeking),na(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,s){const r=this.media=s.media;qr(r,"seeking",this.onSeeking),qr(r,"timeupdate",this.onTimeupdate),qr(r,"play",this.onPlay),qr(r,"pause",this.onPause)}onMediaAttached(e,s){const r=this.effectivePlayingItem,n=this.detachedData;if(this.detachedData=null,r===null)this.checkStart();else if(!n){this.clearScheduleState();const o=this.findItemIndex(r);this.setSchedulePosition(o)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,s){const r=!!s.transferMedia,n=this.media;if(this.media=null,!r&&(n&&this.removeMediaListeners(n),this.detachedData)){const o=this.getBufferingPlayer();o&&(this.log(`Removing schedule state for detachedData and ${o}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,o.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const e=this,s=()=>e.bufferingItem||e.waitingItem,r=g=>g&&e.getAssetPlayer(g.identifier),n=(g,x,b,v,w)=>{if(g){let S=g[x].start;const T=g.event;if(T){if(x==="playout"||T.timelineOccupancy!==Df.Point){const k=r(b);(k==null?void 0:k.interstitial)===T&&(S+=k.assetItem.startOffset+k[w])}}else{const k=v==="bufferedPos"?c():e[v];S+=k-g.start}return S}return 0},o=(g,x)=>{var b;if(g!==0&&x!=="primary"&&(b=e.schedule)!=null&&b.length){var v;const w=e.schedule.findItemIndexAtTime(g),S=(v=e.schedule.items)==null?void 0:v[w];if(S){const T=S[x].start-S.start;return g+T}}return g},c=()=>{const g=e.bufferedPos;return g===Number.MAX_VALUE?d("primary"):Math.max(g,0)},d=g=>{var x,b;return(x=e.primaryDetails)!=null&&x.live?e.primaryDetails.edge:((b=e.schedule)==null?void 0:b.durations[g])||0},f=(g,x)=>{var b,v;const w=e.effectivePlayingItem;if(w!=null&&(b=w.event)!=null&&b.restrictions.skip||!e.schedule)return;e.log(`seek to ${g} "${x}"`);const S=e.effectivePlayingItem,T=e.schedule.findItemIndexAtTime(g,x),k=(v=e.schedule.items)==null?void 0:v[T],E=e.getBufferingPlayer(),R=E==null?void 0:E.interstitial,K=R==null?void 0:R.appendInPlace,z=S&&e.itemsMatch(S,k);if(S&&(K||z)){const D=r(e.playingAsset),O=(D==null?void 0:D.media)||e.primaryMedia;if(O){const U=x==="primary"?O.currentTime:n(S,x,e.playingAsset,"timelinePos","currentTime"),I=g-U,F=(K?U:O.currentTime)+I;if(F>=0&&(!D||K||F<=D.duration)){O.currentTime=F;return}}}if(k){let D=g;if(x!=="primary"){const U=k[x].start,I=g-U;D=k.start+I}const O=!e.isInterstitial(k);if((!e.isInterstitial(S)||S.event.appendInPlace)&&(O||k.event.appendInPlace)){const U=e.media||(K?E==null?void 0:E.media:null);U&&(U.currentTime=D)}else if(S){const U=e.findItemIndex(S);if(T>U){const F=e.schedule.findJumpRestrictedIndex(U+1,T);if(F>U){e.setSchedulePosition(F);return}}let I=0;if(O)e.timelinePos=D,e.checkBuffer();else{const F=k.event.assetList,te=g-(k[x]||k).start;for(let le=F.length;le--;){const H=F[le];if(H.duration&&te>=H.startOffset&&te<H.startOffset+H.duration){I=le;break}}}e.setSchedulePosition(T,I)}}},u=()=>{const g=e.effectivePlayingItem;if(e.isInterstitial(g))return g;const x=s();return e.isInterstitial(x)?x:null},m={get bufferedEnd(){const g=s(),x=e.bufferingItem;if(x&&x===g){var b;return n(x,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-x.playout.start||((b=e.bufferingAsset)==null?void 0:b.startOffset)||0}return 0},get currentTime(){const g=u(),x=e.effectivePlayingItem;return x&&x===g?n(x,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-x.playout.start:0},set currentTime(g){const x=u(),b=e.effectivePlayingItem;b&&b===x&&f(g+b.playout.start,"playout")},get duration(){const g=u();return g?g.playout.end-g.playout.start:0},get assetPlayers(){var g;const x=(g=u())==null?void 0:g.event.assetList;return x?x.map(b=>e.getAssetPlayer(b.identifier)):[]},get playingIndex(){var g;const x=(g=u())==null?void 0:g.event;return x&&e.effectivePlayingAsset?x.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return u()}};return this.manager={get events(){var g;return((g=e.schedule)==null||(g=g.events)==null?void 0:g.slice(0))||[]},get schedule(){var g;return((g=e.schedule)==null||(g=g.items)==null?void 0:g.slice(0))||[]},get interstitialPlayer(){return u()?m:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return s()},get bufferingIndex(){const g=s();return e.findItemIndex(g)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const g=e.effectivePlayingItem;return e.findItemIndex(g)},primary:{get bufferedEnd(){return c()},get currentTime(){const g=e.timelinePos;return g>0?g:0},set currentTime(g){f(g,"primary")},get duration(){return d("primary")},get seekableStart(){var g;return((g=e.primaryDetails)==null?void 0:g.fragmentStart)||0}},integrated:{get bufferedEnd(){return n(s(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return n(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(g){f(g,"integrated")},get duration(){return d("integrated")},get seekableStart(){var g;return o(((g=e.primaryDetails)==null?void 0:g.fragmentStart)||0,"integrated")}},skip:()=>{const g=e.effectivePlayingItem,x=g==null?void 0:g.event;if(x&&!x.restrictions.skip){const b=e.findItemIndex(g);if(x.appendInPlace){const v=g.playout.start+g.event.duration;f(v+.001,"playout")}else e.advanceAfterAssetEnded(x,b,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const s=this.playingItem,r=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!s||!r?!1:this.findItemIndex(s)===r.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,s;if(this.mediaSelection===null)return;const r=this.waitingItem||this.playingItem;if(this.isInterstitial(r)&&!r.event.appendInPlace)return;let n=this.media;!n&&(e=this.bufferingItem)!=null&&(e=e.event)!=null&&e.appendInPlace&&(n=this.primaryMedia);const o=(s=n)==null?void 0:s.currentTime;if(!(o===void 0||!Tt(o)))return o}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,s){const r=this.getAssetPlayer(e);r&&this.transferMediaFromPlayer(r,s)}transferMediaFromPlayer(e,s){const r=e.interstitial.appendInPlace,n=e.media;if(r&&n===this.primaryMedia){if(this.bufferingAsset=null,(!s||this.isInterstitial(s)&&!s.event.appendInPlace)&&s&&n){this.detachedData={media:n};return}const o=e.transferMedia();this.log(`transfer MediaSource from ${e} ${zs(o)}`),this.detachedData=o}else s&&n&&(this.shouldPlay||(this.shouldPlay=!n.paused))}transferMediaTo(e,s){var r,n;if(e.media===s)return;let o=null;const c=this.hls,d=e!==c,f=d&&e.interstitial.appendInPlace,u=(r=this.detachedData)==null?void 0:r.mediaSource;let m;if(c.media)f&&(o=c.transferMedia(),this.detachedData=o),m="Primary";else if(u){const v=this.getBufferingPlayer();v?(o=v.transferMedia(),m=`${v}`):m="detached MediaSource"}else m="detached media";if(!o){if(u)o=this.detachedData,this.log(`using detachedData: MediaSource ${zs(o)}`);else if(!this.detachedData||c.media===s){const v=this.playerQueue;v.length>1&&v.forEach(w=>{if(d&&w.interstitial.appendInPlace!==f){const S=w.interstitial;this.clearInterstitial(w.interstitial,null),S.appendInPlace=!1,S.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${S}`)}}),this.hls.detachMedia(),this.detachedData={media:s}}}const g=o&&"mediaSource"in o&&((n=o.mediaSource)==null?void 0:n.readyState)!=="closed",x=g&&o?o:s;this.log(`${g?"transfering MediaSource":"attaching media"} to ${d?e:"Primary"} from ${m} (media.currentTime: ${s.currentTime})`);const b=this.schedule;if(x===o&&b){const v=d&&e.assetId===b.assetIdAtEnd;x.overrides={duration:b.duration,endOfStream:!d||v,cueRemoval:!d}}e.attachMedia(x)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,s=e==null?void 0:e.events;if(!s||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const r=this.timelinePos,n=this.effectivePlayingItem;if(r===-1){const o=this.hls.startPosition;if(this.log(Uh("checkStart",o)),this.timelinePos=o,s.length&&s[0].cue.pre){const c=e.findEventIndex(s[0].identifier);this.setSchedulePosition(c)}else if(o>=0||!this.primaryLive){const c=this.timelinePos=o>0?o:0,d=e.findItemIndexAtTime(c);this.setSchedulePosition(d)}}else if(n&&!this.playingItem){const o=e.findItemIndex(n);this.setSchedulePosition(o)}}advanceAssetBuffering(e,s){const r=e.event,n=r.findAssetIndex(s),o=$g(r,n);if(!r.isAssetPastPlayoutLimit(o))this.bufferedToEvent(e,o);else if(this.schedule){var c;const d=(c=this.schedule.items)==null?void 0:c[this.findItemIndex(e)+1];d&&this.bufferedToItem(d)}}advanceAfterAssetEnded(e,s,r){const n=$g(e,r);if(e.isAssetPastPlayoutLimit(n)){if(this.schedule){const o=this.schedule.items;if(o){const c=s+1,d=o.length;if(c>=d){this.setSchedulePosition(-1);return}const f=e.resumeTime;this.timelinePos<f&&(this.log(Uh("advanceAfterAssetEnded",f)),this.timelinePos=f,e.appendInPlace&&this.advanceInPlace(f),this.checkBuffer(this.bufferedPos<f)),this.setSchedulePosition(c)}}}else{if(e.appendInPlace){const o=e.assetList[n];o&&this.advanceInPlace(o.timelineStart)}this.setSchedulePosition(s,n)}}setScheduleToAssetAtTime(e,s){const r=this.schedule;if(!r)return;const n=s.parentIdentifier,o=r.getEvent(n);if(o){const c=r.findEventIndex(n),d=r.findAssetIndex(o,e);this.advanceAfterAssetEnded(o,c,d-1)}}setSchedulePosition(e,s){var r;const n=(r=this.schedule)==null?void 0:r.items;if(!n||this.playbackDisabled)return;const o=e>=0?n[e]:null;this.log(`setSchedulePosition ${e}, ${s} (${o&&Ja(o)}) pos: ${this.timelinePos}`);const c=this.waitingItem||this.playingItem,d=this.playingLastItem;if(this.isInterstitial(c)){const m=c.event,g=this.playingAsset,x=g==null?void 0:g.identifier,b=x?this.getAssetPlayer(x):null;if(b&&x&&(!this.eventItemsMatch(c,o)||s!==void 0&&x!==m.assetList[s].identifier)){var f;const v=m.findAssetIndex(g);if(this.log(`INTERSTITIAL_ASSET_ENDED ${v+1}/${m.assetList.length} ${Wl(g)}`),this.endedAsset=g,this.playingAsset=null,this.hls.trigger(Q.INTERSTITIAL_ASSET_ENDED,{asset:g,assetListIndex:v,event:m,schedule:n.slice(0),scheduleIndex:e,player:b}),c!==this.playingItem){this.itemsMatch(c,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(m,this.findItemIndex(this.playingItem),v);return}this.retreiveMediaSource(x,o),b.media&&!((f=this.detachedData)!=null&&f.mediaSource)&&b.detachMedia()}if(!this.eventItemsMatch(c,o)&&(this.endedItem=c,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${m} ${Ja(c)}`),m.hasPlayed=!0,this.hls.trigger(Q.INTERSTITIAL_ENDED,{event:m,schedule:n.slice(0),scheduleIndex:e}),m.cue.once)){var u;this.updateSchedule();const v=(u=this.schedule)==null?void 0:u.items;if(o&&v){const w=this.findItemIndex(o);this.advanceSchedule(w,v,s,c,d)}return}}this.advanceSchedule(e,n,s,c,d)}advanceSchedule(e,s,r,n,o){const c=this.schedule;if(!c)return;const d=s[e]||null,f=this.primaryMedia,u=this.playerQueue;if(u.length&&u.forEach(m=>{const g=m.interstitial,x=c.findEventIndex(g.identifier);(x<e||x>e+1)&&this.clearInterstitial(g,d)}),this.isInterstitial(d)){this.timelinePos=Math.min(Math.max(this.timelinePos,d.start),d.end);const m=d.event;if(r===void 0){r=c.findAssetIndex(m,this.timelinePos);const v=$g(m,r-1);if(m.isAssetPastPlayoutLimit(v)||m.appendInPlace&&this.timelinePos===d.end){this.advanceAfterAssetEnded(m,e,r);return}r=v}const g=this.waitingItem;this.assetsBuffered(d,f)||this.setBufferingItem(d);let x=this.preloadAssets(m,r);if(this.eventItemsMatch(d,g||n)||(this.waitingItem=d,this.log(`INTERSTITIAL_STARTED ${Ja(d)} ${m.appendInPlace?"append in place":""}`),this.hls.trigger(Q.INTERSTITIAL_STARTED,{event:m,schedule:s.slice(0),scheduleIndex:e})),!m.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${m}`);return}if(m.assetListLoader&&(m.assetListLoader.destroy(),m.assetListLoader=void 0),!f){this.log(`Waiting for attachMedia to start Interstitial ${m}`);return}this.waitingItem=this.endedItem=null,this.playingItem=d;const b=m.assetList[r];if(!b){this.advanceAfterAssetEnded(m,e,r||0);return}if(x||(x=this.getAssetPlayer(b.identifier)),x===null||x.destroyed){const v=m.assetList.length;this.warn(`asset ${r+1}/${v} player destroyed ${m}`),x=this.createAssetPlayer(m,b,r),x.loadSource()}if(!this.eventItemsMatch(d,this.bufferingItem)&&m.appendInPlace&&this.isAssetBuffered(b))return;this.startAssetPlayer(x,r,s,e,f),this.shouldPlay&&r_(x.media)}else d?(this.resumePrimary(d,e,n),this.shouldPlay&&r_(this.hls.media)):o&&this.isInterstitial(n)&&(this.endedItem=null,this.playingItem=n,n.event.appendInPlace||this.attachPrimary(c.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e;return(e=this.mediaSelection)==null?void 0:e.main.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,s,r){var n,o;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${Ja(e)}`),!((n=this.detachedData)!=null&&n.mediaSource)){let d=this.timelinePos;(d<e.start||d>=e.end)&&(d=this.getPrimaryResumption(e,s),this.log(Uh("resumePrimary",d)),this.timelinePos=d),this.attachPrimary(d,e)}if(!r)return;const c=(o=this.schedule)==null?void 0:o.items;c&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${Ja(e)}`),this.hls.trigger(Q.INTERSTITIALS_PRIMARY_RESUMED,{schedule:c.slice(0),scheduleIndex:s}),this.checkBuffer())}getPrimaryResumption(e,s){const r=e.start;if(this.primaryLive){const n=this.primaryDetails;if(s===0)return this.hls.startPosition;if(n&&(r<n.fragmentStart||r>n.edge))return this.hls.liveSyncPosition||-1}return r}isAssetBuffered(e){const s=this.getAssetPlayer(e.identifier);return s!=null&&s.hls?s.hls.bufferedToEnd:Zt.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,s,r){s?this.setBufferingItem(s):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const n=this.primaryMedia;if(!n)return;const o=this.hls;o.media?this.checkBuffer():(this.transferMediaTo(o,n),r&&this.startLoadingPrimaryAt(e,r)),r||(this.log(Uh("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,r))}startLoadingPrimaryAt(e,s){var r;const n=this.hls;!n.loadingEnabled||!n.media||Math.abs((((r=n.mainForwardBufferInfo)==null?void 0:r.start)||n.media.currentTime)-e)>.5?n.startLoad(e,s):n.bufferingEnabled||n.resumeBuffering()}onManifestLoading(){var e;this.stopLoad(),(e=this.schedule)==null||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(Q.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(Q.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,s){if(s.level===-1||!this.schedule)return;const r=this.hls.levels[s.level];if(!r.details)return;const n=Is(Is({},this.mediaSelection||this.altSelection),{},{main:r});this.mediaSelection=n,this.schedule.parseInterstitialDateRanges(n,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,s){const r=this.hls.audioTracks[s.id],n=this.mediaSelection;if(!n){this.altSelection=Is(Is({},this.altSelection),{},{audio:r});return}const o=Is(Is({},n),{},{audio:r});this.mediaSelection=o}onSubtitleTrackUpdated(e,s){const r=this.hls.subtitleTracks[s.id],n=this.mediaSelection;if(!n){this.altSelection=Is(Is({},this.altSelection),{},{subtitles:r});return}const o=Is(Is({},n),{},{subtitles:r});this.mediaSelection=o}onAudioTrackSwitching(e,s){const r=h1(s);this.playerQueue.forEach(({hls:n})=>n&&(n.setAudioOption(s)||n.setAudioOption(r)))}onSubtitleTrackSwitch(e,s){const r=h1(s);this.playerQueue.forEach(({hls:n})=>n&&(n.setSubtitleOption(s)||s.id!==-1&&n.setSubtitleOption(r)))}onBufferCodecs(e,s){const r=s.tracks;r&&(this.requiredTracks=r)}onBufferAppended(e,s){this.checkBuffer()}onBufferFlushed(e,s){const r=this.playingItem;if(r&&!this.itemsMatch(r,this.bufferingItem)&&!this.isInterstitial(r)){const n=this.timelinePos;this.bufferedPos=n,this.checkBuffer()}}onBufferedToEnd(e){if(!this.schedule)return;const s=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&s){for(let n=0;n<s.length;n++){const o=s[n];if(o.cue.post){var r;const c=this.schedule.findEventIndex(o.identifier),d=(r=this.schedule.items)==null?void 0:r[c];this.isInterstitial(d)&&this.eventItemsMatch(d,this.bufferingItem)&&this.bufferedToItem(d,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const s=this.playingItem;if(!this.playingLastItem&&s){const r=this.findItemIndex(s);this.setSchedulePosition(r+1)}else this.shouldPlay=!1}updateItem(e,s){var r;const n=(r=this.schedule)==null?void 0:r.items;if(e&&n){const o=this.findItemIndex(e,s);return n[o]||null}return null}trimInPlace(e,s){if(this.isInterstitial(e)&&e.event.appendInPlace&&s.end-e.end>.25){e.event.assetList.forEach((o,c)=>{e.event.isAssetPastPlayoutLimit(c)&&this.clearAssetPlayer(o.identifier,null)});const r=e.end+.25,n=Zt.bufferInfo(this.primaryMedia,r,0);(n.end>r||(n.nextStart||0)>r)&&(this.log(`trim buffered interstitial ${Ja(e)} (was ${Ja(s)})`),this.attachPrimary(r,null,!0),this.flushFrontBuffer(r))}}itemsMatch(e,s){return!!s&&(e===s||e.event&&s.event&&this.eventItemsMatch(e,s)||!e.event&&!s.event&&this.findItemIndex(e)===this.findItemIndex(s))}eventItemsMatch(e,s){var r;return!!s&&(e===s||e.event.identifier===((r=s.event)==null?void 0:r.identifier))}findItemIndex(e,s){return e&&this.schedule?this.schedule.findItemIndex(e,s):-1}updateSchedule(e=!1){var s;const r=this.mediaSelection;r&&((s=this.schedule)==null||s.updateSchedule(r,[],e))}checkBuffer(e){var s;const r=(s=this.schedule)==null?void 0:s.items;if(!r)return;const n=Zt.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=n.len<1),this.updateBufferedPos(n.end,r,e)}updateBufferedPos(e,s,r){const n=this.schedule,o=this.bufferingItem;if(this.bufferedPos>e||!n)return;if(s.length===1&&this.itemsMatch(s[0],o)){this.bufferedPos=e;return}const c=this.playingItem,d=this.findItemIndex(c);let f=n.findItemIndexAtTime(e);if(this.bufferedPos<e){var u;const m=this.findItemIndex(o),g=Math.min(m+1,s.length-1),x=s[g];if((f===-1&&o&&e>=o.end||(u=x.event)!=null&&u.appendInPlace&&e+.01>=x.start)&&(f=g),this.isInterstitial(o)){const b=o.event;if(g-d>1&&b.appendInPlace===!1||b.assetList.length===0&&b.assetListLoader)return}if(this.bufferedPos=e,f>m&&f>d)this.bufferedToItem(x);else{const b=this.primaryDetails;this.primaryLive&&b&&e>b.edge-b.targetduration&&x.start<b.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(x)&&this.preloadAssets(x.event,0)}}else r&&c&&!this.itemsMatch(c,o)&&(f===d?this.bufferedToItem(c):f===d+1&&this.bufferedToItem(s[f]))}assetsBuffered(e,s){return e.event.assetList.length===0?!1:!e.event.assetList.some(n=>{const o=this.getAssetPlayer(n.identifier);return!(o!=null&&o.bufferedInPlaceToEnd(s))})}setBufferingItem(e){const s=this.bufferingItem,r=this.schedule;if(!this.itemsMatch(e,s)&&r){const{items:n,events:o}=r;if(!n||!o)return s;const c=this.isInterstitial(e),d=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const f=d?d.remaining:s?s.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${Ja(e)}`+(s?` (${f.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(c){const u=r.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((m,g)=>{const x=this.getAssetPlayer(m.identifier);x&&(g===u&&x.loadSource(),x.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(u=>u.pauseBuffering());this.hls.trigger(Q.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:o.slice(0),schedule:n.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return s}bufferedToItem(e,s=0){const r=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,s);else if(r!==null){this.bufferingAsset=null;const n=this.detachedData;n?n.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const s=this.findItemIndex(e),r=this.getPrimaryResumption(e,s);this.startLoadingPrimaryAt(r)}bufferedToEvent(e,s){const r=e.event,n=r.assetList.length===0&&!r.assetListLoader,o=r.cue.once;if(n||!o){const c=this.preloadAssets(r,s);if(c!=null&&c.interstitial.appendInPlace){const d=this.primaryMedia;d&&this.bufferAssetPlayer(c,d)}}}preloadAssets(e,s){const r=e.assetUrl,n=e.assetList.length,o=n===0&&!e.assetListLoader,c=e.cue.once;if(o){const f=e.timelineStart;if(e.appendInPlace){var d;const x=this.playingItem;!this.isInterstitial(x)&&(x==null||(d=x.nextEvent)==null?void 0:d.identifier)===e.identifier&&this.flushFrontBuffer(f+.25)}let u,m=0;if(!this.playingItem&&this.primaryLive&&(m=this.hls.startPosition,m===-1&&(m=this.hls.liveSyncPosition||0)),m&&!(e.cue.pre||e.cue.post)){const x=m-f;x>0&&(u=Math.round(x*1e3)/1e3)}if(this.log(`Load interstitial asset ${s+1}/${r?1:n} ${e}${u?` live-start: ${m} start-offset: ${u}`:""}`),r)return this.createAsset(e,0,0,f,e.duration,r);const g=this.assetListLoader.loadAssetList(e,u);g&&(e.assetListLoader=g)}else if(!c&&n){for(let u=s;u<n;u++){const m=e.assetList[u],g=this.getAssetPlayerQueueIndex(m.identifier);(g===-1||this.playerQueue[g].destroyed)&&!m.error&&this.createAssetPlayer(e,m,u)}const f=e.assetList[s];if(f){const u=this.getAssetPlayer(f.identifier);return u&&u.loadSource(),u}}return null}flushFrontBuffer(e){const s=this.requiredTracks;if(!s)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(s).forEach(n=>{this.hls.trigger(Q.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:n})})}getAssetPlayerQueueIndex(e){const s=this.playerQueue;for(let r=0;r<s.length;r++)if(e===s[r].assetId)return r;return-1}getAssetPlayer(e){const s=this.getAssetPlayerQueueIndex(e);return this.playerQueue[s]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:s}=this;if(s){for(let r=0;r<e.length;r++)if(e[r].media===s)return e[r]}return null}createAsset(e,s,r,n,o,c){const d={parentIdentifier:e.identifier,identifier:zO(e,c,s),duration:o,startOffset:r,timelineStart:n,uri:c};return this.createAssetPlayer(e,d,s)}createAssetPlayer(e,s,r){const n=this.hls,o=n.userConfig;let c=o.videoPreference;const d=n.loadLevelObj||n.levels[n.currentLevel];(c||d)&&(c=Us({},c),d.videoCodec&&(c.videoCodec=d.videoCodec),d.videoRange&&(c.allowedVideoRanges=[d.videoRange]));const f=n.audioTracks[n.audioTrack],u=n.subtitleTracks[n.subtitleTrack];let m=0;if(this.primaryLive||e.appendInPlace){const R=this.timelinePos-s.timelineStart;if(R>1){const K=s.duration;K&&R<K&&(m=R)}}const g=s.identifier,x=Is(Is({},o),{},{maxMaxBufferLength:Math.min(180,n.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:n.sessionId,assetPlayerId:g,abrEwmaDefaultEstimate:n.bandwidthEstimate,interstitialsController:void 0,startPosition:m,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:c,audioPreference:f||o.audioPreference,subtitlePreference:u||o.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,s.timelineStart&&(x.timelineOffset=s.timelineStart));const b=x.cmcd;b!=null&&b.sessionId&&b.contentId&&(x.cmcd=Us({},b,{contentId:Md(s.uri)})),this.getAssetPlayer(g)&&this.warn(`Duplicate date range identifier ${e} and asset ${g}`);const v=new YO(this.HlsPlayerClass,x,e,s);this.playerQueue.push(v),e.assetList[r]=s;let w=!0;const S=R=>{if(R.live){var K;const O=new Error(`Interstitials MUST be VOD assets ${e}`),U={fatal:!0,type:Ft.OTHER_ERROR,details:ze.INTERSTITIAL_ASSET_ITEM_ERROR,error:O},I=((K=this.schedule)==null?void 0:K.findEventIndex(e.identifier))||-1;this.handleAssetItemError(U,e,I,r,O.message);return}const z=R.edge-R.fragmentStart,D=s.duration;(w||D===null||z>D)&&(w=!1,this.log(`Interstitial asset "${g}" duration change ${D} > ${z}`),s.duration=z,this.updateSchedule())};v.on(Q.LEVEL_UPDATED,(R,{details:K})=>S(K)),v.on(Q.LEVEL_PTS_UPDATED,(R,{details:K})=>S(K)),v.on(Q.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const T=(R,K)=>{const z=this.getAssetPlayer(g);if(z&&K.tracks){z.off(Q.BUFFER_CODECS,T),z.tracks=K.tracks;const D=this.primaryMedia;this.bufferingAsset===z.assetItem&&D&&!z.media&&this.bufferAssetPlayer(z,D)}};v.on(Q.BUFFER_CODECS,T);const k=()=>{var R;const K=this.getAssetPlayer(g);if(this.log(`buffered to end of asset ${K}`),!K||!this.schedule)return;const z=this.schedule.findEventIndex(e.identifier),D=(R=this.schedule.items)==null?void 0:R[z];this.isInterstitial(D)&&this.advanceAssetBuffering(D,s)};v.on(Q.BUFFERED_TO_END,k);const E=R=>()=>{if(!this.getAssetPlayer(g)||!this.schedule)return;this.shouldPlay=!0;const z=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,z,R)};return v.once(Q.MEDIA_ENDED,E(r)),v.once(Q.PLAYOUT_LIMIT_REACHED,E(1/0)),v.on(Q.ERROR,(R,K)=>{if(!this.schedule)return;const z=this.getAssetPlayer(g);if(K.details===ze.BUFFER_STALLED_ERROR){if(z!=null&&z.appendInPlace){this.handleInPlaceStall(e);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(K,e,this.schedule.findEventIndex(e.identifier),r,`Asset player error ${K.error} ${e}`)}),v.on(Q.DESTROYING,()=>{if(!this.getAssetPlayer(g)||!this.schedule)return;const K=new Error(`Asset player destroyed unexpectedly ${g}`),z={fatal:!0,type:Ft.OTHER_ERROR,details:ze.INTERSTITIAL_ASSET_ITEM_ERROR,error:K};this.handleAssetItemError(z,e,this.schedule.findEventIndex(e.identifier),r,K.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${Wl(s)}`),this.hls.trigger(Q.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:s,assetListIndex:r,event:e,player:v}),v}clearInterstitial(e,s){this.clearAssetPlayers(e,s),e.reset()}clearAssetPlayers(e,s){e.assetList.forEach(r=>{this.clearAssetPlayer(r.identifier,s)})}resetAssetPlayer(e){const s=this.getAssetPlayerQueueIndex(e);if(s!==-1){this.log(`reset asset player "${e}" after error`);const r=this.playerQueue[s];this.transferMediaFromPlayer(r,null),r.resetDetails()}}clearAssetPlayer(e,s){const r=this.getAssetPlayerQueueIndex(e);if(r!==-1){const n=this.playerQueue[r];this.log(`clear ${n} toSegment: ${s&&Ja(s)}`),this.transferMediaFromPlayer(n,s),this.playerQueue.splice(r,1),n.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,s,r,n,o){const{interstitial:c,assetItem:d,assetId:f}=e,u=c.assetList.length,m=this.playingAsset;this.endedAsset=null,this.playingAsset=d,(!m||m.identifier!==f)&&(m&&(this.clearAssetPlayer(m.identifier,r[n]),delete m.error),this.log(`INTERSTITIAL_ASSET_STARTED ${s+1}/${u} ${Wl(d)}`),this.hls.trigger(Q.INTERSTITIAL_ASSET_STARTED,{asset:d,assetListIndex:s,event:c,schedule:r.slice(0),scheduleIndex:n,player:e})),this.bufferAssetPlayer(e,o)}bufferAssetPlayer(e,s){var r,n;if(!this.schedule)return;const{interstitial:o,assetItem:c}=e,d=this.schedule.findEventIndex(o.identifier),f=(r=this.schedule.items)==null?void 0:r[d];if(!f)return;e.loadSource(),this.setBufferingItem(f),this.bufferingAsset=c;const u=this.getBufferingPlayer();if(u===e)return;const m=o.appendInPlace;if(m&&(u==null?void 0:u.interstitial.appendInPlace)===!1)return;const g=(u==null?void 0:u.tracks)||((n=this.detachedData)==null?void 0:n.tracks)||this.requiredTracks;if(m&&c!==this.playingAsset){if(!e.tracks){this.log(`Waiting for track info before buffering ${e}`);return}if(g&&!bj(g,e.tracks)){const x=new Error(`Asset ${Wl(c)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(g)}')`),b={fatal:!0,type:Ft.OTHER_ERROR,details:ze.INTERSTITIAL_ASSET_ITEM_ERROR,error:x},v=o.findAssetIndex(c);this.handleAssetItemError(b,o,d,v,x.message);return}}this.transferMediaTo(e,s)}handleInPlaceStall(e){const s=this.schedule,r=this.primaryMedia;if(!s||!r)return;const n=r.currentTime,o=s.findAssetIndex(e,n),c=e.assetList[o];if(c){const d=this.getAssetPlayer(c.identifier);if(d){const f=d.currentTime||n-c.timelineStart,u=d.duration-f;if(this.warn(`Stalled at ${f} of ${f+u} in ${d} ${e} (media.currentTime: ${n})`),f&&(u/r.playbackRate<.5||d.bufferedInPlaceToEnd(r))&&d.hls){const m=s.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,m,o)}}}}advanceInPlace(e){const s=this.primaryMedia;s&&s.currentTime<e&&(s.currentTime=e)}handleAssetItemError(e,s,r,n,o){if(e.details===ze.BUFFER_STALLED_ERROR)return;const c=s.assetList[n]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${c&&Wl(c)} ${e.error}`),!this.schedule)return;const d=(c==null?void 0:c.identifier)||"",f=this.getAssetPlayerQueueIndex(d),u=this.playerQueue[f]||null,m=this.schedule.items,g=Us({},e,{fatal:!1,errorAction:Zl(!0),asset:c,assetListIndex:n,event:s,schedule:m,scheduleIndex:r,player:u});if(this.hls.trigger(Q.INTERSTITIAL_ASSET_ERROR,g),!e.fatal)return;const x=this.playingAsset,b=this.bufferingAsset,v=new Error(o);if(c&&(this.clearAssetPlayer(d,null),c.error=v),!s.assetList.some(w=>!w.error))s.error=v;else for(let w=n;w<s.assetList.length;w++)this.resetAssetPlayer(s.assetList[w].identifier);this.updateSchedule(!0),s.error?this.primaryFallback(s):x&&x.identifier===d?this.advanceAfterAssetEnded(s,r,n):b&&b.identifier===d&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,b)}primaryFallback(e){const s=e.timelineStart,r=this.effectivePlayingItem;let n=this.timelinePos;if(r){this.log(`Fallback to primary from event "${e.identifier}" start: ${s} pos: ${n} playing: ${Ja(r)} error: ${e.error}`),n===-1&&(n=this.hls.startPosition);const c=this.updateItem(r,n);this.itemsMatch(r,c)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(s,null),this.flushFrontBuffer(s))}else if(n===-1){this.checkStart();return}if(!this.schedule)return;const o=this.schedule.findItemIndexAtTime(n);this.setSchedulePosition(o)}onAssetListLoaded(e,s){var r,n;const o=s.event,c=o.identifier,d=s.assetListResponse.ASSETS;if(!((r=this.schedule)!=null&&r.hasEvent(c)))return;const f=o.timelineStart,u=o.duration;let m=0;d.forEach((w,S)=>{const T=parseFloat(w.DURATION);this.createAsset(o,S,m,f+m,T,w.URI),m+=T}),o.duration=m,this.log(`Loaded asset-list with duration: ${m} (was: ${u}) ${o}`);const g=this.waitingItem,x=(g==null?void 0:g.event.identifier)===c;this.updateSchedule();const b=(n=this.bufferingItem)==null?void 0:n.event;if(x){var v;const w=this.schedule.findEventIndex(c),S=(v=this.schedule.items)==null?void 0:v[w];if(S){if(!this.playingItem&&this.timelinePos>S.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==w){o.error=new Error(`Interstitial ${d.length?"no longer within playback range":"asset-list is empty"} ${this.timelinePos} ${o}`),this.log(o.error.message),this.updateSchedule(!0),this.primaryFallback(o);return}this.setBufferingItem(S)}this.setSchedulePosition(w)}else if((b==null?void 0:b.identifier)===c){const w=o.assetList[0];if(w){const S=this.getAssetPlayer(w.identifier);if(b.appendInPlace){const T=this.primaryMedia;S&&T&&this.bufferAssetPlayer(S,T)}else S&&S.loadSource()}}}onError(e,s){if(this.schedule)switch(s.details){case ze.ASSET_LIST_PARSING_ERROR:case ze.ASSET_LIST_LOAD_ERROR:case ze.ASSET_LIST_LOAD_TIMEOUT:{const r=s.interstitial;r&&(this.updateSchedule(!0),this.primaryFallback(r));break}case ze.BUFFER_STALLED_ERROR:{const r=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(r)&&r.event.appendInPlace){this.handleInPlaceStall(r.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const a_=500;class ZO extends Bx{constructor(e,s,r){super(e,s,r,"subtitle-stream-controller",Rt.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(Q.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Q.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(Q.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(Q.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(Q.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(Q.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(Q.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Q.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(Q.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(Q.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(Q.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(Q.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,s){this.stopLoad(),this.state=ut.IDLE,this.setInterval(a_),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=s?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,s){this.tracksBuffered=[],super.onMediaDetaching(e,s)}onLevelLoaded(e,s){this.mainDetails=s.details}onSubtitleFragProcessed(e,s){const{frag:r,success:n}=s;if(this.fragContextChanged(r)||(ur(r)&&(this.fragPrevious=r),this.state=ut.IDLE),!n)return;const o=this.tracksBuffered[this.currentTrackId];if(!o)return;let c;const d=r.start;for(let u=0;u<o.length;u++)if(d>=o[u].start&&d<=o[u].end){c=o[u];break}const f=r.start+r.duration;c?c.end=f:(c={start:d,end:f},o.push(c)),this.fragmentTracker.fragBuffered(r),this.fragBufferedComplete(r,null),this.media&&this.tick()}onBufferFlushing(e,s){const{startOffset:r,endOffset:n}=s;if(r===0&&n!==Number.POSITIVE_INFINITY){const o=n-1;if(o<=0)return;s.endOffsetSubtitles=Math.max(0,o),this.tracksBuffered.forEach(c=>{for(let d=0;d<c.length;){if(c[d].end<=o){c.shift();continue}else if(c[d].start<o)c[d].start=o;else break;d++}}),this.fragmentTracker.removeFragmentsInRange(r,o,Rt.SUBTITLE)}}onError(e,s){const r=s.frag;(r==null?void 0:r.type)===Rt.SUBTITLE&&(s.details===ze.FRAG_GAP&&this.fragmentTracker.fragBuffered(r,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==ut.STOPPED&&(this.state=ut.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:s}){if(this.levels&&S2(this.levels,s)){this.levels=s.map(r=>new $d(r));return}this.tracksBuffered=[],this.levels=s.map(r=>{const n=new $d(r);return this.tracksBuffered[n.id]=[],n}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Rt.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,s){var r;if(this.currentTrackId=s.id,!((r=this.levels)!=null&&r.length)||this.currentTrackId===-1){this.clearInterval();return}const n=this.levels[this.currentTrackId];n!=null&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.state!==ut.STOPPED&&this.setInterval(a_)}onSubtitleTrackLoaded(e,s){var r;const{currentTrackId:n,levels:o}=this,{details:c,id:d}=s;if(!o){this.warn(`Subtitle tracks were reset while loading level ${d}`);return}const f=o[d];if(d>=o.length||!f)return;this.log(`Subtitle track ${d} loaded [${c.startSN},${c.endSN}]${c.lastPartSn?`[part-${c.lastPartSn}-${c.lastPartIndex}]`:""},duration:${c.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let u=0;if(c.live||(r=f.details)!=null&&r.live){if(c.deltaUpdateFailed)return;const g=this.mainDetails;if(!g){this.startFragRequested=!1;return}const x=g.fragments[0];if(!f.details)c.hasProgramDateTime&&g.hasProgramDateTime?(Rf(c,g),u=c.fragmentStart):x&&(u=x.start,Hp(c,u));else{var m;u=this.alignPlaylists(c,f.details,(m=this.levelLastLoaded)==null?void 0:m.details),u===0&&x&&(u=x.start,Hp(c,u))}g&&!this.startFragRequested&&this.setStartPosition(g,u)}f.details=c,this.levelLastLoaded=f,d===n&&(this.hls.trigger(Q.SUBTITLE_TRACK_UPDATED,{details:c,id:d,groupId:s.groupId}),this.tick(),c.live&&!this.fragCurrent&&this.media&&this.state===ut.IDLE&&(ol(null,c.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),f.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:s,payload:r}=e,n=s.decryptdata,o=this.hls;if(!this.fragContextChanged(s)&&r&&r.byteLength>0&&n!=null&&n.key&&n.iv&&Jl(n.method)){const c=performance.now();this.decrypter.decrypt(new Uint8Array(r),n.key.buffer,n.iv.buffer,Ox(n.method)).catch(d=>{throw o.trigger(Q.ERROR,{type:Ft.MEDIA_ERROR,details:ze.FRAG_DECRYPT_ERROR,fatal:!1,error:d,reason:d.message,frag:s}),d}).then(d=>{const f=performance.now();o.trigger(Q.FRAG_DECRYPTED,{frag:s,payload:d,stats:{tstart:c,tdecrypt:f}})}).catch(d=>{this.warn(`${d.name}: ${d.message}`),this.state=ut.IDLE})}}doTick(){if(!this.media){this.state=ut.IDLE;return}if(this.state===ut.IDLE){const{currentTrackId:e,levels:s}=this,r=s==null?void 0:s[e];if(!r||!s.length||!r.details||this.waitForLive(r))return;const{config:n}=this,o=this.getLoadPosition(),c=Zt.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],o,n.maxBufferHole),{end:d,len:f}=c,u=r.details,m=this.hls.maxBufferLength+u.levelTargetDuration;if(f>m)return;const g=u.fragments,x=g.length,b=u.edge;let v=null;const w=this.fragPrevious;if(d<b){const k=n.maxFragLookUpTolerance,E=d>b-k?0:k;v=ol(w,g,Math.max(g[0].start,d),E),!v&&w&&w.start<g[0].start&&(v=g[0])}else v=g[x-1];if(v=this.filterReplacedPrimary(v,r.details),!v)return;const S=v.sn-u.startSN,T=g[S-1];if(T&&T.cc===v.cc&&this.fragmentTracker.getState(T)===Sr.NOT_LOADED&&(v=T),this.fragmentTracker.getState(v)===Sr.NOT_LOADED){const k=this.mapToInitFragWhenRequired(v);k&&this.loadFragment(k,r,d)}}}loadFragment(e,s,r){ur(e)?super.loadFragment(e,s,r):this._loadInitSegment(e,s)}get mediaBufferTimeRanges(){return new JO(this.tracksBuffered[this.currentTrackId]||[])}}class JO{constructor(e){this.buffered=void 0;const s=(r,n,o)=>{if(n=n>>>0,n>o-1)throw new DOMException(`Failed to execute '${r}' on 'TimeRanges': The index provided (${n}) is greater than the maximum bound (${o})`);return e[n][r]};this.buffered={get length(){return e.length},end(r){return s("end",r,e.length)},start(r){return s("start",r,e.length)}}}}const eF={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},F2=a=>String.fromCharCode(eF[a]||a),en=15,Qn=100,tF={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},sF={17:2,18:4,21:6,22:8,23:10,19:13,20:15},rF={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},aF={25:2,26:4,29:6,30:8,31:10,27:13,28:15},nF=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class iF{constructor(){this.time=null,this.verboseLevel=0}log(e,s){if(this.verboseLevel>=e){const r=typeof s=="function"?s():s;Ms.log(`${this.time} [${e}] ${r}`)}}}const Io=function(e){const s=[];for(let r=0;r<e.length;r++)s.push(e[r].toString(16));return s};class B2{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const s=["foreground","underline","italics","background","flash"];for(let r=0;r<s.length;r++){const n=s[r];e.hasOwnProperty(n)&&(this[n]=e[n])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class oF{constructor(){this.uchar=" ",this.penState=new B2}reset(){this.uchar=" ",this.penState.reset()}setChar(e,s){this.uchar=e,this.penState.copy(s)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class lF{constructor(e){this.chars=[],this.pos=0,this.currPenState=new B2,this.cueStartTime=null,this.logger=void 0;for(let s=0;s<Qn;s++)this.chars.push(new oF);this.logger=e}equals(e){for(let s=0;s<Qn;s++)if(!this.chars[s].equals(e.chars[s]))return!1;return!0}copy(e){for(let s=0;s<Qn;s++)this.chars[s].copy(e.chars[s])}isEmpty(){let e=!0;for(let s=0;s<Qn;s++)if(!this.chars[s].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Qn&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Qn)}moveCursor(e){const s=this.pos+e;if(e>1)for(let r=this.pos+1;r<s+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(s)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const s=F2(e);if(this.pos>=Qn){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+s+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(s,this.currPenState),this.moveCursor(1)}clearFromPos(e){let s;for(s=e;s<Qn;s++)this.chars[s].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let s=!0;for(let r=0;r<Qn;r++){const n=this.chars[r].uchar;n!==" "&&(s=!1),e.push(n)}return s?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class Gg{constructor(e){this.rows=[],this.currRow=en-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let s=0;s<en;s++)this.rows.push(new lF(e));this.logger=e}reset(){for(let e=0;e<en;e++)this.rows[e].clear();this.currRow=en-1}equals(e){let s=!0;for(let r=0;r<en;r++)if(!this.rows[r].equals(e.rows[r])){s=!1;break}return s}copy(e){for(let s=0;s<en;s++)this.rows[s].copy(e.rows[s])}isEmpty(){let e=!0;for(let s=0;s<en;s++)if(!this.rows[s].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+zs(e));let s=e.row-1;if(this.nrRollUpRows&&s<this.nrRollUpRows-1&&(s=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==s){for(let d=0;d<en;d++)this.rows[d].clear();const o=this.currRow+1-this.nrRollUpRows,c=this.lastOutputScreen;if(c){const d=c.rows[o].cueStartTime,f=this.logger.time;if(d!==null&&f!==null&&d<f)for(let u=0;u<this.nrRollUpRows;u++)this.rows[s-this.nrRollUpRows+u+1].copy(c.rows[o+u])}}this.currRow=s;const r=this.rows[this.currRow];if(e.indent!==null){const o=e.indent,c=Math.max(o-1,0);r.setCursor(e.indent),e.color=r.chars[c].penState.foreground}const n={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(n)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+zs(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,s=this.rows.splice(e,1)[0];s.clear(),this.rows.splice(this.currRow,0,s),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const s=[];let r="",n=-1;for(let o=0;o<en;o++){const c=this.rows[o].getTextString();c&&(n=o+1,e?s.push("Row "+n+": '"+c+"'"):s.push(c.trim()))}return s.length>0&&(e?r="["+s.join(" | ")+"]":r=s.join(`
`)),r}getTextAndFormat(){return this.rows}}class n_{constructor(e,s,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=s,this.mode=null,this.verbose=0,this.displayedMemory=new Gg(r),this.nonDisplayedMemory=new Gg(r),this.lastOutputScreen=new Gg(r),this.currRollUpRow=this.displayedMemory.rows[en-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[en-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);const s=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>s+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const s={flash:!1};if(s.underline=e%2===1,s.italics=e>=46,s.italics)s.foreground="white";else{const r=Math.floor(e/2)-16,n=["white","green","blue","cyan","red","yellow","magenta"];s.foreground=n[r]}this.logger.log(2,"MIDROW: "+zs(s)),this.writeScreen.setPen(s)}outputDataUpdate(e=!1){const s=this.logger.time;s!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=s:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,s,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:s),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class i_{constructor(e,s,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=dF(),this.logger=void 0;const n=this.logger=new iF;this.channels=[null,new n_(e,s,n),new n_(e+1,r,n)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,s){this.channels[e].setHandler(s)}addData(e,s){this.logger.time=e;for(let r=0;r<s.length;r+=2){const n=s[r]&127,o=s[r+1]&127;let c=!1,d=null;if(n===0&&o===0)continue;this.logger.log(3,()=>"["+Io([s[r],s[r+1]])+"] -> ("+Io([n,o])+")");const f=this.cmdHistory;if(n>=16&&n<=31){if(cF(n,o,f)){$h(null,null,f),this.logger.log(3,()=>"Repeated command ("+Io([n,o])+") is dropped");continue}$h(n,o,this.cmdHistory),c=this.parseCmd(n,o),c||(c=this.parseMidrow(n,o)),c||(c=this.parsePAC(n,o)),c||(c=this.parseBackgroundAttributes(n,o))}else $h(null,null,f);if(!c&&(d=this.parseChars(n,o),d)){const m=this.currentChannel;m&&m>0?this.channels[m].insertChars(d):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!c&&!d&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Io([n,o])+" orig: "+Io([s[r],s[r+1]]))}}parseCmd(e,s){const r=(e===20||e===28||e===21||e===29)&&s>=32&&s<=47,n=(e===23||e===31)&&s>=33&&s<=35;if(!(r||n))return!1;const o=e===20||e===21||e===23?1:2,c=this.channels[o];return e===20||e===21||e===28||e===29?s===32?c.ccRCL():s===33?c.ccBS():s===34?c.ccAOF():s===35?c.ccAON():s===36?c.ccDER():s===37?c.ccRU(2):s===38?c.ccRU(3):s===39?c.ccRU(4):s===40?c.ccFON():s===41?c.ccRDC():s===42?c.ccTR():s===43?c.ccRTD():s===44?c.ccEDM():s===45?c.ccCR():s===46?c.ccENM():s===47&&c.ccEOC():c.ccTO(s-32),this.currentChannel=o,!0}parseMidrow(e,s){let r=0;if((e===17||e===25)&&s>=32&&s<=47){if(e===17?r=1:r=2,r!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const n=this.channels[r];return n?(n.ccMIDROW(s),this.logger.log(3,()=>"MIDROW ("+Io([e,s])+")"),!0):!1}return!1}parsePAC(e,s){let r;const n=(e>=17&&e<=23||e>=25&&e<=31)&&s>=64&&s<=127,o=(e===16||e===24)&&s>=64&&s<=95;if(!(n||o))return!1;const c=e<=23?1:2;s>=64&&s<=95?r=c===1?tF[e]:rF[e]:r=c===1?sF[e]:aF[e];const d=this.channels[c];return d?(d.setPAC(this.interpretPAC(r,s)),this.currentChannel=c,!0):!1}interpretPAC(e,s){let r;const n={color:null,italics:!1,indent:null,underline:!1,row:e};return s>95?r=s-96:r=s-64,n.underline=(r&1)===1,r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=Math.floor((r-16)/2)*4,n}parseChars(e,s){let r,n=null,o=null;if(e>=25?(r=2,o=e-8):(r=1,o=e),o>=17&&o<=19){let c;o===17?c=s+80:o===18?c=s+112:c=s+144,this.logger.log(2,()=>"Special char '"+F2(c)+"' in channel "+r),n=[c]}else e>=32&&e<=127&&(n=s===0?[e]:[e,s]);return n&&this.logger.log(3,()=>"Char codes =  "+Io(n).join(",")),n}parseBackgroundAttributes(e,s){const r=(e===16||e===24)&&s>=32&&s<=47,n=(e===23||e===31)&&s>=45&&s<=47;if(!(r||n))return!1;let o;const c={};e===16||e===24?(o=Math.floor((s-32)/2),c.background=nF[o],s%2===1&&(c.background=c.background+"_semi")):s===45?c.background="transparent":(c.foreground="black",s===47&&(c.underline=!0));const d=e<=23?1:2;return this.channels[d].setBkgData(c),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const s=this.channels[e];s&&s.reset()}$h(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let s=0;s<this.channels.length;s++){const r=this.channels[s];r&&r.cueSplitAtTime(e)}}}function $h(a,e,s){s.a=a,s.b=e}function cF(a,e,s){return s.a===a&&s.b===e}function dF(){return{a:null,b:null}}var Xx=(function(){if(kf!=null&&kf.VTTCue)return self.VTTCue;const a=["","lr","rl"],e=["start","middle","end","left","right"];function s(d,f){if(typeof f!="string"||!Array.isArray(d))return!1;const u=f.toLowerCase();return~d.indexOf(u)?u:!1}function r(d){return s(a,d)}function n(d){return s(e,d)}function o(d,...f){let u=1;for(;u<arguments.length;u++){const m=arguments[u];for(const g in m)d[g]=m[g]}return d}function c(d,f,u){const m=this,g={enumerable:!0};m.hasBeenReset=!1;let x="",b=!1,v=d,w=f,S=u,T=null,k="",E=!0,R="auto",K="start",z=50,D="middle",O=50,U="middle";Object.defineProperty(m,"id",o({},g,{get:function(){return x},set:function(I){x=""+I}})),Object.defineProperty(m,"pauseOnExit",o({},g,{get:function(){return b},set:function(I){b=!!I}})),Object.defineProperty(m,"startTime",o({},g,{get:function(){return v},set:function(I){if(typeof I!="number")throw new TypeError("Start time must be set to a number.");v=I,this.hasBeenReset=!0}})),Object.defineProperty(m,"endTime",o({},g,{get:function(){return w},set:function(I){if(typeof I!="number")throw new TypeError("End time must be set to a number.");w=I,this.hasBeenReset=!0}})),Object.defineProperty(m,"text",o({},g,{get:function(){return S},set:function(I){S=""+I,this.hasBeenReset=!0}})),Object.defineProperty(m,"region",o({},g,{get:function(){return T},set:function(I){T=I,this.hasBeenReset=!0}})),Object.defineProperty(m,"vertical",o({},g,{get:function(){return k},set:function(I){const F=r(I);if(F===!1)throw new SyntaxError("An invalid or illegal string was specified.");k=F,this.hasBeenReset=!0}})),Object.defineProperty(m,"snapToLines",o({},g,{get:function(){return E},set:function(I){E=!!I,this.hasBeenReset=!0}})),Object.defineProperty(m,"line",o({},g,{get:function(){return R},set:function(I){if(typeof I!="number"&&I!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");R=I,this.hasBeenReset=!0}})),Object.defineProperty(m,"lineAlign",o({},g,{get:function(){return K},set:function(I){const F=n(I);if(!F)throw new SyntaxError("An invalid or illegal string was specified.");K=F,this.hasBeenReset=!0}})),Object.defineProperty(m,"position",o({},g,{get:function(){return z},set:function(I){if(I<0||I>100)throw new Error("Position must be between 0 and 100.");z=I,this.hasBeenReset=!0}})),Object.defineProperty(m,"positionAlign",o({},g,{get:function(){return D},set:function(I){const F=n(I);if(!F)throw new SyntaxError("An invalid or illegal string was specified.");D=F,this.hasBeenReset=!0}})),Object.defineProperty(m,"size",o({},g,{get:function(){return O},set:function(I){if(I<0||I>100)throw new Error("Size must be between 0 and 100.");O=I,this.hasBeenReset=!0}})),Object.defineProperty(m,"align",o({},g,{get:function(){return U},set:function(I){const F=n(I);if(!F)throw new SyntaxError("An invalid or illegal string was specified.");U=F,this.hasBeenReset=!0}})),m.displayState=void 0}return c.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},c})();class uF{decode(e,s){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function U2(a){function e(r,n,o,c){return(r|0)*3600+(n|0)*60+(o|0)+parseFloat(c||0)}const s=a.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return s?parseFloat(s[2])>59?e(s[2],s[3],0,s[4]):e(s[1],s[2],s[3],s[4]):null}class hF{constructor(){this.values=Object.create(null)}set(e,s){!this.get(e)&&s!==""&&(this.values[e]=s)}get(e,s,r){return r?this.has(e)?this.values[e]:s[r]:this.has(e)?this.values[e]:s}has(e){return e in this.values}alt(e,s,r){for(let n=0;n<r.length;++n)if(s===r[n]){this.set(e,s);break}}integer(e,s){/^-?\d+$/.test(s)&&this.set(e,parseInt(s,10))}percent(e,s){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(s)){const r=parseFloat(s);if(r>=0&&r<=100)return this.set(e,r),!0}return!1}}function $2(a,e,s,r){const n=r?a.split(r):[a];for(const o in n){if(typeof n[o]!="string")continue;const c=n[o].split(s);if(c.length!==2)continue;const d=c[0],f=c[1];e(d,f)}}const Xp=new Xx(0,0,""),Gh=Xp.align==="middle"?"middle":"center";function fF(a,e,s){const r=a;function n(){const d=U2(a);if(d===null)throw new Error("Malformed timestamp: "+r);return a=a.replace(/^[^\sa-zA-Z-]+/,""),d}function o(d,f){const u=new hF;$2(d,function(x,b){let v;switch(x){case"region":for(let w=s.length-1;w>=0;w--)if(s[w].id===b){u.set(x,s[w].region);break}break;case"vertical":u.alt(x,b,["rl","lr"]);break;case"line":v=b.split(","),u.integer(x,v[0]),u.percent(x,v[0])&&u.set("snapToLines",!1),u.alt(x,v[0],["auto"]),v.length===2&&u.alt("lineAlign",v[1],["start",Gh,"end"]);break;case"position":v=b.split(","),u.percent(x,v[0]),v.length===2&&u.alt("positionAlign",v[1],["start",Gh,"end","line-left","line-right","auto"]);break;case"size":u.percent(x,b);break;case"align":u.alt(x,b,["start",Gh,"end","left","right"]);break}},/:/,/\s/),f.region=u.get("region",null),f.vertical=u.get("vertical","");let m=u.get("line","auto");m==="auto"&&Xp.line===-1&&(m=-1),f.line=m,f.lineAlign=u.get("lineAlign","start"),f.snapToLines=u.get("snapToLines",!0),f.size=u.get("size",100),f.align=u.get("align",Gh);let g=u.get("position","auto");g==="auto"&&Xp.position===50&&(g=f.align==="start"||f.align==="left"?0:f.align==="end"||f.align==="right"?100:50),f.position=g}function c(){a=a.replace(/^\s+/,"")}if(c(),e.startTime=n(),c(),a.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+r);a=a.slice(3),c(),e.endTime=n(),c(),o(a,e)}function G2(a){return a.replace(/<br(?: \/)?>/gi,`
`)}class mF{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new uF,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const s=this;e&&(s.buffer+=s.decoder.decode(e,{stream:!0}));function r(){let o=s.buffer,c=0;for(o=G2(o);c<o.length&&o[c]!=="\r"&&o[c]!==`
`;)++c;const d=o.slice(0,c);return o[c]==="\r"&&++c,o[c]===`
`&&++c,s.buffer=o.slice(c),d}function n(o){$2(o,function(c,d){},/:/)}try{let o="";if(s.state==="INITIAL"){if(!/\r\n|\n/.test(s.buffer))return this;o=r();const d=o.match(/^()?WEBVTT([ \t].*)?$/);if(!(d!=null&&d[0]))throw new Error("Malformed WebVTT signature.");s.state="HEADER"}let c=!1;for(;s.buffer;){if(!/\r\n|\n/.test(s.buffer))return this;switch(c?c=!1:o=r(),s.state){case"HEADER":/:/.test(o)?n(o):o||(s.state="ID");continue;case"NOTE":o||(s.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(o)){s.state="NOTE";break}if(!o)continue;if(s.cue=new Xx(0,0,""),s.state="CUE",o.indexOf("-->")===-1){s.cue.id=o;continue}case"CUE":if(!s.cue){s.state="BADCUE";continue}try{fF(o,s.cue,s.regionList)}catch{s.cue=null,s.state="BADCUE";continue}s.state="CUETEXT";continue;case"CUETEXT":{const d=o.indexOf("-->")!==-1;if(!o||d&&(c=!0)){s.oncue&&s.cue&&s.oncue(s.cue),s.cue=null,s.state="ID";continue}if(s.cue===null)continue;s.cue.text&&(s.cue.text+=`
`),s.cue.text+=o}continue;case"BADCUE":o||(s.state="ID")}}}catch{s.state==="CUETEXT"&&s.cue&&s.oncue&&s.oncue(s.cue),s.cue=null,s.state=s.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(s){e.onparsingerror&&e.onparsingerror(s)}return e.onflush&&e.onflush(),this}}const gF=/\r\n|\n\r|\n|\r/g,Hg=function(e,s,r=0){return e.slice(r,r+s.length)===s},pF=function(e){let s=parseInt(e.slice(-3));const r=parseInt(e.slice(-6,-4)),n=parseInt(e.slice(-9,-7)),o=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!Tt(s)||!Tt(r)||!Tt(n)||!Tt(o))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return s+=1e3*r,s+=60*1e3*n,s+=3600*1e3*o,s};function Zx(a,e,s){return Md(a.toString())+Md(e.toString())+Md(s)}const xF=function(e,s,r){let n=e[s],o=e[n.prevCC];if(!o||!o.new&&n.new){e.ccOffset=e.presentationOffset=n.start,n.new=!1;return}for(;(c=o)!=null&&c.new;){var c;e.ccOffset+=n.start-o.start,n.new=!1,n=o,o=e[n.prevCC]}e.presentationOffset=r};function yF(a,e,s,r,n,o,c){const d=new mF,f=ja(new Uint8Array(a)).trim().replace(gF,`
`).split(`
`),u=[],m=e?NP(e.baseTime,e.timescale):0;let g="00:00.000",x=0,b=0,v,w=!0;d.oncue=function(S){const T=s[r];let k=s.ccOffset;const E=(x-m)/9e4;if(T!=null&&T.new&&(b!==void 0?k=s.ccOffset=T.start:xF(s,r,E)),E){if(!e){v=new Error("Missing initPTS for VTT MPEGTS");return}k=E-s.presentationOffset}const R=S.endTime-S.startTime,K=Sa((S.startTime+k-b)*9e4,n*9e4)/9e4;S.startTime=Math.max(K,0),S.endTime=Math.max(K+R,0);const z=S.text.trim();S.text=decodeURIComponent(encodeURIComponent(z)),S.id||(S.id=Zx(S.startTime,S.endTime,z)),S.endTime>0&&u.push(S)},d.onparsingerror=function(S){v=S},d.onflush=function(){if(v){c(v);return}o(u)},f.forEach(S=>{if(w)if(Hg(S,"X-TIMESTAMP-MAP=")){w=!1,S.slice(16).split(",").forEach(T=>{Hg(T,"LOCAL:")?g=T.slice(6):Hg(T,"MPEGTS:")&&(x=parseInt(T.slice(7)))});try{b=pF(g)/1e3}catch(T){v=T}return}else S===""&&(w=!1);d.parse(S+`
`)}),d.flush()}const Vg="stpp.ttml.im1t",H2=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,V2=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,bF={left:"start",center:"center",right:"end",start:"start",end:"end"};function o_(a,e,s,r){const n=ls(new Uint8Array(a),["mdat"]);if(n.length===0){r(new Error("Could not parse IMSC1 mdat"));return}const o=n.map(d=>ja(d)),c=_P(e.baseTime,1,e.timescale);try{o.forEach(d=>s(vF(d,c)))}catch(d){r(d)}}function vF(a,e){const n=new DOMParser().parseFromString(a,"text/xml").getElementsByTagName("tt")[0];if(!n)throw new Error("Invalid ttml");const o={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},c=Object.keys(o).reduce((g,x)=>(g[x]=n.getAttribute(`ttp:${x}`)||o[x],g),{}),d=n.getAttribute("xml:space")!=="preserve",f=l_(zg(n,"styling","style")),u=l_(zg(n,"layout","region")),m=zg(n,"body","[begin]");return[].map.call(m,g=>{const x=z2(g,d);if(!x||!g.hasAttribute("begin"))return null;const b=Kg(g.getAttribute("begin"),c),v=Kg(g.getAttribute("dur"),c);let w=Kg(g.getAttribute("end"),c);if(b===null)throw c_(g);if(w===null){if(v===null)throw c_(g);w=b+v}const S=new Xx(b-e,w-e,x);S.id=Zx(S.startTime,S.endTime,S.text);const T=u[g.getAttribute("region")],k=f[g.getAttribute("style")],E=wF(T,k,f),{textAlign:R}=E;if(R){const K=bF[R];K&&(S.lineAlign=K),S.align=R}return Us(S,E),S}).filter(g=>g!==null)}function zg(a,e,s){const r=a.getElementsByTagName(e)[0];return r?[].slice.call(r.querySelectorAll(s)):[]}function l_(a){return a.reduce((e,s)=>{const r=s.getAttribute("xml:id");return r&&(e[r]=s),e},{})}function z2(a,e){return[].slice.call(a.childNodes).reduce((s,r,n)=>{var o;return r.nodeName==="br"&&n?s+`
`:(o=r.childNodes)!=null&&o.length?z2(r,e):e?s+r.textContent.trim().replace(/\s+/g," "):s+r.textContent},"")}function wF(a,e,s){const r="http://www.w3.org/ns/ttml#styling";let n=null;const o=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],c=a!=null&&a.hasAttribute("style")?a.getAttribute("style"):null;return c&&s.hasOwnProperty(c)&&(n=s[c]),o.reduce((d,f)=>{const u=qg(e,r,f)||qg(a,r,f)||qg(n,r,f);return u&&(d[f]=u),d},{})}function qg(a,e,s){return a&&a.hasAttributeNS(e,s)?a.getAttributeNS(e,s):null}function c_(a){return new Error(`Could not parse ttml timestamp ${a}`)}function Kg(a,e){if(!a)return null;let s=U2(a);return s===null&&(H2.test(a)?s=SF(a,e):V2.test(a)&&(s=_F(a,e))),s}function SF(a,e){const s=H2.exec(a),r=(s[4]|0)+(s[5]|0)/e.subFrameRate;return(s[1]|0)*3600+(s[2]|0)*60+(s[3]|0)+r/e.frameRate}function _F(a,e){const s=V2.exec(a),r=Number(s[1]);switch(s[2]){case"h":return r*3600;case"m":return r*60;case"ms":return r*1e3;case"f":return r/e.frameRate;case"t":return r/e.tickRate}return r}class Hh{constructor(e,s){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=s}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,s,r){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=s,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class NF{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=u_(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(Q.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Q.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Q.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Q.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(Q.FRAG_LOADING,this.onFragLoading,this),e.on(Q.FRAG_LOADED,this.onFragLoaded,this),e.on(Q.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(Q.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(Q.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(Q.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(Q.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(Q.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Q.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Q.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Q.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(Q.FRAG_LOADING,this.onFragLoading,this),e.off(Q.FRAG_LOADED,this.onFragLoaded,this),e.off(Q.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(Q.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(Q.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(Q.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(Q.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new Hh(this,"textTrack1"),s=new Hh(this,"textTrack2"),r=new Hh(this,"textTrack3"),n=new Hh(this,"textTrack4");this.cea608Parser1=new i_(1,e,s),this.cea608Parser2=new i_(3,r,n)}addCues(e,s,r,n,o){let c=!1;for(let d=o.length;d--;){const f=o[d],u=jF(f[0],f[1],s,r);if(u>=0&&(f[0]=Math.min(f[0],s),f[1]=Math.max(f[1],r),c=!0,u/(r-s)>.5))return}if(c||o.push([s,r]),this.config.renderTextTracksNatively){const d=this.captionsTracks[e];this.Cues.newCue(d,s,r,n)}else{const d=this.Cues.newCue(null,s,r,n);this.hls.trigger(Q.CUES_PARSED,{type:"captions",cues:d,track:e})}}onInitPtsFound(e,{frag:s,id:r,initPTS:n,timescale:o,trackId:c}){const{unparsedVttFrags:d}=this;r===Rt.MAIN&&(this.initPTS[s.cc]={baseTime:n,timescale:o,trackId:c}),d.length&&(this.unparsedVttFrags=[],d.forEach(f=>{this.initPTS[f.frag.cc]?this.onFragLoaded(Q.FRAG_LOADED,f):this.hls.trigger(Q.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:f.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,s){const{media:r}=this;if(r)for(let n=0;n<r.textTracks.length;n++){const o=r.textTracks[n];if(d_(o,{name:e,lang:s,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return o}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:s,captionsTracks:r,media:n}=this,{label:o,languageCode:c}=s[e],d=this.getExistingTrack(o,c);if(d)r[e]=d,Xl(r[e]),M2(r[e],n);else{const f=this.createTextTrack("captions",o,c);f&&(f[e]=!0,r[e]=f)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const s=this.captionsProperties[e];if(!s)return;const r=s.label,n={_id:e,label:r,kind:"captions",default:s.media?!!s.media.default:!1,closedCaptions:s.media};this.nonNativeCaptionsTracks[e]=n,this.hls.trigger(Q.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[n]})}createTextTrack(e,s,r){const n=this.media;if(n)return n.addTextTrack(e,s,r)}onMediaAttaching(e,s){this.media=s.media,s.mediaSource||this._cleanTracks()}onMediaDetaching(e,s){const r=!!s.transferMedia;if(this.media=null,r)return;const{captionsTracks:n}=this;Object.keys(n).forEach(o=>{Xl(n[o]),delete n[o]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=u_(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const s=e.textTracks;if(s)for(let r=0;r<s.length;r++)Xl(s[r])}onSubtitleTracksUpdated(e,s){const r=s.subtitleTracks||[],n=r.some(o=>o.textCodec===Vg);if(this.config.enableWebVTT||n&&this.config.enableIMSC1){if(S2(this.tracks,r)){this.tracks=r;return}if(this.textTracks=[],this.tracks=r,this.config.renderTextTracksNatively){const c=this.media,d=c?uf(c.textTracks):null;if(this.tracks.forEach((f,u)=>{let m;if(d){let g=null;for(let x=0;x<d.length;x++)if(d[x]&&d_(d[x],f)){g=d[x],d[x]=null;break}g&&(m=g)}if(m)Xl(m);else{const g=q2(f);m=this.createTextTrack(g,f.name,f.lang),m&&(m.mode="disabled")}m&&this.textTracks.push(m)}),d!=null&&d.length){const f=d.filter(u=>u!==null).map(u=>u.label);f.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${f.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const c=this.tracks.map(d=>({label:d.name,kind:d.type.toLowerCase(),default:d.default,subtitleTrack:d}));this.hls.trigger(Q.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:c})}}}onManifestLoaded(e,s){this.config.enableCEA708Captions&&s.captions&&s.captions.forEach(r=>{const n=/(?:CC|SERVICE)([1-4])/.exec(r.instreamId);if(!n)return;const o=`textTrack${n[1]}`,c=this.captionsProperties[o];c&&(c.label=r.name,r.lang&&(c.languageCode=r.lang),c.media=r)})}closedCaptionsForLevel(e){const s=this.hls.levels[e.level];return s==null?void 0:s.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,s){if(this.enabled&&s.frag.type===Rt.MAIN){var r,n;const{cea608Parser1:o,cea608Parser2:c,lastSn:d}=this,{cc:f,sn:u}=s.frag,m=(r=(n=s.part)==null?void 0:n.index)!=null?r:-1;o&&c&&(u!==d+1||u===d&&m!==this.lastPartIndex+1||f!==this.lastCc)&&(o.reset(),c.reset()),this.lastCc=f,this.lastSn=u,this.lastPartIndex=m}}onFragLoaded(e,s){const{frag:r,payload:n}=s;if(r.type===Rt.SUBTITLE)if(n.byteLength){const o=r.decryptdata,c="stats"in s;if(o==null||!o.encrypted||c){const d=this.tracks[r.level],f=this.vttCCs;f[r.cc]||(f[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),d&&d.textCodec===Vg?this._parseIMSC1(r,n):this._parseVTTs(s)}}else this.hls.trigger(Q.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,s){const r=this.hls;o_(s,this.initPTS[e.cc],n=>{this._appendCues(n,e.level),r.trigger(Q.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},n=>{r.logger.log(`Failed to parse IMSC1: ${n}`),r.trigger(Q.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:n})})}_parseVTTs(e){var s;const{frag:r,payload:n}=e,{initPTS:o,unparsedVttFrags:c}=this,d=o.length-1;if(!o[r.cc]&&d===-1){c.push(e);return}const f=this.hls,u=(s=r.initSegment)!=null&&s.data?Ha(r.initSegment.data,new Uint8Array(n)).buffer:n;yF(u,this.initPTS[r.cc],this.vttCCs,r.cc,r.start,m=>{this._appendCues(m,r.level),f.trigger(Q.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:r})},m=>{const g=m.message==="Missing initPTS for VTT MPEGTS";g?c.push(e):this._fallbackToIMSC1(r,n),f.logger.log(`Failed to parse VTT cue: ${m}`),!(g&&d>r.cc)&&f.trigger(Q.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:m})})}_fallbackToIMSC1(e,s){const r=this.tracks[e.level];r.textCodec||o_(s,this.initPTS[e.cc],()=>{r.textCodec=Vg,this._parseIMSC1(e,s)},()=>{r.textCodec="wvtt"})}_appendCues(e,s){const r=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[s];if(!n||n.mode==="disabled")return;e.forEach(o=>P2(n,o))}else{const n=this.tracks[s];if(!n)return;const o=n.default?"default":"subtitles"+s;r.trigger(Q.CUES_PARSED,{type:"subtitles",cues:e,track:o})}}onFragDecrypted(e,s){const{frag:r}=s;r.type===Rt.SUBTITLE&&this.onFragLoaded(Q.FRAG_LOADED,s)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,s){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:r,samples:n}=s;if(!(r.type===Rt.MAIN&&this.closedCaptionsForLevel(r)==="NONE"))for(let o=0;o<n.length;o++){const c=n[o].bytes;if(c){this.cea608Parser1||this.initCea608Parsers();const d=this.extractCea608Data(c);this.cea608Parser1.addData(n[o].pts,d[0]),this.cea608Parser2.addData(n[o].pts,d[1])}}}onBufferFlushing(e,{startOffset:s,endOffset:r,endOffsetSubtitles:n,type:o}){const{media:c}=this;if(!(!c||c.currentTime<r)){if(!o||o==="video"){const{captionsTracks:d}=this;Object.keys(d).forEach(f=>Qp(d[f],s,r))}if(this.config.renderTextTracksNatively&&s===0&&n!==void 0){const{textTracks:d}=this;Object.keys(d).forEach(f=>Qp(d[f],s,n))}}}extractCea608Data(e){const s=[[],[]],r=e[0]&31;let n=2;for(let o=0;o<r;o++){const c=e[n++],d=127&e[n++],f=127&e[n++];if(d===0&&f===0)continue;if((4&c)!==0){const m=3&c;(m===0||m===1)&&(s[m].push(d),s[m].push(f))}}return s}}function q2(a){return a.characteristics&&/transcribes-spoken-dialog/gi.test(a.characteristics)&&/describes-music-and-sound/gi.test(a.characteristics)?"captions":"subtitles"}function d_(a,e){return!!a&&a.kind===q2(e)&&qp(e,a)}function jF(a,e,s,r){return Math.min(e,r)-Math.max(a,s)}function u_(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const EF=/\s/,TF={newCue(a,e,s,r){const n=[];let o,c,d,f,u;const m=self.VTTCue||self.TextTrackCue;for(let x=0;x<r.rows.length;x++)if(o=r.rows[x],d=!0,f=0,u="",!o.isEmpty()){var g;for(let w=0;w<o.chars.length;w++)EF.test(o.chars[w].uchar)&&d?f++:(u+=o.chars[w].uchar,d=!1);o.cueStartTime=e,e===s&&(s+=1e-4),f>=16?f--:f++;const b=G2(u.trim()),v=Zx(e,s,b);a!=null&&(g=a.cues)!=null&&g.getCueById(v)||(c=new m(e,s,b),c.id=v,c.line=x+1,c.align="left",c.position=10+Math.min(80,Math.floor(f*8/32)*10),n.push(c))}return a&&n.length&&(n.sort((x,b)=>x.line==="auto"||b.line==="auto"?0:x.line>8&&b.line>8?b.line-x.line:x.line-b.line),n.forEach(x=>P2(a,x))),n}};function AF(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const CF=/(\d+)-(\d+)\/(\d+)/;class h_{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||DF,this.controller=new self.AbortController,this.stats=new kx}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,s,r){const n=this.stats;if(n.loading.start)throw new Error("Loader can only be used once.");n.loading.start=self.performance.now();const o=kF(e,this.controller.signal),c=e.responseType==="arraybuffer",d=c?"byteLength":"length",{maxTimeToFirstByteMs:f,maxLoadTimeMs:u}=s.loadPolicy;this.context=e,this.config=s,this.callbacks=r,this.request=this.fetchSetup(e,o),self.clearTimeout(this.requestTimeout),s.timeout=f&&Tt(f)?f:u,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(n,e,this.response))},s.timeout),(Vd(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(g=>{var x;this.response=this.loader=g;const b=Math.max(self.performance.now(),n.loading.start);if(self.clearTimeout(this.requestTimeout),s.timeout=u,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(n,e,this.response))},u-(b-n.loading.start)),!g.ok){const{status:w,statusText:S}=g;throw new IF(S||"fetch, bad network response",w,g)}n.loading.first=b,n.total=LF(g.headers)||n.total;const v=(x=this.callbacks)==null?void 0:x.onProgress;return v&&Tt(s.highWaterMark)?this.loadProgressively(g,n,e,s.highWaterMark,v):c?g.arrayBuffer():e.responseType==="json"?g.json():g.text()}).then(g=>{var x,b;const v=this.response;if(!v)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),n.loading.end=Math.max(self.performance.now(),n.loading.first);const w=g[d];w&&(n.loaded=n.total=w);const S={url:v.url,data:g,code:v.status},T=(x=this.callbacks)==null?void 0:x.onProgress;T&&!Tt(s.highWaterMark)&&T(n,e,g,v),(b=this.callbacks)==null||b.onSuccess(S,n,e,v)}).catch(g=>{var x;if(self.clearTimeout(this.requestTimeout),n.aborted)return;const b=g&&g.code||0,v=g?g.message:null;(x=this.callbacks)==null||x.onError({code:b,text:v},e,g?g.details:null,n)})}getCacheAge(){let e=null;if(this.response){const s=this.response.headers.get("age");e=s?parseFloat(s):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,s,r,n=0,o){const c=new s2,d=e.body.getReader(),f=()=>d.read().then(u=>{if(u.done)return c.dataLength&&o(s,r,c.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const m=u.value,g=m.length;return s.loaded+=g,g<n||c.dataLength?(c.push(m),c.dataLength>=n&&o(s,r,c.flush().buffer,e)):o(s,r,m.buffer,e),f()}).catch(()=>Promise.reject());return f()}}function kF(a,e){const s={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Us({},a.headers))};return a.rangeEnd&&s.headers.set("Range","bytes="+a.rangeStart+"-"+String(a.rangeEnd-1)),s}function RF(a){const e=CF.exec(a);if(e)return parseInt(e[2])-parseInt(e[1])+1}function LF(a){const e=a.get("Content-Range");if(e){const r=RF(e);if(Tt(r))return r}const s=a.get("Content-Length");if(s)return parseInt(s)}function DF(a,e){return new self.Request(a.url,e)}class IF extends Error{constructor(e,s,r){super(e),this.code=void 0,this.details=void 0,this.code=s,this.details=r}}const MF=/^age:\s*[\d.]+\s*$/im;class K2{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new kx,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,s,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=s,this.callbacks=r,this.loadInternal()}loadInternal(){const{config:e,context:s}=this;if(!e||!s)return;const r=this.loader=new self.XMLHttpRequest,n=this.stats;n.loading.first=0,n.loaded=0,n.aborted=!1;const o=this.xhrSetup;o?Promise.resolve().then(()=>{if(!(this.loader!==r||this.stats.aborted))return o(r,s.url)}).catch(c=>{if(!(this.loader!==r||this.stats.aborted))return r.open("GET",s.url,!0),o(r,s.url)}).then(()=>{this.loader!==r||this.stats.aborted||this.openAndSendXhr(r,s,e)}).catch(c=>{var d;(d=this.callbacks)==null||d.onError({code:r.status,text:c.message},s,r,n)}):this.openAndSendXhr(r,s,e)}openAndSendXhr(e,s,r){e.readyState||e.open("GET",s.url,!0);const n=s.headers,{maxTimeToFirstByteMs:o,maxLoadTimeMs:c}=r.loadPolicy;if(n)for(const d in n)e.setRequestHeader(d,n[d]);s.rangeEnd&&e.setRequestHeader("Range","bytes="+s.rangeStart+"-"+(s.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=s.responseType,self.clearTimeout(this.requestTimeout),r.timeout=o&&Tt(o)?o:c,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()}readystatechange(){const{context:e,loader:s,stats:r}=this;if(!e||!s)return;const n=s.readyState,o=this.config;if(!r.aborted&&n>=2&&(r.loading.first===0&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),o.timeout!==o.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),o.timeout=o.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),o.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),n===4)){self.clearTimeout(this.requestTimeout),s.onreadystatechange=null,s.onprogress=null;const u=s.status,m=s.responseType==="text"?s.responseText:null;if(u>=200&&u<300){const v=m??s.response;if(v!=null){var c,d;r.loading.end=Math.max(self.performance.now(),r.loading.first);const w=s.responseType==="arraybuffer"?v.byteLength:v.length;r.loaded=r.total=w,r.bwEstimate=r.total*8e3/(r.loading.end-r.loading.first);const S=(c=this.callbacks)==null?void 0:c.onProgress;S&&S(r,e,v,s);const T={url:s.responseURL,data:v,code:u};(d=this.callbacks)==null||d.onSuccess(T,r,e,s);return}}const g=o.loadPolicy.errorRetry,x=r.retry,b={url:e.url,data:void 0,code:u};if(Af(g,x,!1,b))this.retry(g);else{var f;Ms.error(`${u} while loading ${e.url}`),(f=this.callbacks)==null||f.onError({code:u,text:s.statusText},e,s,r)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,s=this.stats.retry;if(Af(e,s,!0))this.retry(e);else{var r;Ms.warn(`timeout while loading ${(r=this.context)==null?void 0:r.url}`);const n=this.callbacks;n&&(this.abortInternal(),n.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:s,stats:r}=this;this.retryDelay=Ix(e,r.retry),r.retry++,Ms.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${s==null?void 0:s.url}, retrying ${r.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const s=this.stats;s.loaded=e.loaded,e.lengthComputable&&(s.total=e.total)}getCacheAge(){let e=null;if(this.loader&&MF.test(this.loader.getAllResponseHeaders())){const s=this.loader.getResponseHeader("age");e=s?parseFloat(s):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const PF={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},OF=Is(Is({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:K2,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:WM,bufferController:BP,capLevelController:Yx,errorController:e6,fpsController:UO,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:zj,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:PF},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},FF()),{},{subtitleStreamController:ZO,subtitleTrackController:HO,timelineController:NF,audioStreamController:MP,audioTrackController:PP,emeController:ec,cmcdController:PO,contentSteeringController:FO,interstitialsController:XO});function FF(){return{cueHandler:TF,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function BF(a,e,s){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const r=Zp(a),n=["manifest","level","frag"],o=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return n.forEach(c=>{const d=`${c==="level"?"playlist":c}LoadPolicy`,f=e[d]===void 0,u=[];o.forEach(m=>{const g=`${c}Loading${m}`,x=e[g];if(x!==void 0&&f){u.push(g);const b=r[d].default;switch(e[d]={default:b},m){case"TimeOut":b.maxLoadTimeMs=x,b.maxTimeToFirstByteMs=x;break;case"MaxRetry":b.errorRetry.maxNumRetry=x,b.timeoutRetry.maxNumRetry=x;break;case"RetryDelay":b.errorRetry.retryDelayMs=x,b.timeoutRetry.retryDelayMs=x;break;case"MaxRetryTimeout":b.errorRetry.maxRetryDelayMs=x,b.timeoutRetry.maxRetryDelayMs=x;break}}}),u.length&&s.warn(`hls.js config: "${u.join('", "')}" setting(s) are deprecated, use "${d}": ${zs(e[d])}`)}),Is(Is({},r),e)}function Zp(a){return a&&typeof a=="object"?Array.isArray(a)?a.map(Zp):Object.keys(a).reduce((e,s)=>(e[s]=Zp(a[s]),e),{}):a}function UF(a,e){const s=a.loader;s!==h_&&s!==K2?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),a.progressive=!1):AF()&&(a.loader=h_,a.progressive=!0,a.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const hf=2,$F=.1,GF=.05,HF=100;class VF extends Uj{constructor(e,s){super("gap-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var r;(r=this.media)!=null&&r.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var r;this.ended=((r=this.media)==null?void 0:r.currentTime)||1,this.hls.trigger(Q.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=s,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(Q.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Q.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Q.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(Q.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Q.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Q.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,s){this.setInterval(HF),this.mediaSource=s.mediaSource;const r=this.media=s.media;qr(r,"playing",this.onMediaPlaying),qr(r,"waiting",this.onMediaWaiting),qr(r,"ended",this.onMediaEnded)}onMediaDetaching(e,s){this.clearInterval();const{media:r}=this;r&&(na(r,"playing",this.onMediaPlaying),na(r,"waiting",this.onMediaWaiting),na(r,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,s){this.buffered=s.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const s=this.media.currentTime;this.poll(s,this.lastCurrentTime),this.lastCurrentTime=s}poll(e,s){var r,n;const o=(r=this.hls)==null?void 0:r.config;if(!o)return;const c=this.media;if(!c)return;const{seeking:d}=c,f=this.seeking&&!d,u=!this.seeking&&d,m=c.paused&&!d||c.ended||c.playbackRate===0;if(this.seeking=d,e!==s){s&&(this.ended=0),this.moved=!0,d||(this.nudgeRetry=0,o.nudgeOnVideoHole&&!m&&e>s&&this.nudgeOnVideoHole(e,s)),this.waiting===0&&this.stallResolved(e);return}if(u||f){f&&this.stallResolved(e);return}if(m){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&c.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(Q.MEDIA_ENDED,{stalled:!1}));return}if(!Zt.getBuffered(c).length){this.nudgeRetry=0;return}const g=Zt.bufferInfo(c,e,0),x=g.nextStart||0,b=this.fragmentTracker;if(d&&b&&this.hls){const z=f_(this.hls.inFlightFragments,e),D=g.len>hf,O=!x||z||x-e>hf&&!b.getPartialFragment(e);if(D||O)return;this.moved=!1}const v=(n=this.hls)==null?void 0:n.latestLevelDetails;if(!this.moved&&this.stalled!==null&&b){if(!(g.len>0)&&!x)return;const D=Math.max(x,g.start||0)-e,U=!!(v!=null&&v.live)?v.targetduration*2:hf,I=Vh(e,b);if(D>0&&(D<=U||I)){c.paused||this._trySkipBufferHole(I);return}}const w=o.detectStallWithCurrentTimeMs,S=self.performance.now(),T=this.waiting;let k=this.stalled;if(k===null)if(T>0&&S-T<w)k=this.stalled=T;else{this.stalled=S;return}const E=S-k;if(!d&&(E>=w||T)&&this.hls){var R;if(((R=this.mediaSource)==null?void 0:R.readyState)==="ended"&&!(v!=null&&v.live)&&Math.abs(e-((v==null?void 0:v.edge)||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(Q.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(g),!this.media||!this.hls)return}const K=Zt.bufferInfo(c,e,o.maxBufferHole);this._tryFixBufferStall(K,E,e)}stallResolved(e){const s=this.stalled;if(s&&this.hls&&(this.stalled=null,this.stallReported)){const r=self.performance.now()-s;this.log(`playback not stuck anymore @${e}, after ${Math.round(r)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(Q.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,s){var r;const n=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(r=this.buffered.audio)!=null&&r.length&&n&&n.length>1&&e>n.end(0)){const o=Zt.bufferedInfo(Zt.timeRangesToArray(this.buffered.audio),e,0);if(o.len>1&&s>=o.start){const c=Zt.timeRangesToArray(n),d=Zt.bufferedInfo(c,s,0).bufferedIndex;if(d>-1&&d<c.length-1){const f=Zt.bufferedInfo(c,e,0).bufferedIndex,u=c[d].end,m=c[d+1].start;if((f===-1||f>d)&&m-u<1&&e-u<2){const g=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${u} -> ${m} buffered index: ${f}`);this.warn(g.message),this.media.currentTime+=1e-6;let x=Vh(e,this.fragmentTracker);x&&"fragment"in x?x=x.fragment:x||(x=void 0);const b=Zt.bufferInfo(this.media,e,0);this.hls.trigger(Q.ERROR,{type:Ft.MEDIA_ERROR,details:ze.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:g,reason:g.message,frag:x,buffer:b.len,bufferInfo:b})}}}}}_tryFixBufferStall(e,s,r){var n,o;const{fragmentTracker:c,media:d}=this,f=(n=this.hls)==null?void 0:n.config;if(!d||!c||!f)return;const u=(o=this.hls)==null?void 0:o.latestLevelDetails,m=Vh(r,c);if((m||u!=null&&u.live&&r<u.fragmentStart)&&(this._trySkipBufferHole(m)||!this.media))return;const g=e.buffered,x=this.adjacentTraversal(e,r);(g&&g.length>1&&e.len>f.maxBufferHole||e.nextStart&&(e.nextStart-r<f.maxBufferHole||x))&&(s>f.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,s){const r=this.fragmentTracker,n=e.nextStart;if(r&&n){const o=r.getFragAtPos(s,Rt.MAIN),c=r.getFragAtPos(n,Rt.MAIN);if(o&&c)return c.sn-o.sn<2}return!1}_reportStall(e){const{hls:s,media:r,stallReported:n,stalled:o}=this;if(!n&&o!==null&&r&&s){this.stallReported=!0;const c=new Error(`Playback stalling at @${r.currentTime} due to low buffer (${zs(e)})`);this.warn(c.message),s.trigger(Q.ERROR,{type:Ft.MEDIA_ERROR,details:ze.BUFFER_STALLED_ERROR,fatal:!1,error:c,buffer:e.len,bufferInfo:e,stalled:{start:o}})}}_trySkipBufferHole(e){var s;const{fragmentTracker:r,media:n}=this,o=(s=this.hls)==null?void 0:s.config;if(!n||!r||!o)return 0;const c=n.currentTime,d=Zt.bufferInfo(n,c,0),f=c<d.start?d.start:d.nextStart;if(f&&this.hls){const m=d.len<=o.maxBufferHole,g=d.len>0&&d.len<1&&n.readyState<3,x=f-c;if(x>0&&(m||g)){if(x>o.maxBufferHole){let v=!1;if(c===0){const w=r.getAppendedFrag(0,Rt.MAIN);w&&f<w.end&&(v=!0)}if(!v&&e){var u;if(!((u=this.hls.loadLevelObj)!=null&&u.details)||f_(this.hls.inFlightFragments,f))return 0;let S=!1,T=e.end;for(;T<f;){const k=Vh(T,r);if(k)T+=k.duration;else{S=!0;break}}if(S)return 0}}const b=Math.max(f+GF,c+$F);if(this.warn(`skipping hole, adjusting currentTime from ${c} to ${b}`),this.moved=!0,n.currentTime=b,!(e!=null&&e.gap)){const v=new Error(`fragment loaded with buffer holes, seeking from ${c} to ${b}`),w={type:Ft.MEDIA_ERROR,details:ze.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:v,reason:v.message,buffer:d.len,bufferInfo:d};e&&("fragment"in e?w.part=e:w.frag=e),this.hls.trigger(Q.ERROR,w)}return b}}return 0}_tryNudgeBuffer(e){const{hls:s,media:r,nudgeRetry:n}=this,o=s==null?void 0:s.config;if(!r||!o)return 0;const c=r.currentTime;if(this.nudgeRetry++,n<o.nudgeMaxRetry){const d=c+(n+1)*o.nudgeOffset,f=new Error(`Nudging 'currentTime' from ${c} to ${d}`);this.warn(f.message),r.currentTime=d,s.trigger(Q.ERROR,{type:Ft.MEDIA_ERROR,details:ze.BUFFER_NUDGE_ON_STALL,error:f,fatal:!1,buffer:e.len,bufferInfo:e})}else{const d=new Error(`Playhead still not moving while enough data buffered @${c} after ${o.nudgeMaxRetry} nudges`);this.error(d.message),s.trigger(Q.ERROR,{type:Ft.MEDIA_ERROR,details:ze.BUFFER_STALLED_ERROR,error:d,fatal:!0,buffer:e.len,bufferInfo:e})}}}function f_(a,e){const s=m_(a.main);if(s&&s.start<=e)return s;const r=m_(a.audio);return r&&r.start<=e?r:null}function m_(a){if(!a)return null;switch(a.state){case ut.IDLE:case ut.STOPPED:case ut.ENDED:case ut.ERROR:return null}return a.frag}function Vh(a,e){return e.getAppendedFrag(a,Rt.MAIN)||e.getPartialFragment(a)}const zF=.25;function Jp(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function Yg(a,e,s,r,n){let o=new a(e,s,"");try{o.value=r,n&&(o.type=n)}catch{o=new a(e,s,zs(n?Is({type:n},r):r))}return o}const zh=(()=>{const a=Jp();try{a&&new a(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class qF{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(Q.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e&&(e.on(Q.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Q.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Q.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Q.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(Q.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Q.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(Q.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(Q.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Q.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Q.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Q.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(Q.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Q.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(Q.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(e,s){var r;this.media=s.media,((r=s.overrides)==null?void 0:r.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var e;const s=(e=this.hls)==null?void 0:e.latestLevelDetails;s&&this.updateDateRangeCues(s)}onMediaDetaching(e,s){this.media=null,!s.transferMedia&&(this.id3Track&&(this.removeCues&&Xl(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const s=this.getID3Track(e.textTracks);return s.mode="hidden",s}getID3Track(e){if(this.media){for(let s=0;s<e.length;s++){const r=e[s];if(r.kind==="metadata"&&r.label==="id3")return M2(r,this.media),r}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,s){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:r,enableID3MetadataCues:n}=this.hls.config;if(!r&&!n)return;const{samples:o}=s;this.id3Track||(this.id3Track=this.createTrack(this.media));const c=Jp();if(c)for(let d=0;d<o.length;d++){const f=o[d].type;if(f===_a.emsg&&!r||!n)continue;const u=c2(o[d].data),m=o[d].pts;let g=m+o[d].duration;g>zh&&(g=zh),g-m<=0&&(g=m+zF);for(let b=0;b<u.length;b++){const v=u[b];if(!d2(v)){this.updateId3CueEnds(m,f);const w=Yg(c,m,g,v,f);w&&this.id3Track.addCue(w)}}}}updateId3CueEnds(e,s){var r;const n=(r=this.id3Track)==null?void 0:r.cues;if(n)for(let o=n.length;o--;){const c=n[o];c.type===s&&c.startTime<e&&c.endTime===zh&&(c.endTime=e)}}onBufferFlushing(e,{startOffset:s,endOffset:r,type:n}){const{id3Track:o,hls:c}=this;if(!c)return;const{config:{enableEmsgMetadataCues:d,enableID3MetadataCues:f}}=c;if(o&&(d||f)){let u;n==="audio"?u=m=>m.type===_a.audioId3&&f:n==="video"?u=m=>m.type===_a.emsg&&d:u=m=>m.type===_a.audioId3&&f||m.type===_a.emsg&&d,Qp(o,s,r,u)}}onLevelUpdated(e,{details:s}){this.updateDateRangeCues(s,!0)}onLevelPtsUpdated(e,s){Math.abs(s.drift)>.01&&this.updateDateRangeCues(s.details)}updateDateRangeCues(e,s){if(!this.hls||!this.media)return;const{assetPlayerId:r,timelineOffset:n,enableDateRangeMetadataCues:o,interstitialsController:c}=this.hls.config;if(!o)return;const d=Jp();if(r&&n&&!c){const{fragmentStart:w,fragmentEnd:S}=e;let T=this.assetCue;T?(T.startTime=w,T.endTime=S):d&&(T=this.assetCue=Yg(d,w,S,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),T&&(T.id=r,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(T),T.addEventListener("enter",this.onEventCueEnter)))}if(!e.hasProgramDateTime)return;const{id3Track:f}=this,{dateRanges:u}=e,m=Object.keys(u);let g=this.dateRangeCuesAppended;if(f&&s){var x;if((x=f.cues)!=null&&x.length){const w=Object.keys(g).filter(S=>!m.includes(S));for(let S=w.length;S--;){var b;const T=w[S],k=(b=g[T])==null?void 0:b.cues;delete g[T],k&&Object.keys(k).forEach(E=>{const R=k[E];if(R){R.removeEventListener("enter",this.onEventCueEnter);try{f.removeCue(R)}catch{}}})}}else g=this.dateRangeCuesAppended={}}const v=e.fragments[e.fragments.length-1];if(!(m.length===0||!Tt(v==null?void 0:v.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let w=0;w<m.length;w++){const S=m[w],T=u[S],k=T.startTime,E=g[S],R=(E==null?void 0:E.cues)||{};let K=(E==null?void 0:E.durationKnown)||!1,z=zh;const{duration:D,endDate:O}=T;if(O&&D!==null)z=k+D,K=!0;else if(T.endOnNext&&!K){const I=m.reduce((F,te)=>{if(te!==T.id){const le=u[te];if(le.class===T.class&&le.startDate>T.startDate&&(!F||T.startDate<F.startDate))return le}return F},null);I&&(z=I.startTime,K=!0)}const U=Object.keys(T.attr);for(let I=0;I<U.length;I++){const F=U[I];if(!f6(F))continue;const te=R[F];if(te)K&&!(E!=null&&E.durationKnown)?te.endTime=z:Math.abs(te.startTime-k)>.01&&(te.startTime=k,te.endTime=z);else if(d){let le=T.attr[F];m6(F)&&(le=vj(le));const X=Yg(d,k,z,{key:F,data:le},_a.dateRange);X&&(X.id=S,this.id3Track.addCue(X),R[F]=X,c&&(F==="X-ASSET-LIST"||F==="X-ASSET-URL")&&X.addEventListener("enter",this.onEventCueEnter))}}g[S]={cues:R,dateRange:T,durationKnown:K}}}}}class KF{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:s}=this,r=this.levelDetails;if(!s||!r)return;this.currentTime=s.currentTime;const n=this.computeLatency();if(n===null)return;this._latency=n;const{lowLatencyMode:o,maxLiveSyncPlaybackRate:c}=this.config;if(!o||c===1||!r.live)return;const d=this.targetLatency;if(d===null)return;const f=n-d,u=Math.min(this.maxLatency,d+r.targetduration);if(f<u&&f>.05&&this.forwardBufferLength>1){const g=Math.min(2,Math.max(1,c)),x=Math.round(2/(1+Math.exp(-.75*f-this.edgeStalled))*20)/20,b=Math.min(g,Math.max(1,x));this.changeMediaPlaybackRate(s,b)}else s.playbackRate!==1&&s.playbackRate!==0&&this.changeMediaPlaybackRate(s,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const s=this.levelDetails;return s?e.liveMaxLatencyDurationCount*s.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:s,partHoldBack:r,targetduration:n}=e,{liveSyncDuration:o,liveSyncDurationCount:c,lowLatencyMode:d}=this.config,f=this.hls.userConfig;let u=d&&r||s;(this._targetLatencyUpdated||f.liveSyncDuration||f.liveSyncDurationCount||u===0)&&(u=o!==void 0?o:c*n);const m=n;return u+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,m)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),s=this.targetLatency;if(e===null||s===null)return null;const r=this.levelDetails;if(r===null)return null;const n=r.edge,o=e-s-this.edgeStalled,c=n-r.totalduration,d=n-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(c,o),d)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const s=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-s,0)}get forwardBufferLength(){const{media:e}=this,s=this.levelDetails;if(!e||!s)return 0;const r=e.buffered.length;return(r?e.buffered.end(r-1):s.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(Q.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Q.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Q.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(Q.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(Q.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Q.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Q.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(Q.ERROR,this.onError,this))}onMediaAttached(e,s){this.media=s.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:s}){s.advanced&&this.onTimeupdate(),!s.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,s){var r;s.details===ze.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(r=this.levelDetails)!=null&&r.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,s){var r,n;e.playbackRate!==s&&((r=this.hls)==null||r.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(n=this.targetLatency)==null?void 0:n.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${s}`),e.playbackRate=s)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class YF extends Kx{constructor(e,s){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=s,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Q.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Q.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Q.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Q.FRAG_BUFFERED,this.onFragBuffered,this),e.on(Q.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Q.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Q.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Q.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Q.FRAG_BUFFERED,this.onFragBuffered,this),e.off(Q.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(s=>{s.loadError=0,s.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,s){this.resetLevels()}onManifestLoaded(e,s){const r=this.hls.config.preferManagedMediaSource,n=[],o={},c={};let d=!1,f=!1,u=!1;s.levels.forEach(m=>{const g=m.attrs;let{audioCodec:x,videoCodec:b}=m;x&&(m.audioCodec=x=Nf(x,r)||void 0),b&&(b=m.videoCodec=kM(b));const{width:v,height:w,unknownCodecs:S}=m,T=(S==null?void 0:S.length)||0;if(d||(d=!!(v&&w)),f||(f=!!b),u||(u=!!x),T||x&&!this.isAudioSupported(x)||b&&!this.isVideoSupported(b)){this.log(`Some or all CODECS not supported "${g.CODECS}"`);return}const{CODECS:k,"FRAME-RATE":E,"HDCP-LEVEL":R,"PATHWAY-ID":K,RESOLUTION:z,"VIDEO-RANGE":D}=g,U=`${`${K||"."}-`}${m.bitrate}-${z}-${E}-${k}-${D}-${R}`;if(o[U])if(o[U].uri!==m.url&&!m.attrs["PATHWAY-ID"]){const I=c[U]+=1;m.attrs["PATHWAY-ID"]=new Array(I+1).join(".");const F=this.createLevel(m);o[U]=F,n.push(F)}else o[U].addGroupId("audio",g.AUDIO),o[U].addGroupId("text",g.SUBTITLES);else{const I=this.createLevel(m);o[U]=I,c[U]=1,n.push(I)}}),this.filterAndSortMediaOptions(n,s,d,f,u)}createLevel(e){const s=new $d(e),r=e.supplemental;if(r!=null&&r.videoCodec&&!this.isVideoSupported(r.videoCodec)){const n=new Error(`SUPPLEMENTAL-CODECS not supported "${r.videoCodec}"`);this.log(n.message),s.supportedResult=Lj(n,[])}return s}isAudioSupported(e){return Bd(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return Bd(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,s,r,n,o){var c;let d=[],f=[],u=e;const m=((c=s.stats)==null?void 0:c.parsing)||{};if((r||n)&&o&&(u=u.filter(({videoCodec:k,videoRange:E,width:R,height:K})=>(!!k||!!(R&&K))&&UM(E))),u.length===0){Promise.resolve().then(()=>{if(this.hls){let k="no level with compatible codecs found in manifest",E=k;s.levels.length&&(E=`one or more CODECS in variant not supported: ${zs(s.levels.map(K=>K.attrs.CODECS).filter((K,z,D)=>D.indexOf(K)===z))}`,this.warn(E),k+=` (${E})`);const R=new Error(k);this.hls.trigger(Q.ERROR,{type:Ft.MEDIA_ERROR,details:ze.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:s.url,error:R,reason:E})}}),m.end=performance.now();return}s.audioTracks&&(d=s.audioTracks.filter(k=>!k.audioCodec||this.isAudioSupported(k.audioCodec)),g_(d)),s.subtitles&&(f=s.subtitles,g_(f));const g=u.slice(0);u.sort((k,E)=>{if(k.attrs["HDCP-LEVEL"]!==E.attrs["HDCP-LEVEL"])return(k.attrs["HDCP-LEVEL"]||"")>(E.attrs["HDCP-LEVEL"]||"")?1:-1;if(r&&k.height!==E.height)return k.height-E.height;if(k.frameRate!==E.frameRate)return k.frameRate-E.frameRate;if(k.videoRange!==E.videoRange)return jf.indexOf(k.videoRange)-jf.indexOf(E.videoRange);if(k.videoCodec!==E.videoCodec){const R=i1(k.videoCodec),K=i1(E.videoCodec);if(R!==K)return K-R}if(k.uri===E.uri&&k.codecSet!==E.codecSet){const R=_f(k.codecSet),K=_f(E.codecSet);if(R!==K)return K-R}return k.averageBitrate!==E.averageBitrate?k.averageBitrate-E.averageBitrate:0});let x=g[0];if(this.steering&&(u=this.steering.filterParsedLevels(u),u.length!==g.length)){for(let k=0;k<g.length;k++)if(g[k].pathwayId===u[0].pathwayId){x=g[k];break}}this._levels=u;for(let k=0;k<u.length;k++)if(u[k]===x){var b;this._firstLevel=k;const E=x.bitrate,R=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${u.length} level(s) found, first bitrate: ${E}`),((b=this.hls.userConfig)==null?void 0:b.abrEwmaDefaultEstimate)===void 0){const K=Math.min(E,this.hls.config.abrEwmaDefaultEstimateMax);K>R&&R===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=K)}break}const v=o&&!n,w=this.hls.config,S=!!(w.audioStreamController&&w.audioTrackController),T={levels:u,audioTracks:d,subtitleTracks:f,sessionData:s.sessionData,sessionKeys:s.sessionKeys,firstLevel:this._firstLevel,stats:s.stats,audio:o,video:n,altAudio:S&&!v&&d.some(k=>!!k.url)};m.end=performance.now(),this.hls.trigger(Q.MANIFEST_PARSED,T)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const s=this._levels;if(s.length===0)return;if(e<0||e>=s.length){const m=new Error("invalid level idx"),g=e<0;if(this.hls.trigger(Q.ERROR,{type:Ft.OTHER_ERROR,details:ze.LEVEL_SWITCH_ERROR,level:e,fatal:g,error:m,reason:m.message}),g)return;e=Math.min(e,s.length-1)}const r=this.currentLevelIndex,n=this.currentLevel,o=n?n.attrs["PATHWAY-ID"]:void 0,c=s[e],d=c.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=c,r===e&&n&&o===d)return;this.log(`Switching to level ${e} (${c.height?c.height+"p ":""}${c.videoRange?c.videoRange+" ":""}${c.codecSet?c.codecSet+" ":""}@${c.bitrate})${d?" with Pathway "+d:""} from level ${r}${o?" with Pathway "+o:""}`);const f={level:e,attrs:c.attrs,details:c.details,bitrate:c.bitrate,averageBitrate:c.averageBitrate,maxBitrate:c.maxBitrate,realBitrate:c.realBitrate,width:c.width,height:c.height,codecSet:c.codecSet,audioCodec:c.audioCodec,videoCodec:c.videoCodec,audioGroups:c.audioGroups,subtitleGroups:c.subtitleGroups,loaded:c.loaded,loadError:c.loadError,fragmentError:c.fragmentError,name:c.name,id:c.id,uri:c.uri,url:c.url,urlId:0,audioGroupIds:c.audioGroupIds,textGroupIds:c.textGroupIds};this.hls.trigger(Q.LEVEL_SWITCHING,f);const u=c.details;if(!u||u.live){const m=this.switchParams(c.uri,n==null?void 0:n.details,u);this.loadPlaylist(m)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const s=this.steering.pathways(),r=e.filter(n=>s.indexOf(n)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${s}`);return}this.steering.pathwayPriority=r}}onError(e,s){s.fatal||!s.context||s.context.type===us.LEVEL&&s.context.level===this.level&&this.checkRetry(s)}onFragBuffered(e,{frag:s}){if(s!==void 0&&s.type===Rt.MAIN){const r=s.elementaryStreams;if(!Object.keys(r).some(o=>!!r[o]))return;const n=this._levels[s.level];n!=null&&n.loadError&&(this.log(`Resetting level error count of ${n.loadError} on frag buffered`),n.loadError=0)}}onLevelLoaded(e,s){var r;const{level:n,details:o}=s,c=s.levelInfo;if(!c){var d;this.warn(`Invalid level index ${n}`),(d=s.deliveryDirectives)!=null&&d.skip&&(o.deltaUpdateFailed=!0);return}if(c===this.currentLevel||s.withoutMultiVariant){c.fragmentError===0&&(c.loadError=0);let f=c.details;f===s.details&&f.advanced&&(f=void 0),this.playlistLoaded(n,s,f)}else(r=s.deliveryDirectives)!=null&&r.skip&&(o.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,s){super.loadingPlaylist(e,s);const r=this.getUrlWithDirectives(e.uri,s),n=this.currentLevelIndex,o=e.attrs["PATHWAY-ID"],c=e.details,d=c==null?void 0:c.age;this.log(`Loading level index ${n}${(s==null?void 0:s.msn)!==void 0?" at sn "+s.msn+" part "+s.part:""}${o?" Pathway "+o:""}${d&&c.live?" age "+d.toFixed(1)+(c.type&&" "+c.type||""):""} ${r}`),this.hls.trigger(Q.LEVEL_LOADING,{url:r,level:n,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:s||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var s;if(this._levels.length===1)return;const r=this._levels.filter((o,c)=>c!==e?!0:(this.steering&&this.steering.removeLevel(o),o===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,o.details&&o.details.fragments.forEach(d=>d.level=-1)),!1));Jj(r),this._levels=r,this.currentLevelIndex>-1&&(s=this.currentLevel)!=null&&s.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const n=r.length-1;this._firstLevel=Math.min(this._firstLevel,n),this._startLevel&&(this._startLevel=Math.min(this._startLevel,n)),this.hls.trigger(Q.LEVELS_UPDATED,{levels:r})}onLevelsUpdated(e,{levels:s}){this._levels=s}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:s,maxHdcpLevel:r}=this.hls;this._maxAutoLevel!==s&&(this._maxAutoLevel=s,this.hls.trigger(Q.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:s,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:r}))}}function g_(a){const e={};a.forEach(s=>{const r=s.groupId||"";s.id=e[r]=e[r]||0,e[r]++})}function Y2(){return self.SourceBuffer||self.WebKitSourceBuffer}function W2(){if(!co())return!1;const e=Y2();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function WF(){if(!W2())return!1;const a=co();return typeof(a==null?void 0:a.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>a.isTypeSupported(Ud(e,"video")))||["mp4a.40.2","fLaC"].some(e=>a.isTypeSupported(Ud(e,"audio"))))}function QF(){var a;const e=Y2();return typeof(e==null||(a=e.prototype)==null?void 0:a.changeType)=="function"}const XF=100;class ZF extends Bx{constructor(e,s,r){super(e,s,r,"stream-controller",Rt.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const n=this.media,o=n?n.currentTime:null;if(o===null||!Tt(o)||(this.log(`Media seeked to ${o.toFixed(3)}`),!this.getBufferedFrag(o)))return;const c=this.getFwdBufferInfoAtPos(n,o,Rt.MAIN,0);if(c===null||c.len===0){this.warn(`Main forward buffer length at ${o} on "seeked" event ${c?c.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(Q.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Q.LEVEL_LOADING,this.onLevelLoading,this),e.on(Q.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Q.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(Q.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(Q.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(Q.BUFFER_CREATED,this.onBufferCreated,this),e.on(Q.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(Q.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Q.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(Q.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Q.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Q.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(Q.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(Q.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(Q.BUFFER_CREATED,this.onBufferCreated,this),e.off(Q.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(Q.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Q.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,s){if(this.levels){const{lastCurrentTime:r,hls:n}=this;if(this.stopLoad(),this.setInterval(XF),this.level=-1,!this.startFragRequested){let o=n.startLevel;o===-1&&(n.config.testBandwidth&&this.levels.length>1?(o=0,this.bitrateTest=!0):o=n.firstAutoLevel),n.nextLoadLevel=o,this.level=n.loadLevel,this._hasEnoughToStart=!!s}r>0&&e===-1&&!s&&(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r),this.state=ut.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=s?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=ut.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case ut.WAITING_LEVEL:{const{levels:e,level:s}=this,r=e==null?void 0:e[s],n=r==null?void 0:r.details;if(n&&(!n.live||this.levelLastLoaded===r&&!this.waitForLive(r))){if(this.waitForCdnTuneIn(n))break;this.state=ut.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=ut.IDLE;break}break}case ut.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===ut.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:s,levels:r,media:n}=this;if(s===null||!n&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const o=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(r!=null&&r[o]))return;const c=r[o],d=this.getMainFwdBufferInfo();if(d===null)return;const f=this.getLevelDetails();if(f&&this._streamEnded(d,f)){const w={};this.altAudio===2&&(w.type="video"),this.hls.trigger(Q.BUFFER_EOS,w),this.state=ut.ENDED;return}if(!this.buffering)return;e.loadLevel!==o&&e.manualLevel===-1&&this.log(`Adapting to level ${o} from level ${this.level}`),this.level=e.nextLoadLevel=o;const u=c.details;if(!u||this.state===ut.WAITING_LEVEL||this.waitForLive(c)){this.level=o,this.state=ut.WAITING_LEVEL,this.startFragRequested=!1;return}const m=d.len,g=this.getMaxBufferLength(c.maxBitrate);if(m>=g)return;this.backtrackFragment&&this.backtrackFragment.start>d.end&&(this.backtrackFragment=null);const x=this.backtrackFragment?this.backtrackFragment.start:d.end;let b=this.getNextFragment(x,u);if(this.couldBacktrack&&!this.fragPrevious&&b&&ur(b)&&this.fragmentTracker.getState(b)!==Sr.OK){var v;const S=((v=this.backtrackFragment)!=null?v:b).sn-u.startSN,T=u.fragments[S-1];T&&b.cc===T.cc&&(b=T,this.fragmentTracker.removeFragment(T))}else this.backtrackFragment&&d.len&&(this.backtrackFragment=null);if(b&&this.isLoopLoading(b,x)){if(!b.gap){const S=this.audioOnly&&!this.altAudio?Hs.AUDIO:Hs.VIDEO,T=(S===Hs.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;T&&this.afterBufferFlushed(T,S,Rt.MAIN)}b=this.getNextFragmentLoopLoading(b,u,d,Rt.MAIN,g)}b&&(b.initSegment&&!b.initSegment.data&&!this.bitrateTest&&(b=b.initSegment),this.loadFragment(b,c,x))}loadFragment(e,s,r){const n=this.fragmentTracker.getState(e);n===Sr.NOT_LOADED||n===Sr.PARTIAL?ur(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,s)):super.loadFragment(e,s,r):this._loadInitSegment(e,s):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Rt.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:s}=this;if(s!=null&&s.readyState){let r;const n=this.getAppendedFrag(s.currentTime);n&&n.start>1&&this.flushMainBuffer(0,n.start-1);const o=this.getLevelDetails();if(o!=null&&o.live){const d=this.getMainFwdBufferInfo();if(!d||d.len<o.targetduration*2)return}if(!s.paused&&e){const d=this.hls.nextLoadLevel,f=e[d],u=this.fragLastKbps;u&&this.fragCurrent?r=this.fragCurrent.duration*f.maxBitrate/(1e3*u)+1:r=0}else r=0;const c=this.getBufferedFrag(s.currentTime+r);if(c){const d=this.followingBufferedFrag(c);if(d){this.abortCurrentFrag();const f=d.maxStartPTS?d.maxStartPTS:d.start,u=d.duration,m=Math.max(c.end,f+Math.min(Math.max(u-this.config.maxFragLookUpTolerance,u*(this.couldBacktrack?.5:.125)),u*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(m,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case ut.KEY_LOADING:case ut.FRAG_LOADING:case ut.FRAG_LOADING_WAITING_RETRY:case ut.PARSING:case ut.PARSED:this.state=ut.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,s){super.flushMainBuffer(e,s,this.altAudio===2?"video":null)}onMediaAttached(e,s){super.onMediaAttached(e,s);const r=s.media;qr(r,"playing",this.onMediaPlaying),qr(r,"seeked",this.onMediaSeeked)}onMediaDetaching(e,s){const{media:r}=this;r&&(na(r,"playing",this.onMediaPlaying),na(r,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,s),!s.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(Q.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,s){let r=!1,n=!1;for(let o=0;o<s.levels.length;o++){const c=s.levels[o].audioCodec;c&&(r=r||c.indexOf("mp4a.40.2")!==-1,n=n||c.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=r&&n&&!QF(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=s.levels,this.startFragRequested=!1}onLevelLoading(e,s){const{levels:r}=this;if(!r||this.state!==ut.IDLE)return;const n=s.levelInfo;(!n.details||n.details.live&&(this.levelLastLoaded!==n||n.details.expired)||this.waitForCdnTuneIn(n.details))&&(this.state=ut.WAITING_LEVEL)}onLevelLoaded(e,s){var r;const{levels:n,startFragRequested:o}=this,c=s.level,d=s.details,f=d.totalduration;if(!n){this.warn(`Levels were reset while loading level ${c}`);return}this.log(`Level ${c} loaded [${d.startSN},${d.endSN}]${d.lastPartSn?`[part-${d.lastPartSn}-${d.lastPartIndex}]`:""}, cc [${d.startCC}, ${d.endCC}] duration:${f}`);const u=s.levelInfo,m=this.fragCurrent;m&&(this.state===ut.FRAG_LOADING||this.state===ut.FRAG_LOADING_WAITING_RETRY)&&m.level!==s.level&&m.loader&&this.abortCurrentFrag();let g=0;if(d.live||(r=u.details)!=null&&r.live){var x;if(this.checkLiveUpdate(d),d.deltaUpdateFailed)return;g=this.alignPlaylists(d,u.details,(x=this.levelLastLoaded)==null?void 0:x.details)}if(u.details=d,this.levelLastLoaded=u,o||this.setStartPosition(d,g),this.hls.trigger(Q.LEVEL_UPDATED,{details:d,level:c}),this.state===ut.WAITING_LEVEL){if(this.waitForCdnTuneIn(d))return;this.state=ut.IDLE}o&&d.live&&this.synchronizeToLiveEdge(d),this.tick()}synchronizeToLiveEdge(e){const{config:s,media:r}=this;if(!r)return;const n=this.hls.liveSyncPosition,o=this.getLoadPosition(),c=e.fragmentStart,d=e.edge,f=o>=c-s.maxFragLookUpTolerance&&o<=d;if(n!==null&&r.duration>n&&(o<n||!f)){const m=s.liveMaxLatencyDuration!==void 0?s.liveMaxLatencyDuration:s.liveMaxLatencyDurationCount*e.targetduration;if((!f&&r.readyState<4||o<d-m)&&(this._hasEnoughToStart||(this.nextLoadPosition=n),r.readyState))if(this.warn(`Playback: ${o.toFixed(3)} is located too far from the end of live sliding playlist: ${d}, reset currentTime to : ${n.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var u;const g=Zt.bufferInfo(r,n,0);if(!((u=g.buffered)!=null&&u.length)){r.currentTime=n;return}if(g.start<=o){r.currentTime=n;return}const{nextStart:b}=Zt.bufferedInfo(g.buffered,o,0);b&&(r.currentTime=b)}else r.currentTime=n}}_handleFragmentLoadProgress(e){var s;const r=e.frag,{part:n,payload:o}=e,{levels:c}=this;if(!c){this.warn(`Levels were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const d=c[r.level];if(!d){this.warn(`Level ${r.level} not found on progress`);return}const f=d.details;if(!f){this.warn(`Dropping fragment ${r.sn} of level ${r.level} after level details were reset`),this.fragmentTracker.removeFragment(r);return}const u=d.videoCodec,m=f.PTSKnown||!f.live,g=(s=r.initSegment)==null?void 0:s.data,x=this._getAudioCodec(d),b=this.transmuxer=this.transmuxer||new w2(this.hls,Rt.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),v=n?n.index:-1,w=v!==-1,S=new Px(r.level,r.sn,r.stats.chunkCount,o.byteLength,v,w),T=this.initPTS[r.cc];b.push(o,g,x,u,r,n,f.totalduration,m,S,T)}onAudioTrackSwitching(e,s){const r=this.hls,n=this.altAudio!==0;if(Ef(s.url,r))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const c=this.fragCurrent;c&&(this.log("Switching to main audio track, cancel main fragment load"),c.abortRequests(),this.fragmentTracker.removeFragment(c)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(n){this.altAudio=0,this.fragmentTracker.removeAllFragments(),r.once(Q.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(Q.AUDIO_TRACK_SWITCHED,s)}),r.trigger(Q.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}r.trigger(Q.AUDIO_TRACK_SWITCHED,s)}}onAudioTrackSwitched(e,s){const r=Ef(s.url,this.hls);if(r){const n=this.videoBuffer;n&&this.mediaBuffer!==n&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=r?2:0,this.tick()}onBufferCreated(e,s){const r=s.tracks;let n,o,c=!1;for(const d in r){const f=r[d];if(f.id==="main"){if(o=d,n=f,d==="video"){const u=r[d];u&&(this.videoBuffer=u.buffer)}}else c=!0}c&&n?(this.log(`Alternate track found, use ${o}.buffered to schedule main fragment loading`),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media}onFragBuffered(e,s){const{frag:r,part:n}=s,o=r.type===Rt.MAIN;if(o){if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${n?" p: "+n.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}`),this.state===ut.PARSED&&(this.state=ut.IDLE);return}const d=n?n.stats:r.stats;this.fragLastKbps=Math.round(8*d.total/(d.buffering.end-d.loading.first)),ur(r)&&(this.fragPrevious=r),this.fragBufferedComplete(r,n)}const c=this.media;c&&(!this._hasEnoughToStart&&Zt.getBuffered(c).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),o&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,s){var r;if(s.fatal){this.state=ut.ERROR;return}switch(s.details){case ze.FRAG_GAP:case ze.FRAG_PARSING_ERROR:case ze.FRAG_DECRYPT_ERROR:case ze.FRAG_LOAD_ERROR:case ze.FRAG_LOAD_TIMEOUT:case ze.KEY_LOAD_ERROR:case ze.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Rt.MAIN,s);break;case ze.LEVEL_LOAD_ERROR:case ze.LEVEL_LOAD_TIMEOUT:case ze.LEVEL_PARSING_ERROR:!s.levelRetry&&this.state===ut.WAITING_LEVEL&&((r=s.context)==null?void 0:r.type)===us.LEVEL&&(this.state=ut.IDLE);break;case ze.BUFFER_ADD_CODEC_ERROR:case ze.BUFFER_APPEND_ERROR:if(s.parent!=="main")return;this.reduceLengthAndFlushBuffer(s)&&this.resetLoadingState();break;case ze.BUFFER_FULL_ERROR:if(s.parent!=="main")return;this.reduceLengthAndFlushBuffer(s)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case ze.INTERNAL_EXCEPTION:this.recoverWorkerError(s);break}}onFragLoadEmergencyAborted(){this.state=ut.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:s}){if(s!==Hs.AUDIO||!this.altAudio){const r=(s===Hs.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;r&&(this.afterBufferFlushed(r,s,Rt.MAIN),this.tick())}}onLevelsUpdated(e,s){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=s.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const s=e.currentTime;let r=this.startPosition;if(r>=0&&s<r){if(e.seeking){this.log(`could not seek to ${r}, already seeking at ${s}`);return}const n=this.timelineOffset;n&&r&&(r+=n);const o=this.getLevelDetails(),c=Zt.getBuffered(e),d=c.length?c.start(0):0,f=d-r,u=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||f>0&&(f<u||this.loadingParts&&f<2*((o==null?void 0:o.partTarget)||0)))&&(this.log(`adjusting start position by ${f} to match buffer start`),r+=f,this.startPosition=r),s<r&&(this.log(`seek to target start position ${r} from current time ${s} buffer start ${d}`),e.currentTime=r)}}_getAudioCodec(e){let s=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&s&&(this.log("Swapping audio codec"),s.indexOf("mp4a.40.5")!==-1?s="mp4a.40.2":s="mp4a.40.5"),s}_loadBitrateTestFrag(e,s){e.bitrateTest=!0,this._doFragLoad(e,s).then(r=>{const{hls:n}=this,o=r==null?void 0:r.frag;if(!o||this.fragContextChanged(o))return;s.fragmentError=0,this.state=ut.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const c=o.stats;c.parsing.start=c.parsing.end=c.buffering.start=c.buffering.end=self.performance.now(),n.trigger(Q.FRAG_LOADED,r),o.bitrateTest=!1}).catch(r=>{this.state===ut.STOPPED||this.state===ut.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}_handleTransmuxComplete(e){const s=this.playlistType,{hls:r}=this,{remuxResult:n,chunkMeta:o}=e,c=this.getCurrentContext(o);if(!c){this.resetWhenMissingContext(o);return}const{frag:d,part:f,level:u}=c,{video:m,text:g,id3:x,initSegment:b}=n,{details:v}=u,w=this.altAudio?void 0:n.audio;if(this.fragContextChanged(d)){this.fragmentTracker.removeFragment(d);return}if(this.state=ut.PARSING,b){const S=b.tracks;if(S){const R=d.initSegment||d;if(this.unhandledEncryptionError(b,d))return;this._bufferInitSegment(u,S,R,o),r.trigger(Q.FRAG_PARSING_INIT_SEGMENT,{frag:R,id:s,tracks:S})}const T=b.initPTS,k=b.timescale,E=this.initPTS[d.cc];if(Tt(T)&&(!E||E.baseTime!==T||E.timescale!==k)){const R=b.trackId;this.initPTS[d.cc]={baseTime:T,timescale:k,trackId:R},r.trigger(Q.INIT_PTS_FOUND,{frag:d,id:s,initPTS:T,timescale:k,trackId:R})}}if(m&&v){w&&m.type==="audiovideo"&&this.logMuxedErr(d);const S=v.fragments[d.sn-1-v.startSN],T=d.sn===v.startSN,k=!S||d.cc>S.cc;if(n.independent!==!1){const{startPTS:E,endPTS:R,startDTS:K,endDTS:z}=m;if(f)f.elementaryStreams[m.type]={startPTS:E,endPTS:R,startDTS:K,endDTS:z};else if(m.firstKeyFrame&&m.independent&&o.id===1&&!k&&(this.couldBacktrack=!0),m.dropped&&m.independent){const D=this.getMainFwdBufferInfo(),O=(D?D.end:this.getLoadPosition())+this.config.maxBufferHole,U=m.firstKeyFramePTS?m.firstKeyFramePTS:E;if(!T&&O<U-this.config.maxBufferHole&&!k){this.backtrack(d);return}else k&&(d.gap=!0);d.setElementaryStreamInfo(m.type,d.start,R,d.start,z,!0)}else T&&E-(v.appliedTimelineOffset||0)>hf&&(d.gap=!0);d.setElementaryStreamInfo(m.type,E,R,K,z),this.backtrackFragment&&(this.backtrackFragment=d),this.bufferFragmentData(m,d,f,o,T||k)}else if(T||k)d.gap=!0;else{this.backtrack(d);return}}if(w){const{startPTS:S,endPTS:T,startDTS:k,endDTS:E}=w;f&&(f.elementaryStreams[Hs.AUDIO]={startPTS:S,endPTS:T,startDTS:k,endDTS:E}),d.setElementaryStreamInfo(Hs.AUDIO,S,T,k,E),this.bufferFragmentData(w,d,f,o)}if(v&&x!=null&&x.samples.length){const S={id:s,frag:d,details:v,samples:x.samples};r.trigger(Q.FRAG_PARSING_METADATA,S)}if(v&&g){const S={id:s,frag:d,details:v,samples:g.samples};r.trigger(Q.FRAG_PARSING_USERDATA,S)}}logMuxedErr(e){this.warn(`${ur(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,s,r,n){if(this.state!==ut.PARSING)return;this.audioOnly=!!s.audio&&!s.video,this.altAudio&&!this.audioOnly&&(delete s.audio,s.audiovideo&&this.logMuxedErr(r));const{audio:o,video:c,audiovideo:d}=s;if(o){const u=e.audioCodec;let m=af(o.codec,u);m==="mp4a"&&(m="mp4a.40.5");const g=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){m&&(m.indexOf("mp4a.40.5")!==-1?m="mp4a.40.2":m="mp4a.40.5");const x=o.metadata;x&&"channelCount"in x&&(x.channelCount||1)!==1&&g.indexOf("firefox")===-1&&(m="mp4a.40.5")}m&&m.indexOf("mp4a.40.5")!==-1&&g.indexOf("android")!==-1&&o.container!=="audio/mpeg"&&(m="mp4a.40.2",this.log(`Android: force audio codec to ${m}`)),u&&u!==m&&this.log(`Swapping manifest audio codec "${u}" for "${m}"`),o.levelCodec=m,o.id=Rt.MAIN,this.log(`Init audio buffer, container:${o.container}, codecs[selected/level/parsed]=[${m||""}/${u||""}/${o.codec}]`),delete s.audiovideo}if(c){c.levelCodec=e.videoCodec,c.id=Rt.MAIN;const u=c.codec;if((u==null?void 0:u.length)===4)switch(u){case"hvc1":case"hev1":c.codec="hvc1.1.6.L120.90";break;case"av01":c.codec="av01.0.04M.08";break;case"avc1":c.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${c.container}, codecs[level/parsed]=[${e.videoCodec||""}/${u}]${c.codec!==u?" parsed-corrected="+c.codec:""}${c.supplemental?" supplemental="+c.supplemental:""}`),delete s.audiovideo}d&&(this.log(`Init audiovideo buffer, container:${d.container}, codecs[level/parsed]=[${e.codecs}/${d.codec}]`),delete s.video,delete s.audio);const f=Object.keys(s);if(f.length){if(this.hls.trigger(Q.BUFFER_CODECS,s),!this.hls)return;f.forEach(u=>{const g=s[u].initSegment;g!=null&&g.byteLength&&this.hls.trigger(Q.BUFFER_APPENDING,{type:u,data:g,frag:r,part:null,chunkMeta:n,parent:r.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,Rt.MAIN)}get maxBufferLength(){const{levels:e,level:s}=this,r=e==null?void 0:e[s];return r?this.getMaxBufferLength(r.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=ut.IDLE}checkFragmentChanged(){const e=this.media;let s=null;if(e&&e.readyState>1&&e.seeking===!1){const r=e.currentTime;if(Zt.isBuffered(e,r)?s=this.getAppendedFrag(r):Zt.isBuffered(e,r+.1)&&(s=this.getAppendedFrag(r+.1)),s){this.backtrackFragment=null;const n=this.fragPlaying,o=s.level;(!n||s.sn!==n.sn||n.level!==o)&&(this.fragPlaying=s,this.hls.trigger(Q.FRAG_CHANGED,{frag:s}),(!n||n.level!==o)&&this.hls.trigger(Q.LEVEL_SWITCHED,{level:o}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const s=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return Tt(s)?this.getAppendedFrag(s):null}get currentProgramDateTime(){var e;const s=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(Tt(s)){const r=this.getLevelDetails(),n=this.currentFrag||(r?ol(null,r.fragments,s):null);if(n){const o=n.programDateTime;if(o!==null){const c=o+(s-n.start)*1e3;return new Date(c)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class JF extends qa{constructor(e,s){super("key-loader",s),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const r in this.keyIdToKeyInfo){const n=this.keyIdToKeyInfo[r].loader;if(n){var s;if(e&&e!==((s=n.context)==null?void 0:s.frag.type))return;n.abort()}}}detach(){for(const e in this.keyIdToKeyInfo){const s=this.keyIdToKeyInfo[e];(s.mediaKeySessionContext||s.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyIdToKeyInfo){const s=this.keyIdToKeyInfo[e].loader;s&&s.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(e,s=ze.KEY_LOAD_ERROR,r,n,o){return new Jn({type:Ft.NETWORK_ERROR,details:s,fatal:!1,frag:e,response:o,error:r,networkDetails:n})}loadClear(e,s,r){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(s.length)for(let n=0,o=s.length;n<o;n++){const c=s[n];if(e.cc<=c.cc&&(!ur(e)||!ur(c)||e.sn<c.sn)||!r&&n==o-1)return this.emeController.selectKeySystemFormat(c).then(d=>{if(!this.emeController)return;c.setKeyFormat(d);const f=of(d);if(f)return this.emeController.getKeySystemAccess([f])})}if(this.config.requireKeySystemAccessOnStart){const n=Ad(this.config);if(n.length)return this.emeController.getKeySystemAccess(n)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(s=>this.loadInternal(e,s)):this.loadInternal(e)}loadInternal(e,s){var r,n;s&&e.setKeyFormat(s);const o=e.decryptdata;if(!o){const u=new Error(s?`Expected frag.decryptdata to be defined after setting format ${s}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(e,ze.KEY_LOAD_ERROR,u))}const c=o.uri;if(!c)return Promise.reject(this.createKeyLoadError(e,ze.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${c}"`)));const d=Wg(o);let f=this.keyIdToKeyInfo[d];if((r=f)!=null&&r.decryptdata.key)return o.key=f.decryptdata.key,Promise.resolve({frag:e,keyInfo:f});if(this.emeController&&(n=f)!=null&&n.keyLoadPromise)switch(this.emeController.getKeyStatus(f.decryptdata)){case"usable":case"usable-in-future":return f.keyLoadPromise.then(m=>{const{keyInfo:g}=m;return o.key=g.decryptdata.key,{frag:e,keyInfo:g}})}switch(this.log(`${this.keyIdToKeyInfo[d]?"Rel":"L"}oading${o.keyId?" keyId: "+Ir(o.keyId):""} URI: ${o.uri} from ${e.type} ${e.level}`),f=this.keyIdToKeyInfo[d]={decryptdata:o,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},o.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return o.keyFormat==="identity"?this.loadKeyHTTP(f,e):this.loadKeyEME(f,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(f,e);default:return Promise.reject(this.createKeyLoadError(e,ze.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${o.method}"`)))}}loadKeyEME(e,s){const r={frag:s,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var n;if(!e.decryptdata.keyId&&(n=s.initSegment)!=null&&n.data){const c=yM(s.initSegment.data);if(c.length){let d=c[0];d.some(f=>f!==0)?(this.log(`Using keyId found in init segment ${Ir(d)}`),lo.setKeyIdForUri(e.decryptdata.uri,d)):(d=lo.addKeyIdForUri(e.decryptdata.uri),this.log(`Generating keyId to patch media ${Ir(d)}`)),e.decryptdata.keyId=d}}if(!e.decryptdata.keyId&&!ur(s))return Promise.resolve(r);const o=this.emeController.loadKey(r);return(e.keyLoadPromise=o.then(c=>(e.mediaKeySessionContext=c,r))).catch(c=>{throw e.keyLoadPromise=null,"data"in c&&(c.data.frag=s),c})}return Promise.resolve(r)}loadKeyHTTP(e,s){const r=this.config,n=r.loader,o=new n(r);return s.keyLoader=e.loader=o,e.keyLoadPromise=new Promise((c,d)=>{const f={keyInfo:e,frag:s,responseType:"arraybuffer",url:e.decryptdata.uri},u=r.keyLoadPolicy.default,m={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},g={onSuccess:(x,b,v,w)=>{const{frag:S,keyInfo:T}=v,k=Wg(T.decryptdata);if(!S.decryptdata||T!==this.keyIdToKeyInfo[k])return d(this.createKeyLoadError(S,ze.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),w));T.decryptdata.key=S.decryptdata.key=new Uint8Array(x.data),S.keyLoader=null,T.loader=null,c({frag:S,keyInfo:T})},onError:(x,b,v,w)=>{this.resetLoader(b),d(this.createKeyLoadError(s,ze.KEY_LOAD_ERROR,new Error(`HTTP Error ${x.code} loading key ${x.text}`),v,Is({url:f.url,data:void 0},x)))},onTimeout:(x,b,v)=>{this.resetLoader(b),d(this.createKeyLoadError(s,ze.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),v))},onAbort:(x,b,v)=>{this.resetLoader(b),d(this.createKeyLoadError(s,ze.INTERNAL_ABORTED,new Error("key loading aborted"),v))}};o.load(f,m,g)})}resetLoader(e){const{frag:s,keyInfo:r,url:n}=e,o=r.loader;s.keyLoader===o&&(s.keyLoader=null,r.loader=null);const c=Wg(r.decryptdata)||n;delete this.keyIdToKeyInfo[c],o&&o.destroy()}}function Wg(a){if(a.keyFormat!==Mr.FAIRPLAY){const e=a.keyId;if(e)return Ir(e)}return a.uri}function p_(a){const{type:e}=a;switch(e){case us.AUDIO_TRACK:return Rt.AUDIO;case us.SUBTITLE_TRACK:return Rt.SUBTITLE;default:return Rt.MAIN}}function Qg(a,e){let s=a.url;return(s===void 0||s.indexOf("data:")===0)&&(s=e.url),s}class e8{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Q.LEVEL_LOADING,this.onLevelLoading,this),e.on(Q.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(Q.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(Q.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(Q.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Q.LEVEL_LOADING,this.onLevelLoading,this),e.off(Q.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(Q.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(Q.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const s=this.hls.config,r=s.pLoader,n=s.loader,o=r||n,c=new o(s);return this.loaders[e.type]=c,c}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const s=this.loaders[e];s&&s.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,s){const{url:r}=s;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:us.MANIFEST,url:r,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,s){const{id:r,level:n,pathwayId:o,url:c,deliveryDirectives:d,levelInfo:f}=s;this.load({id:r,level:n,pathwayId:o,responseType:"text",type:us.LEVEL,url:c,deliveryDirectives:d,levelOrTrack:f})}onAudioTrackLoading(e,s){const{id:r,groupId:n,url:o,deliveryDirectives:c,track:d}=s;this.load({id:r,groupId:n,level:null,responseType:"text",type:us.AUDIO_TRACK,url:o,deliveryDirectives:c,levelOrTrack:d})}onSubtitleTrackLoading(e,s){const{id:r,groupId:n,url:o,deliveryDirectives:c,track:d}=s;this.load({id:r,groupId:n,level:null,responseType:"text",type:us.SUBTITLE_TRACK,url:o,deliveryDirectives:c,levelOrTrack:d})}onLevelsUpdated(e,s){const r=this.loaders[us.LEVEL];if(r){const n=r.context;n&&!s.levels.some(o=>o===n.levelOrTrack)&&(r.abort(),delete this.loaders[us.LEVEL])}}load(e){var s;const r=this.hls.config;let n=this.getInternalLoader(e);if(n){const u=this.hls.logger,m=n.context;if(m&&m.levelOrTrack===e.levelOrTrack&&(m.url===e.url||m.deliveryDirectives&&!e.deliveryDirectives)){m.url===e.url?u.log(`[playlist-loader]: ignore ${e.url} ongoing request`):u.log(`[playlist-loader]: ignore ${e.url} in favor of ${m.url}`);return}u.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),n.abort()}let o;if(e.type===us.MANIFEST?o=r.manifestLoadPolicy.default:o=Us({},r.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),n=this.createInternalLoader(e),Tt((s=e.deliveryDirectives)==null?void 0:s.part)){let u;if(e.type===us.LEVEL&&e.level!==null?u=this.hls.levels[e.level].details:e.type===us.AUDIO_TRACK&&e.id!==null?u=this.hls.audioTracks[e.id].details:e.type===us.SUBTITLE_TRACK&&e.id!==null&&(u=this.hls.subtitleTracks[e.id].details),u){const m=u.partTarget,g=u.targetduration;if(m&&g){const x=Math.max(m*3,g*.8)*1e3;o=Us({},o,{maxTimeToFirstByteMs:Math.min(x,o.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(x,o.maxTimeToFirstByteMs)})}}}const c=o.errorRetry||o.timeoutRetry||{},d={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:c.maxNumRetry||0,retryDelay:c.retryDelayMs||0,maxRetryDelay:c.maxRetryDelayMs||0},f={onSuccess:(u,m,g,x)=>{const b=this.getInternalLoader(g);this.resetInternalLoader(g.type);const v=u.data;m.parsing.start=performance.now(),jn.isMediaPlaylist(v)||g.type!==us.MANIFEST?this.handleTrackOrLevelPlaylist(u,m,g,x||null,b):this.handleMasterPlaylist(u,m,g,x)},onError:(u,m,g,x)=>{this.handleNetworkError(m,g,!1,u,x)},onTimeout:(u,m,g)=>{this.handleNetworkError(m,g,!0,void 0,u)}};n.load(e,d,f)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:s},forceStartLoad:r}=this.hls;(e||r)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${s}`),this.hls.startLoad(s))}handleMasterPlaylist(e,s,r,n){const o=this.hls,c=e.data,d=Qg(e,r),f=jn.parseMasterPlaylist(c,d);if(f.playlistParsingError){s.parsing.end=performance.now(),this.handleManifestParsingError(e,r,f.playlistParsingError,n,s);return}const{contentSteering:u,levels:m,sessionData:g,sessionKeys:x,startTimeOffset:b,variableList:v}=f;this.variableList=v,m.forEach(k=>{const{unknownCodecs:E}=k;if(E){const{preferManagedMediaSource:R}=this.hls.config;let{audioCodec:K,videoCodec:z}=k;for(let D=E.length;D--;){const O=E[D];Bd(O,"audio",R)?(k.audioCodec=K=K?`${K},${O}`:O,gc.audio[K.substring(0,4)]=2,E.splice(D,1)):Bd(O,"video",R)&&(k.videoCodec=z=z?`${z},${O}`:O,gc.video[z.substring(0,4)]=2,E.splice(D,1))}}});const{AUDIO:w=[],SUBTITLES:S,"CLOSED-CAPTIONS":T}=jn.parseMasterPlaylistMedia(c,d,f);w.length&&!w.some(E=>!E.url)&&m[0].audioCodec&&!m[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),w.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new tr({}),bitrate:0,url:""})),o.trigger(Q.MANIFEST_LOADED,{levels:m,audioTracks:w,subtitles:S,captions:T,contentSteering:u,url:d,stats:s,networkDetails:n,sessionData:g,sessionKeys:x,startTimeOffset:b,variableList:v})}handleTrackOrLevelPlaylist(e,s,r,n,o){const c=this.hls,{id:d,level:f,type:u}=r,m=Qg(e,r),g=Tt(f)?f:Tt(d)?d:0,x=p_(r),b=jn.parseLevelPlaylist(e.data,m,g,x,0,this.variableList);if(u===us.MANIFEST){const v={attrs:new tr({}),bitrate:0,details:b,name:"",url:m};b.requestScheduled=s.loading.start+Qj(b,0),c.trigger(Q.MANIFEST_LOADED,{levels:[v],audioTracks:[],url:m,stats:s,networkDetails:n,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}s.parsing.end=performance.now(),r.levelDetails=b,this.handlePlaylistLoaded(b,e,s,r,n,o)}handleManifestParsingError(e,s,r,n,o){this.hls.trigger(Q.ERROR,{type:Ft.NETWORK_ERROR,details:ze.MANIFEST_PARSING_ERROR,fatal:s.type===us.MANIFEST,url:e.url,err:r,error:r,reason:r.message,response:e,context:s,networkDetails:n,stats:o})}handleNetworkError(e,s,r=!1,n,o){let c=`A network ${r?"timeout":"error"+(n?" (status "+n.code+")":"")} occurred while loading ${e.type}`;e.type===us.LEVEL?c+=`: ${e.level} id: ${e.id}`:(e.type===us.AUDIO_TRACK||e.type===us.SUBTITLE_TRACK)&&(c+=` id: ${e.id} group-id: "${e.groupId}"`);const d=new Error(c);this.hls.logger.warn(`[playlist-loader]: ${c}`);let f=ze.UNKNOWN,u=!1;const m=this.getInternalLoader(e);switch(e.type){case us.MANIFEST:f=r?ze.MANIFEST_LOAD_TIMEOUT:ze.MANIFEST_LOAD_ERROR,u=!0;break;case us.LEVEL:f=r?ze.LEVEL_LOAD_TIMEOUT:ze.LEVEL_LOAD_ERROR,u=!1;break;case us.AUDIO_TRACK:f=r?ze.AUDIO_TRACK_LOAD_TIMEOUT:ze.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case us.SUBTITLE_TRACK:f=r?ze.SUBTITLE_TRACK_LOAD_TIMEOUT:ze.SUBTITLE_LOAD_ERROR,u=!1;break}m&&this.resetInternalLoader(e.type);const g={type:Ft.NETWORK_ERROR,details:f,fatal:u,url:e.url,loader:m,context:e,error:d,networkDetails:s,stats:o};if(n){const x=(s==null?void 0:s.url)||e.url;g.response=Is({url:x,data:void 0},n)}this.hls.trigger(Q.ERROR,g)}handlePlaylistLoaded(e,s,r,n,o,c){const d=this.hls,{type:f,level:u,levelOrTrack:m,id:g,groupId:x,deliveryDirectives:b}=n,v=Qg(s,n),w=p_(n);let S=typeof n.level=="number"&&w===Rt.MAIN?u:void 0;const T=e.playlistParsingError;if(T){if(this.hls.logger.warn(`${T} ${e.url}`),!d.config.ignorePlaylistParsingErrors){d.trigger(Q.ERROR,{type:Ft.NETWORK_ERROR,details:ze.LEVEL_PARSING_ERROR,fatal:!1,url:v,error:T,reason:T.message,response:s,context:n,level:S,parent:w,networkDetails:o,stats:r});return}e.playlistParsingError=null}if(!e.fragments.length){const k=e.playlistParsingError=new Error("No Segments found in Playlist");d.trigger(Q.ERROR,{type:Ft.NETWORK_ERROR,details:ze.LEVEL_EMPTY_ERROR,fatal:!1,url:v,error:k,reason:k.message,response:s,context:n,level:S,parent:w,networkDetails:o,stats:r});return}switch(e.live&&c&&(c.getCacheAge&&(e.ageHeader=c.getCacheAge()||0),(!c.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),f){case us.MANIFEST:case us.LEVEL:if(S){if(!m)S=0;else if(m!==d.levels[S]){const k=d.levels.indexOf(m);k>-1&&(S=k)}}d.trigger(Q.LEVEL_LOADED,{details:e,levelInfo:m||d.levels[0],level:S||0,id:g||0,stats:r,networkDetails:o,deliveryDirectives:b,withoutMultiVariant:f===us.MANIFEST});break;case us.AUDIO_TRACK:d.trigger(Q.AUDIO_TRACK_LOADED,{details:e,track:m,id:g||0,groupId:x||"",stats:r,networkDetails:o,deliveryDirectives:b});break;case us.SUBTITLE_TRACK:d.trigger(Q.SUBTITLE_TRACK_LOADED,{details:e,track:m,id:g||0,groupId:x||"",stats:r,networkDetails:o,deliveryDirectives:b});break}}}class Gs{static get version(){return Gd}static isMSESupported(){return W2()}static isSupported(){return WF()}static getMediaSource(){return co()}static get Events(){return Q}static get MetadataSchema(){return _a}static get ErrorTypes(){return Ft}static get ErrorDetails(){return ze}static get DefaultConfig(){return Gs.defaultConfig?Gs.defaultConfig:OF}static set DefaultConfig(e){Gs.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Ux,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const s=this.logger=iM(e.debug||!1,"Hls instance",e.assetPlayerId),r=this.config=BF(Gs.DefaultConfig,e,s);this.userConfig=e,r.progressive&&UF(r,s);const{abrController:n,bufferController:o,capLevelController:c,errorController:d,fpsController:f}=r,u=new d(this),m=this.abrController=new n(this),g=new t6(this),x=r.interstitialsController,b=x?this.interstitialsController=new x(this,Gs):null,v=this.bufferController=new o(this,g),w=this.capLevelController=new c(this),S=new f(this),T=new e8(this),k=r.contentSteeringController,E=k?new k(this):null,R=this.levelController=new YF(this,E),K=new qF(this),z=new JF(this.config,this.logger),D=this.streamController=new ZF(this,g,z),O=this.gapController=new VF(this,g);w.setStreamController(D),S.setStreamController(D);const U=[T,R,D];b&&U.splice(1,0,b),E&&U.splice(1,0,E),this.networkControllers=U;const I=[m,v,O,w,S,K,g];this.audioTrackController=this.createController(r.audioTrackController,U);const F=r.audioStreamController;F&&U.push(this.audioStreamController=new F(this,g,z)),this.subtitleTrackController=this.createController(r.subtitleTrackController,U);const te=r.subtitleStreamController;te&&U.push(this.subtititleStreamController=new te(this,g,z)),this.createController(r.timelineController,I),z.emeController=this.emeController=this.createController(r.emeController,I),this.cmcdController=this.createController(r.cmcdController,I),this.latencyController=this.createController(KF,I),this.coreComponents=I,U.push(u);const le=u.onErrorOut;typeof le=="function"&&this.on(Q.ERROR,le,u),this.on(Q.MANIFEST_LOADED,T.onManifestLoaded,T)}createController(e,s){if(e){const r=new e(this);return s&&s.push(r),r}return null}on(e,s,r=this){this._emitter.on(e,s,r)}once(e,s,r=this){this._emitter.once(e,s,r)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,s,r=this,n){this._emitter.off(e,s,r,n)}listeners(e){return this._emitter.listeners(e)}emit(e,s,r){return this._emitter.emit(e,s,r)}trigger(e,s){if(this.config.debug)return this.emit(e,e,s);try{return this.emit(e,e,s)}catch(r){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+r.message+'". Here is a stacktrace:',r),!this.triggeringException){this.triggeringException=!0;const n=e===Q.ERROR;this.trigger(Q.ERROR,{type:Ft.OTHER_ERROR,details:ze.INTERNAL_EXCEPTION,fatal:n,event:e,error:r}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(Q.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(s=>s.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(s=>s.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const o=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(Q.ERROR,{type:Ft.OTHER_ERROR,details:ze.ATTACH_MEDIA_ERROR,fatal:!0,error:o});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const s="media"in e,r=s?e.media:e,n=s?e:{media:r};this._media=r,this.trigger(Q.MEDIA_ATTACHING,n)}detachMedia(){this.logger.log("detachMedia"),this.trigger(Q.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(Q.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const s=this.media,r=this._url,n=this._url=Cx.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${n}`),s&&r&&(r!==n||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(s)),this.trigger(Q.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,s){this.logger.log(`startLoad(${e+(s?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let r=0;r<this.networkControllers.length&&(this.networkControllers[r].startLoad(e,s),!(!this.started||!this.networkControllers));r++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[Rt.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[Rt.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[Rt.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,s=e==null?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),s&&this.startLoad(s))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=VO()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const s=!!e;s!==this.config.capLevelToPlayerSize&&(s?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=s)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){BM(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:s}}=this;if(!e)return 0;const r=e.length;for(let n=0;n<r;n++)if(e[n].maxBitrate>=s)return n;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:s,maxHdcpLevel:r}=this;let n;if(s===-1&&e!=null&&e.length?n=e.length-1:n=s,r)for(let o=n;o--;){const c=e[o].attrs["HDCP-LEVEL"];if(c&&c<=r)return o}return n}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var s;return((s=this.audioTrackController)==null?void 0:s.setAudioOption(e))||null}setSubtitleOption(e){var s;return((s=this.subtitleTrackController)==null?void 0:s.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const s=this.audioTrackController;s&&(s.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const s=this.subtitleTrackController;s&&(s.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const s=this.subtitleTrackController;s&&(s.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,s=this.allAudioTracks){const r=Mj(s);return Dj(e,r,navigator.mediaCapabilities)}}Gs.defaultConfig=void 0;var Xg={exports:{}},x_;function t8(){return x_||(x_=1,(function(a,e){(function(s,r){a.exports=r()})(window,(function(){return(function(s){var r={};function n(o){if(r[o])return r[o].exports;var c=r[o]={i:o,l:!1,exports:{}};return s[o].call(c.exports,c,c.exports,n),c.l=!0,c.exports}return n.m=s,n.c=r,n.d=function(o,c,d){n.o(o,c)||Object.defineProperty(o,c,{enumerable:!0,get:d})},n.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},n.t=function(o,c){if(1&c&&(o=n(o)),8&c||4&c&&typeof o=="object"&&o&&o.__esModule)return o;var d=Object.create(null);if(n.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:o}),2&c&&typeof o!="string")for(var f in o)n.d(d,f,(function(u){return o[u]}).bind(null,f));return d},n.n=function(o){var c=o&&o.__esModule?function(){return o.default}:function(){return o};return n.d(c,"a",c),c},n.o=function(o,c){return Object.prototype.hasOwnProperty.call(o,c)},n.p="",n(n.s=20)})([function(s,r,n){var o=n(9),c=n.n(o),d=(function(){function f(){}return f.e=function(u,m){u&&!f.FORCE_GLOBAL_TAG||(u=f.GLOBAL_TAG);var g="[".concat(u,"] > ").concat(m);f.ENABLE_CALLBACK&&f.emitter.emit("log","error",g),f.ENABLE_ERROR&&(console.error?console.error(g):console.warn?console.warn(g):console.log(g))},f.i=function(u,m){u&&!f.FORCE_GLOBAL_TAG||(u=f.GLOBAL_TAG);var g="[".concat(u,"] > ").concat(m);f.ENABLE_CALLBACK&&f.emitter.emit("log","info",g),f.ENABLE_INFO&&(console.info?console.info(g):console.log(g))},f.w=function(u,m){u&&!f.FORCE_GLOBAL_TAG||(u=f.GLOBAL_TAG);var g="[".concat(u,"] > ").concat(m);f.ENABLE_CALLBACK&&f.emitter.emit("log","warn",g),f.ENABLE_WARN&&(console.warn?console.warn(g):console.log(g))},f.d=function(u,m){u&&!f.FORCE_GLOBAL_TAG||(u=f.GLOBAL_TAG);var g="[".concat(u,"] > ").concat(m);f.ENABLE_CALLBACK&&f.emitter.emit("log","debug",g),f.ENABLE_DEBUG&&(console.debug?console.debug(g):console.log(g))},f.v=function(u,m){u&&!f.FORCE_GLOBAL_TAG||(u=f.GLOBAL_TAG);var g="[".concat(u,"] > ").concat(m);f.ENABLE_CALLBACK&&f.emitter.emit("log","verbose",g),f.ENABLE_VERBOSE&&console.log(g)},f})();d.GLOBAL_TAG="mpegts.js",d.FORCE_GLOBAL_TAG=!1,d.ENABLE_ERROR=!0,d.ENABLE_INFO=!0,d.ENABLE_WARN=!0,d.ENABLE_DEBUG=!0,d.ENABLE_VERBOSE=!0,d.ENABLE_CALLBACK=!1,d.emitter=new c.a,r.a=d},function(s,r,n){var o;(function(c){c.IO_ERROR="io_error",c.DEMUX_ERROR="demux_error",c.INIT_SEGMENT="init_segment",c.MEDIA_SEGMENT="media_segment",c.LOADING_COMPLETE="loading_complete",c.RECOVERED_EARLY_EOF="recovered_early_eof",c.MEDIA_INFO="media_info",c.METADATA_ARRIVED="metadata_arrived",c.SCRIPTDATA_ARRIVED="scriptdata_arrived",c.TIMED_ID3_METADATA_ARRIVED="timed_id3_metadata_arrived",c.SYNCHRONOUS_KLV_METADATA_ARRIVED="synchronous_klv_metadata_arrived",c.ASYNCHRONOUS_KLV_METADATA_ARRIVED="asynchronous_klv_metadata_arrived",c.SMPTE2038_METADATA_ARRIVED="smpte2038_metadata_arrived",c.SCTE35_METADATA_ARRIVED="scte35_metadata_arrived",c.PES_PRIVATE_DATA_DESCRIPTOR="pes_private_data_descriptor",c.PES_PRIVATE_DATA_ARRIVED="pes_private_data_arrived",c.STATISTICS_INFO="statistics_info",c.RECOMMEND_SEEKPOINT="recommend_seekpoint"})(o||(o={})),r.a=o},function(s,r,n){n.d(r,"c",(function(){return c})),n.d(r,"b",(function(){return d})),n.d(r,"a",(function(){return f}));var o=n(3),c={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},d={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},f=(function(){function u(m){this._type=m||"undefined",this._status=c.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return u.prototype.destroy=function(){this._status=c.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},u.prototype.isWorking=function(){return this._status===c.kConnecting||this._status===c.kBuffering},Object.defineProperty(u.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(m){this._onContentLengthKnown=m},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(m){this._onURLRedirect=m},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(m){this._onDataArrival=m},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onError",{get:function(){return this._onError},set:function(m){this._onError=m},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onComplete",{get:function(){return this._onComplete},set:function(m){this._onComplete=m},enumerable:!1,configurable:!0}),u.prototype.open=function(m,g){throw new o.c("Unimplemented abstract function!")},u.prototype.abort=function(){throw new o.c("Unimplemented abstract function!")},u})()},function(s,r,n){n.d(r,"d",(function(){return d})),n.d(r,"a",(function(){return f})),n.d(r,"b",(function(){return u})),n.d(r,"c",(function(){return m}));var o,c=(o=function(g,x){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,v){b.__proto__=v}||function(b,v){for(var w in v)Object.prototype.hasOwnProperty.call(v,w)&&(b[w]=v[w])})(g,x)},function(g,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");function b(){this.constructor=g}o(g,x),g.prototype=x===null?Object.create(x):(b.prototype=x.prototype,new b)}),d=(function(){function g(x){this._message=x}return Object.defineProperty(g.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),g.prototype.toString=function(){return this.name+": "+this.message},g})(),f=(function(g){function x(b){return g.call(this,b)||this}return c(x,g),Object.defineProperty(x.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),x})(d),u=(function(g){function x(b){return g.call(this,b)||this}return c(x,g),Object.defineProperty(x.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),x})(d),m=(function(g){function x(b){return g.call(this,b)||this}return c(x,g),Object.defineProperty(x.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),x})(d)},function(s,r,n){var o;(function(c){c.ERROR="error",c.LOADING_COMPLETE="loading_complete",c.RECOVERED_EARLY_EOF="recovered_early_eof",c.MEDIA_INFO="media_info",c.METADATA_ARRIVED="metadata_arrived",c.SCRIPTDATA_ARRIVED="scriptdata_arrived",c.TIMED_ID3_METADATA_ARRIVED="timed_id3_metadata_arrived",c.SYNCHRONOUS_KLV_METADATA_ARRIVED="synchronous_klv_metadata_arrived",c.ASYNCHRONOUS_KLV_METADATA_ARRIVED="asynchronous_klv_metadata_arrived",c.SMPTE2038_METADATA_ARRIVED="smpte2038_metadata_arrived",c.SCTE35_METADATA_ARRIVED="scte35_metadata_arrived",c.PES_PRIVATE_DATA_DESCRIPTOR="pes_private_data_descriptor",c.PES_PRIVATE_DATA_ARRIVED="pes_private_data_arrived",c.STATISTICS_INFO="statistics_info",c.DESTROYING="destroying"})(o||(o={})),r.a=o},function(s,r,n){var o={};(function(){var c=self.navigator.userAgent.toLowerCase(),d=/(edge)\/([\w.]+)/.exec(c)||/(opr)[\/]([\w.]+)/.exec(c)||/(chrome)[ \/]([\w.]+)/.exec(c)||/(iemobile)[\/]([\w.]+)/.exec(c)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(c)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(c)||/(webkit)[ \/]([\w.]+)/.exec(c)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(c)||/(msie) ([\w.]+)/.exec(c)||c.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(c)||c.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(c)||[],f=/(ipad)/.exec(c)||/(ipod)/.exec(c)||/(windows phone)/.exec(c)||/(iphone)/.exec(c)||/(kindle)/.exec(c)||/(android)/.exec(c)||/(windows)/.exec(c)||/(mac)/.exec(c)||/(linux)/.exec(c)||/(cros)/.exec(c)||[],u={browser:d[5]||d[3]||d[1]||"",version:d[2]||d[4]||"0",majorVersion:d[4]||d[2]||"0",platform:f[0]||""},m={};if(u.browser){m[u.browser]=!0;var g=u.majorVersion.split(".");m.version={major:parseInt(u.majorVersion,10),string:u.version},g.length>1&&(m.version.minor=parseInt(g[1],10)),g.length>2&&(m.version.build=parseInt(g[2],10))}u.platform&&(m[u.platform]=!0),(m.chrome||m.opr||m.safari)&&(m.webkit=!0),(m.rv||m.iemobile)&&(m.rv&&delete m.rv,u.browser="msie",m.msie=!0),m.edge&&(delete m.edge,u.browser="msedge",m.msedge=!0),m.opr&&(u.browser="opera",m.opera=!0),m.safari&&m.android&&(u.browser="android",m.android=!0);for(var x in m.name=u.browser,m.platform=u.platform,o)o.hasOwnProperty(x)&&delete o[x];Object.assign(o,m)})(),r.a=o},function(s,r,n){r.a={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"}},function(s,r,n){var o;(function(c){c.ERROR="error",c.SOURCE_OPEN="source_open",c.UPDATE_END="update_end",c.BUFFER_FULL="buffer_full",c.START_STREAMING="start_streaming",c.END_STREAMING="end_streaming"})(o||(o={})),r.a=o},function(s,r,n){var o=n(9),c=n.n(o),d=n(0),f=(function(){function u(){}return Object.defineProperty(u,"forceGlobalTag",{get:function(){return d.a.FORCE_GLOBAL_TAG},set:function(m){d.a.FORCE_GLOBAL_TAG=m,u._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(u,"globalTag",{get:function(){return d.a.GLOBAL_TAG},set:function(m){d.a.GLOBAL_TAG=m,u._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(u,"enableAll",{get:function(){return d.a.ENABLE_VERBOSE&&d.a.ENABLE_DEBUG&&d.a.ENABLE_INFO&&d.a.ENABLE_WARN&&d.a.ENABLE_ERROR},set:function(m){d.a.ENABLE_VERBOSE=m,d.a.ENABLE_DEBUG=m,d.a.ENABLE_INFO=m,d.a.ENABLE_WARN=m,d.a.ENABLE_ERROR=m,u._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(u,"enableDebug",{get:function(){return d.a.ENABLE_DEBUG},set:function(m){d.a.ENABLE_DEBUG=m,u._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(u,"enableVerbose",{get:function(){return d.a.ENABLE_VERBOSE},set:function(m){d.a.ENABLE_VERBOSE=m,u._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(u,"enableInfo",{get:function(){return d.a.ENABLE_INFO},set:function(m){d.a.ENABLE_INFO=m,u._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(u,"enableWarn",{get:function(){return d.a.ENABLE_WARN},set:function(m){d.a.ENABLE_WARN=m,u._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(u,"enableError",{get:function(){return d.a.ENABLE_ERROR},set:function(m){d.a.ENABLE_ERROR=m,u._notifyChange()},enumerable:!1,configurable:!0}),u.getConfig=function(){return{globalTag:d.a.GLOBAL_TAG,forceGlobalTag:d.a.FORCE_GLOBAL_TAG,enableVerbose:d.a.ENABLE_VERBOSE,enableDebug:d.a.ENABLE_DEBUG,enableInfo:d.a.ENABLE_INFO,enableWarn:d.a.ENABLE_WARN,enableError:d.a.ENABLE_ERROR,enableCallback:d.a.ENABLE_CALLBACK}},u.applyConfig=function(m){d.a.GLOBAL_TAG=m.globalTag,d.a.FORCE_GLOBAL_TAG=m.forceGlobalTag,d.a.ENABLE_VERBOSE=m.enableVerbose,d.a.ENABLE_DEBUG=m.enableDebug,d.a.ENABLE_INFO=m.enableInfo,d.a.ENABLE_WARN=m.enableWarn,d.a.ENABLE_ERROR=m.enableError,d.a.ENABLE_CALLBACK=m.enableCallback},u._notifyChange=function(){var m=u.emitter;if(m.listenerCount("change")>0){var g=u.getConfig();m.emit("change",g)}},u.registerListener=function(m){u.emitter.addListener("change",m)},u.removeListener=function(m){u.emitter.removeListener("change",m)},u.addLogListener=function(m){d.a.emitter.addListener("log",m),d.a.emitter.listenerCount("log")>0&&(d.a.ENABLE_CALLBACK=!0,u._notifyChange())},u.removeLogListener=function(m){d.a.emitter.removeListener("log",m),d.a.emitter.listenerCount("log")===0&&(d.a.ENABLE_CALLBACK=!1,u._notifyChange())},u})();f.emitter=new c.a,r.a=f},function(s,r,n){var o,c=typeof Reflect=="object"?Reflect:null,d=c&&typeof c.apply=="function"?c.apply:function(R,K,z){return Function.prototype.apply.call(R,K,z)};o=c&&typeof c.ownKeys=="function"?c.ownKeys:Object.getOwnPropertySymbols?function(R){return Object.getOwnPropertyNames(R).concat(Object.getOwnPropertySymbols(R))}:function(R){return Object.getOwnPropertyNames(R)};var f=Number.isNaN||function(R){return R!=R};function u(){u.init.call(this)}s.exports=u,s.exports.once=function(R,K){return new Promise((function(z,D){function O(I){R.removeListener(K,U),D(I)}function U(){typeof R.removeListener=="function"&&R.removeListener("error",O),z([].slice.call(arguments))}E(R,K,U,{once:!0}),K!=="error"&&(function(I,F,te){typeof I.on=="function"&&E(I,"error",F,te)})(R,O,{once:!0})}))},u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var m=10;function g(R){if(typeof R!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof R)}function x(R){return R._maxListeners===void 0?u.defaultMaxListeners:R._maxListeners}function b(R,K,z,D){var O,U,I,F;if(g(z),(U=R._events)===void 0?(U=R._events=Object.create(null),R._eventsCount=0):(U.newListener!==void 0&&(R.emit("newListener",K,z.listener?z.listener:z),U=R._events),I=U[K]),I===void 0)I=U[K]=z,++R._eventsCount;else if(typeof I=="function"?I=U[K]=D?[z,I]:[I,z]:D?I.unshift(z):I.push(z),(O=x(R))>0&&I.length>O&&!I.warned){I.warned=!0;var te=new Error("Possible EventEmitter memory leak detected. "+I.length+" "+String(K)+" listeners added. Use emitter.setMaxListeners() to increase limit");te.name="MaxListenersExceededWarning",te.emitter=R,te.type=K,te.count=I.length,F=te,console&&console.warn&&console.warn(F)}return R}function v(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function w(R,K,z){var D={fired:!1,wrapFn:void 0,target:R,type:K,listener:z},O=v.bind(D);return O.listener=z,D.wrapFn=O,O}function S(R,K,z){var D=R._events;if(D===void 0)return[];var O=D[K];return O===void 0?[]:typeof O=="function"?z?[O.listener||O]:[O]:z?(function(U){for(var I=new Array(U.length),F=0;F<I.length;++F)I[F]=U[F].listener||U[F];return I})(O):k(O,O.length)}function T(R){var K=this._events;if(K!==void 0){var z=K[R];if(typeof z=="function")return 1;if(z!==void 0)return z.length}return 0}function k(R,K){for(var z=new Array(K),D=0;D<K;++D)z[D]=R[D];return z}function E(R,K,z,D){if(typeof R.on=="function")D.once?R.once(K,z):R.on(K,z);else{if(typeof R.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof R);R.addEventListener(K,(function O(U){D.once&&R.removeEventListener(K,O),z(U)}))}}Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return m},set:function(R){if(typeof R!="number"||R<0||f(R))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+R+".");m=R}}),u.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=function(R){if(typeof R!="number"||R<0||f(R))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+R+".");return this._maxListeners=R,this},u.prototype.getMaxListeners=function(){return x(this)},u.prototype.emit=function(R){for(var K=[],z=1;z<arguments.length;z++)K.push(arguments[z]);var D=R==="error",O=this._events;if(O!==void 0)D=D&&O.error===void 0;else if(!D)return!1;if(D){var U;if(K.length>0&&(U=K[0]),U instanceof Error)throw U;var I=new Error("Unhandled error."+(U?" ("+U.message+")":""));throw I.context=U,I}var F=O[R];if(F===void 0)return!1;if(typeof F=="function")d(F,this,K);else{var te=F.length,le=k(F,te);for(z=0;z<te;++z)d(le[z],this,K)}return!0},u.prototype.addListener=function(R,K){return b(this,R,K,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(R,K){return b(this,R,K,!0)},u.prototype.once=function(R,K){return g(K),this.on(R,w(this,R,K)),this},u.prototype.prependOnceListener=function(R,K){return g(K),this.prependListener(R,w(this,R,K)),this},u.prototype.removeListener=function(R,K){var z,D,O,U,I;if(g(K),(D=this._events)===void 0)return this;if((z=D[R])===void 0)return this;if(z===K||z.listener===K)--this._eventsCount==0?this._events=Object.create(null):(delete D[R],D.removeListener&&this.emit("removeListener",R,z.listener||K));else if(typeof z!="function"){for(O=-1,U=z.length-1;U>=0;U--)if(z[U]===K||z[U].listener===K){I=z[U].listener,O=U;break}if(O<0)return this;O===0?z.shift():(function(F,te){for(;te+1<F.length;te++)F[te]=F[te+1];F.pop()})(z,O),z.length===1&&(D[R]=z[0]),D.removeListener!==void 0&&this.emit("removeListener",R,I||K)}return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(R){var K,z,D;if((z=this._events)===void 0)return this;if(z.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):z[R]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete z[R]),this;if(arguments.length===0){var O,U=Object.keys(z);for(D=0;D<U.length;++D)(O=U[D])!=="removeListener"&&this.removeAllListeners(O);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(K=z[R])=="function")this.removeListener(R,K);else if(K!==void 0)for(D=K.length-1;D>=0;D--)this.removeListener(R,K[D]);return this},u.prototype.listeners=function(R){return S(this,R,!0)},u.prototype.rawListeners=function(R){return S(this,R,!1)},u.listenerCount=function(R,K){return typeof R.listenerCount=="function"?R.listenerCount(K):T.call(R,K)},u.prototype.listenerCount=T,u.prototype.eventNames=function(){return this._eventsCount>0?o(this._events):[]}},function(s,r,n){n.d(r,"b",(function(){return d})),n.d(r,"a",(function(){return f}));var o=n(2),c=n(6),d={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},f={NETWORK_EXCEPTION:o.b.EXCEPTION,NETWORK_STATUS_CODE_INVALID:o.b.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:o.b.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:o.b.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:c.a.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:c.a.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:c.a.CODEC_UNSUPPORTED}},function(s,r,n){n.d(r,"d",(function(){return o})),n.d(r,"b",(function(){return c})),n.d(r,"a",(function(){return d})),n.d(r,"c",(function(){return f}));var o=function(u,m,g,x,b){this.dts=u,this.pts=m,this.duration=g,this.originalDts=x,this.isSyncPoint=b,this.fileposition=null},c=(function(){function u(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return u.prototype.appendSyncPoint=function(m){m.isSyncPoint=!0,this.syncPoints.push(m)},u})(),d=(function(){function u(){this._list=[]}return u.prototype.clear=function(){this._list=[]},u.prototype.appendArray=function(m){var g=this._list;m.length!==0&&(g.length>0&&m[0].originalDts<g[g.length-1].originalDts&&this.clear(),Array.prototype.push.apply(g,m))},u.prototype.getLastSyncPointBeforeDts=function(m){if(this._list.length==0)return null;var g=this._list,x=0,b=g.length-1,v=0,w=0,S=b;for(m<g[0].dts&&(x=0,w=S+1);w<=S;){if((v=w+Math.floor((S-w)/2))===b||m>=g[v].dts&&m<g[v+1].dts){x=v;break}g[v].dts<m?w=v+1:S=v-1}return this._list[x]},u})(),f=(function(){function u(m){this._type=m,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(u.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),u.prototype.isEmpty=function(){return this._list.length===0},u.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},u.prototype._searchNearestSegmentBefore=function(m){var g=this._list;if(g.length===0)return-2;var x=g.length-1,b=0,v=0,w=x,S=0;if(m<g[0].originalBeginDts)return S=-1;for(;v<=w;){if((b=v+Math.floor((w-v)/2))===x||m>g[b].lastSample.originalDts&&m<g[b+1].originalBeginDts){S=b;break}g[b].originalBeginDts<m?v=b+1:w=b-1}return S},u.prototype._searchNearestSegmentAfter=function(m){return this._searchNearestSegmentBefore(m)+1},u.prototype.append=function(m){var g=this._list,x=m,b=this._lastAppendLocation,v=0;b!==-1&&b<g.length&&x.originalBeginDts>=g[b].lastSample.originalDts&&(b===g.length-1||b<g.length-1&&x.originalBeginDts<g[b+1].originalBeginDts)?v=b+1:g.length>0&&(v=this._searchNearestSegmentBefore(x.originalBeginDts)+1),this._lastAppendLocation=v,this._list.splice(v,0,x)},u.prototype.getLastSegmentBefore=function(m){var g=this._searchNearestSegmentBefore(m);return g>=0?this._list[g]:null},u.prototype.getLastSampleBefore=function(m){var g=this.getLastSegmentBefore(m);return g!=null?g.lastSample:null},u.prototype.getLastSyncPointBefore=function(m){for(var g=this._searchNearestSegmentBefore(m),x=this._list[g].syncPoints;x.length===0&&g>0;)g--,x=this._list[g].syncPoints;return x.length>0?x[x.length-1]:null},u})()},function(s,r,n){var o=(function(){function c(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return c.prototype.isComplete=function(){var d=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,f=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&d&&f},c.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},c.prototype.getNearestKeyframe=function(d){if(this.keyframesIndex==null)return null;var f=this.keyframesIndex,u=this._search(f.times,d);return{index:u,milliseconds:f.times[u],fileposition:f.filepositions[u]}},c.prototype._search=function(d,f){var u=0,m=d.length-1,g=0,x=0,b=m;for(f<d[0]&&(u=0,x=b+1);x<=b;){if((g=x+Math.floor((b-x)/2))===m||f>=d[g]&&f<d[g+1]){u=g;break}d[g]<f?x=g+1:b=g-1}return u},c})();r.a=o},function(s,r,n){var o=n(9),c=n.n(o),d=n(0),f=n(5),u=n(12);function m(M,C,j){var _=M;if(C+j<_.length){for(;j--;)if((192&_[++C])!=128)return!1;return!0}return!1}var g,x=function(M){for(var C=[],j=M,_=0,P=M.length;_<P;)if(j[_]<128)C.push(String.fromCharCode(j[_])),++_;else{if(!(j[_]<192)){if(j[_]<224){if(m(j,_,1)&&(L=(31&j[_])<<6|63&j[_+1])>=128){C.push(String.fromCharCode(65535&L)),_+=2;continue}}else if(j[_]<240){if(m(j,_,2)&&(L=(15&j[_])<<12|(63&j[_+1])<<6|63&j[_+2])>=2048&&(63488&L)!=55296){C.push(String.fromCharCode(65535&L)),_+=3;continue}}else if(j[_]<248){var L;if(m(j,_,3)&&(L=(7&j[_])<<18|(63&j[_+1])<<12|(63&j[_+2])<<6|63&j[_+3])>65536&&L<1114112){L-=65536,C.push(String.fromCharCode(L>>>10|55296)),C.push(String.fromCharCode(1023&L|56320)),_+=4;continue}}}C.push(""),++_}return C.join("")},b=n(3),v=(g=new ArrayBuffer(2),new DataView(g).setInt16(0,256,!0),new Int16Array(g)[0]===256),w=(function(){function M(){}return M.parseScriptData=function(C,j,_){var P={};try{var L=M.parseValue(C,j,_),$=M.parseValue(C,j+L.size,_-L.size);P[L.data]=$.data}catch(J){d.a.e("AMF",J.toString())}return P},M.parseObject=function(C,j,_){if(_<3)throw new b.a("Data not enough when parse ScriptDataObject");var P=M.parseString(C,j,_),L=M.parseValue(C,j+P.size,_-P.size),$=L.objectEnd;return{data:{name:P.data,value:L.data},size:P.size+L.size,objectEnd:$}},M.parseVariable=function(C,j,_){return M.parseObject(C,j,_)},M.parseString=function(C,j,_){if(_<2)throw new b.a("Data not enough when parse String");var P=new DataView(C,j,_).getUint16(0,!v);return{data:P>0?x(new Uint8Array(C,j+2,P)):"",size:2+P}},M.parseLongString=function(C,j,_){if(_<4)throw new b.a("Data not enough when parse LongString");var P=new DataView(C,j,_).getUint32(0,!v);return{data:P>0?x(new Uint8Array(C,j+4,P)):"",size:4+P}},M.parseDate=function(C,j,_){if(_<10)throw new b.a("Data size invalid when parse Date");var P=new DataView(C,j,_),L=P.getFloat64(0,!v),$=P.getInt16(8,!v);return{data:new Date(L+=60*$*1e3),size:10}},M.parseValue=function(C,j,_){if(_<1)throw new b.a("Data not enough when parse Value");var P,L=new DataView(C,j,_),$=1,J=L.getUint8(0),de=!1;try{switch(J){case 0:P=L.getFloat64(1,!v),$+=8;break;case 1:P=!!L.getUint8(1),$+=1;break;case 2:var B=M.parseString(C,j+1,_-1);P=B.data,$+=B.size;break;case 3:P={};var se=0;for((16777215&L.getUint32(_-4,!v))==9&&(se=3);$<_-4;){var fe=M.parseObject(C,j+$,_-$-se);if(fe.objectEnd)break;P[fe.data.name]=fe.data.value,$+=fe.size}$<=_-3&&(16777215&L.getUint32($-1,!v))===9&&($+=3);break;case 8:for(P={},$+=4,se=0,(16777215&L.getUint32(_-4,!v))==9&&(se=3);$<_-8;){var he=M.parseVariable(C,j+$,_-$-se);if(he.objectEnd)break;P[he.data.name]=he.data.value,$+=he.size}$<=_-3&&(16777215&L.getUint32($-1,!v))===9&&($+=3);break;case 9:P=void 0,$=1,de=!0;break;case 10:P=[];var pe=L.getUint32(1,!v);$+=4;for(var Ue=0;Ue<pe;Ue++){var Ge=M.parseValue(C,j+$,_-$);P.push(Ge.data),$+=Ge.size}break;case 11:var re=M.parseDate(C,j+1,_-1);P=re.data,$+=re.size;break;case 12:var Le=M.parseString(C,j+1,_-1);P=Le.data,$+=Le.size;break;default:$=_,d.a.w("AMF","Unsupported AMF value type "+J)}}catch(Je){d.a.e("AMF",Je.toString())}return{data:P,size:$,objectEnd:de}},M})(),S=(function(){function M(C){this.TAG="ExpGolomb",this._buffer=C,this._buffer_index=0,this._total_bytes=C.byteLength,this._total_bits=8*C.byteLength,this._current_word=0,this._current_word_bits_left=0}return M.prototype.destroy=function(){this._buffer=null},M.prototype._fillCurrentWord=function(){var C=this._total_bytes-this._buffer_index;if(C<=0)throw new b.a("ExpGolomb: _fillCurrentWord() but no bytes available");var j=Math.min(4,C),_=new Uint8Array(4);_.set(this._buffer.subarray(this._buffer_index,this._buffer_index+j)),this._current_word=new DataView(_.buffer).getUint32(0,!1),this._buffer_index+=j,this._current_word_bits_left=8*j},M.prototype.readBits=function(C){if(C>32)throw new b.b("ExpGolomb: readBits() bits exceeded max 32bits!");if(C<=this._current_word_bits_left){var j=this._current_word>>>32-C;return this._current_word<<=C,this._current_word_bits_left-=C,j}var _=this._current_word_bits_left?this._current_word:0;_>>>=32-this._current_word_bits_left;var P=C-this._current_word_bits_left;this._fillCurrentWord();var L=Math.min(P,this._current_word_bits_left),$=this._current_word>>>32-L;return this._current_word<<=L,this._current_word_bits_left-=L,_=_<<L|$},M.prototype.readBool=function(){return this.readBits(1)===1},M.prototype.readByte=function(){return this.readBits(8)},M.prototype._skipLeadingZero=function(){var C;for(C=0;C<this._current_word_bits_left;C++)if((this._current_word&2147483648>>>C)!=0)return this._current_word<<=C,this._current_word_bits_left-=C,C;return this._fillCurrentWord(),C+this._skipLeadingZero()},M.prototype.readUEG=function(){var C=this._skipLeadingZero();return this.readBits(C+1)-1},M.prototype.readSEG=function(){var C=this.readUEG();return 1&C?C+1>>>1:-1*(C>>>1)},M})(),T=(function(){function M(){}return M._ebsp2rbsp=function(C){for(var j=C,_=j.byteLength,P=new Uint8Array(_),L=0,$=0;$<_;$++)$>=2&&j[$]===3&&j[$-1]===0&&j[$-2]===0||(P[L]=j[$],L++);return new Uint8Array(P.buffer,0,L)},M.parseSPS=function(C){for(var j=C.subarray(1,4),_="avc1.",P=0;P<3;P++){var L=j[P].toString(16);L.length<2&&(L="0"+L),_+=L}var $=M._ebsp2rbsp(C),J=new S($);J.readByte();var de=J.readByte();J.readByte();var B=J.readByte();J.readUEG();var se=M.getProfileString(de),fe=M.getLevelString(B),he=1,pe=420,Ue=8,Ge=8;if((de===100||de===110||de===122||de===244||de===44||de===83||de===86||de===118||de===128||de===138||de===144)&&((he=J.readUEG())===3&&J.readBits(1),he<=3&&(pe=[0,420,422,444][he]),Ue=J.readUEG()+8,Ge=J.readUEG()+8,J.readBits(1),J.readBool()))for(var re=he!==3?8:12,Le=0;Le<re;Le++)J.readBool()&&(Le<6?M._skipScalingList(J,16):M._skipScalingList(J,64));J.readUEG();var Je=J.readUEG();if(Je===0)J.readUEG();else if(Je===1){J.readBits(1),J.readSEG(),J.readSEG();var it=J.readUEG();for(Le=0;Le<it;Le++)J.readSEG()}var Et=J.readUEG();J.readBits(1);var Ht=J.readUEG(),_t=J.readUEG(),Pt=J.readBits(1);Pt===0&&J.readBits(1),J.readBits(1);var Wt=0,Bt=0,It=0,Qt=0;J.readBool()&&(Wt=J.readUEG(),Bt=J.readUEG(),It=J.readUEG(),Qt=J.readUEG());var _s=1,Yt=1,es=0,Es=!0,Ys=0,ua=0;if(J.readBool()){if(J.readBool()){var Rs=J.readByte();Rs>0&&Rs<16?(_s=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][Rs-1],Yt=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][Rs-1]):Rs===255&&(_s=J.readByte()<<8|J.readByte(),Yt=J.readByte()<<8|J.readByte())}if(J.readBool()&&J.readBool(),J.readBool()&&(J.readBits(4),J.readBool()&&J.readBits(24)),J.readBool()&&(J.readUEG(),J.readUEG()),J.readBool()){var Ar=J.readBits(32),Nr=J.readBits(32);Es=J.readBool(),es=(Ys=Nr)/(ua=2*Ar)}}var mr=1;_s===1&&Yt===1||(mr=_s/Yt);var rr=0,ys=0;he===0?(rr=1,ys=2-Pt):(rr=he===3?1:2,ys=(he===1?2:1)*(2-Pt));var Aa=16*(Ht+1),Fr=16*(_t+1)*(2-Pt);Aa-=(Wt+Bt)*rr,Fr-=(It+Qt)*ys;var dl=Math.ceil(Aa*mr);return J.destroy(),J=null,{codec_mimetype:_,profile_idc:de,level_idc:B,profile_string:se,level_string:fe,chroma_format_idc:he,bit_depth:Ue,bit_depth_luma:Ue,bit_depth_chroma:Ge,ref_frames:Et,chroma_format:pe,chroma_format_string:M.getChromaFormatString(pe),frame_rate:{fixed:Es,fps:es,fps_den:ua,fps_num:Ys},sar_ratio:{width:_s,height:Yt},codec_size:{width:Aa,height:Fr},present_size:{width:dl,height:Fr}}},M._skipScalingList=function(C,j){for(var _=8,P=8,L=0;L<j;L++)P!==0&&(P=(_+C.readSEG()+256)%256),_=P===0?_:P},M.getProfileString=function(C){switch(C){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},M.getLevelString=function(C){return(C/10).toFixed(1)},M.getChromaFormatString=function(C){switch(C){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},M})(),k=n(6),E=(function(){function M(){}return M._ebsp2rbsp=function(C){for(var j=C,_=j.byteLength,P=new Uint8Array(_),L=0,$=0;$<_;$++)$>=2&&j[$]===3&&j[$-1]===0&&j[$-2]===0||(P[L]=j[$],L++);return new Uint8Array(P.buffer,0,L)},M.parseVPS=function(C){var j=M._ebsp2rbsp(C),_=new S(j);return _.readByte(),_.readByte(),_.readBits(4),_.readBits(2),_.readBits(6),{num_temporal_layers:_.readBits(3)+1,temporal_id_nested:_.readBool()}},M.parseSPS=function(C){var j=M._ebsp2rbsp(C),_=new S(j);_.readByte(),_.readByte();for(var P=0,L=0,$=0,J=0,de=(_.readBits(4),_.readBits(3)),B=(_.readBool(),_.readBits(2)),se=_.readBool(),fe=_.readBits(5),he=_.readByte(),pe=_.readByte(),Ue=_.readByte(),Ge=_.readByte(),re=_.readByte(),Le=_.readByte(),Je=_.readByte(),it=_.readByte(),Et=_.readByte(),Ht=_.readByte(),_t=_.readByte(),Pt=[],Wt=[],Bt=0;Bt<de;Bt++)Pt.push(_.readBool()),Wt.push(_.readBool());if(de>0)for(Bt=de;Bt<8;Bt++)_.readBits(2);for(Bt=0;Bt<de;Bt++)Pt[Bt]&&(_.readByte(),_.readByte(),_.readByte(),_.readByte(),_.readByte(),_.readByte(),_.readByte(),_.readByte(),_.readByte(),_.readByte(),_.readByte()),Wt[Bt]&&_.readByte();_.readUEG();var It=_.readUEG();It==3&&_.readBits(1);var Qt=_.readUEG(),_s=_.readUEG();_.readBool()&&(P+=_.readUEG(),L+=_.readUEG(),$+=_.readUEG(),J+=_.readUEG());var Yt=_.readUEG(),es=_.readUEG(),Es=_.readUEG();for(Bt=_.readBool()?0:de;Bt<=de;Bt++)_.readUEG(),_.readUEG(),_.readUEG();if(_.readUEG(),_.readUEG(),_.readUEG(),_.readUEG(),_.readUEG(),_.readUEG(),_.readBool()&&_.readBool())for(var Ys=0;Ys<4;Ys++)for(var ua=0;ua<(Ys===3?2:6);ua++)if(_.readBool()){var Rs=Math.min(64,1<<4+(Ys<<1));for(Ys>1&&_.readSEG(),Bt=0;Bt<Rs;Bt++)_.readSEG()}else _.readUEG();_.readBool(),_.readBool(),_.readBool()&&(_.readByte(),_.readUEG(),_.readUEG(),_.readBool());var Ar=_.readUEG(),Nr=0;for(Bt=0;Bt<Ar;Bt++){var mr=!1;if(Bt!==0&&(mr=_.readBool()),mr){Bt===Ar&&_.readUEG(),_.readBool(),_.readUEG();for(var rr=0,ys=0;ys<=Nr;ys++){var Aa=_.readBool(),Fr=!1;Aa||(Fr=_.readBool()),(Aa||Fr)&&rr++}Nr=rr}else{var dl=_.readUEG(),Nc=_.readUEG();for(Nr=dl+Nc,ys=0;ys<dl;ys++)_.readUEG(),_.readBool();for(ys=0;ys<Nc;ys++)_.readUEG(),_.readBool()}}if(_.readBool()){var du=_.readUEG();for(Bt=0;Bt<du;Bt++){for(ys=0;ys<Es+4;ys++)_.readBits(1);_.readBits(1)}}var ul=0,ho=1,fo=1,mo=!1,ha=1,go=1;if(_.readBool(),_.readBool(),_.readBool()){if(_.readBool()){var Ln=_.readByte();Ln>0&&Ln<=16?(ho=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][Ln-1],fo=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][Ln-1]):Ln===255&&(ho=_.readBits(16),fo=_.readBits(16))}if(_.readBool()&&_.readBool(),_.readBool()&&(_.readBits(3),_.readBool(),_.readBool()&&(_.readByte(),_.readByte(),_.readByte())),_.readBool()&&(_.readUEG(),_.readUEG()),_.readBool(),_.readBool(),_.readBool(),_.readBool()&&(_.readUEG(),_.readUEG(),_.readUEG(),_.readUEG()),_.readBool()&&(ha=_.readBits(32),go=_.readBits(32),_.readBool()&&_.readUEG(),_.readBool())){var ln=!1,cn=!1,po=!1;for(ln=_.readBool(),cn=_.readBool(),(ln||cn)&&((po=_.readBool())&&(_.readByte(),_.readBits(5),_.readBool(),_.readBits(5)),_.readBits(4),_.readBits(4),po&&_.readBits(4),_.readBits(5),_.readBits(5),_.readBits(5)),Bt=0;Bt<=de;Bt++){var hl=_.readBool();mo=hl;var jc=!0,Dn=1;hl||(jc=_.readBool());var Ca=!1;if(jc?_.readUEG():Ca=_.readBool(),Ca||(Dn=_.readUEG()+1),ln){for(ys=0;ys<Dn;ys++)_.readUEG(),_.readUEG(),po&&(_.readUEG(),_.readUEG());_.readBool()}if(cn){for(ys=0;ys<Dn;ys++)_.readUEG(),_.readUEG(),po&&(_.readUEG(),_.readUEG());_.readBool()}}}_.readBool()&&(_.readBool(),_.readBool(),_.readBool(),ul=_.readUEG(),_.readUEG(),_.readUEG(),_.readUEG(),_.readUEG())}_.readBool();var Ec="hvc1.".concat(fe,".1.L").concat(_t,".B0"),pi=Qt-(P+L)*(It===1||It===2?2:1),Ka=_s-($+J)*(It===1?2:1),fl=1;return ho!==1&&fo!==1&&(fl=ho/fo),_.destroy(),_=null,{codec_mimetype:Ec,profile_string:M.getProfileString(fe),level_string:M.getLevelString(_t),profile_idc:fe,bit_depth:Yt+8,ref_frames:1,chroma_format:It,chroma_format_string:M.getChromaFormatString(It),general_level_idc:_t,general_profile_space:B,general_tier_flag:se,general_profile_idc:fe,general_profile_compatibility_flags_1:he,general_profile_compatibility_flags_2:pe,general_profile_compatibility_flags_3:Ue,general_profile_compatibility_flags_4:Ge,general_constraint_indicator_flags_1:re,general_constraint_indicator_flags_2:Le,general_constraint_indicator_flags_3:Je,general_constraint_indicator_flags_4:it,general_constraint_indicator_flags_5:Et,general_constraint_indicator_flags_6:Ht,min_spatial_segmentation_idc:ul,constant_frame_rate:0,chroma_format_idc:It,bit_depth_luma_minus8:Yt,bit_depth_chroma_minus8:es,frame_rate:{fixed:mo,fps:go/ha,fps_den:ha,fps_num:go},sar_ratio:{width:ho,height:fo},codec_size:{width:pi,height:Ka},present_size:{width:pi*fl,height:Ka}}},M.parsePPS=function(C){var j=M._ebsp2rbsp(C),_=new S(j);_.readByte(),_.readByte(),_.readUEG(),_.readUEG(),_.readBool(),_.readBool(),_.readBits(3),_.readBool(),_.readBool(),_.readUEG(),_.readUEG(),_.readSEG(),_.readBool(),_.readBool(),_.readBool()&&_.readUEG(),_.readSEG(),_.readSEG(),_.readBool(),_.readBool(),_.readBool(),_.readBool();var P=_.readBool(),L=_.readBool(),$=1;return L&&P?$=0:L?$=3:P&&($=2),{parallelismType:$}},M.getChromaFormatString=function(C){switch(C){case 0:return"4:0:0";case 1:return"4:2:0";case 2:return"4:2:2";case 3:return"4:4:4";default:return"Unknown"}},M.getProfileString=function(C){switch(C){case 1:return"Main";case 2:return"Main10";case 3:return"MainSP";case 4:return"Rext";case 9:return"SCC";default:return"Unknown"}},M.getLevelString=function(C){return(C/30).toFixed(1)},M})();function R(M){return M.byteOffset%2==0&&M.byteLength%2==0}function K(M){return M.byteOffset%4==0&&M.byteLength%4==0}function z(M,C){for(var j=0;j<M.length;j++)if(M[j]!==C[j])return!1;return!0}var D=function(M,C){return M.byteLength===C.byteLength&&(K(M)&&K(C)?(function(j,_){return z(new Uint32Array(j.buffer,j.byteOffset,j.byteLength/4),new Uint32Array(_.buffer,_.byteOffset,_.byteLength/4))})(M,C):R(M)&&R(C)?(function(j,_){return z(new Uint16Array(j.buffer,j.byteOffset,j.byteLength/2),new Uint16Array(_.buffer,_.byteOffset,_.byteLength/2))})(M,C):(function(j,_){return z(j,_)})(M,C))},O=function(){return(O=Object.assign||function(M){for(var C,j=1,_=arguments.length;j<_;j++)for(var P in C=arguments[j])Object.prototype.hasOwnProperty.call(C,P)&&(M[P]=C[P]);return M}).apply(this,arguments)},U=(function(){function M(){}return M.parseOBUs=function(C,j){for(var _=0;_<C.byteLength;){var P=_,L=(C[_],(120&C[_])>>3),$=(4&C[_])!=0,J=(2&C[_])!=0;C[_],_+=1,$&&(_+=1);var de=Number.POSITIVE_INFINITY;if(J){de=0;for(var B=0;;B++){var se=C[_++];if(de|=(127&se)<<7*B,(128&se)==0)break}}console.log(L),L===1?j=O(O({},M.parseSeuqneceHeader(C.subarray(_,_+de))),{sequence_header_data:C.subarray(P,_+de)}):(L==3&&j||L==6&&j)&&(j=M.parseOBUFrameHeader(C.subarray(_,_+de),0,0,j)),_+=de}return j},M.parseSeuqneceHeader=function(C){var j=new S(C),_=j.readBits(3),P=(j.readBool(),j.readBool()),L=!0,$=0,J=1,de=void 0,B=[];if(P)B.push({operating_point_idc:0,level:j.readBits(5),tier:0});else{if(j.readBool()){var se=j.readBits(32),fe=j.readBits(32),he=j.readBool();if(he){for(var pe=0;j.readBits(1)===0;)pe+=1;pe>=32||(1<<pe)-1+j.readBits(pe)}($=fe)/(J=se),L=he,j.readBool()&&(j.readBits(5),j.readBits(32),de=j.readBits(5),j.readBits(5))}for(var Ue=j.readBool(),Ge=j.readBits(5),re=0;re<=Ge;re++){var Le=j.readBits(12),Je=j.readBits(5),it=Je>7?j.readBits(1):0;B.push({operating_point_idc:Le,level:Je,tier:it}),Ue&&j.readBool()&&j.readBits(4)}}var Et=B[0],Ht=Et.level,_t=Et.tier,Pt=j.readBits(4),Wt=j.readBits(4),Bt=j.readBits(Pt+1)+1,It=j.readBits(Wt+1)+1,Qt=!1;P||(Qt=j.readBool()),Qt&&(j.readBits(4),j.readBits(4)),j.readBool(),j.readBool(),j.readBool();var _s=!1,Yt=2,es=2,Es=0;P||(j.readBool(),j.readBool(),j.readBool(),j.readBool(),(_s=j.readBool())&&(j.readBool(),j.readBool()),(Yt=j.readBool()?2:j.readBits(1))?es=j.readBool()?2:j.readBits(1):es=2,_s?Es=j.readBits(3)+1:Es=0);var Ys=j.readBool(),ua=(j.readBool(),j.readBool(),j.readBool()),Rs=8;_===2&&ua?Rs=j.readBool()?12:10:Rs=ua?10:8;var Ar=!1;_!==1&&(Ar=j.readBool()),j.readBool()&&(j.readBits(8),j.readBits(8),j.readBits(8));var Nr=1,mr=1;return Ar?(j.readBits(1),Nr=1,mr=1):(j.readBits(1),_==0?(Nr=1,mr=1):_==1?(Nr=0,mr=0):Rs==12?j.readBits(1)&&j.readBits(1):(Nr=1,mr=0),Nr&&mr&&j.readBits(2),j.readBits(1)),j.readBool(),j.destroy(),j=null,{codec_mimetype:"av01.".concat(_,".").concat(M.getLevelString(Ht,_t),".").concat(Rs.toString(10).padStart(2,"0")),level:Ht,tier:_t,level_string:M.getLevelString(Ht,_t),profile_idc:_,profile_string:"".concat(_),bit_depth:Rs,ref_frames:1,chroma_format:M.getChromaFormat(Ar,Nr,mr),chroma_format_string:M.getChromaFormatString(Ar,Nr,mr),sequence_header:{frame_id_numbers_present_flag:Qt,additional_frame_id_length_minus_1:void 0,delta_frame_id_length_minus_2:void 0,reduced_still_picture_header:P,decoder_model_info_present_flag:!1,operating_points:B,buffer_removal_time_length_minus_1:de,equal_picture_interval:L,seq_force_screen_content_tools:Yt,seq_force_integer_mv:es,enable_order_hint:_s,order_hint_bits:Es,enable_superres:Ys,frame_width_bit:Pt+1,frame_height_bit:Wt+1,max_frame_width:Bt,max_frame_height:It},keyframe:void 0,frame_rate:{fixed:L,fps:$/J,fps_den:J,fps_num:$}}},M.parseOBUFrameHeader=function(C,j,_,P){var L=P.sequence_header,$=new S(C),J=(L.max_frame_width,L.max_frame_height,0);L.frame_id_numbers_present_flag&&(J=L.additional_frame_id_length_minus_1+L.delta_frame_id_length_minus_2+3);var de=0,B=!0,se=!0,fe=!1;if(!L.reduced_still_picture_header){if($.readBool())return P;B=(de=$.readBits(2))===2||de===0,(se=$.readBool())&&L.decoder_model_info_present_flag&&L.equal_picture_interval,se&&$.readBool(),fe=!!(de===3||de===0&&se)||$.readBool()}P.keyframe=B,$.readBool();var he=L.seq_force_screen_content_tools;L.seq_force_screen_content_tools===2&&(he=$.readBits(1)),he&&(L.seq_force_integer_mv,L.seq_force_integer_mv==2&&$.readBits(1)),L.frame_id_numbers_present_flag&&$.readBits(J);var pe=!1;if(pe=de==3||!L.reduced_still_picture_header&&$.readBool(),$.readBits(L.order_hint_bits),B||fe||$.readBits(3),L.decoder_model_info_present_flag&&$.readBool()){for(var Ue=0;Ue<=L.operating_points_cnt_minus_1;Ue++)if(L.operating_points[Ue].decoder_model_present_for_this_op[Ue]){var Ge=L.operating_points[Ue].operating_point_idc;(Ge===0||Ge>>j&1&&Ge>>_+8&1)&&$.readBits(L.buffer_removal_time_length_minus_1+1)}}var re=255;if(de===3||de==0&&se||(re=$.readBits(8)),(B||re!==255)&&fe&&L.enable_order_hint)for(var Le=0;Le<8;Le++)$.readBits(L.order_hint_bits);if(B){var Je=M.frameSizeAndRenderSize($,pe,L);P.codec_size={width:Je.FrameWidth,height:Je.FrameHeight},P.present_size={width:Je.RenderWidth,height:Je.RenderHeight},P.sar_ratio={width:Je.RenderWidth/Je.FrameWidth,height:Je.RenderHeight/Je.FrameHeight}}return $.destroy(),$=null,P},M.frameSizeAndRenderSize=function(C,j,_){var P=_.max_frame_width,L=_.max_frame_height;j&&(P=C.readBits(_.frame_width_bit)+1,L=C.readBits(_.frame_height_bit)+1);var $=!1;_.enable_superres&&($=C.readBool());var J=8;$&&(J=C.readBits(3)+9);var de=P;P=Math.floor((8*de+J/2)/J);var B=de,se=L;if(C.readBool()){var fe=C.readBits(16)+1,he=C.readBits(16)+1;B=C.readBits(fe)+1,se=C.readBits(he)+1}return{UpscaledWidth:de,FrameWidth:P,FrameHeight:L,RenderWidth:B,RenderHeight:se}},M.getLevelString=function(C,j){return"".concat(C.toString(10).padStart(2,"0")).concat(j===0?"M":"H")},M.getChromaFormat=function(C,j,_){return C?0:j===0&&_===0?3:j===1&&_===0?2:j===1&&_===1?1:Number.NaN},M.getChromaFormatString=function(C,j,_){return C?"4:0:0":j===0&&_===0?"4:4:4":j===1&&_===0?"4:2:2":j===1&&_===1?"4:2:0":"Unknown"},M})(),I,F=(function(){function M(C,j){this.TAG="FLVDemuxer",this._config=j,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=C.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=C.hasAudioTrack,this._hasVideo=C.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new u.a,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=(function(){var _=new ArrayBuffer(2);return new DataView(_).setInt16(0,256,!0),new Int16Array(_)[0]===256})()}return M.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},M.probe=function(C){var j=new Uint8Array(C);if(j.byteLength<9)return{needMoreData:!0};var _={match:!1};if(j[0]!==70||j[1]!==76||j[2]!==86||j[3]!==1)return _;var P,L,$=(4&j[4])>>>2!=0,J=(1&j[4])!=0,de=(P=j)[L=5]<<24|P[L+1]<<16|P[L+2]<<8|P[L+3];return de<9?_:{match:!0,consumed:de,dataOffset:de,hasAudioTrack:$,hasVideoTrack:J}},M.prototype.bindDataSource=function(C){return C.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(M.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(C){this._onTrackMetadata=C},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(C){this._onMediaInfo=C},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(C){this._onMetaDataArrived=C},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(C){this._onScriptDataArrived=C},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"onError",{get:function(){return this._onError},set:function(C){this._onError=C},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(C){this._onDataAvailable=C},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(C){this._timestampBase=C},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"overridedDuration",{get:function(){return this._duration},set:function(C){this._durationOverrided=!0,this._duration=C,this._mediaInfo.duration=C},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"overridedHasAudio",{set:function(C){this._hasAudioFlagOverrided=!0,this._hasAudio=C,this._mediaInfo.hasAudio=C},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"overridedHasVideo",{set:function(C){this._hasVideoFlagOverrided=!0,this._hasVideo=C,this._mediaInfo.hasVideo=C},enumerable:!1,configurable:!0}),M.prototype.resetMediaInfo=function(){this._mediaInfo=new u.a},M.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!(this._hasAudio||!this._hasVideo)&&this._videoInitialMetadataDispatched},M.prototype.parseChunks=function(C,j){if(!(this._onError&&this._onMediaInfo&&this._onTrackMetadata&&this._onDataAvailable))throw new b.a("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var _=0,P=this._littleEndian;if(j===0){if(!(C.byteLength>13))return 0;_=M.probe(C).dataOffset}for(this._firstParse&&(this._firstParse=!1,j+_!==this._dataOffset&&d.a.w(this.TAG,"First time parsing but chunk byteStart invalid!"),(L=new DataView(C,_)).getUint32(0,!P)!==0&&d.a.w(this.TAG,"PrevTagSize0 !== 0 !!!"),_+=4);_<C.byteLength;){this._dispatch=!0;var L=new DataView(C,_);if(_+11+4>C.byteLength)break;var $=L.getUint8(0),J=16777215&L.getUint32(0,!P);if(_+11+J+4>C.byteLength)break;if($===8||$===9||$===18){var de=L.getUint8(4),B=L.getUint8(5),se=L.getUint8(6)|B<<8|de<<16|L.getUint8(7)<<24;(16777215&L.getUint32(7,!P))!==0&&d.a.w(this.TAG,"Meet tag which has StreamID != 0!");var fe=_+11;switch($){case 8:this._parseAudioData(C,fe,J,se);break;case 9:this._parseVideoData(C,fe,J,se,j+_);break;case 18:this._parseScriptData(C,fe,J)}var he=L.getUint32(11+J,!P);he!==11+J&&d.a.w(this.TAG,"Invalid PrevTagSize ".concat(he)),_+=11+J+4}else d.a.w(this.TAG,"Unsupported tag type ".concat($,", skipped")),_+=11+J+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),_},M.prototype._parseScriptData=function(C,j,_){var P=w.parseScriptData(C,j,_);if(P.hasOwnProperty("onMetaData")){if(P.onMetaData==null||typeof P.onMetaData!="object")return void d.a.w(this.TAG,"Invalid onMetaData structure!");this._metadata&&d.a.w(this.TAG,"Found another onMetaData tag!"),this._metadata=P;var L=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},L)),typeof L.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=L.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof L.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=L.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof L.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=L.audiodatarate),typeof L.videodatarate=="number"&&(this._mediaInfo.videoDataRate=L.videodatarate),typeof L.width=="number"&&(this._mediaInfo.width=L.width),typeof L.height=="number"&&(this._mediaInfo.height=L.height),typeof L.duration=="number"){if(!this._durationOverrided){var $=Math.floor(L.duration*this._timescale);this._duration=$,this._mediaInfo.duration=$}}else this._mediaInfo.duration=0;if(typeof L.framerate=="number"){var J=Math.floor(1e3*L.framerate);if(J>0){var de=J/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=de,this._referenceFrameRate.fps_num=J,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=de}}if(typeof L.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var B=L.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(B),L.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=L,d.a.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(P).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},P))},M.prototype._parseKeyframesIndex=function(C){for(var j=[],_=[],P=1;P<C.times.length;P++){var L=this._timestampBase+Math.floor(1e3*C.times[P]);j.push(L),_.push(C.filepositions[P])}return{times:j,filepositions:_}},M.prototype._parseAudioData=function(C,j,_,P){if(_<=1)d.a.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");else if(this._hasAudioFlagOverrided!==!0||this._hasAudio!==!1){this._littleEndian;var L=new DataView(C,j,_).getUint8(0),$=L>>>4;if($!==9)if($===2||$===10){var J=0,de=(12&L)>>>2;if(de>=0&&de<=4){J=this._flvSoundRateTable[de];var B=1&L,se=this._audioMetadata,fe=this._audioTrack;if(se||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(se=this._audioMetadata={}).type="audio",se.id=fe.id,se.timescale=this._timescale,se.duration=this._duration,se.audioSampleRate=J,se.channelCount=B===0?1:2),$===10){var he=this._parseAACAudioData(C,j+1,_-1);if(he==null)return;if(he.packetType===0){if(se.config){if(D(he.data.config,se.config))return;d.a.w(this.TAG,"AudioSpecificConfig has been changed, re-generate initialization segment")}var pe=he.data;se.audioSampleRate=pe.samplingRate,se.channelCount=pe.channelCount,se.codec=pe.codec,se.originalCodec=pe.originalCodec,se.config=pe.config,se.refSampleDuration=1024/se.audioSampleRate*se.timescale,d.a.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",se),(re=this._mediaInfo).audioCodec=se.originalCodec,re.audioSampleRate=se.audioSampleRate,re.audioChannelCount=se.channelCount,re.hasVideo?re.videoCodec!=null&&(re.mimeType='video/x-flv; codecs="'+re.videoCodec+","+re.audioCodec+'"'):re.mimeType='video/x-flv; codecs="'+re.audioCodec+'"',re.isComplete()&&this._onMediaInfo(re)}else if(he.packetType===1){var Ue=this._timestampBase+P,Ge={unit:he.data,length:he.data.byteLength,dts:Ue,pts:Ue};fe.samples.push(Ge),fe.length+=he.data.length}else d.a.e(this.TAG,"Flv: Unsupported AAC data type ".concat(he.packetType))}else if($===2){if(!se.codec){var re;if((pe=this._parseMP3AudioData(C,j+1,_-1,!0))==null)return;se.audioSampleRate=pe.samplingRate,se.channelCount=pe.channelCount,se.codec=pe.codec,se.originalCodec=pe.originalCodec,se.refSampleDuration=1152/se.audioSampleRate*se.timescale,d.a.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",se),(re=this._mediaInfo).audioCodec=se.codec,re.audioSampleRate=se.audioSampleRate,re.audioChannelCount=se.channelCount,re.audioDataRate=pe.bitRate,re.hasVideo?re.videoCodec!=null&&(re.mimeType='video/x-flv; codecs="'+re.videoCodec+","+re.audioCodec+'"'):re.mimeType='video/x-flv; codecs="'+re.audioCodec+'"',re.isComplete()&&this._onMediaInfo(re)}var Le=this._parseMP3AudioData(C,j+1,_-1,!1);if(Le==null)return;Ue=this._timestampBase+P;var Je={unit:Le,length:Le.byteLength,dts:Ue,pts:Ue};fe.samples.push(Je),fe.length+=Le.length}}else this._onError(k.a.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+de)}else this._onError(k.a.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+$);else{if(_<=5)return void d.a.w(this.TAG,"Flv: Invalid audio packet, missing AudioFourCC in Ehnanced FLV payload!");var it=15&L,Et=String.fromCharCode.apply(String,new Uint8Array(C,j,_).slice(1,5));switch(Et){case"Opus":this._parseOpusAudioPacket(C,j+5,_-5,P,it);break;case"fLaC":this._parseFlacAudioPacket(C,j+5,_-5,P,it);break;default:this._onError(k.a.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec: "+Et)}}}},M.prototype._parseAACAudioData=function(C,j,_){if(!(_<=1)){var P={},L=new Uint8Array(C,j,_);return P.packetType=L[0],L[0]===0?P.data=this._parseAACAudioSpecificConfig(C,j+1,_-1):P.data=L.subarray(1),P}d.a.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!")},M.prototype._parseAACAudioSpecificConfig=function(C,j,_){var P,L,$=new Uint8Array(C,j,_),J=null,de=0,B=null;if(de=P=$[0]>>>3,(L=(7&$[0])<<1|$[1]>>>7)<0||L>=this._mpegSamplingRates.length)this._onError(k.a.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");else{var se=this._mpegSamplingRates[L],fe=(120&$[1])>>>3;if(!(fe<0||fe>=8)){de===5&&(B=(7&$[1])<<1|$[2]>>>7,(124&$[2])>>>2);var he=self.navigator.userAgent.toLowerCase();return he.indexOf("firefox")!==-1?L>=6?(de=5,J=new Array(4),B=L-3):(de=2,J=new Array(2),B=L):he.indexOf("android")!==-1?(de=2,J=new Array(2),B=L):(de=5,B=L,J=new Array(4),L>=6?B=L-3:fe===1&&(de=2,J=new Array(2),B=L)),J[0]=de<<3,J[0]|=(15&L)>>>1,J[1]=(15&L)<<7,J[1]|=(15&fe)<<3,de===5&&(J[1]|=(15&B)>>>1,J[2]=(1&B)<<7,J[2]|=8,J[3]=0),{config:J,samplingRate:se,channelCount:fe,codec:"mp4a.40."+de,originalCodec:"mp4a.40."+P}}this._onError(k.a.FORMAT_ERROR,"Flv: AAC invalid channel configuration")}},M.prototype._parseMP3AudioData=function(C,j,_,P){if(!(_<4)){this._littleEndian;var L=new Uint8Array(C,j,_),$=null;if(P){if(L[0]!==255)return;var J=L[1]>>>3&3,de=(6&L[1])>>1,B=(240&L[2])>>>4,se=(12&L[2])>>>2,fe=(L[3]>>>6&3)!==3?2:1,he=0,pe=0;switch(J){case 0:he=this._mpegAudioV25SampleRateTable[se];break;case 2:he=this._mpegAudioV20SampleRateTable[se];break;case 3:he=this._mpegAudioV10SampleRateTable[se]}switch(de){case 1:B<this._mpegAudioL3BitRateTable.length&&(pe=this._mpegAudioL3BitRateTable[B]);break;case 2:B<this._mpegAudioL2BitRateTable.length&&(pe=this._mpegAudioL2BitRateTable[B]);break;case 3:B<this._mpegAudioL1BitRateTable.length&&(pe=this._mpegAudioL1BitRateTable[B])}$={bitRate:pe,samplingRate:he,channelCount:fe,codec:"mp3",originalCodec:"mp3"}}else $=L;return $}d.a.w(this.TAG,"Flv: Invalid MP3 packet, header missing!")},M.prototype._parseOpusAudioPacket=function(C,j,_,P,L){if(L===0)this._parseOpusSequenceHeader(C,j,_);else if(L===1)this._parseOpusAudioData(C,j,_,P);else if(L!==2)return void this._onError(k.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(L))},M.prototype._parseOpusSequenceHeader=function(C,j,_){if(_<=16)d.a.w(this.TAG,"Flv: Invalid OpusSequenceHeader, lack of data!");else{var P=this._audioMetadata,L=this._audioTrack;P||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(P=this._audioMetadata={}).type="audio",P.id=L.id,P.timescale=this._timescale,P.duration=this._duration);var $=new DataView(C,j,_);$.setUint8(8,0);var J=$.getUint8(9);$.setUint16(10,$.getUint16(10,!0),!1);var de=$.getUint32(12,!0);$.setUint32(12,$.getUint32(12,!0),!1);var B={config:new Uint8Array(C,j+8,_-8),channelCount:J,samplingFrequence:de,codec:"opus",originalCodec:"opus"};if(P.config){if(D(B.config,P.config))return;d.a.w(this.TAG,"OpusSequenceHeader has been changed, re-generate initialization segment")}P.audioSampleRate=B.samplingFrequence,P.channelCount=B.channelCount,P.codec=B.codec,P.originalCodec=B.originalCodec,P.config=B.config,P.refSampleDuration=20,d.a.v(this.TAG,"Parsed OpusSequenceHeader"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",P);var se=this._mediaInfo;se.audioCodec=P.originalCodec,se.audioSampleRate=P.audioSampleRate,se.audioChannelCount=P.channelCount,se.hasVideo?se.videoCodec!=null&&(se.mimeType='video/x-flv; codecs="'+se.videoCodec+","+se.audioCodec+'"'):se.mimeType='video/x-flv; codecs="'+se.audioCodec+'"',se.isComplete()&&this._onMediaInfo(se)}},M.prototype._parseOpusAudioData=function(C,j,_,P){var L=this._audioTrack,$=new Uint8Array(C,j,_),J=this._timestampBase+P,de={unit:$,length:$.byteLength,dts:J,pts:J};L.samples.push(de),L.length+=$.length},M.prototype._parseFlacAudioPacket=function(C,j,_,P,L){if(L===0)this._parseFlacSequenceHeader(C,j,_);else if(L===1)this._parseFlacAudioData(C,j,_,P);else if(L!==2)return void this._onError(k.a.FORMAT_ERROR,"Flv: Invalid Flac audio packet type ".concat(L))},M.prototype._parseFlacSequenceHeader=function(C,j,_){var P=this._audioMetadata,L=this._audioTrack;P||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(P=this._audioMetadata={}).type="audio",P.id=L.id,P.timescale=this._timescale,P.duration=this._duration);var $=new Uint8Array(C,j+4,_-4),J=new S($),de=J.readBits(16),B=J.readBits(16),se=B===de?B:null;J.readBits(24),J.readBits(24);var fe=J.readBits(20),he=J.readBits(3)+1,pe=J.readBits(5)+1;J.destroy();var Ue=new Uint8Array($.byteLength+4);Ue.set($,4),Ue[0]=128,Ue[1]=$.byteLength>>>16&255,Ue[2]=$.byteLength>>>8&255,Ue[3]=$.byteLength>>>0&255;var Ge={config:Ue,channelCount:he,samplingFrequence:fe,sampleSize:pe,codec:"flac",originalCodec:"flac"};if(P.config){if(D(Ge.config,P.config))return;d.a.w(this.TAG,"FlacSequenceHeader has been changed, re-generate initialization segment")}P.audioSampleRate=Ge.samplingFrequence,P.channelCount=Ge.channelCount,P.sampleSize=Ge.sampleSize,P.codec=Ge.codec,P.originalCodec=Ge.originalCodec,P.config=Ge.config,P.refSampleDuration=se!=null?1e3*se/Ge.samplingFrequence:null,d.a.v(this.TAG,"Parsed FlacSequenceHeader"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",P);var re=this._mediaInfo;re.audioCodec=P.originalCodec,re.audioSampleRate=P.audioSampleRate,re.audioChannelCount=P.channelCount,re.hasVideo?re.videoCodec!=null&&(re.mimeType='video/x-flv; codecs="'+re.videoCodec+","+re.audioCodec+'"'):re.mimeType='video/x-flv; codecs="'+re.audioCodec+'"',re.isComplete()&&this._onMediaInfo(re)},M.prototype._parseFlacAudioData=function(C,j,_,P){var L=this._audioTrack,$=new Uint8Array(C,j,_),J=this._timestampBase+P,de={unit:$,length:$.byteLength,dts:J,pts:J};L.samples.push(de),L.length+=$.length},M.prototype._parseVideoData=function(C,j,_,P,L){if(_<=1)d.a.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");else if(this._hasVideoFlagOverrided!==!0||this._hasVideo!==!1){var $=new Uint8Array(C,j,_)[0],J=(112&$)>>>4;if((128&$)!=0){var de=15&$,B=String.fromCharCode.apply(String,new Uint8Array(C,j,_).slice(1,5));if(B==="hvc1")this._parseEnhancedHEVCVideoPacket(C,j+5,_-5,P,L,J,de);else{if(B!=="av01")return void this._onError(k.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: ".concat(B));this._parseEnhancedAV1VideoPacket(C,j+5,_-5,P,L,J,de)}}else{var se=15&$;if(se===7)this._parseAVCVideoPacket(C,j+1,_-1,P,L,J);else{if(se!==12)return void this._onError(k.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: ".concat(se));this._parseHEVCVideoPacket(C,j+1,_-1,P,L,J)}}}},M.prototype._parseAVCVideoPacket=function(C,j,_,P,L,$){if(_<4)d.a.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");else{var J=this._littleEndian,de=new DataView(C,j,_),B=de.getUint8(0),se=(16777215&de.getUint32(0,!J))<<8>>8;if(B===0)this._parseAVCDecoderConfigurationRecord(C,j+4,_-4);else if(B===1)this._parseAVCVideoData(C,j+4,_-4,P,L,$,se);else if(B!==2)return void this._onError(k.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(B))}},M.prototype._parseHEVCVideoPacket=function(C,j,_,P,L,$){if(_<4)d.a.w(this.TAG,"Flv: Invalid HEVC packet, missing HEVCPacketType or/and CompositionTime");else{var J=this._littleEndian,de=new DataView(C,j,_),B=de.getUint8(0),se=(16777215&de.getUint32(0,!J))<<8>>8;if(B===0)this._parseHEVCDecoderConfigurationRecord(C,j+4,_-4);else if(B===1)this._parseHEVCVideoData(C,j+4,_-4,P,L,$,se);else if(B!==2)return void this._onError(k.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(B))}},M.prototype._parseEnhancedHEVCVideoPacket=function(C,j,_,P,L,$,J){var de=this._littleEndian,B=new DataView(C,j,_);if(J===0)this._parseHEVCDecoderConfigurationRecord(C,j,_);else if(J===1){var se=(4294967040&B.getUint32(0,!de))>>8;this._parseHEVCVideoData(C,j+3,_-3,P,L,$,se)}else if(J===3)this._parseHEVCVideoData(C,j,_,P,L,$,0);else if(J!==2)return void this._onError(k.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(J))},M.prototype._parseEnhancedAV1VideoPacket=function(C,j,_,P,L,$,J){if(this._littleEndian,J===0)this._parseAV1CodecConfigurationRecord(C,j,_);else if(J===1)this._parseAV1VideoData(C,j,_,P,L,$,0);else{if(J===5)return void this._onError(k.a.FORMAT_ERROR,"Flv: Not Supported MP2T AV1 video packet type ".concat(J));if(J!==2)return void this._onError(k.a.FORMAT_ERROR,"Flv: Invalid video packet type ".concat(J))}},M.prototype._parseAVCDecoderConfigurationRecord=function(C,j,_){if(_<7)d.a.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");else{var P=this._videoMetadata,L=this._videoTrack,$=this._littleEndian,J=new DataView(C,j,_);if(P){if(P.avcc!==void 0){var de=new Uint8Array(C,j,_);if(D(de,P.avcc))return;d.a.w(this.TAG,"AVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(P=this._videoMetadata={}).type="video",P.id=L.id,P.timescale=this._timescale,P.duration=this._duration;var B=J.getUint8(0),se=J.getUint8(1);if(J.getUint8(2),J.getUint8(3),B===1&&se!==0)if(this._naluLengthSize=1+(3&J.getUint8(4)),this._naluLengthSize===3||this._naluLengthSize===4){var fe=31&J.getUint8(5);if(fe!==0){fe>1&&d.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = ".concat(fe));for(var he=6,pe=0;pe<fe;pe++){var Ue=J.getUint16(he,!$);if(he+=2,Ue!==0){var Ge=new Uint8Array(C,j+he,Ue);he+=Ue;var re=T.parseSPS(Ge);if(pe===0){P.codecWidth=re.codec_size.width,P.codecHeight=re.codec_size.height,P.presentWidth=re.present_size.width,P.presentHeight=re.present_size.height,P.profile=re.profile_string,P.level=re.level_string,P.bitDepth=re.bit_depth,P.chromaFormat=re.chroma_format,P.sarRatio=re.sar_ratio,P.frameRate=re.frame_rate,re.frame_rate.fixed!==!1&&re.frame_rate.fps_num!==0&&re.frame_rate.fps_den!==0||(P.frameRate=this._referenceFrameRate);var Le=P.frameRate.fps_den,Je=P.frameRate.fps_num;P.refSampleDuration=P.timescale*(Le/Je);for(var it=Ge.subarray(1,4),Et="avc1.",Ht=0;Ht<3;Ht++){var _t=it[Ht].toString(16);_t.length<2&&(_t="0"+_t),Et+=_t}P.codec=Et;var Pt=this._mediaInfo;Pt.width=P.codecWidth,Pt.height=P.codecHeight,Pt.fps=P.frameRate.fps,Pt.profile=P.profile,Pt.level=P.level,Pt.refFrames=re.ref_frames,Pt.chromaFormat=re.chroma_format_string,Pt.sarNum=P.sarRatio.width,Pt.sarDen=P.sarRatio.height,Pt.videoCodec=Et,Pt.hasAudio?Pt.audioCodec!=null&&(Pt.mimeType='video/x-flv; codecs="'+Pt.videoCodec+","+Pt.audioCodec+'"'):Pt.mimeType='video/x-flv; codecs="'+Pt.videoCodec+'"',Pt.isComplete()&&this._onMediaInfo(Pt)}}}var Wt=J.getUint8(he);if(Wt!==0){for(Wt>1&&d.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = ".concat(Wt)),he++,pe=0;pe<Wt;pe++)Ue=J.getUint16(he,!$),he+=2,Ue!==0&&(he+=Ue);P.avcc=new Uint8Array(_),P.avcc.set(new Uint8Array(C,j,_),0),d.a.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",P)}else this._onError(k.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS")}else this._onError(k.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS")}else this._onError(k.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: ".concat(this._naluLengthSize-1));else this._onError(k.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord")}},M.prototype._parseHEVCDecoderConfigurationRecord=function(C,j,_){if(_<22)d.a.w(this.TAG,"Flv: Invalid HEVCDecoderConfigurationRecord, lack of data!");else{var P=this._videoMetadata,L=this._videoTrack,$=this._littleEndian,J=new DataView(C,j,_);if(P){if(P.hvcc!==void 0){var de=new Uint8Array(C,j,_);if(D(de,P.hvcc))return;d.a.w(this.TAG,"HEVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(P=this._videoMetadata={}).type="video",P.id=L.id,P.timescale=this._timescale,P.duration=this._duration;var B=J.getUint8(0),se=31&J.getUint8(1);if(B!==0&&B!==1||se===0)this._onError(k.a.FORMAT_ERROR,"Flv: Invalid HEVCDecoderConfigurationRecord");else if(this._naluLengthSize=1+(3&J.getUint8(21)),this._naluLengthSize===3||this._naluLengthSize===4){for(var fe=J.getUint8(22),he=0,pe=23;he<fe;he++){var Ue=63&J.getUint8(pe+0),Ge=J.getUint16(pe+1,!$);pe+=3;for(var re=0;re<Ge;re++){var Le=J.getUint16(pe+0,!$);if(re===0)if(Ue===33){pe+=2;var Je=new Uint8Array(C,j+pe,Le),it=E.parseSPS(Je);P.codecWidth=it.codec_size.width,P.codecHeight=it.codec_size.height,P.presentWidth=it.present_size.width,P.presentHeight=it.present_size.height,P.profile=it.profile_string,P.level=it.level_string,P.bitDepth=it.bit_depth,P.chromaFormat=it.chroma_format,P.sarRatio=it.sar_ratio,P.frameRate=it.frame_rate,it.frame_rate.fixed!==!1&&it.frame_rate.fps_num!==0&&it.frame_rate.fps_den!==0||(P.frameRate=this._referenceFrameRate);var Et=P.frameRate.fps_den,Ht=P.frameRate.fps_num;P.refSampleDuration=P.timescale*(Et/Ht),P.codec=it.codec_mimetype;var _t=this._mediaInfo;_t.width=P.codecWidth,_t.height=P.codecHeight,_t.fps=P.frameRate.fps,_t.profile=P.profile,_t.level=P.level,_t.refFrames=it.ref_frames,_t.chromaFormat=it.chroma_format_string,_t.sarNum=P.sarRatio.width,_t.sarDen=P.sarRatio.height,_t.videoCodec=it.codec_mimetype,_t.hasAudio?_t.audioCodec!=null&&(_t.mimeType='video/x-flv; codecs="'+_t.videoCodec+","+_t.audioCodec+'"'):_t.mimeType='video/x-flv; codecs="'+_t.videoCodec+'"',_t.isComplete()&&this._onMediaInfo(_t),pe+=Le}else pe+=2+Le;else pe+=2+Le}}P.hvcc=new Uint8Array(_),P.hvcc.set(new Uint8Array(C,j,_),0),d.a.v(this.TAG,"Parsed HEVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",P)}else this._onError(k.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: ".concat(this._naluLengthSize-1))}},M.prototype._parseAV1CodecConfigurationRecord=function(C,j,_){if(_<4)d.a.w(this.TAG,"Flv: Invalid AV1CodecConfigurationRecord, lack of data!");else{var P=this._videoMetadata,L=this._videoTrack,$=(this._littleEndian,new DataView(C,j,_));P?P.av1c!==void 0&&d.a.w(this.TAG,"Found another AV1CodecConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(P=this._videoMetadata={}).type="video",P.id=L.id,P.timescale=this._timescale,P.duration=this._duration);var J=127&$.getUint8(0);if($.getUint8(1),$.getUint8(1),$.getUint8(2),J===1){var de=U.parseOBUs(new Uint8Array(C,j+4,_-4));if(de!=null){P.profile=de.profile_string,P.level=de.level_string,P.bitDepth=de.bit_depth,P.chromaFormat=de.chroma_format,P.frameRate=de.frame_rate,de.frame_rate.fixed!==!1&&de.frame_rate.fps_num!==0&&de.frame_rate.fps_den!==0||(P.frameRate=this._referenceFrameRate);var B=P.frameRate.fps_den,se=P.frameRate.fps_num;P.refSampleDuration=P.timescale*(B/se),P.codec=de.codec_mimetype,P.extra=de;var fe=this._mediaInfo;fe.fps=P.frameRate.fps,fe.profile=P.profile,fe.level=P.level,fe.refFrames=de.ref_frames,fe.chromaFormat=de.chroma_format_string,fe.videoCodec=de.codec_mimetype,fe.hasAudio?fe.audioCodec!=null&&(fe.mimeType='video/x-flv; codecs="'+fe.videoCodec+","+fe.audioCodec+'"'):fe.mimeType='video/x-flv; codecs="'+fe.videoCodec+'"',fe.isComplete()&&this._onMediaInfo(fe),P.av1c=new Uint8Array(_),P.av1c.set(new Uint8Array(C,j,_),0),d.a.v(this.TAG,"Preparing AV1CodecConfigurationRecord")}else this._onError(k.a.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord")}else this._onError(k.a.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord")}},M.prototype._parseAVCVideoData=function(C,j,_,P,L,$,J){for(var de=this._littleEndian,B=new DataView(C,j,_),se=[],fe=0,he=0,pe=this._naluLengthSize,Ue=this._timestampBase+P,Ge=$===1;he<_;){if(he+4>=_){d.a.w(this.TAG,"Malformed Nalu near timestamp ".concat(Ue,", offset = ").concat(he,", dataSize = ").concat(_));break}var re=B.getUint32(he,!de);if(pe===3&&(re>>>=8),re>_-pe)return void d.a.w(this.TAG,"Malformed Nalus near timestamp ".concat(Ue,", NaluSize > DataSize!"));var Le=31&B.getUint8(he+pe);Le===5&&(Ge=!0);var Je=new Uint8Array(C,j+he,pe+re),it={type:Le,data:Je};se.push(it),fe+=Je.byteLength,he+=pe+re}if(se.length){var Et=this._videoTrack,Ht={units:se,length:fe,isKeyframe:Ge,dts:Ue,cts:J,pts:Ue+J};Ge&&(Ht.fileposition=L),Et.samples.push(Ht),Et.length+=fe}},M.prototype._parseHEVCVideoData=function(C,j,_,P,L,$,J){for(var de=this._littleEndian,B=new DataView(C,j,_),se=[],fe=0,he=0,pe=this._naluLengthSize,Ue=this._timestampBase+P,Ge=$===1;he<_;){if(he+4>=_){d.a.w(this.TAG,"Malformed Nalu near timestamp ".concat(Ue,", offset = ").concat(he,", dataSize = ").concat(_));break}var re=B.getUint32(he,!de);if(pe===3&&(re>>>=8),re>_-pe)return void d.a.w(this.TAG,"Malformed Nalus near timestamp ".concat(Ue,", NaluSize > DataSize!"));var Le=B.getUint8(he+pe)>>1&63;Le!==19&&Le!==20&&Le!==21||(Ge=!0);var Je=new Uint8Array(C,j+he,pe+re),it={type:Le,data:Je};se.push(it),fe+=Je.byteLength,he+=pe+re}if(se.length){var Et=this._videoTrack,Ht={units:se,length:fe,isKeyframe:Ge,dts:Ue,cts:J,pts:Ue+J};Ge&&(Ht.fileposition=L),Et.samples.push(Ht),Et.length+=fe}},M.prototype._parseAV1VideoData=function(C,j,_,P,L,$,J){this._littleEndian;var de,B=[],se=this._timestampBase+P,fe=$===1;if(fe){var he=this._videoMetadata,pe=U.parseOBUs(new Uint8Array(C,j,_),he.extra);if(pe==null)return void this._onError(k.a.FORMAT_ERROR,"Flv: Invalid AV1 VideoData");console.log(pe),he.codecWidth=pe.codec_size.width,he.codecHeight=pe.codec_size.height,he.presentWidth=pe.present_size.width,he.presentHeight=pe.present_size.height,he.sarRatio=pe.sar_ratio;var Ue=this._mediaInfo;Ue.width=he.codecWidth,Ue.height=he.codecHeight,Ue.sarNum=he.sarRatio.width,Ue.sarDen=he.sarRatio.height,d.a.v(this.TAG,"Parsed AV1DecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",he)}if(de=_,B.push({unitType:0,data:new Uint8Array(C,j+0,_)}),B.length){var Ge=this._videoTrack,re={units:B,length:de,isKeyframe:fe,dts:se,cts:J,pts:se+J};fe&&(re.fileposition=L),Ge.samples.push(re),Ge.length+=de}},M})(),te=(function(){function M(){}return M.prototype.destroy=function(){this.onError=null,this.onMediaInfo=null,this.onMetaDataArrived=null,this.onTrackMetadata=null,this.onDataAvailable=null,this.onTimedID3Metadata=null,this.onSynchronousKLVMetadata=null,this.onAsynchronousKLVMetadata=null,this.onSMPTE2038Metadata=null,this.onSCTE35Metadata=null,this.onPESPrivateData=null,this.onPESPrivateDataDescriptor=null},M})(),le=function(){this.program_pmt_pid={}};(function(M){M[M.kMPEG1Audio=3]="kMPEG1Audio",M[M.kMPEG2Audio=4]="kMPEG2Audio",M[M.kPESPrivateData=6]="kPESPrivateData",M[M.kADTSAAC=15]="kADTSAAC",M[M.kLOASAAC=17]="kLOASAAC",M[M.kAC3=129]="kAC3",M[M.kEAC3=135]="kEAC3",M[M.kMetadata=21]="kMetadata",M[M.kSCTE35=134]="kSCTE35",M[M.kH264=27]="kH264",M[M.kH265=36]="kH265"})(I||(I={}));var H,X=function(){this.pid_stream_type={},this.common_pids={h264:void 0,h265:void 0,av1:void 0,adts_aac:void 0,loas_aac:void 0,opus:void 0,ac3:void 0,eac3:void 0,mp3:void 0},this.pes_private_data_pids={},this.timed_id3_pids={},this.synchronous_klv_pids={},this.asynchronous_klv_pids={},this.scte_35_pids={},this.smpte2038_pids={}},q=function(){},ae=function(){},ce=function(){this.slices=[],this.total_length=0,this.expected_length=0,this.file_position=0};(function(M){M[M.kUnspecified=0]="kUnspecified",M[M.kSliceNonIDR=1]="kSliceNonIDR",M[M.kSliceDPA=2]="kSliceDPA",M[M.kSliceDPB=3]="kSliceDPB",M[M.kSliceDPC=4]="kSliceDPC",M[M.kSliceIDR=5]="kSliceIDR",M[M.kSliceSEI=6]="kSliceSEI",M[M.kSliceSPS=7]="kSliceSPS",M[M.kSlicePPS=8]="kSlicePPS",M[M.kSliceAUD=9]="kSliceAUD",M[M.kEndOfSequence=10]="kEndOfSequence",M[M.kEndOfStream=11]="kEndOfStream",M[M.kFiller=12]="kFiller",M[M.kSPSExt=13]="kSPSExt",M[M.kReserved0=14]="kReserved0"})(H||(H={}));var ee,W,V=function(){},G=function(M){var C=M.data.byteLength;this.type=M.type,this.data=new Uint8Array(4+C),new DataView(this.data.buffer).setUint32(0,C),this.data.set(M.data,4)},Z=(function(){function M(C){this.TAG="H264AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=C,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&d.a.e(this.TAG,"Could not find H264 startcode until payload end!")}return M.prototype.findNextStartCodeOffset=function(C){for(var j=C,_=this.data_;;){if(j+3>=_.byteLength)return this.eof_flag_=!0,_.byteLength;var P=_[j+0]<<24|_[j+1]<<16|_[j+2]<<8|_[j+3],L=_[j+0]<<16|_[j+1]<<8|_[j+2];if(P===1||L===1)return j;j++}},M.prototype.readNextNaluPayload=function(){for(var C=this.data_,j=null;j==null&&!this.eof_flag_;){var _=this.current_startcode_offset_,P=31&C[_+=(C[_]<<24|C[_+1]<<16|C[_+2]<<8|C[_+3])===1?4:3],L=(128&C[_])>>>7,$=this.findNextStartCodeOffset(_);if(this.current_startcode_offset_=$,!(P>=H.kReserved0)&&L===0){var J=C.subarray(_,$);(j=new V).type=P,j.data=J}}return j},M})(),oe=(function(){function M(C,j,_){var P=8+C.byteLength+1+2+j.byteLength,L=!1;C[3]!==66&&C[3]!==77&&C[3]!==88&&(L=!0,P+=4);var $=this.data=new Uint8Array(P);$[0]=1,$[1]=C[1],$[2]=C[2],$[3]=C[3],$[4]=255,$[5]=225;var J=C.byteLength;$[6]=J>>>8,$[7]=255&J;var de=8;$.set(C,8),$[de+=J]=1;var B=j.byteLength;$[de+1]=B>>>8,$[de+2]=255&B,$.set(j,de+3),de+=3+B,L&&($[de]=252|_.chroma_format_idc,$[de+1]=248|_.bit_depth_luma-8,$[de+2]=248|_.bit_depth_chroma-8,$[de+3]=0,de+=4)}return M.prototype.getData=function(){return this.data},M})();(function(M){M[M.kNull=0]="kNull",M[M.kAACMain=1]="kAACMain",M[M.kAAC_LC=2]="kAAC_LC",M[M.kAAC_SSR=3]="kAAC_SSR",M[M.kAAC_LTP=4]="kAAC_LTP",M[M.kAAC_SBR=5]="kAAC_SBR",M[M.kAAC_Scalable=6]="kAAC_Scalable",M[M.kLayer1=32]="kLayer1",M[M.kLayer2=33]="kLayer2",M[M.kLayer3=34]="kLayer3"})(ee||(ee={})),(function(M){M[M.k96000Hz=0]="k96000Hz",M[M.k88200Hz=1]="k88200Hz",M[M.k64000Hz=2]="k64000Hz",M[M.k48000Hz=3]="k48000Hz",M[M.k44100Hz=4]="k44100Hz",M[M.k32000Hz=5]="k32000Hz",M[M.k24000Hz=6]="k24000Hz",M[M.k22050Hz=7]="k22050Hz",M[M.k16000Hz=8]="k16000Hz",M[M.k12000Hz=9]="k12000Hz",M[M.k11025Hz=10]="k11025Hz",M[M.k8000Hz=11]="k8000Hz",M[M.k7350Hz=12]="k7350Hz"})(W||(W={}));var ye,je,xe=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],Ee=(ye=function(M,C){return(ye=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(j,_){j.__proto__=_}||function(j,_){for(var P in _)Object.prototype.hasOwnProperty.call(_,P)&&(j[P]=_[P])})(M,C)},function(M,C){if(typeof C!="function"&&C!==null)throw new TypeError("Class extends value "+String(C)+" is not a constructor or null");function j(){this.constructor=M}ye(M,C),M.prototype=C===null?Object.create(C):(j.prototype=C.prototype,new j)}),Pe=function(){},Re=(function(M){function C(){return M!==null&&M.apply(this,arguments)||this}return Ee(C,M),C})(Pe),Qe=(function(){function M(C){this.TAG="AACADTSParser",this.data_=C,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&d.a.e(this.TAG,"Could not found ADTS syncword until payload end")}return M.prototype.findNextSyncwordOffset=function(C){for(var j=C,_=this.data_;;){if(j+7>=_.byteLength)return this.eof_flag_=!0,_.byteLength;if((_[j+0]<<8|_[j+1])>>>4===4095)return j;j++}},M.prototype.readNextAACFrame=function(){for(var C=this.data_,j=null;j==null&&!this.eof_flag_;){var _=this.current_syncword_offset_,P=(8&C[_+1])>>>3,L=(6&C[_+1])>>>1,$=1&C[_+1],J=(192&C[_+2])>>>6,de=(60&C[_+2])>>>2,B=(1&C[_+2])<<2|(192&C[_+3])>>>6,se=(3&C[_+3])<<11|C[_+4]<<3|(224&C[_+5])>>>5;if(C[_+6],_+se>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var fe=$===1?7:9,he=se-fe;_+=fe;var pe=this.findNextSyncwordOffset(_+he);if(this.current_syncword_offset_=pe,(P===0||P===1)&&L===0){var Ue=C.subarray(_,_+he);(j=new Pe).audio_object_type=J+1,j.sampling_freq_index=de,j.sampling_frequency=xe[de],j.channel_config=B,j.data=Ue}}return j},M.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},M.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},M})(),ot=(function(){function M(C){this.TAG="AACLOASParser",this.data_=C,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&d.a.e(this.TAG,"Could not found LOAS syncword until payload end")}return M.prototype.findNextSyncwordOffset=function(C){for(var j=C,_=this.data_;;){if(j+1>=_.byteLength)return this.eof_flag_=!0,_.byteLength;if((_[j+0]<<3|_[j+1]>>>5)===695)return j;j++}},M.prototype.getLATMValue=function(C){for(var j=C.readBits(2),_=0,P=0;P<=j;P++)_<<=8,_|=C.readByte();return _},M.prototype.readNextAACFrame=function(C){for(var j=this.data_,_=null;_==null&&!this.eof_flag_;){var P=this.current_syncword_offset_,L=(31&j[P+1])<<8|j[P+2];if(P+3+L>=this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var $=new S(j.subarray(P+3,P+3+L)),J=null;if($.readBool()){if(C==null){d.a.w(this.TAG,"StreamMuxConfig Missing"),this.current_syncword_offset_=this.findNextSyncwordOffset(P+3+L),$.destroy();continue}J=C}else{var de=$.readBool();if(de&&$.readBool()){d.a.e(this.TAG,"audioMuxVersionA is Not Supported"),$.destroy();break}if(de&&this.getLATMValue($),!$.readBool()){d.a.e(this.TAG,"allStreamsSameTimeFraming zero is Not Supported"),$.destroy();break}if($.readBits(6)!==0){d.a.e(this.TAG,"more than 2 numSubFrames Not Supported"),$.destroy();break}if($.readBits(4)!==0){d.a.e(this.TAG,"more than 2 numProgram Not Supported"),$.destroy();break}if($.readBits(3)!==0){d.a.e(this.TAG,"more than 2 numLayer Not Supported"),$.destroy();break}var B=de?this.getLATMValue($):0,se=$.readBits(5);B-=5;var fe=$.readBits(4);B-=4;var he=$.readBits(4);B-=4,$.readBits(3),(B-=3)>0&&$.readBits(B);var pe=$.readBits(3);if(pe!==0){d.a.e(this.TAG,"frameLengthType = ".concat(pe,". Only frameLengthType = 0 Supported")),$.destroy();break}$.readByte();var Ue=$.readBool();if(Ue)if(de)this.getLATMValue($);else{for(var Ge=0;;){Ge<<=8;var re=$.readBool();if(Ge+=$.readByte(),!re)break}console.log(Ge)}$.readBool()&&$.readByte(),(J=new Re).audio_object_type=se,J.sampling_freq_index=fe,J.sampling_frequency=xe[J.sampling_freq_index],J.channel_config=he,J.other_data_present=Ue}for(var Le=0;;){var Je=$.readByte();if(Le+=Je,Je!==255)break}for(var it=new Uint8Array(Le),Et=0;Et<Le;Et++)it[Et]=$.readByte();(_=new Re).audio_object_type=J.audio_object_type,_.sampling_freq_index=J.sampling_freq_index,_.sampling_frequency=xe[J.sampling_freq_index],_.channel_config=J.channel_config,_.other_data_present=J.other_data_present,_.data=it,this.current_syncword_offset_=this.findNextSyncwordOffset(P+3+L)}return _},M.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},M.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},M})(),ne=function(M){var C=null,j=M.audio_object_type,_=M.audio_object_type,P=M.sampling_freq_index,L=M.channel_config,$=0,J=navigator.userAgent.toLowerCase();J.indexOf("firefox")!==-1?P>=6?(_=5,C=new Array(4),$=P-3):(_=2,C=new Array(2),$=P):J.indexOf("android")!==-1?(_=2,C=new Array(2),$=P):(_=5,$=P,C=new Array(4),P>=6?$=P-3:L===1&&(_=2,C=new Array(2),$=P)),C[0]=_<<3,C[0]|=(15&P)>>>1,C[1]=(15&P)<<7,C[1]|=(15&L)<<3,_===5&&(C[1]|=(15&$)>>>1,C[2]=(1&$)<<7,C[2]|=8,C[3]=0),this.config=C,this.sampling_rate=xe[P],this.channel_count=L,this.codec_mimetype="mp4a.40."+_,this.original_codec_mimetype="mp4a.40."+j},ke=function(){},Be=function(){};(function(M){M[M.kSpliceNull=0]="kSpliceNull",M[M.kSpliceSchedule=4]="kSpliceSchedule",M[M.kSpliceInsert=5]="kSpliceInsert",M[M.kTimeSignal=6]="kTimeSignal",M[M.kBandwidthReservation=7]="kBandwidthReservation",M[M.kPrivateCommand=255]="kPrivateCommand"})(je||(je={}));var qe,dt=function(M){var C=M.readBool();return C?(M.readBits(6),{time_specified_flag:C,pts_time:4*M.readBits(31)+M.readBits(2)}):(M.readBits(7),{time_specified_flag:C})},He=function(M){var C=M.readBool();return M.readBits(6),{auto_return:C,duration:4*M.readBits(31)+M.readBits(2)}},Ce=function(M,C){var j=C.readBits(8);return M?{component_tag:j}:{component_tag:j,splice_time:dt(C)}},_e=function(M){return{component_tag:M.readBits(8),utc_splice_time:M.readBits(32)}},ge=function(M){var C=M.readBits(32),j=M.readBool();M.readBits(7);var _={splice_event_id:C,splice_event_cancel_indicator:j};if(j)return _;if(_.out_of_network_indicator=M.readBool(),_.program_splice_flag=M.readBool(),_.duration_flag=M.readBool(),M.readBits(5),_.program_splice_flag)_.utc_splice_time=M.readBits(32);else{_.component_count=M.readBits(8),_.components=[];for(var P=0;P<_.component_count;P++)_.components.push(_e(M))}return _.duration_flag&&(_.break_duration=He(M)),_.unique_program_id=M.readBits(16),_.avail_num=M.readBits(8),_.avails_expected=M.readBits(8),_},Ze=function(M,C,j,_){return{descriptor_tag:M,descriptor_length:C,identifier:j,provider_avail_id:_.readBits(32)}},Me=function(M,C,j,_){var P=_.readBits(8),L=_.readBits(3);_.readBits(5);for(var $="",J=0;J<L;J++)$+=String.fromCharCode(_.readBits(8));return{descriptor_tag:M,descriptor_length:C,identifier:j,preroll:P,dtmf_count:L,DTMF_char:$}},nt=function(M){var C=M.readBits(8);return M.readBits(7),{component_tag:C,pts_offset:4*M.readBits(31)+M.readBits(2)}},ht=function(M,C,j,_){var P=_.readBits(32),L=_.readBool();_.readBits(7);var $={descriptor_tag:M,descriptor_length:C,identifier:j,segmentation_event_id:P,segmentation_event_cancel_indicator:L};if(L)return $;if($.program_segmentation_flag=_.readBool(),$.segmentation_duration_flag=_.readBool(),$.delivery_not_restricted_flag=_.readBool(),$.delivery_not_restricted_flag?_.readBits(5):($.web_delivery_allowed_flag=_.readBool(),$.no_regional_blackout_flag=_.readBool(),$.archive_allowed_flag=_.readBool(),$.device_restrictions=_.readBits(2)),!$.program_segmentation_flag){$.component_count=_.readBits(8),$.components=[];for(var J=0;J<$.component_count;J++)$.components.push(nt(_))}$.segmentation_duration_flag&&($.segmentation_duration=_.readBits(40)),$.segmentation_upid_type=_.readBits(8),$.segmentation_upid_length=_.readBits(8);var de=new Uint8Array($.segmentation_upid_length);for(J=0;J<$.segmentation_upid_length;J++)de[J]=_.readBits(8);return $.segmentation_upid=de.buffer,$.segmentation_type_id=_.readBits(8),$.segment_num=_.readBits(8),$.segments_expected=_.readBits(8),$.segmentation_type_id!==52&&$.segmentation_type_id!==54&&$.segmentation_type_id!==56&&$.segmentation_type_id!==58||($.sub_segment_num=_.readBits(8),$.sub_segments_expected=_.readBits(8)),$},Oe=function(M,C,j,_){return{descriptor_tag:M,descriptor_length:C,identifier:j,TAI_seconds:_.readBits(48),TAI_ns:_.readBits(32),UTC_offset:_.readBits(16)}},tt=function(M){return{component_tag:M.readBits(8),ISO_code:String.fromCharCode(M.readBits(8),M.readBits(8),M.readBits(8)),Bit_Stream_Mode:M.readBits(3),Num_Channels:M.readBits(4),Full_Srvc_Audio:M.readBool()}},Ct=function(M,C,j,_){for(var P=_.readBits(4),L=[],$=0;$<P;$++)L.push(tt(_));return{descriptor_tag:M,descriptor_length:C,identifier:j,audio_count:P,components:L}},we=function(M){var C=new S(M),j=C.readBits(8),_=C.readBool(),P=C.readBool();C.readBits(2);var L=C.readBits(12),$=C.readBits(8),J=C.readBool(),de=C.readBits(6),B=4*C.readBits(31)+C.readBits(2),se=C.readBits(8),fe=C.readBits(12),he=C.readBits(12),pe=C.readBits(8),Ue=null;pe===je.kSpliceNull?Ue={}:pe===je.kSpliceSchedule?Ue=(function(It){for(var Qt=It.readBits(8),_s=[],Yt=0;Yt<Qt;Yt++)_s.push(ge(It));return{splice_count:Qt,events:_s}})(C):pe===je.kSpliceInsert?Ue=(function(It){var Qt=It.readBits(32),_s=It.readBool();It.readBits(7);var Yt={splice_event_id:Qt,splice_event_cancel_indicator:_s};if(_s)return Yt;if(Yt.out_of_network_indicator=It.readBool(),Yt.program_splice_flag=It.readBool(),Yt.duration_flag=It.readBool(),Yt.splice_immediate_flag=It.readBool(),It.readBits(4),Yt.program_splice_flag&&!Yt.splice_immediate_flag&&(Yt.splice_time=dt(It)),!Yt.program_splice_flag){Yt.component_count=It.readBits(8),Yt.components=[];for(var es=0;es<Yt.component_count;es++)Yt.components.push(Ce(Yt.splice_immediate_flag,It))}return Yt.duration_flag&&(Yt.break_duration=He(It)),Yt.unique_program_id=It.readBits(16),Yt.avail_num=It.readBits(8),Yt.avails_expected=It.readBits(8),Yt})(C):pe===je.kTimeSignal?Ue=(function(It){return{splice_time:dt(It)}})(C):pe===je.kBandwidthReservation?Ue={}:pe===je.kPrivateCommand?Ue=(function(It,Qt){for(var _s=String.fromCharCode(Qt.readBits(8),Qt.readBits(8),Qt.readBits(8),Qt.readBits(8)),Yt=new Uint8Array(It-4),es=0;es<It-4;es++)Yt[es]=Qt.readBits(8);return{identifier:_s,private_data:Yt.buffer}})(he,C):C.readBits(8*he);for(var Ge=[],re=C.readBits(16),Le=0;Le<re;){var Je=C.readBits(8),it=C.readBits(8),Et=String.fromCharCode(C.readBits(8),C.readBits(8),C.readBits(8),C.readBits(8));Je===0?Ge.push(Ze(Je,it,Et,C)):Je===1?Ge.push(Me(Je,it,Et,C)):Je===2?Ge.push(ht(Je,it,Et,C)):Je===3?Ge.push(Oe(Je,it,Et,C)):Je===4?Ge.push(Ct(Je,it,Et,C)):C.readBits(8*(it-4)),Le+=2+it}var Ht={table_id:j,section_syntax_indicator:_,private_indicator:P,section_length:L,protocol_version:$,encrypted_packet:J,encryption_algorithm:de,pts_adjustment:B,cw_index:se,tier:fe,splice_command_length:he,splice_command_type:pe,splice_command:Ue,descriptor_loop_length:re,splice_descriptors:Ge,E_CRC32:J?C.readBits(32):void 0,CRC32:C.readBits(32)};if(pe===je.kSpliceInsert){var _t=Ue;if(_t.splice_event_cancel_indicator)return{splice_command_type:pe,detail:Ht,data:M};if(_t.program_splice_flag&&!_t.splice_immediate_flag){var Pt=_t.duration_flag?_t.break_duration.auto_return:void 0,Wt=_t.duration_flag?_t.break_duration.duration/90:void 0;return _t.splice_time.time_specified_flag?{splice_command_type:pe,pts:(B+_t.splice_time.pts_time)%Math.pow(2,33),auto_return:Pt,duraiton:Wt,detail:Ht,data:M}:{splice_command_type:pe,auto_return:Pt,duraiton:Wt,detail:Ht,data:M}}return{splice_command_type:pe,auto_return:Pt=_t.duration_flag?_t.break_duration.auto_return:void 0,duraiton:Wt=_t.duration_flag?_t.break_duration.duration/90:void 0,detail:Ht,data:M}}if(pe===je.kTimeSignal){var Bt=Ue;return Bt.splice_time.time_specified_flag?{splice_command_type:pe,pts:(B+Bt.splice_time.pts_time)%Math.pow(2,33),detail:Ht,data:M}:{splice_command_type:pe,detail:Ht,data:M}}return{splice_command_type:pe,detail:Ht,data:M}};(function(M){M[M.kSliceIDR_W_RADL=19]="kSliceIDR_W_RADL",M[M.kSliceIDR_N_LP=20]="kSliceIDR_N_LP",M[M.kSliceCRA_NUT=21]="kSliceCRA_NUT",M[M.kSliceVPS=32]="kSliceVPS",M[M.kSliceSPS=33]="kSliceSPS",M[M.kSlicePPS=34]="kSlicePPS",M[M.kSliceAUD=35]="kSliceAUD"})(qe||(qe={}));var bt=function(){},ve=function(M){var C=M.data.byteLength;this.type=M.type,this.data=new Uint8Array(4+C),new DataView(this.data.buffer).setUint32(0,C),this.data.set(M.data,4)},xt=(function(){function M(C){this.TAG="H265AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=C,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&d.a.e(this.TAG,"Could not find H265 startcode until payload end!")}return M.prototype.findNextStartCodeOffset=function(C){for(var j=C,_=this.data_;;){if(j+3>=_.byteLength)return this.eof_flag_=!0,_.byteLength;var P=_[j+0]<<24|_[j+1]<<16|_[j+2]<<8|_[j+3],L=_[j+0]<<16|_[j+1]<<8|_[j+2];if(P===1||L===1)return j;j++}},M.prototype.readNextNaluPayload=function(){for(var C=this.data_,j=null;j==null&&!this.eof_flag_;){var _=this.current_startcode_offset_,P=C[_+=(C[_]<<24|C[_+1]<<16|C[_+2]<<8|C[_+3])===1?4:3]>>1&63,L=(128&C[_])>>>7,$=this.findNextStartCodeOffset(_);if(this.current_startcode_offset_=$,L===0){var J=C.subarray(_,$);(j=new bt).type=P,j.data=J}}return j},M})(),me=(function(){function M(C,j,_,P){var L=23+(5+C.byteLength)+(5+j.byteLength)+(5+_.byteLength),$=this.data=new Uint8Array(L);$[0]=1,$[1]=(3&P.general_profile_space)<<6|(P.general_tier_flag?1:0)<<5|31&P.general_profile_idc,$[2]=P.general_profile_compatibility_flags_1,$[3]=P.general_profile_compatibility_flags_2,$[4]=P.general_profile_compatibility_flags_3,$[5]=P.general_profile_compatibility_flags_4,$[6]=P.general_constraint_indicator_flags_1,$[7]=P.general_constraint_indicator_flags_2,$[8]=P.general_constraint_indicator_flags_3,$[9]=P.general_constraint_indicator_flags_4,$[10]=P.general_constraint_indicator_flags_5,$[11]=P.general_constraint_indicator_flags_6,$[12]=P.general_level_idc,$[13]=240|(3840&P.min_spatial_segmentation_idc)>>8,$[14]=255&P.min_spatial_segmentation_idc,$[15]=252|3&P.parallelismType,$[16]=252|3&P.chroma_format_idc,$[17]=248|7&P.bit_depth_luma_minus8,$[18]=248|7&P.bit_depth_chroma_minus8,$[19]=0,$[20]=0,$[21]=(3&P.constant_frame_rate)<<6|(7&P.num_temporal_layers)<<3|(P.temporal_id_nested?1:0)<<2|3,$[22]=3,$[23]=128|qe.kSliceVPS,$[24]=0,$[25]=1,$[26]=(65280&C.byteLength)>>8,$[27]=(255&C.byteLength)>>0,$.set(C,28),$[23+(5+C.byteLength)+0]=128|qe.kSliceSPS,$[23+(5+C.byteLength)+1]=0,$[23+(5+C.byteLength)+2]=1,$[23+(5+C.byteLength)+3]=(65280&j.byteLength)>>8,$[23+(5+C.byteLength)+4]=(255&j.byteLength)>>0,$.set(j,23+(5+C.byteLength)+5),$[23+(5+C.byteLength+5+j.byteLength)+0]=128|qe.kSlicePPS,$[23+(5+C.byteLength+5+j.byteLength)+1]=0,$[23+(5+C.byteLength+5+j.byteLength)+2]=1,$[23+(5+C.byteLength+5+j.byteLength)+3]=(65280&_.byteLength)>>8,$[23+(5+C.byteLength+5+j.byteLength)+4]=(255&_.byteLength)>>0,$.set(_,23+(5+C.byteLength+5+j.byteLength)+5)}return M.prototype.getData=function(){return this.data},M})(),De=function(){},ue=function(){},Fe=function(){},mt=[[64,64,80,80,96,96,112,112,128,128,160,160,192,192,224,224,256,256,320,320,384,384,448,448,512,512,640,640,768,768,896,896,1024,1024,1152,1152,1280,1280],[69,70,87,88,104,105,121,122,139,140,174,175,208,209,243,244,278,279,348,349,417,418,487,488,557,558,696,697,835,836,975,976,1114,1115,1253,1254,1393,1394],[96,96,120,120,144,144,168,168,192,192,240,240,288,288,336,336,384,384,480,480,576,576,672,672,768,768,960,960,1152,1152,1344,1344,1536,1536,1728,1728,1920,1920]],Se=(function(){function M(C){this.TAG="AC3Parser",this.data_=C,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&d.a.e(this.TAG,"Could not found AC3 syncword until payload end")}return M.prototype.findNextSyncwordOffset=function(C){for(var j=C,_=this.data_;;){if(j+7>=_.byteLength)return this.eof_flag_=!0,_.byteLength;if((_[j+0]<<8|_[j+1]<<0)===2935)return j;j++}},M.prototype.readNextAC3Frame=function(){for(var C=this.data_,j=null;j==null&&!this.eof_flag_;){var _=this.current_syncword_offset_,P=C[_+4]>>6,L=[48e3,44200,33e3][P],$=63&C[_+4],J=2*mt[P][$];if(isNaN(J)||_+J>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var de=this.findNextSyncwordOffset(_+J);this.current_syncword_offset_=de;var B=C[_+5]>>3,se=7&C[_+5],fe=C[_+6]>>5,he=0;(1&fe)!=0&&fe!==1&&(he+=2),(4&fe)!=0&&(he+=2),fe===2&&(he+=2);var pe=(C[_+6]<<8|C[_+7]<<0)>>12-he&1,Ue=[2,1,2,3,3,4,4,5][fe]+pe;(j=new Fe).sampling_frequency=L,j.channel_count=Ue,j.channel_mode=fe,j.bit_stream_identification=B,j.low_frequency_effects_channel_on=pe,j.bit_stream_mode=se,j.frame_size_code=$,j.data=C.subarray(_,_+J)}return j},M.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},M.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},M})(),st=function(M){var C;C=[M.sampling_rate_code<<6|M.bit_stream_identification<<1|M.bit_stream_mode>>2,(3&M.bit_stream_mode)<<6|M.channel_mode<<3|M.low_frequency_effects_channel_on<<2|M.frame_size_code>>4,M.frame_size_code<<4&224],this.config=C,this.sampling_rate=M.sampling_frequency,this.bit_stream_identification=M.bit_stream_identification,this.bit_stream_mode=M.bit_stream_mode,this.low_frequency_effects_channel_on=M.low_frequency_effects_channel_on,this.channel_count=M.channel_count,this.channel_mode=M.channel_mode,this.codec_mimetype="ac-3",this.original_codec_mimetype="ac-3"},wt=function(){},yt=(function(){function M(C){this.TAG="EAC3Parser",this.data_=C,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&d.a.e(this.TAG,"Could not found AC3 syncword until payload end")}return M.prototype.findNextSyncwordOffset=function(C){for(var j=C,_=this.data_;;){if(j+7>=_.byteLength)return this.eof_flag_=!0,_.byteLength;if((_[j+0]<<8|_[j+1]<<0)===2935)return j;j++}},M.prototype.readNextEAC3Frame=function(){for(var C=this.data_,j=null;j==null&&!this.eof_flag_;){var _=this.current_syncword_offset_,P=new S(C.subarray(_+2)),L=(P.readBits(2),P.readBits(3),P.readBits(11)+1<<1),$=P.readBits(2),J=null,de=null;$===3?(J=[24e3,22060,16e3][$=P.readBits(2)],de=3):(J=[48e3,44100,32e3][$],de=P.readBits(2));var B=P.readBits(3),se=P.readBits(1),fe=P.readBits(5);if(_+L>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var he=this.findNextSyncwordOffset(_+L);this.current_syncword_offset_=he;var pe=[2,1,2,3,3,4,4,5][B]+se;P.destroy(),(j=new wt).sampling_frequency=J,j.channel_count=pe,j.channel_mode=B,j.bit_stream_identification=fe,j.low_frequency_effects_channel_on=se,j.frame_size=L,j.num_blks=[1,2,3,6][de],j.data=C.subarray(_,_+L)}return j},M.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},M.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},M})(),Mt=function(M){var C,j=Math.floor(M.frame_size*M.sampling_frequency/(16*M.num_blks));C=[255&j,248&j,M.sampling_rate_code<<6|M.bit_stream_identification<<1|0,0|M.channel_mode<<1|M.low_frequency_effects_channel_on<<0,0],this.config=C,this.sampling_rate=M.sampling_frequency,this.bit_stream_identification=M.bit_stream_identification,this.num_blks=M.num_blks,this.low_frequency_effects_channel_on=M.low_frequency_effects_channel_on,this.channel_count=M.channel_count,this.channel_mode=M.channel_mode,this.codec_mimetype="ec-3",this.original_codec_mimetype="ec-3"},Ke=function(){},Vt=(function(){function M(C){this.TAG="AV1OBUInMpegTsParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=C,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&d.a.e(this.TAG,"Could not find AV1 startcode until payload end!")}return M._ebsp2rbsp=function(C){for(var j=C,_=j.byteLength,P=new Uint8Array(_),L=0,$=0;$<_;$++)$>=2&&j[$]===3&&j[$-1]===0&&j[$-2]===0||(P[L]=j[$],L++);return new Uint8Array(P.buffer,0,L)},M.prototype.findNextStartCodeOffset=function(C){for(var j=C,_=this.data_;;){if(j+2>=_.byteLength)return this.eof_flag_=!0,_.byteLength;if((_[j+0]<<16|_[j+1]<<8|_[j+2])===1)return j;j++}},M.prototype.readNextOBUPayload=function(){for(var C=this.data_,j=null;j==null&&!this.eof_flag_;){var _=this.current_startcode_offset_+3,P=this.findNextStartCodeOffset(_);this.current_startcode_offset_=P,j=M._ebsp2rbsp(C.subarray(_,P))}return j},M})(),Nt=(function(){var M=function(C,j){return(M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,P){_.__proto__=P}||function(_,P){for(var L in P)Object.prototype.hasOwnProperty.call(P,L)&&(_[L]=P[L])})(C,j)};return function(C,j){if(typeof j!="function"&&j!==null)throw new TypeError("Class extends value "+String(j)+" is not a constructor or null");function _(){this.constructor=C}M(C,j),C.prototype=j===null?Object.create(j):(_.prototype=j.prototype,new _)}})(),St=function(){return(St=Object.assign||function(M){for(var C,j=1,_=arguments.length;j<_;j++)for(var P in C=arguments[j])Object.prototype.hasOwnProperty.call(C,P)&&(M[P]=C[P]);return M}).apply(this,arguments)},Kt=(function(M){function C(j,_){var P=M.call(this)||this;return P.TAG="TSDemuxer",P.first_parse_=!0,P.media_info_=new u.a,P.timescale_=90,P.duration_=0,P.current_pmt_pid_=-1,P.program_pmt_map_={},P.pes_slice_queues_={},P.section_slice_queues_={},P.video_metadata_={vps:void 0,sps:void 0,pps:void 0,av1c:void 0,details:void 0},P.audio_metadata_={codec:void 0,audio_object_type:void 0,sampling_freq_index:void 0,sampling_frequency:void 0,channel_config:void 0},P.last_pcr_base_=NaN,P.timestamp_offset_=0,P.audio_last_sample_pts_=void 0,P.aac_last_incomplete_data_=null,P.has_video_=!1,P.has_audio_=!1,P.video_init_segment_dispatched_=!1,P.audio_init_segment_dispatched_=!1,P.video_metadata_changed_=!1,P.audio_metadata_changed_=!1,P.loas_previous_frame=null,P.video_track_={type:"video",id:1,sequenceNumber:0,samples:[],length:0},P.audio_track_={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},P.ts_packet_size_=j.ts_packet_size,P.sync_offset_=j.sync_offset,P.config_=_,P}return Nt(C,M),C.prototype.destroy=function(){this.media_info_=null,this.pes_slice_queues_=null,this.section_slice_queues_=null,this.video_metadata_=null,this.audio_metadata_=null,this.aac_last_incomplete_data_=null,this.video_track_=null,this.audio_track_=null,M.prototype.destroy.call(this)},C.probe=function(j){var _=new Uint8Array(j),P=-1,L=188;if(_.byteLength<=3*L)return{needMoreData:!0};for(;P===-1;){for(var $=Math.min(1e3,_.byteLength-3*L),J=0;J<$;){if(_[J]===71&&_[J+L]===71&&_[J+2*L]===71){P=J;break}J++}if(P===-1)if(L===188)L=192;else{if(L!==192)break;L=204}}return P===-1?{match:!1}:(L===192&&P>=4?(d.a.v("TSDemuxer","ts_packet_size = 192, m2ts mode"),P-=4):L===204&&d.a.v("TSDemuxer","ts_packet_size = 204, RS encoded MPEG2-TS stream"),{match:!0,consumed:0,ts_packet_size:L,sync_offset:P})},C.prototype.bindDataSource=function(j){return j.onDataArrival=this.parseChunks.bind(this),this},C.prototype.resetMediaInfo=function(){this.media_info_=new u.a},C.prototype.parseChunks=function(j,_){if(!(this.onError&&this.onMediaInfo&&this.onTrackMetadata&&this.onDataAvailable))throw new b.a("onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var P=0;for(this.first_parse_&&(this.first_parse_=!1,P=this.sync_offset_);P+this.ts_packet_size_<=j.byteLength;){var L=_+P;this.ts_packet_size_===192&&(P+=4);var $=new Uint8Array(j,P,188),J=$[0];if(J!==71){d.a.e(this.TAG,"sync_byte = ".concat(J,", not 0x47"));break}var de=(64&$[1])>>>6,B=($[1],(31&$[1])<<8|$[2]),se=(48&$[3])>>>4,fe=15&$[3],he=!(!this.pmt_||this.pmt_.pcr_pid!==B),pe={},Ue=4;if(se==2||se==3){var Ge=$[4];if(Ge>0&&(he||se==3)&&(pe.discontinuity_indicator=(128&$[5])>>>7,pe.random_access_indicator=(64&$[5])>>>6,pe.elementary_stream_priority_indicator=(32&$[5])>>>5,(16&$[5])>>>4)){var re=300*this.getPcrBase($)+((1&$[10])<<8|$[11]);this.last_pcr_=re}if(se==2||5+Ge===188){P+=188,this.ts_packet_size_===204&&(P+=16);continue}Ue=5+Ge}if(se==1||se==3){if(B===0||B===this.current_pmt_pid_||this.pmt_!=null&&this.pmt_.pid_stream_type[B]===I.kSCTE35){var Le=188-Ue;this.handleSectionSlice(j,P+Ue,Le,{pid:B,file_position:L,payload_unit_start_indicator:de,continuity_conunter:fe,random_access_indicator:pe.random_access_indicator})}else if(this.pmt_!=null&&this.pmt_.pid_stream_type[B]!=null){Le=188-Ue;var Je=this.pmt_.pid_stream_type[B];B!==this.pmt_.common_pids.h264&&B!==this.pmt_.common_pids.h265&&B!==this.pmt_.common_pids.av1&&B!==this.pmt_.common_pids.adts_aac&&B!==this.pmt_.common_pids.loas_aac&&B!==this.pmt_.common_pids.ac3&&B!==this.pmt_.common_pids.eac3&&B!==this.pmt_.common_pids.opus&&B!==this.pmt_.common_pids.mp3&&this.pmt_.pes_private_data_pids[B]!==!0&&this.pmt_.timed_id3_pids[B]!==!0&&this.pmt_.synchronous_klv_pids[B]!==!0&&this.pmt_.asynchronous_klv_pids[B]!==!0||this.handlePESSlice(j,P+Ue,Le,{pid:B,stream_type:Je,file_position:L,payload_unit_start_indicator:de,continuity_conunter:fe,random_access_indicator:pe.random_access_indicator})}}P+=188,this.ts_packet_size_===204&&(P+=16)}return this.dispatchAudioVideoMediaSegment(),P},C.prototype.handleSectionSlice=function(j,_,P,L){var $=new Uint8Array(j,_,P),J=this.section_slice_queues_[L.pid];if(L.payload_unit_start_indicator){var de=$[0];if(J!=null&&J.total_length!==0){var B=new Uint8Array(j,_+1,Math.min(P,de));J.slices.push(B),J.total_length+=B.byteLength,J.total_length===J.expected_length?this.emitSectionSlices(J,L):this.clearSlices(J,L)}for(var se=1+de;se<$.byteLength&&$[se+0]!==255;){var fe=(15&$[se+1])<<8|$[se+2];this.section_slice_queues_[L.pid]=new ce,(J=this.section_slice_queues_[L.pid]).expected_length=fe+3,J.file_position=L.file_position,J.random_access_indicator=L.random_access_indicator,B=new Uint8Array(j,_+se,Math.min(P-se,J.expected_length-J.total_length)),J.slices.push(B),J.total_length+=B.byteLength,J.total_length===J.expected_length?this.emitSectionSlices(J,L):J.total_length>=J.expected_length&&this.clearSlices(J,L),se+=B.byteLength}}else J!=null&&J.total_length!==0&&(B=new Uint8Array(j,_,Math.min(P,J.expected_length-J.total_length)),J.slices.push(B),J.total_length+=B.byteLength,J.total_length===J.expected_length?this.emitSectionSlices(J,L):J.total_length>=J.expected_length&&this.clearSlices(J,L))},C.prototype.handlePESSlice=function(j,_,P,L){var $=new Uint8Array(j,_,P),J=$[0]<<16|$[1]<<8|$[2],de=($[3],$[4]<<8|$[5]);if(L.payload_unit_start_indicator){if(J!==1)return void d.a.e(this.TAG,"handlePESSlice: packet_start_code_prefix should be 1 but with value ".concat(J));var B=this.pes_slice_queues_[L.pid];B&&(B.expected_length===0||B.expected_length===B.total_length?this.emitPESSlices(B,L):this.clearSlices(B,L)),this.pes_slice_queues_[L.pid]=new ce,this.pes_slice_queues_[L.pid].file_position=L.file_position,this.pes_slice_queues_[L.pid].random_access_indicator=L.random_access_indicator}if(this.pes_slice_queues_[L.pid]!=null){var se=this.pes_slice_queues_[L.pid];se.slices.push($),L.payload_unit_start_indicator&&(se.expected_length=de===0?0:de+6),se.total_length+=$.byteLength,se.expected_length>0&&se.expected_length===se.total_length?this.emitPESSlices(se,L):se.expected_length>0&&se.expected_length<se.total_length&&this.clearSlices(se,L)}},C.prototype.emitSectionSlices=function(j,_){for(var P=new Uint8Array(j.total_length),L=0,$=0;L<j.slices.length;L++){var J=j.slices[L];P.set(J,$),$+=J.byteLength}j.slices=[],j.expected_length=-1,j.total_length=0;var de=new ae;de.pid=_.pid,de.data=P,de.file_position=j.file_position,de.random_access_indicator=j.random_access_indicator,this.parseSection(de)},C.prototype.emitPESSlices=function(j,_){for(var P=new Uint8Array(j.total_length),L=0,$=0;L<j.slices.length;L++){var J=j.slices[L];P.set(J,$),$+=J.byteLength}j.slices=[],j.expected_length=-1,j.total_length=0;var de=new q;de.pid=_.pid,de.data=P,de.stream_type=_.stream_type,de.file_position=j.file_position,de.random_access_indicator=j.random_access_indicator,this.parsePES(de)},C.prototype.clearSlices=function(j,_){j.slices=[],j.expected_length=-1,j.total_length=0},C.prototype.parseSection=function(j){var _=j.data,P=j.pid;P===0?this.parsePAT(_):P===this.current_pmt_pid_?this.parsePMT(_):this.pmt_!=null&&this.pmt_.scte_35_pids[P]&&this.parseSCTE35(_)},C.prototype.parsePES=function(j){var _=j.data,P=_[0]<<16|_[1]<<8|_[2],L=_[3],$=_[4]<<8|_[5];if(P===1)if(L!==188&&L!==190&&L!==191&&L!==240&&L!==241&&L!==255&&L!==242&&L!==248){_[6];var J=(192&_[7])>>>6,de=_[8],B=void 0,se=void 0;J!==2&&J!==3||(B=this.getTimestamp(_,9),se=J===3?this.getTimestamp(_,14):B);var fe=9+de,he=void 0;if($!==0){if($<3+de)return void d.a.v(this.TAG,"Malformed PES: PES_packet_length < 3 + PES_header_data_length");he=$-3-de}else he=_.byteLength-fe;var pe=_.subarray(fe,fe+he);switch(j.stream_type){case I.kMPEG1Audio:case I.kMPEG2Audio:this.parseMP3Payload(pe,B);break;case I.kPESPrivateData:this.pmt_.common_pids.av1===j.pid?this.parseAV1Payload(pe,B,se,j.file_position,j.random_access_indicator):this.pmt_.common_pids.opus===j.pid?this.parseOpusPayload(pe,B):this.pmt_.common_pids.ac3===j.pid?this.parseAC3Payload(pe,B):this.pmt_.common_pids.eac3===j.pid?this.parseEAC3Payload(pe,B):this.pmt_.asynchronous_klv_pids[j.pid]?this.parseAsynchronousKLVMetadataPayload(pe,j.pid,L):this.pmt_.smpte2038_pids[j.pid]?this.parseSMPTE2038MetadataPayload(pe,B,se,j.pid,L):this.parsePESPrivateDataPayload(pe,B,se,j.pid,L);break;case I.kADTSAAC:this.parseADTSAACPayload(pe,B);break;case I.kLOASAAC:this.parseLOASAACPayload(pe,B);break;case I.kAC3:this.parseAC3Payload(pe,B);break;case I.kEAC3:this.parseEAC3Payload(pe,B);break;case I.kMetadata:this.pmt_.timed_id3_pids[j.pid]?this.parseTimedID3MetadataPayload(pe,B,se,j.pid,L):this.pmt_.synchronous_klv_pids[j.pid]&&this.parseSynchronousKLVMetadataPayload(pe,B,se,j.pid,L);break;case I.kH264:this.parseH264Payload(pe,B,se,j.file_position,j.random_access_indicator);break;case I.kH265:this.parseH265Payload(pe,B,se,j.file_position,j.random_access_indicator)}}else(L===188||L===191||L===240||L===241||L===255||L===242||L===248)&&j.stream_type===I.kPESPrivateData&&(fe=6,he=void 0,he=$!==0?$:_.byteLength-fe,pe=_.subarray(fe,fe+he),this.parsePESPrivateDataPayload(pe,void 0,void 0,j.pid,L));else d.a.e(this.TAG,"parsePES: packet_start_code_prefix should be 1 but with value ".concat(P))},C.prototype.parsePAT=function(j){var _=j[0];if(_===0){var P=(15&j[1])<<8|j[2],L=(j[3],j[4],(62&j[5])>>>1),$=1&j[5],J=j[6],de=(j[7],null);if($===1&&J===0)(de=new le).version_number=L;else if((de=this.pat_)==null)return;for(var B=P-5-4,se=-1,fe=-1,he=8;he<8+B;he+=4){var pe=j[he]<<8|j[he+1],Ue=(31&j[he+2])<<8|j[he+3];pe===0?de.network_pid=Ue:(de.program_pmt_pid[pe]=Ue,se===-1&&(se=pe),fe===-1&&(fe=Ue))}$===1&&J===0&&(this.pat_==null&&d.a.v(this.TAG,"Parsed first PAT: ".concat(JSON.stringify(de))),this.pat_=de,this.current_program_=se,this.current_pmt_pid_=fe)}else d.a.e(this.TAG,"parsePAT: table_id ".concat(_," is not corresponded to PAT!"))},C.prototype.parsePMT=function(j){var _=j[0];if(_===2){var P=(15&j[1])<<8|j[2],L=j[3]<<8|j[4],$=(62&j[5])>>>1,J=1&j[5],de=j[6],B=(j[7],null);if(J===1&&de===0)(B=new X).program_number=L,B.version_number=$,this.program_pmt_map_[L]=B;else if((B=this.program_pmt_map_[L])==null)return;B.pcr_pid=(31&j[8])<<8|j[9];for(var se=(15&j[10])<<8|j[11],fe=12+se,he=P-9-se-4,pe=fe;pe<fe+he;){var Ue=j[pe],Ge=(31&j[pe+1])<<8|j[pe+2],re=(15&j[pe+3])<<8|j[pe+4];B.pid_stream_type[Ge]=Ue;var Le=B.common_pids.h264||B.common_pids.h265,Je=B.common_pids.adts_aac||B.common_pids.loas_aac||B.common_pids.ac3||B.common_pids.eac3||B.common_pids.opus||B.common_pids.mp3;if(Ue!==I.kH264||Le)if(Ue!==I.kH265||Le)if(Ue!==I.kADTSAAC||Je)if(Ue!==I.kLOASAAC||Je)if(Ue!==I.kAC3||Je)if(Ue!==I.kEAC3||Je)if(Ue!==I.kMPEG1Audio&&Ue!==I.kMPEG2Audio||Je)if(Ue===I.kPESPrivateData){if(B.pes_private_data_pids[Ge]=!0,re>0){for(var it=pe+5;it<pe+5+re;){var Et=j[it+0],Ht=j[it+1];if(Et===5){var _t=String.fromCharCode.apply(String,Array.from(j.subarray(it+2,it+2+Ht)));_t==="VANC"?B.smpte2038_pids[Ge]=!0:_t==="AV01"?B.common_pids.av1=Ge:_t==="Opus"?B.common_pids.opus=Ge:_t==="KLVA"&&(B.asynchronous_klv_pids[Ge]=!0)}else if(Et===127){if(Ge===B.common_pids.opus){var Pt=null;if(j[it+2]===128&&(Pt=j[it+3]),Pt==null){d.a.e(this.TAG,"Not Supported Opus channel count.");continue}var Wt={codec:"opus",channel_count:(15&Pt)==0?2:15&Pt,channel_config_code:Pt,sample_rate:48e3},Bt={codec:"opus",meta:Wt};this.audio_init_segment_dispatched_==0?(this.audio_metadata_=Wt,this.dispatchAudioInitSegment(Bt)):this.detectAudioMetadataChange(Bt)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(Bt))}}else Et===128&&Ge===B.common_pids.av1&&(this.video_metadata_.av1c=j.subarray(it+2,it+2+Ht));it+=2+Ht}var It=j.subarray(pe+5,pe+5+re);this.dispatchPESPrivateDataDescriptor(Ge,Ue,It)}}else if(Ue===I.kMetadata){if(re>0)for(it=pe+5;it<pe+5+re;){Et=j[it+0];var Qt=j[it+1];if(Et===38){var _s=j[it+2]<<8|j[it+3]<<0,Yt=null;_s===65535&&(Yt=String.fromCharCode.apply(String,Array.from(j.subarray(it+4,it+4+4))));var es=null;if(j[it+4+(_s===65535?4:0)]===255){var Es=4+(_s===65535?4:0)+1;es=String.fromCharCode.apply(String,Array.from(j.subarray(it+Es,it+Es+4)))}Yt==="ID3 "&&es==="ID3 "?B.timed_id3_pids[Ge]=!0:es==="KLVA"&&(B.synchronous_klv_pids[Ge]=!0)}it+=2+Qt}}else Ue===I.kSCTE35&&(B.scte_35_pids[Ge]=!0);else B.common_pids.mp3=Ge;else B.common_pids.eac3=Ge;else B.common_pids.ac3=Ge;else B.common_pids.loas_aac=Ge;else B.common_pids.adts_aac=Ge;else B.common_pids.h265=Ge;else B.common_pids.h264=Ge;pe+=5+re}L===this.current_program_&&(this.pmt_==null&&d.a.v(this.TAG,"Parsed first PMT: ".concat(JSON.stringify(B))),this.pmt_=B,(B.common_pids.h264||B.common_pids.h265||B.common_pids.av1)&&(this.has_video_=!0),(B.common_pids.adts_aac||B.common_pids.loas_aac||B.common_pids.ac3||B.common_pids.opus||B.common_pids.mp3)&&(this.has_audio_=!0))}else d.a.e(this.TAG,"parsePMT: table_id ".concat(_," is not corresponded to PMT!"))},C.prototype.parseSCTE35=function(j){var _=we(j);if(_.pts!=null){var P=Math.floor(_.pts/this.timescale_);_.pts=P}else _.nearest_pts=this.getNearestTimestampMilliseconds();this.onSCTE35Metadata&&this.onSCTE35Metadata(_)},C.prototype.parseAV1Payload=function(j,_,P,L,$){for(var J=new Vt(j),de=null,B=[],se=0,fe=!1,he=null;(de=J.readNextOBUPayload())!=null;){if((he=U.parseOBUs(de,this.video_metadata_.details))&&he.keyframe===!0)if(this.video_init_segment_dispatched_){if(this.detectVideoMetadataChange(null,he)===!0){var pe;this.video_metadata_changed_=!0,this.dispatchVideoMediaSegment(),(pe=new Uint8Array(new ArrayBuffer(this.video_metadata_.av1c.byteLength+he.sequence_header_data.byteLength))).set(this.video_metadata_.av1c,0),pe.set(he.sequence_header_data,this.video_metadata_.av1c.byteLength),he.av1c=pe,this.dispatchVideoInitSegment()}}else(pe=new Uint8Array(new ArrayBuffer(this.video_metadata_.av1c.byteLength+he.sequence_header_data.byteLength))).set(this.video_metadata_.av1c,0),pe.set(he.sequence_header_data,this.video_metadata_.av1c.byteLength),he.av1c=pe,this.video_metadata_.details=he,this.dispatchVideoInitSegment();this.video_metadata_.details=he,fe||(fe=he.keyframe),B.push({data:de}),se+=de.byteLength}var Ue=Math.floor(_/this.timescale_),Ge=Math.floor(P/this.timescale_);if(B.length){var re=this.video_track_,Le={units:B,length:se,isKeyframe:fe,dts:Ge,pts:Ue,cts:Ue-Ge,file_position:L};re.samples.push(Le),re.length+=se}},C.prototype.parseH264Payload=function(j,_,P,L,$){for(var J=new Z(j),de=null,B=[],se=0,fe=!1;(de=J.readNextNaluPayload())!=null;){var he=new G(de);if(he.type===H.kSliceSPS){var pe=T.parseSPS(de.data);this.video_init_segment_dispatched_?this.detectVideoMetadataChange(he,pe)===!0&&(d.a.v(this.TAG,"H264: Critical h264 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:he,pps:void 0,av1c:void 0,details:pe}):(this.video_metadata_.sps=he,this.video_metadata_.details=pe)}else he.type===H.kSlicePPS?this.video_init_segment_dispatched_&&!this.video_metadata_changed_||(this.video_metadata_.pps=he,this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(),this.dispatchVideoInitSegment())):(he.type===H.kSliceIDR||he.type===H.kSliceNonIDR&&$===1)&&(fe=!0);this.video_init_segment_dispatched_&&(B.push(he),se+=he.data.byteLength)}var Ue=Math.floor(_/this.timescale_),Ge=Math.floor(P/this.timescale_);if(B.length){var re=this.video_track_,Le={units:B,length:se,isKeyframe:fe,dts:Ge,pts:Ue,cts:Ue-Ge,file_position:L};re.samples.push(Le),re.length+=se}},C.prototype.parseH265Payload=function(j,_,P,L,$){for(var J=new xt(j),de=null,B=[],se=0,fe=!1;(de=J.readNextNaluPayload())!=null;){var he=new ve(de);if(he.type===qe.kSliceVPS){if(!this.video_init_segment_dispatched_){var pe=E.parseVPS(de.data);this.video_metadata_.vps=he,this.video_metadata_.details=St(St({},this.video_metadata_.details),pe)}}else he.type===qe.kSliceSPS?(pe=E.parseSPS(de.data),this.video_init_segment_dispatched_?this.detectVideoMetadataChange(he,pe)===!0&&(d.a.v(this.TAG,"H265: Critical h265 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:he,pps:void 0,av1c:void 0,details:pe}):(this.video_metadata_.sps=he,this.video_metadata_.details=St(St({},this.video_metadata_.details),pe))):he.type===qe.kSlicePPS?(!this.video_init_segment_dispatched_||this.video_metadata_changed_)&&(pe=E.parsePPS(de.data),this.video_metadata_.pps=he,this.video_metadata_.details=St(St({},this.video_metadata_.details),pe),this.video_metadata_.vps&&this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(),this.dispatchVideoInitSegment())):he.type!==qe.kSliceIDR_W_RADL&&he.type!==qe.kSliceIDR_N_LP&&he.type!==qe.kSliceCRA_NUT||(fe=!0);this.video_init_segment_dispatched_&&(B.push(he),se+=he.data.byteLength)}var Ue=Math.floor(_/this.timescale_),Ge=Math.floor(P/this.timescale_);if(B.length){var re=this.video_track_,Le={units:B,length:se,isKeyframe:fe,dts:Ge,pts:Ue,cts:Ue-Ge,file_position:L};re.samples.push(Le),re.length+=se}},C.prototype.detectVideoMetadataChange=function(j,_){if(_.codec_mimetype!==this.video_metadata_.details.codec_mimetype)return d.a.v(this.TAG,"Video: Codec mimeType changed from "+"".concat(this.video_metadata_.details.codec_mimetype," to ").concat(_.codec_mimetype)),!0;if(_.codec_size.width!==this.video_metadata_.details.codec_size.width||_.codec_size.height!==this.video_metadata_.details.codec_size.height){var P=this.video_metadata_.details.codec_size,L=_.codec_size;return d.a.v(this.TAG,"Video: Coded Resolution changed from "+"".concat(P.width,"x").concat(P.height," to ").concat(L.width,"x").concat(L.height)),!0}return _.present_size.width!==this.video_metadata_.details.present_size.width&&(d.a.v(this.TAG,"Video: Present resolution width changed from "+"".concat(this.video_metadata_.details.present_size.width," to ").concat(_.present_size.width)),!0)},C.prototype.isInitSegmentDispatched=function(){return this.has_video_&&this.has_audio_?this.video_init_segment_dispatched_&&this.audio_init_segment_dispatched_:this.has_video_&&!this.has_audio_?this.video_init_segment_dispatched_:!(this.has_video_||!this.has_audio_)&&this.audio_init_segment_dispatched_},C.prototype.dispatchVideoInitSegment=function(){var j=this.video_metadata_.details,_={type:"video"};_.id=this.video_track_.id,_.timescale=1e3,_.duration=this.duration_,_.codecWidth=j.codec_size.width,_.codecHeight=j.codec_size.height,_.presentWidth=j.present_size.width,_.presentHeight=j.present_size.height,_.profile=j.profile_string,_.level=j.level_string,_.bitDepth=j.bit_depth,_.chromaFormat=j.chroma_format,_.sarRatio=j.sar_ratio,_.frameRate=j.frame_rate;var P=_.frameRate.fps_den,L=_.frameRate.fps_num;if(_.refSampleDuration=P/L*1e3,_.codec=j.codec_mimetype,this.video_metadata_.av1c)_.av1c=this.video_metadata_.av1c,this.video_init_segment_dispatched_==0&&d.a.v(this.TAG,"Generated first AV1 for mimeType: ".concat(_.codec));else if(this.video_metadata_.vps){var $=this.video_metadata_.vps.data.subarray(4),J=this.video_metadata_.sps.data.subarray(4),de=this.video_metadata_.pps.data.subarray(4),B=new me($,J,de,j);_.hvcc=B.getData(),this.video_init_segment_dispatched_==0&&d.a.v(this.TAG,"Generated first HEVCDecoderConfigurationRecord for mimeType: ".concat(_.codec))}else{J=this.video_metadata_.sps.data.subarray(4),de=this.video_metadata_.pps.data.subarray(4);var se=new oe(J,de,j);_.avcc=se.getData(),this.video_init_segment_dispatched_==0&&d.a.v(this.TAG,"Generated first AVCDecoderConfigurationRecord for mimeType: ".concat(_.codec))}this.onTrackMetadata("video",_),this.video_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var fe=this.media_info_;fe.hasVideo=!0,fe.width=_.codecWidth,fe.height=_.codecHeight,fe.fps=_.frameRate.fps,fe.profile=_.profile,fe.level=_.level,fe.refFrames=j.ref_frames,fe.chromaFormat=j.chroma_format_string,fe.sarNum=_.sarRatio.width,fe.sarDen=_.sarRatio.height,fe.videoCodec=_.codec,fe.hasAudio&&fe.audioCodec?fe.mimeType='video/mp2t; codecs="'.concat(fe.videoCodec,",").concat(fe.audioCodec,'"'):fe.mimeType='video/mp2t; codecs="'.concat(fe.videoCodec,'"'),fe.isComplete()&&this.onMediaInfo(fe)},C.prototype.dispatchVideoMediaSegment=function(){this.isInitSegmentDispatched()&&this.video_track_.length&&this.onDataAvailable(null,this.video_track_)},C.prototype.dispatchAudioMediaSegment=function(){this.isInitSegmentDispatched()&&this.audio_track_.length&&this.onDataAvailable(this.audio_track_,null)},C.prototype.dispatchAudioVideoMediaSegment=function(){this.isInitSegmentDispatched()&&(this.audio_track_.length||this.video_track_.length)&&this.onDataAvailable(this.audio_track_,this.video_track_)},C.prototype.parseADTSAACPayload=function(j,_){if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var P=new Uint8Array(j.byteLength+this.aac_last_incomplete_data_.byteLength);P.set(this.aac_last_incomplete_data_,0),P.set(j,this.aac_last_incomplete_data_.byteLength),j=P}var L,$;if(_!=null&&($=_/this.timescale_),this.audio_metadata_.codec==="aac"){if(_==null&&this.audio_last_sample_pts_!=null)L=1024/this.audio_metadata_.sampling_frequency*1e3,$=this.audio_last_sample_pts_+L;else if(_==null)return void d.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.audio_last_sample_pts_){L=1024/this.audio_metadata_.sampling_frequency*1e3;var J=this.audio_last_sample_pts_+L;Math.abs(J-$)>1&&(d.a.w(this.TAG,"AAC: Detected pts overlapped, "+"expected: ".concat(J,"ms, PES pts: ").concat($,"ms")),$=J)}}for(var de,B=new Qe(j),se=null,fe=$;(se=B.readNextAACFrame())!=null;){L=1024/se.sampling_frequency*1e3;var he={codec:"aac",data:se};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"aac",audio_object_type:se.audio_object_type,sampling_freq_index:se.sampling_freq_index,sampling_frequency:se.sampling_frequency,channel_config:se.channel_config},this.dispatchAudioInitSegment(he)):this.detectAudioMetadataChange(he)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(he)),de=fe;var pe=Math.floor(fe),Ue={unit:se.data,length:se.data.byteLength,pts:pe,dts:pe};this.audio_track_.samples.push(Ue),this.audio_track_.length+=se.data.byteLength,fe+=L}B.hasIncompleteData()&&(this.aac_last_incomplete_data_=B.getIncompleteData()),de&&(this.audio_last_sample_pts_=de)}},C.prototype.parseLOASAACPayload=function(j,_){var P;if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var L=new Uint8Array(j.byteLength+this.aac_last_incomplete_data_.byteLength);L.set(this.aac_last_incomplete_data_,0),L.set(j,this.aac_last_incomplete_data_.byteLength),j=L}var $,J;if(_!=null&&(J=_/this.timescale_),this.audio_metadata_.codec==="aac"){if(_==null&&this.audio_last_sample_pts_!=null)$=1024/this.audio_metadata_.sampling_frequency*1e3,J=this.audio_last_sample_pts_+$;else if(_==null)return void d.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.audio_last_sample_pts_){$=1024/this.audio_metadata_.sampling_frequency*1e3;var de=this.audio_last_sample_pts_+$;Math.abs(de-J)>1&&(d.a.w(this.TAG,"AAC: Detected pts overlapped, "+"expected: ".concat(de,"ms, PES pts: ").concat(J,"ms")),J=de)}}for(var B,se=new ot(j),fe=null,he=J;(fe=se.readNextAACFrame((P=this.loas_previous_frame)!==null&&P!==void 0?P:void 0))!=null;){this.loas_previous_frame=fe,$=1024/fe.sampling_frequency*1e3;var pe={codec:"aac",data:fe};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"aac",audio_object_type:fe.audio_object_type,sampling_freq_index:fe.sampling_freq_index,sampling_frequency:fe.sampling_frequency,channel_config:fe.channel_config},this.dispatchAudioInitSegment(pe)):this.detectAudioMetadataChange(pe)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(pe)),B=he;var Ue=Math.floor(he),Ge={unit:fe.data,length:fe.data.byteLength,pts:Ue,dts:Ue};this.audio_track_.samples.push(Ge),this.audio_track_.length+=fe.data.byteLength,he+=$}se.hasIncompleteData()&&(this.aac_last_incomplete_data_=se.getIncompleteData()),B&&(this.audio_last_sample_pts_=B)}},C.prototype.parseAC3Payload=function(j,_){if(!this.has_video_||this.video_init_segment_dispatched_){var P,L;if(_!=null&&(L=_/this.timescale_),this.audio_metadata_.codec==="ac-3"){if(_==null&&this.audio_last_sample_pts_!=null)P=1536/this.audio_metadata_.sampling_frequency*1e3,L=this.audio_last_sample_pts_+P;else if(_==null)return void d.a.w(this.TAG,"AC3: Unknown pts")}for(var $,J=new Se(j),de=null,B=L;(de=J.readNextAC3Frame())!=null;){P=1536/de.sampling_frequency*1e3;var se={codec:"ac-3",data:de};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"ac-3",sampling_frequency:de.sampling_frequency,bit_stream_identification:de.bit_stream_identification,bit_stream_mode:de.bit_stream_mode,low_frequency_effects_channel_on:de.low_frequency_effects_channel_on,channel_mode:de.channel_mode},this.dispatchAudioInitSegment(se)):this.detectAudioMetadataChange(se)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(se)),$=B;var fe=Math.floor(B),he={unit:de.data,length:de.data.byteLength,pts:fe,dts:fe};this.audio_track_.samples.push(he),this.audio_track_.length+=de.data.byteLength,B+=P}$&&(this.audio_last_sample_pts_=$)}},C.prototype.parseEAC3Payload=function(j,_){if(!this.has_video_||this.video_init_segment_dispatched_){var P,L;if(_!=null&&(L=_/this.timescale_),this.audio_metadata_.codec==="ec-3"){if(_==null&&this.audio_last_sample_pts_!=null)P=256*this.audio_metadata_.num_blks/this.audio_metadata_.sampling_frequency*1e3,L=this.audio_last_sample_pts_+P;else if(_==null)return void d.a.w(this.TAG,"EAC3: Unknown pts")}for(var $,J=new yt(j),de=null,B=L;(de=J.readNextEAC3Frame())!=null;){P=1536/de.sampling_frequency*1e3;var se={codec:"ec-3",data:de};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"ec-3",sampling_frequency:de.sampling_frequency,bit_stream_identification:de.bit_stream_identification,low_frequency_effects_channel_on:de.low_frequency_effects_channel_on,num_blks:de.num_blks,channel_mode:de.channel_mode},this.dispatchAudioInitSegment(se)):this.detectAudioMetadataChange(se)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(se)),$=B;var fe=Math.floor(B),he={unit:de.data,length:de.data.byteLength,pts:fe,dts:fe};this.audio_track_.samples.push(he),this.audio_track_.length+=de.data.byteLength,B+=P}$&&(this.audio_last_sample_pts_=$)}},C.prototype.parseOpusPayload=function(j,_){if(!this.has_video_||this.video_init_segment_dispatched_){var P,L;if(_!=null&&(L=_/this.timescale_),this.audio_metadata_.codec==="opus"){if(_==null&&this.audio_last_sample_pts_!=null)P=20,L=this.audio_last_sample_pts_+P;else if(_==null)return void d.a.w(this.TAG,"Opus: Unknown pts")}for(var $,J=L,de=0;de<j.length;){P=20;for(var B=(16&j[de+1])!=0,se=(8&j[de+1])!=0,fe=de+2,he=0;j[fe]===255;)he+=255,fe+=1;he+=j[fe],fe+=1,fe+=B?2:0,fe+=se?2:0,$=J;var pe=Math.floor(J),Ue=j.slice(fe,fe+he),Ge={unit:Ue,length:Ue.byteLength,pts:pe,dts:pe};this.audio_track_.samples.push(Ge),this.audio_track_.length+=Ue.byteLength,J+=P,de=fe+he}$&&(this.audio_last_sample_pts_=$)}},C.prototype.parseMP3Payload=function(j,_){if(!this.has_video_||this.video_init_segment_dispatched_){var P=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],L=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],$=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],J=j[1]>>>3&3,de=(6&j[1])>>1,B=(240&j[2])>>>4,se=(12&j[2])>>>2,fe=(j[3]>>>6&3)!==3?2:1,he=0,pe=34;switch(J){case 0:he=[11025,12e3,8e3,0][se];break;case 2:he=[22050,24e3,16e3,0][se];break;case 3:he=[44100,48e3,32e3,0][se]}switch(de){case 1:pe=34,B<$.length&&$[B];break;case 2:pe=33,B<L.length&&L[B];break;case 3:pe=32,B<P.length&&P[B]}var Ue=new ue;Ue.object_type=pe,Ue.sample_rate=he,Ue.channel_count=fe,Ue.data=j;var Ge={codec:"mp3",data:Ue};this.audio_init_segment_dispatched_==0?(this.audio_metadata_={codec:"mp3",object_type:pe,sample_rate:he,channel_count:fe},this.dispatchAudioInitSegment(Ge)):this.detectAudioMetadataChange(Ge)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(Ge));var re={unit:j,length:j.byteLength,pts:_/this.timescale_,dts:_/this.timescale_};this.audio_track_.samples.push(re),this.audio_track_.length+=j.byteLength}},C.prototype.detectAudioMetadataChange=function(j){if(j.codec!==this.audio_metadata_.codec)return d.a.v(this.TAG,"Audio: Audio Codecs changed from "+"".concat(this.audio_metadata_.codec," to ").concat(j.codec)),!0;if(j.codec==="aac"&&this.audio_metadata_.codec==="aac"){if((_=j.data).audio_object_type!==this.audio_metadata_.audio_object_type)return d.a.v(this.TAG,"AAC: AudioObjectType changed from "+"".concat(this.audio_metadata_.audio_object_type," to ").concat(_.audio_object_type)),!0;if(_.sampling_freq_index!==this.audio_metadata_.sampling_freq_index)return d.a.v(this.TAG,"AAC: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sampling_freq_index," to ").concat(_.sampling_freq_index)),!0;if(_.channel_config!==this.audio_metadata_.channel_config)return d.a.v(this.TAG,"AAC: Channel configuration changed from "+"".concat(this.audio_metadata_.channel_config," to ").concat(_.channel_config)),!0}else if(j.codec==="ac-3"&&this.audio_metadata_.codec==="ac-3"){var _;if((_=j.data).sampling_frequency!==this.audio_metadata_.sampling_frequency)return d.a.v(this.TAG,"AC3: Sampling Frequency changed from "+"".concat(this.audio_metadata_.sampling_frequency," to ").concat(_.sampling_frequency)),!0;if(_.bit_stream_identification!==this.audio_metadata_.bit_stream_identification)return d.a.v(this.TAG,"AC3: Bit Stream Identification changed from "+"".concat(this.audio_metadata_.bit_stream_identification," to ").concat(_.bit_stream_identification)),!0;if(_.bit_stream_mode!==this.audio_metadata_.bit_stream_mode)return d.a.v(this.TAG,"AC3: BitStream Mode changed from "+"".concat(this.audio_metadata_.bit_stream_mode," to ").concat(_.bit_stream_mode)),!0;if(_.channel_mode!==this.audio_metadata_.channel_mode)return d.a.v(this.TAG,"AC3: Channel Mode changed from "+"".concat(this.audio_metadata_.channel_mode," to ").concat(_.channel_mode)),!0;if(_.low_frequency_effects_channel_on!==this.audio_metadata_.low_frequency_effects_channel_on)return d.a.v(this.TAG,"AC3: Low Frequency Effects Channel On changed from "+"".concat(this.audio_metadata_.low_frequency_effects_channel_on," to ").concat(_.low_frequency_effects_channel_on)),!0}else if(j.codec==="opus"&&this.audio_metadata_.codec==="opus"){if((P=j.meta).sample_rate!==this.audio_metadata_.sample_rate)return d.a.v(this.TAG,"Opus: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sample_rate," to ").concat(P.sample_rate)),!0;if(P.channel_count!==this.audio_metadata_.channel_count)return d.a.v(this.TAG,"Opus: Channel count changed from "+"".concat(this.audio_metadata_.channel_count," to ").concat(P.channel_count)),!0}else if(j.codec==="mp3"&&this.audio_metadata_.codec==="mp3"){var P;if((P=j.data).object_type!==this.audio_metadata_.object_type)return d.a.v(this.TAG,"MP3: AudioObjectType changed from "+"".concat(this.audio_metadata_.object_type," to ").concat(P.object_type)),!0;if(P.sample_rate!==this.audio_metadata_.sample_rate)return d.a.v(this.TAG,"MP3: SamplingFrequencyIndex changed from "+"".concat(this.audio_metadata_.sample_rate," to ").concat(P.sample_rate)),!0;if(P.channel_count!==this.audio_metadata_.channel_count)return d.a.v(this.TAG,"MP3: Channel count changed from "+"".concat(this.audio_metadata_.channel_count," to ").concat(P.channel_count)),!0}return!1},C.prototype.dispatchAudioInitSegment=function(j){var _={type:"audio"};if(_.id=this.audio_track_.id,_.timescale=1e3,_.duration=this.duration_,this.audio_metadata_.codec==="aac"){var P=j.codec==="aac"?j.data:null,L=new ne(P);_.audioSampleRate=L.sampling_rate,_.channelCount=L.channel_count,_.codec=L.codec_mimetype,_.originalCodec=L.original_codec_mimetype,_.config=L.config,_.refSampleDuration=1024/_.audioSampleRate*_.timescale}else if(this.audio_metadata_.codec==="ac-3"){var $=j.codec==="ac-3"?j.data:null,J=new st($);_.audioSampleRate=J.sampling_rate,_.channelCount=J.channel_count,_.codec=J.codec_mimetype,_.originalCodec=J.original_codec_mimetype,_.config=J.config,_.refSampleDuration=1536/_.audioSampleRate*_.timescale}else if(this.audio_metadata_.codec==="ec-3"){var de=j.codec==="ec-3"?j.data:null,B=new Mt(de);_.audioSampleRate=B.sampling_rate,_.channelCount=B.channel_count,_.codec=B.codec_mimetype,_.originalCodec=B.original_codec_mimetype,_.config=B.config,_.refSampleDuration=256*B.num_blks/_.audioSampleRate*_.timescale}else this.audio_metadata_.codec==="opus"?(_.audioSampleRate=this.audio_metadata_.sample_rate,_.channelCount=this.audio_metadata_.channel_count,_.channelConfigCode=this.audio_metadata_.channel_config_code,_.codec="opus",_.originalCodec="opus",_.config=void 0,_.refSampleDuration=20):this.audio_metadata_.codec==="mp3"&&(_.audioSampleRate=this.audio_metadata_.sample_rate,_.channelCount=this.audio_metadata_.channel_count,_.codec="mp3",_.originalCodec="mp3",_.config=void 0);this.audio_init_segment_dispatched_==0&&d.a.v(this.TAG,"Generated first AudioSpecificConfig for mimeType: ".concat(_.codec)),this.onTrackMetadata("audio",_),this.audio_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var se=this.media_info_;se.hasAudio=!0,se.audioCodec=_.originalCodec,se.audioSampleRate=_.audioSampleRate,se.audioChannelCount=_.channelCount,se.hasVideo&&se.videoCodec?se.mimeType='video/mp2t; codecs="'.concat(se.videoCodec,",").concat(se.audioCodec,'"'):se.mimeType='video/mp2t; codecs="'.concat(se.audioCodec,'"'),se.isComplete()&&this.onMediaInfo(se)},C.prototype.dispatchPESPrivateDataDescriptor=function(j,_,P){var L=new Be;L.pid=j,L.stream_type=_,L.descriptor=P,this.onPESPrivateDataDescriptor&&this.onPESPrivateDataDescriptor(L)},C.prototype.parsePESPrivateDataPayload=function(j,_,P,L,$){var J=new ke;if(J.pid=L,J.stream_id=$,J.len=j.byteLength,J.data=j,_!=null){var de=Math.floor(_/this.timescale_);J.pts=de}else J.nearest_pts=this.getNearestTimestampMilliseconds();if(P!=null){var B=Math.floor(P/this.timescale_);J.dts=B}this.onPESPrivateData&&this.onPESPrivateData(J)},C.prototype.parseTimedID3MetadataPayload=function(j,_,P,L,$){var J=new ke;if(J.pid=L,J.stream_id=$,J.len=j.byteLength,J.data=j,_!=null){var de=Math.floor(_/this.timescale_);J.pts=de}if(P!=null){var B=Math.floor(P/this.timescale_);J.dts=B}this.onTimedID3Metadata&&this.onTimedID3Metadata(J)},C.prototype.parseSynchronousKLVMetadataPayload=function(j,_,P,L,$){var J=new Ke;if(J.pid=L,J.stream_id=$,J.len=j.byteLength,J.data=j,_!=null){var de=Math.floor(_/this.timescale_);J.pts=de}if(P!=null){var B=Math.floor(P/this.timescale_);J.dts=B}J.access_units=(function(se){for(var fe=[],he=0;he+5<se.byteLength;){var pe=se[he+0],Ue=se[he+1],Ge=se[he+2],re=se[he+3]<<8|se[he+4]<<0,Le=se.slice(he+5,he+5+re);fe.push({service_id:pe,sequence_number:Ue,flags:Ge,data:Le}),he+=5+re}return fe})(j),this.onSynchronousKLVMetadata&&this.onSynchronousKLVMetadata(J)},C.prototype.parseAsynchronousKLVMetadataPayload=function(j,_,P){var L=new ke;L.pid=_,L.stream_id=P,L.len=j.byteLength,L.data=j,this.onAsynchronousKLVMetadata&&this.onAsynchronousKLVMetadata(L)},C.prototype.parseSMPTE2038MetadataPayload=function(j,_,P,L,$){var J=new De;if(J.pid=L,J.stream_id=$,J.len=j.byteLength,J.data=j,_!=null){var de=Math.floor(_/this.timescale_);J.pts=de}if(J.nearest_pts=this.getNearestTimestampMilliseconds(),P!=null){var B=Math.floor(P/this.timescale_);J.dts=B}J.ancillaries=(function(se){for(var fe=new S(se),he=0,pe=[];he+=6,fe.readBits(6)===0;){var Ue=fe.readBool();he+=1;var Ge=fe.readBits(11);he+=11;var re=fe.readBits(12);he+=12;var Le=255&fe.readBits(10);he+=10;var Je=255&fe.readBits(10);he+=10;var it=255&fe.readBits(10);he+=10;for(var Et=new Uint8Array(it),Ht=0;Ht<it;Ht++){var _t=255&fe.readBits(10);he+=10,Et[Ht]=_t}fe.readBits(10),he+=10;var Pt="User Defined";Le===65?Je===7&&(Pt="SCTE-104"):Le===95?Je===220?Pt="ARIB STD-B37 (1SEG)":Je===221?Pt="ARIB STD-B37 (ANALOG)":Je===222?Pt="ARIB STD-B37 (SD)":Je===223&&(Pt="ARIB STD-B37 (HD)"):Le===97&&(Je===1?Pt="EIA-708":Je===2&&(Pt="EIA-608")),pe.push({yc_indicator:Ue,line_number:Ge,horizontal_offset:re,did:Le,sdid:Je,user_data:Et,description:Pt,information:{}}),fe.readBits(8-(he-Math.floor(he/8))%8),he+=(8-(he-Math.floor(he/8)))%8}return fe.destroy(),fe=null,pe})(j),this.onSMPTE2038Metadata&&this.onSMPTE2038Metadata(J)},C.prototype.getNearestTimestampMilliseconds=function(){return this.audio_last_sample_pts_!=null?Math.floor(this.audio_last_sample_pts_):this.last_pcr_!=null?Math.floor(this.last_pcr_/300/this.timescale_):void 0},C.prototype.getPcrBase=function(j){var _=33554432*j[6]+131072*j[7]+512*j[8]+2*j[9]+(128&j[10])/128+this.timestamp_offset_;return _+4294967296<this.last_pcr_base_&&(_+=8589934592,this.timestamp_offset_+=8589934592),this.last_pcr_base_=_,_},C.prototype.getTimestamp=function(j,_){var P=536870912*(14&j[_])+4194304*(255&j[_+1])+16384*(254&j[_+2])+128*(255&j[_+3])+(254&j[_+4])/2+this.timestamp_offset_;return P+4294967296<this.last_pcr_base_&&(P+=8589934592),P},C})(te),ws=function(M,C,j){for(var _,P=0,L=C.length;P<L;P++)!_&&P in C||(_||(_=Array.prototype.slice.call(C,0,P)),_[P]=C[P]);return M.concat(_||Array.prototype.slice.call(C))},Ne=(function(){function M(){}return M.init=function(){for(var C in M.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],hvc1:[],hvcC:[],av01:[],av1C:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[],Opus:[],dOps:[],"ac-3":[],dac3:[],"ec-3":[],dec3:[],fLaC:[],dfLa:[]},M.types)M.types.hasOwnProperty(C)&&(M.types[C]=[C.charCodeAt(0),C.charCodeAt(1),C.charCodeAt(2),C.charCodeAt(3)]);var j=M.constants={};j.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),j.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),j.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),j.STSC=j.STCO=j.STTS,j.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),j.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),j.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),j.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),j.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),j.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},M.box=function(C){for(var j=8,_=null,P=Array.prototype.slice.call(arguments,1),L=P.length,$=0;$<L;$++)j+=P[$].byteLength;(_=new Uint8Array(j))[0]=j>>>24&255,_[1]=j>>>16&255,_[2]=j>>>8&255,_[3]=255&j,_.set(C,4);var J=8;for($=0;$<L;$++)_.set(P[$],J),J+=P[$].byteLength;return _},M.generateInitSegment=function(C){var j=M.box(M.types.ftyp,M.constants.FTYP),_=M.moov(C),P=new Uint8Array(j.byteLength+_.byteLength);return P.set(j,0),P.set(_,j.byteLength),P},M.moov=function(C){var j=M.mvhd(C.timescale,C.duration),_=M.trak(C),P=M.mvex(C);return M.box(M.types.moov,j,_,P)},M.mvhd=function(C,j){return M.box(M.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,C>>>24&255,C>>>16&255,C>>>8&255,255&C,j>>>24&255,j>>>16&255,j>>>8&255,255&j,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},M.trak=function(C){return M.box(M.types.trak,M.tkhd(C),M.mdia(C))},M.tkhd=function(C){var j=C.id,_=C.duration,P=C.presentWidth,L=C.presentHeight;return M.box(M.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,j>>>24&255,j>>>16&255,j>>>8&255,255&j,0,0,0,0,_>>>24&255,_>>>16&255,_>>>8&255,255&_,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,P>>>8&255,255&P,0,0,L>>>8&255,255&L,0,0]))},M.mdia=function(C){return M.box(M.types.mdia,M.mdhd(C),M.hdlr(C),M.minf(C))},M.mdhd=function(C){var j=C.timescale,_=C.duration;return M.box(M.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,j>>>24&255,j>>>16&255,j>>>8&255,255&j,_>>>24&255,_>>>16&255,_>>>8&255,255&_,85,196,0,0]))},M.hdlr=function(C){var j=null;return j=C.type==="audio"?M.constants.HDLR_AUDIO:M.constants.HDLR_VIDEO,M.box(M.types.hdlr,j)},M.minf=function(C){var j=null;return j=C.type==="audio"?M.box(M.types.smhd,M.constants.SMHD):M.box(M.types.vmhd,M.constants.VMHD),M.box(M.types.minf,j,M.dinf(),M.stbl(C))},M.dinf=function(){return M.box(M.types.dinf,M.box(M.types.dref,M.constants.DREF))},M.stbl=function(C){return M.box(M.types.stbl,M.stsd(C),M.box(M.types.stts,M.constants.STTS),M.box(M.types.stsc,M.constants.STSC),M.box(M.types.stsz,M.constants.STSZ),M.box(M.types.stco,M.constants.STCO))},M.stsd=function(C){return C.type==="audio"?C.codec==="mp3"?M.box(M.types.stsd,M.constants.STSD_PREFIX,M.mp3(C)):C.codec==="ac-3"?M.box(M.types.stsd,M.constants.STSD_PREFIX,M.ac3(C)):C.codec==="ec-3"?M.box(M.types.stsd,M.constants.STSD_PREFIX,M.ec3(C)):C.codec==="opus"?M.box(M.types.stsd,M.constants.STSD_PREFIX,M.Opus(C)):C.codec=="flac"?M.box(M.types.stsd,M.constants.STSD_PREFIX,M.fLaC(C)):M.box(M.types.stsd,M.constants.STSD_PREFIX,M.mp4a(C)):C.type==="video"&&C.codec.startsWith("hvc1")?M.box(M.types.stsd,M.constants.STSD_PREFIX,M.hvc1(C)):C.type==="video"&&C.codec.startsWith("av01")?M.box(M.types.stsd,M.constants.STSD_PREFIX,M.av01(C)):M.box(M.types.stsd,M.constants.STSD_PREFIX,M.avc1(C))},M.mp3=function(C){var j=C.channelCount,_=C.audioSampleRate,P=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,j,0,16,0,0,0,0,_>>>8&255,255&_,0,0]);return M.box(M.types[".mp3"],P)},M.mp4a=function(C){var j=C.channelCount,_=C.audioSampleRate,P=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,j,0,16,0,0,0,0,_>>>8&255,255&_,0,0]);return M.box(M.types.mp4a,P,M.esds(C))},M.ac3=function(C){var j=C.channelCount,_=C.audioSampleRate,P=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,j,0,16,0,0,0,0,_>>>8&255,255&_,0,0]);return M.box(M.types["ac-3"],P,M.box(M.types.dac3,new Uint8Array(C.config)))},M.ec3=function(C){var j=C.channelCount,_=C.audioSampleRate,P=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,j,0,16,0,0,0,0,_>>>8&255,255&_,0,0]);return M.box(M.types["ec-3"],P,M.box(M.types.dec3,new Uint8Array(C.config)))},M.esds=function(C){var j=C.config||[],_=j.length,P=new Uint8Array([0,0,0,0,3,23+_,0,1,0,4,15+_,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([_]).concat(j).concat([6,1,2]));return M.box(M.types.esds,P)},M.Opus=function(C){var j=C.channelCount,_=C.audioSampleRate,P=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,j,0,16,0,0,0,0,_>>>8&255,255&_,0,0]);return M.box(M.types.Opus,P,M.dOps(C))},M.dOps=function(C){var j=C.channelCount,_=C.channelConfigCode,P=C.audioSampleRate;if(C.config)return M.box(M.types.dOps,C.config);var L=[];switch(_){case 1:case 2:L=[0];break;case 0:L=[255,1,1,0,1];break;case 128:L=[255,2,0,0,1];break;case 3:L=[1,2,1,0,2,1];break;case 4:L=[1,2,2,0,1,2,3];break;case 5:L=[1,3,2,0,4,1,2,3];break;case 6:L=[1,4,2,0,4,1,2,3,5];break;case 7:L=[1,4,2,0,4,1,2,3,5,6];break;case 8:L=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:L=[1,1,2,0,1];break;case 131:L=[1,1,3,0,1,2];break;case 132:L=[1,1,4,0,1,2,3];break;case 133:L=[1,1,5,0,1,2,3,4];break;case 134:L=[1,1,6,0,1,2,3,4,5];break;case 135:L=[1,1,7,0,1,2,3,4,5,6];break;case 136:L=[1,1,8,0,1,2,3,4,5,6,7]}var $=new Uint8Array(ws([0,j,0,0,P>>>24&255,P>>>17&255,P>>>8&255,P>>>0&255,0,0],L));return M.box(M.types.dOps,$)},M.fLaC=function(C){var j=C.channelCount,_=Math.min(C.audioSampleRate,65535),P=C.sampleSize,L=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,j,0,P,0,0,0,0,_>>>8&255,255&_,0,0]);return M.box(M.types.fLaC,L,M.dfLa(C))},M.dfLa=function(C){var j=new Uint8Array(ws([0,0,0,0],C.config));return M.box(M.types.dfLa,j)},M.avc1=function(C){var j=C.avcc,_=C.codecWidth,P=C.codecHeight,L=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,_>>>8&255,255&_,P>>>8&255,255&P,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return M.box(M.types.avc1,L,M.box(M.types.avcC,j))},M.hvc1=function(C){var j=C.hvcc,_=C.codecWidth,P=C.codecHeight,L=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,_>>>8&255,255&_,P>>>8&255,255&P,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return M.box(M.types.hvc1,L,M.box(M.types.hvcC,j))},M.av01=function(C){var j=C.av1c,_=C.codecWidth||192,P=C.codecHeight||108,L=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,_>>>8&255,255&_,P>>>8&255,255&P,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return M.box(M.types.av01,L,M.box(M.types.av1C,j))},M.mvex=function(C){return M.box(M.types.mvex,M.trex(C))},M.trex=function(C){var j=C.id,_=new Uint8Array([0,0,0,0,j>>>24&255,j>>>16&255,j>>>8&255,255&j,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return M.box(M.types.trex,_)},M.moof=function(C,j){return M.box(M.types.moof,M.mfhd(C.sequenceNumber),M.traf(C,j))},M.mfhd=function(C){var j=new Uint8Array([0,0,0,0,C>>>24&255,C>>>16&255,C>>>8&255,255&C]);return M.box(M.types.mfhd,j)},M.traf=function(C,j){var _=C.id,P=M.box(M.types.tfhd,new Uint8Array([0,0,0,0,_>>>24&255,_>>>16&255,_>>>8&255,255&_])),L=M.box(M.types.tfdt,new Uint8Array([0,0,0,0,j>>>24&255,j>>>16&255,j>>>8&255,255&j])),$=M.sdtp(C),J=M.trun(C,$.byteLength+16+16+8+16+8+8);return M.box(M.types.traf,P,L,J,$)},M.sdtp=function(C){for(var j=C.samples||[],_=j.length,P=new Uint8Array(4+_),L=0;L<_;L++){var $=j[L].flags;P[L+4]=$.isLeading<<6|$.dependsOn<<4|$.isDependedOn<<2|$.hasRedundancy}return M.box(M.types.sdtp,P)},M.trun=function(C,j){var _=C.samples||[],P=_.length,L=12+16*P,$=new Uint8Array(L);j+=8+L,$.set([0,0,15,1,P>>>24&255,P>>>16&255,P>>>8&255,255&P,j>>>24&255,j>>>16&255,j>>>8&255,255&j],0);for(var J=0;J<P;J++){var de=_[J].duration,B=_[J].size,se=_[J].flags,fe=_[J].cts;$.set([de>>>24&255,de>>>16&255,de>>>8&255,255&de,B>>>24&255,B>>>16&255,B>>>8&255,255&B,se.isLeading<<2|se.dependsOn,se.isDependedOn<<6|se.hasRedundancy<<4|se.isNonSync,0,0,fe>>>24&255,fe>>>16&255,fe>>>8&255,255&fe],12+16*J)}return M.box(M.types.trun,$)},M.mdat=function(C){return M.box(M.types.mdat,C)},M})();Ne.init();var gt=Ne,jt=(function(){function M(){}return M.getSilentFrame=function(C,j){if(C==="mp4a.40.2"){if(j===1)return new Uint8Array([0,200,0,128,35,128]);if(j===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(j===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(j===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(j===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(j===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(j===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(j===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(j===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},M})(),vt=n(11),os=(function(){function M(C){this.TAG="MP4Remuxer",this._config=C,this._isLive=C.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new vt.c("audio"),this._videoSegmentInfoList=new vt.c("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!(!f.a.chrome||!(f.a.version.major<50||f.a.version.major===50&&f.a.version.build<2661)),this._fillSilentAfterSeek=f.a.msedge||f.a.msie,this._mp3UseMpegAudio=!f.a.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return M.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},M.prototype.bindDataSource=function(C){return C.onDataAvailable=this.remux.bind(this),C.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(M.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(C){this._onInitSegment=C},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(C){this._onMediaSegment=C},enumerable:!1,configurable:!0}),M.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},M.prototype.seek=function(C){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},M.prototype.remux=function(C,j){if(!this._onMediaSegment)throw new b.a("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(C,j),j&&this._remuxVideo(j),C&&this._remuxAudio(C)},M.prototype._onTrackMetadataReceived=function(C,j){var _=null,P="mp4",L=j.codec;if(C==="audio")this._audioMeta=j,j.codec==="mp3"&&this._mp3UseMpegAudio?(P="mpeg",L="",_=new Uint8Array):_=gt.generateInitSegment(j);else{if(C!=="video")return;this._videoMeta=j,_=gt.generateInitSegment(j)}if(!this._onInitSegment)throw new b.a("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(C,{type:C,data:_.buffer,codec:L,container:"".concat(C,"/").concat(P),mediaDuration:j.duration})},M.prototype._calculateDtsBase=function(C,j){this._dtsBaseInited||(C&&C.samples&&C.samples.length&&(this._audioDtsBase=C.samples[0].dts),j&&j.samples&&j.samples.length&&(this._videoDtsBase=j.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},M.prototype.getTimestampBase=function(){if(this._dtsBaseInited)return this._dtsBase},M.prototype.flushStashedSamples=function(){var C=this._videoStashedLastSample,j=this._audioStashedLastSample,_={type:"video",id:1,sequenceNumber:0,samples:[],length:0};C!=null&&(_.samples.push(C),_.length=C.length);var P={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};j!=null&&(P.samples.push(j),P.length=j.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(_,!0),this._remuxAudio(P,!0)},M.prototype._remuxAudio=function(C,j){if(this._audioMeta!=null){var _,P=C,L=P.samples,$=void 0,J=-1,de=this._audioMeta.refSampleDuration,B=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,se=this._dtsBaseInited&&this._audioNextDts===void 0,fe=!1;if(L&&L.length!==0&&(L.length!==1||j)){var he=0,pe=null,Ue=0;B?(he=0,Ue=P.length):(he=8,Ue=8+P.length);var Ge=null;if(L.length>1&&(Ue-=(Ge=L.pop()).length),this._audioStashedLastSample!=null){var re=this._audioStashedLastSample;this._audioStashedLastSample=null,L.unshift(re),Ue+=re.length}Ge!=null&&(this._audioStashedLastSample=Ge);var Le=L[0].dts-this._dtsBase;if(this._audioNextDts)$=Le-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())$=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(fe=!0);else{var Je=this._audioSegmentInfoList.getLastSampleBefore(Le);if(Je!=null){var it=Le-(Je.originalDts+Je.duration);it<=3&&(it=0),$=Le-(Je.dts+Je.duration+it)}else $=0}if(fe){var Et=Le-$,Ht=this._videoSegmentInfoList.getLastSegmentBefore(Le);if(Ht!=null&&Ht.beginDts<Et){if(Ys=jt.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount)){var _t=Ht.beginDts,Pt=Et-Ht.beginDts;d.a.v(this.TAG,"InsertPrefixSilentAudio: dts: ".concat(_t,", duration: ").concat(Pt)),L.unshift({unit:Ys,dts:_t,pts:_t}),Ue+=Ys.byteLength}}else fe=!1}for(var Wt=[],Bt=0;Bt<L.length;Bt++){var It=(re=L[Bt]).unit,Qt=re.dts-this._dtsBase,_s=(_t=Qt,!1),Yt=null,es=0;if(!(Qt<-.001)){if(this._audioMeta.codec!=="mp3"&&de!=null){var Es=Qt;if(this._audioNextDts&&(Es=this._audioNextDts),($=Qt-Es)<=-3*de){d.a.w(this.TAG,"Dropping 1 audio frame (originalDts: ".concat(Qt," ms ,curRefDts: ").concat(Es," ms)  due to dtsCorrection: ").concat($," ms overlap."));continue}if($>=3*de&&this._fillAudioTimestampGap&&!f.a.safari){_s=!0;var Ys,ua=Math.floor($/de);d.a.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+"originalDts: ".concat(Qt," ms, curRefDts: ").concat(Es," ms, ")+"dtsCorrection: ".concat(Math.round($)," ms, generate: ").concat(ua," frames")),_t=Math.floor(Es),es=Math.floor(Es+de)-_t,(Ys=jt.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount))==null&&(d.a.w(this.TAG,"Unable to generate silent frame for "+"".concat(this._audioMeta.originalCodec," with ").concat(this._audioMeta.channelCount," channels, repeat last frame")),Ys=It),Yt=[];for(var Rs=0;Rs<ua;Rs++){Es+=de;var Ar=Math.floor(Es),Nr=Math.floor(Es+de)-Ar,mr={dts:Ar,pts:Ar,cts:0,unit:Ys,size:Ys.byteLength,duration:Nr,originalDts:Qt,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};Yt.push(mr),Ue+=mr.size}this._audioNextDts=Es+de}else _t=Math.floor(Es),es=Math.floor(Es+de)-_t,this._audioNextDts=Es+de}else _t=Qt-$,Bt!==L.length-1?es=L[Bt+1].dts-this._dtsBase-$-_t:Ge!=null?es=Ge.dts-this._dtsBase-$-_t:es=Wt.length>=1?Wt[Wt.length-1].duration:Math.floor(de),this._audioNextDts=_t+es;J===-1&&(J=_t),Wt.push({dts:_t,pts:_t,cts:0,unit:re.unit,size:re.unit.byteLength,duration:es,originalDts:Qt,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),_s&&Wt.push.apply(Wt,Yt)}}if(Wt.length===0)return P.samples=[],void(P.length=0);for(B?pe=new Uint8Array(Ue):((pe=new Uint8Array(Ue))[0]=Ue>>>24&255,pe[1]=Ue>>>16&255,pe[2]=Ue>>>8&255,pe[3]=255&Ue,pe.set(gt.types.mdat,4)),Bt=0;Bt<Wt.length;Bt++)It=Wt[Bt].unit,pe.set(It,he),he+=It.byteLength;var rr=Wt[Wt.length-1];_=rr.dts+rr.duration;var ys=new vt.b;ys.beginDts=J,ys.endDts=_,ys.beginPts=J,ys.endPts=_,ys.originalBeginDts=Wt[0].originalDts,ys.originalEndDts=rr.originalDts+rr.duration,ys.firstSample=new vt.d(Wt[0].dts,Wt[0].pts,Wt[0].duration,Wt[0].originalDts,!1),ys.lastSample=new vt.d(rr.dts,rr.pts,rr.duration,rr.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(ys),P.samples=Wt,P.sequenceNumber++;var Aa=null;Aa=B?new Uint8Array:gt.moof(P,J),P.samples=[],P.length=0;var Fr={type:"audio",data:this._mergeBoxes(Aa,pe).buffer,sampleCount:Wt.length,info:ys};B&&se&&(Fr.timestampOffset=J),this._onMediaSegment("audio",Fr)}}},M.prototype._remuxVideo=function(C,j){if(this._videoMeta!=null){var _,P,L=C,$=L.samples,J=void 0,de=-1,B=-1;if($&&$.length!==0&&($.length!==1||j)){var se=8,fe=null,he=8+C.length,pe=null;if($.length>1&&(he-=(pe=$.pop()).length),this._videoStashedLastSample!=null){var Ue=this._videoStashedLastSample;this._videoStashedLastSample=null,$.unshift(Ue),he+=Ue.length}pe!=null&&(this._videoStashedLastSample=pe);var Ge=$[0].dts-this._dtsBase;if(this._videoNextDts)J=Ge-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())J=0;else{var re=this._videoSegmentInfoList.getLastSampleBefore(Ge);if(re!=null){var Le=Ge-(re.originalDts+re.duration);Le<=3&&(Le=0),J=Ge-(re.dts+re.duration+Le)}else J=0}for(var Je=new vt.b,it=[],Et=0;Et<$.length;Et++){var Ht=(Ue=$[Et]).dts-this._dtsBase,_t=Ue.isKeyframe,Pt=Ht-J,Wt=Ue.cts,Bt=Pt+Wt;de===-1&&(de=Pt,B=Bt);var It=0;if(Et!==$.length-1?It=$[Et+1].dts-this._dtsBase-J-Pt:pe!=null?It=pe.dts-this._dtsBase-J-Pt:It=it.length>=1?it[it.length-1].duration:Math.floor(this._videoMeta.refSampleDuration),_t){var Qt=new vt.d(Pt,Bt,It,Ue.dts,!0);Qt.fileposition=Ue.fileposition,Je.appendSyncPoint(Qt)}it.push({dts:Pt,pts:Bt,cts:Wt,units:Ue.units,size:Ue.length,isKeyframe:_t,duration:It,originalDts:Ht,flags:{isLeading:0,dependsOn:_t?2:1,isDependedOn:_t?1:0,hasRedundancy:0,isNonSync:_t?0:1}})}for((fe=new Uint8Array(he))[0]=he>>>24&255,fe[1]=he>>>16&255,fe[2]=he>>>8&255,fe[3]=255&he,fe.set(gt.types.mdat,4),Et=0;Et<it.length;Et++)for(var _s=it[Et].units;_s.length;){var Yt=_s.shift().data;fe.set(Yt,se),se+=Yt.byteLength}var es=it[it.length-1];if(_=es.dts+es.duration,P=es.pts+es.duration,this._videoNextDts=_,Je.beginDts=de,Je.endDts=_,Je.beginPts=B,Je.endPts=P,Je.originalBeginDts=it[0].originalDts,Je.originalEndDts=es.originalDts+es.duration,Je.firstSample=new vt.d(it[0].dts,it[0].pts,it[0].duration,it[0].originalDts,it[0].isKeyframe),Je.lastSample=new vt.d(es.dts,es.pts,es.duration,es.originalDts,es.isKeyframe),this._isLive||this._videoSegmentInfoList.append(Je),L.samples=it,L.sequenceNumber++,this._forceFirstIDR){var Es=it[0].flags;Es.dependsOn=2,Es.isNonSync=0}var Ys=gt.moof(L,de);L.samples=[],L.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(Ys,fe).buffer,sampleCount:it.length,info:Je})}}},M.prototype._mergeBoxes=function(C,j){var _=new Uint8Array(C.byteLength+j.byteLength);return _.set(C,0),_.set(j,C.byteLength),_},M})(),xs=n(14),hs=n(1),Yr=(n(2),(function(){function M(C,j){this.TAG="TransmuxingController",this._emitter=new c.a,this._config=j,C.segments||(C.segments=[{duration:C.duration,filesize:C.filesize,url:C.url}]),typeof C.cors!="boolean"&&(C.cors=!0),typeof C.withCredentials!="boolean"&&(C.withCredentials=!1),this._mediaDataSource=C,this._currentSegmentIndex=0;var _=0;this._mediaDataSource.segments.forEach((function(P){P.timestampBase=_,_+=P.duration,P.cors=C.cors,P.withCredentials=C.withCredentials,j.referrerPolicy&&(P.referrerPolicy=j.referrerPolicy)})),isNaN(_)||this._mediaDataSource.duration===_||(this._mediaDataSource.duration=_),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return M.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},M.prototype.on=function(C,j){this._emitter.addListener(C,j)},M.prototype.off=function(C,j){this._emitter.removeListener(C,j)},M.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},M.prototype._loadSegment=function(C,j){this._currentSegmentIndex=C;var _=this._mediaDataSource.segments[C],P=this._ioctl=new xs.a(_,this._config,C);P.onError=this._onIOException.bind(this),P.onSeeked=this._onIOSeeked.bind(this),P.onComplete=this._onIOComplete.bind(this),P.onRedirect=this._onIORedirect.bind(this),P.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),j?this._demuxer.bindDataSource(this._ioctl):P.onDataArrival=this._onInitChunkArrival.bind(this),P.open(j)},M.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},M.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},M.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},M.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},M.prototype.seek=function(C){if(this._mediaInfo!=null&&this._mediaInfo.isSeekable()){var j=this._searchSegmentIndexContains(C);if(j===this._currentSegmentIndex){var _=this._mediaInfo.segments[j];if(_==null)this._pendingSeekTime=C;else{var P=_.getNearestKeyframe(C);this._remuxer.seek(P.milliseconds),this._ioctl.seek(P.fileposition),this._pendingResolveSeekPoint=P.milliseconds}}else{var L=this._mediaInfo.segments[j];L==null?(this._pendingSeekTime=C,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(j)):(P=L.getNearestKeyframe(C),this._internalAbort(),this._remuxer.seek(C),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[j].timestampBase,this._loadSegment(j,P.fileposition),this._pendingResolveSeekPoint=P.milliseconds,this._reportSegmentMediaInfo(j))}this._enableStatisticsReporter()}},M.prototype._searchSegmentIndexContains=function(C){for(var j=this._mediaDataSource.segments,_=j.length-1,P=0;P<j.length;P++)if(C<j[P].timestampBase){_=P-1;break}return _},M.prototype._onInitChunkArrival=function(C,j){var _=this,P=0;if(j>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,P=this._demuxer.parseChunks(C,j);else{var L=null;(L=F.probe(C)).match&&(this._setupFLVDemuxerRemuxer(L),P=this._demuxer.parseChunks(C,j)),L.match||L.needMoreData||(L=Kt.probe(C)).match&&(this._setupTSDemuxerRemuxer(L),P=this._demuxer.parseChunks(C,j)),L.match||L.needMoreData||(L=null,d.a.e(this.TAG,"Non MPEG-TS/FLV, Unsupported media type!"),Promise.resolve().then((function(){_._internalAbort()})),this._emitter.emit(hs.a.DEMUX_ERROR,k.a.FORMAT_UNSUPPORTED,"Non MPEG-TS/FLV, Unsupported media type!"))}return P},M.prototype._setupFLVDemuxerRemuxer=function(C){this._demuxer=new F(C,this._config),this._remuxer||(this._remuxer=new os(this._config));var j=this._mediaDataSource;j.duration==null||isNaN(j.duration)||(this._demuxer.overridedDuration=j.duration),typeof j.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=j.hasAudio),typeof j.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=j.hasVideo),this._demuxer.timestampBase=j.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},M.prototype._setupTSDemuxerRemuxer=function(C){var j=this._demuxer=new Kt(C,this._config);this._remuxer||(this._remuxer=new os(this._config)),j.onError=this._onDemuxException.bind(this),j.onMediaInfo=this._onMediaInfo.bind(this),j.onMetaDataArrived=this._onMetaDataArrived.bind(this),j.onTimedID3Metadata=this._onTimedID3Metadata.bind(this),j.onSynchronousKLVMetadata=this._onSynchronousKLVMetadata.bind(this),j.onAsynchronousKLVMetadata=this._onAsynchronousKLVMetadata.bind(this),j.onSMPTE2038Metadata=this._onSMPTE2038Metadata.bind(this),j.onSCTE35Metadata=this._onSCTE35Metadata.bind(this),j.onPESPrivateDataDescriptor=this._onPESPrivateDataDescriptor.bind(this),j.onPESPrivateData=this._onPESPrivateData.bind(this),this._remuxer.bindDataSource(this._demuxer),this._demuxer.bindDataSource(this._ioctl),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},M.prototype._onMediaInfo=function(C){var j=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},C),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,u.a.prototype));var _=Object.assign({},C);Object.setPrototypeOf(_,u.a.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=_,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then((function(){var P=j._pendingSeekTime;j._pendingSeekTime=null,j.seek(P)}))},M.prototype._onMetaDataArrived=function(C){this._emitter.emit(hs.a.METADATA_ARRIVED,C)},M.prototype._onScriptDataArrived=function(C){this._emitter.emit(hs.a.SCRIPTDATA_ARRIVED,C)},M.prototype._onTimedID3Metadata=function(C){var j=this._remuxer.getTimestampBase();j!=null&&(C.pts!=null&&(C.pts-=j),C.dts!=null&&(C.dts-=j),this._emitter.emit(hs.a.TIMED_ID3_METADATA_ARRIVED,C))},M.prototype._onSynchronousKLVMetadata=function(C){var j=this._remuxer.getTimestampBase();j!=null&&(C.pts!=null&&(C.pts-=j),C.dts!=null&&(C.dts-=j),this._emitter.emit(hs.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,C))},M.prototype._onAsynchronousKLVMetadata=function(C){this._emitter.emit(hs.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,C)},M.prototype._onSMPTE2038Metadata=function(C){var j=this._remuxer.getTimestampBase();j!=null&&(C.pts!=null&&(C.pts-=j),C.dts!=null&&(C.dts-=j),C.nearest_pts!=null&&(C.nearest_pts-=j),this._emitter.emit(hs.a.SMPTE2038_METADATA_ARRIVED,C))},M.prototype._onSCTE35Metadata=function(C){var j=this._remuxer.getTimestampBase();j!=null&&(C.pts!=null&&(C.pts-=j),C.nearest_pts!=null&&(C.nearest_pts-=j),this._emitter.emit(hs.a.SCTE35_METADATA_ARRIVED,C))},M.prototype._onPESPrivateDataDescriptor=function(C){this._emitter.emit(hs.a.PES_PRIVATE_DATA_DESCRIPTOR,C)},M.prototype._onPESPrivateData=function(C){var j=this._remuxer.getTimestampBase();j!=null&&(C.pts!=null&&(C.pts-=j),C.nearest_pts!=null&&(C.nearest_pts-=j),C.dts!=null&&(C.dts-=j),this._emitter.emit(hs.a.PES_PRIVATE_DATA_ARRIVED,C))},M.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},M.prototype._onIOComplete=function(C){var j=C+1;j<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer&&this._remuxer.flushStashedSamples(),this._loadSegment(j)):(this._remuxer&&this._remuxer.flushStashedSamples(),this._emitter.emit(hs.a.LOADING_COMPLETE),this._disableStatisticsReporter())},M.prototype._onIORedirect=function(C){var j=this._ioctl.extraData;this._mediaDataSource.segments[j].redirectedURL=C},M.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(hs.a.RECOVERED_EARLY_EOF)},M.prototype._onIOException=function(C,j){d.a.e(this.TAG,"IOException: type = ".concat(C,", code = ").concat(j.code,", msg = ").concat(j.msg)),this._emitter.emit(hs.a.IO_ERROR,C,j),this._disableStatisticsReporter()},M.prototype._onDemuxException=function(C,j){d.a.e(this.TAG,"DemuxException: type = ".concat(C,", info = ").concat(j)),this._emitter.emit(hs.a.DEMUX_ERROR,C,j)},M.prototype._onRemuxerInitSegmentArrival=function(C,j){this._emitter.emit(hs.a.INIT_SEGMENT,C,j)},M.prototype._onRemuxerMediaSegmentArrival=function(C,j){if(this._pendingSeekTime==null&&(this._emitter.emit(hs.a.MEDIA_SEGMENT,C,j),this._pendingResolveSeekPoint!=null&&C==="video")){var _=j.info.syncPoints,P=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,f.a.safari&&_.length>0&&_[0].originalDts===P&&(P=_[0].pts),this._emitter.emit(hs.a.RECOMMEND_SEEKPOINT,P)}},M.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},M.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},M.prototype._reportSegmentMediaInfo=function(C){var j=this._mediaInfo.segments[C],_=Object.assign({},j);_.duration=this._mediaInfo.duration,_.segmentCount=this._mediaInfo.segmentCount,delete _.segments,delete _.keyframesIndex,this._emitter.emit(hs.a.MEDIA_INFO,_)},M.prototype._reportStatisticsInfo=function(){var C={};C.url=this._ioctl.currentURL,C.hasRedirect=this._ioctl.hasRedirect,C.hasRedirect&&(C.redirectedURL=this._ioctl.currentRedirectedURL),C.speed=this._ioctl.currentSpeed,C.loaderType=this._ioctl.loaderType,C.currentSegmentIndex=this._currentSegmentIndex,C.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(hs.a.STATISTICS_INFO,C)},M})());r.a=Yr},function(s,r,n){var o,c=n(0),d=(function(){function D(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return D.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},D.prototype.addBytes=function(O){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=O,this._totalBytes+=O):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=O,this._totalBytes+=O):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=O,this._totalBytes+=O,this._lastCheckpoint=this._now())},Object.defineProperty(D.prototype,"currentKBps",{get:function(){this.addBytes(0);var O=(this._now()-this._lastCheckpoint)/1e3;return O==0&&(O=1),this._intervalBytes/O/1024},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"averageKBps",{get:function(){var O=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/O/1024},enumerable:!1,configurable:!0}),D})(),f=n(2),u=n(5),m=n(3),g=(o=function(D,O){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(U,I){U.__proto__=I}||function(U,I){for(var F in I)Object.prototype.hasOwnProperty.call(I,F)&&(U[F]=I[F])})(D,O)},function(D,O){if(typeof O!="function"&&O!==null)throw new TypeError("Class extends value "+String(O)+" is not a constructor or null");function U(){this.constructor=D}o(D,O),D.prototype=O===null?Object.create(O):(U.prototype=O.prototype,new U)}),x=(function(D){function O(U,I){var F=D.call(this,"fetch-stream-loader")||this;return F.TAG="FetchStreamLoader",F._seekHandler=U,F._config=I,F._needStash=!0,F._requestAbort=!1,F._abortController=null,F._contentLength=null,F._receivedLength=0,F}return g(O,D),O.isSupported=function(){try{var U=u.a.msedge&&u.a.version.minor>=15048,I=!u.a.msedge||U;return self.fetch&&self.ReadableStream&&I}catch{return!1}},O.prototype.destroy=function(){this.isWorking()&&this.abort(),D.prototype.destroy.call(this)},O.prototype.open=function(U,I){var F=this;this._dataSource=U,this._range=I;var te=U.url;this._config.reuseRedirectedURL&&U.redirectedURL!=null&&(te=U.redirectedURL);var le=this._seekHandler.getConfig(te,I),H=new self.Headers;if(typeof le.headers=="object"){var X=le.headers;for(var q in X)X.hasOwnProperty(q)&&H.append(q,X[q])}var ae={method:"GET",headers:H,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var q in this._config.headers)H.append(q,this._config.headers[q]);U.cors===!1&&(ae.mode="same-origin"),U.withCredentials&&(ae.credentials="include"),U.referrerPolicy&&(ae.referrerPolicy=U.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,ae.signal=this._abortController.signal),this._status=f.c.kConnecting,self.fetch(le.url,ae).then((function(ce){if(F._requestAbort)return F._status=f.c.kIdle,void ce.body.cancel();if(ce.ok&&ce.status>=200&&ce.status<=299){if(ce.url!==le.url&&F._onURLRedirect){var ee=F._seekHandler.removeURLParameters(ce.url);F._onURLRedirect(ee)}var W=ce.headers.get("Content-Length");return W!=null&&(F._contentLength=parseInt(W),F._contentLength!==0&&F._onContentLengthKnown&&F._onContentLengthKnown(F._contentLength)),F._pump.call(F,ce.body.getReader())}if(F._status=f.c.kError,!F._onError)throw new m.d("FetchStreamLoader: Http code invalid, "+ce.status+" "+ce.statusText);F._onError(f.b.HTTP_STATUS_CODE_INVALID,{code:ce.status,msg:ce.statusText})})).catch((function(ce){if(!F._abortController||!F._abortController.signal.aborted){if(F._status=f.c.kError,!F._onError)throw ce;F._onError(f.b.EXCEPTION,{code:-1,msg:ce.message})}}))},O.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==f.c.kBuffering||!u.a.chrome)&&this._abortController)try{this._abortController.abort()}catch{}},O.prototype._pump=function(U){var I=this;return U.read().then((function(F){if(F.done)if(I._contentLength!==null&&I._receivedLength<I._contentLength){I._status=f.c.kError;var te=f.b.EARLY_EOF,le={code:-1,msg:"Fetch stream meet Early-EOF"};if(!I._onError)throw new m.d(le.msg);I._onError(te,le)}else I._status=f.c.kComplete,I._onComplete&&I._onComplete(I._range.from,I._range.from+I._receivedLength-1);else{if(I._abortController&&I._abortController.signal.aborted)return void(I._status=f.c.kComplete);if(I._requestAbort===!0)return I._status=f.c.kComplete,U.cancel();I._status=f.c.kBuffering;var H=F.value.buffer,X=I._range.from+I._receivedLength;I._receivedLength+=H.byteLength,I._onDataArrival&&I._onDataArrival(H,X,I._receivedLength),I._pump(U)}})).catch((function(F){if(I._abortController&&I._abortController.signal.aborted)I._status=f.c.kComplete;else if(F.code!==11||!u.a.msedge){I._status=f.c.kError;var te=0,le=null;if(F.code!==19&&F.message!=="network error"||!(I._contentLength===null||I._contentLength!==null&&I._receivedLength<I._contentLength)?(te=f.b.EXCEPTION,le={code:F.code,msg:F.message}):(te=f.b.EARLY_EOF,le={code:F.code,msg:"Fetch stream meet Early-EOF"}),!I._onError)throw new m.d(le.msg);I._onError(te,le)}}))},O})(f.a),b=(function(){var D=function(O,U){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,F){I.__proto__=F}||function(I,F){for(var te in F)Object.prototype.hasOwnProperty.call(F,te)&&(I[te]=F[te])})(O,U)};return function(O,U){if(typeof U!="function"&&U!==null)throw new TypeError("Class extends value "+String(U)+" is not a constructor or null");function I(){this.constructor=O}D(O,U),O.prototype=U===null?Object.create(U):(I.prototype=U.prototype,new I)}})(),v=(function(D){function O(U,I){var F=D.call(this,"xhr-moz-chunked-loader")||this;return F.TAG="MozChunkedLoader",F._seekHandler=U,F._config=I,F._needStash=!0,F._xhr=null,F._requestAbort=!1,F._contentLength=null,F._receivedLength=0,F}return b(O,D),O.isSupported=function(){try{var U=new XMLHttpRequest;return U.open("GET","https://example.com",!0),U.responseType="moz-chunked-arraybuffer",U.responseType==="moz-chunked-arraybuffer"}catch(I){return c.a.w("MozChunkedLoader",I.message),!1}},O.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),D.prototype.destroy.call(this)},O.prototype.open=function(U,I){this._dataSource=U,this._range=I;var F=U.url;this._config.reuseRedirectedURL&&U.redirectedURL!=null&&(F=U.redirectedURL);var te=this._seekHandler.getConfig(F,I);this._requestURL=te.url;var le=this._xhr=new XMLHttpRequest;if(le.open("GET",te.url,!0),le.responseType="moz-chunked-arraybuffer",le.onreadystatechange=this._onReadyStateChange.bind(this),le.onprogress=this._onProgress.bind(this),le.onloadend=this._onLoadEnd.bind(this),le.onerror=this._onXhrError.bind(this),U.withCredentials&&(le.withCredentials=!0),typeof te.headers=="object"){var H=te.headers;for(var X in H)H.hasOwnProperty(X)&&le.setRequestHeader(X,H[X])}if(typeof this._config.headers=="object"){H=this._config.headers;for(var X in H)H.hasOwnProperty(X)&&le.setRequestHeader(X,H[X])}this._status=f.c.kConnecting,le.send()},O.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=f.c.kComplete},O.prototype._onReadyStateChange=function(U){var I=U.target;if(I.readyState===2){if(I.responseURL!=null&&I.responseURL!==this._requestURL&&this._onURLRedirect){var F=this._seekHandler.removeURLParameters(I.responseURL);this._onURLRedirect(F)}if(I.status!==0&&(I.status<200||I.status>299)){if(this._status=f.c.kError,!this._onError)throw new m.d("MozChunkedLoader: Http code invalid, "+I.status+" "+I.statusText);this._onError(f.b.HTTP_STATUS_CODE_INVALID,{code:I.status,msg:I.statusText})}else this._status=f.c.kBuffering}},O.prototype._onProgress=function(U){if(this._status!==f.c.kError){this._contentLength===null&&U.total!==null&&U.total!==0&&(this._contentLength=U.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var I=U.target.response,F=this._range.from+this._receivedLength;this._receivedLength+=I.byteLength,this._onDataArrival&&this._onDataArrival(I,F,this._receivedLength)}},O.prototype._onLoadEnd=function(U){this._requestAbort!==!0?this._status!==f.c.kError&&(this._status=f.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)):this._requestAbort=!1},O.prototype._onXhrError=function(U){this._status=f.c.kError;var I=0,F=null;if(this._contentLength&&U.loaded<this._contentLength?(I=f.b.EARLY_EOF,F={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(I=f.b.EXCEPTION,F={code:-1,msg:U.constructor.name+" "+U.type}),!this._onError)throw new m.d(F.msg);this._onError(I,F)},O})(f.a),w=(function(){var D=function(O,U){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,F){I.__proto__=F}||function(I,F){for(var te in F)Object.prototype.hasOwnProperty.call(F,te)&&(I[te]=F[te])})(O,U)};return function(O,U){if(typeof U!="function"&&U!==null)throw new TypeError("Class extends value "+String(U)+" is not a constructor or null");function I(){this.constructor=O}D(O,U),O.prototype=U===null?Object.create(U):(I.prototype=U.prototype,new I)}})(),S=((function(D){function O(U,I){var F=D.call(this,"xhr-msstream-loader")||this;return F.TAG="MSStreamLoader",F._seekHandler=U,F._config=I,F._needStash=!0,F._xhr=null,F._reader=null,F._totalRange=null,F._currentRange=null,F._currentRequestURL=null,F._currentRedirectedURL=null,F._contentLength=null,F._receivedLength=0,F._bufferLimit=16777216,F._lastTimeBufferSize=0,F._isReconnecting=!1,F}w(O,D),O.isSupported=function(){try{if(self.MSStream===void 0||self.MSStreamReader===void 0)return!1;var U=new XMLHttpRequest;return U.open("GET","https://example.com",!0),U.responseType="ms-stream",U.responseType==="ms-stream"}catch(I){return c.a.w("MSStreamLoader",I.message),!1}},O.prototype.destroy=function(){this.isWorking()&&this.abort(),this._reader&&(this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr=null),D.prototype.destroy.call(this)},O.prototype.open=function(U,I){this._internalOpen(U,I,!1)},O.prototype._internalOpen=function(U,I,F){this._dataSource=U,F?this._currentRange=I:this._totalRange=I;var te=U.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?te=this._currentRedirectedURL:U.redirectedURL!=null&&(te=U.redirectedURL));var le=this._seekHandler.getConfig(te,I);this._currentRequestURL=le.url;var H=this._reader=new self.MSStreamReader;H.onprogress=this._msrOnProgress.bind(this),H.onload=this._msrOnLoad.bind(this),H.onerror=this._msrOnError.bind(this);var X=this._xhr=new XMLHttpRequest;if(X.open("GET",le.url,!0),X.responseType="ms-stream",X.onreadystatechange=this._xhrOnReadyStateChange.bind(this),X.onerror=this._xhrOnError.bind(this),U.withCredentials&&(X.withCredentials=!0),typeof le.headers=="object"){var q=le.headers;for(var ae in q)q.hasOwnProperty(ae)&&X.setRequestHeader(ae,q[ae])}if(typeof this._config.headers=="object"){q=this._config.headers;for(var ae in q)q.hasOwnProperty(ae)&&X.setRequestHeader(ae,q[ae])}this._isReconnecting?this._isReconnecting=!1:this._status=f.c.kConnecting,X.send()},O.prototype.abort=function(){this._internalAbort(),this._status=f.c.kComplete},O.prototype._internalAbort=function(){this._reader&&(this._reader.readyState===1&&this._reader.abort(),this._reader.onprogress=null,this._reader.onload=null,this._reader.onerror=null,this._reader=null),this._xhr&&(this._xhr.abort(),this._xhr.onreadystatechange=null,this._xhr=null)},O.prototype._xhrOnReadyStateChange=function(U){var I=U.target;if(I.readyState===2)if(I.status>=200&&I.status<=299){if(this._status=f.c.kBuffering,I.responseURL!=null){var F=this._seekHandler.removeURLParameters(I.responseURL);I.responseURL!==this._currentRequestURL&&F!==this._currentRedirectedURL&&(this._currentRedirectedURL=F,this._onURLRedirect&&this._onURLRedirect(F))}var te=I.getResponseHeader("Content-Length");if(te!=null&&this._contentLength==null){var le=parseInt(te);le>0&&(this._contentLength=le,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength))}}else{if(this._status=f.c.kError,!this._onError)throw new m.d("MSStreamLoader: Http code invalid, "+I.status+" "+I.statusText);this._onError(f.b.HTTP_STATUS_CODE_INVALID,{code:I.status,msg:I.statusText})}else if(I.readyState===3&&I.status>=200&&I.status<=299){this._status=f.c.kBuffering;var H=I.response;this._reader.readAsArrayBuffer(H)}},O.prototype._xhrOnError=function(U){this._status=f.c.kError;var I=f.b.EXCEPTION,F={code:-1,msg:U.constructor.name+" "+U.type};if(!this._onError)throw new m.d(F.msg);this._onError(I,F)},O.prototype._msrOnProgress=function(U){var I=U.target.result;if(I!=null){var F=I.slice(this._lastTimeBufferSize);this._lastTimeBufferSize=I.byteLength;var te=this._totalRange.from+this._receivedLength;this._receivedLength+=F.byteLength,this._onDataArrival&&this._onDataArrival(F,te,this._receivedLength),I.byteLength>=this._bufferLimit&&(c.a.v(this.TAG,"MSStream buffer exceeded max size near ".concat(te+F.byteLength,", reconnecting...")),this._doReconnectIfNeeded())}else this._doReconnectIfNeeded()},O.prototype._doReconnectIfNeeded=function(){if(this._contentLength==null||this._receivedLength<this._contentLength){this._isReconnecting=!0,this._lastTimeBufferSize=0,this._internalAbort();var U={from:this._totalRange.from+this._receivedLength,to:-1};this._internalOpen(this._dataSource,U,!0)}},O.prototype._msrOnLoad=function(U){this._status=f.c.kComplete,this._onComplete&&this._onComplete(this._totalRange.from,this._totalRange.from+this._receivedLength-1)},O.prototype._msrOnError=function(U){this._status=f.c.kError;var I=0,F=null;if(this._contentLength&&this._receivedLength<this._contentLength?(I=f.b.EARLY_EOF,F={code:-1,msg:"MSStream meet Early-Eof"}):(I=f.b.EARLY_EOF,F={code:-1,msg:U.constructor.name+" "+U.type}),!this._onError)throw new m.d(F.msg);this._onError(I,F)}})(f.a),(function(){var D=function(O,U){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,F){I.__proto__=F}||function(I,F){for(var te in F)Object.prototype.hasOwnProperty.call(F,te)&&(I[te]=F[te])})(O,U)};return function(O,U){if(typeof U!="function"&&U!==null)throw new TypeError("Class extends value "+String(U)+" is not a constructor or null");function I(){this.constructor=O}D(O,U),O.prototype=U===null?Object.create(U):(I.prototype=U.prototype,new I)}})()),T=(function(D){function O(U,I){var F=D.call(this,"xhr-range-loader")||this;return F.TAG="RangeLoader",F._seekHandler=U,F._config=I,F._needStash=!1,F._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],F._currentChunkSizeKB=384,F._currentSpeedNormalized=0,F._zeroSpeedChunkCount=0,F._xhr=null,F._speedSampler=new d,F._requestAbort=!1,F._waitForTotalLength=!1,F._totalLengthReceived=!1,F._currentRequestURL=null,F._currentRedirectedURL=null,F._currentRequestRange=null,F._totalLength=null,F._contentLength=null,F._receivedLength=0,F._lastTimeLoaded=0,F}return S(O,D),O.isSupported=function(){try{var U=new XMLHttpRequest;return U.open("GET","https://example.com",!0),U.responseType="arraybuffer",U.responseType==="arraybuffer"}catch(I){return c.a.w("RangeLoader",I.message),!1}},O.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),D.prototype.destroy.call(this)},Object.defineProperty(O.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),O.prototype.open=function(U,I){this._dataSource=U,this._range=I,this._status=f.c.kConnecting;var F=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(F=!0,this._totalLength=this._dataSource.filesize),this._totalLengthReceived||F?this._openSubRange():(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1}))},O.prototype._openSubRange=function(){var U=1024*this._currentChunkSizeKB,I=this._range.from+this._receivedLength,F=I+U;this._contentLength!=null&&F-this._range.from>=this._contentLength&&(F=this._range.from+this._contentLength-1),this._currentRequestRange={from:I,to:F},this._internalOpen(this._dataSource,this._currentRequestRange)},O.prototype._internalOpen=function(U,I){this._lastTimeLoaded=0;var F=U.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?F=this._currentRedirectedURL:U.redirectedURL!=null&&(F=U.redirectedURL));var te=this._seekHandler.getConfig(F,I);this._currentRequestURL=te.url;var le=this._xhr=new XMLHttpRequest;if(le.open("GET",te.url,!0),le.responseType="arraybuffer",le.onreadystatechange=this._onReadyStateChange.bind(this),le.onprogress=this._onProgress.bind(this),le.onload=this._onLoad.bind(this),le.onerror=this._onXhrError.bind(this),U.withCredentials&&(le.withCredentials=!0),typeof te.headers=="object"){var H=te.headers;for(var X in H)H.hasOwnProperty(X)&&le.setRequestHeader(X,H[X])}if(typeof this._config.headers=="object"){H=this._config.headers;for(var X in H)H.hasOwnProperty(X)&&le.setRequestHeader(X,H[X])}le.send()},O.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=f.c.kComplete},O.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},O.prototype._onReadyStateChange=function(U){var I=U.target;if(I.readyState===2){if(I.responseURL!=null){var F=this._seekHandler.removeURLParameters(I.responseURL);I.responseURL!==this._currentRequestURL&&F!==this._currentRedirectedURL&&(this._currentRedirectedURL=F,this._onURLRedirect&&this._onURLRedirect(F))}if(I.status>=200&&I.status<=299){if(this._waitForTotalLength)return;this._status=f.c.kBuffering}else{if(this._status=f.c.kError,!this._onError)throw new m.d("RangeLoader: Http code invalid, "+I.status+" "+I.statusText);this._onError(f.b.HTTP_STATUS_CODE_INVALID,{code:I.status,msg:I.statusText})}}},O.prototype._onProgress=function(U){if(this._status!==f.c.kError){if(this._contentLength===null){var I=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,I=!0;var F=U.total;this._internalAbort(),F!=null&F!==0&&(this._totalLength=F)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,I)return void this._openSubRange();this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var te=U.loaded-this._lastTimeLoaded;this._lastTimeLoaded=U.loaded,this._speedSampler.addBytes(te)}},O.prototype._normalizeSpeed=function(U){var I=this._chunkSizeKBList,F=I.length-1,te=0,le=0,H=F;if(U<I[0])return I[0];for(;le<=H;){if((te=le+Math.floor((H-le)/2))===F||U>=I[te]&&U<I[te+1])return I[te];I[te]<U?le=te+1:H=te-1}},O.prototype._onLoad=function(U){if(this._status!==f.c.kError)if(this._waitForTotalLength)this._waitForTotalLength=!1;else{this._lastTimeLoaded=0;var I=this._speedSampler.lastSecondKBps;if(I===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(I=this._speedSampler.currentKBps)),I!==0){var F=this._normalizeSpeed(I);this._currentSpeedNormalized!==F&&(this._currentSpeedNormalized=F,this._currentChunkSizeKB=F)}var te=U.target.response,le=this._range.from+this._receivedLength;this._receivedLength+=te.byteLength;var H=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():H=!0,this._onDataArrival&&this._onDataArrival(te,le,this._receivedLength),H&&(this._status=f.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},O.prototype._onXhrError=function(U){this._status=f.c.kError;var I=0,F=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(I=f.b.EARLY_EOF,F={code:-1,msg:"RangeLoader meet Early-Eof"}):(I=f.b.EXCEPTION,F={code:-1,msg:U.constructor.name+" "+U.type}),!this._onError)throw new m.d(F.msg);this._onError(I,F)},O})(f.a),k=(function(){var D=function(O,U){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,F){I.__proto__=F}||function(I,F){for(var te in F)Object.prototype.hasOwnProperty.call(F,te)&&(I[te]=F[te])})(O,U)};return function(O,U){if(typeof U!="function"&&U!==null)throw new TypeError("Class extends value "+String(U)+" is not a constructor or null");function I(){this.constructor=O}D(O,U),O.prototype=U===null?Object.create(U):(I.prototype=U.prototype,new I)}})(),E=(function(D){function O(){var U=D.call(this,"websocket-loader")||this;return U.TAG="WebSocketLoader",U._needStash=!0,U._ws=null,U._requestAbort=!1,U._receivedLength=0,U}return k(O,D),O.isSupported=function(){try{return self.WebSocket!==void 0}catch{return!1}},O.prototype.destroy=function(){this._ws&&this.abort(),D.prototype.destroy.call(this)},O.prototype.open=function(U){try{var I=this._ws=new self.WebSocket(U.url);I.binaryType="arraybuffer",I.onopen=this._onWebSocketOpen.bind(this),I.onclose=this._onWebSocketClose.bind(this),I.onmessage=this._onWebSocketMessage.bind(this),I.onerror=this._onWebSocketError.bind(this),this._status=f.c.kConnecting}catch(te){this._status=f.c.kError;var F={code:te.code,msg:te.message};if(!this._onError)throw new m.d(F.msg);this._onError(f.b.EXCEPTION,F)}},O.prototype.abort=function(){var U=this._ws;!U||U.readyState!==0&&U.readyState!==1||(this._requestAbort=!0,U.close()),this._ws=null,this._status=f.c.kComplete},O.prototype._onWebSocketOpen=function(U){this._status=f.c.kBuffering},O.prototype._onWebSocketClose=function(U){this._requestAbort!==!0?(this._status=f.c.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)):this._requestAbort=!1},O.prototype._onWebSocketMessage=function(U){var I=this;if(U.data instanceof ArrayBuffer)this._dispatchArrayBuffer(U.data);else if(U.data instanceof Blob){var F=new FileReader;F.onload=function(){I._dispatchArrayBuffer(F.result)},F.readAsArrayBuffer(U.data)}else{this._status=f.c.kError;var te={code:-1,msg:"Unsupported WebSocket message type: "+U.data.constructor.name};if(!this._onError)throw new m.d(te.msg);this._onError(f.b.EXCEPTION,te)}},O.prototype._dispatchArrayBuffer=function(U){var I=U,F=this._receivedLength;this._receivedLength+=I.byteLength,this._onDataArrival&&this._onDataArrival(I,F,this._receivedLength)},O.prototype._onWebSocketError=function(U){this._status=f.c.kError;var I={code:U.code,msg:U.message};if(!this._onError)throw new m.d(I.msg);this._onError(f.b.EXCEPTION,I)},O})(f.a),R=(function(){function D(O){this._zeroStart=O||!1}return D.prototype.getConfig=function(O,U){var I={};if(U.from!==0||U.to!==-1){var F=void 0;F=U.to!==-1?"bytes=".concat(U.from.toString(),"-").concat(U.to.toString()):"bytes=".concat(U.from.toString(),"-"),I.Range=F}else this._zeroStart&&(I.Range="bytes=0-");return{url:O,headers:I}},D.prototype.removeURLParameters=function(O){return O},D})(),K=(function(){function D(O,U){this._startName=O,this._endName=U}return D.prototype.getConfig=function(O,U){var I=O;if(U.from!==0||U.to!==-1){var F=!0;I.indexOf("?")===-1&&(I+="?",F=!1),F&&(I+="&"),I+="".concat(this._startName,"=").concat(U.from.toString()),U.to!==-1&&(I+="&".concat(this._endName,"=").concat(U.to.toString()))}return{url:I,headers:{}}},D.prototype.removeURLParameters=function(O){var U=O.split("?")[0],I=void 0,F=O.indexOf("?");F!==-1&&(I=O.substring(F+1));var te="";if(I!=null&&I.length>0)for(var le=I.split("&"),H=0;H<le.length;H++){var X=le[H].split("="),q=H>0;X[0]!==this._startName&&X[0]!==this._endName&&(q&&(te+="&"),te+=le[H])}return te.length===0?U:U+"?"+te},D})(),z=(function(){function D(O,U,I){this.TAG="IOController",this._config=U,this._extraData=I,this._stashInitialSize=65536,U.stashInitialSize!=null&&U.stashInitialSize>0&&(this._stashInitialSize=U.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=Math.max(this._stashSize,3145728),this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,U.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=O,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(O.url),this._refTotalLength=O.filesize?O.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new d,this._speedNormalizeList=[32,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return D.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},D.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},D.prototype.isPaused=function(){return this._paused},Object.defineProperty(D.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"extraData",{get:function(){return this._extraData},set:function(O){this._extraData=O},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(O){this._onDataArrival=O},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(O){this._onSeeked=O},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"onError",{get:function(){return this._onError},set:function(O){this._onError=O},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"onComplete",{get:function(){return this._onComplete},set:function(O){this._onComplete=O},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(O){this._onRedirect=O},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(O){this._onRecoveredEarlyEof=O},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"currentSpeed",{get:function(){return this._loaderClass===T?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),D.prototype._selectSeekHandler=function(){var O=this._config;if(O.seekType==="range")this._seekHandler=new R(this._config.rangeLoadZeroStart);else if(O.seekType==="param"){var U=O.seekParamStart||"bstart",I=O.seekParamEnd||"bend";this._seekHandler=new K(U,I)}else{if(O.seekType!=="custom")throw new m.b("Invalid seekType in config: ".concat(O.seekType));if(typeof O.customSeekHandler!="function")throw new m.b("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new O.customSeekHandler}},D.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=E;else if(x.isSupported())this._loaderClass=x;else if(v.isSupported())this._loaderClass=v;else{if(!T.isSupported())throw new m.d("Your browser doesn't support xhr with arraybuffer responseType!");this._loaderClass=T}},D.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},D.prototype.open=function(O){this._currentRange={from:0,to:-1},O&&(this._currentRange.from=O),this._speedSampler.reset(),O||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},D.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},D.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},D.prototype.resume=function(){if(this._paused){this._paused=!1;var O=this._resumeFrom;this._resumeFrom=0,this._internalSeek(O,!0)}},D.prototype.seek=function(O){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(O,!0)},D.prototype._internalSeek=function(O,U){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(U),this._loader.destroy(),this._loader=null;var I={from:O,to:-1};this._currentRange={from:I.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,I),this._onSeeked&&this._onSeeked()},D.prototype.updateUrl=function(O){if(!O||typeof O!="string"||O.length===0)throw new m.b("Url must be a non-empty string!");this._dataSource.url=O},D.prototype._expandBuffer=function(O){for(var U=this._stashSize;U+1048576<O;)U*=2;if((U+=1048576)!==this._bufferSize){var I=new ArrayBuffer(U);if(this._stashUsed>0){var F=new Uint8Array(this._stashBuffer,0,this._stashUsed);new Uint8Array(I,0,U).set(F,0)}this._stashBuffer=I,this._bufferSize=U}},D.prototype._normalizeSpeed=function(O){var U=this._speedNormalizeList,I=U.length-1,F=0,te=0,le=I;if(O<U[0])return U[0];for(;te<=le;){if((F=te+Math.floor((le-te)/2))===I||O>=U[F]&&O<U[F+1])return U[F];U[F]<O?te=F+1:le=F-1}},D.prototype._adjustStashSize=function(O){var U=0;(U=this._config.isLive?O/8:O<512?O:O>=512&&O<=1024?Math.floor(1.5*O):2*O)>8192&&(U=8192);var I=1024*U+1048576;this._bufferSize<I&&this._expandBuffer(I),this._stashSize=1024*U},D.prototype._dispatchChunks=function(O,U){return this._currentRange.to=U+O.byteLength-1,this._onDataArrival(O,U)},D.prototype._onURLRedirect=function(O){this._redirectedURL=O,this._onRedirect&&this._onRedirect(O)},D.prototype._onContentLengthKnown=function(O){O&&this._fullRequestFlag&&(this._totalLength=O,this._fullRequestFlag=!1)},D.prototype._onLoaderChunkArrival=function(O,U,I){if(!this._onDataArrival)throw new m.a("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(O.byteLength);var F=this._speedSampler.lastSecondKBps;if(F!==0){var te=this._normalizeSpeed(F);this._speedNormalized!==te&&(this._speedNormalized=te,this._adjustStashSize(te))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=U),this._stashUsed+O.byteLength<=this._stashSize)(X=new Uint8Array(this._stashBuffer,0,this._stashSize)).set(new Uint8Array(O),this._stashUsed),this._stashUsed+=O.byteLength;else if(X=new Uint8Array(this._stashBuffer,0,this._bufferSize),this._stashUsed>0){var le=this._stashBuffer.slice(0,this._stashUsed);(q=this._dispatchChunks(le,this._stashByteStart))<le.byteLength?q>0&&(ae=new Uint8Array(le,q),X.set(ae,0),this._stashUsed=ae.byteLength,this._stashByteStart+=q):(this._stashUsed=0,this._stashByteStart+=q),this._stashUsed+O.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+O.byteLength),X=new Uint8Array(this._stashBuffer,0,this._bufferSize)),X.set(new Uint8Array(O),this._stashUsed),this._stashUsed+=O.byteLength}else(q=this._dispatchChunks(O,U))<O.byteLength&&((H=O.byteLength-q)>this._bufferSize&&(this._expandBuffer(H),X=new Uint8Array(this._stashBuffer,0,this._bufferSize)),X.set(new Uint8Array(O,q),0),this._stashUsed+=H,this._stashByteStart=U+q);else if(this._stashUsed===0){var H;(q=this._dispatchChunks(O,U))<O.byteLength&&((H=O.byteLength-q)>this._bufferSize&&this._expandBuffer(H),(X=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(O,q),0),this._stashUsed+=H,this._stashByteStart=U+q)}else{var X,q;if(this._stashUsed+O.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+O.byteLength),(X=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(O),this._stashUsed),this._stashUsed+=O.byteLength,(q=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart))<this._stashUsed&&q>0){var ae=new Uint8Array(this._stashBuffer,q);X.set(ae,0)}this._stashUsed-=q,this._stashByteStart+=q}}},D.prototype._flushStashBuffer=function(O){if(this._stashUsed>0){var U=this._stashBuffer.slice(0,this._stashUsed),I=this._dispatchChunks(U,this._stashByteStart),F=U.byteLength-I;if(I<U.byteLength){if(!O){if(I>0){var te=new Uint8Array(this._stashBuffer,0,this._bufferSize),le=new Uint8Array(U,I);te.set(le,0),this._stashUsed=le.byteLength,this._stashByteStart+=I}return 0}c.a.w(this.TAG,"".concat(F," bytes unconsumed data remain when flush buffer, dropped"))}return this._stashUsed=0,this._stashByteStart=0,F}return 0},D.prototype._onLoaderComplete=function(O,U){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},D.prototype._onLoaderError=function(O,U){switch(c.a.e(this.TAG,"Loader error, code = ".concat(U.code,", msg = ").concat(U.msg)),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,O=f.b.UNRECOVERABLE_EARLY_EOF),O){case f.b.EARLY_EOF:if(!this._config.isLive&&this._totalLength){var I=this._currentRange.to+1;return void(I<this._totalLength&&(c.a.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(I,!1)))}O=f.b.UNRECOVERABLE_EARLY_EOF;break;case f.b.UNRECOVERABLE_EARLY_EOF:case f.b.CONNECTING_TIMEOUT:case f.b.HTTP_STATUS_CODE_INVALID:case f.b.EXCEPTION:}if(!this._onError)throw new m.d("IOException: "+U.msg);this._onError(O,U)},D})();r.a=z},function(s,r,n){var o=(function(){function c(){}return c.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(d,f){return d.__proto__=f,d},Object.assign=Object.assign||function(d){if(d==null)throw new TypeError("Cannot convert undefined or null to object");for(var f=Object(d),u=1;u<arguments.length;u++){var m=arguments[u];if(m!=null)for(var g in m)m.hasOwnProperty(g)&&(f[g]=m[g])}return f},String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(d,f){var u=f>0?0|f:0;return this.substring(u,u+d.length)===d}}),typeof self.Promise!="function"&&n(21).polyfill()},c})();o.install(),r.a=o},function(s,r,n){var o=n(9),c=n.n(o),d=n(0),f=n(5),u=n(7),m=n(3),g=(function(){function x(b){this.TAG="MSEController",this._config=b,this._emitter=new c.a,this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onStartStreaming:this._onStartStreaming.bind(this),onEndStreaming:this._onEndStreaming.bind(this),onQualityChange:this._onQualityChange.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._useManagedMediaSource="ManagedMediaSource"in self&&!("MediaSource"in self),this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElementProxy=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]}}return x.prototype.destroy=function(){this._mediaSource&&this.shutdown(),this._mediaSourceObjectURL&&this.revokeObjectURL(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},x.prototype.on=function(b,v){this._emitter.addListener(b,v)},x.prototype.off=function(b,v){this._emitter.removeListener(b,v)},x.prototype.initialize=function(b){if(this._mediaSource)throw new m.a("MediaSource has been attached to an HTMLMediaElement!");this._useManagedMediaSource&&d.a.v(this.TAG,"Using ManagedMediaSource");var v=this._mediaSource=this._useManagedMediaSource?new self.ManagedMediaSource:new self.MediaSource;v.addEventListener("sourceopen",this.e.onSourceOpen),v.addEventListener("sourceended",this.e.onSourceEnded),v.addEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(v.addEventListener("startstreaming",this.e.onStartStreaming),v.addEventListener("endstreaming",this.e.onEndStreaming),v.addEventListener("qualitychange",this.e.onQualityChange)),this._mediaElementProxy=b},x.prototype.shutdown=function(){if(this._mediaSource){var b=this._mediaSource;for(var v in this._sourceBuffers){var w=this._pendingSegments[v];w.splice(0,w.length),this._pendingSegments[v]=null,this._pendingRemoveRanges[v]=null,this._lastInitSegments[v]=null;var S=this._sourceBuffers[v];if(S){if(b.readyState!=="closed"){try{b.removeSourceBuffer(S)}catch(T){d.a.e(this.TAG,T.message)}S.removeEventListener("error",this.e.onSourceBufferError),S.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[v]=null,this._sourceBuffers[v]=null}}if(b.readyState==="open")try{b.endOfStream()}catch(T){d.a.e(this.TAG,T.message)}this._mediaElementProxy=null,b.removeEventListener("sourceopen",this.e.onSourceOpen),b.removeEventListener("sourceended",this.e.onSourceEnded),b.removeEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(b.removeEventListener("startstreaming",this.e.onStartStreaming),b.removeEventListener("endstreaming",this.e.onEndStreaming),b.removeEventListener("qualitychange",this.e.onQualityChange)),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._mediaSource=null}},x.prototype.isManagedMediaSource=function(){return this._useManagedMediaSource},x.prototype.getObject=function(){if(!this._mediaSource)throw new m.a("MediaSource has not been initialized yet!");return this._mediaSource},x.prototype.getHandle=function(){if(!this._mediaSource)throw new m.a("MediaSource has not been initialized yet!");return this._mediaSource.handle},x.prototype.getObjectURL=function(){if(!this._mediaSource)throw new m.a("MediaSource has not been initialized yet!");return this._mediaSourceObjectURL==null&&(this._mediaSourceObjectURL=URL.createObjectURL(this._mediaSource)),this._mediaSourceObjectURL},x.prototype.revokeObjectURL=function(){this._mediaSourceObjectURL&&(URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},x.prototype.appendInitSegment=function(b,v){if(v===void 0&&(v=void 0),!this._mediaSource||this._mediaSource.readyState!=="open"||this._mediaSource.streaming===!1)return this._pendingSourceBufferInit.push(b),void this._pendingSegments[b.type].push(b);var w=b,S="".concat(w.container);w.codec&&w.codec.length>0&&(w.codec==="opus"&&f.a.safari&&(w.codec="Opus"),S+=";codecs=".concat(w.codec));var T=!1;if(d.a.v(this.TAG,"Received Initialization Segment, mimeType: "+S),this._lastInitSegments[w.type]=w,S!==this._mimeTypes[w.type]){if(this._mimeTypes[w.type])d.a.v(this.TAG,"Notice: ".concat(w.type," mimeType changed, origin: ").concat(this._mimeTypes[w.type],", target: ").concat(S));else{T=!0;try{var k=this._sourceBuffers[w.type]=this._mediaSource.addSourceBuffer(S);k.addEventListener("error",this.e.onSourceBufferError),k.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(E){return d.a.e(this.TAG,E.message),void this._emitter.emit(u.a.ERROR,{code:E.code,msg:E.message})}}this._mimeTypes[w.type]=S}v||this._pendingSegments[w.type].push(w),T||this._sourceBuffers[w.type]&&!this._sourceBuffers[w.type].updating&&this._doAppendSegments(),f.a.safari&&w.container==="audio/mpeg"&&w.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=w.mediaDuration/1e3,this._updateMediaSourceDuration())},x.prototype.appendMediaSegment=function(b){var v=b;this._pendingSegments[v.type].push(v),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var w=this._sourceBuffers[v.type];!w||w.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()},x.prototype.flush=function(){for(var b in this._sourceBuffers)if(this._sourceBuffers[b]){var v=this._sourceBuffers[b];if(this._mediaSource.readyState==="open")try{v.abort()}catch(R){d.a.e(this.TAG,R.message)}var w=this._pendingSegments[b];if(w.splice(0,w.length),this._mediaSource.readyState!=="closed"){for(var S=0;S<v.buffered.length;S++){var T=v.buffered.start(S),k=v.buffered.end(S);this._pendingRemoveRanges[b].push({start:T,end:k})}if(v.updating||this._doRemoveRanges(),f.a.safari){var E=this._lastInitSegments[b];E&&(this._pendingSegments[b].push(E),v.updating||this._doAppendSegments())}}}},x.prototype.endOfStream=function(){var b=this._mediaSource,v=this._sourceBuffers;b&&b.readyState==="open"?v.video&&v.video.updating||v.audio&&v.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,b.endOfStream()):b&&b.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0)},x.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var b=this._mediaElementProxy.getCurrentTime();for(var v in this._sourceBuffers){var w=this._sourceBuffers[v];if(w){var S=w.buffered;if(S.length>=1&&b-S.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},x.prototype._doCleanupSourceBuffer=function(){var b=this._mediaElementProxy.getCurrentTime();for(var v in this._sourceBuffers){var w=this._sourceBuffers[v];if(w){for(var S=w.buffered,T=!1,k=0;k<S.length;k++){var E=S.start(k),R=S.end(k);if(E<=b&&b<R+3){if(b-E>=this._config.autoCleanupMaxBackwardDuration){T=!0;var K=b-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[v].push({start:E,end:K})}}else R<b&&(T=!0,this._pendingRemoveRanges[v].push({start:E,end:R}))}T&&!w.updating&&this._doRemoveRanges()}}},x.prototype._updateMediaSourceDuration=function(){var b=this._sourceBuffers;if(this._mediaElementProxy.getReadyState()!==0&&this._mediaSource.readyState==="open"&&!(b.video&&b.video.updating||b.audio&&b.audio.updating)){var v=this._mediaSource.duration,w=this._pendingMediaDuration;w>0&&(isNaN(v)||w>v)&&(d.a.v(this.TAG,"Update MediaSource duration from ".concat(v," to ").concat(w)),this._mediaSource.duration=w),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},x.prototype._doRemoveRanges=function(){for(var b in this._pendingRemoveRanges)if(this._sourceBuffers[b]&&!this._sourceBuffers[b].updating)for(var v=this._sourceBuffers[b],w=this._pendingRemoveRanges[b];w.length&&!v.updating;){var S=w.shift();v.remove(S.start,S.end)}},x.prototype._doAppendSegments=function(){var b=this._pendingSegments;for(var v in b)if(this._sourceBuffers[v]&&!this._sourceBuffers[v].updating&&this._mediaSource.streaming!==!1&&b[v].length>0){var w=b[v].shift();if(typeof w.timestampOffset=="number"&&isFinite(w.timestampOffset)){var S=this._sourceBuffers[v].timestampOffset,T=w.timestampOffset/1e3;Math.abs(S-T)>.1&&(d.a.v(this.TAG,"Update MPEG audio timestampOffset from ".concat(S," to ").concat(T)),this._sourceBuffers[v].timestampOffset=T),delete w.timestampOffset}if(!w.data||w.data.byteLength===0)continue;try{this._sourceBuffers[v].appendBuffer(w.data),this._isBufferFull=!1}catch(k){this._pendingSegments[v].unshift(w),k.code===22?(this._isBufferFull||this._emitter.emit(u.a.BUFFER_FULL),this._isBufferFull=!0):(d.a.e(this.TAG,k.message),this._emitter.emit(u.a.ERROR,{code:k.code,msg:k.message}))}}},x.prototype._onSourceOpen=function(){if(d.a.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var b=this._pendingSourceBufferInit;b.length;){var v=b.shift();this.appendInitSegment(v,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(u.a.SOURCE_OPEN)},x.prototype._onStartStreaming=function(){d.a.v(this.TAG,"ManagedMediaSource onStartStreaming"),this._emitter.emit(u.a.START_STREAMING)},x.prototype._onEndStreaming=function(){d.a.v(this.TAG,"ManagedMediaSource onEndStreaming"),this._emitter.emit(u.a.END_STREAMING)},x.prototype._onQualityChange=function(){d.a.v(this.TAG,"ManagedMediaSource onQualityChange")},x.prototype._onSourceEnded=function(){d.a.v(this.TAG,"MediaSource onSourceEnded")},x.prototype._onSourceClose=function(){d.a.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose),this._useManagedMediaSource&&(this._mediaSource.removeEventListener("startstreaming",this.e.onStartStreaming),this._mediaSource.removeEventListener("endstreaming",this.e.onEndStreaming),this._mediaSource.removeEventListener("qualitychange",this.e.onQualityChange)))},x.prototype._hasPendingSegments=function(){var b=this._pendingSegments;return b.video.length>0||b.audio.length>0},x.prototype._hasPendingRemoveRanges=function(){var b=this._pendingRemoveRanges;return b.video.length>0||b.audio.length>0},x.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(u.a.UPDATE_END)},x.prototype._onSourceBufferError=function(b){d.a.e(this.TAG,"SourceBuffer Error: ".concat(b))},x})();r.a=g},function(s,r,n){var o=n(9),c=n.n(o),d=n(18),f=n.n(d),u=n(0),m=n(8),g=n(13),x=n(1),b=(n(19),n(12)),v=(function(){function w(S,T){if(this.TAG="Transmuxer",this._emitter=new c.a,T.enableWorker&&typeof Worker<"u")try{this._worker=f()(19),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[S,T]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},m.a.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:m.a.getConfig()})}catch{u.a.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new g.a(S,T)}else this._controller=new g.a(S,T);if(this._controller){var k=this._controller;k.on(x.a.IO_ERROR,this._onIOError.bind(this)),k.on(x.a.DEMUX_ERROR,this._onDemuxError.bind(this)),k.on(x.a.INIT_SEGMENT,this._onInitSegment.bind(this)),k.on(x.a.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),k.on(x.a.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),k.on(x.a.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),k.on(x.a.MEDIA_INFO,this._onMediaInfo.bind(this)),k.on(x.a.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),k.on(x.a.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),k.on(x.a.TIMED_ID3_METADATA_ARRIVED,this._onTimedID3MetadataArrived.bind(this)),k.on(x.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,this._onSynchronousKLVMetadataArrived.bind(this)),k.on(x.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,this._onAsynchronousKLVMetadataArrived.bind(this)),k.on(x.a.SMPTE2038_METADATA_ARRIVED,this._onSMPTE2038MetadataArrived.bind(this)),k.on(x.a.SCTE35_METADATA_ARRIVED,this._onSCTE35MetadataArrived.bind(this)),k.on(x.a.PES_PRIVATE_DATA_DESCRIPTOR,this._onPESPrivateDataDescriptor.bind(this)),k.on(x.a.PES_PRIVATE_DATA_ARRIVED,this._onPESPrivateDataArrived.bind(this)),k.on(x.a.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),k.on(x.a.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return w.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),m.a.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},w.prototype.on=function(S,T){this._emitter.addListener(S,T)},w.prototype.off=function(S,T){this._emitter.removeListener(S,T)},w.prototype.hasWorker=function(){return this._worker!=null},w.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},w.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},w.prototype.seek=function(S){this._worker?this._worker.postMessage({cmd:"seek",param:S}):this._controller.seek(S)},w.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},w.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},w.prototype._onInitSegment=function(S,T){var k=this;Promise.resolve().then((function(){k._emitter.emit(x.a.INIT_SEGMENT,S,T)}))},w.prototype._onMediaSegment=function(S,T){var k=this;Promise.resolve().then((function(){k._emitter.emit(x.a.MEDIA_SEGMENT,S,T)}))},w.prototype._onLoadingComplete=function(){var S=this;Promise.resolve().then((function(){S._emitter.emit(x.a.LOADING_COMPLETE)}))},w.prototype._onRecoveredEarlyEof=function(){var S=this;Promise.resolve().then((function(){S._emitter.emit(x.a.RECOVERED_EARLY_EOF)}))},w.prototype._onMediaInfo=function(S){var T=this;Promise.resolve().then((function(){T._emitter.emit(x.a.MEDIA_INFO,S)}))},w.prototype._onMetaDataArrived=function(S){var T=this;Promise.resolve().then((function(){T._emitter.emit(x.a.METADATA_ARRIVED,S)}))},w.prototype._onScriptDataArrived=function(S){var T=this;Promise.resolve().then((function(){T._emitter.emit(x.a.SCRIPTDATA_ARRIVED,S)}))},w.prototype._onTimedID3MetadataArrived=function(S){var T=this;Promise.resolve().then((function(){T._emitter.emit(x.a.TIMED_ID3_METADATA_ARRIVED,S)}))},w.prototype._onSynchronousKLVMetadataArrived=function(S){var T=this;Promise.resolve().then((function(){T._emitter.emit(x.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,S)}))},w.prototype._onAsynchronousKLVMetadataArrived=function(S){var T=this;Promise.resolve().then((function(){T._emitter.emit(x.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,S)}))},w.prototype._onSMPTE2038MetadataArrived=function(S){var T=this;Promise.resolve().then((function(){T._emitter.emit(x.a.SMPTE2038_METADATA_ARRIVED,S)}))},w.prototype._onSCTE35MetadataArrived=function(S){var T=this;Promise.resolve().then((function(){T._emitter.emit(x.a.SCTE35_METADATA_ARRIVED,S)}))},w.prototype._onPESPrivateDataDescriptor=function(S){var T=this;Promise.resolve().then((function(){T._emitter.emit(x.a.PES_PRIVATE_DATA_DESCRIPTOR,S)}))},w.prototype._onPESPrivateDataArrived=function(S){var T=this;Promise.resolve().then((function(){T._emitter.emit(x.a.PES_PRIVATE_DATA_ARRIVED,S)}))},w.prototype._onStatisticsInfo=function(S){var T=this;Promise.resolve().then((function(){T._emitter.emit(x.a.STATISTICS_INFO,S)}))},w.prototype._onIOError=function(S,T){var k=this;Promise.resolve().then((function(){k._emitter.emit(x.a.IO_ERROR,S,T)}))},w.prototype._onDemuxError=function(S,T){var k=this;Promise.resolve().then((function(){k._emitter.emit(x.a.DEMUX_ERROR,S,T)}))},w.prototype._onRecommendSeekpoint=function(S){var T=this;Promise.resolve().then((function(){T._emitter.emit(x.a.RECOMMEND_SEEKPOINT,S)}))},w.prototype._onLoggingConfigChanged=function(S){this._worker&&this._worker.postMessage({cmd:"logging_config",param:S})},w.prototype._onWorkerMessage=function(S){var T=S.data,k=T.data;if(T.msg==="destroyed"||this._workerDestroying)return this._workerDestroying=!1,this._worker.terminate(),void(this._worker=null);switch(T.msg){case x.a.INIT_SEGMENT:case x.a.MEDIA_SEGMENT:this._emitter.emit(T.msg,k.type,k.data);break;case x.a.LOADING_COMPLETE:case x.a.RECOVERED_EARLY_EOF:this._emitter.emit(T.msg);break;case x.a.MEDIA_INFO:Object.setPrototypeOf(k,b.a.prototype),this._emitter.emit(T.msg,k);break;case x.a.METADATA_ARRIVED:case x.a.SCRIPTDATA_ARRIVED:case x.a.TIMED_ID3_METADATA_ARRIVED:case x.a.SYNCHRONOUS_KLV_METADATA_ARRIVED:case x.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED:case x.a.SMPTE2038_METADATA_ARRIVED:case x.a.SCTE35_METADATA_ARRIVED:case x.a.PES_PRIVATE_DATA_DESCRIPTOR:case x.a.PES_PRIVATE_DATA_ARRIVED:case x.a.STATISTICS_INFO:this._emitter.emit(T.msg,k);break;case x.a.IO_ERROR:case x.a.DEMUX_ERROR:this._emitter.emit(T.msg,k.type,k.info);break;case x.a.RECOMMEND_SEEKPOINT:this._emitter.emit(T.msg,k);break;case"logcat_callback":u.a.emitter.emit("log",k.type,k.logcat)}},w})();r.a=v},function(s,r,n){function o(u){var m={};function g(b){if(m[b])return m[b].exports;var v=m[b]={i:b,l:!1,exports:{}};return u[b].call(v.exports,v,v.exports,g),v.l=!0,v.exports}g.m=u,g.c=m,g.i=function(b){return b},g.d=function(b,v,w){g.o(b,v)||Object.defineProperty(b,v,{configurable:!1,enumerable:!0,get:w})},g.r=function(b){Object.defineProperty(b,"__esModule",{value:!0})},g.n=function(b){var v=b&&b.__esModule?function(){return b.default}:function(){return b};return g.d(v,"a",v),v},g.o=function(b,v){return Object.prototype.hasOwnProperty.call(b,v)},g.p="/",g.oe=function(b){throw console.error(b),b};var x=g(g.s=ENTRY_MODULE);return x.default||x}function c(u){return(u+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function d(u,m,g){var x={};x[g]=[];var b=m.toString(),v=b.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!v)return x;for(var w,S=v[1],T=new RegExp("(\\\\n|\\W)"+c(S)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");w=T.exec(b);)w[3]!=="dll-reference"&&x[g].push(w[3]);for(T=new RegExp("\\("+c(S)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");w=T.exec(b);)u[w[2]]||(x[g].push(w[1]),u[w[2]]=n(w[1]).m),x[w[2]]=x[w[2]]||[],x[w[2]].push(w[4]);for(var k,E=Object.keys(x),R=0;R<E.length;R++)for(var K=0;K<x[E[R]].length;K++)k=x[E[R]][K],isNaN(1*k)||(x[E[R]][K]=1*x[E[R]][K]);return x}function f(u){return Object.keys(u).reduce((function(m,g){return m||u[g].length>0}),!1)}s.exports=function(u,m){m=m||{};var g={main:n.m},x=m.all?{main:Object.keys(g.main)}:(function(T,k){for(var E={main:[k]},R={main:[]},K={main:{}};f(E);)for(var z=Object.keys(E),D=0;D<z.length;D++){var O=z[D],U=E[O].pop();if(K[O]=K[O]||{},!K[O][U]&&T[O][U]){K[O][U]=!0,R[O]=R[O]||[],R[O].push(U);for(var I=d(T,T[O][U],O),F=Object.keys(I),te=0;te<F.length;te++)E[F[te]]=E[F[te]]||[],E[F[te]]=E[F[te]].concat(I[F[te]])}}return R})(g,u),b="";Object.keys(x).filter((function(T){return T!=="main"})).forEach((function(T){for(var k=0;x[T][k];)k++;x[T].push(k),g[T][k]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",b=b+"var "+T+" = ("+o.toString().replace("ENTRY_MODULE",JSON.stringify(k))+")({"+x[T].map((function(E){return JSON.stringify(E)+": "+g[T][E].toString()})).join(",")+`});
`})),b=b+"new (("+o.toString().replace("ENTRY_MODULE",JSON.stringify(u))+")({"+x.main.map((function(T){return JSON.stringify(T)+": "+g.main[T].toString()})).join(",")+"}))(self);";var v=new self.Blob([b],{type:"text/javascript"});if(m.bare)return v;var w=(self.URL||self.webkitURL||self.mozURL||self.msURL).createObjectURL(v),S=new self.Worker(w);return S.objectURL=w,S}},function(s,r,n){n.r(r),n(0);var o=n(8),c=n(15),d=n(13),f=n(1);r.default=function(u){var m=null,g=(function(H,X){u.postMessage({msg:"logcat_callback",data:{type:H,logcat:X}})}).bind(this);function x(H,X){var q={msg:f.a.INIT_SEGMENT,data:{type:H,data:X}};u.postMessage(q,[X.data])}function b(H,X){var q={msg:f.a.MEDIA_SEGMENT,data:{type:H,data:X}};u.postMessage(q,[X.data])}function v(){var H={msg:f.a.LOADING_COMPLETE};u.postMessage(H)}function w(){var H={msg:f.a.RECOVERED_EARLY_EOF};u.postMessage(H)}function S(H){var X={msg:f.a.MEDIA_INFO,data:H};u.postMessage(X)}function T(H){var X={msg:f.a.METADATA_ARRIVED,data:H};u.postMessage(X)}function k(H){var X={msg:f.a.SCRIPTDATA_ARRIVED,data:H};u.postMessage(X)}function E(H){var X={msg:f.a.TIMED_ID3_METADATA_ARRIVED,data:H};u.postMessage(X)}function R(H){var X={msg:f.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,data:H};u.postMessage(X)}function K(H){var X={msg:f.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,data:H};u.postMessage(X)}function z(H){var X={msg:f.a.SMPTE2038_METADATA_ARRIVED,data:H};u.postMessage(X)}function D(H){var X={msg:f.a.SCTE35_METADATA_ARRIVED,data:H};u.postMessage(X)}function O(H){var X={msg:f.a.PES_PRIVATE_DATA_DESCRIPTOR,data:H};u.postMessage(X)}function U(H){var X={msg:f.a.PES_PRIVATE_DATA_ARRIVED,data:H};u.postMessage(X)}function I(H){var X={msg:f.a.STATISTICS_INFO,data:H};u.postMessage(X)}function F(H,X){u.postMessage({msg:f.a.IO_ERROR,data:{type:H,info:X}})}function te(H,X){u.postMessage({msg:f.a.DEMUX_ERROR,data:{type:H,info:X}})}function le(H){u.postMessage({msg:f.a.RECOMMEND_SEEKPOINT,data:H})}c.a.install(),u.addEventListener("message",(function(H){switch(H.data.cmd){case"init":(m=new d.a(H.data.param[0],H.data.param[1])).on(f.a.IO_ERROR,F.bind(this)),m.on(f.a.DEMUX_ERROR,te.bind(this)),m.on(f.a.INIT_SEGMENT,x.bind(this)),m.on(f.a.MEDIA_SEGMENT,b.bind(this)),m.on(f.a.LOADING_COMPLETE,v.bind(this)),m.on(f.a.RECOVERED_EARLY_EOF,w.bind(this)),m.on(f.a.MEDIA_INFO,S.bind(this)),m.on(f.a.METADATA_ARRIVED,T.bind(this)),m.on(f.a.SCRIPTDATA_ARRIVED,k.bind(this)),m.on(f.a.TIMED_ID3_METADATA_ARRIVED,E.bind(this)),m.on(f.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,R.bind(this)),m.on(f.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,K.bind(this)),m.on(f.a.SMPTE2038_METADATA_ARRIVED,z.bind(this)),m.on(f.a.SCTE35_METADATA_ARRIVED,D.bind(this)),m.on(f.a.PES_PRIVATE_DATA_DESCRIPTOR,O.bind(this)),m.on(f.a.PES_PRIVATE_DATA_ARRIVED,U.bind(this)),m.on(f.a.STATISTICS_INFO,I.bind(this)),m.on(f.a.RECOMMEND_SEEKPOINT,le.bind(this));break;case"destroy":m&&(m.destroy(),m=null),u.postMessage({msg:"destroyed"});break;case"start":m.start();break;case"stop":m.stop();break;case"seek":m.seek(H.data.param);break;case"pause":m.pause();break;case"resume":m.resume();break;case"logging_config":var X=H.data.param;o.a.applyConfig(X),X.enableCallback===!0?o.a.addLogListener(g):o.a.removeLogListener(g)}}))}},function(s,r,n){s.exports=n(25).default},function(s,r,n){(function(o,c){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var d;d=function(){function f(xe){return typeof xe=="function"}var u=Array.isArray?Array.isArray:function(xe){return Object.prototype.toString.call(xe)==="[object Array]"},m=0,g=void 0,x=void 0,b=function(xe,Ee){R[m]=xe,R[m+1]=Ee,(m+=2)===2&&(x?x(K):I())},v=typeof window<"u"?window:void 0,w=v||{},S=w.MutationObserver||w.WebKitMutationObserver,T=typeof self>"u"&&o!==void 0&&{}.toString.call(o)==="[object process]",k=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function E(){var xe=setTimeout;return function(){return xe(K,1)}}var R=new Array(1e3);function K(){for(var xe=0;xe<m;xe+=2)(0,R[xe])(R[xe+1]),R[xe]=void 0,R[xe+1]=void 0;m=0}var z,D,O,U,I=void 0;function F(xe,Ee){var Pe=this,Re=new this.constructor(H);Re[le]===void 0&&oe(Re);var Qe=Pe._state;if(Qe){var ot=arguments[Qe-1];b((function(){return G(Qe,Re,ot,Pe._result)}))}else W(Pe,Re,xe,Ee);return Re}function te(xe){if(xe&&typeof xe=="object"&&xe.constructor===this)return xe;var Ee=new this(H);return q(Ee,xe),Ee}T?I=function(){return o.nextTick(K)}:S?(D=0,O=new S(K),U=document.createTextNode(""),O.observe(U,{characterData:!0}),I=function(){U.data=D=++D%2}):k?((z=new MessageChannel).port1.onmessage=K,I=function(){return z.port2.postMessage(0)}):I=v===void 0?(function(){try{var xe=Function("return this")().require("vertx");return(g=xe.runOnLoop||xe.runOnContext)!==void 0?function(){g(K)}:E()}catch{return E()}})():E();var le=Math.random().toString(36).substring(2);function H(){}function X(xe,Ee,Pe){Ee.constructor===xe.constructor&&Pe===F&&Ee.constructor.resolve===te?(function(Re,Qe){Qe._state===1?ce(Re,Qe._result):Qe._state===2?ee(Re,Qe._result):W(Qe,void 0,(function(ot){return q(Re,ot)}),(function(ot){return ee(Re,ot)}))})(xe,Ee):Pe===void 0?ce(xe,Ee):f(Pe)?(function(Re,Qe,ot){b((function(ne){var ke=!1,Be=(function(qe,dt,He,Ce){try{qe.call(dt,He,Ce)}catch(_e){return _e}})(ot,Qe,(function(qe){ke||(ke=!0,Qe!==qe?q(ne,qe):ce(ne,qe))}),(function(qe){ke||(ke=!0,ee(ne,qe))}),ne._label);!ke&&Be&&(ke=!0,ee(ne,Be))}),Re)})(xe,Ee,Pe):ce(xe,Ee)}function q(xe,Ee){if(xe===Ee)ee(xe,new TypeError("You cannot resolve a promise with itself"));else if(Qe=typeof(Re=Ee),Re===null||Qe!=="object"&&Qe!=="function")ce(xe,Ee);else{var Pe=void 0;try{Pe=Ee.then}catch(ot){return void ee(xe,ot)}X(xe,Ee,Pe)}var Re,Qe}function ae(xe){xe._onerror&&xe._onerror(xe._result),V(xe)}function ce(xe,Ee){xe._state===void 0&&(xe._result=Ee,xe._state=1,xe._subscribers.length!==0&&b(V,xe))}function ee(xe,Ee){xe._state===void 0&&(xe._state=2,xe._result=Ee,b(ae,xe))}function W(xe,Ee,Pe,Re){var Qe=xe._subscribers,ot=Qe.length;xe._onerror=null,Qe[ot]=Ee,Qe[ot+1]=Pe,Qe[ot+2]=Re,ot===0&&xe._state&&b(V,xe)}function V(xe){var Ee=xe._subscribers,Pe=xe._state;if(Ee.length!==0){for(var Re=void 0,Qe=void 0,ot=xe._result,ne=0;ne<Ee.length;ne+=3)Re=Ee[ne],Qe=Ee[ne+Pe],Re?G(Pe,Re,Qe,ot):Qe(ot);xe._subscribers.length=0}}function G(xe,Ee,Pe,Re){var Qe=f(Pe),ot=void 0,ne=void 0,ke=!0;if(Qe){try{ot=Pe(Re)}catch(Be){ke=!1,ne=Be}if(Ee===ot)return void ee(Ee,new TypeError("A promises callback cannot return that same promise."))}else ot=Re;Ee._state!==void 0||(Qe&&ke?q(Ee,ot):ke===!1?ee(Ee,ne):xe===1?ce(Ee,ot):xe===2&&ee(Ee,ot))}var Z=0;function oe(xe){xe[le]=Z++,xe._state=void 0,xe._result=void 0,xe._subscribers=[]}var ye=(function(){function xe(Ee,Pe){this._instanceConstructor=Ee,this.promise=new Ee(H),this.promise[le]||oe(this.promise),u(Pe)?(this.length=Pe.length,this._remaining=Pe.length,this._result=new Array(this.length),this.length===0?ce(this.promise,this._result):(this.length=this.length||0,this._enumerate(Pe),this._remaining===0&&ce(this.promise,this._result))):ee(this.promise,new Error("Array Methods must be provided an Array"))}return xe.prototype._enumerate=function(Ee){for(var Pe=0;this._state===void 0&&Pe<Ee.length;Pe++)this._eachEntry(Ee[Pe],Pe)},xe.prototype._eachEntry=function(Ee,Pe){var Re=this._instanceConstructor,Qe=Re.resolve;if(Qe===te){var ot=void 0,ne=void 0,ke=!1;try{ot=Ee.then}catch(qe){ke=!0,ne=qe}if(ot===F&&Ee._state!==void 0)this._settledAt(Ee._state,Pe,Ee._result);else if(typeof ot!="function")this._remaining--,this._result[Pe]=Ee;else if(Re===je){var Be=new Re(H);ke?ee(Be,ne):X(Be,Ee,ot),this._willSettleAt(Be,Pe)}else this._willSettleAt(new Re((function(qe){return qe(Ee)})),Pe)}else this._willSettleAt(Qe(Ee),Pe)},xe.prototype._settledAt=function(Ee,Pe,Re){var Qe=this.promise;Qe._state===void 0&&(this._remaining--,Ee===2?ee(Qe,Re):this._result[Pe]=Re),this._remaining===0&&ce(Qe,this._result)},xe.prototype._willSettleAt=function(Ee,Pe){var Re=this;W(Ee,void 0,(function(Qe){return Re._settledAt(1,Pe,Qe)}),(function(Qe){return Re._settledAt(2,Pe,Qe)}))},xe})(),je=(function(){function xe(Ee){this[le]=Z++,this._result=this._state=void 0,this._subscribers=[],H!==Ee&&(typeof Ee!="function"&&(function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")})(),this instanceof xe?(function(Pe,Re){try{Re((function(Qe){q(Pe,Qe)}),(function(Qe){ee(Pe,Qe)}))}catch(Qe){ee(Pe,Qe)}})(this,Ee):(function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")})())}return xe.prototype.catch=function(Ee){return this.then(null,Ee)},xe.prototype.finally=function(Ee){var Pe=this.constructor;return f(Ee)?this.then((function(Re){return Pe.resolve(Ee()).then((function(){return Re}))}),(function(Re){return Pe.resolve(Ee()).then((function(){throw Re}))})):this.then(Ee,Ee)},xe})();return je.prototype.then=F,je.all=function(xe){return new ye(this,xe).promise},je.race=function(xe){var Ee=this;return u(xe)?new Ee((function(Pe,Re){for(var Qe=xe.length,ot=0;ot<Qe;ot++)Ee.resolve(xe[ot]).then(Pe,Re)})):new Ee((function(Pe,Re){return Re(new TypeError("You must pass an array to race."))}))},je.resolve=te,je.reject=function(xe){var Ee=new this(H);return ee(Ee,xe),Ee},je._setScheduler=function(xe){x=xe},je._setAsap=function(xe){b=xe},je._asap=b,je.polyfill=function(){var xe=void 0;if(c!==void 0)xe=c;else if(typeof self<"u")xe=self;else try{xe=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var Ee=xe.Promise;if(Ee){var Pe=null;try{Pe=Object.prototype.toString.call(Ee.resolve())}catch{}if(Pe==="[object Promise]"&&!Ee.cast)return}xe.Promise=je},je.Promise=je,je},s.exports=d()}).call(this,n(22),n(23))},function(s,r){var n,o,c=s.exports={};function d(){throw new Error("setTimeout has not been defined")}function f(){throw new Error("clearTimeout has not been defined")}function u(k){if(n===setTimeout)return setTimeout(k,0);if((n===d||!n)&&setTimeout)return n=setTimeout,setTimeout(k,0);try{return n(k,0)}catch{try{return n.call(null,k,0)}catch{return n.call(this,k,0)}}}(function(){try{n=typeof setTimeout=="function"?setTimeout:d}catch{n=d}try{o=typeof clearTimeout=="function"?clearTimeout:f}catch{o=f}})();var m,g=[],x=!1,b=-1;function v(){x&&m&&(x=!1,m.length?g=m.concat(g):b=-1,g.length&&w())}function w(){if(!x){var k=u(v);x=!0;for(var E=g.length;E;){for(m=g,g=[];++b<E;)m&&m[b].run();b=-1,E=g.length}m=null,x=!1,(function(R){if(o===clearTimeout)return clearTimeout(R);if((o===f||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(R);try{o(R)}catch{try{return o.call(null,R)}catch{return o.call(this,R)}}})(k)}}function S(k,E){this.fun=k,this.array=E}function T(){}c.nextTick=function(k){var E=new Array(arguments.length-1);if(arguments.length>1)for(var R=1;R<arguments.length;R++)E[R-1]=arguments[R];g.push(new S(k,E)),g.length!==1||x||u(w)},S.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=T,c.addListener=T,c.once=T,c.off=T,c.removeListener=T,c.removeAllListeners=T,c.emit=T,c.prependListener=T,c.prependOnceListener=T,c.listeners=function(k){return[]},c.binding=function(k){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(k){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},function(s,r){var n;n=(function(){return this})();try{n=n||new Function("return this")()}catch{typeof window=="object"&&(n=window)}s.exports=n},function(s,r,n){n.r(r);var o=n(0),c=n(8),d=n(3),f=n(7),u=n(16),m=n(17),g=n(1),x=n(4),b=n(10);r.default=function(v){var w="PlayerEngineWorker",S=(function(ee,W){v.postMessage({msg:"logcat_callback",type:ee,logcat:W})}).bind(void 0),T=null,k=null,E=null,R=null,K=!1,z=!1,D=0,O=0,U=!1;function I(){E&&(E.shutdown(),E.destroy(),E=null)}function F(){if(T==null||k==null)throw new d.a("Worker not initialized");if(R)throw new d.a("Transmuxer has been initialized");z||(!k.deferLoadAfterSourceOpen||K?((R=new m.a(T,k)).on(g.a.INIT_SEGMENT,(function(ee,W){E.appendInitSegment(W)})),R.on(g.a.MEDIA_SEGMENT,(function(ee,W){E.appendMediaSegment(W),v.postMessage({msg:"buffered_position_changed",buffered_position_milliseconds:W.info.endDts})})),R.on(g.a.LOADING_COMPLETE,(function(){E.endOfStream(),v.postMessage({msg:"player_event",event:x.a.LOADING_COMPLETE})})),R.on(g.a.RECOVERED_EARLY_EOF,(function(){v.postMessage({msg:"player_event",event:x.a.RECOVERED_EARLY_EOF})})),R.on(g.a.IO_ERROR,(function(ee,W){v.postMessage({msg:"player_event",event:x.a.ERROR,error_type:b.b.NETWORK_ERROR,error_detail:ee,info:W})})),R.on(g.a.DEMUX_ERROR,(function(ee,W){v.postMessage({msg:"player_event",event:x.a.ERROR,error_type:b.b.MEDIA_ERROR,error_detail:ee,info:W})})),R.on(g.a.MEDIA_INFO,(function(ee){ae(g.a.MEDIA_INFO,ee)})),R.on(g.a.STATISTICS_INFO,(function(ee){ae(g.a.STATISTICS_INFO,ee)})),R.on(g.a.RECOMMEND_SEEKPOINT,(function(ee){(function(W){v.postMessage({msg:"transmuxing_event",event:g.a.RECOMMEND_SEEKPOINT,milliseconds:W})})(ee)})),R.on(g.a.METADATA_ARRIVED,(function(ee){ce(x.a.METADATA_ARRIVED,ee)})),R.on(g.a.SCRIPTDATA_ARRIVED,(function(ee){ce(x.a.SCRIPTDATA_ARRIVED,ee)})),R.on(g.a.TIMED_ID3_METADATA_ARRIVED,(function(ee){ce(x.a.TIMED_ID3_METADATA_ARRIVED,ee)})),R.on(g.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,(function(ee){ce(x.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,ee)})),R.on(g.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,(function(ee){ce(x.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,ee)})),R.on(g.a.SMPTE2038_METADATA_ARRIVED,(function(ee){ce(x.a.SMPTE2038_METADATA_ARRIVED,ee)})),R.on(g.a.SCTE35_METADATA_ARRIVED,(function(ee){ce(x.a.SCTE35_METADATA_ARRIVED,ee)})),R.on(g.a.PES_PRIVATE_DATA_DESCRIPTOR,(function(ee){ce(x.a.PES_PRIVATE_DATA_DESCRIPTOR,ee)})),R.on(g.a.PES_PRIVATE_DATA_ARRIVED,(function(ee){ce(x.a.PES_PRIVATE_DATA_ARRIVED,ee)})),R.open()):z=!0)}function te(){E&&E.flush(),R&&(R.close(),R.destroy(),R=null)}function le(){K=!0,z&&(z=!1,F())}function H(){v.postMessage({msg:"mse_event",event:f.a.UPDATE_END})}function X(){o.a.v(w,"MSE SourceBuffer is full, report to main thread"),v.postMessage({msg:"mse_event",event:f.a.BUFFER_FULL})}function q(ee){v.postMessage({msg:"player_event",event:x.a.ERROR,error_type:b.b.MEDIA_ERROR,error_detail:b.b.MEDIA_MSE_ERROR,info:ee})}function ae(ee,W){v.postMessage({msg:"transmuxing_event",event:ee,info:W})}function ce(ee,W){v.postMessage({msg:"player_event",event:ee,extraData:W})}v.addEventListener("message",(function(ee){if(!U){var W=ee.data;switch(W.cmd){case"logging_config":var V=W;c.a.applyConfig(V.logging_config),V.logging_config.enableCallback===!0?c.a.addLogListener(S):c.a.removeLogListener(S);break;case"init":T=(V=W).media_data_source,k=V.config;break;case"destroy":(function(){R&&te(),E&&I(),U=!0,v.postMessage({msg:"destroyed"})})();break;case"initialize_mse":(function(){o.a.v(w,"Initializing MediaSource in DedicatedWorker"),(E=new u.a(k)).on(f.a.SOURCE_OPEN,le.bind(this)),E.on(f.a.UPDATE_END,H.bind(this)),E.on(f.a.BUFFER_FULL,X.bind(this)),E.on(f.a.ERROR,q.bind(this)),E.initialize({getCurrentTime:function(){return D},getReadyState:function(){return O}});var G=E.getHandle();v.postMessage({msg:"mse_init",handle:G},[G])})();break;case"shutdown_mse":I();break;case"load":F();break;case"unload":te();break;case"unbuffered_seek":V=W,E.flush(),R.seek(V.milliseconds);break;case"timeupdate":D=(V=W).current_time;break;case"readystatechange":O=(V=W).ready_state;break;case"pause_transmuxer":R.pause();break;case"resume_transmuxer":R.resume()}}}))}},function(s,r,n){n.r(r);var o=n(15),c=n(14),d={enableWorker:!1,enableWorkerForMSE:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,liveBufferLatencyChasing:!1,liveBufferLatencyChasingOnPaused:!1,liveBufferLatencyMaxLatency:1.5,liveBufferLatencyMinRemain:.5,liveSync:!1,liveSyncMaxLatency:1.2,liveSyncTargetLatency:.8,liveSyncPlaybackRate:1.2,lazyLoad:!0,lazyLoadMaxDuration:180,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:180,autoCleanupMinBackwardDuration:120,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function f(){return Object.assign({},d)}var u=(function(){function ee(){}return ee.supportMSEH264Playback=function(){var W=self.MediaSource&&self.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),V=self.ManagedMediaSource&&self.ManagedMediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"');return W||V},ee.supportMSEH265Playback=function(){var W=self.MediaSource&&self.MediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L93.B0"'),V=self.ManagedMediaSource&&self.ManagedMediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L93.B0"');return W||V},ee.supportNetworkStreamIO=function(){var W=new c.a({},f()),V=W.loaderType;return W.destroy(),V=="fetch-stream-loader"||V=="xhr-moz-chunked-loader"},ee.getNetworkLoaderTypeName=function(){var W=new c.a({},f()),V=W.loaderType;return W.destroy(),V},ee.supportNativeMediaPlayback=function(W){ee.videoElement==null&&(ee.videoElement=window.document.createElement("video"));var V=ee.videoElement.canPlayType(W);return V==="probably"||V=="maybe"},ee.getFeatureList=function(){var W={msePlayback:!1,mseLivePlayback:!1,mseH265Playback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeMP4H265Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return W.msePlayback=ee.supportMSEH264Playback(),W.networkStreamIO=ee.supportNetworkStreamIO(),W.networkLoaderName=ee.getNetworkLoaderTypeName(),W.mseLivePlayback=W.msePlayback&&W.networkStreamIO,W.mseH265Playback=ee.supportMSEH265Playback(),W.nativeMP4H264Playback=ee.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),W.nativeMP4H265Playback=ee.supportNativeMediaPlayback('video/mp4; codecs="hvc1.1.6.L93.B0"'),W.nativeWebmVP8Playback=ee.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),W.nativeWebmVP9Playback=ee.supportNativeMediaPlayback('video/webm; codecs="vp9"'),W},ee})(),m=n(2),g=n(0),x=n(9),b=n.n(x),v=n(16),w=n(4),S=n(17),T=n(7),k=n(10),E=n(3),R=n(1),K=n(5),z=n(11),D=(function(){function ee(W,V,G){this.TAG="SeekingHandler",this._config=null,this._media_element=null,this._always_seek_keyframe=!1,this._on_unbuffered_seek=null,this._request_set_current_time=!1,this._seek_request_record_clocktime=null,this._idr_sample_list=new z.a,this.e=null,this._config=W,this._media_element=V,this._on_unbuffered_seek=G,this.e={onMediaSeeking:this._onMediaSeeking.bind(this)};var Z=K.a.chrome&&(K.a.version.major<50||K.a.version.major===50&&K.a.version.build<2661);this._always_seek_keyframe=!!(Z||K.a.msedge||K.a.msie),this._always_seek_keyframe&&(this._config.accurateSeek=!1),this._media_element.addEventListener("seeking",this.e.onMediaSeeking)}return ee.prototype.destroy=function(){this._idr_sample_list.clear(),this._idr_sample_list=null,this._media_element.removeEventListener("seeking",this.e.onMediaSeeking),this._media_element=null,this._on_unbuffered_seek=null},ee.prototype.seek=function(W){var V=this._isPositionBuffered(W),G=!1;if(W<1&&this._media_element.buffered.length>0){var Z=this._media_element.buffered.start(0);(Z<1&&W<Z||K.a.safari)&&(G=!0,W=K.a.safari?.1:Z)}if(G)this.directSeek(W);else if(V)if(this._always_seek_keyframe){var oe=this._getNearestKeyframe(Math.floor(1e3*W));oe!=null&&(W=oe.dts/1e3),this.directSeek(W)}else this.directSeek(W);else this._idr_sample_list.clear(),this._on_unbuffered_seek(Math.floor(1e3*W)),this._config.accurateSeek&&this.directSeek(W)},ee.prototype.directSeek=function(W){this._request_set_current_time=!0,this._media_element.currentTime=W},ee.prototype.appendSyncPoints=function(W){this._idr_sample_list.appendArray(W)},ee.prototype._onMediaSeeking=function(W){if(this._request_set_current_time)this._request_set_current_time=!1;else{var V=this._media_element.currentTime,G=this._media_element.buffered;if(V<1&&G.length>0){var Z=G.start(0);if(Z<1&&V<Z||K.a.safari){var oe=K.a.safari?.1:Z;return void this.directSeek(oe)}}if(this._isPositionBuffered(V)){if(this._always_seek_keyframe){var ye=this._getNearestKeyframe(Math.floor(1e3*V));ye!=null&&(V=ye.dts/1e3,this.directSeek(V))}}else this._seek_request_record_clocktime=ee._getClockTime(),window.setTimeout(this._pollAndApplyUnbufferedSeek.bind(this),50)}},ee.prototype._pollAndApplyUnbufferedSeek=function(){if(this._seek_request_record_clocktime!=null)if(this._seek_request_record_clocktime<=ee._getClockTime()-100){var W=this._media_element.currentTime;this._seek_request_record_clocktime=null,this._isPositionBuffered(W)||(this._idr_sample_list.clear(),this._on_unbuffered_seek(Math.floor(1e3*W)),this._config.accurateSeek&&this.directSeek(W))}else window.setTimeout(this._pollAndApplyUnbufferedSeek.bind(this),50)},ee.prototype._isPositionBuffered=function(W){for(var V=this._media_element.buffered,G=0;G<V.length;G++){var Z=V.start(G),oe=V.end(G);if(W>=Z&&W<oe)return!0}return!1},ee.prototype._getNearestKeyframe=function(W){return this._idr_sample_list.getLastSyncPointBeforeDts(W)},ee._getClockTime=function(){return self.performance&&self.performance.now?self.performance.now():Date.now()},ee})(),O=(function(){function ee(W,V,G,Z){this.TAG="LoadingController",this._config=null,this._media_element=null,this._on_pause_transmuxer=null,this._on_resume_transmuxer=null,this._paused=!1,this.e=null,this._config=W,this._media_element=V,this._on_pause_transmuxer=G,this._on_resume_transmuxer=Z,this.e={onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this)}}return ee.prototype.destroy=function(){this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this.e=null,this._media_element=null,this._config=null,this._on_pause_transmuxer=null,this._on_resume_transmuxer=null},ee.prototype.notifyBufferedPositionChanged=function(W){!this._config.isLive&&this._config.lazyLoad&&(W==null?this._suspendTransmuxerIfNeeded():this._suspendTransmuxerIfBufferedPositionExceeded(W))},ee.prototype._onMediaTimeUpdate=function(W){this._paused&&this._resumeTransmuxerIfNeeded()},ee.prototype._suspendTransmuxerIfNeeded=function(){for(var W=this._media_element.buffered,V=this._media_element.currentTime,G=0,Z=0;Z<W.length;Z++){var oe=W.start(Z),ye=W.end(Z);if(oe<=V&&V<ye){G=ye;break}}G>0&&this._suspendTransmuxerIfBufferedPositionExceeded(G)},ee.prototype._suspendTransmuxerIfBufferedPositionExceeded=function(W){W>=this._media_element.currentTime+this._config.lazyLoadMaxDuration&&!this._paused&&(g.a.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this.suspendTransmuxer(),this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate))},ee.prototype.suspendTransmuxer=function(){this._paused=!0,this._on_pause_transmuxer()},ee.prototype._resumeTransmuxerIfNeeded=function(){for(var W=this._media_element.buffered,V=this._media_element.currentTime,G=this._config.lazyLoadRecoverDuration,Z=!1,oe=0;oe<W.length;oe++){var ye=W.start(oe),je=W.end(oe);if(V>=ye&&V<je){V>=je-G&&(Z=!0);break}}Z&&(g.a.v(this.TAG,"Continue loading from paused position"),this.resumeTransmuxer(),this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate))},ee.prototype.resumeTransmuxer=function(){this._paused=!1,this._on_resume_transmuxer()},ee})(),U=(function(){function ee(W,V){this.TAG="StartupStallJumper",this._media_element=null,this._on_direct_seek=null,this._canplay_received=!1,this.e=null,this._media_element=W,this._on_direct_seek=V,this.e={onMediaCanPlay:this._onMediaCanPlay.bind(this),onMediaStalled:this._onMediaStalled.bind(this),onMediaProgress:this._onMediaProgress.bind(this)},this._media_element.addEventListener("canplay",this.e.onMediaCanPlay),this._media_element.addEventListener("stalled",this.e.onMediaStalled),this._media_element.addEventListener("progress",this.e.onMediaProgress)}return ee.prototype.destroy=function(){this._media_element.removeEventListener("canplay",this.e.onMediaCanPlay),this._media_element.removeEventListener("stalled",this.e.onMediaStalled),this._media_element.removeEventListener("progress",this.e.onMediaProgress),this._media_element=null,this._on_direct_seek=null},ee.prototype._onMediaCanPlay=function(W){this._canplay_received=!0,this._media_element.removeEventListener("canplay",this.e.onMediaCanPlay)},ee.prototype._onMediaStalled=function(W){this._detectAndFixStuckPlayback(!0)},ee.prototype._onMediaProgress=function(W){this._detectAndFixStuckPlayback()},ee.prototype._detectAndFixStuckPlayback=function(W){var V=this._media_element,G=V.buffered;W||!this._canplay_received||V.readyState<2?G.length>0&&V.currentTime<G.start(0)&&(g.a.w(this.TAG,"Playback seems stuck at ".concat(V.currentTime,", seek to ").concat(G.start(0))),this._on_direct_seek(G.start(0)),this._media_element.removeEventListener("progress",this.e.onMediaProgress)):this._media_element.removeEventListener("progress",this.e.onMediaProgress)},ee})(),I=(function(){function ee(W,V,G){this._config=null,this._media_element=null,this._on_direct_seek=null,this._config=W,this._media_element=V,this._on_direct_seek=G}return ee.prototype.destroy=function(){this._on_direct_seek=null,this._media_element=null,this._config=null},ee.prototype.notifyBufferedRangeUpdate=function(){this._chaseLiveLatency()},ee.prototype._chaseLiveLatency=function(){var W=this._media_element.buffered,V=this._media_element.currentTime,G=this._media_element.paused;if(this._config.isLive&&this._config.liveBufferLatencyChasing&&W.length!=0&&(this._config.liveBufferLatencyChasingOnPaused||!G)){var Z=W.end(W.length-1);if(Z>this._config.liveBufferLatencyMaxLatency&&Z-V>this._config.liveBufferLatencyMaxLatency){var oe=Z-this._config.liveBufferLatencyMinRemain;this._on_direct_seek(oe)}}},ee})(),F=(function(){function ee(W,V){this._config=null,this._media_element=null,this.e=null,this._config=W,this._media_element=V,this.e={onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this)},this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate)}return ee.prototype.destroy=function(){this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element=null,this._config=null},ee.prototype._onMediaTimeUpdate=function(W){if(this._config.isLive&&this._config.liveSync){var V=this._getCurrentLatency();if(V>this._config.liveSyncMaxLatency){var G=Math.min(2,Math.max(1,this._config.liveSyncPlaybackRate));this._media_element.playbackRate=G}else V>this._config.liveSyncTargetLatency||this._media_element.playbackRate!==1&&this._media_element.playbackRate!==0&&(this._media_element.playbackRate=1)}},ee.prototype._getCurrentLatency=function(){if(!this._media_element)return 0;var W=this._media_element.buffered,V=this._media_element.currentTime;return W.length==0?0:W.end(W.length-1)-V},ee})(),te=(function(){function ee(W,V){this.TAG="PlayerEngineMainThread",this._emitter=new x,this._media_element=null,this._mse_controller=null,this._transmuxer=null,this._pending_seek_time=null,this._seeking_handler=null,this._loading_controller=null,this._startup_stall_jumper=null,this._live_latency_chaser=null,this._live_latency_synchronizer=null,this._mse_source_opened=!1,this._has_pending_load=!1,this._loaded_metadata_received=!1,this._media_info=null,this._statistics_info=null,this.e=null,this._media_data_source=W,this._config=f(),typeof V=="object"&&Object.assign(this._config,V),W.isLive===!0&&(this._config.isLive=!0),this.e={onMediaLoadedMetadata:this._onMediaLoadedMetadata.bind(this)}}return ee.prototype.destroy=function(){this._emitter.emit(w.a.DESTROYING),this._transmuxer&&this.unload(),this._media_element&&this.detachMediaElement(),this.e=null,this._media_data_source=null,this._emitter.removeAllListeners(),this._emitter=null},ee.prototype.on=function(W,V){var G=this;this._emitter.addListener(W,V),W===w.a.MEDIA_INFO&&this._media_info?Promise.resolve().then((function(){return G._emitter.emit(w.a.MEDIA_INFO,G.mediaInfo)})):W==w.a.STATISTICS_INFO&&this._statistics_info&&Promise.resolve().then((function(){return G._emitter.emit(w.a.STATISTICS_INFO,G.statisticsInfo)}))},ee.prototype.off=function(W,V){this._emitter.removeListener(W,V)},ee.prototype.attachMediaElement=function(W){var V=this;this._media_element=W,W.src="",W.removeAttribute("src"),W.srcObject=null,W.load(),W.addEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._mse_controller=new v.a(this._config),this._mse_controller.on(T.a.UPDATE_END,this._onMSEUpdateEnd.bind(this)),this._mse_controller.on(T.a.BUFFER_FULL,this._onMSEBufferFull.bind(this)),this._mse_controller.on(T.a.SOURCE_OPEN,this._onMSESourceOpen.bind(this)),this._mse_controller.on(T.a.ERROR,this._onMSEError.bind(this)),this._mse_controller.on(T.a.START_STREAMING,this._onMSEStartStreaming.bind(this)),this._mse_controller.on(T.a.END_STREAMING,this._onMSEEndStreaming.bind(this)),this._mse_controller.initialize({getCurrentTime:function(){return V._media_element.currentTime},getReadyState:function(){return V._media_element.readyState}}),this._mse_controller.isManagedMediaSource()?(W.disableRemotePlayback=!0,W.srcObject=this._mse_controller.getObject()):W.src=this._mse_controller.getObjectURL()},ee.prototype.detachMediaElement=function(){this._media_element&&(this._mse_controller.shutdown(),this._media_element.removeEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element=null,this._mse_controller.revokeObjectURL()),this._mse_controller&&(this._mse_controller.destroy(),this._mse_controller=null)},ee.prototype.load=function(){var W=this;if(!this._media_element)throw new E.a("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new E.a("load() has been called, please call unload() first!");this._has_pending_load||(!this._config.deferLoadAfterSourceOpen||this._mse_source_opened?(this._transmuxer=new S.a(this._media_data_source,this._config),this._transmuxer.on(R.a.INIT_SEGMENT,(function(V,G){W._mse_controller.appendInitSegment(G)})),this._transmuxer.on(R.a.MEDIA_SEGMENT,(function(V,G){W._mse_controller.appendMediaSegment(G),!W._config.isLive&&V==="video"&&G.data&&G.data.byteLength>0&&"info"in G&&W._seeking_handler.appendSyncPoints(G.info.syncPoints),W._loading_controller.notifyBufferedPositionChanged(G.info.endDts/1e3)})),this._transmuxer.on(R.a.LOADING_COMPLETE,(function(){W._mse_controller.endOfStream(),W._emitter.emit(w.a.LOADING_COMPLETE)})),this._transmuxer.on(R.a.RECOVERED_EARLY_EOF,(function(){W._emitter.emit(w.a.RECOVERED_EARLY_EOF)})),this._transmuxer.on(R.a.IO_ERROR,(function(V,G){W._emitter.emit(w.a.ERROR,k.b.NETWORK_ERROR,V,G)})),this._transmuxer.on(R.a.DEMUX_ERROR,(function(V,G){W._emitter.emit(w.a.ERROR,k.b.MEDIA_ERROR,V,G)})),this._transmuxer.on(R.a.MEDIA_INFO,(function(V){W._media_info=V,W._emitter.emit(w.a.MEDIA_INFO,Object.assign({},V))})),this._transmuxer.on(R.a.STATISTICS_INFO,(function(V){W._statistics_info=W._fillStatisticsInfo(V),W._emitter.emit(w.a.STATISTICS_INFO,Object.assign({},V))})),this._transmuxer.on(R.a.RECOMMEND_SEEKPOINT,(function(V){W._media_element&&!W._config.accurateSeek&&W._seeking_handler.directSeek(V/1e3)})),this._transmuxer.on(R.a.METADATA_ARRIVED,(function(V){W._emitter.emit(w.a.METADATA_ARRIVED,V)})),this._transmuxer.on(R.a.SCRIPTDATA_ARRIVED,(function(V){W._emitter.emit(w.a.SCRIPTDATA_ARRIVED,V)})),this._transmuxer.on(R.a.TIMED_ID3_METADATA_ARRIVED,(function(V){W._emitter.emit(w.a.TIMED_ID3_METADATA_ARRIVED,V)})),this._transmuxer.on(R.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,(function(V){W._emitter.emit(w.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,V)})),this._transmuxer.on(R.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,(function(V){W._emitter.emit(w.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,V)})),this._transmuxer.on(R.a.SMPTE2038_METADATA_ARRIVED,(function(V){W._emitter.emit(w.a.SMPTE2038_METADATA_ARRIVED,V)})),this._transmuxer.on(R.a.SCTE35_METADATA_ARRIVED,(function(V){W._emitter.emit(w.a.SCTE35_METADATA_ARRIVED,V)})),this._transmuxer.on(R.a.PES_PRIVATE_DATA_DESCRIPTOR,(function(V){W._emitter.emit(w.a.PES_PRIVATE_DATA_DESCRIPTOR,V)})),this._transmuxer.on(R.a.PES_PRIVATE_DATA_ARRIVED,(function(V){W._emitter.emit(w.a.PES_PRIVATE_DATA_ARRIVED,V)})),this._seeking_handler=new D(this._config,this._media_element,this._onRequiredUnbufferedSeek.bind(this)),this._loading_controller=new O(this._config,this._media_element,this._onRequestPauseTransmuxer.bind(this),this._onRequestResumeTransmuxer.bind(this)),this._startup_stall_jumper=new U(this._media_element,this._onRequestDirectSeek.bind(this)),this._config.isLive&&this._config.liveBufferLatencyChasing&&(this._live_latency_chaser=new I(this._config,this._media_element,this._onRequestDirectSeek.bind(this))),this._config.isLive&&this._config.liveSync&&(this._live_latency_synchronizer=new F(this._config,this._media_element)),this._media_element.readyState>0&&this._seeking_handler.directSeek(0),this._transmuxer.open()):this._has_pending_load=!0)},ee.prototype.unload=function(){var W,V,G,Z,oe,ye,je,xe,Ee;(W=this._media_element)===null||W===void 0||W.pause(),(V=this._live_latency_synchronizer)===null||V===void 0||V.destroy(),this._live_latency_synchronizer=null,(G=this._live_latency_chaser)===null||G===void 0||G.destroy(),this._live_latency_chaser=null,(Z=this._startup_stall_jumper)===null||Z===void 0||Z.destroy(),this._startup_stall_jumper=null,(oe=this._loading_controller)===null||oe===void 0||oe.destroy(),this._loading_controller=null,(ye=this._seeking_handler)===null||ye===void 0||ye.destroy(),this._seeking_handler=null,(je=this._mse_controller)===null||je===void 0||je.flush(),(xe=this._transmuxer)===null||xe===void 0||xe.close(),(Ee=this._transmuxer)===null||Ee===void 0||Ee.destroy(),this._transmuxer=null},ee.prototype.play=function(){return this._media_element.play()},ee.prototype.pause=function(){this._media_element.pause()},ee.prototype.seek=function(W){this._media_element&&this._seeking_handler?this._seeking_handler.seek(W):this._pending_seek_time=W},Object.defineProperty(ee.prototype,"mediaInfo",{get:function(){return Object.assign({},this._media_info)},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"statisticsInfo",{get:function(){return Object.assign({},this._statistics_info)},enumerable:!1,configurable:!0}),ee.prototype._onMSESourceOpen=function(){this._mse_source_opened=!0,this._has_pending_load&&(this._has_pending_load=!1,this.load())},ee.prototype._onMSEUpdateEnd=function(){this._config.isLive&&this._config.liveBufferLatencyChasing&&this._live_latency_chaser&&this._live_latency_chaser.notifyBufferedRangeUpdate(),this._loading_controller.notifyBufferedPositionChanged()},ee.prototype._onMSEBufferFull=function(){g.a.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._loading_controller.suspendTransmuxer()},ee.prototype._onMSEError=function(W){this._emitter.emit(w.a.ERROR,k.b.MEDIA_ERROR,k.a.MEDIA_MSE_ERROR,W)},ee.prototype._onMSEStartStreaming=function(){this._loaded_metadata_received&&(this._config.isLive||(g.a.v(this.TAG,"Resume transmuxing task due to ManagedMediaSource onStartStreaming"),this._loading_controller.resumeTransmuxer()))},ee.prototype._onMSEEndStreaming=function(){this._config.isLive||(g.a.v(this.TAG,"Suspend transmuxing task due to ManagedMediaSource onEndStreaming"),this._loading_controller.suspendTransmuxer())},ee.prototype._onMediaLoadedMetadata=function(W){this._loaded_metadata_received=!0,this._pending_seek_time!=null&&(this._seeking_handler.seek(this._pending_seek_time),this._pending_seek_time=null)},ee.prototype._onRequestDirectSeek=function(W){this._seeking_handler.directSeek(W)},ee.prototype._onRequiredUnbufferedSeek=function(W){this._mse_controller.flush(),this._transmuxer.seek(W)},ee.prototype._onRequestPauseTransmuxer=function(){this._transmuxer.pause()},ee.prototype._onRequestResumeTransmuxer=function(){this._transmuxer.resume()},ee.prototype._fillStatisticsInfo=function(W){if(W.playerType="MSEPlayer",!(this._media_element instanceof HTMLVideoElement))return W;var V=!0,G=0,Z=0;if(this._media_element.getVideoPlaybackQuality){var oe=this._media_element.getVideoPlaybackQuality();G=oe.totalVideoFrames,Z=oe.droppedVideoFrames}else this._media_element.webkitDecodedFrameCount!=null?(G=this._media_element.webkitDecodedFrameCount,Z=this._media_element.webkitDroppedFrameCount):V=!1;return V&&(W.decodedFrames=G,W.droppedFrames=Z),W},ee})(),le=n(18),H=n(8),X=(function(){function ee(W,V){this.TAG="PlayerEngineDedicatedThread",this._emitter=new x,this._media_element=null,this._worker_destroying=!1,this._seeking_handler=null,this._loading_controller=null,this._startup_stall_jumper=null,this._live_latency_chaser=null,this._live_latency_synchronizer=null,this._pending_seek_time=null,this._media_info=null,this._statistics_info=null,this.e=null,this._media_data_source=W,this._config=f(),typeof V=="object"&&Object.assign(this._config,V),W.isLive===!0&&(this._config.isLive=!0),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this),onMediaLoadedMetadata:this._onMediaLoadedMetadata.bind(this),onMediaTimeUpdate:this._onMediaTimeUpdate.bind(this),onMediaReadyStateChanged:this._onMediaReadyStateChange.bind(this)},H.a.registerListener(this.e.onLoggingConfigChanged),this._worker=le(24,{all:!0}),this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",media_data_source:this._media_data_source,config:this._config}),this._worker.postMessage({cmd:"logging_config",logging_config:H.a.getConfig()})}return ee.isSupported=function(){return!!self.Worker&&(!(!self.MediaSource||!("canConstructInDedicatedWorker"in self.MediaSource)||self.MediaSource.canConstructInDedicatedWorker!==!0)||!(!self.ManagedMediaSource||!("canConstructInDedicatedWorker"in self.ManagedMediaSource)||self.ManagedMediaSource.canConstructInDedicatedWorker!==!0))},ee.prototype.destroy=function(){this._emitter.emit(w.a.DESTROYING),this.unload(),this.detachMediaElement(),this._worker_destroying=!0,this._worker.postMessage({cmd:"destroy"}),H.a.removeListener(this.e.onLoggingConfigChanged),this.e=null,this._media_data_source=null,this._emitter.removeAllListeners(),this._emitter=null},ee.prototype.on=function(W,V){var G=this;this._emitter.addListener(W,V),W===w.a.MEDIA_INFO&&this._media_info?Promise.resolve().then((function(){return G._emitter.emit(w.a.MEDIA_INFO,G.mediaInfo)})):W==w.a.STATISTICS_INFO&&this._statistics_info&&Promise.resolve().then((function(){return G._emitter.emit(w.a.STATISTICS_INFO,G.statisticsInfo)}))},ee.prototype.off=function(W,V){this._emitter.removeListener(W,V)},ee.prototype.attachMediaElement=function(W){this._media_element=W,this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element.addEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.addEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element.addEventListener("readystatechange",this.e.onMediaReadyStateChanged),this._worker.postMessage({cmd:"initialize_mse"})},ee.prototype.detachMediaElement=function(){this._worker.postMessage({cmd:"shutdown_mse"}),this._media_element&&(this._media_element.removeEventListener("loadedmetadata",this.e.onMediaLoadedMetadata),this._media_element.removeEventListener("timeupdate",this.e.onMediaTimeUpdate),this._media_element.removeEventListener("readystatechange",this.e.onMediaReadyStateChanged),this._media_element.src="",this._media_element.removeAttribute("src"),this._media_element.srcObject=null,this._media_element.load(),this._media_element=null)},ee.prototype.load=function(){this._worker.postMessage({cmd:"load"}),this._seeking_handler=new D(this._config,this._media_element,this._onRequiredUnbufferedSeek.bind(this)),this._loading_controller=new O(this._config,this._media_element,this._onRequestPauseTransmuxer.bind(this),this._onRequestResumeTransmuxer.bind(this)),this._startup_stall_jumper=new U(this._media_element,this._onRequestDirectSeek.bind(this)),this._config.isLive&&this._config.liveBufferLatencyChasing&&(this._live_latency_chaser=new I(this._config,this._media_element,this._onRequestDirectSeek.bind(this))),this._config.isLive&&this._config.liveSync&&(this._live_latency_synchronizer=new F(this._config,this._media_element)),this._media_element.readyState>0&&this._seeking_handler.directSeek(0)},ee.prototype.unload=function(){var W,V,G,Z,oe,ye;(W=this._media_element)===null||W===void 0||W.pause(),this._worker.postMessage({cmd:"unload"}),(V=this._live_latency_synchronizer)===null||V===void 0||V.destroy(),this._live_latency_synchronizer=null,(G=this._live_latency_chaser)===null||G===void 0||G.destroy(),this._live_latency_chaser=null,(Z=this._startup_stall_jumper)===null||Z===void 0||Z.destroy(),this._startup_stall_jumper=null,(oe=this._loading_controller)===null||oe===void 0||oe.destroy(),this._loading_controller=null,(ye=this._seeking_handler)===null||ye===void 0||ye.destroy(),this._seeking_handler=null},ee.prototype.play=function(){return this._media_element.play()},ee.prototype.pause=function(){this._media_element.pause()},ee.prototype.seek=function(W){this._media_element&&this._seeking_handler?this._seeking_handler.seek(W):this._pending_seek_time=W},Object.defineProperty(ee.prototype,"mediaInfo",{get:function(){return Object.assign({},this._media_info)},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"statisticsInfo",{get:function(){return Object.assign({},this._statistics_info)},enumerable:!1,configurable:!0}),ee.prototype._onLoggingConfigChanged=function(W){var V;(V=this._worker)===null||V===void 0||V.postMessage({cmd:"logging_config",logging_config:W})},ee.prototype._onMSEUpdateEnd=function(){this._config.isLive&&this._config.liveBufferLatencyChasing&&this._live_latency_chaser&&this._live_latency_chaser.notifyBufferedRangeUpdate(),this._loading_controller.notifyBufferedPositionChanged()},ee.prototype._onMSEBufferFull=function(){g.a.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._loading_controller.suspendTransmuxer()},ee.prototype._onMediaLoadedMetadata=function(W){this._pending_seek_time!=null&&(this._seeking_handler.seek(this._pending_seek_time),this._pending_seek_time=null)},ee.prototype._onRequestDirectSeek=function(W){this._seeking_handler.directSeek(W)},ee.prototype._onRequiredUnbufferedSeek=function(W){this._worker.postMessage({cmd:"unbuffered_seek",milliseconds:W})},ee.prototype._onRequestPauseTransmuxer=function(){this._worker.postMessage({cmd:"pause_transmuxer"})},ee.prototype._onRequestResumeTransmuxer=function(){this._worker.postMessage({cmd:"resume_transmuxer"})},ee.prototype._onMediaTimeUpdate=function(W){this._worker.postMessage({cmd:"timeupdate",current_time:W.target.currentTime})},ee.prototype._onMediaReadyStateChange=function(W){this._worker.postMessage({cmd:"readystatechange",ready_state:W.target.readyState})},ee.prototype._onWorkerMessage=function(W){var V,G=W.data,Z=G.msg;if(Z=="destroyed"||this._worker_destroying)return this._worker_destroying=!1,(V=this._worker)===null||V===void 0||V.terminate(),void(this._worker=null);switch(Z){case"mse_init":var oe=G;"ManagedMediaSource"in self&&!("MediaSource"in self)&&(this._media_element.disableRemotePlayback=!0),this._media_element.srcObject=oe.handle;break;case"mse_event":(oe=G).event==T.a.UPDATE_END?this._onMSEUpdateEnd():oe.event==T.a.BUFFER_FULL&&this._onMSEBufferFull();break;case"transmuxing_event":if((oe=G).event==R.a.MEDIA_INFO){var ye=G;this._media_info=ye.info,this._emitter.emit(w.a.MEDIA_INFO,Object.assign({},ye.info))}else if(oe.event==R.a.STATISTICS_INFO){var je=G;this._statistics_info=this._fillStatisticsInfo(je.info),this._emitter.emit(w.a.STATISTICS_INFO,Object.assign({},je.info))}else if(oe.event==R.a.RECOMMEND_SEEKPOINT){var xe=G;this._media_element&&!this._config.accurateSeek&&this._seeking_handler.directSeek(xe.milliseconds/1e3)}break;case"player_event":if((oe=G).event==w.a.ERROR){var Ee=G;this._emitter.emit(w.a.ERROR,Ee.error_type,Ee.error_detail,Ee.info)}else if("extraData"in oe){var Pe=G;this._emitter.emit(Pe.event,Pe.extraData)}break;case"logcat_callback":oe=G,g.a.emitter.emit("log",oe.type,oe.logcat);break;case"buffered_position_changed":oe=G,this._loading_controller.notifyBufferedPositionChanged(oe.buffered_position_milliseconds/1e3)}},ee.prototype._fillStatisticsInfo=function(W){if(W.playerType="MSEPlayer",!(this._media_element instanceof HTMLVideoElement))return W;var V=!0,G=0,Z=0;if(this._media_element.getVideoPlaybackQuality){var oe=this._media_element.getVideoPlaybackQuality();G=oe.totalVideoFrames,Z=oe.droppedVideoFrames}else this._media_element.webkitDecodedFrameCount!=null?(G=this._media_element.webkitDecodedFrameCount,Z=this._media_element.webkitDroppedFrameCount):V=!1;return V&&(W.decodedFrames=G,W.droppedFrames=Z),W},ee})(),q=(function(){function ee(W,V){this.TAG="MSEPlayer",this._type="MSEPlayer",this._media_element=null,this._player_engine=null;var G=W.type.toLowerCase();if(G!=="mse"&&G!=="mpegts"&&G!=="m2ts"&&G!=="flv")throw new E.b("MSEPlayer requires an mpegts/m2ts/flv MediaDataSource input!");if(V&&V.enableWorkerForMSE&&X.isSupported())try{this._player_engine=new X(W,V)}catch{g.a.e(this.TAG,"Error while initializing PlayerEngineDedicatedThread, fallback to PlayerEngineMainThread"),this._player_engine=new te(W,V)}else this._player_engine=new te(W,V)}return ee.prototype.destroy=function(){this._player_engine.destroy(),this._player_engine=null,this._media_element=null},ee.prototype.on=function(W,V){this._player_engine.on(W,V)},ee.prototype.off=function(W,V){this._player_engine.off(W,V)},ee.prototype.attachMediaElement=function(W){this._media_element=W,this._player_engine.attachMediaElement(W)},ee.prototype.detachMediaElement=function(){this._media_element=null,this._player_engine.detachMediaElement()},ee.prototype.load=function(){this._player_engine.load()},ee.prototype.unload=function(){this._player_engine.unload()},ee.prototype.play=function(){return this._player_engine.play()},ee.prototype.pause=function(){this._player_engine.pause()},Object.defineProperty(ee.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"buffered",{get:function(){return this._media_element.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"duration",{get:function(){return this._media_element.duration},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"volume",{get:function(){return this._media_element.volume},set:function(W){this._media_element.volume=W},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"muted",{get:function(){return this._media_element.muted},set:function(W){this._media_element.muted=W},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"currentTime",{get:function(){return this._media_element?this._media_element.currentTime:0},set:function(W){this._player_engine.seek(W)},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"mediaInfo",{get:function(){return this._player_engine.mediaInfo},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"statisticsInfo",{get:function(){return this._player_engine.statisticsInfo},enumerable:!1,configurable:!0}),ee})(),ae=(function(){function ee(W,V){this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new b.a,this._config=f(),typeof V=="object"&&Object.assign(this._config,V);var G=W.type.toLowerCase();if(G==="mse"||G==="mpegts"||G==="m2ts"||G==="flv")throw new E.b("NativePlayer does't support mse/mpegts/m2ts/flv MediaDataSource input!");if(W.hasOwnProperty("segments"))throw new E.b("NativePlayer(".concat(W.type,") doesn't support multipart playback!"));this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=W,this._mediaElement=null}return ee.prototype.destroy=function(){this._emitter.emit(w.a.DESTROYING),this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},ee.prototype.on=function(W,V){var G=this;W===w.a.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then((function(){G._emitter.emit(w.a.MEDIA_INFO,G.mediaInfo)})):W===w.a.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then((function(){G._emitter.emit(w.a.STATISTICS_INFO,G.statisticsInfo)})),this._emitter.addListener(W,V)},ee.prototype.off=function(W,V){this._emitter.removeListener(W,V)},ee.prototype.attachMediaElement=function(W){if(this._mediaElement=W,W.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{W.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},ee.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},ee.prototype.load=function(){if(!this._mediaElement)throw new E.a("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},ee.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},ee.prototype.play=function(){return this._mediaElement.play()},ee.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(ee.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(W){this._mediaElement.volume=W},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(W){this._mediaElement.muted=W},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(W){this._mediaElement?this._mediaElement.currentTime=W:this._pendingSeekTime=W},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"mediaInfo",{get:function(){var W={mimeType:(this._mediaElement instanceof HTMLAudioElement?"audio/":"video/")+this._mediaDataSource.type};return this._mediaElement&&(W.duration=Math.floor(1e3*this._mediaElement.duration),this._mediaElement instanceof HTMLVideoElement&&(W.width=this._mediaElement.videoWidth,W.height=this._mediaElement.videoHeight)),W},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"statisticsInfo",{get:function(){var W={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return W;var V=!0,G=0,Z=0;if(this._mediaElement.getVideoPlaybackQuality){var oe=this._mediaElement.getVideoPlaybackQuality();G=oe.totalVideoFrames,Z=oe.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(G=this._mediaElement.webkitDecodedFrameCount,Z=this._mediaElement.webkitDroppedFrameCount):V=!1;return V&&(W.decodedFrames=G,W.droppedFrames=Z),W},enumerable:!1,configurable:!0}),ee.prototype._onvLoadedMetadata=function(W){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(w.a.MEDIA_INFO,this.mediaInfo)},ee.prototype._reportStatisticsInfo=function(){this._emitter.emit(w.a.STATISTICS_INFO,this.statisticsInfo)},ee})();o.a.install();var ce={createPlayer:function(ee,W){var V=ee;if(V==null||typeof V!="object")throw new E.b("MediaDataSource must be an javascript object!");if(!V.hasOwnProperty("type"))throw new E.b("MediaDataSource must has type field to indicate video file type!");switch(V.type){case"mse":case"mpegts":case"m2ts":case"flv":return new q(V,W);default:return new ae(V,W)}},isSupported:function(){return u.supportMSEH264Playback()},getFeatureList:function(){return u.getFeatureList()}};ce.BaseLoader=m.a,ce.LoaderStatus=m.c,ce.LoaderErrors=m.b,ce.Events=w.a,ce.ErrorTypes=k.b,ce.ErrorDetails=k.a,ce.MSEPlayer=q,ce.NativePlayer=ae,ce.LoggingControl=H.a,Object.defineProperty(ce,"version",{enumerable:!0,get:function(){return"1.8.0"}}),r.default=ce}])}))})(Xg)),Xg.exports}var s8=t8();const Xn=tx(s8);function r8(a){const e=a.toLowerCase();return e.includes(".m3u8")||e.includes("m3u8")?"hls":e.includes(".ts")||e.includes("/ts/")||e.includes("mpegts")||e.includes(".flv")?"mpegts":e.includes(".mp4")||e.includes(".webm")||e.includes(".ogg")?"native":"hls"}let ro=[];function Ut(a,e,...s){const r=new Date().toISOString().split("T")[1].slice(0,12),o=`${`[${r}][${a.toUpperCase()}]`} ${e} ${s.length>0?JSON.stringify(s):""}`;switch(ro.push(o),ro.length>100&&(ro=ro.slice(-100)),a){case"info":console.log(`[StreamPlayer ${r}]`,e,...s);break;case"warn":console.warn(`[StreamPlayer ${r}]`,e,...s);break;case"error":console.error(`[StreamPlayer ${r}]`,e,...s);break;case"debug":console.debug(`[StreamPlayer ${r}]`,e,...s);break}}function Q2({isOpen:a,onClose:e,streamUrl:s,channelId:r,channelName:n}){const o=y.useRef(null),c=y.useRef(null),d=y.useRef(null),[f,u]=y.useState(!1),[m,g]=y.useState(!1),[x,b]=y.useState(1),[v,w]=y.useState(null),[S,T]=y.useState(null),[k,E]=y.useState(!0),[R,K]=y.useState("unknown"),[z,D]=y.useState("proxy"),[O,U]=y.useState(0),[I,F]=y.useState(!1),[te,le]=y.useState(null),[H,X]=y.useState(!1),[q,ae]=y.useState([]),[ce,ee]=y.useState(null),[W,V]=y.useState(!1),G=y.useRef(!1);y.useEffect(()=>{a&&(V(!1),F(!1),le(null),X(!1),ae([]),w(null),T(null),E(!0),G.current=!1,g(!1))},[a,r]),y.useEffect(()=>{a&&s&&Ut("info","Modal opened",{channelId:r,channelName:n,streamUrl:s.substring(0,50)+"...",hlsSupported:Gs.isSupported(),mpegtsSupported:Xn.isSupported(),hasVideoRef:!!o.current})},[a,s,r,n]);const Z=async()=>{if(!r){Ut("warn","Cannot fetch debug info without channelId");return}X(!0),ae([...ro]),Ut("info","Fetching stream debug info",{channelId:r});try{const Ce=await at.get(`/iptv/stream/${r}/debug`);le(Ce.data),Ut("info","Debug info received",Ce.data)}catch(Ce){Ut("error","Failed to fetch debug info",Ce);const _e=Ce instanceof Error?Ce.message:"Unknown error";le({channelId:r,channelName:n,streamUrl:s||"",userAgent:"N/A",error:`Failed to fetch debug info: ${_e}`})}finally{X(!1),ae([...ro])}},oe=async()=>{const Ce={debugInfo:te,logs:ro.slice(-50),browser:navigator.userAgent,timestamp:new Date().toISOString()};try{await navigator.clipboard.writeText(JSON.stringify(Ce,null,2)),Ut("info","Debug info copied to clipboard")}catch{Ut("error","Failed to copy to clipboard")}},ye=Ce=>Ce.startsWith("http://")||Ce.startsWith("https://")?Ce:`${window.location.origin}${Ce.startsWith("/")?"":"/"}${Ce}`,je=()=>s?z==="ffmpeg"&&ce?ye(`/api/v1/stream/${ce}/playlist.m3u8`):z==="proxy"&&r?ye(`/api/iptv/stream/${r}`):s:null,xe=async()=>{if(!r)return null;try{Ut("info","Starting FFmpeg HLS stream",{channelId:r});const Ce=await at.post(`/v1/stream/${r}/start`);return Ce.data.success?(Ut("info","FFmpeg stream started",{sessionId:Ce.data.sessionId,playlistUrl:Ce.data.playlistUrl}),ee(Ce.data.sessionId),Ce.data.sessionId):(Ut("error","FFmpeg stream failed",Ce.data.error),null)}catch(Ce){return Ut("error","Failed to start FFmpeg stream",Ce),null}},Ee=async()=>{if(r&&ce)try{Ut("info","Stopping FFmpeg stream",{channelId:r}),await at.post(`/v1/stream/${r}/stop`),ee(null)}catch(Ce){Ut("warn","Failed to stop FFmpeg stream",Ce)}},Pe=async()=>{if(Ut("debug","Cleaning up player resources"),c.current&&(c.current.destroy(),c.current=null),d.current){try{d.current.destroy()}catch{}d.current=null}o.current&&(o.current.src="",o.current.load()),await Ee(),u(!1),w(null),T(null),E(!0),K("unknown")},Re=async()=>{Ut("info","Retrying stream playback",{currentMode:z,retryCount:O}),await Pe(),U(Ce=>Ce+1),z==="proxy"?(D("ffmpeg"),Ut("info","Switching to FFmpeg HLS mode")):z==="ffmpeg"?(D("direct"),Ut("info","Switching to direct mode")):(D("proxy"),Ut("info","Switching to proxy mode"))},Qe=()=>z==="proxy"?"FFmpeg":z==="ffmpeg"?"Direct":"Proxy";y.useEffect(()=>{if(!a||!s||!W||!o.current)return;const Ce=o.current;w(null),T(null),E(!0),Ut("info","Initializing player",{isOpen:a,streamUrl:s.substring(0,50),videoReady:W,playbackMode:z}),(async()=>{try{if(z==="ffmpeg"){Ut("info","Starting FFmpeg HLS transcoding session",{channelId:r,channelName:n}),G.current=!0,Ce.removeAttribute("src"),Ce.load();const we=await xe();if(!we){G.current=!1,w("Failed to start FFmpeg transcoding"),T("FFmpeg may not be installed or the stream URL is invalid."),E(!1);return}if(await new Promise(ve=>setTimeout(ve,2e3)),!o.current){Ut("warn","Video element no longer available after FFmpeg startup"),G.current=!1;return}const bt=`/api/v1/stream/${we}/playlist.m3u8`;if(Ut("info","Playing FFmpeg HLS stream",{hlsUrl:bt,hlsSupported:Gs.isSupported(),videoElement:!!Ce}),Gs.isSupported()){Ut("debug","Creating HLS.js instance for FFmpeg stream");const ve=new Gs({enableWorker:!0,lowLatencyMode:!1,liveSyncDuration:6,liveMaxLatencyDuration:15,maxBufferLength:60,maxMaxBufferLength:120,maxBufferSize:60*1e3*1e3,maxBufferHole:1,highBufferWatchdogPeriod:3});ve.on(Gs.Events.MEDIA_ATTACHED,()=>{Ut("debug","FFmpeg HLS: Media attached"),G.current=!1,ve.loadSource(bt)}),ve.on(Gs.Events.MANIFEST_PARSED,(xt,me)=>{Ut("info","FFmpeg HLS: Manifest parsed",{levels:me.levels.length}),K("hls"),E(!1),Ce.play().catch(De=>{Ut("warn","Autoplay blocked",De),u(!1)})}),ve.on(Gs.Events.ERROR,(xt,me)=>{Ut("error","FFmpeg HLS error",{type:me.type,details:me.details,fatal:me.fatal}),me.fatal&&(w(`FFmpeg playback error: ${me.details}`),T("Try a different playback mode."),E(!1))}),ve.attachMedia(Ce),c.current=ve}else G.current=!1,Ce.src=bt,Ce.addEventListener("loadedmetadata",()=>{K("hls"),E(!1),Ce.play().catch(()=>u(!1))});return}const tt=je();if(!tt){w("No stream URL available"),E(!1);return}const Ct=r8(s);if(K(Ct),Ut("info","Initializing stream player",{channelName:n,channelId:r,originalUrl:s,effectiveUrl:tt,detectedType:Ct,playbackMode:z,hlsSupported:Gs.isSupported(),mpegtsSupported:Xn.isSupported()}),Ct==="hls")if(Gs.isSupported()){Ut("debug","Creating HLS player");const we=new Gs({enableWorker:!0,lowLatencyMode:!0,backBufferLength:90,maxBufferLength:30,maxMaxBufferLength:60,xhrSetup:bt=>{bt.withCredentials=!1}});we.on(Gs.Events.MEDIA_ATTACHED,()=>{Ut("debug","HLS: Media attached, loading source"),we.loadSource(tt)}),we.on(Gs.Events.MANIFEST_PARSED,(bt,ve)=>{Ut("info","HLS: Manifest parsed",{levels:ve.levels.length}),E(!1),Ce.play().catch(xt=>{Ut("warn","Autoplay blocked",xt),u(!1)})}),we.on(Gs.Events.MANIFEST_LOADING,()=>{Ut("debug","HLS: Loading manifest from",tt)}),we.on(Gs.Events.LEVEL_LOADED,(bt,ve)=>{Ut("debug","HLS: Level loaded",{duration:ve.details.totalduration})}),we.on(Gs.Events.ERROR,(bt,ve)=>{var xt,me,De;if(Ut("error","HLS error",{type:ve.type,details:ve.details,fatal:ve.fatal,response:ve.response}),ve.fatal)switch(ve.type){case Gs.ErrorTypes.NETWORK_ERROR:((xt=ve.response)==null?void 0:xt.code)===0?(w("CORS/Network error - trying alternative method..."),T(`The stream server blocked the request. This is usually a CORS issue. Response code: ${(me=ve.response)==null?void 0:me.code}`)):(w(`Network error (${((De=ve.response)==null?void 0:De.code)||"unknown"})`),T(`Failed to load: ${ve.details}. The stream may be offline or unreachable.`)),we.startLoad();break;case Gs.ErrorTypes.MEDIA_ERROR:w("Media error - trying to recover..."),T(`Media decoding failed: ${ve.details}`),we.recoverMediaError();break;default:w(`Playback failed: ${ve.details}`),T(`Fatal error type: ${ve.type}`),E(!1);break}}),we.attachMedia(Ce),c.current=we}else Ce.canPlayType("application/vnd.apple.mpegurl")?(Ut("info","Using native HLS support (Safari)"),Ce.src=tt,Ce.addEventListener("loadedmetadata",()=>{Ut("debug","Native HLS: Metadata loaded"),E(!1),Ce.play().catch(()=>u(!1))})):(w("HLS is not supported in this browser"),T("Your browser does not support HLS playback. Try Chrome, Firefox, or Safari."),E(!1));else if(Ct==="mpegts")if(Xn.isSupported()){Ut("info","Creating MPEG-TS player",{url:tt,originalUrl:s});const we=Xn.createPlayer({type:s.toLowerCase().includes(".flv")?"flv":"mpegts",url:tt,isLive:!0,cors:!0},{enableWorker:!0,enableStashBuffer:!0,stashInitialSize:1024*1024,autoCleanupSourceBuffer:!0,autoCleanupMaxBackwardDuration:60,autoCleanupMinBackwardDuration:30,lazyLoad:!1,lazyLoadMaxDuration:0,lazyLoadRecoverDuration:0,deferLoadAfterSourceOpen:!1,liveBufferLatencyChasing:!1,liveBufferLatencyMaxLatency:10,liveBufferLatencyMinRemain:3});we.on(Xn.Events.ERROR,(bt,ve,xt)=>{Ut("error","MPEG-TS error",{errorType:bt,errorDetail:ve,errorInfo:xt}),w(`Stream error: ${bt}`),T(String(ve))}),we.on(Xn.Events.LOADING_COMPLETE,()=>{Ut("debug","MPEG-TS: Loading complete")}),we.on(Xn.Events.MEDIA_INFO,bt=>{Ut("info","MPEG-TS: Media info received",bt),E(!1)}),we.on(Xn.Events.STATISTICS_INFO,bt=>{bt.speed!==void 0&&bt.speed>0&&Ut("debug","MPEG-TS: Receiving data",{speed:bt.speed,decodedFrames:bt.decodedFrames})}),we.on(Xn.Events.METADATA_ARRIVED,bt=>{Ut("info","MPEG-TS: Metadata arrived",bt)}),we.attachMediaElement(Ce),we.load();try{we.play()}catch(bt){Ut("warn","MPEG-TS autoplay blocked",bt)}d.current=we,setTimeout(()=>{d.current&&E(!1)},5e3)}else Ut("error","MPEG-TS not supported in this browser"),w("MPEG-TS/FLV is not supported in this browser"),T("Your browser does not support MPEG-TS playback. Try Chrome or Edge."),E(!1);else if(Ct==="native")Ut("debug","Using native video playback"),Ce.src=tt,Ce.addEventListener("loadedmetadata",()=>{Ut("debug","Native: Metadata loaded"),E(!1),Ce.play().catch(()=>u(!1))}),Ce.addEventListener("error",we=>{var bt;Ut("error","Native video error",we),w("Failed to load video"),T(`Video element error: ${((bt=Ce.error)==null?void 0:bt.message)||"Unknown error"}`),E(!1)});else if(Ut("info","Unknown stream type, trying HLS"),Gs.isSupported()){const we=new Gs;we.on(Gs.Events.ERROR,(bt,ve)=>{ve.fatal&&(Ut("error","Default HLS error",ve),w("Could not play this stream format"),T(`HLS error: ${ve.details}`),E(!1))}),we.loadSource(tt),we.attachMedia(Ce),c.current=we}else Ce.src=tt}catch(tt){const Ct=tt instanceof Error?tt.message:typeof tt=="string"?tt:JSON.stringify(tt);Ut("error","Player initialization error",{message:Ct,type:typeof tt,err:tt}),w("Failed to initialize player"),T(Ct||"Unknown initialization error"),E(!1),G.current=!1}})();const ge=()=>{Ut("debug","Video playing"),u(!0)},Ze=()=>{Ut("debug","Video paused"),u(!1)},Me=tt=>{var we,bt;const Ct=tt.target;if(G.current){Ut("debug","Ignoring video error during FFmpeg initialization");return}Ut("error","Video element error",{error:Ct.error}),v||(w("Failed to play stream"),T(`Error code: ${(we=Ct.error)==null?void 0:we.code}, Message: ${(bt=Ct.error)==null?void 0:bt.message}`)),E(!1)},nt=()=>{Ut("debug","Video can play"),E(!1),w(null),T(null)},ht=()=>{Ut("debug","Video waiting/buffering")},Oe=()=>{Ut("warn","Video stalled")};return Ce.addEventListener("play",ge),Ce.addEventListener("pause",Ze),Ce.addEventListener("error",Me),Ce.addEventListener("canplay",nt),Ce.addEventListener("waiting",ht),Ce.addEventListener("stalled",Oe),()=>{Ce.removeEventListener("play",ge),Ce.removeEventListener("pause",Ze),Ce.removeEventListener("error",Me),Ce.removeEventListener("canplay",nt),Ce.removeEventListener("waiting",ht),Ce.removeEventListener("stalled",Oe),Pe()}},[a,s,z,O,W,r]);const ot=async()=>{await Pe(),D("proxy"),U(0),ee(null),V(!1),e()},ne=()=>{o.current&&(f?o.current.pause():o.current.play().catch(()=>{}))},ke=()=>{if(o.current){const Ce=!m;o.current.muted=Ce,g(Ce)}},Be=Ce=>{const _e=Math.max(0,Math.min(1,Ce));b(_e),o.current&&(o.current.volume=_e,_e>0&&m&&(o.current.muted=!1,g(!1)),_e===0&&(o.current.muted=!0,g(!0)))},qe=Ce=>{Ce.preventDefault();const _e=Ce.deltaY>0?-.05:.05;Be(x+_e)},dt=()=>{o.current&&(document.fullscreenElement?document.exitFullscreen():o.current.requestFullscreen().catch(()=>{}))},He=()=>{switch(R){case"hls":return"HLS";case"mpegts":return"MPEG-TS";case"native":return"Native";default:return"Unknown"}};return t.jsx(Bs,{appear:!0,show:a&&!!s,as:y.Fragment,afterLeave:()=>{document.querySelectorAll("[inert]").forEach(Ce=>{Ce.removeAttribute("inert")})},children:t.jsxs(Xs,{as:"div",className:"relative z-50",onClose:ot,children:[t.jsx(Bs.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t.jsx("div",{className:"fixed inset-0 bg-black/90"})}),t.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:t.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:t.jsx(Bs.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:t.jsxs(Xs.Panel,{className:"w-full max-w-5xl transform overflow-hidden rounded-lg bg-gradient-to-br from-gray-900 to-black border border-red-900/30 shadow-xl transition-all",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-red-900/30",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Xs.Title,{className:"text-lg font-bold text-white",children:n}),t.jsx("span",{className:"px-2 py-0.5 text-xs rounded bg-blue-600/30 text-blue-300 border border-blue-500/30",children:He()}),t.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${z==="proxy"?"bg-green-600/30 text-green-300":z==="ffmpeg"?"bg-purple-600/30 text-purple-300":"bg-yellow-600/30 text-yellow-300"}`,children:z==="proxy"?"Proxy":z==="ffmpeg"?"FFmpeg":"Direct"})]}),t.jsx("button",{onClick:ot,className:"p-1 rounded-lg hover:bg-gray-700 transition-colors",children:t.jsx(qt,{className:"w-6 h-6 text-gray-400"})})]}),t.jsxs("div",{className:"relative bg-black aspect-video",children:[k&&!v&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:t.jsxs("div",{className:"flex flex-col items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 border-4 border-red-500 border-t-transparent rounded-full animate-spin"}),t.jsx("span",{className:"text-gray-400",children:"Loading stream..."}),t.jsxs("span",{className:"text-gray-500 text-xs",children:["Mode: ",z]})]})}),v&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/80",children:t.jsxs("div",{className:"text-center p-6 max-w-lg",children:[t.jsx("div",{className:"text-red-400 text-lg mb-2",children:"Stream Error"}),t.jsx("div",{className:"text-gray-400 text-sm mb-2",children:v}),S&&t.jsx("div",{className:"text-gray-500 text-xs mb-4 p-2 bg-gray-900 rounded",children:S}),t.jsxs("div",{className:"mt-4 space-y-2",children:[t.jsxs("button",{onClick:Re,className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors mx-auto",children:[t.jsx(Dt,{className:"w-4 h-4"}),"Retry (try ",Qe(),")"]}),t.jsxs("div",{className:"text-xs text-gray-600",children:["Current: ",z," | Retries: ",O]})]}),t.jsxs("div",{className:"mt-4 text-xs text-gray-600 break-all",children:["URL: ",s==null?void 0:s.substring(0,80),"..."]})]})}),t.jsx("video",{ref:Ce=>{o.current=Ce,Ce&&!W&&(Ut("debug","Video element mounted",{channelId:r}),Ce.volume=x,Ce.muted=!1,V(!0))},className:"w-full h-full",controls:!1,playsInline:!0,autoPlay:!0,crossOrigin:"anonymous",onWheel:qe},`video-${r}`)]}),t.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-red-900/30 bg-black/30",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:ne,disabled:k||!!v,className:"p-2 rounded-lg bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:f?t.jsx(r3,{className:"w-6 h-6 text-white"}):t.jsx(nu,{className:"w-6 h-6 text-white"})}),t.jsx("button",{onClick:ke,disabled:k||!!v,className:"p-2 rounded-lg bg-gray-700 hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:m?"Unmute":"Mute",children:m||x===0?t.jsx(p3,{className:"w-6 h-6 text-white"}):t.jsx(ON,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{className:"flex items-center gap-2 group",onWheel:qe,title:`Volume: ${Math.round(x*100)}%`,children:[t.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:m?0:x,onChange:Ce=>Be(parseFloat(Ce.target.value)),disabled:k||!!v,className:`w-20 h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed\r
                          [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3\r
                          [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:cursor-pointer\r
                          [&::-webkit-slider-thumb]:hover:bg-red-400 [&::-webkit-slider-thumb]:transition-colors\r
                          [&::-moz-range-thumb]:w-3 [&::-moz-range-thumb]:h-3 [&::-moz-range-thumb]:rounded-full\r
                          [&::-moz-range-thumb]:bg-white [&::-moz-range-thumb]:border-0 [&::-moz-range-thumb]:cursor-pointer`}),t.jsxs("span",{className:"text-xs text-gray-400 w-8 text-right",children:[Math.round((m?0:x)*100),"%"]})]}),t.jsx("button",{onClick:Re,disabled:k,className:"p-2 rounded-lg bg-gray-700 hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Retry stream",children:t.jsx(Dt,{className:"w-6 h-6 text-white"})})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:`px-2 py-1 text-xs rounded ${f?"bg-green-600/30 text-green-300":"bg-yellow-600/30 text-yellow-300"}`,children:k?"Loading...":f?"Playing":"Paused"}),t.jsx("button",{onClick:()=>{F(!I),!I&&!te?Z():ae([...ro])},className:`p-2 rounded-lg transition-colors ${I?"bg-orange-600 hover:bg-orange-700":"bg-gray-700 hover:bg-gray-600"}`,title:"Debug stream",children:t.jsx(_S,{className:"w-6 h-6 text-white"})}),t.jsx("button",{onClick:dt,disabled:k||!!v,className:"p-2 rounded-lg bg-gray-700 hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:t.jsx(Qk,{className:"w-6 h-6 text-white"})})]})]}),I&&t.jsxs("div",{className:"p-4 border-t border-red-900/30 bg-gray-900/50 max-h-96 overflow-y-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("h3",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[t.jsx(_S,{className:"w-4 h-4"}),"Stream Diagnostics"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:Z,disabled:H,className:"px-3 py-1 text-xs bg-blue-600 hover:bg-blue-700 disabled:opacity-50 text-white rounded flex items-center gap-1",children:[t.jsx(Dt,{className:"w-3 h-3"}),"Refresh"]}),t.jsxs("button",{onClick:oe,className:"px-3 py-1 text-xs bg-gray-600 hover:bg-gray-700 text-white rounded flex items-center gap-1",children:[t.jsx(li,{className:"w-3 h-3"}),"Copy"]})]})]}),H&&t.jsxs("div",{className:"text-center py-4 text-gray-400",children:[t.jsx("div",{className:"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-2"}),"Testing stream connectivity..."]}),te&&!H&&t.jsxs("div",{className:"space-y-3 text-xs",children:[t.jsxs("div",{className:"p-2 bg-gray-800 rounded",children:[t.jsx("div",{className:"font-semibold text-gray-300 mb-1",children:"Stream Info"}),t.jsxs("div",{className:"text-gray-400 break-all",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"URL:"})," ",te.streamUrl]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Channel:"})," ",te.channelName," (ID: ",te.channelId,")"]}),te.streamType&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Type (URL):"})," ",te.streamType.fromUrl]}),te.streamType.fromContent&&t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Type (Content):"})," ",te.streamType.fromContent]}),te.streamType.contentTypeHeader&&t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Content-Type:"})," ",te.streamType.contentTypeHeader]})]})]})]}),te.headRequest&&t.jsxs("div",{className:"p-2 bg-gray-800 rounded",children:[t.jsx("div",{className:"font-semibold text-gray-300 mb-1",children:"HEAD Request"}),t.jsxs("div",{className:`${te.headRequest.success?"text-green-400":"text-red-400"}`,children:[te.headRequest.success?"":""," ",te.headRequest.statusCode," ",te.headRequest.statusReason,t.jsxs("span",{className:"text-gray-500 ml-2",children:["(",te.headRequest.responseTimeMs,"ms)"]})]}),te.headRequest.contentType&&t.jsxs("div",{className:"text-gray-400",children:["Content-Type: ",te.headRequest.contentType]}),te.headRequest.error&&t.jsxs("div",{className:"text-red-400",children:["Error: ",te.headRequest.error]})]}),te.getRequest&&t.jsxs("div",{className:"p-2 bg-gray-800 rounded",children:[t.jsx("div",{className:"font-semibold text-gray-300 mb-1",children:"GET Request (first 1KB)"}),t.jsxs("div",{className:`${te.getRequest.success?"text-green-400":"text-red-400"}`,children:[te.getRequest.success?"":""," ",te.getRequest.statusCode,t.jsxs("span",{className:"text-gray-500 ml-2",children:["(",te.getRequest.responseTimeMs,"ms, ",te.getRequest.bytesReceived," bytes)"]})]}),te.getRequest.detectedFormat&&t.jsxs("div",{className:"text-blue-400",children:["Detected: ",te.getRequest.detectedFormat]}),te.getRequest.error&&t.jsxs("div",{className:"text-red-400",children:["Error: ",te.getRequest.error]})]}),te.playability&&t.jsxs("div",{className:`p-2 rounded ${te.playability.canPlay?"bg-green-900/30":"bg-red-900/30"}`,children:[t.jsx("div",{className:"font-semibold text-gray-300 mb-1",children:"Playability Assessment"}),t.jsx("div",{className:`${te.playability.canPlay?"text-green-400":"text-red-400"} font-semibold`,children:te.playability.canPlay?" Stream appears playable":" Stream may have issues"}),te.playability.issues.length>0&&t.jsx("ul",{className:"text-yellow-400 mt-1 list-disc list-inside",children:te.playability.issues.map((Ce,_e)=>t.jsx("li",{children:Ce},_e))}),t.jsxs("div",{className:"text-gray-400 mt-1",children:[t.jsx("span",{className:"text-gray-500",children:"Recommendation:"})," ",te.playability.recommendation]})]}),te.error&&t.jsxs("div",{className:"p-2 bg-red-900/30 rounded text-red-400",children:["Error: ",te.error]})]}),t.jsxs("div",{className:"mt-3 p-2 bg-gray-800 rounded",children:[t.jsx("div",{className:"font-semibold text-gray-300 mb-1 text-xs",children:"Player Logs (last 20)"}),t.jsxs("div",{className:"font-mono text-[10px] text-gray-400 max-h-32 overflow-y-auto space-y-0.5",children:[q.slice(-20).map((Ce,_e)=>t.jsx("div",{className:`${Ce.includes("[ERROR]")?"text-red-400":Ce.includes("[WARN]")?"text-yellow-400":Ce.includes("[INFO]")?"text-blue-400":"text-gray-500"}`,children:Ce},_e)),q.length===0&&t.jsx("div",{className:"text-gray-500 italic",children:"No logs yet"})]})]})]})]})})})})]})})}const qh={name:"",type:"M3U",url:"",username:"",password:"",maxStreams:1,userAgent:""};function a8(){const[a,e]=y.useState(null),[s,r]=y.useState(!1);y.useEffect(()=>{s&&!a&&n()},[s]);const n=async()=>{try{const c=await at.get("/iptv/subscription-urls");e(c.data)}catch(c){console.error("Failed to load subscription URLs:",c)}},o=async(c,d)=>{try{await navigator.clipboard.writeText(c),be.success(`${d} copied to clipboard`)}catch{be.error("Failed to copy to clipboard")}};return t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-purple-900/30 rounded-lg overflow-hidden",children:[t.jsxs("button",{onClick:()=>r(!s),className:"w-full p-4 flex items-center justify-between text-left hover:bg-gray-800/30 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Fd,{className:"w-5 h-5 text-purple-400"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-white",children:"External App Subscription"}),t.jsx("p",{className:"text-sm text-gray-400",children:"Subscribe to Sportarr's filtered channels from external IPTV apps"})]})]}),t.jsx("span",{className:"text-gray-400",children:s?"":"+"})]}),s&&t.jsxs("div",{className:"p-6 border-t border-gray-800",children:[t.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Use these URLs to subscribe from external IPTV apps like TiviMate, IPTV Smarters, etc. Only enabled, non-hidden channels will be included in the filtered playlist."}),a?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"M3U Playlist (All Channels)"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",readOnly:!0,value:a.m3uUrl,className:"flex-1 px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm font-mono"}),t.jsx("button",{onClick:()=>o(a.m3uUrl,"M3U URL"),className:"px-3 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",title:"Copy to clipboard",children:t.jsx(li,{className:"w-5 h-5"})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"M3U Playlist (Sports Only)"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",readOnly:!0,value:a.m3uSportsOnlyUrl,className:"flex-1 px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm font-mono"}),t.jsx("button",{onClick:()=>o(a.m3uSportsOnlyUrl,"Sports M3U URL"),className:"px-3 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",title:"Copy to clipboard",children:t.jsx(li,{className:"w-5 h-5"})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"M3U Playlist (Favorites Only)"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",readOnly:!0,value:a.m3uFavoritesOnlyUrl,className:"flex-1 px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm font-mono"}),t.jsx("button",{onClick:()=>o(a.m3uFavoritesOnlyUrl,"Favorites M3U URL"),className:"px-3 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",title:"Copy to clipboard",children:t.jsx(li,{className:"w-5 h-5"})})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"EPG / TV Guide (XMLTV)"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",readOnly:!0,value:a.epgUrl,className:"flex-1 px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm font-mono"}),t.jsx("button",{onClick:()=>o(a.epgUrl,"EPG URL"),className:"px-3 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",title:"Copy to clipboard",children:t.jsx(li,{className:"w-5 h-5"})})]})]}),t.jsx("div",{className:"mt-4 p-3 bg-blue-950/30 border border-blue-900/50 rounded-lg",children:t.jsxs("p",{className:"text-blue-400 text-sm",children:[t.jsx("strong",{children:"Tip:"})," Use the Channels page to hide channels you don't want in the filtered playlist. Hidden and disabled channels will not appear in the exported M3U or EPG."]})})]}):t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx(Dt,{className:"w-6 h-6 animate-spin text-gray-400"})})]})]})}function n8(){const[a,e]=y.useState([]),[s,r]=y.useState(!0),[n,o]=y.useState(null),[c,d]=y.useState(!1),[f,u]=y.useState(null),[m,g]=y.useState(null),[x,b]=y.useState(qh),[v,w]=y.useState(null),[S,T]=y.useState([]),[k,E]=y.useState(null),[R,K]=y.useState(""),[z,D]=y.useState("sports"),[O,U]=y.useState([]),[I,F]=y.useState(""),[te,le]=y.useState(0),[H,X]=y.useState(!0),[q,ae]=y.useState(!1),ce=100,[ee,W]=y.useState(!1),[V,G]=y.useState(null),[Z,oe]=y.useState(null),[ye,je]=y.useState(null);y.useEffect(()=>{xe()},[]);const xe=async()=>{try{r(!0);const{data:Oe}=await at.get("/iptv/sources");e(Oe)}catch(Oe){o(Oe.message||"Failed to load IPTV sources")}finally{r(!1)}},Ee=async(Oe,tt=0,Ct=!0)=>{try{ae(!0);const we=tt*ce,bt=[at.get(`/iptv/sources/${Oe}/channels`,{params:{sportsOnly:z==="sports"?!0:void 0,search:R||void 0,group:I||void 0,limit:ce,offset:we}})];tt===0&&bt.push(at.get(`/iptv/sources/${Oe}/stats`),at.get(`/iptv/sources/${Oe}/groups`));const ve=await Promise.all(bt),xt=Array.isArray(ve[0].data)?ve[0].data:[];T(Ct?xt:me=>[...me,...xt]),le(tt),X(xt.length===ce),tt===0&&ve.length>1&&(E(ve[1].data),U(Array.isArray(ve[2].data)?ve[2].data:[]))}catch(we){be.error("Failed to load channels",{description:we.message})}finally{ae(!1)}},Pe=(Oe,tt)=>{b(Ct=>({...Ct,[Oe]:tt}))},Re=async()=>{try{o(null);const Oe=await at.post("/iptv/sources",x);e(tt=>[...tt,Oe.data]),d(!1),b(qh),be.success("Source Added",{description:`${x.name} has been added and channels synced`})}catch(Oe){o(Oe.message||"Failed to add source"),be.error("Failed to add source",{description:Oe.message})}},Qe=async()=>{if(f)try{o(null);const Oe={...x,password:x.password===Ce?"":x.password},tt=await at.put(`/iptv/sources/${f.id}`,Oe);e(Ct=>Ct.map(we=>we.id===f.id?tt.data:we)),u(null),b(qh),be.success("Source Updated",{description:`${x.name} has been updated`})}catch(Oe){o(Oe.message||"Failed to update source"),be.error("Failed to update source",{description:Oe.message})}},ot=async Oe=>{try{o(null),await at.delete(`/iptv/sources/${Oe}`),e(tt=>tt.filter(Ct=>Ct.id!==Oe)),g(null),be.success("Source Deleted")}catch(tt){o(tt.message||"Failed to delete source"),be.error("Failed to delete source",{description:tt.message})}},ne=async Oe=>{try{const tt=await at.post(`/iptv/sources/${Oe.id}/toggle`);e(Ct=>Ct.map(we=>we.id===Oe.id?tt.data:we)),be.success(tt.data.isActive?"Source Enabled":"Source Disabled")}catch(tt){be.error("Failed to toggle source",{description:tt.message})}},ke=async Oe=>{try{oe(Oe);const tt=await at.post(`/iptv/sources/${Oe}/sync`);await xe(),be.success("Channels Synced",{description:`Synced ${tt.data.channelCount} channels`})}catch(tt){be.error("Failed to sync channels",{description:tt.message})}finally{oe(null)}},Be=async()=>{try{W(!0),G(null);const Oe=await at.post("/iptv/sources/test",x);Oe.data.success?(G({success:!0,message:`Connection successful! Found ${Oe.data.channelCount||0} channels.`,channelCount:Oe.data.channelCount}),be.success("Test Successful")):(G({success:!1,message:Oe.data.error||"Connection failed"}),be.error("Test Failed",{description:Oe.data.error}))}catch(Oe){G({success:!1,message:Oe.message||"Connection test failed"}),be.error("Test Failed",{description:Oe.message})}finally{W(!1)}},[qe,dt]=y.useState(null),He=async Oe=>{try{dt(Oe);const tt=await at.post(`/iptv/channels/${Oe}/test`);T(Ct=>Ct.map(we=>we.id===Oe?{...we,status:tt.data.success?"Online":"Offline"}:we)),tt.data.success?be.success("Channel Online"):be.error("Channel Offline",{description:tt.data.error})}catch(tt){be.error("Failed to test channel",{description:tt.message})}finally{dt(null)}},Ce="",_e=Oe=>{u(Oe),b({name:Oe.name,type:Oe.type,url:Oe.url,username:Oe.username||"",password:Oe.hasPassword?Ce:"",maxStreams:Oe.maxStreams||1,userAgent:Oe.userAgent||""})},ge=async Oe=>{w(Oe),K(""),D("sports"),F(""),le(0),X(!0),await Ee(Oe.id,0,!0)},Ze=()=>{d(!1),u(null),b(qh),G(null)},Me=y.useMemo(()=>S,[S]),nt=()=>{const Oe=x.type==="Xtream";return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:"Source Settings"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Name *"}),t.jsx("input",{type:"text",value:x.name,onChange:tt=>Pe("name",tt.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"My IPTV Provider"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Type *"}),t.jsxs("select",{value:x.type,onChange:tt=>Pe("type",tt.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"M3U",children:"M3U Playlist"}),t.jsx("option",{value:"Xtream",children:"Xtream Codes API"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:Oe?"Server URL *":"Playlist URL *"}),t.jsx("input",{type:"text",value:x.url,onChange:tt=>Pe("url",tt.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:Oe?"http://server.example.com:8080":"http://example.com/playlist.m3u"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Oe?"The base URL of your Xtream Codes server (without /player_api.php)":"Direct URL to your M3U/M3U8 playlist file"})]}),Oe&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Username *"}),t.jsx("input",{type:"text",value:x.username,onChange:tt=>Pe("username",tt.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"Your username"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Password ",!f&&"*"]}),t.jsx("input",{type:"password",value:x.password,onChange:tt=>Pe("password",tt.target.value),onFocus:tt=>{x.password===Ce&&Pe("password","")},className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:f?"Leave blank to keep existing":"Your password"}),f&&x.password!==Ce&&t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank to keep the existing password, or enter a new one to update it"})]})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:"Advanced Settings"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Max Concurrent Streams"}),t.jsx("input",{type:"number",value:x.maxStreams,onChange:tt=>Pe("maxStreams",parseInt(tt.target.value)||1),min:"1",max:"10",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maximum number of simultaneous recordings from this source"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Custom User Agent"}),t.jsx("input",{type:"text",value:x.userAgent,onChange:tt=>Pe("userAgent",tt.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"Leave empty for default (VLC/3.0.18)"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Some providers require a specific user agent string"})]})]}),V&&t.jsx("div",{className:`p-4 rounded-lg ${V.success?"bg-green-950/30 border border-green-900/50":"bg-red-950/30 border border-red-900/50"}`,children:t.jsxs("div",{className:"flex items-center",children:[V.success?t.jsx(rs,{className:"w-5 h-5 text-green-400 mr-2"}):t.jsx(Ss,{className:"w-5 h-5 text-red-400 mr-2"}),t.jsx("span",{className:V.success?"text-green-400":"text-red-400",children:V.message})]})})]})},ht=()=>!(!x.name.trim()||!x.url.trim()||x.type==="Xtream"&&(!x.username.trim()||!f&&!x.password.trim()));return t.jsxs("div",{children:[t.jsx(Rn,{title:"IPTV Sources",subtitle:"Configure IPTV sources for DVR recording of sports events",showSaveButton:!1}),t.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[n&&t.jsxs("div",{className:"mb-6 bg-red-950/30 border border-red-900/50 rounded-lg p-4 flex items-start",children:[t.jsx(Ss,{className:"w-6 h-6 text-red-400 mr-3 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-lg font-semibold text-red-400 mb-1",children:"Error"}),t.jsx("p",{className:"text-sm text-gray-300",children:n})]}),t.jsx("button",{onClick:()=>o(null),className:"text-gray-400 hover:text-white ml-4",children:t.jsx(qt,{className:"w-5 h-5"})})]}),t.jsx("div",{className:"mb-8 bg-blue-950/30 border border-blue-900/50 rounded-lg p-6",children:t.jsxs("div",{className:"flex items-start",children:[t.jsx(_n,{className:"w-6 h-6 text-blue-400 mr-3 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"About IPTV Sources"}),t.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:"*"}),t.jsxs("span",{children:[t.jsx("strong",{children:"M3U Playlists:"})," Standard playlist format supported by most IPTV providers"]})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:"*"}),t.jsxs("span",{children:[t.jsx("strong",{children:"Xtream Codes:"})," API-based access with automatic EPG and category support"]})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:"*"}),t.jsx("span",{children:"Sports channels are automatically detected and can be mapped to leagues for DVR scheduling"})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:"*"}),t.jsx("span",{children:"Channel testing verifies stream connectivity before recording"})]})]})]})]})}),t.jsx(a8,{}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Your IPTV Sources"}),t.jsxs("button",{onClick:()=>d(!0),className:"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[t.jsx(hr,{className:"w-4 h-4 mr-2"}),"Add Source"]})]}),t.jsx("div",{className:"space-y-3",children:a.map(Oe=>t.jsx("div",{className:"group bg-black/30 border border-gray-800 hover:border-red-900/50 rounded-lg p-4 transition-all",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[t.jsx("div",{className:"mt-1",children:Oe.isActive?t.jsx(rs,{className:"w-6 h-6 text-green-500"}):t.jsx(Ss,{className:"w-6 h-6 text-gray-500"})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:Oe.name}),t.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${Oe.type==="M3U"?"bg-blue-900/30 text-blue-400":"bg-purple-900/30 text-purple-400"}`,children:Oe.type}),t.jsxs("span",{className:"px-2 py-0.5 bg-gray-800 text-gray-400 text-xs rounded",children:[Oe.channelCount," channels"]})]}),t.jsxs("div",{className:"space-y-1 text-sm text-gray-400",children:[t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-500",children:"URL:"})," ",t.jsx("span",{className:"text-white truncate",children:Oe.url})]}),Oe.lastUpdated&&t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-500",children:"Last Synced:"})," ",t.jsx("span",{className:"text-white",children:new Date(Oe.lastUpdated).toLocaleString()})]}),Oe.lastError&&t.jsxs("p",{className:"text-red-400",children:[t.jsx("span",{className:"text-gray-500",children:"Error:"})," ",Oe.lastError]})]})]})]}),t.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[t.jsx("button",{onClick:()=>ge(Oe),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",title:"View Channels",children:t.jsx(KR,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>ke(Oe.id),disabled:Z===Oe.id,className:`p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors ${Z===Oe.id?"animate-spin":""}`,title:"Sync Channels",children:t.jsx(Dt,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>ne(Oe),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",title:Oe.isActive?"Disable":"Enable",children:Oe.isActive?t.jsx(rs,{className:"w-5 h-5 text-green-400"}):t.jsx(Ss,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>_e(Oe),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",title:"Edit",children:t.jsx(an,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>g(Oe.id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-950/30 rounded transition-colors",title:"Delete",children:t.jsx(cs,{className:"w-5 h-5"})})]})]})},Oe.id))}),s&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-red-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500",children:"Loading IPTV sources..."})]}),!s&&a.length===0&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx(_n,{className:"w-16 h-16 text-gray-700 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500 mb-2",children:"No IPTV sources configured"}),t.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Add your M3U playlist or Xtream Codes credentials to get started"})]})]}),(c||f)&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 overflow-y-auto",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-2xl w-full my-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-2xl font-bold text-white",children:f?`Edit ${f.name}`:"Add IPTV Source"}),t.jsx("button",{onClick:Ze,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsx("div",{className:"max-h-[60vh] overflow-y-auto pr-2",children:nt()}),t.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-800 flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:Ze,className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:Be,disabled:!ht()||ee,className:`px-4 py-2 rounded-lg transition-colors ${ht()&&!ee?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-700 text-gray-500 cursor-not-allowed"}`,children:ee?"Testing...":"Test"}),t.jsx("button",{onClick:f?Qe:Re,disabled:!ht(),className:`px-4 py-2 rounded-lg transition-colors ${ht()?"bg-red-600 hover:bg-red-700 text-white":"bg-gray-700 text-gray-500 cursor-not-allowed"}`,children:f?"Save":"Add"})]})]})}),m!==null&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-md w-full",children:[t.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Delete Source?"}),t.jsx("p",{className:"text-gray-400 mb-6",children:"Are you sure you want to delete this IPTV source? This will also remove all associated channels and mappings. This action cannot be undone."}),t.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>g(null),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>ot(m),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Delete"})]})]})}),t.jsx(Q2,{isOpen:!!ye,onClose:()=>je(null),streamUrl:(ye==null?void 0:ye.streamUrl)||null,channelId:ye==null?void 0:ye.id,channelName:(ye==null?void 0:ye.name)||""}),v&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 overflow-y-auto",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-5xl w-full my-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{children:[t.jsxs("h3",{className:"text-2xl font-bold text-white",children:[v.name," Channels"]}),k&&t.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-400",children:[t.jsxs("span",{children:[k.totalCount," total"]}),t.jsxs("span",{className:"text-green-400",children:[k.sportsCount," sports"]}),t.jsxs("span",{className:"text-blue-400",children:[k.onlineCount," online"]}),t.jsxs("span",{className:"text-red-400",children:[k.offlineCount," offline"]})]})]}),t.jsx("button",{onClick:()=>w(null),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[t.jsx("div",{className:"flex-1",children:t.jsx("input",{type:"text",value:R,onChange:Oe=>{K(Oe.target.value)},onKeyDown:Oe=>{Oe.key==="Enter"&&Ee(v.id,0,!0)},className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"Search channels..."})}),t.jsxs("select",{value:z,onChange:Oe=>{D(Oe.target.value),Ee(v.id,0,!0)},className:"px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"all",children:"All Channels"}),t.jsx("option",{value:"sports",children:"Sports Only"})]}),O.length>0&&t.jsxs("select",{value:I,onChange:Oe=>{F(Oe.target.value),Ee(v.id,0,!0)},className:"px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"",children:"All Groups"}),O.map(Oe=>t.jsx("option",{value:Oe,children:Oe},Oe))]})]}),t.jsxs("div",{className:"max-h-[50vh] overflow-y-auto space-y-2",children:[Me.map(Oe=>t.jsxs("div",{className:"flex items-center justify-between bg-black/30 border border-gray-800 rounded-lg p-3",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[Oe.logoUrl?t.jsx("img",{src:Oe.logoUrl,alt:Oe.name,className:"w-8 h-8 rounded object-contain bg-gray-800",onError:tt=>{tt.target.style.display="none"}}):t.jsx("div",{className:"w-8 h-8 rounded bg-gray-800 flex items-center justify-center",children:t.jsx(_n,{className:"w-4 h-4 text-gray-600"})}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"text-white font-medium",children:Oe.name}),Oe.isSportsChannel&&t.jsx("span",{className:"px-1.5 py-0.5 bg-green-900/30 text-green-400 text-xs rounded",children:"Sports"})]}),Oe.group&&t.jsx("span",{className:"text-xs text-gray-500",children:Oe.group})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${Oe.status==="Online"?"bg-green-900/30 text-green-400":Oe.status==="Offline"?"bg-red-900/30 text-red-400":Oe.status==="Error"?"bg-yellow-900/30 text-yellow-400":"bg-gray-800 text-gray-400"}`,children:Oe.status}),t.jsx("button",{onClick:()=>He(Oe.id),disabled:qe===Oe.id,className:`p-1.5 text-gray-400 hover:text-green-400 hover:bg-gray-800 rounded transition-colors ${qe===Oe.id?"animate-pulse":""}`,title:"Test Connection",children:t.jsx(LN,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>je(Oe),className:"p-1.5 text-gray-400 hover:text-blue-400 hover:bg-gray-800 rounded transition-colors",title:"Play Stream",children:t.jsx(nu,{className:"w-4 h-4"})})]})]},Oe.id)),Me.length===0&&!q&&t.jsx("div",{className:"text-center py-8 text-gray-500",children:"No channels found"}),q&&t.jsx("div",{className:"text-center py-4",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-600 mx-auto"})}),H&&!q&&Me.length>0&&t.jsx("div",{className:"text-center py-4",children:t.jsx("button",{onClick:()=>Ee(v.id,te+1,!1),className:"px-4 py-2 bg-red-900/30 hover:bg-red-900/50 text-red-400 rounded-lg transition-colors",children:"Load More Channels"})})]}),t.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-800 flex items-center justify-between",children:[t.jsxs("span",{className:"text-sm text-gray-500",children:["Showing ",S.length," channels",k?` of ${k.totalCount} total`:""]}),t.jsx("button",{onClick:()=>w(null),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Close"})]})]})})]})]})}const Zg=100;function i8(){const[a,e]=y.useState([]),[s,r]=y.useState([]),[n,o]=y.useState(!0),[c,d]=y.useState(null),[f,u]=y.useState(0),[m,g]=y.useState(0),[x,b]=y.useState(!0),[v,w]=y.useState(""),[S,T]=y.useState(!0),[k,E]=y.useState(!1),[R,K]=y.useState(!1),[z,D]=y.useState("all"),[O,U]=y.useState(!1),[I,F]=y.useState(!1),[te,le]=y.useState(new Set),[H,X]=y.useState(!1),[q,ae]=y.useState(new Set),[ce,ee]=y.useState(!1),[W,V]=y.useState([]),[G,Z]=y.useState([]),[oe,ye]=y.useState(new Set),[je,xe]=y.useState(null),[Ee,Pe]=y.useState([]),[Re,Qe]=y.useState([]),[ot,ne]=y.useState(null),[ke,Be]=y.useState(new Set),[qe,dt]=y.useState(!1),[He,Ce]=y.useState(!1),[_e,ge]=y.useState(!1),[Ze,Me]=y.useState(null);y.useEffect(()=>{nt(0,!0),ht(),Oe()},[]),y.useEffect(()=>{nt(0,!0)},[S,k,O,R,q,te]);const nt=async(Ne=0,gt=!1)=>{try{o(!0);const jt=Ne*Zg,{data:vt}=await at.get("/iptv/channels",{params:{sportsOnly:S?!0:void 0,enabledOnly:k?!0:void 0,favoritesOnly:O?!0:void 0,hasEpgOnly:R?!0:void 0,search:v||void 0,groups:q.size>0?Array.from(q).join(","):void 0,countries:te.size>0?Array.from(te).join(","):void 0,limit:Zg,offset:jt}});e(gt?Array.isArray(vt)?vt:[]:os=>[...os,...Array.isArray(vt)?vt:[]]),g(Ne),b(vt.length===Zg),u(Ne===0?vt.length:os=>gt?vt.length:os+vt.length)}catch(jt){d(jt.message||"Failed to load channels")}finally{o(!1)}},ht=async()=>{try{const{data:Ne}=await at.get("/leagues");r(Array.isArray(Ne)?Ne:[])}catch(Ne){console.error("Failed to load leagues:",Ne),r([])}},Oe=async()=>{try{const[Ne,gt]=await Promise.all([at.get("/iptv/countries"),at.get("/iptv/groups")]);V(Array.isArray(Ne.data)?Ne.data:[]),Z(Array.isArray(gt.data)?gt.data:[])}catch(Ne){console.error("Failed to load filter options:",Ne),V([]),Z([])}},tt=y.useMemo(()=>a.filter(Ne=>{var gt,jt;if(!I&&Ne.isHidden||S&&!Ne.isSportsChannel||k&&!Ne.isEnabled||O&&!Ne.isFavorite||z!=="all"&&Ne.status.toLowerCase()!==z)return!1;if(te.size>0){const vt=((gt=Ne.country)==null?void 0:gt.trim())||"";if(!te.has(vt))return!1}if(q.size>0){const vt=((jt=Ne.group)==null?void 0:jt.trim())||"";if(!q.has(vt))return!1}if(v){const vt=v.toLowerCase();return Ne.name.toLowerCase().includes(vt)||Ne.group&&Ne.group.toLowerCase().includes(vt)}return!0}),[a,S,k,O,I,z,v,te,q]),Ct=Ne=>{ye(gt=>{const jt=new Set(gt);return jt.has(Ne)?jt.delete(Ne):jt.add(Ne),jt})},we=()=>{oe.size===tt.length&&tt.length>0?ye(new Set):ye(new Set(tt.map(Ne=>Ne.id)))},bt=async Ne=>{try{const{data:gt}=await at.post(`/iptv/channels/${Ne.id}/toggle`);e(jt=>jt.map(vt=>vt.id===Ne.id?gt:vt)),be.success(gt.isEnabled?"Channel Enabled":"Channel Disabled")}catch(gt){be.error("Failed to toggle channel",{description:gt.message})}},ve=async Ne=>{try{Be(jt=>new Set(jt).add(Ne));const{data:gt}=await at.post(`/iptv/channels/${Ne}/test`);e(jt=>jt.map(vt=>vt.id===Ne?{...vt,status:gt.success?"Online":"Offline",lastChecked:new Date().toISOString()}:vt)),gt.success?be.success("Channel Online"):be.error("Channel Offline",{description:gt.error})}catch(gt){be.error("Failed to test channel",{description:gt.message})}finally{Be(gt=>{const jt=new Set(gt);return jt.delete(Ne),jt})}},xt=async Ne=>{try{const{data:gt}=await at.post(`/iptv/channels/${Ne.id}/sports`,{isSportsChannel:!Ne.isSportsChannel});e(jt=>jt.map(vt=>vt.id===Ne.id?gt:vt)),be.success(gt.isSportsChannel?"Marked as Sports Channel":"Unmarked as Sports Channel")}catch(gt){be.error("Failed to update channel",{description:gt.message})}},me=async Ne=>{try{const gt=Array.from(oe);await at.post("/iptv/channels/bulk/enable",{channelIds:gt,enabled:Ne}),e(jt=>jt.map(vt=>gt.includes(vt.id)?{...vt,isEnabled:Ne}:vt)),ye(new Set),be.success(`${Ne?"Enabled":"Disabled"} ${gt.length} channels`)}catch(gt){be.error("Bulk operation failed",{description:gt.message})}},De=async()=>{try{dt(!0);const Ne=Array.from(oe),{data:gt}=await at.post("/iptv/channels/bulk/test",{channelIds:Ne}),jt=gt.results.filter(xs=>xs.success).length,vt=gt.results.filter(xs=>!xs.success).length,os=new Map(gt.results.map(xs=>[xs.channelId,xs.success]));e(xs=>xs.map(hs=>os.has(hs.id)?{...hs,status:os.get(hs.id)?"Online":"Offline",lastChecked:new Date().toISOString()}:hs)),be.success(`Tested ${Ne.length} channels`,{description:`${jt} online, ${vt} offline`})}catch(Ne){be.error("Bulk test failed",{description:Ne.message})}finally{dt(!1)}},ue=async()=>{try{Ce(!0);const{data:Ne}=await at.post("/iptv/channels/auto-map");Ne.success?(await nt(0,!0),be.success("Auto-mapping complete",{description:Ne.message})):be.error("Auto-mapping failed")}catch(Ne){be.error("Auto-mapping failed",{description:Ne.message})}finally{Ce(!1)}},Fe=async()=>{try{ge(!0);const{data:Ne}=await at.post("/epg/auto-map");Ne.mappedCount>0?(await nt(0,!0),be.success("EPG auto-mapping complete",{description:`Mapped ${Ne.mappedCount} channels to EPG data`})):be.info("No new channels to map",{description:"All channels are already mapped or no matching EPG channels found. Make sure you have synced an EPG source first."})}catch(Ne){be.error("EPG auto-mapping failed",{description:Ne.message})}finally{ge(!1)}},mt=async()=>{try{const{data:Ne}=await at.post("/iptv/leagues/update-preferred");Ne.success&&be.success("Preferred channels updated",{description:Ne.message})}catch(Ne){be.error("Failed to update preferred channels",{description:Ne.message})}},Se=async Ne=>{try{const gt=!Ne.isFavorite;await at.post(`/iptv/channels/${Ne.id}/favorite`,{isFavorite:gt}),e(jt=>jt.map(vt=>vt.id===Ne.id?{...vt,isFavorite:gt}:vt)),be.success(gt?"Added to Favorites":"Removed from Favorites")}catch(gt){be.error("Failed to update favorite status",{description:gt.message})}},st=async Ne=>{try{const gt=Array.from(oe);await at.post("/iptv/channels/bulk/favorite",{channelIds:gt,isFavorite:Ne}),e(jt=>jt.map(vt=>gt.includes(vt.id)?{...vt,isFavorite:Ne}:vt)),ye(new Set),be.success(`${Ne?"Added":"Removed"} ${gt.length} channels ${Ne?"to":"from"} favorites`)}catch(gt){be.error("Bulk favorite operation failed",{description:gt.message})}},wt=async Ne=>{try{const gt=!Ne.isHidden;await at.post(`/iptv/channels/${Ne.id}/hidden`,{isHidden:gt}),e(jt=>jt.map(vt=>vt.id===Ne.id?{...vt,isHidden:gt}:vt)),be.success(gt?"Channel Hidden":"Channel Visible")}catch(gt){be.error("Failed to update hidden status",{description:gt.message})}},yt=async Ne=>{try{const gt=Array.from(oe);await at.post("/iptv/channels/bulk/hidden",{channelIds:gt,isHidden:Ne}),e(jt=>jt.map(vt=>gt.includes(vt.id)?{...vt,isHidden:Ne}:vt)),ye(new Set),be.success(`${Ne?"Hid":"Showed"} ${gt.length} channels`)}catch(gt){be.error("Bulk hide operation failed",{description:gt.message})}},Mt=async()=>{try{const{data:Ne}=await at.post("/iptv/channels/hide-non-sports");Ne.success&&(await nt(0,!0),be.success("Non-sports channels hidden",{description:Ne.message}))}catch(Ne){be.error("Failed to hide non-sports channels",{description:Ne.message})}},Ke=async()=>{try{const{data:Ne}=await at.post("/iptv/channels/unhide-all");Ne.success&&(await nt(0,!0),be.success("All channels visible",{description:Ne.message}))}catch(Ne){be.error("Failed to unhide channels",{description:Ne.message})}},Vt=async Ne=>{xe(Ne);try{const{data:gt}=await at.get(`/iptv/channels/${Ne.id}/mappings`);Pe(gt),Qe(gt.map(vt=>vt.leagueId));const jt=gt.find(vt=>vt.isPreferred);ne((jt==null?void 0:jt.leagueId)||null)}catch(gt){be.error("Failed to load mappings",{description:gt.message})}},Nt=async()=>{if(je)try{await at.post("/iptv/channels/map",{channelId:je.id,leagueIds:Re,preferredLeagueId:ot}),await nt(),xe(null),be.success("Mappings saved",{description:`Mapped to ${Re.length} league(s)`})}catch(Ne){be.error("Failed to save mappings",{description:Ne.message})}},St=Ne=>{Qe(gt=>gt.includes(Ne)?(ot===Ne&&ne(null),gt.filter(jt=>jt!==Ne)):[...gt,Ne])},Kt=Ne=>{switch(Ne.toLowerCase()){case"online":return"bg-green-900/30 text-green-400";case"offline":return"bg-red-900/30 text-red-400";case"error":return"bg-yellow-900/30 text-yellow-400";default:return"bg-gray-800 text-gray-400"}},ws=Ne=>{switch(Ne==null?void 0:Ne.toUpperCase()){case"4K":return"bg-purple-900/30 text-purple-400";case"FHD":return"bg-blue-900/30 text-blue-400";case"HD":return"bg-green-900/30 text-green-400";case"SD":return"bg-yellow-900/30 text-yellow-400";default:return"bg-gray-800 text-gray-400"}};return t.jsxs("div",{className:"pb-8",children:[t.jsx(Rn,{title:"IPTV Channels",subtitle:"Manage channels across all IPTV sources and map them to leagues",showSaveButton:!1}),t.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[c&&t.jsxs("div",{className:"mb-6 bg-red-950/30 border border-red-900/50 rounded-lg p-4 flex items-start",children:[t.jsx(Ss,{className:"w-6 h-6 text-red-400 mr-3 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-lg font-semibold text-red-400 mb-1",children:"Error"}),t.jsx("p",{className:"text-sm text-gray-300",children:c})]}),t.jsx("button",{onClick:()=>d(null),className:"text-gray-400 hover:text-white ml-4",children:t.jsx(qt,{className:"w-5 h-5"})})]}),t.jsx("div",{className:"mb-8 bg-blue-950/30 border border-blue-900/50 rounded-lg p-6",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start",children:[t.jsx(_n,{className:"w-6 h-6 text-blue-400 mr-3 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Channel Management"}),t.jsxs("ul",{className:"space-y-1 text-sm text-gray-300",children:[t.jsxs("li",{children:[t.jsx("span",{className:"text-red-400 mr-2",children:"*"}),"Map channels to leagues to enable automatic DVR recording when events are scheduled"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-red-400 mr-2",children:"*"}),"Use ",t.jsx("strong",{children:"Auto-Map"})," to automatically detect networks (ESPN, Sky Sports, etc.) and map to leagues"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-red-400 mr-2",children:"*"}),t.jsx("strong",{children:"EPG mapping"})," links channels to EPG data for the TV Guide - sync EPG first in Settings > EPG Sources"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-red-400 mr-2",children:"*"}),"The highest quality channel (4K > FHD > HD > SD) is automatically selected for DVR recording"]})]})]})]}),t.jsxs("div",{className:"flex flex-col space-y-2 ml-4",children:[t.jsx("button",{onClick:ue,disabled:He,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors flex items-center space-x-2 disabled:opacity-50",children:He?t.jsxs(t.Fragment,{children:[t.jsx(Dt,{className:"w-4 h-4 animate-spin"}),t.jsx("span",{children:"Mapping..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(Fd,{className:"w-4 h-4"}),t.jsx("span",{children:"Auto-Map Leagues"})]})}),t.jsx("button",{onClick:Fe,disabled:_e,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors flex items-center space-x-2 disabled:opacity-50",children:_e?t.jsxs(t.Fragment,{children:[t.jsx(Dt,{className:"w-4 h-4 animate-spin"}),t.jsx("span",{children:"Mapping EPG..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(_n,{className:"w-4 h-4"}),t.jsx("span",{children:"Auto-Map EPG"})]})}),t.jsxs("button",{onClick:mt,className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors flex items-center space-x-2",children:[t.jsx(Dt,{className:"w-4 h-4"}),t.jsx("span",{children:"Update Preferred"})]})]})]})}),t.jsxs("div",{className:"mb-6 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-4",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[t.jsx("div",{className:"flex-1 min-w-[200px]",children:t.jsx("input",{type:"text",value:v,onChange:Ne=>w(Ne.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"Search channels..."})}),t.jsxs("div",{className:"flex items-center space-x-4 flex-wrap gap-2",children:[t.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:S,onChange:Ne=>T(Ne.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm text-gray-300",children:"Sports Only"})]}),t.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:O,onChange:Ne=>U(Ne.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-yellow-600 focus:ring-yellow-600"}),t.jsxs("span",{className:"text-sm text-gray-300 flex items-center space-x-1",children:[t.jsx(Ah,{className:"w-4 h-4 text-yellow-400"}),t.jsx("span",{children:"Favorites"})]})]}),t.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:k,onChange:Ne=>E(Ne.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm text-gray-300",children:"Enabled Only"})]}),t.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:R,onChange:Ne=>K(Ne.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm text-gray-300",children:"Has EPG Only"})]}),t.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:I,onChange:Ne=>F(Ne.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-gray-600 focus:ring-gray-600"}),t.jsxs("span",{className:"text-sm text-gray-300 flex items-center space-x-1",children:[t.jsx(pd,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{children:"Show Hidden"})]})]}),t.jsxs("select",{value:z,onChange:Ne=>D(Ne.target.value),className:"px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"all",children:"All Status"}),t.jsx("option",{value:"online",children:"Online"}),t.jsx("option",{value:"offline",children:"Offline"}),t.jsx("option",{value:"unknown",children:"Unknown"})]}),t.jsxs("div",{className:"relative",children:[t.jsxs("button",{onClick:()=>X(!H),className:`px-3 py-2 bg-gray-800 border rounded-lg text-sm flex items-center space-x-2 transition-colors ${te.size>0?"border-red-600 text-white":"border-gray-700 text-gray-300 hover:border-gray-600"}`,children:[t.jsx(Gf,{className:"w-4 h-4"}),t.jsx("span",{children:te.size===0?"All Countries":`${te.size} ${te.size===1?"Country":"Countries"}`}),t.jsx(As,{className:`w-4 h-4 transition-transform ${H?"rotate-180":""}`})]}),H&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>X(!1)}),t.jsxs("div",{className:"absolute top-full left-0 mt-1 w-64 max-h-80 overflow-y-auto bg-gray-900 border border-gray-700 rounded-lg shadow-xl z-20",children:[t.jsxs("div",{className:"sticky top-0 bg-gray-900 border-b border-gray-700 p-2 flex items-center justify-between",children:[t.jsxs("span",{className:"text-xs text-gray-400",children:[W.length," countries"]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>le(new Set(W)),className:"text-xs text-blue-400 hover:text-blue-300",children:"Select All"}),t.jsx("span",{className:"text-gray-600",children:"|"}),t.jsx("button",{onClick:()=>le(new Set),className:"text-xs text-gray-400 hover:text-gray-300",children:"Clear"})]})]}),t.jsx("div",{className:"p-1",children:W.length===0?t.jsx("div",{className:"px-3 py-4 text-sm text-gray-500 text-center",children:"No country data available"}):W.map(Ne=>t.jsxs("label",{className:"flex items-center space-x-2 px-3 py-1.5 hover:bg-gray-800 rounded cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:te.has(Ne),onChange:()=>{le(gt=>{const jt=new Set(gt);return jt.has(Ne)?jt.delete(Ne):jt.add(Ne),jt})},className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm text-gray-300",children:Ne})]},Ne))})]})]})]}),t.jsxs("div",{className:"relative",children:[t.jsxs("button",{onClick:()=>ee(!ce),className:`px-3 py-2 bg-gray-800 border rounded-lg text-sm flex items-center space-x-2 transition-colors ${q.size>0?"border-red-600 text-white":"border-gray-700 text-gray-300 hover:border-gray-600"}`,children:[t.jsx(au,{className:"w-4 h-4"}),t.jsx("span",{children:q.size===0?"All Groups":`${q.size} ${q.size===1?"Group":"Groups"}`}),t.jsx(As,{className:`w-4 h-4 transition-transform ${ce?"rotate-180":""}`})]}),ce&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>ee(!1)}),t.jsxs("div",{className:"absolute top-full left-0 mt-1 w-64 max-h-80 overflow-y-auto bg-gray-900 border border-gray-700 rounded-lg shadow-xl z-20",children:[t.jsxs("div",{className:"sticky top-0 bg-gray-900 border-b border-gray-700 p-2 flex items-center justify-between",children:[t.jsxs("span",{className:"text-xs text-gray-400",children:[G.length," groups"]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>ae(new Set(G)),className:"text-xs text-blue-400 hover:text-blue-300",children:"Select All"}),t.jsx("span",{className:"text-gray-600",children:"|"}),t.jsx("button",{onClick:()=>ae(new Set),className:"text-xs text-gray-400 hover:text-gray-300",children:"Clear"})]})]}),t.jsx("div",{className:"p-1",children:G.length===0?t.jsx("div",{className:"px-3 py-4 text-sm text-gray-500 text-center",children:"No group data available"}):G.map(Ne=>t.jsxs("label",{className:"flex items-center space-x-2 px-3 py-1.5 hover:bg-gray-800 rounded cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:q.has(Ne),onChange:()=>{ae(gt=>{const jt=new Set(gt);return jt.has(Ne)?jt.delete(Ne):jt.add(Ne),jt})},className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsx("span",{className:"text-sm text-gray-300",children:Ne})]},Ne))})]})]})]})]}),t.jsx("button",{onClick:()=>nt(0,!0),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",title:"Refresh",children:t.jsx(Dt,{className:"w-5 h-5"})})]}),oe.size>0&&t.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-800 flex items-center flex-wrap gap-2",children:[t.jsxs("span",{className:"text-sm text-gray-400",children:[oe.size," selected"]}),t.jsx("button",{onClick:()=>me(!0),className:"px-3 py-1.5 bg-green-900/30 hover:bg-green-900/50 text-green-400 rounded text-sm transition-colors",children:"Enable All"}),t.jsx("button",{onClick:()=>me(!1),className:"px-3 py-1.5 bg-red-900/30 hover:bg-red-900/50 text-red-400 rounded text-sm transition-colors",children:"Disable All"}),t.jsxs("button",{onClick:()=>st(!0),className:"px-3 py-1.5 bg-yellow-900/30 hover:bg-yellow-900/50 text-yellow-400 rounded text-sm transition-colors flex items-center space-x-1",children:[t.jsx(Ah,{className:"w-4 h-4"}),t.jsx("span",{children:"Favorite"})]}),t.jsxs("button",{onClick:()=>st(!1),className:"px-3 py-1.5 bg-gray-800 hover:bg-gray-700 text-gray-400 rounded text-sm transition-colors flex items-center space-x-1",children:[t.jsx(ES,{className:"w-4 h-4"}),t.jsx("span",{children:"Unfavorite"})]}),t.jsxs("button",{onClick:()=>yt(!0),className:"px-3 py-1.5 bg-gray-800 hover:bg-gray-700 text-gray-400 rounded text-sm transition-colors flex items-center space-x-1",children:[t.jsx(pd,{className:"w-4 h-4"}),t.jsx("span",{children:"Hide"})]}),t.jsxs("button",{onClick:()=>yt(!1),className:"px-3 py-1.5 bg-gray-800 hover:bg-gray-700 text-gray-400 rounded text-sm transition-colors flex items-center space-x-1",children:[t.jsx(Cd,{className:"w-4 h-4"}),t.jsx("span",{children:"Unhide"})]}),t.jsx("button",{onClick:De,disabled:qe,className:"px-3 py-1.5 bg-blue-900/30 hover:bg-blue-900/50 text-blue-400 rounded text-sm transition-colors disabled:opacity-50",children:qe?"Testing...":"Test All"}),t.jsx("button",{onClick:()=>ye(new Set),className:"px-3 py-1.5 text-gray-400 hover:text-white text-sm",children:"Clear Selection"})]}),t.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-800 flex items-center space-x-4",children:[t.jsxs("button",{onClick:Mt,className:"px-3 py-1.5 bg-gray-800 hover:bg-gray-700 text-gray-300 rounded text-sm transition-colors flex items-center space-x-1",children:[t.jsx(pd,{className:"w-4 h-4"}),t.jsx("span",{children:"Hide All Non-Sports"})]}),t.jsxs("button",{onClick:Ke,className:"px-3 py-1.5 bg-gray-800 hover:bg-gray-700 text-gray-300 rounded text-sm transition-colors flex items-center space-x-1",children:[t.jsx(Cd,{className:"w-4 h-4"}),t.jsx("span",{children:"Unhide All"})]})]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg overflow-hidden",children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-black/50 border-b border-gray-800",children:t.jsxs("tr",{children:[t.jsx("th",{className:"w-12 px-4 py-3",children:t.jsx("input",{type:"checkbox",checked:oe.size===tt.length&&tt.length>0,onChange:we,className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"})}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Channel"}),t.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-400",children:"Network"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-400",children:"Quality"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-400",children:"Status"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-400",children:"EPG"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-400",children:"Sports"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-400",children:"Mappings"}),t.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-400",children:"Actions"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-800",children:tt.map(Ne=>{var gt;return t.jsxs("tr",{className:`hover:bg-gray-800/30 ${oe.has(Ne.id)?"bg-red-950/20":""}`,children:[t.jsx("td",{className:"px-4 py-3",children:t.jsx("input",{type:"checkbox",checked:oe.has(Ne.id),onChange:()=>Ct(Ne.id),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[Ne.logoUrl?t.jsx("img",{src:Ne.logoUrl,alt:Ne.name,className:"w-8 h-8 rounded object-contain bg-gray-800",onError:jt=>{jt.target.style.display="none"}}):t.jsx("div",{className:"w-8 h-8 rounded bg-gray-800 flex items-center justify-center",children:t.jsx(_n,{className:"w-4 h-4 text-gray-600"})}),t.jsxs("div",{children:[t.jsxs("div",{className:"font-medium text-white flex items-center space-x-1",children:[t.jsx("span",{className:Ne.isHidden?"text-gray-500":"",children:Ne.name}),Ne.isFavorite&&t.jsx(Ah,{className:"w-3 h-3 text-yellow-400"}),Ne.isHidden&&t.jsx(pd,{className:"w-3 h-3 text-gray-500"})]}),Ne.channelNumber&&t.jsxs("div",{className:"text-xs text-gray-500",children:["Ch. ",Ne.channelNumber]})]})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"text-sm text-gray-400",children:Ne.detectedNetwork||Ne.group||"-"})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${ws(Ne.detectedQuality)}`,children:Ne.detectedQuality||"HD"})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${Kt(Ne.status)}`,children:Ne.status})}),t.jsx("td",{className:"px-4 py-3 text-center",children:Ne.tvgId?t.jsx("span",{className:"px-2 py-0.5 text-xs rounded bg-green-900/30 text-green-400 cursor-help",title:`EPG ID: ${Ne.tvgId}`,children:"Mapped"}):t.jsx("span",{className:"px-2 py-0.5 text-xs rounded bg-gray-800 text-gray-500",children:"-"})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsx("button",{onClick:()=>xt(Ne),className:`px-2 py-0.5 text-xs rounded transition-colors ${Ne.isSportsChannel?"bg-green-900/30 text-green-400 hover:bg-green-900/50":"bg-gray-800 text-gray-500 hover:bg-gray-700"}`,children:Ne.isSportsChannel?"Yes":"No"})}),t.jsx("td",{className:"px-4 py-3 text-center",children:t.jsxs("button",{onClick:()=>Vt(Ne),className:"flex items-center justify-center space-x-1 px-2 py-0.5 text-xs rounded bg-gray-800 text-gray-400 hover:bg-gray-700 hover:text-white transition-colors mx-auto",children:[t.jsx(Fd,{className:"w-3 h-3"}),t.jsx("span",{children:((gt=Ne.mappedLeagueIds)==null?void 0:gt.length)||0})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center justify-center space-x-1",children:[t.jsx("button",{onClick:()=>Se(Ne),className:"p-1.5 hover:bg-gray-800 rounded transition-colors",title:Ne.isFavorite?"Remove from Favorites":"Add to Favorites",children:Ne.isFavorite?t.jsx(Ah,{className:"w-4 h-4 text-yellow-400"}):t.jsx(ES,{className:"w-4 h-4 text-gray-400 hover:text-yellow-400"})}),t.jsx("button",{onClick:()=>wt(Ne),className:"p-1.5 text-gray-400 hover:bg-gray-800 rounded transition-colors",title:Ne.isHidden?"Show Channel":"Hide Channel",children:Ne.isHidden?t.jsx(pd,{className:"w-4 h-4 text-gray-500"}):t.jsx(Cd,{className:"w-4 h-4 hover:text-gray-300"})}),t.jsx("button",{onClick:()=>ve(Ne.id),disabled:ke.has(Ne.id),className:`p-1.5 text-gray-400 hover:text-green-400 hover:bg-gray-800 rounded transition-colors ${ke.has(Ne.id)?"animate-pulse":""}`,title:"Test Connection",children:t.jsx(LN,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>Me(Ne),className:"p-1.5 text-gray-400 hover:text-blue-400 hover:bg-gray-800 rounded transition-colors",title:"Play Stream",children:t.jsx(nu,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>bt(Ne),className:"p-1.5 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",title:Ne.isEnabled?"Disable":"Enable",children:Ne.isEnabled?t.jsx(rs,{className:"w-4 h-4 text-green-400"}):t.jsx(Ss,{className:"w-4 h-4"})})]})})]},Ne.id)})})]})}),n&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500",children:"Loading channels..."})]}),!n&&tt.length===0&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx(_n,{className:"w-12 h-12 text-gray-700 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500",children:"No channels found"}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.length>0?"Try adjusting your filters":"Add IPTV sources in the IPTV Sources settings page"})]}),t.jsxs("div",{className:"px-4 py-3 bg-black/30 border-t border-gray-800 flex items-center justify-between",children:[t.jsxs("span",{className:"text-sm text-gray-500",children:["Showing ",tt.length," of ",a.length," channels loaded"]}),x&&!n&&t.jsx("button",{onClick:()=>nt(m+1,!1),className:"px-4 py-1.5 bg-red-900/30 hover:bg-red-900/50 text-red-400 rounded text-sm transition-colors",children:"Load More"}),n&&m>0&&t.jsx("span",{className:"text-sm text-gray-400",children:"Loading more..."})]})]}),t.jsx(Q2,{isOpen:!!Ze,onClose:()=>Me(null),streamUrl:(Ze==null?void 0:Ze.streamUrl)||null,channelId:Ze==null?void 0:Ze.id,channelName:(Ze==null?void 0:Ze.name)||""}),je&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 overflow-y-auto",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-2xl w-full my-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-2xl font-bold text-white",children:"Map Channel to Leagues"}),t.jsx("p",{className:"text-gray-400 mt-1",children:je.name})]}),t.jsx("button",{onClick:()=>xe(null),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Select the leagues that this channel broadcasts. When events are scheduled for these leagues, Sportarr can automatically record them from this channel."}),t.jsx("div",{className:"max-h-80 overflow-y-auto space-y-2",children:s.map(Ne=>{const gt=Re.includes(Ne.id),jt=ot===Ne.id;return t.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border transition-colors cursor-pointer ${gt?"bg-red-950/30 border-red-900/50":"bg-black/30 border-gray-800 hover:border-gray-700"}`,onClick:()=>St(Ne.id),children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("input",{type:"checkbox",checked:gt,onChange:()=>St(Ne.id),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600",onClick:vt=>vt.stopPropagation()}),Ne.logoUrl?t.jsx("img",{src:Ne.logoUrl,alt:Ne.name,className:"w-8 h-8 rounded object-contain bg-gray-800"}):t.jsx("div",{className:"w-8 h-8 rounded bg-gray-800"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-white",children:Ne.name}),t.jsx("div",{className:"text-xs text-gray-500",children:Ne.sport})]})]}),gt&&t.jsx("button",{onClick:vt=>{vt.stopPropagation(),ne(jt?null:Ne.id)},className:`px-2 py-1 text-xs rounded transition-colors ${jt?"bg-yellow-900/30 text-yellow-400":"bg-gray-800 text-gray-500 hover:bg-gray-700"}`,children:jt?"Preferred":"Set Preferred"})]},Ne.id)})}),s.length===0&&t.jsxs("div",{className:"text-center py-8 text-gray-500",children:[t.jsx("p",{children:"No leagues available"}),t.jsx("p",{className:"text-sm mt-1",children:"Add leagues to your library first"})]})]}),t.jsxs("div",{className:"pt-6 border-t border-gray-800 flex items-center justify-between",children:[t.jsxs("span",{className:"text-sm text-gray-400",children:[Re.length," league(s) selected"]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("button",{onClick:()=>xe(null),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:Nt,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Save Mappings"})]})]})]})})]})]})}const Jg=[{value:0,label:"None",description:"Software encoding only (CPU)"},{value:1,label:"NVENC (NVIDIA)",description:"NVIDIA GPU hardware encoding",dockerRequirements:"Docker: --gpus=all, Environment: NVIDIA_DRIVER_CAPABILITIES=all, NVIDIA_VISIBLE_DEVICES=all"},{value:2,label:"QuickSync (Intel)",description:"Intel GPU hardware encoding",dockerRequirements:"Docker: devices: /dev/dri:/dev/dri (Intel 8th gen+ recommended)"},{value:3,label:"AMF (AMD)",description:"AMD GPU hardware encoding",dockerRequirements:"Docker: devices: /dev/dri:/dev/dri, /dev/kfd:/dev/kfd (Windows: use d3d11va)"},{value:4,label:"VAAPI (Linux)",description:"Linux hardware encoding (Intel/AMD)",dockerRequirements:"Docker: devices: /dev/dri:/dev/dri (requires mesa-va-drivers)"},{value:5,label:"VideoToolbox (macOS)",description:"macOS hardware encoding",dockerRequirements:"Native macOS only (not available in Docker)"},{value:99,label:"Auto-detect",description:"Automatically detect best available encoder"}],y_={defaultProfileId:1,recordingPath:"",fileNamingPattern:"{Title} - {Date}",prePaddingMinutes:5,postPaddingMinutes:30,maxConcurrentRecordings:0,deleteAfterImport:!1,recordingRetentionDays:0,hardwareAcceleration:99,ffmpegPath:"",enableReconnect:!0,maxReconnectAttempts:5,reconnectDelaySeconds:5,videoCodec:"copy",audioCodec:"copy",audioChannels:"original",audioBitrate:192,videoBitrate:0,container:"mp4"},Kh={eventTitle:"",channelId:0,scheduledStart:"",scheduledEnd:"",prePadding:5,postPadding:15};function o8(){var _,P;const{timezone:a}=Zf(),[e,s]=y.useState([]),[r,n]=y.useState(null),[o,c]=y.useState([]),[d,f]=y.useState(!0),[u,m]=y.useState(null),[g,x]=y.useState("All"),[b,v]=y.useState(new Set),[w,S]=y.useState(!1),[T,k]=y.useState(Kh),[E,R]=y.useState(null),[K,z]=y.useState(!1),[D,O]=y.useState(null),[U,I]=y.useState(""),[F,te]=y.useState(!1),[le,H]=y.useState(null),[X,q]=y.useState(y_),[ae,ce]=y.useState([]),[ee,W]=y.useState(!1),[V,G]=y.useState(!1),[Z,oe]=y.useState(!1),[ye,je]=y.useState(y_),[xe,Ee]=y.useState(null),[Pe,Re]=y.useState(!1),[Qe,ot]=y.useState(4),[ne,ke]=y.useState([]),[Be,qe]=y.useState(null),[dt,He]=y.useState(null),[Ce,_e]=y.useState(""),[ge,Ze]=y.useState({videoCodec:"copy",audioCodec:"copy",audioChannels:"original",audioBitrate:192,videoBitrate:8e3,container:"mkv"});y.useEffect(()=>{Me(),tt(),Ct(),bt(),we(),ve();const L=setInterval(nt,3e4);return()=>clearInterval(L)},[]),y.useEffect(()=>{nt()},[g]),y.useEffect(()=>{Be&&mt(Be,ge)},[Be]);const Me=async()=>{await Promise.all([nt(),ht(),Oe()])},nt=async()=>{try{f(!0);const L={};g!=="All"&&(L.status=g);const{data:$}=await at.get("/dvr/recordings",{params:L});s($)}catch(L){m(L.message||"Failed to load recordings")}finally{f(!1)}},ht=async()=>{try{const{data:L}=await at.get("/dvr/stats");n(L)}catch(L){console.error("Failed to load DVR stats:",L)}},Oe=async()=>{try{const{data:L}=await at.get("/iptv/channels",{params:{enabledOnly:!0}});c(L)}catch(L){console.error("Failed to load channels:",L)}},tt=async()=>{try{const{data:L}=await at.get("/dvr/ffmpeg/check");H(L.available)}catch{H(!1)}},Ct=async()=>{try{const{data:L}=await at.get("/dvr/settings");q(L),je(L),oe(!1),Ze({videoCodec:L.videoCodec||"copy",audioCodec:L.audioCodec||"copy",audioChannels:L.audioChannels||"original",audioBitrate:L.audioBitrate||192,videoBitrate:L.videoBitrate||0,container:L.container||"mp4"}),L.videoBitrate>0&&ot(De(L.videoBitrate))}catch(L){console.error("Failed to load DVR settings:",L)}},we=async()=>{try{const{data:L}=await at.get("/qualityprofile");if(ke(L),L.length>0){const $=L.find(J=>J.isDefault)||L[0];qe($.id)}}catch(L){console.error("Failed to load user quality profiles:",L)}},bt=async()=>{try{const{data:L}=await at.get("/dvr/hardware-acceleration");ce(L)}catch(L){console.error("Failed to load hardware acceleration info:",L)}},ve=async()=>{try{const L=await kt("/api/trash/naming-presets?enableMultiPartEpisodes=true");if(L.ok){const $=await L.json();He($)}}catch(L){console.error("Failed to load naming presets:",L)}},xt=L=>{var J;if(!((J=dt==null?void 0:dt.file)!=null&&J[L]))return;const $=dt.file[L];Se("fileNamingPattern",$.format),_e(L),be.success("Naming preset applied",{description:$.description})},me=L=>Math.round(L*1024*8*1e3/3600),De=L=>L*3600/(1024*8*1e3),ue=(L,$)=>{const J={...ge,[L]:$};Ze(J),q(de=>({...de,[L]:$})),oe(!0),mt(Be,J)},Fe=L=>{ot(L);const $=me(L),J={...ge,videoBitrate:$};Ze(J),q(de=>({...de,videoBitrate:$})),oe(!0),mt(Be,J)},mt=async(L,$)=>{const J=L??Be,de=$??ge;if(!J){Ee(null);return}try{Re(!0);const B=new URLSearchParams;B.append("qualityProfileId",J.toString()),B.append("sourceResolution","1080p");const se={videoCodec:de.videoCodec,audioCodec:de.audioCodec,audioChannels:de.audioChannels,audioBitrate:de.audioBitrate,videoBitrate:de.videoBitrate,container:de.container},{data:fe}=await at.post(`/dvr/profiles/calculate-scores?${B}`,se);Ee(fe)}catch(B){console.error("Failed to load score preview:",B),Ee(null)}finally{Re(!1)}},Se=(L,$)=>{q(J=>{const de={...J,[L]:$};return oe(JSON.stringify(de)!==JSON.stringify(ye)),de})},st=async()=>{try{G(!0),await at.put("/dvr/settings",X),je(X),oe(!1),be.success("DVR Settings Saved",{description:"Your DVR settings have been saved"})}catch(L){be.error("Failed to save settings",{description:L.message})}finally{G(!1)}},wt=()=>{q(ye),oe(!1)},yt=(L,$)=>{k(J=>({...J,[L]:$}))},Mt=async()=>{try{m(null);const L=await at.post("/dvr/recordings",T);s($=>[L.data,...$]),S(!1),k(Kh),await ht(),be.success("Recording Scheduled",{description:`${T.eventTitle} has been scheduled`})}catch(L){m(L.message||"Failed to schedule recording"),be.error("Failed to schedule recording",{description:L.message})}},Ke=async L=>{try{const $=await at.post(`/dvr/recordings/${L}/start`);$.data.success?(await nt(),await ht(),be.success("Recording Started")):be.error("Failed to start recording",{description:$.data.error})}catch($){be.error("Failed to start recording",{description:$.message})}},Vt=async L=>{try{const $=await at.post(`/dvr/recordings/${L}/stop`);$.data.success?(await nt(),await ht(),be.success("Recording Stopped")):be.error("Failed to stop recording",{description:$.data.error})}catch($){be.error("Failed to stop recording",{description:$.message})}},Nt=async L=>{try{await at.delete(`/dvr/recordings/${L}`),s($=>$.filter(J=>J.id!==L)),R(null),await ht(),be.success("Recording Deleted")}catch($){be.error("Failed to delete recording",{description:$.message})}},St=async()=>{const L=Array.from(b);if(L.length!==0)try{let $=0,J=0;for(const de of L)try{await at.delete(`/dvr/recordings/${de}`),$++}catch{J++}s(de=>de.filter(B=>!b.has(B.id))),v(new Set),await ht(),J>0?be.success(`Deleted ${$} recordings`,{description:`${J} failed to delete`}):be.success(`Deleted ${$} recordings`)}catch($){be.error("Failed to delete recordings",{description:$.message})}},Kt=L=>{v($=>{const J=new Set($);return J.has(L)?J.delete(L):J.add(L),J})},ws=()=>{const L=e.filter($=>$.status==="Scheduled"||$.status==="Completed"||$.status==="Failed"||$.status==="Cancelled"||$.status==="Imported");b.size===L.length&&L.length>0?v(new Set):v(new Set(L.map($=>$.id)))},Ne=L=>L.status==="Scheduled"||L.status==="Completed"||L.status==="Failed"||L.status==="Cancelled"||L.status==="Imported",gt=e.filter(Ne).length,jt=async L=>{try{const $=await at.post(`/dvr/recordings/${L}/import`);$.data.success?(await nt(),await ht(),be.success("Recording Imported",{description:"Recording has been added to your library"})):be.error("Failed to import recording",{description:$.data.error})}catch($){be.error("Failed to import recording",{description:$.message})}},vt=(L,$)=>{const J=new Date(L),B=new Date($).getTime()-J.getTime(),se=Math.floor(B/(1e3*60*60)),fe=Math.floor(B%(1e3*60*60)/(1e3*60));return se>0?`${se}h ${fe}m`:`${fe}m`},os=L=>{if(!L)return"0 B";const $=["B","KB","MB","GB","TB"];let J=0,de=L;for(;de>=1024&&J<$.length-1;)de/=1024,J++;return`${de.toFixed(1)} ${$[J]}`},xs=L=>{switch(L){case"Scheduled":return t.jsx($r,{className:"w-5 h-5 text-blue-400"});case"Recording":return t.jsx(ii,{className:"w-5 h-5 text-red-400 animate-pulse"});case"Completed":return t.jsx(rs,{className:"w-5 h-5 text-green-400"});case"Imported":return t.jsx(wS,{className:"w-5 h-5 text-green-400"});case"Failed":return t.jsx(Ss,{className:"w-5 h-5 text-red-400"});case"Cancelled":return t.jsx(qt,{className:"w-5 h-5 text-gray-400"});default:return t.jsx($r,{className:"w-5 h-5 text-gray-400"})}},hs=L=>{switch(L){case"Scheduled":return"bg-blue-900/30 text-blue-400";case"Recording":return"bg-red-900/30 text-red-400";case"Completed":return"bg-green-900/30 text-green-400";case"Imported":return"bg-green-900/30 text-green-400";case"Failed":return"bg-red-900/30 text-red-400";case"Cancelled":return"bg-gray-800 text-gray-400";default:return"bg-gray-800 text-gray-400"}},Yr=()=>T.eventTitle.trim()!==""&&T.channelId>0&&T.scheduledStart!==""&&T.scheduledEnd!=="",M=o.filter(L=>L.name.toLowerCase().includes(U.toLowerCase())),C=o.find(L=>L.id===T.channelId),j=L=>{yt("channelId",L),I(""),te(!1)};return t.jsxs("div",{className:"pb-8",children:[t.jsx(Rn,{title:"DVR Recordings",subtitle:"Manage scheduled and completed DVR recordings",showSaveButton:!1}),t.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[le===!1&&t.jsxs("div",{className:"mb-6 bg-yellow-950/30 border border-yellow-900/50 rounded-lg p-4 flex items-start",children:[t.jsx(Pr,{className:"w-6 h-6 text-yellow-400 mr-3 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-lg font-semibold text-yellow-400 mb-1",children:"FFmpeg Not Found"}),t.jsx("p",{className:"text-sm text-gray-300",children:"FFmpeg is required for DVR recordings. Please install FFmpeg and ensure it's available in your system PATH."})]})]}),u&&t.jsxs("div",{className:"mb-6 bg-red-950/30 border border-red-900/50 rounded-lg p-4 flex items-start",children:[t.jsx(Ss,{className:"w-6 h-6 text-red-400 mr-3 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-lg font-semibold text-red-400 mb-1",children:"Error"}),t.jsx("p",{className:"text-sm text-gray-300",children:u})]}),t.jsx("button",{onClick:()=>m(null),className:"text-gray-400 hover:text-white ml-4",children:t.jsx(qt,{className:"w-5 h-5"})})]}),r&&t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-8",children:[t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-gray-800 rounded-lg p-4",children:[t.jsx("div",{className:"text-2xl font-bold text-white",children:r.totalRecordings}),t.jsx("div",{className:"text-sm text-gray-400",children:"Total Recordings"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-blue-900/30 rounded-lg p-4",children:[t.jsx("div",{className:"text-2xl font-bold text-blue-400",children:r.scheduledCount}),t.jsx("div",{className:"text-sm text-gray-400",children:"Scheduled"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-4",children:[t.jsx("div",{className:"text-2xl font-bold text-red-400",children:r.recordingCount}),t.jsx("div",{className:"text-sm text-gray-400",children:"Recording Now"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-green-900/30 rounded-lg p-4",children:[t.jsx("div",{className:"text-2xl font-bold text-green-400",children:r.completedCount}),t.jsx("div",{className:"text-sm text-gray-400",children:"Completed"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-gray-800 rounded-lg p-4",children:[t.jsx("div",{className:"text-2xl font-bold text-white",children:os(r.totalStorageUsed)}),t.jsx("div",{className:"text-sm text-gray-400",children:"Storage Used"})]})]}),t.jsx("div",{className:"mb-8 bg-blue-950/30 border border-blue-900/50 rounded-lg p-6",children:t.jsxs("div",{className:"flex items-start",children:[t.jsx(ii,{className:"w-6 h-6 text-blue-400 mr-3 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"About DVR Recordings"}),t.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:"*"}),t.jsxs("span",{children:[t.jsx("strong",{children:"Automatic Recording:"})," Events with IPTV channel mappings are recorded automatically"]})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:"*"}),t.jsxs("span",{children:[t.jsx("strong",{children:"Manual Recording:"})," Schedule recordings for any channel and time"]})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:"*"}),t.jsxs("span",{children:[t.jsx("strong",{children:"Pre/Post Padding:"})," Start recording early and end late to capture full events"]})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"text-red-400 mr-2",children:"*"}),t.jsx("span",{children:"Recordings are saved using your chosen container format and encoding settings"})]})]})]})]})}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg overflow-hidden",children:[t.jsxs("button",{onClick:()=>W(!ee),className:"w-full flex items-center justify-between p-6 hover:bg-gray-800/30 transition-colors",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(ru,{className:"w-6 h-6 text-red-400 mr-3"}),t.jsxs("div",{className:"text-left",children:[t.jsx("h3",{className:"text-xl font-semibold text-white",children:"DVR Settings"}),t.jsx("p",{className:"text-sm text-gray-400",children:"Quality profiles, hardware acceleration, and recording options"})]})]}),ee?t.jsx(Js,{className:"w-5 h-5 text-gray-400"}):t.jsx(As,{className:"w-5 h-5 text-gray-400"})]}),ee&&t.jsxs("div",{className:"p-6 pt-0 border-t border-gray-800",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("h4",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:[t.jsx(En,{className:"w-5 h-5 mr-2 text-purple-400"}),"Recording Quality & Encoding"]}),t.jsx("div",{className:"mb-6 p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-white mb-2",children:[t.jsx(Sp,{className:"w-5 h-5 text-yellow-400"}),"Quality Profile for Scoring"]}),t.jsxs("select",{value:Be||"",onChange:L=>{const $=L.target.value?parseInt(L.target.value):null;qe($),mt($)},className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white text-sm focus:outline-none focus:border-red-500",children:[t.jsx("option",{value:"",children:"-- Select a Quality Profile --"}),ne.map(L=>t.jsxs("option",{value:L.id,children:[L.name," ",L.isDefault?"(Default)":""]},L.id))]}),t.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Scores will match your profile's custom format scores"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-white mb-2",children:[t.jsx(ii,{className:"w-5 h-5 text-blue-400"}),"Source Resolution"]}),t.jsxs("div",{className:"px-3 py-2 bg-gray-900/50 border border-gray-700 rounded-lg",children:[t.jsx("p",{className:"text-sm text-gray-300",children:"Auto-detected from channel"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Resolution is detected from each IPTV channel's name (4K, FHD, HD, SD) and used for quality scoring."})]})]})]})}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2 flex items-center gap-2",children:[t.jsx(Kr,{className:"w-4 h-4 text-yellow-400"}),"File Size: ",Qe.toFixed(1)," GB per hour"]}),t.jsx("input",{type:"range",min:"0.5",max:"50",step:"0.5",value:Qe,onChange:L=>Fe(parseFloat(L.target.value)),className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-red-600"}),t.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[t.jsx("span",{children:"0.5 GB/hr"}),t.jsx("span",{children:"50 GB/hr"})]}),t.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Video Bitrate: ",(ge.videoBitrate/1e3).toFixed(1)," Mbps"]})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2 flex items-center gap-2",children:[t.jsx(ii,{className:"w-4 h-4 text-purple-400"}),"Video Codec"]}),t.jsxs("select",{value:ge.videoCodec,onChange:L=>ue("videoCodec",L.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-red-600",children:[t.jsx("optgroup",{label:"Recommended",children:t.jsx("option",{value:"copy",children:"Original (Copy) - No transcoding"})}),t.jsxs("optgroup",{label:"H.264/AVC (Most Compatible)",children:[t.jsx("option",{value:"h264",children:"H.264 (x264) - Software"}),t.jsx("option",{value:"h264_nvenc",children:"H.264 (NVENC) - NVIDIA GPU"}),t.jsx("option",{value:"h264_qsv",children:"H.264 (QuickSync) - Intel GPU"}),t.jsx("option",{value:"h264_amf",children:"H.264 (AMF) - AMD GPU"})]}),t.jsxs("optgroup",{label:"H.265/HEVC (Better Compression)",children:[t.jsx("option",{value:"hevc",children:"H.265/HEVC (x265) - Software"}),t.jsx("option",{value:"hevc_nvenc",children:"H.265/HEVC (NVENC) - NVIDIA GPU"}),t.jsx("option",{value:"hevc_qsv",children:"H.265/HEVC (QuickSync) - Intel GPU"}),t.jsx("option",{value:"hevc_amf",children:"H.265/HEVC (AMF) - AMD GPU"})]}),t.jsxs("optgroup",{label:"Next-Gen Codecs",children:[t.jsx("option",{value:"av1",children:"AV1 (SVT-AV1) - Best compression, slow"}),t.jsx("option",{value:"av1_nvenc",children:"AV1 (NVENC) - RTX 40 series+"}),t.jsx("option",{value:"av1_qsv",children:"AV1 (QuickSync) - Intel Arc+"}),t.jsx("option",{value:"vvc",children:"H.266/VVC - Experimental"})]}),t.jsxs("optgroup",{label:"Other",children:[t.jsx("option",{value:"vp9",children:"VP9 - Google/YouTube codec"}),t.jsx("option",{value:"mpeg2",children:"MPEG-2 - Legacy compatibility"})]})]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'"Original" preserves source quality. GPU encoders are faster but may have slightly lower quality.'})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-3 flex items-center gap-2",children:[t.jsx(ON,{className:"w-4 h-4 text-green-400"}),"Audio Settings"]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Audio Codec"}),t.jsxs("select",{value:ge.audioCodec,onChange:L=>ue("audioCodec",L.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"copy",children:"Original (Copy)"}),t.jsx("option",{value:"aac",children:"AAC"}),t.jsx("option",{value:"ac3",children:"Dolby Digital (AC3)"}),t.jsx("option",{value:"eac3",children:"Dolby Digital+ (E-AC3)"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Audio Channels"}),t.jsxs("select",{value:ge.audioChannels,onChange:L=>ue("audioChannels",L.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"original",children:"Original"}),t.jsx("option",{value:"stereo",children:"Stereo (2.0)"}),t.jsx("option",{value:"5.1",children:"Surround (5.1)"})]})]})]}),t.jsxs("div",{className:"mt-3",children:[t.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Audio Bitrate (kbps)"}),t.jsx("input",{type:"number",value:ge.audioBitrate,onChange:L=>ue("audioBitrate",parseInt(L.target.value)||0),min:"64",max:"640",step:"32",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"128-192 kbps for stereo, 384-640 kbps for 5.1"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Container Format"}),t.jsxs("select",{value:ge.container,onChange:L=>ue("container",L.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-red-600",children:[t.jsxs("optgroup",{label:"Recommended",children:[t.jsx("option",{value:"mkv",children:"Matroska (.mkv) - Best features, all codecs"}),t.jsx("option",{value:"mp4",children:"MP4 (.mp4) - Best compatibility"})]}),t.jsxs("optgroup",{label:"Streaming",children:[t.jsx("option",{value:"ts",children:"MPEG-TS (.ts) - Live stream native"}),t.jsx("option",{value:"m2ts",children:"M2TS (.m2ts) - Blu-ray format"})]}),t.jsxs("optgroup",{label:"Other",children:[t.jsx("option",{value:"avi",children:"AVI (.avi) - Legacy format"}),t.jsx("option",{value:"webm",children:"WebM (.webm) - Web optimized (VP9/AV1)"}),t.jsx("option",{value:"mov",children:"QuickTime (.mov) - Apple devices"})]})]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"MKV supports all codecs and features. MP4 has best device compatibility. TS is native for IPTV."})]})]}),t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h4",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[t.jsx(f3,{className:"w-5 h-5 text-yellow-400"}),"Format Score Preview"]}),Be?Pe?t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-600"})}):xe?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"p-3 bg-gray-900/50 rounded-lg",children:[t.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Expected Quality"}),t.jsx("div",{className:"text-lg font-medium text-white",children:xe.qualityName}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:xe.formatDescription})]}),xe.matchedFormats&&xe.matchedFormats.length>0?t.jsxs("div",{className:"p-3 bg-gray-900/50 rounded-lg",children:[t.jsx("div",{className:"text-sm text-gray-400 mb-3",children:"Your Encoding Choices  Profile Scores"}),t.jsx("div",{className:"space-y-2",children:xe.matchedFormats.map((L,$)=>{const J=L.match(/^(.+?)\s*\(([+-]?\d+)\)$/),de=J?J[1]:L,B=J?parseInt(J[2]):0;return t.jsxs("div",{className:"flex items-center justify-between py-1.5 border-b border-gray-700/50 last:border-0",children:[t.jsx("span",{className:"text-sm text-gray-300",children:de}),t.jsxs("span",{className:`text-sm font-mono font-medium ${B>0?"text-green-400":B<0?"text-red-400":"text-gray-400"}`,children:[B>0?"+":"",B]})]},$)})})]}):t.jsx("div",{className:"p-3 bg-gray-900/50 rounded-lg text-center text-gray-500 text-sm",children:"No custom formats matched your encoding settings"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:"p-3 bg-gray-900/50 rounded-lg",children:[t.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Quality Score"}),t.jsx("div",{className:"text-lg font-bold text-blue-400",children:xe.qualityScore}),t.jsxs("div",{className:"text-xs text-gray-500",children:["Based on ",xe.qualityName]})]}),t.jsxs("div",{className:"p-3 bg-gray-900/50 rounded-lg",children:[t.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Custom Format Score"}),t.jsxs("div",{className:`text-lg font-bold ${xe.customFormatScore>=0?"text-green-400":"text-red-400"}`,children:[xe.customFormatScore>=0?"+":"",xe.customFormatScore]}),t.jsx("div",{className:"text-xs text-gray-500",children:"Sum of matched formats"})]})]}),t.jsx("div",{className:"p-4 bg-gradient-to-r from-gray-900 to-gray-800 rounded-lg border border-gray-600",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-400",children:"Total Score"}),t.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:"Quality + Custom Formats"})]}),t.jsx("div",{className:`text-2xl font-bold ${xe.totalScore>=0?"text-green-400":"text-red-400"}`,children:xe.totalScore})]})}),t.jsxs("div",{className:"pt-3 border-t border-gray-700",children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Scene Title Preview (for scoring)"}),t.jsx("code",{className:"text-xs text-gray-400 bg-black/50 px-2 py-1 rounded block overflow-x-auto",children:xe.syntheticTitle})]}),t.jsxs("div",{className:"text-xs text-gray-500 pt-2 border-t border-gray-700 space-y-1",children:[t.jsxs("p",{children:['Scores calculated using "',(_=ne.find(L=>L.id===Be))==null?void 0:_.name,'" profile (preview assumes 1080p source).']}),t.jsx("p",{className:"text-blue-400",children:"Actual scores will vary based on each channel's detected resolution (4K, FHD, HD, SD)."})]})]}):t.jsxs("div",{className:"text-center py-8 text-gray-500",children:[t.jsx("p",{children:"Unable to calculate scores"}),t.jsx("p",{className:"text-xs mt-1",children:"Make sure you have a quality profile configured"})]}):t.jsxs("div",{className:"text-center py-8 text-gray-500",children:[t.jsx(Sp,{className:"w-12 h-12 mx-auto mb-3 text-gray-600"}),t.jsx("p",{className:"font-medium",children:"Select a Quality Profile"}),t.jsx("p",{className:"text-xs mt-1",children:"Choose a quality profile above to see how your encoding choices will be scored."})]})]})]})]}),t.jsxs("div",{className:"mb-8",children:[t.jsxs("h4",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:[t.jsx(wR,{className:"w-5 h-5 mr-2 text-blue-400"}),"Hardware Acceleration"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Encoding Method"}),t.jsx("select",{value:X.hardwareAcceleration,onChange:L=>Se("hardwareAcceleration",parseInt(L.target.value)),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",children:Jg.map(L=>{const $=ae.find(de=>de.type===L.value),J=L.value===0||L.value===99||($==null?void 0:$.isAvailable);return t.jsxs("option",{value:L.value,children:[L.label," ",!J&&ae.length>0&&"(Not Detected)"]},L.value)})}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:(P=Jg.find(L=>L.value===X.hardwareAcceleration))==null?void 0:P.description}),(()=>{const L=X.hardwareAcceleration,$=Jg.find(B=>B.value===L),J=ae.find(B=>B.type===L),de=L===0||L===99||(J==null?void 0:J.isAvailable);return t.jsxs(t.Fragment,{children:[($==null?void 0:$.dockerRequirements)&&t.jsx("p",{className:"text-xs text-blue-400 mt-1 font-mono",children:$.dockerRequirements}),!de&&L!==0&&L!==99&&ae.length>0&&t.jsx("p",{className:"text-xs text-yellow-500 mt-1",children:" Not detected - ensure Docker has access to GPU device. Will fall back to software encoding if unavailable."})]})})()]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"FFmpeg Path (Optional)"}),t.jsx("input",{type:"text",value:X.ffmpegPath,onChange:L=>Se("ffmpegPath",L.target.value),placeholder:"Leave empty to use system PATH",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Custom path to FFmpeg binary"})]})]}),ae.length>0&&t.jsxs("div",{className:"mt-4 p-3 bg-gray-800/50 rounded-lg",children:[t.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Detected Hardware Encoders:"}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[ae.filter(L=>L.isAvailable).map(L=>t.jsx("span",{className:"px-2 py-1 bg-green-900/30 text-green-400 text-xs rounded",children:L.name},L.type)),ae.filter(L=>L.isAvailable).length===0&&t.jsx("span",{className:"text-gray-500 text-xs",children:"No hardware encoders detected - using software encoding"})]})]})]}),t.jsxs("div",{className:"mb-8",children:[t.jsxs("h4",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:[t.jsx(Kr,{className:"w-5 h-5 mr-2 text-yellow-400"}),"Storage Settings"]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Recording Path"}),t.jsx("input",{type:"text",value:X.recordingPath,onChange:L=>Se("recordingPath",L.target.value),placeholder:"Leave empty to use root folder",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Where to save recordings (empty = root folder)"})]}),t.jsxs("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-white",children:[t.jsx(MN,{className:"w-5 h-5 text-purple-400"}),"File Naming Pattern"]}),(dt==null?void 0:dt.file)&&Object.keys(dt.file).length>0&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(tl,{className:"w-4 h-4 text-purple-400"}),t.jsxs("select",{value:Ce,onChange:L=>xt(L.target.value),className:"px-3 py-1 bg-gray-900 border border-purple-700 rounded text-sm text-purple-200 focus:outline-none focus:border-purple-500",children:[t.jsx("option",{value:"",className:"bg-gray-900 text-gray-300",children:"TRaSH Naming Presets..."}),Object.entries(dt.file).map(([L,$])=>t.jsxs("option",{value:L,className:"bg-gray-900 text-white",children:[L.replace(/-/g," ").replace(/\b\w/g,J=>J.toUpperCase()),$.supportsMultiPart?" (Multi-Part)":""]},L))]})]})]}),t.jsx("input",{type:"text",value:X.fileNamingPattern,onChange:L=>{Se("fileNamingPattern",L.target.value),_e("")},placeholder:"{Series} - {Season}{Episode}{Part} - {Event Title} - {Quality Full}",className:"w-full px-4 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white font-mono text-sm focus:outline-none focus:border-red-600"}),t.jsxs("div",{className:"mt-3 p-3 bg-black/30 rounded-lg border border-gray-800",children:[t.jsx("p",{className:"text-xs font-medium text-gray-400 mb-2",children:"Available Tokens (click to insert):"}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[{token:"{Series}",desc:"League name",category:"Plex"},{token:"{Season}",desc:"s2024",category:"Plex"},{token:"{Episode}",desc:"e12",category:"Plex"},{token:"{Part}",desc:"pt1/pt2/pt3",category:"Plex"},{token:"{Event Title}",desc:"Event name",category:"Event"},{token:"{Air Date}",desc:"2024-04-13",category:"Event"},{token:"{Quality Full}",desc:"HDTV-1080p",category:"Quality"},{token:"{Release Group}",desc:"DVR",category:"Release"}].map(L=>t.jsxs("button",{type:"button",onClick:()=>{const $=X.fileNamingPattern||"";Se("fileNamingPattern",$+L.token),_e("")},className:"text-left px-2 py-1.5 bg-gray-800 hover:bg-gray-700 border border-gray-700 hover:border-purple-600 rounded text-xs transition-colors group",children:[t.jsx("div",{className:"font-mono text-purple-400 group-hover:text-purple-300",children:L.token}),t.jsx("div",{className:"text-gray-500 text-[10px]",children:L.desc})]},L.token))})]}),t.jsxs("div",{className:"mt-3 p-3 bg-gradient-to-r from-blue-950/30 to-purple-950/30 border border-blue-900/50 rounded-lg",children:[t.jsx("p",{className:"text-xs font-medium text-blue-300 mb-1",children:"Preview:"}),t.jsxs("p",{className:"text-white font-mono text-sm break-all",children:[(X.fileNamingPattern||"{Title} - {Date}").replace(/{Series}/gi,"UFC").replace(/{Season}/gi,"s2024").replace(/{Episode}/gi,"e12").replace(/{Part}/gi," - pt3").replace(/{Event Title}/gi,"UFC 315").replace(/{Title}/gi,"UFC 315").replace(/{Air Date}/gi,"2024-12-26").replace(/{Date}/gi,"2024-12-26").replace(/{League}/gi,"UFC").replace(/{Channel}/gi,"ESPN").replace(/{Quality Full}/gi,"HDTV-1080p").replace(/{Quality}/gi,"1080p").replace(/{Release Group}/gi,"DVR"),".mkv"]}),t.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:"Using TRaSH-compatible naming ensures Plex and other media players recognize your recordings correctly"})]}),t.jsxs("div",{className:"mt-3 p-2 bg-blue-950/20 border border-blue-900/30 rounded text-xs text-gray-400",children:[t.jsx(Or,{className:"w-4 h-4 text-blue-400 inline mr-1"}),"Use the same naming format as your Media Management settings for consistent file organization across DVR recordings and imported files."]})]})]}),t.jsxs("div",{className:"mb-8",children:[t.jsxs("h4",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:[t.jsx($r,{className:"w-5 h-5 mr-2 text-green-400"}),"Recording Padding"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Pre-Padding (minutes)"}),t.jsx("input",{type:"number",value:X.prePaddingMinutes,onChange:L=>Se("prePaddingMinutes",parseInt(L.target.value)||0),min:"0",max:"60",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Start recording before scheduled time"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Post-Padding (minutes)"}),t.jsx("input",{type:"number",value:X.postPaddingMinutes,onChange:L=>Se("postPaddingMinutes",parseInt(L.target.value)||0),min:"0",max:"180",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Continue recording after scheduled end (for overtime)"})]})]})]}),t.jsxs("div",{className:"mb-8",children:[t.jsx("h4",{className:"text-lg font-semibold text-white mb-4",children:"Advanced Settings"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Max Concurrent Recordings"}),t.jsx("input",{type:"number",value:X.maxConcurrentRecordings,onChange:L=>Se("maxConcurrentRecordings",parseInt(L.target.value)||0),min:"0",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"0 = unlimited"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Recording Retention (days)"}),t.jsx("input",{type:"number",value:X.recordingRetentionDays,onChange:L=>Se("recordingRetentionDays",parseInt(L.target.value)||0),min:"0",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"0 = keep forever"})]}),t.jsx("div",{className:"flex items-center",children:t.jsxs("label",{className:"flex items-center cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:X.deleteAfterImport,onChange:L=>Se("deleteAfterImport",L.target.checked),className:"w-4 h-4 text-red-600 bg-gray-800 border-gray-700 rounded focus:ring-red-500"}),t.jsx("span",{className:"ml-2 text-sm text-gray-300",children:"Delete after import"})]})})]})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h4",{className:"text-lg font-semibold text-white mb-4",children:"Stream Reconnection"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsx("div",{className:"flex items-center",children:t.jsxs("label",{className:"flex items-center cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:X.enableReconnect,onChange:L=>Se("enableReconnect",L.target.checked),className:"w-4 h-4 text-red-600 bg-gray-800 border-gray-700 rounded focus:ring-red-500"}),t.jsx("span",{className:"ml-2 text-sm text-gray-300",children:"Enable auto-reconnect"})]})}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Max Reconnect Attempts"}),t.jsx("input",{type:"number",value:X.maxReconnectAttempts,onChange:L=>Se("maxReconnectAttempts",parseInt(L.target.value)||1),min:"1",max:"20",disabled:!X.enableReconnect,className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600 disabled:opacity-50"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Reconnect Delay (seconds)"}),t.jsx("input",{type:"number",value:X.reconnectDelaySeconds,onChange:L=>Se("reconnectDelaySeconds",parseInt(L.target.value)||1),min:"1",max:"60",disabled:!X.enableReconnect,className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600 disabled:opacity-50"})]})]})]}),Z&&t.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-gray-800",children:[t.jsx("button",{onClick:wt,className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Reset"}),t.jsx("button",{onClick:st,disabled:V,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors disabled:opacity-50",children:V?"Saving...":"Save Settings"})]})]})]}),t.jsxs("div",{className:"mb-8 bg-gradient-to-br from-gray-900 to-black border border-red-900/30 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Recordings"}),t.jsxs("select",{value:g,onChange:L=>x(L.target.value),className:"px-3 py-1.5 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm focus:outline-none focus:border-red-600",children:[t.jsx("option",{value:"All",children:"All Status"}),t.jsx("option",{value:"Scheduled",children:"Scheduled"}),t.jsx("option",{value:"Recording",children:"Recording"}),t.jsx("option",{value:"Completed",children:"Completed"}),t.jsx("option",{value:"Imported",children:"Imported"}),t.jsx("option",{value:"Failed",children:"Failed"}),t.jsx("option",{value:"Cancelled",children:"Cancelled"})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:nt,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",title:"Refresh",children:t.jsx(Dt,{className:"w-5 h-5"})}),t.jsxs("button",{onClick:()=>S(!0),disabled:le===!1,className:`flex items-center px-4 py-2 rounded-lg transition-colors ${le!==!1?"bg-red-600 hover:bg-red-700 text-white":"bg-gray-700 text-gray-500 cursor-not-allowed"}`,children:[t.jsx(hr,{className:"w-4 h-4 mr-2"}),"Manual Recording"]})]})]}),gt>0&&t.jsxs("div",{className:"flex items-center justify-between mb-4 pb-4 border-b border-gray-800",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:b.size===gt&&gt>0,onChange:ws,className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"}),t.jsxs("span",{className:"text-sm text-gray-300",children:["Select All (",gt,")"]})]}),b.size>0&&t.jsxs("span",{className:"text-sm text-gray-400",children:[b.size," selected"]})]}),b.size>0&&t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("button",{onClick:()=>z(!0),className:"flex items-center px-3 py-1.5 bg-red-900/30 hover:bg-red-900/50 text-red-400 rounded text-sm transition-colors",children:[t.jsx(cs,{className:"w-4 h-4 mr-1"}),"Delete Selected (",b.size,")"]}),t.jsx("button",{onClick:()=>v(new Set),className:"px-3 py-1.5 text-gray-400 hover:text-white text-sm",children:"Clear Selection"})]})]}),t.jsx("div",{className:"space-y-3",children:e.map(L=>t.jsx("div",{className:`group bg-black/30 border rounded-lg p-4 transition-all ${b.has(L.id)?"border-red-600 bg-red-950/20":"border-gray-800 hover:border-red-900/50"}`,children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[Ne(L)&&t.jsx("div",{className:"mt-1",children:t.jsx("input",{type:"checkbox",checked:b.has(L.id),onChange:()=>Kt(L.id),className:"w-4 h-4 rounded border-gray-600 bg-gray-800 text-red-600 focus:ring-red-600"})}),t.jsx("div",{className:"mt-1",children:xs(L.status)}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[t.jsx("h4",{className:"text-lg font-semibold text-white",children:L.eventTitle}),t.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${hs(L.status)}`,children:L.status}),L.leagueName&&t.jsx("span",{className:"px-2 py-0.5 bg-purple-900/30 text-purple-400 text-xs rounded",children:L.leagueName})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-400",children:[t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-500",children:"Channel:"})," ",t.jsx("span",{className:"text-white",children:L.channelName})]}),t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-500",children:"Duration:"})," ",t.jsx("span",{className:"text-white",children:vt(L.scheduledStart,L.scheduledEnd)})]}),t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-500",children:"Start:"})," ",t.jsxs("span",{className:"text-white",children:[ti(L.scheduledStart,a,{month:"2-digit",day:"2-digit",year:"numeric"}),", ",Fo(L.scheduledStart,a,{hour:"2-digit",minute:"2-digit",second:"2-digit"})]})]}),t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-500",children:"End:"})," ",t.jsxs("span",{className:"text-white",children:[ti(L.scheduledEnd,a,{month:"2-digit",day:"2-digit",year:"numeric"}),", ",Fo(L.scheduledEnd,a,{hour:"2-digit",minute:"2-digit",second:"2-digit"})]})]}),L.fileSize&&L.fileSize>0&&t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-500",children:"File Size:"})," ",t.jsx("span",{className:"text-white",children:os(L.fileSize)})]}),L.status==="Scheduled"&&L.expectedQualityName&&t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-500",children:"Expected Quality:"})," ",t.jsx("span",{className:"text-amber-400",children:L.expectedQualityName})]}),L.status==="Scheduled"&&L.expectedTotalScore!==void 0&&t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-500",children:"Expected Score:"})," ",t.jsxs("span",{className:`font-semibold ${L.expectedTotalScore>=0?"text-green-400":"text-red-400"}`,children:[L.expectedTotalScore>=0?"+":"",L.expectedTotalScore]}),t.jsxs("span",{className:"text-gray-600 text-xs ml-1",children:["(Q:",L.expectedQualityScore??0," + CF:",L.expectedCustomFormatScore??0,")"]})]}),L.status==="Scheduled"&&L.expectedMatchedFormats&&L.expectedMatchedFormats.length>0&&t.jsxs("div",{className:"col-span-2",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("span",{className:"text-gray-500",children:"Expected Formats:"}),t.jsxs("span",{className:"text-gray-600 text-xs",children:["(",L.expectedMatchedFormats.length,")"]})]}),t.jsx("div",{className:"max-h-24 overflow-y-auto bg-black/30 rounded p-2",children:t.jsx("div",{className:"flex flex-wrap gap-1",children:L.expectedMatchedFormats.slice().sort(($,J)=>{const de=fe=>{const he=fe.match(/\(([+-]?\d+)\)$/);return he?parseInt(he[1]):0},B=de($),se=de(J);return se!==B?se-B:$.localeCompare(J)}).map(($,J)=>{const de=$.match(/\(([+-]?\d+)\)$/),B=de?parseInt(de[1]):0,se=de?$.replace(/\s*\([+-]?\d+\)$/,""):$,fe=de?de[1]:null;return t.jsxs("span",{className:`text-xs px-1.5 py-0.5 rounded whitespace-nowrap ${B>0?"bg-green-900/30 text-green-400":B<0?"bg-red-900/30 text-red-400":"bg-gray-700/50 text-gray-300"}`,children:[se,fe&&t.jsxs("span",{className:"ml-1 opacity-75",children:["(",B>0?"+":"",B,")"]})]},J)})})})]}),(L.status==="Completed"||L.status==="Imported")&&L.quality&&t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-500",children:"Quality:"})," ",t.jsx("span",{className:"text-green-400",children:L.quality})]}),(L.status==="Completed"||L.status==="Imported")&&L.qualityScore!==void 0&&t.jsxs("p",{children:[t.jsx("span",{className:"text-gray-500",children:"Score:"})," ",t.jsxs("span",{className:`font-semibold ${L.qualityScore+(L.customFormatScore??0)>=0?"text-green-400":"text-red-400"}`,children:[L.qualityScore+(L.customFormatScore??0)>=0?"+":"",L.qualityScore+(L.customFormatScore??0)]}),t.jsxs("span",{className:"text-gray-600 text-xs ml-1",children:["(Q:",L.qualityScore," + CF:",L.customFormatScore??0,")"]})]}),L.errorMessage&&t.jsxs("p",{className:"col-span-2 text-red-400",children:[t.jsx("span",{className:"text-gray-500",children:"Error:"})," ",L.errorMessage]})]})]})]}),t.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[L.status==="Scheduled"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>Ke(L.id),className:"p-2 text-gray-400 hover:text-green-400 hover:bg-green-950/30 rounded transition-colors",title:"Start Now",children:t.jsx(nu,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>R(L.id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-950/30 rounded transition-colors",title:"Delete",children:t.jsx(cs,{className:"w-5 h-5"})})]}),L.status==="Recording"&&t.jsx("button",{onClick:()=>Vt(L.id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-950/30 rounded transition-colors",title:"Stop Recording",children:t.jsx(_d,{className:"w-5 h-5"})}),L.status==="Completed"&&L.outputPath&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>O(L),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",title:"View Details",children:t.jsx(En,{className:"w-5 h-5"})}),L.eventId&&t.jsx("button",{onClick:()=>jt(L.id),className:"p-2 text-gray-400 hover:text-green-400 hover:bg-green-950/30 rounded transition-colors",title:"Import to Library",children:t.jsx(wS,{className:"w-5 h-5"})})]}),L.status==="Imported"&&t.jsx("span",{className:"px-2 py-1 bg-green-900/30 text-green-400 text-xs rounded",children:"Imported"}),(L.status==="Completed"||L.status==="Failed"||L.status==="Cancelled")&&t.jsx("button",{onClick:()=>R(L.id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-950/30 rounded transition-colors",title:"Delete",children:t.jsx(cs,{className:"w-5 h-5"})})]})]})},L.id))}),d&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-red-600 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500",children:"Loading recordings..."})]}),!d&&e.length===0&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx(ii,{className:"w-16 h-16 text-gray-700 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-500 mb-2",children:"No recordings found"}),t.jsx("p",{className:"text-sm text-gray-400",children:g!=="All"?`No ${g.toLowerCase()} recordings`:"Schedule a recording or add events with IPTV channel mappings"})]})]}),w&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 overflow-y-auto",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-8 max-w-3xl w-full my-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-2xl font-bold text-white",children:"Schedule Manual Recording"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Record any channel at a specific time. For automatic event recording, map channels to leagues in IPTV Channels."})]}),t.jsx("button",{onClick:()=>{S(!1),k(Kh),I(""),te(!1)},className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Event Title *"}),t.jsx("input",{type:"text",value:T.eventTitle,onChange:L=>yt("eventTitle",L.target.value),className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"e.g., NFL: Patriots vs Cowboys"})]}),t.jsxs("div",{className:"relative",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Channel *"}),C&&!F?t.jsxs("div",{onClick:()=>te(!0),className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white cursor-pointer hover:border-gray-600 flex items-center justify-between",children:[t.jsx("span",{children:C.name}),t.jsx("span",{className:"text-gray-500 text-sm",children:"Click to change"})]}):t.jsx("input",{type:"text",value:U,onChange:L=>{I(L.target.value),te(!0)},onFocus:()=>te(!0),className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600",placeholder:"Type to search channels..."}),F&&t.jsx("div",{className:"absolute z-10 w-full mt-1 bg-gray-800 border border-gray-700 rounded-lg shadow-xl max-h-64 overflow-y-auto",children:M.length===0?t.jsx("div",{className:"px-4 py-3 text-gray-500 text-center",children:o.length===0?"No enabled channels available. Enable channels in IPTV Channels settings.":"No channels match your search"}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"sticky top-0 bg-gray-800 px-4 py-2 border-b border-gray-700",children:t.jsxs("span",{className:"text-xs text-gray-500",children:[M.length," of ",o.length," channels"]})}),M.slice(0,100).map(L=>t.jsxs("button",{onClick:()=>j(L.id),className:`w-full px-4 py-3 text-left hover:bg-gray-700 transition-colors flex items-center justify-between ${T.channelId===L.id?"bg-red-900/30 text-red-400":"text-white"}`,children:[t.jsx("span",{className:"truncate",children:L.name}),T.channelId===L.id&&t.jsx(rs,{className:"w-5 h-5 text-red-400 flex-shrink-0 ml-2"})]},L.id)),M.length>100&&t.jsx("div",{className:"px-4 py-2 text-xs text-gray-500 text-center border-t border-gray-700",children:"Showing first 100 results. Type to narrow search."})]})}),F&&t.jsx("div",{className:"fixed inset-0 z-0",onClick:()=>te(!1)})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Time *"}),t.jsx("input",{type:"datetime-local",value:T.scheduledStart,onChange:L=>yt("scheduledStart",L.target.value),className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"End Time *"}),t.jsx("input",{type:"datetime-local",value:T.scheduledEnd,onChange:L=>yt("scheduledEnd",L.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Pre-padding (minutes)"}),t.jsx("input",{type:"number",value:T.prePadding,onChange:L=>yt("prePadding",parseInt(L.target.value)||0),min:"0",max:"60",className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Start recording before scheduled time"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Post-padding (minutes)"}),t.jsx("input",{type:"number",value:T.postPadding,onChange:L=>yt("postPadding",parseInt(L.target.value)||0),min:"0",max:"120",className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-red-600"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Continue recording after scheduled end"})]})]})]}),t.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-800 flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>{S(!1),k(Kh),I(""),te(!1)},className:"px-6 py-3 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>{Mt(),I(""),te(!1)},disabled:!Yr(),className:`px-6 py-3 rounded-lg transition-colors ${Yr()?"bg-red-600 hover:bg-red-700 text-white":"bg-gray-700 text-gray-500 cursor-not-allowed"}`,children:"Schedule Recording"})]})]})}),E!==null&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-md w-full",children:[t.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Delete Recording?"}),t.jsx("p",{className:"text-gray-400 mb-6",children:"Are you sure you want to delete this recording? This will also delete the recorded file if it exists. This action cannot be undone."}),t.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>R(null),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>Nt(E),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Delete"})]})]})}),K&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-md w-full",children:[t.jsxs("h3",{className:"text-2xl font-bold text-white mb-4",children:["Delete ",b.size," Recordings?"]}),t.jsxs("p",{className:"text-gray-400 mb-6",children:["Are you sure you want to delete ",b.size," recording",b.size!==1?"s":"","? This will also delete the recorded files if they exist. This action cannot be undone."]}),t.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[t.jsx("button",{onClick:()=>z(!1),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:()=>{St(),z(!1)},className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"Delete All"})]})]})}),D&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 overflow-y-auto",children:t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border border-red-900/50 rounded-lg p-6 max-w-2xl w-full my-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-2xl font-bold text-white",children:"Recording Details"}),t.jsx("button",{onClick:()=>O(null),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded transition-colors",children:t.jsx(qt,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500 text-sm",children:"Title"}),t.jsx("p",{className:"text-white font-medium",children:D.eventTitle})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500 text-sm",children:"Status"}),t.jsx("p",{className:`font-medium ${D.status==="Completed"?"text-green-400":"text-gray-400"}`,children:D.status})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500 text-sm",children:"Channel"}),t.jsx("p",{className:"text-white",children:D.channelName})]}),D.leagueName&&t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500 text-sm",children:"League"}),t.jsx("p",{className:"text-white",children:D.leagueName})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500 text-sm",children:"Scheduled Start"}),t.jsxs("p",{className:"text-white",children:[ti(D.scheduledStart,a,{month:"2-digit",day:"2-digit",year:"numeric"}),", ",Fo(D.scheduledStart,a,{hour:"2-digit",minute:"2-digit",second:"2-digit"})]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500 text-sm",children:"Scheduled End"}),t.jsxs("p",{className:"text-white",children:[ti(D.scheduledEnd,a,{month:"2-digit",day:"2-digit",year:"numeric"}),", ",Fo(D.scheduledEnd,a,{hour:"2-digit",minute:"2-digit",second:"2-digit"})]})]}),D.actualStart&&t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500 text-sm",children:"Actual Start"}),t.jsxs("p",{className:"text-white",children:[ti(D.actualStart,a,{month:"2-digit",day:"2-digit",year:"numeric"}),", ",Fo(D.actualStart,a,{hour:"2-digit",minute:"2-digit",second:"2-digit"})]})]}),D.actualEnd&&t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500 text-sm",children:"Actual End"}),t.jsxs("p",{className:"text-white",children:[ti(D.actualEnd,a,{month:"2-digit",day:"2-digit",year:"numeric"}),", ",Fo(D.actualEnd,a,{hour:"2-digit",minute:"2-digit",second:"2-digit"})]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500 text-sm",children:"Duration"}),t.jsx("p",{className:"text-white",children:vt(D.actualStart||D.scheduledStart,D.actualEnd||D.scheduledEnd)})]}),D.fileSize&&D.fileSize>0&&t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500 text-sm",children:"File Size"}),t.jsx("p",{className:"text-white",children:os(D.fileSize)})]})]}),D.outputPath&&t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500 text-sm",children:"File Path"}),t.jsx("p",{className:"text-white font-mono text-sm bg-black/50 p-2 rounded mt-1 break-all",children:D.outputPath})]}),D.errorMessage&&t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500 text-sm",children:"Error"}),t.jsx("p",{className:"text-red-400 bg-red-950/30 p-2 rounded mt-1",children:D.errorMessage})]})]}),t.jsx("div",{className:"mt-6 pt-6 border-t border-gray-800 flex items-center justify-end",children:t.jsx("button",{onClick:()=>O(null),className:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Close"})})]})})]})]})}const Yh={Scheduled:{bg:"bg-blue-900/50",border:"border-blue-500",text:"text-blue-400"},Recording:{bg:"bg-red-900/50",border:"border-red-500",text:"text-red-400"},Completed:{bg:"bg-green-900/50",border:"border-green-500",text:"text-green-400"},Failed:{bg:"bg-red-900/50",border:"border-red-500",text:"text-red-400"}},Mo=120,wd=200,l8=48,c8=64;function d8(){var dt,He,Ce;const[a,e]=aN(),s=Ta(),{timezone:r}=Zf(),[n,o]=y.useState(null),[c,d]=y.useState([]),[f,u]=y.useState(!0),[m,g]=y.useState(!1),[x,b]=y.useState(new Date),[v,w]=y.useState(0),[S,T]=y.useState(null),[k,E]=y.useState(null),R=a.get("scheduledOnly")==="true",K=a.get("sportsOnly")==="true",z=a.get("enabledOnly")!=="false",D=a.get("hasEpgOnly")==="true",O=a.get("group")||"",U=a.get("country")||"",[I,F]=y.useState(!1),[te,le]=y.useState(!1),[H,X]=y.useState(""),[q,ae]=y.useState(""),[ce,ee]=y.useState([]),[W,V]=y.useState([]),G=y.useRef(null);y.useEffect(()=>{const _e=setInterval(()=>{b(new Date)},6e4);return()=>clearInterval(_e)},[]),y.useEffect(()=>{Z(),oe(),ye(),je()},[v,R,K,z,D,O,U]);const Z=async()=>{u(!0);try{const _e=new Date;_e.setHours(_e.getHours()+v),_e.setMinutes(0,0,0);const ge=new Date(_e);ge.setHours(ge.getHours()+12);const Ze=new URLSearchParams({start:_e.toISOString(),end:ge.toISOString(),offset:"0",limit:"500"});R&&Ze.set("scheduledOnly","true"),K&&Ze.set("sportsOnly","true"),z&&Ze.set("enabledOnly","true"),D&&Ze.set("hasEpgOnly","true"),O&&Ze.set("group",O),U&&Ze.set("country",U);const Me=await at.get(`/epg/guide?${Ze}`);o(Me.data)}catch(_e){console.error("Failed to load TV Guide:",_e),be.error("Failed to load TV Guide")}finally{u(!1)}},oe=async()=>{try{const _e=await at.get("/epg/sources");d(_e.data)}catch(_e){console.error("Failed to load EPG sources:",_e)}},ye=async()=>{try{const _e=await at.get("/iptv/groups");ee(Array.isArray(_e.data)?_e.data:[])}catch(_e){console.error("Failed to load channel groups:",_e),ee([])}},je=async()=>{try{const _e=await at.get("/iptv/countries");V(Array.isArray(_e.data)?_e.data:[])}catch(_e){console.error("Failed to load channel countries:",_e),V([])}},xe=async()=>{g(!0);try{await at.post("/epg/sync-all"),be.success("EPG sync started"),await oe(),await Z()}catch(_e){console.error("Failed to sync EPG:",_e),be.error("Failed to sync EPG sources")}finally{g(!1)}},Ee=async()=>{if(!H.trim()||!q.trim()){be.error("Please enter both name and URL");return}try{await at.post("/epg/sources",{name:q.trim(),url:H.trim()}),be.success("EPG source added"),X(""),ae(""),await oe()}catch(_e){console.error("Failed to add EPG source:",_e),be.error("Failed to add EPG source")}},Pe=async _e=>{try{await at.delete(`/epg/sources/${_e}`),be.success("EPG source deleted"),await oe()}catch(ge){console.error("Failed to delete EPG source:",ge),be.error("Failed to delete EPG source")}},Re=async _e=>{var ge,Ze;try{await at.post(`/epg/programs/${_e.id}/schedule-dvr`),be.success(`DVR scheduled for "${_e.title}"`),await Z()}catch(Me){console.error("Failed to schedule DVR:",Me),be.error(((Ze=(ge=Me.response)==null?void 0:ge.data)==null?void 0:Ze.error)||"Failed to schedule DVR")}},Qe=async _e=>{try{await at.post(`/dvr/recordings/${_e}/cancel`),be.success("DVR recording cancelled"),await Z()}catch(ge){console.error("Failed to cancel DVR:",ge),be.error("Failed to cancel DVR")}},ot=(_e,ge)=>{const Ze=new URLSearchParams(a);ge?(Ze.set(_e,"true"),_e==="enabledOnly"&&Ze.delete(_e)):_e==="enabledOnly"?Ze.set(_e,"false"):Ze.delete(_e),e(Ze)},ne=y.useMemo(()=>{if(!n)return[];const _e=new Date(n.startTime),ge=[];for(let Ze=0;Ze<24;Ze++){const Me=new Date(_e);Me.setMinutes(Me.getMinutes()+Ze*30),ge.push(Me)}return ge},[n]),ke=y.useCallback(_e=>{if(!n)return{left:0,width:0};const ge=new Date(n.startTime).getTime(),Ze=new Date(n.endTime).getTime(),Me=Math.max(new Date(_e.startTime).getTime(),ge),nt=Math.min(new Date(_e.endTime).getTime(),Ze),ht=Ze-ge,Oe=(Me-ge)/ht,tt=(nt-Me)/ht,Ct=Mo*24;return{left:Oe*Ct,width:Math.max(tt*Ct-2,40)}},[n]),Be=y.useMemo(()=>{if(!n)return null;const _e=new Date(n.startTime).getTime(),ge=new Date(n.endTime).getTime(),Ze=x.getTime();if(Ze<_e||Ze>ge)return null;const Me=ge-_e,nt=(Ze-_e)/Me,ht=Mo*24;return nt*ht},[n,x]),qe=_e=>{const ge=typeof _e=="string"?new Date(_e):_e;return Fo(ge.toISOString(),r,{hour:"2-digit",minute:"2-digit"})};return f&&!n?t.jsx("div",{className:"p-8 flex items-center justify-center",children:t.jsx(Dt,{className:"w-8 h-8 animate-spin text-red-500"})}):t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-black border-b border-red-900/30 p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[t.jsx(io,{className:"w-7 h-7 text-red-500"}),"TV Guide"]}),t.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Browse EPG data and schedule DVR recordings"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>le(!te),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",title:"EPG Settings",children:t.jsx(ru,{className:"w-5 h-5"})}),t.jsxs("button",{onClick:xe,disabled:m,className:"flex items-center gap-2 px-3 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors disabled:opacity-50",children:[t.jsx(Dt,{className:`w-4 h-4 ${m?"animate-spin":""}`}),"Sync EPG"]})]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>w(_e=>_e-6),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",children:t.jsx(DN,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>w(0),className:"px-3 py-1 text-sm bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors",children:"Now"}),t.jsx("button",{onClick:()=>w(_e=>_e+6),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",children:t.jsx(_c,{className:"w-5 h-5"})}),n&&t.jsxs("span",{className:"text-gray-400 text-sm ml-4",children:[ti(n.startTime,r,{weekday:"short",month:"short",day:"numeric"})," ",qe(n.startTime)," - ",qe(n.endTime)]})]}),t.jsx("div",{className:"flex items-center gap-4",children:t.jsxs("button",{onClick:()=>F(!I),className:`flex items-center gap-2 px-3 py-1 rounded-lg transition-colors ${I?"bg-red-600 text-white":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`,children:[t.jsx(au,{className:"w-4 h-4"}),"Filters"]})})]}),I&&t.jsx("div",{className:"mt-4 p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:t.jsxs("div",{className:"flex flex-wrap gap-4",children:[t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:R,onChange:_e=>ot("scheduledOnly",_e.target.checked),className:"rounded border-gray-600 bg-gray-700 text-red-600 focus:ring-red-500"}),t.jsx("span",{className:"text-gray-300 text-sm",children:"Scheduled recordings only"})]}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:K,onChange:_e=>ot("sportsOnly",_e.target.checked),className:"rounded border-gray-600 bg-gray-700 text-red-600 focus:ring-red-500"}),t.jsx("span",{className:"text-gray-300 text-sm",children:"Sports channels only"})]}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:z,onChange:_e=>ot("enabledOnly",_e.target.checked),className:"rounded border-gray-600 bg-gray-700 text-red-600 focus:ring-red-500"}),t.jsx("span",{className:"text-gray-300 text-sm",children:"Enabled channels only"})]}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:D,onChange:_e=>ot("hasEpgOnly",_e.target.checked),className:"rounded border-gray-600 bg-gray-700 text-red-600 focus:ring-red-500"}),t.jsx("span",{className:"text-gray-300 text-sm",children:"Channels with EPG only"})]}),ce.length>0&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-gray-300 text-sm",children:"Group:"}),t.jsxs("select",{value:O,onChange:_e=>{const ge=new URLSearchParams(a);_e.target.value?ge.set("group",_e.target.value):ge.delete("group"),e(ge)},className:"px-3 py-1.5 bg-gray-700 border border-gray-600 rounded-lg text-white text-sm focus:border-red-500 focus:ring-1 focus:ring-red-500",children:[t.jsx("option",{value:"",children:"All Groups"}),ce.map(_e=>t.jsx("option",{value:_e,children:_e},_e))]})]}),W.length>0&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-gray-300 text-sm",children:"Country:"}),t.jsxs("select",{value:U,onChange:_e=>{const ge=new URLSearchParams(a);_e.target.value?ge.set("country",_e.target.value):ge.delete("country"),e(ge)},className:"px-3 py-1.5 bg-gray-700 border border-gray-600 rounded-lg text-white text-sm focus:border-red-500 focus:ring-1 focus:ring-red-500",children:[t.jsx("option",{value:"",children:"All Countries"}),W.map(_e=>t.jsx("option",{value:_e,children:_e},_e))]})]})]})}),te&&t.jsxs("div",{className:"mt-4 p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:[t.jsx("h3",{className:"text-white font-semibold mb-3",children:"EPG Sources"}),t.jsxs("div",{className:"flex gap-2 mb-4",children:[t.jsx("input",{type:"text",placeholder:"Source name",value:q,onChange:_e=>ae(_e.target.value),className:"flex-1 max-w-xs px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:border-red-500 focus:ring-1 focus:ring-red-500"}),t.jsx("input",{type:"text",placeholder:"XMLTV URL (http://... or .xml.gz)",value:H,onChange:_e=>X(_e.target.value),className:"flex-[2] px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:border-red-500 focus:ring-1 focus:ring-red-500"}),t.jsx("button",{onClick:Ee,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:t.jsx(hr,{className:"w-5 h-5"})})]}),c.length===0?t.jsx("p",{className:"text-gray-400 text-sm",children:"No EPG sources configured. Add an XMLTV URL above to get started."}):t.jsx("div",{className:"space-y-2",children:c.map(_e=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-700/50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-white font-medium",children:_e.name}),t.jsx("div",{className:"text-gray-400 text-xs truncate max-w-md",children:_e.url}),t.jsxs("div",{className:"text-gray-500 text-xs mt-1",children:[_e.programCount," programs",_e.lastUpdated&&` | Updated: ${ti(_e.lastUpdated,r,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}`,_e.lastError&&t.jsxs("span",{className:"text-red-400",children:[" | Error: ",_e.lastError]})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>at.post(`/epg/sources/${_e.id}/sync`).then(()=>{be.success("Syncing..."),oe()}),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-600 rounded transition-colors",title:"Sync this source",children:t.jsx(Dt,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>Pe(_e.id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-900/30 rounded transition-colors",title:"Delete",children:t.jsx("span",{className:"text-lg",children:""})})]})]},_e.id))})]})]}),t.jsx("div",{className:"flex-1 overflow-hidden",children:!n||n.channels.length===0?t.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[t.jsx(io,{className:"w-16 h-16 mb-4 opacity-50"}),t.jsx("p",{className:"text-lg",children:"No TV Guide data available"}),t.jsx("p",{className:"text-sm mt-2",children:c.length===0?"Add an EPG source above to get started":"Try syncing your EPG sources or adjusting filters"})]}):t.jsx("div",{className:"h-full overflow-auto",ref:G,children:t.jsxs("div",{className:"relative",style:{minWidth:wd+Mo*24},children:[t.jsxs("div",{className:"sticky top-0 z-20 flex bg-gray-900 border-b border-gray-700",style:{height:l8},children:[t.jsx("div",{className:"sticky left-0 z-30 bg-gray-900 border-r border-gray-700 flex items-center px-4",style:{width:wd,minWidth:wd},children:t.jsx("span",{className:"text-gray-400 font-medium",children:"Channel"})}),t.jsx("div",{className:"flex",children:ne.map((_e,ge)=>t.jsx("div",{className:"flex items-center justify-center border-r border-gray-700 text-gray-400 text-sm",style:{width:Mo,minWidth:Mo},children:qe(_e)},ge))})]}),n.channels.map(_e=>t.jsxs("div",{className:"flex border-b border-gray-800 hover:bg-gray-800/30",style:{height:c8},children:[t.jsxs("div",{className:"sticky left-0 z-10 bg-gray-900 border-r border-gray-700 flex items-center gap-2 px-3",style:{width:wd,minWidth:wd},children:[_e.logoUrl?t.jsx("img",{src:_e.logoUrl,alt:_e.name,className:"w-8 h-8 object-contain rounded",onError:ge=>{ge.target.style.display="none"}}):t.jsx("div",{className:"w-8 h-8 bg-gray-700 rounded flex items-center justify-center",children:t.jsx(io,{className:"w-4 h-4 text-gray-500"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"text-white text-sm font-medium truncate",children:_e.name}),_e.channelNumber&&t.jsx("div",{className:"text-gray-500 text-xs",children:_e.channelNumber})]})]}),t.jsxs("div",{className:"relative flex-1",style:{width:Mo*24},children:[t.jsx("div",{className:"absolute inset-0 flex pointer-events-none",children:ne.map((ge,Ze)=>t.jsx("div",{className:"border-r border-gray-800/50",style:{width:Mo}},Ze))}),Be!==null&&t.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-red-500 z-10",style:{left:Be}}),_e.programs.map((ge,Ze)=>{const Me=ke(ge),nt=ge.dvrRecordingStatus?Yh[ge.dvrRecordingStatus]:null;return t.jsx("div",{className:`absolute top-1 bottom-1 rounded cursor-pointer overflow-hidden transition-all hover:z-10 hover:scale-[1.02] ${ge.hasDvrRecording?`${(nt==null?void 0:nt.bg)||"bg-blue-900/50"} ${(nt==null?void 0:nt.border)||"border-blue-500"} border-2`:ge.isSportsProgram?"bg-green-900/40 border border-green-700/50 hover:bg-green-900/60":"bg-gray-800 border border-gray-700 hover:bg-gray-700"}`,style:{left:Me.left,width:Me.width},onClick:()=>{T(ge),E(_e)},title:`${ge.title}
${qe(ge.startTime)} - ${qe(ge.endTime)}`,children:t.jsxs("div",{className:"p-1.5 h-full flex flex-col",children:[t.jsx("div",{className:`text-xs font-medium truncate ${ge.hasDvrRecording?(nt==null?void 0:nt.text)||"text-blue-400":"text-white"}`,children:ge.title}),t.jsxs("div",{className:"text-[10px] text-gray-400 truncate",children:[qe(ge.startTime)," - ",qe(ge.endTime)]}),ge.hasDvrRecording&&t.jsx("div",{className:"mt-auto",children:t.jsx(ii,{className:`w-3 h-3 ${(nt==null?void 0:nt.text)||"text-blue-400"}`})})]})},`${ge.id}-${Ze}`)})]})]},_e.id))]})})}),S&&k&&t.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",onClick:()=>{T(null),E(null)},children:t.jsx("div",{className:"bg-gray-900 border border-gray-700 rounded-xl max-w-lg w-full max-h-[90vh] overflow-auto",onClick:_e=>_e.stopPropagation(),children:t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-white",children:S.title}),t.jsx("p",{className:"text-gray-400 text-sm mt-1",children:k.name})]}),t.jsx("button",{onClick:()=>{T(null),E(null)},className:"text-gray-400 hover:text-white p-1",children:t.jsx("span",{className:"text-2xl",children:""})})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[t.jsxs("div",{className:"flex items-center gap-1 text-gray-400",children:[t.jsx($r,{className:"w-4 h-4"}),qe(S.startTime)," - ",qe(S.endTime)]}),S.category&&t.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 rounded text-xs",children:S.category}),S.isSportsProgram&&t.jsx("span",{className:"px-2 py-0.5 bg-green-900/50 text-green-400 rounded text-xs",children:"Sports"})]}),S.description&&t.jsx("p",{className:"text-gray-300 text-sm",children:S.description}),S.hasDvrRecording?t.jsx("div",{className:`p-3 rounded-lg ${((dt=Yh[S.dvrRecordingStatus||""])==null?void 0:dt.bg)||"bg-blue-900/30"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ii,{className:`w-5 h-5 ${((He=Yh[S.dvrRecordingStatus||""])==null?void 0:He.text)||"text-blue-400"}`}),t.jsxs("span",{className:((Ce=Yh[S.dvrRecordingStatus||""])==null?void 0:Ce.text)||"text-blue-400",children:["DVR: ",S.dvrRecordingStatus]})]}),S.dvrRecordingStatus==="Scheduled"&&t.jsx("button",{onClick:()=>S.dvrRecordingId&&Qe(S.dvrRecordingId),className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white text-sm rounded transition-colors",children:"Cancel"})]})}):S.id>0?t.jsxs("button",{onClick:()=>Re(S),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[t.jsx(ii,{className:"w-5 h-5"}),"Schedule DVR Recording"]}):t.jsxs("div",{className:"p-3 bg-gray-800 rounded-lg text-gray-400 text-sm",children:[t.jsx(Or,{className:"w-5 h-5 inline mr-2"}),"This is a DVR-only entry (no EPG data). Use the Recordings page to manage."]}),S.matchedEventId&&t.jsx("button",{onClick:()=>s(`/events/${S.matchedEventId}`),className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"View Matched Event"})]})]})})}),t.jsxs("div",{className:"bg-gray-900 border-t border-gray-700 px-4 py-2 flex items-center gap-6 text-xs",children:[t.jsx("span",{className:"text-gray-500",children:"Legend:"}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-3 h-3 bg-gray-800 border border-gray-700 rounded"}),t.jsx("span",{className:"text-gray-400",children:"Regular"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-3 h-3 bg-green-900/40 border border-green-700/50 rounded"}),t.jsx("span",{className:"text-gray-400",children:"Sports"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-3 h-3 bg-blue-900/50 border-2 border-blue-500 rounded"}),t.jsx("span",{className:"text-gray-400",children:"Scheduled DVR"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-3 h-3 bg-red-900/50 border-2 border-red-500 rounded"}),t.jsx("span",{className:"text-gray-400",children:"Recording"})]}),t.jsxs("div",{className:"flex items-center gap-1 ml-auto",children:[t.jsx("div",{className:"w-0.5 h-3 bg-red-500"}),t.jsx("span",{className:"text-gray-400",children:"Current Time"})]})]})]})}function u8(){y.useEffect(()=>{const a=new Map,e=new MutationObserver(r=>{for(const n of r)if(n.type==="attributes"&&n.attributeName==="inert"){const o=n.target;o.hasAttribute("inert")?a.set(o,Date.now()):a.delete(o)}}),s=setInterval(()=>{const r=Date.now();document.querySelector('[role="dialog"]')!==null||document.querySelectorAll("[inert]").forEach(o=>{const c=a.get(o);(!c||r-c>500)&&(o.removeAttribute("inert"),a.delete(o))})},200);return e.observe(document.body,{attributes:!0,attributeFilter:["inert"],subtree:!0}),()=>{e.disconnect(),clearInterval(s)}},[])}const h8=new DA({defaultOptions:{queries:{staleTime:1e3*60*5,retry:1}}});function f8(){var a;return u8(),t.jsx(P3,{children:t.jsxs(IA,{client:h8,children:[t.jsxs(d4,{basename:((a=window.Sportarr)==null?void 0:a.urlBase)||"",children:[t.jsx(K4,{position:"top-right",theme:"dark",richColors:!0,closeButton:!0}),t.jsx(I3,{children:t.jsxs(UC,{children:[t.jsx(ns,{path:"/login",element:t.jsx(MI,{})}),t.jsxs(ns,{path:"/",element:t.jsx(O3,{children:t.jsx(M3,{})}),children:[t.jsx(ns,{index:!0,element:t.jsx(Yl,{to:"/leagues",replace:!0})}),t.jsx(ns,{path:"leagues",element:t.jsx(WD,{})}),t.jsx(ns,{path:"leagues/:id",element:t.jsx(iI,{})}),t.jsx(ns,{path:"add-league/search",element:t.jsx(dI,{})}),t.jsx(ns,{path:"add-event/search",element:t.jsx(lI,{})}),t.jsx(ns,{path:"library-import",element:t.jsx(NI,{})}),t.jsx(ns,{path:"calendar",element:t.jsx(fI,{})}),t.jsx(ns,{path:"activity",element:t.jsx(wI,{})}),t.jsx(ns,{path:"wanted",element:t.jsx(SI,{})}),t.jsx(ns,{path:"iptv",element:t.jsx(Yl,{to:"/iptv/sources",replace:!0})}),t.jsx(ns,{path:"iptv/sources",element:t.jsx(n8,{})}),t.jsx(ns,{path:"iptv/channels",element:t.jsx(i8,{})}),t.jsx(ns,{path:"iptv/guide",element:t.jsx(d8,{})}),t.jsx(ns,{path:"iptv/schedule",element:t.jsx(Yl,{to:"/iptv/guide?scheduledOnly=true",replace:!0})}),t.jsx(ns,{path:"iptv/recordings",element:t.jsx(o8,{})}),t.jsx(ns,{path:"settings",element:t.jsx(Yl,{to:"/settings/mediamanagement",replace:!0})}),t.jsx(ns,{path:"settings/mediamanagement",element:t.jsx(OI,{})}),t.jsx(ns,{path:"settings/profiles",element:t.jsx(FI,{})}),t.jsx(ns,{path:"settings/quality",element:t.jsx(BI,{})}),t.jsx(ns,{path:"settings/customformats",element:t.jsx($I,{})}),t.jsx(ns,{path:"settings/trashguides",element:t.jsx(GI,{})}),t.jsx(ns,{path:"settings/indexers",element:t.jsx(HI,{})}),t.jsx(ns,{path:"settings/importlists",element:t.jsx(VI,{})}),t.jsx(ns,{path:"settings/downloadclients",element:t.jsx(qI,{})}),t.jsx(ns,{path:"settings/notifications",element:t.jsx(KI,{})}),t.jsx(ns,{path:"settings/general",element:t.jsx(YI,{})}),t.jsx(ns,{path:"settings/ui",element:t.jsx(WI,{})}),t.jsx(ns,{path:"settings/tags",element:t.jsx(QI,{})}),t.jsx(ns,{path:"settings/development",element:t.jsx(XI,{})}),t.jsx(ns,{path:"system",element:t.jsx(Yl,{to:"/system/status",replace:!0})}),t.jsx(ns,{path:"system/status",element:t.jsx(jI,{})}),t.jsx(ns,{path:"system/health",element:t.jsx(AI,{})}),t.jsx(ns,{path:"system/tasks",element:t.jsx(DI,{})}),t.jsx(ns,{path:"system/backup",element:t.jsx(CI,{})}),t.jsx(ns,{path:"system/updates",element:t.jsx(RI,{})}),t.jsx(ns,{path:"system/events",element:t.jsx(kI,{})}),t.jsx(ns,{path:"system/logs",element:t.jsx(LI,{})}),t.jsx(ns,{path:"*",element:t.jsx(II,{})})]})]})})]}),t.jsx(qA,{initialIsOpen:!1})]})})}async function m8(){var a;try{const e=`${((a=window.Sportarr)==null?void 0:a.urlBase)||""}/initialize.json?t=${Date.now()}`,s=await fetch(e);if(!s.ok)throw new Error(`Failed to fetch initialize.json: ${s.status}`);window.Sportarr=await s.json(),console.log("[INIT] Loaded config from backend:",window.Sportarr)}catch(e){console.error("Failed to initialize Sportarr config:",e),window.Sportarr={apiRoot:"",apiKey:"",urlBase:"",version:"unknown"}}dA.createRoot(document.getElementById("root")).render(t.jsx(y.StrictMode,{children:t.jsx(f8,{})}))}m8();
